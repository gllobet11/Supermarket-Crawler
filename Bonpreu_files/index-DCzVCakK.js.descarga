const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/bop-K01uqWqK.js","static/0-vendor-react-Cj6oeB6O.js","static/2-vendor-DXBa0Shd.js","static/1-vendor-moment-Zj37fLSV.js","static/campaign-BAwaXs9s.js","static/cookie-policy-CDyQUtyi.js","static/coupons-page-CzHhDXRe.js","static/coupon-details-CKpzxpog.js","static/logged-out-homepage-B_iOlxqs.js","static/homepage-catalogue-Dk5rI1co.js","static/logged-in-homepage-iGgUS9qa.js","static/instant-shop-B5H1JdQL.js","static/lister-page-DFU_k5wa.js","static/index-CC359V3C.js","static/meal-tabs-voz_CI_P.js","static/meals-DukPd3jg.js","static/promotion-details-D2I5VqxA.js","static/out-of-stock-page-BV5B2MFK.js","static/refund-request-page-TxTGNEMq.js","static/regulars-D1N0L6Px.js","static/shop-in-shop-DWPo7uNb.js","static/shopping-lists-CtmPMhdK.js","static/update-list-name-modal-HB7k6N09.js","static/shopping-list-details-BGrvRjef.js"])))=>i.map(i=>d[i]);
import{R as ie,r as h,j as s,b as Boe,f as Pb}from"./0-vendor-react-Cj6oeB6O.js";import{m as Ge,h as Mt,a as Zr}from"./1-vendor-moment-Zj37fLSV.js";import{c as V,A as Uoe,v as vt,i as Goe,g as $oe,R as Hoe,a as Voe,m as A$,t as o_,f as tj,d as Yoe,q as tt,P as p,s as To,b as Woe,n as b$,e as qoe,p as UI,h as Koe,u as E,j as wo,k as F,l as x$,G as zoe,o as Or,r as ip,z as Qoe,w as r_,x as De,y as Xoe,B as Zoe,C as sj,D as Joe,E as ere,F as R$,U as tre,H as nj,I as M,J as Ee,K as ne,W as Yl,L as P,M as Pe,N as eh,S as Fn,O as Wl,Q as sre,T as nre,V as ore,X as Zn,Y as Jr,Z as lp,_ as Ne,$ as $i,a0 as ve,a1 as th,a2 as Ki,a3 as ke,a4 as sh,a5 as Ct,a6 as Bt,a7 as nn,a8 as Nb,a9 as We,aa as rre,ab as zi,ac as Ms,ad as Lb,ae as are,af as us,ag as ire,ah as lre,ai as cre,aj as dre,ak as kb,al as ure,am as pre,an as _o,ao as mre,ap as hre,aq as _t,ar as Y,as as gre,at as Ere,au as fre,av as yre,aw as Ire,ax as Sre,ay as Mb,az as D$,aA as jb,aB as Cre,aC as Tre,aD as $o,aE as Gn,aF as $n,aG as co,aH as zv,aI as _re,aJ as vre,aK as Iu,aL as O$,aM as Za,aN as ri,aO as wb,aP as Fb,aQ as Lu,aR as Are,aS as _u,aT as Qv,aU as GI,aV as yf,aW as Xv,aX as ai,aY as P$,aZ as hy,a_ as ed,a$ as $I,b0 as un,b1 as bre,b2 as xre,b3 as N$,b4 as Rre,b5 as L$,b6 as Dre,b7 as td,b8 as If,b9 as Ore,ba as k$,bb as _m,bc as Pre,bd as Nre,be as Lre,bf as kre,bg as HI,bh as Mre,bi as jre,bj as M$,bk as wre,bl as Fre,bm as Bre}from"./2-vendor-DXBa0Shd.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};e.__faroBundleId_webuniversal="175820668366402f6fc025b"}catch{}})();(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};e.__faroBundleId_webuniversal="1758206683664f790769977"}catch{}})();(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();const oa="YYYY-MM-DD",j$="YYYY-MM-DDTHH:mm:ssZ",Ure="DD-MM-YY",w$="dddd D MMMM",Xo="ddd DD MMM",VI="ddd DD",YI="ddd DD MMM H:mm",gy="ddd DD MMM YYYY",Gre="DD MMM YYYY",F$="DD/MM/YYYY",B$="DD/MM/YY",WI="ll",$re="L",Hre="LLLL",vn="HH:mm",U$="ddd",Ma="dddd",G$="DD",Zv="M",$$="MMMM YYYY",Jv="Do MMMM YYYY",H$="DD MMM",eA="DD MMMM",V$="MMM",Y$="minutes",Bb="day",qI="days",KI="month",Ub="months",Gb="week",W$="weeks",Ks=(e,t)=>Ge(t).format(e),q$=(e,t)=>Ge(t).format(e),gd=(e,t)=>{const n=typeof e=="string"?Number(e):e;return typeof n=="number"&&n>=1&&n<=7?Ge().isoWeekday(n).format(t):""},yt=(e,t)=>Ge.parseZone(e,Ge.ISO_8601).format(t),Wh=(e,t,n)=>{const o=yt(e,n),r=yt(t,n);return`${o} - ${r}`},Vre=(e,t,n,o)=>({fromDate:yt(e,n),toDate:yt(t,o)}),K$=(e,t,n)=>`${yt(e,t)} ${yt(e,n)}`,qh=e=>/[+|-][0-9]{2}/.test(Ge.tz(e).zoneName())?"[GMT]zz":"zz",So=(e,t,n,o)=>Ge.parseZone(e,Ge.ISO_8601).tz(t).format(`${n}${o?` ${qh(t)}`:""}`),$b=(e,t,n,o)=>Ge.parseZone(e,Ge.ISO_8601).tz(t).format(`${n}${o?` ${qh(t)}`:""}`),Hb=(e,t,n,o,r)=>Ge.parseZone(e,Ge.ISO_8601).tz(t).format(`${n} ${o}${r?` ${qh(t)}`:""}`),z$=(e,t,n,o,r)=>{const a=Ge.parseZone(e,Ge.ISO_8601).tz(n),i=Ge.parseZone(t,Ge.ISO_8601).tz(n);return`${a.format(o)} - ${i.format(`${o}${r?` ${qh(n)}`:""}`)}`},Q$=(e,t,n,o,r,a)=>{const i=Ge.parseZone(e,Ge.ISO_8601).tz(n),l=Ge.parseZone(t,Ge.ISO_8601).tz(n),c=i.format(o),d=l.format(o),u=c!==d?`${d} `:"",m=l.format(`${r}${a?` ${qh(n)}`:""}`);return`${c} ${i.format(r)} - ${u}${m}`},X$=(e,t,n,o)=>{const r=yt(e,n),a=yt(t,n),i=yt(e,o),l=yt(t,o),c=r!==a?`${a} `:"";return`${r} ${i} - ${c}${l}`},nh=(e,t)=>Ge.utc(e).tz(t).format(j$),cp=(e,t,n)=>Ge(n).add(e,t).format(),tA=(e,t)=>cp(e,Y$,t),zI=(e,t)=>cp(e,qI,t),Z$=(e,t)=>cp(e,Ub,t),Yre=(e,t)=>Ge(t).subtract(e,Ub).format(),J$=(e,t)=>Ge(t).subtract(e,qI).format(),oh=(e,t=Ge())=>Ge(e).isAfter(Ge(t)),Kh=(e,t)=>Ge(e)-Ge(t),Wre=(e,t)=>oh(e,t)?t:e,qre=()=>Ge.localeData().firstDayOfWeek(),e0=(e,t,n)=>{const r=Ge(e),a=Ge(t);if(!r.isValid()||!a.isValid())return"Invalid date";const l=Math.abs(r.diff(a,n))/1+1;return Array.from(Array(l)).map((c,d)=>cp(d*1,n,e))},t0=(e,t)=>e0(e,t,qI),Kre=(e,t)=>e0(e,t,W$),zre=(e,t)=>Ge(e).isSame(Ge(t),Bb),Qre=e=>Ge(e).startOf(KI).startOf(Gb).format(),Xre=e=>Ge(e).endOf(KI).endOf(Gb).format(),le=(e="")=>e!==""?Ge(e).valueOf():Ge().valueOf(),Zre=e=>e?Ge(e).valueOf():Ge().valueOf(),Vb=e=>Ge(e).format(),Ll=()=>Ge().format(),s0=(e="")=>e.split("T")[0],rh=e=>Ge(e).valueOf(),Jre=e=>Ge(e).toDate(),eae=e=>Ge(e),QI=e=>Ge(e).toDate(),Ey=e=>Ge(e).toISOString(),n0=()=>Ge().utc().toISOString(),o0=e=>Ge.locale(e),tae=()=>Date,ah=e=>Ge.tz.zone(e)!==null,ih=e=>Ge.tz.guess()||e||"UTC",sA=e=>Ge().tz(e).utcOffset(),fy=(e,t)=>{const n=Ge(e).startOf("day"),o=Ge(t).startOf("day");return n.diff(o,"days")},ql=e=>{const t=Ge().startOf("day");return Ge(e).startOf("day").diff(t,"days")},XI=e=>ql(e)<0,sae=e=>ql(e)>0,nae=e=>ql(e)===-1,sd=e=>ql(e)===0,lh=e=>ql(e)===1,Yb=(e,t)=>Ge(e).startOf("day").isSame(Ge(t).startOf("day"),Bb),r0=(e,t)=>Ge(e).isSame(Ge(t),KI),vm=Object.freeze(Object.defineProperty({__proto__:null,DATE_FORMAT_DAY_AND_FULL_MONTH:eA,DATE_FORMAT_DAY_AND_MONTH:H$,DATE_FORMAT_DAY_WITH_LEADING_ZEROS:G$,DATE_FORMAT_FULL_DAY_NAME:Ma,DATE_FORMAT_HYPHEN_SEPARATED:Ure,DATE_FORMAT_LOCALE_DEPENDENT:WI,DATE_FORMAT_LOCALE_DEPENDENT_LONG:Hre,DATE_FORMAT_LOCALE_DEPENDENT_SHORT:$re,DATE_FORMAT_MONTH_INDEX:Zv,DATE_FORMAT_MONTH_SHORTHAND:V$,DATE_FORMAT_MONTH_YEAR_LABEL:$$,DATE_FORMAT_SHORT_ISO:oa,DATE_FORMAT_SHORT_WEEKDAY_NAME:U$,DATE_FORMAT_SLASH_SEPARATED_WITH_FULL_YEAR:F$,DATE_FORMAT_SLASH_SEPARATED_WITH_SHORT_YEAR:B$,DATE_FORMAT_SPACE_SEPARATED_WITH_FULL_YEAR:Gre,DATE_FORMAT_UTC_WITH_OFFSET:j$,DATE_FORMAT_WRITTEN:w$,DATE_FORMAT_WRITTEN_SHORTHAND:Xo,DATE_FORMAT_WRITTEN_SHORTHAND_WEEKDAY:VI,DATE_FORMAT_WRITTEN_SHORTHAND_WITH_YEAR:gy,DATE_FORMAT_WRITTEN_WITH_FULL_YEAR:Jv,DATE_TIME_FORMAT_WRITTEN_SHORTHAND:YI,TIME_FORMAT_MILITARY:vn,TIME_PERIOD_DAY:Bb,TIME_PERIOD_DAYS:qI,TIME_PERIOD_MINUTES:Y$,TIME_PERIOD_MONTH:KI,TIME_PERIOD_MONTHS:Ub,TIME_PERIOD_WEEK:Gb,TIME_PERIOD_WEEKS:W$,addDays:zI,addMinutes:tA,addMonths:Z$,addPeriod:cp,areDaysTheSame:zre,checkDiffBetweenTodayAndGivenDayInDays:ql,checkIfDaysAreTheSame:Yb,checkIfGivenDateIsInTheFuture:sae,checkIfGivenDateIsInThePast:XI,checkIfGivenDateIsToday:sd,checkIfGivenDateIsTomorrow:lh,checkIfGivenDateIsYesterday:nae,checkIfMonthsAreTheSame:r0,convertUtcDateToUtcWithOffset:nh,formatDate:Ks,formatDateTime:K$,formatDateTimeIntervalWithFixedTimezone:X$,formatDateTimeIntervalWithTimeZone:Q$,formatDateTimeWithTimeZone:Hb,formatDateWithFixedTimezone:yt,formatDateWithTimeZone:So,formatDayOfWeekIso:gd,formatInterval:Wh,formatTime:q$,formatTimeIntervalWithTimeZone:z$,formatTimeWithTimeZone:$b,genDayRange:t0,genWeekRange:Kre,getClientLocalTimeZoneId:ih,getDateFromIso:QI,getDateFromTimestamp:Jre,getDateLibraryObjectFromIso:eae,getDiffInDays:fy,getEarliestDate:Wre,getFirstDayOfWeekCrossingBeginningOfMonth:Qre,getFirstDayOfWeekIndex:qre,getFormattedIntervalDates:Vre,getIsoDateFromDatetime:s0,getIsoFromTimestamp:Vb,getIsoNow:Ll,getLastDayOfWeekCrossingEndOfMonth:Xre,getMillisecondsSinceUnixEpoch:le,getMillisecondsSinceUnixEpochFromTimestamp:Zre,getNativeDate:tae,getTimeZoneOffset:sA,getTimestampFromIso:rh,getUtcIso:n0,isDateAfter:oh,isTimeZoneIdValid:ah,setLocale:o0,subtractDate:Kh,subtractDays:J$,subtractMonths:Yre,toUtcIso:Ey},Symbol.toStringTag,{value:"Module"})),Ed=({retailerSettings:e})=>e["default-time-zone"],Vt=({data:e,retailerSettings:t})=>t[`display-format-${e.locale.active}-momentjs-time`]||vn,oae=({data:e,retailerSettings:t})=>t[`display-format-${e.locale.active}-momentjs-time-range-start`],rae=({data:e,retailerSettings:t})=>t[`display-format-${e.locale.active}-momentjs-time-range-end`],Wb=V(Vt,oae,rae,(e,t,n)=>!t||!n?{startFormat:e,endFormat:e}:{startFormat:t,endFormat:n}),da=({data:e,retailerSettings:t})=>t[`display-format-${e.locale.active}-momentjs-date-numerical`]||F$,Jt=({data:e,retailerSettings:t})=>t[`display-format-${e.locale.active}-momentjs-date-descriptive`]||Xo,aae=({data:e,retailerSettings:t})=>t[`display-format-${e.locale.active}-momentjs-datetime-descriptive`]||YI,a0=({data:e,retailerSettings:t})=>t[`display-format-${e.locale.active}-momentjs-month-of-year`]||$$,pi=({data:e,retailerSettings:t})=>t[`display-format-${e.locale.active}-currency-format`]||"",iae=V(({retailerSettings:e})=>e["validation-customer-details-form-definition"],e=>{if(!e)return[];try{return JSON.parse(decodeURIComponent(e))}catch{return[]}}),lae=({retailerSettings:e})=>e["validation-mobile-phone-number-mask-frontend"],dp=({retailerSettings:e})=>e["validation-chars-allowed"],qb=({retailerSettings:e})=>e["validation-postal-code-mask"],cae=({retailerSettings:e})=>e["customer-account-external-management-return-redirect-web-url"],dae=({retailerSettings:e})=>e["customer-account-external-management-url"],uae=({retailerSettings:e})=>e["customer-promise-price-and-promotions-strategy"],qe=({retailerSettings:e},t)=>e[t],i0=({retailerSettings:e})=>Number(e["basket-max-quantity-per-product"]??0),pae=V(({retailerSettings:e})=>e["slot-booking-slot-time-font-size"],({retailerSettings:e})=>e["slot-booking-slot-time-font-weight"],(e,t)=>({fontSize:e,fontWeight:t})),mae=V(({retailerSettings:e})=>e["required-user-info-marketing-prefs"],e=>e?.split(",").map(t=>t.trim())||[]),ZI=({retailerSettings:e})=>e["orders-display-fiscal-invoice-form-url"],l0=({retailerSettings:e})=>e["orders-display-hide-external-orders-alert"]==="true",hae=({retailerSettings:e})=>e["use-by-date-short-year-web"]||B$,gae=({retailerSettings:e})=>e["use-by-date-short-weekday-web"]||U$,Eae=({retailerSettings:e})=>e["pop-up-banner-page-count-to-reset"],fae=({retailerSettings:e})=>e["psps-to-save-payment-method"]==="true",yae=({retailerSettings:e})=>e["psps-show-checkout-complete-invoice-icon"]==="true",io=V(({retailerSettings:e})=>e["images-formats"],e=>e?.split(",").map(t=>t.trim())??[]),Kb=({retailerSettings:e})=>e["infinite-scroll-server-side-fop-decoration-limit"]||"50",Iae=({retailerSettings:e})=>({iosAppId:e["smart-banners-ios-app-id"],iosCustomScheme:e["smart-banners-ios-custom-scheme"],iosIconUrl:e["smart-banners-ios-icon-url"],iosAppStoreUrl:e["smart-banners-ios-app-store-url"],iosAppTeamId:e["smart-banners-ios-app-team-id"],iosAppBundleId:e["smart-banners-ios-app-bundle-id"],androidPackageName:e["smart-banners-android-package-name"],androidCustomScheme:e["smart-banners-android-custom-scheme"],androidIconUrl:e["smart-banners-android-icon-url"],androidAppFallbackUrl:e["smart-banners-android-fallback-url"],appTitle:e["smart-banners-app-title"],appAuthor:e["smart-banners-app-author"],hideTTL:e["smart-banners-hide-ttl"],visiblePages:e["smart-banners-visible-pages"]}),Sae=({retailerSettings:e})=>Number(e["basket-max-number-items"]||1e3),Cae={enabledFeatures:[]},Tae=(e=Cae)=>e,zh=e=>e.session.features.enabledFeatures,D=e=>V(zh,t=>t.some(n=>n===e)),Dn=e=>V(zh,t=>e.some(n=>t.includes(n))),vo=e=>V(zh,t=>e.every(n=>t.includes(n))),mn="@@router/LOCATION_CHANGE",_ae=(e,t,n=!1)=>({type:mn,payload:{location:e,action:t,isFirstRendering:n}}),oj=e=>{if(e&&e.query)return e;const t=e&&e.search;if(typeof t!="string"||t.length===0)return{...e,query:{}};const r=t.substring(1).split("&").reduce((a,i)=>{const[l,c]=i.split("=");return{...a,[l]:c}},{});return{...e,query:r}},vae=(e,t)=>t?.length&&e.startsWith(t)?e.replace(t,"")||"/":e,Aae=({basePath:e,initialLocation:t,initialAction:n})=>{const o={location:oj({pathname:vae(t.pathname,e),search:t.search??"",hash:"",key:"default",state:null}),action:n??Uoe.Pop};return(r=o,{type:a,payload:i}={})=>{if(a===mn){const{location:l,action:c,isFirstRendering:d}=i;return d?r:{...r,location:oj(l),action:c}}return r}},Sf={error:null,fetchError:!1,isFetching:!1},Cf={selectedItems:[],refundValueBreakdown:{taxComponents:[],net:null,gross:null,displayAmount:null},...Sf},nA={newRefundRequest:{regionId:"",availableItems:[],refundReasonsPerCategory:[],...Sf},summary:Cf,createdRefundRequest:{anyItemAvailableForRefund:!1,newRefundRequestCreationCutoff:"",regionId:"",requestedItems:[],...Sf},placeRefundRequest:{refundRequestId:null,expectedRequestReviewTime:null,...Sf}},Re={isFetching:!1,fetchError:!1,didInvalidate:!1,lastUpdated:null},ns={benefits:{...Re,currentSubscription:{...Re}},customerDeliveryPassSubscription:{...Re},menuCampaigns:{...Re},checkoutWalk:{...Re,data:{}},orders:{all:{...Re,retentionPeriod:"",orders:[]},pending:{...Re,orders:[]},past:{...Re,retentionPeriod:"",nextPageToken:"",orders:[]},current:{order:{...Re},refunds:nA,loyalty:{...Re}},failedPayments:{...Re,orders:[]},recurring:{definitions:{...Re}},orderEntities:{lastUpdated:null}},addWalletItemModal:{},footer:{...Re,links:{sections:[],contact:"",social:[],feedback:""}},contentBlocks:{...Re,blocks:[]},advertisingBanners:{...Re},customer:{addresses:{...Re,data:[]},addressFields:{...Re,formSection:{title:"",fields:[]}},addressDetails:{...Re,data:{}},billingAddress:{...Re},addressValidation:{...Re,data:{formattedAddress:"",id:"",additionalInformation:""}},segments:{...Re}},addressLookup:{metadata:{...Re}},favorite:Re,bop:{details:{...Re}},products:{alternatives:{...Re,data:{}},catalogue:{...Re},offers:{...Re,data:{promotionPageType:"UNKNOWN",sortOptions:[],promoId:"",retailerPromotionId:"",description:"",promotionGroups:[{products:[],quantity:0}]}},productEntities:{},missedPromotions:[]},wallet:{...Re,items:[]},theme:{...Re},retailer:{addressFields:{...Re}},search:{suggestions:{...Re,data:[],smartSearchSuggestions:null,isSearchPage:!1},redirects:{...Re}},topTabs:{...Re,data:[]},shopInShop:{html:"",productIds:[],isFetching:!1},recipes:{homePageComponents:{...Re},homePage:{...Re},searchPage:{...Re},collectionDetailsPage:{...Re},savedRecipesPage:{...Re}},recommendedProducts:{...Re},toggleablePromotions:Re},ee=e=>({DISPATCH:`${e}_DISPATCH`,PENDING:`${e}_PENDING`,SUCCESS:`${e}_SUCCESS`,ERROR:`${e}_ERROR`,ABORT:`${e}_ABORT`}),JI="PAGE_PART_VIEW_CHANGE",c0="APP_MOUNTED",d0="USER_JUST_LOGGED_IN",u0="CLEAR_USER_JUST_LOGGED_IN",p0="SET_CLIENT_ROUTE_ID",m0="SET_HAS_PAGE_BEEN_HIDDEN",Tf=ee("GET_RETAILER_CUSTOMER_ID"),_f=(e,t)=>({type:JI,payload:{location:e,pagePartType:t}}),bae=()=>({type:c0}),xae=(e=!1)=>({type:d0,payload:{withRegistration:e}}),Rae=()=>({type:u0}),h0=e=>({type:"API",payload:{url:`/customer/v3/customers/${e}/customerRetailerId`,service:"web_customer_ws",...Tf}}),Dae=()=>({type:p0}),a_=e=>({type:m0,payload:{hasPageBeenHidden:e}}),Oae={...Re,locationChangeCount:0,isFullPageLoad:!0,isServerRendered:!1,hasPageBeenHidden:!1,reportingLevel:0,assetVersion:"",environment:"",bannerId:"",bannerName:"",regionId:"",clientRouteId:"",requestId:"",visitorId:"",fqdn:"",userJustLoggedIn:!1,userJustRegistered:!1},g0={CENTRALIZED:"CENTRALIZED",STORE:"STORE"},Pae=(e=Oae,t)=>{switch(t.type){case mn:return{...e,pageViewId:vt(),locationChangeCount:e.locationChangeCount+1,isFullPageLoad:e.locationChangeCount===0};case JI:return{...e,pageViewId:vt()};case m0:return{...e,hasPageBeenHidden:t.payload.hasPageBeenHidden};case p0:return{...e,clientRouteId:vt()};case c0:return{...e,isServerRendered:!1};case d0:return{...e,userJustLoggedIn:!0,userJustRegistered:t.payload.withRegistration};case u0:return{...e,userJustLoggedIn:!1,userJustRegistered:!1};case Tf.PENDING:return{...e,isFetching:!0,fetchError:!1};case Tf.ERROR:return{...e,isFetching:!1,fetchError:!0,retailerCustomerId:void 0};case Tf.SUCCESS:return{...e,isFetching:!1,fetchError:!1,retailerCustomerId:t.payload.responseData.customerRetailerId};default:return e}},Kl=({session:e})=>e.metadata.sessionId,Yt=({session:e})=>e.metadata.isServerRendered,rr=({session:e})=>e.metadata.customerId,ua=({session:e})=>e.metadata.retailerCustomerId,up=({session:e})=>e.metadata.visitorId,hn=({session:e})=>e.metadata.regionId,ar=({session:e})=>e.metadata.retailerRegionId,eS=({session:e})=>e.metadata.regionName,tS=({session:e})=>e.metadata.requestId,ja=({session:e})=>e.metadata.bannerId,Qh=({session:e})=>e.metadata.retailerBannerId,fd=({session:e})=>e.metadata.bannerName,zb=({session:e})=>e.metadata.contentExperienceUserId,Qi=({session:e})=>e.metadata.bannerBusinessModel,Nae=V(Qi,e=>e===g0.CENTRALIZED),Lae=V(Qi,e=>e===g0.STORE),On=({session:e})=>e.metadata.pageViewId,kae=({session:e})=>e.metadata.serverLoadTime,Mae=({session:e})=>e.metadata.userJustLoggedIn,jae=({session:e})=>e.metadata.userJustRegistered,sS=({session:e})=>e.metadata.isFullPageLoad,E0=({session:e})=>e.metadata.locationChangeCount,wa=({session:e})=>e.metadata.clientRouteId,nS=({session:e})=>e.metadata.fqdn,Wt=e=>e?.session?.metadata?.basePath,oS=e=>e?.session?.metadata?.assetVersion,wae=e=>e.session.metadata.environment,f0=e=>e?.session?.metadata?.hasPageBeenHidden,y0=({session:e})=>e.metadata.reportingLevel,Ho=({session:e})=>({basePath:e.metadata?.basePath,clientRouteId:e.metadata?.clientRouteId,requestId:e.metadata?.requestId,csrfToken:e.csrf?.token}),Fae=.1,Bae=e=>{const t={collectorURL:qe(e,"grafana-faro-web-url"),includePII:qe(e,"grafana-faro-include-pii")==="true",samplingRate:Fae},n=[],o=qe(e,"grafana-faro-sampling-rate"),r=Number(o||"NaN");return isNaN(r)?n.push(new Error(`Invalid setting 'grafana-faro-sampling-rate': '${o}'`)):t.samplingRate=r,[t,n]},Uae=e=>{if(!D("faro")(e))return;const[t,n]=Bae(e),o=t.includePII?{id:rr(e)}:void 0,r=Goe({url:t.collectorURL,instrumentations:[...$oe(),new Hoe({router:Voe({matchRoutes:A$})})],app:{name:"webuniversal",version:oS(e),environment:wae(e)},sessionTracking:{samplingRate:t.samplingRate,session:{attributes:{bannerId:ja(e),bannerName:fd(e)}}},user:o});n.forEach(a=>{r.api.pushError(a)})};Uae(window.__INITIAL_STATE__);const Gae="default"in o_?o_.default:o_,rj={api:{pushError:()=>{},pushLog:()=>{},pushTraces:()=>{},pushEvent:()=>{},pushMeasurement:()=>{},changeStacktraceParser:()=>{},getStacktraceParser:()=>{},getOTEL:()=>{},getTraceContext:()=>{},initOTEL:()=>{},isOTELInitialized:()=>!1,setUser:()=>{},resetUser:()=>{},getPage:()=>{},setPage:()=>{},setSession:()=>{},resetSession:()=>{},getSession:()=>{},setView:()=>{},getView:()=>{}},instrumentations:{add:()=>{},remove:()=>{},instrumentations:[]},metas:{add:()=>{},remove:()=>{},addListener:()=>{},removeListener:()=>{},value:{}},transports:{add:()=>{},addBeforeSendHooks:()=>{},execute:()=>{},getBeforeSendHooks:()=>[],isPaused:()=>!1,remove:()=>{},removeBeforeSendHooks:()=>{},transports:[],pause:()=>{},unpause:()=>{}},config:{app:{},dedupe:!1,globalObjectKey:"",instrumentations:[],internalLoggerLevel:0,isolate:!1,metas:[],parseStacktrace:()=>({frames:[]}),paused:!1,preventGlobalExposure:!1,transports:[],unpatchedConsole:console},internalLogger:{debug:()=>{},error:()=>{},info:()=>{},prefix:"",warn:()=>{}},unpatchedConsole:console,pause:()=>{},unpause:()=>{}},Me=new Proxy(rj,{get(e,t,n){const o=tj?.config?.app?.name?tj:rj;return Reflect.get(o,t,n)}}),$ae=e=>{switch(e.keyword){case"required":return`Missing required field: ${e.params.missingProperty}`;case"type":return`Invalid type at "${e.instancePath||"/"}". Expected ${e.params.type}.`;case"enum":return`Invalid value at "${e.instancePath||"/"}". Must be one of: ${e.params.allowedValues.join(", ")}.`;case"minLength":return`Value at "${e.instancePath||"/"}" is too short. Minimum length is ${e.params.limit}.`;case"maxLength":return`Value at "${e.instancePath||"/"}" is too long. Maximum length is ${e.params.limit}.`;case"pattern":return`Value at "${e.instancePath||"/"}" does not match the required format.`;default:return e.message||`Validation error at "${e.instancePath||"/"}".`}},I0=e=>{try{e.forEach(t=>{if(t&&typeof t=="object"&&"event"in t){const n=t.event;Yoe.googleAnalyticsEventHandler(n,t).forEach(r=>{const a=new Error(`GA-INVALID:${n}`),i=$ae(r);i&&Me.api.pushError(a,{context:{validationError:i}})})}})}catch(t){const n=t instanceof Error?t:new Error(`handleGaValidation error: ${JSON.stringify(t)}`);Me.api.pushError(n)}},Hae={error:null,fetchError:!1,isFetching:!1,lastUpdated:null,didInvalidate:!1},Vae={errorCheckoutBasket:null,fetchErrorCheckoutBasket:!1,isFetchingCheckoutBasket:!1,lastCheckoutBasketUpdated:null},Yae={isVoucherError:!1,isVoucherFetching:!1},Wae={...Hae,...Vae,...Yae},qae={ageRestriction:null,appliedPaymentChecks:null,checkout:{basketAboveThreshold:!1,canCheckout:!1,minimumCheckoutThreshold:{amount:"0",currency:"GBP"},shippingGroupType:"",shippingGroupTypeDisplayName:""},basketId:null,basketStatus:null,bufferRate:null,carrierBag:null,delivery:null,deliveryDestinationId:null,deliveryPriceModificationLevels:null,deliveryPromotions:[],invoice:null,items:[],loyalty:null,orderId:null,checkoutCorrelationId:null,activeCheckoutGroupId:null,orderLevelPromotions:[],preparation:null,regionId:null,remainingTimeToEditInMillis:null,removedPaymentChecks:null,slot:null,smallOrder:null,defaultSlot:null,nextAvailableSlot:null,unavailableData:[],checkoutGroups:[],unassignedItems:[],variablePrice:!1,vouchers:[]},Do={...Wae,...qae},jt=({basePath:e=""}={})=>`${e}/basket`,S0=({basePath:e="",shippingGroupType:t="",showErrorIfShippingGroupDoesntExist:n=!1}={})=>`${jt({basePath:e})}?error=below-minimum-spend${t?`&errorShippingGroupType=${t}`:""}${n?"&showError=true":""}`,lo=()=>"/orders",Kae=(e,t)=>`${lo()}/recurring-shopping/definitions/${e}/scheduled/${t}`,gn=(e,t,n="")=>{const o=t?`?${t}`:"";return`${n}${lo()}/${e}/details${o}`},C0=e=>`/api/receipts/v1/orders/${e}/receipt.pdf`,T0=/orders\/\d+\/details/,_0=D("logmod"),zae=D("logmod.dest"),Qae=D("asi"),Xae=D("asi.m"),Ze=e=>e.session.isLoggedIn,mi=({basePath:e="",queryString:t=""}={})=>`${e}/delivery${t}`,Qb=(e="")=>`${mi({basePath:e})}/home`,Xb=(e="")=>`${mi({basePath:e})}/collection`,yd=(e="")=>`${Qb(e)}/slots`,pp=(e="")=>`${Xb(e)}/slots`,Zae=()=>"/slots",kr=({basePath:e="",queryString:t=""}={})=>`${e}/checkout${t?`?${t}`:""}`,tr=({basePath:e="",queryString:t=""}={})=>`${kr({basePath:e})}/summary${t?`?${t}`:""}`,Jae=({basePath:e=""}={})=>`${kr({basePath:e})}/3ds`,Zb=({basePath:e="",queryString:t=""}={})=>{const n=t?`?${t}`:"";return`${Jae({basePath:e})}/continue${n}`},Xh=({pageKey:e="",queryString:t="",basePath:n=""}={})=>`${kr({basePath:n})}/checkout-walk/${e}${t?`?${t}`:""}`,Zh=(e={})=>{const t=e.orderId?`?orderId=${e.orderId}`:"";return`${kr({basePath:e.basePath})}/complete${t}`},eie=({basePath:e=""}={})=>`${kr({basePath:e})}/3ds`,sr=({basePath:e="",inCheckoutWalk:t=!1,shippingGroupType:n="",directDeliveryMethod:o=void 0,searchParams:r=new URLSearchParams,isContinue:a=!1}={})=>{let i=mi({basePath:e});return o==="HOME_DELIVERY"&&(i=yd(e)),o==="CUSTOMER_COLLECTION"&&(i=pp(e)),r.set("in-checkout-walk",`${t}`),n&&r.set("shippingGroup",n),t&&a&&r.set("continue",`${a}`),`${i}?${r.toString()}`},v0=ee("GET_ACTIVE_SESSION"),tie=e=>({type:"API",payload:{url:tt.stringifyUrl({url:"/v2/sessions/active",query:{...e&&{regionId:e}}}),pathPrefix:{client:"/api/customersessions",server:"/core-api"},service:"customersessions",...v0}}),oA={getActiveSession:tie,types:{GET_ACTIVE_SESSION:v0}},sie=()=>async(e,t)=>{let n=null;const o=t(),{regionId:r}=o.session.metadata;try{n=(await e(oA.getActiveSession(r)))?.payload?.responseData}catch(a){Me.api.pushError(new Error("CustomerSession: Get active session call failed"),{context:{errorData:JSON.stringify(a,Object.getOwnPropertyNames(a))}})}return n},nie={getActiveSession:sie},oie={ORDER_EDIT:"ORDER_EDIT"},Wr={CART:"CART",CART_VIEW:"CART_VIEW",CHECKOUT_WALK:"CHECKOUT_WALK",CHECKOUT_SUMMARY:"CHECKOUT_SUMMARY"},rA={NULL:"NULL",ADDITION_TIME:"ADDITION_TIME",CATEGORIES:"CATEGORIES",SELLER:"SELLER"},A0=ee("GET_CART"),b0=ee("GET_CHECKOUT_CART"),x0=ee("UPDATE_CHECKOUT_CART"),rie=(e={})=>{const{withUpdatedItemsResponse:t,updatedItems:n,fetchAllocatedPaymentChecks:o,cartType:r,productGroupingType:a,location:i}=e;return{type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:tt.stringifyUrl({url:lie(r),query:die({fetchAllocatedPaymentChecks:o,location:i,productGroupingType:a})}),...A0},withUpdatedItemsResponse:t,updatedItems:n}},aie=({fetchAllocatedPaymentChecks:e,appliedPaymentCheckId:t}={fetchAllocatedPaymentChecks:!1,appliedPaymentCheckId:void 0})=>{const n="/v1/carts/active/checkout-summary",o={...e&&{fetchAllocatedPaymentChecks:e},...t&&{paymentCheckId:t}};return{type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:tt.stringifyUrl({url:n,query:o}),...b0}}},iie=({paymentMethodGroup:e,fetchAllocatedPaymentChecks:t=!1,appliedPaymentCheckId:n=void 0})=>{const o="/v1/carts/active/checkout-summary",r={...t&&{fetchAllocatedPaymentChecks:t},...n&&{paymentCheckId:n}};return{type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:tt.stringifyUrl({url:o,query:r}),options:{method:"PUT",body:{paymentMethodGroup:e}},...x0}}},en={getCart:rie,getCheckoutCart:aie,updateCheckoutCart:iie,types:{GET_CART:A0,GET_CHECKOUT_CART:b0,UPDATE_CHECKOUT_CART:x0}},lie=e=>{switch(e){case Wr.CART_VIEW:return"/v1/carts/active/cart-view";case Wr.CHECKOUT_WALK:return"/v1/carts/active/checkout-walk";case Wr.CHECKOUT_SUMMARY:return"/v1/carts/active/checkout-summary";case Wr.CART:default:return"/v1/carts/active"}},cie=(e={})=>{const{location:t,productGroupingType:n}=e,o=t?.pathname??"/";return n===rA.NULL?null:n||(o.endsWith(jt())||T0.test(o)?rA.CATEGORIES:null)},die=(e={})=>{const{fetchAllocatedPaymentChecks:t,location:n}=e,o=cie({location:n,productGroupingType:e?.productGroupingType});return{...o&&{productGroupingType:o},...t&&{fetchAllocatedPaymentChecks:t}}},aA=e=>t=>e?.find(n=>n?.productId===t?.productId)??t,Jh=({basket:e,updatedItems:t})=>({...e,items:e?.items?.map(aA(t))||[],checkoutGroups:e?.checkoutGroups?.map(n=>({...n,items:n?.items?.map(aA(t))}))||[]}),uie=e=>async(t,n)=>{const o=n(),r=Ze(o),a=e?.pathname??"/";return a.endsWith(jt())?Wr.CART_VIEW:r?T0.test(a)?(await t(nie.getActiveSession()))?.type===oie.ORDER_EDIT?Wr.CART_VIEW:Wr.CART:a?.startsWith(Xh())||new URLSearchParams(e?.search)?.get("in-checkout-walk")==="true"?Wr.CHECKOUT_WALK:a===tr()?Wr.CHECKOUT_SUMMARY:Wr.CART:Wr.CART},pie=(e,t)=>({orderId:e||t?.orderId||null}),R0=({productId:e,quantity:t,maxQuantityReached:n})=>({productId:e,quantity:{quantityInBasket:t,maxQuantityReached:n}}),aj=(e,t)=>{const n=t?.reduce((a,i)=>[...a,...i?.promoIds??[]],[])??[],r=(e?.delivery?.promotions||[]).filter(({promoId:a})=>!n.includes(a));return{carrierBag:e?.carrierBag?.finalPrice??null,delivery:e?.delivery?.price??null,preparation:e?.preparation?.finalPrice??null,invoice:e?.invoice?.finalPrice??null,smallOrder:e?.smallOrder?.finalPrice??null,deliveryPromotions:r}},mie=(e,t)=>e&&e==="ORDER_EDIT"&&t&&typeof Number(t)=="number"?t:null,hie=e=>{if(e){const{startTime:t,endTime:n,timeZoneId:o,slotId:r,...a}=e;return{nextAvailableSlot:{...a,slotId:r,start:Ge(t,Ge.ISO_8601).tz(o).format(),end:Ge(n,Ge.ISO_8601).tz(o).format(),utcStartTime:t,utcEndTime:n,timeZoneId:o}}}return{nextAvailableSlot:null}},iA=e=>{if(!e)return null;const{startTime:t,endTime:n,addressDetails:o,...r}=e,a=e?.timeZoneId||"UTC";return{...r,...o,start:Ge(t,Ge.ISO_8601).tz(a).format(),end:Ge(n,Ge.ISO_8601).tz(a).format(),utcStartTime:t,utcEndTime:n}},ij=({checkout:e})=>{const t=e?.delivery;return{...e,...t&&iA(t)}},gie=e=>{const{checkoutGroups:t,...n}=e,{cartId:o,checkoutCorrelationId:r}=n,a=t?.assignedCheckoutGroups||[],i=t?.unassignedProducts||[];return{checkoutGroups:a.map(l=>ti({cartId:o,checkoutCorrelationId:r,...l})),unassignedItems:i.map(R0)}},ti=e=>{const{bufferRate:t,cartId:n,orderId:o,checkoutCorrelationId:r,checkout:a,activeCheckoutGroup:i,defaultCheckoutGroup:l,regionId:c,items:d,itemGroups:u,charges:m,orderLevelPromotions:g,totals:f,vouchers:y,loyalty:I,cartStatus:S,unavailableData:C,remainingTimeToEditInMillis:_,ageRestriction:A,variablePrice:x,appliedPaymentChecks:R,removedPaymentChecks:O,deliveryDestinationId:N,deliveryPriceModificationLevels:k,pricingNotifications:j,nextAvailableSlot:w,smallOrderChargeThresholds:L,totalsGroups:B,sellers:W,paymentMethodGroup:$}=e,K=a||i||l;return{basketId:n??null,checkoutCorrelationId:r||null,activeCheckoutGroupId:i?.orderId||null,regionId:c??null,items:d?.map(R0)??[],...u&&{itemGroups:u},orderLevelPromotions:g??[],slot:iA(K?.delivery),defaultSlot:iA(l?.delivery),appliedPaymentChecks:R??null,removedPaymentChecks:O??null,loyalty:I??null,basketStatus:S??null,ageRestriction:A??null,variablePrice:x??!1,unavailableData:C??[],remainingTimeToEditInMillis:mie(S,_),bufferRate:t??null,deliveryDestinationId:N??null,deliveryPriceModificationLevels:k??null,pricingNotifications:j,vouchers:y||[],sellers:W||[],smallOrderChargeThresholds:L||[],totalsGroups:B?.map(Q=>({...Q,...aj(Q.charges,Q.vouchers),charges:void 0}))??[],...f&&{totals:f},...aj(m,y),...hie(w),...pie(o,K),...gie(e),...K&&{checkout:ij({checkout:K})},...l&&{defaultCheckout:ij({checkout:l})},paymentMethodGroup:$}},D0=e=>{if(e.type===en.types.GET_CART.SUCCESS||e.type===en.types.GET_CHECKOUT_CART.SUCCESS){const t=e?.payload?.responseData;return t?ti(t):null}return null},rS=[],Eie=(e=Do,t)=>{switch(t.type){case en.types.GET_CART.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case en.types.GET_CART.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case en.types.GET_CART.SUCCESS:{const n=t,o=n?.payload?.responseData;if(!o)return e;const r=ti(o),a=n?.updatedItems||[];return{...Do,...Jh({basket:r,updatedItems:a}),isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),limitedPromotionIds:e.limitedPromotionIds}}case en.types.GET_CHECKOUT_CART.PENDING:case en.types.UPDATE_CHECKOUT_CART.PENDING:return{...e,isFetchingCheckoutBasket:!0,fetchErrorCheckoutBasket:!1,errorCheckoutBasket:null};case en.types.GET_CHECKOUT_CART.ERROR:case en.types.UPDATE_CHECKOUT_CART.ERROR:return{...e,isFetchingCheckoutBasket:!1,fetchErrorCheckoutBasket:!0,errorCheckoutBasket:t.payload};case en.types.GET_CHECKOUT_CART.SUCCESS:case en.types.UPDATE_CHECKOUT_CART.SUCCESS:{const o=t?.payload?.responseData;if(!o)return e;const r=ti(o);return{...Do,...r,...r?.totals?.finalPrice&&{lastCheckoutBasketUpdated:le()},isFetchingCheckoutBasket:!1,fetchErrorCheckoutBasket:!1,errorCheckoutBasket:null,lastUpdated:le()}}default:return e}},hi=({data:e})=>e.basket,aS=V(hi,e=>e?.slot),fie=V(hi,e=>e?.slot?.expiryTime),Id=V(hi,e=>e?.items||rS),O0=V(Id,e=>e?.map(t=>t.productId));V(hi,e=>e?.limitedPromotionIds?.length?e.limitedPromotionIds:rS);const iS=V(hi,e=>e?.checkout?.shippingGroupType),mp=V(hi,e=>e?.basketStatus==="ORDER_EDIT"),Jb=V(hi,e=>e?.defaultCheckout?.shippingGroupType),Fa=V(hi,e=>e?.deliveryDestinationId);V(hi,e=>e.isFetching);const yie=V(hi,e=>e.isFetchingCheckoutBasket),P0=e=>!!e?.items?.length,Sd=e=>e.data.basket?.checkoutGroups?.filter(P0)||rS,Iie=(e,t)=>Sd(e).find(n=>n?.checkout?.shippingGroupType===t),ex=e=>e.data.basket?.sellers||rS,Sie=V(ex,e=>e?.map(t=>t.sellerId)),Et={clickAndCollect:{type:"C_N_C",id:"collection",method:"CUSTOMER_COLLECTION"},vanDelivery:{type:"BRANDED_VAN",id:"home",method:"HOME_DELIVERY"},jinn:{type:"JINN",id:"jinn",method:"JINN"}};p.shape({type:p.string,id:p.string,method:p.string});const hp=e=>{const t=e.deliveryMethod===Et.clickAndCollect.method,n=e.slotType==="STANDARD",o="deliveryTimeInMinutes"in e,r=e.start?.slice(0,10)!==e.end?.slice(0,10);return t&&n&&!o&&r},N0="BATCH_ADD_BASKET_ITEM",L0=ee("EMPTY_CART"),k0="BATCH_REMOVE_BASKET_ITEM",M0=ee("ADD_BASKET_ITEM"),j0=ee("REMOVE_BASKET_ITEM"),w0=ee("ADD_BASKET_FREE_GIFT_ITEM"),F0=ee("REMOVE_BASKET_FREE_GIFT_ITEM"),Cie=(e,t)=>({type:N0,productId:e,quantity:t}),Tie=(e,t)=>({type:k0,productId:e,quantity:t}),_ie=()=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:"/v1/carts/active/items",options:{method:"DELETE"},...L0}}),vie=e=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:"/v1/carts/active/add-items",options:{body:e,method:"POST"},...M0},items:e}),Aie=e=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:"/v1/carts/active/add-promoted-product",options:{body:{productId:e.productId,promotionId:e.promotionId,meta:e.meta},method:"POST"},...w0}}),bie=e=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:"/v1/carts/active/remove-items",options:{body:e,method:"POST"},...j0},items:e}),xie=e=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:"/v1/carts/active/remove-promoted-product",options:{body:{productId:e.productId,promotionId:e.promotionId},method:"POST"},...F0}}),Is={setBatchAdd:Cie,emptyCart:_ie,setBatchRemove:Tie,addBasketItems:vie,removeBasketItems:bie,addBasketFreeGiftItem:Aie,removeBasketFreeGiftItem:xie,types:{BATCH_ADD_BASKET_ITEM:N0,EMPTY_CART:L0,BATCH_REMOVE_BASKET_ITEM:k0,ADD_BASKET_ITEM:M0,REMOVE_BASKET_ITEM:j0,ADD_BASKET_FREE_GIFT_ITEM:w0,REMOVE_BASKET_FREE_GIFT_ITEM:F0}},tx=e=>e?.data?.basketSpeculation||{},Rie=({data:e})=>e.basketSpeculation?.items||[],Die=e=>e?.data?.basketSpeculation?.maximumInFlightRequests>1,Oie=e=>e.type===Is.types.ADD_BASKET_ITEM.ERROR||e.type===Is.types.REMOVE_BASKET_ITEM.ERROR||e.type===en.types.GET_CART.SUCCESS&&!!e.withUpdatedItemsResponse,Pie=(e,t)=>Oie(e)&&tx(t).currentInFlightRequests===1&&Die(t),Nie=e=>({...e.data.basket,items:Rie(e)}),Lie=V(tx,e=>e.currentInFlightRequests>=1||e.currentBouncedAddItemRequests===1||e.currentBouncedRemoveItemRequests===1),Zt=e=>Lie(e)?{...e.data.basket,...Nie(e)}:e.data.basket,B0=e=>Sd(e).find(n=>n.checkout?.shippingGroupType===Zt(e).checkout?.shippingGroupType),kie=({data:e})=>e.basket.remainingTimeToEditInMillis||null,zl=e=>Zt(e)?.items||[],lS=e=>Zt(e)?.itemGroups||[],gi=e=>zl(e).length>0,pa=({data:e})=>e.basket?.totals?.display?.itemPriceAfterPromos||null,sx=({data:e})=>e.basket?.totals?.display?.finalPrice||null,cS=({data:e})=>e.basket?.checkout?.minimumCheckoutThreshold||null,nx=({data:e})=>e.basket?.checkout?.basketAboveThreshold,ox=e=>!nx(e),eg=({data:e})=>e.basket.loyalty?.earnings||null,U0=e=>e?.unitsSpent&&e?.savings?{money:{...e.savings},units:e.unitsSpent}:null,Xi=e=>{const t=B0(e),n=t?t.loyalty:Zt(e).loyalty;return U0(n)},Mie=({data:e})=>e.basket.loyalty?.totalSavings||null,G0=e=>({data:t})=>{const o=t.basket?.totalsGroups?.find(r=>r.groupName===e)?.loyalty;return U0(o)},rx=({data:e})=>e.basket?.appliedPaymentChecks&&e.basket?.appliedPaymentChecks?.length>=1?e.basket?.appliedPaymentChecks:[],ax=e=>{const t=rx(e);return t?.length>=1&&t[0]||void 0},$0=({data:e})=>e.basket?.removedPaymentChecks&&e.basket?.removedPaymentChecks?.length>=1?e.basket.removedPaymentChecks:[],Cn=({data:e})=>e.basket.slot,jie=e=>{const{slotType:t,deliveryMethod:n}=Cn(e)||{};return t==="ON_DEMAND"&&n==="CUSTOMER_COLLECTION"},wie=V(Cn,e=>e&&hp(e)),Fie=V(jie,wie,(e,t)=>e||t),H0=e=>{const t=B0(e);return t?t.slot:Zt(e).slot},Bie=({data:e})=>e.basket.defaultSlot,Ql=V(D("bt.spl"),Cn,Bie,(e,t,n)=>e?n:t),V0=({data:e})=>e.basket?.unavailableData||[],Y0=e=>!!V0(e).length,W0=({data:e})=>e.basket?.totals?.savingsPrice||null,q0=({data:e})=>e.basket?.basketStatus,K0=e=>e.reduce((t,n)=>{const o=n.product.productId,r=t[o]||0,a=n.product.quantity||1;return t[o]=r+a,t},{}),tg=(e=[])=>e.reduce((t,{quantity:n})=>t+n.quantityInBasket,0),Uie=({data:e})=>e.basket?.totals?.paymentSplit?.remainingPayment,Gie=({data:e})=>e.basket?.pricingNotifications||[],dS=V(Cn,e=>e&&Object.keys(e).length>0||!1),j7t=V(Ql,e=>e&&Object.keys(e).length>0||!1),w7t=V(Ql,e=>e?.expiryTime?oh(Ll(),e.expiryTime):!1),$ie=V([Zt],e=>{const t=e.totalsGroups?.length;return t===void 0?!1:t>1}),ix=V(H0,e=>e&&Object.keys(e).length>0||!1),gp=V(zl,e=>tg(e)),Hie=V(W0,e=>e?.amount&&Number(parseFloat(e.amount.toString()))>0||!1),At=e=>V(Zt,t=>t?.orderId)(e),uS=(e,t)=>V(zl,n=>n.filter(o=>o.productId===t)[0])(e),Vie=()=>V(uS,e=>e&&e.quantity&&e.quantity.quantityInBasket||0),lx=Vie(),Mr=V(q0,e=>e==="ORDER_EDIT");V(e=>Zt(e),e=>{const[t]=e?.vouchers||[];return t?.voucherId});V(e=>Zt(e),e=>e?.delivery?.amount??null);const Fo=V(e=>Zt(e),e=>e?.activeCheckoutGroupId||null);V(e=>Zt(e),e=>e?.checkoutCorrelationId||null);const Yie=V(e=>Zt(e),e=>e?.vouchers||[]),Wie=V(e=>Zt(e),e=>e?.lastUpdated),cx=V(e=>Zt(e),e=>e?.paymentMethodGroup?.paymentMethodGroupId),qie=V(e=>Zt(e),e=>e?.paymentMethodGroup?.financingProviderId),Kie=V(e=>Zt(e),e=>e?.isVoucherFetching),zie=new To.Entity("address",void 0,{idAttribute:e=>e.address.addressId}),Qie=[zie],lA=new To.Entity("categories",{},{idAttribute:"categoryId",processStrategy:e=>({name:e.name,id:e.categoryId,retailerId:e.retailerCategoryId,children:e.childCategories})}),Xie=[lA];lA.define({children:[lA]});const au=new To.Entity("product",{},{idAttribute:e=>e.productId}),Zie=new To.Entity("order",{substitutedItems:[{product:au,substitutes:[{product:au}]}],missingItems:[{product:au}],returnedItems:[{product:au}],items:[{product:au}],itemsOnCheckout:[{product:au}]},{idAttribute:e=>e.orderId}),z0=new To.Entity("order",{},{idAttribute:e=>e.orderId}),Jie=[z0],dx=new To.Entity("product",void 0,{idAttribute:"productId"}),ele=new To.Object({productGroups:[{products:[new To.Entity("product",void 0,{processStrategy:e=>e.product,idAttribute:"productId"})]}]}),tle=[dx],Q0=new To.Object({promotionGroups:[{products:[dx]}]}),sle=new To.Object({productGroups:[{products:[new To.Entity("product",void 0,{idAttribute:"productId"})]}]}),nle=new To.Object({pages:[sle]}),ole=new To.Entity("products",void 0,{idAttribute:"productId"}),rle=new To.Entity("productList",{products:[ole]},{idAttribute:"listId"}),X0=new To.Entity("productList",void 0,{idAttribute:"listId"}),ale=new To.Array(X0),Zi=Object.freeze(Object.defineProperty({__proto__:null,addressesSchema:Qie,categoriesSchema:Xie,checkoutWalkSchema:nle,decoratedOrderSchema:Zie,decoratedProductListSchema:rle,offerPageSchema:Q0,orderSchema:z0,ordersSchema:Jie,productArraySchema:tle,productGroupsSchema:ele,productListSchema:X0,productListsSchema:ale,productSchema:dx},Symbol.toStringTag,{value:"Module"})),Ji=Object.freeze(Object.defineProperty({__proto__:null,denormalize:Woe,normalize:b$},Symbol.toStringTag,{value:"Module"})),Z0=ee("GET_PENDING_ORDERS"),J0=()=>({type:"API",payload:{url:"/v6/orders/pending",service:"web_order_ws",pathPrefix:{client:"/api/order",server:"/core-api"},...Z0}}),e1="SET_PENDING_ORDERS",t1=e=>({type:"SET_PENDING_ORDERS",payload:e}),vf={getPendingOrders:J0,setPendingOrders:t1,actionTypes:{GET_PENDING_ORDERS:Z0,SET_PENDING_ORDERS:e1}},{denormalize:ile}=Ji,{ordersSchema:lle}=Zi,cle=(e=ns.orders.pending,t)=>{switch(t.type){case vf.actionTypes.GET_PENDING_ORDERS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case vf.actionTypes.GET_PENDING_ORDERS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case vf.actionTypes.GET_PENDING_ORDERS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),orders:t.payload.responseData.result};default:return e}},Xl=V(e=>e.data.orders.pending,e=>e.data.orders.orderEntities,(e,t)=>{const n=ile(e.orders,lle,{order:t});return{...e,orders:n.includes(void 0)?[]:n}}),dle="UNDER_EDIT",s1=V(Xl,e=>(e.orders.find(t=>t.editStatus===dle)||{}).orderId||null),Cd=V(s1,e=>!!e),n1="SET_SELECTED_ADDRESS",ule=e=>({type:n1,selectedAddress:{addressId:e?.addressId||null,deliveryDestinationId:e?.deliveryDestinationId||null}}),ea={setSelectedAddress:ule,types:{SET_SELECTED_ADDRESS:n1}},o1="SET_SELECTED_DELIVERY_DESTINATION_ID",ple=(e=null)=>({type:o1,selectedDeliveryDestinationId:e}),r1={setSelectedDeliveryDestinationId:ple,types:{SET_SELECTED_DELIVERY_DESTINATION_ID:o1}},mle=(e=null,t)=>{switch(t.type){case r1.types.SET_SELECTED_DELIVERY_DESTINATION_ID:return t.selectedDeliveryDestinationId;case ea.types.SET_SELECTED_ADDRESS:return t.selectedAddress.deliveryDestinationId;default:return e}},uo=({control:e,router:t})=>e.delivery.selectedDeliveryDestinationId||t.location.query?.deliveryDestinationId,hle=(e,t)=>e&&t,gle=(e,t,n)=>e&&t&&!n,sg=V(D("dds"),D("dds.t"),Ze,(e,t,n)=>hle(e,n)||gle(e,t,n)),Zl=D("dds.plus"),Ele=D("dds.hup"),Qs=({data:e})=>e.delivery.destinations.selectedDeliveryDestination;V(Qs,e=>e.data?.deliveryType);const a1=V(Qs,e=>e.data?.deliveryMethod),ma=V(uo,Qs,(e,t)=>e??t.data?.deliveryDestinationId),Ei=({data:e})=>e.delivery.destinations.homeDelivery,Jl=({data:e})=>e.delivery.destinations.customerCollection,ux=D("homedel"),i1=D("cncdel"),fle=e=>e.data.basket.deliveryDestinationId,el=e=>e?.deliverability==="DELIVERABLE",pS=V(Qs,e=>el(e.data));V(Ei,({data:e})=>[...new Set(Object.values(e).map(({resolvedRegionId:t})=>t))]);V(Ei,({lastUpdated:e})=>e);V(Jl,({data:e})=>[...new Set(Object.values(e).map(({resolvedRegionId:t})=>t))]);V(Jl,({lastUpdated:e})=>e);const px=V(Ei,({data:e})=>e?Object.values(e):[]),mx=V(px,e=>e.filter(t=>el(t))),l1=({data:e})=>e.delivery.destinations.supportedPropositions,c1=({data:e})=>e.delivery.supportedDeliveryMethods,d1=({data:e})=>e.delivery.supportedDeliveryMethods.data,yle=V(d1,e=>e.length),Ile=(e,t)=>{const n=i1(e),o=ux(e);return n&&t===Et.clickAndCollect.method||o&&t===Et.vanDelivery.method},u1=e=>{const t=a1(e);if(t&&pS(e)&&Ile(e,t))return t},xs=e=>p1(e)||u1(e)||Sle(e),Sle=e=>ux(e)?Et.vanDelivery.method:Et.clickAndCollect.method,p1=V(e=>e.router.location,e=>{if(!e||!e.pathname)return;const t=o=>e.pathname.indexOf(o)>-1;if(t(Xb()))return Et.clickAndCollect.method;if(t(Qb()))return Et.vanDelivery.method;const n=tt.parse(e.search);return Object.values(Et).find(o=>o.type===n.type||o.method===n.deliveryMethod)?.method}),hx=V(xs,e=>Object.values(Et).find(t=>t.method===e)?.type),Cle={"^/settings/user-details$":"CUSTOMER_DETAILS","^/settings/login-details$":"LOGIN_DETAILS","^/settings/language$":"LANGUAGE","^/settings/addresses$":"ADDRESS_BOOK","^/settings/delivery-pass$":"DELIVERY_PASS_SETTINGS","^/settings/loyalty$":"LOYALTY","^/settings/wallet$":"WALLET","^/settings/marketing$":"MARKETING_PREFERENCES"},Tle={"^/basket$":"SMART_BASKET"},_le={"^/products/[^/]*/details$":"BOP","^/products/[^/]*/[^/]*$":"BOP","^/products(/?)/[^/search]*$":"BOP"},vle={"^/products$":"SHOP_PRODUCTS","^/categories":"SHOP_PRODUCTS","^/favorites$":"FAVORITES","^/promotions":"PROMOTIONS"},lj={"^/products$":"ALL_SHOP_PRODUCTS","^/products(\\?.*)(sublocationId)(.*)":"SHOP_PRODUCTS","^/categories$":"ALL_SHOP_PRODUCTS","^/categories/.*":"SHOP_PRODUCTS","^/favorites":"FAVORITES","^/promotions$":"ALL_PROMOTIONS","^/promotions/.*":"PROMOTIONS","^/promotions?(.*)([&]?)(sublocationId)([&]?)(.*)":"PROMOTIONS"},Ale={"^/checkout/summary$":"ORDER_SUMMARY","^/checkout/complete$":"ORDER_CONFIRM","^/checkout/3ds$":"THREE_D_SECURE_FRAME","^/checkout/checkout-walk/([^/?]*)[^/]*$":"CHECKOUT_WALK"},ble={"^/cookie-policy$":"COOKIE_POLICY"},m1="HOME_DELIVERY_SLOTBOOKING",h1="COLLECT_SLOTBOOKING",g1="EDIT_ORDER_HOME_DELIVERY_SLOTBOOKING",E1="EDIT_ORDER_COLLECT_SLOTBOOKING",xle="DEFAULT_METHOD_SLOTBOOKING",Rle="EDIT_ORDER_DEFAULT_METHOD_SLOTBOOKING",f1="^/out-of-stock$",y1={"^/delivery$":"DELIVERY_TYPE_SELECTION","^/delivery/home$":"HOME_DELIVERY_ADDRESS_SELECT","^/delivery/collection$":"COLLECT_ADDRESS_SELECT","^/delivery/home/slots$":m1,"^/delivery/collection/slots$":h1,[f1]:"SLOT_RESERVATION","^/orders/[^/]*/delivery$":"EDIT_ORDER_DELIVERY_TYPE_SELECTION","^/orders/[^/]*/delivery/home$":"EDIT_ORDER_HOME_DELIVERY_ADDRESS_SELECT","^/orders/[^/]*/delivery/collection$":"EDIT_ORDER_COLLECT_ADDRESS_SELECT","^/orders/[^/]*/delivery/home/slots$":g1,"^/orders/[^/]*/delivery/collection/slots$":E1},Dle={"^/delivery-pass/subscription$":"DELIVERY_PASS_SUBSCRIPTION","^/subscription/reauth$":"DELIVERY_PASS_SETTINGS","^/delivery-pass/benefit-group-selection$":"BENEFIT_GROUP_SELECT","^/delivery-pass/subscription[^/]*$":"DELIVERY_PASS_SUBSCRIPTION","^/delivery-pass/subscription/complete":"DELIVERY_PASS_SUBSCRIPTION_3DS_COMPLETE","^/delivery-pass/complete":"DELIVERY_PASS_3DS_COMPLETE"},Ole={"^/$":"HOMEPAGE"},Ple={"^/smart-shop":"INSTANT_SHOP"},Nle={"^/orders/[^/]*/refund-request":"REFUNDS"},Lle={"^/orders/recurring-shopping/definitions/[^/]*/scheduled/[^/]*$":"UPCOMING_ORDER","^/orders$":"ORDERS"},kle={"^/failed-payment/[^/]*$":"FAILED_PAYMENT","^/failed-payment/[^/]*/3ds$":"FAILED_PAYMENT_3DS","^/failed-payment/[^/]*/complete$":"FAILED_PAYMENT_SUCCESS"},Mle={"^/offers/[^/]*$":"OFFERS","^/offers/[^/]*/[^/]*$":"OFFERS"},jle={"^/products/search$":"SEARCH","^/search$":"SEARCH"},wle={"^/lists$":"LISTS","^/lists/[^/]*$":"LIST_DETAILS"},Fle={"^/content/[^/]*$":"CONTENT_PAGE"},Ble={"^/addresses/add-address$":"ADD_ADDRESS","^/addresses/confirm-address":"CONFIRM_ADDRESS"},Ule={"^/regulars$":"REGULARS"},Gle={"^/shop-in-shop/[^/]*$":"SHOP_IN_SHOP"},fi=e=>Number(e)!==0?`-${e}`:e,dm=e=>e?e.replace(/./g,"*"):"",mS=e=>/^[A-Za-z0-9]+(\.[A-Za-z0-9]+){1,}$/.test(e),$le=/[^\p{L}\d]/gu,Hle=new RegExp($le),Co=e=>e&&e.replace(Hle," ").trim().replace(/ +/g,"-"),Vle=e=>e.split(/[?#]/)[0],Yle=e=>e.endsWith("/")?e.slice(0,-1):e,Wle=e=>e?.replace(/\s+/g," ").trim(),Am=(e,t,n="")=>{let o=n?Vle(n):e;return t&&(o+=`?language=${t}`),o},I1="fromCollectionsPage=true",Oo={RecipeHome:"RECIPES_HOMEPAGE",RecipeSearch:"RECIPES_SEARCH_PAGE",RecipeCollections:"RECIPES_COLLECTIONS_LIST",RecipeCollectionDetails:"RECIPES_COLLECTION_DETAILS",RecipeDetails:"RECIPE_DETAILS",ShopForIngredients:"RECIPE_SHOP_FOR_INGREDIENTS",SavedRecipes:"SAVED_RECIPES_PAGE"},gx=(e,t)=>{const n=decodeURIComponent(e);return t?.length?n.concat("?",t):n},Vu=e=>{const t=Array.isArray(e)?e[0]:e;return typeof t=="string"?t:void 0},yi={service:"ecomrecipes",pathPrefix:{client:"/api/recipes",server:"/core-api"}},qle={"^/recipes$":Oo.RecipeHome,"^/recipes/search-results$":Oo.RecipeSearch,"^/recipes/saved-recipes$":Oo.SavedRecipes,"^/recipes/[^/]+/[^/]+$":Oo.RecipeDetails,"^/recipes/[^/]+/[^/]+/ingredients$":Oo.ShopForIngredients,"^/recipes/collections$":Oo.RecipeCollections,"^/recipes/collections/[^/]+/[^/]+$":Oo.RecipeCollectionDetails},Kle={"^/meal-plan$":"MEAL_PLAN","^/meals$":"YOUR_MEALS"},zle={"^/product-range$":"PRODUCT_RANGE"},Qle={"^/coupons$":"COUPONS","^/coupons/[^/]*/[^/]*$":"COUPON_DETAILS"},cj={...Cle,...Tle,..._le,...vle,...Ale,...ble,...y1,...Dle,...Ole,...Ple,...Nle,...Lle,...kle,...Mle,...jle,...wle,...Fle,...Ble,...Ule,...Gle,...qle,...Kle,...zle,...Qle},Xle=Object.keys(y1).filter(e=>e!==f1),Zle=(e,t,n)=>{if(e.match("^(/orders/[^/]*)?/delivery$"))return n?Rle:xle;if(t==="CUSTOMER_COLLECTION")return n?E1:h1;if(t==="HOME_DELIVERY")return n?g1:m1},Jle=(e,t,n)=>{if(Xle.some(r=>e.match(r)))return Zle(e,t,n)},ece=(e,t,n)=>{if(n){const{search:o}=e,r=o.includes("sublocationId")?t.concat(o):t,a=Object.keys(lj).find(i=>r&&r.match(i));if(a)return lj[a]}},tce=(e,t)=>{if(e.match("^/orders/[^/]*/details$"))return t?"SMART_BASKET":"ORDER"},sce=(e,t,n,o,r)=>{const a=Jle(t,n,o);if(a)return a;const i=ece(e,t,r);if(i)return i;const l=tce(t,o);if(l)return l},nce="cluster",oce="favorite",rce="featured",ace="featured_cross_sell",S1="group",ice="personalized",C1="ungrouped",lce="missing",cce="substitutions",dce="returned",uce="delivered",pce="on_offer",T1="unknown",mce="inspiration_carousel",hce="shoppable_banner",gce="shop-for-ingredients",Ece="other",Lt={CLUSTER:nce,FAVORITE:oce,FEATURED:rce,FEATURED_CROSS_SELL:ace,GROUP:S1,PERSONALIZED:ice,UNGROUPED:C1,MISSING:lce,SUBSTITUTED:cce,RETURNED:dce,DELIVERED:uce,ON_OFFER:pce,UNKNOWN:T1,INSPIRATION_CAROUSEL:mce,SHOPPABLE_BANNER:hce,SHOP_FOR_INGREDIENTS:gce,OTHER:Ece},hS=[S1,C1,T1],Td=V([Wt,xs,Cd,D("aeptu"),(e,t)=>t],(e,t,n,o,r)=>{const{pathname:a}=r,i=a?.replace(e||"","")||"/",l=sce(r,i,t,n,o);if(l)return l;const c=Object.keys(cj).find(g=>i?.match(g));if(!c)return"UNDEFINED";const d=cj[c],m=i.match(c)?.[1];return m?`${d}_${qoe(m).toUpperCase()}`:d}),_1=e=>{const t=tt.parse(e.payload.location.search).source,n=e.payload.location.state&&decodeURIComponent(e.payload.location.state.source);return t||n},fce=e=>{const t=tt.parse(e.payload.location.search).sourceEventId,n=e.payload.location.state&&e.payload.location.state.sourceEventId;return t||n};function kl(e){const t=e.price&&e.price.current&&e.price.current.amount;return typeof t<"u"?Number(t):null}const Ex=e=>{const t=e.ratingSummary?.overallRating;return t?Number(t):null},fx=e=>{const t=e.offers?.map(n=>n?.retailerPromotionId)?.join(",");return t?t.slice(0,100):null},yce={[Lt.FAVORITE]:"favorites",[Lt.FEATURED]:"featured",[Lt.FEATURED_CROSS_SELL]:"cross-sell",[Lt.PERSONALIZED]:"top-results",[Lt.ON_OFFER]:"on-offer",[Lt.MISSING]:"missing",[Lt.SUBSTITUTED]:"substitutes",[Lt.RETURNED]:"returns",[Lt.DELIVERED]:"delivered",[Lt.INSPIRATION_CAROUSEL]:"inspiration_carousel",[Lt.CLUSTER]:"other",[Lt.GROUP]:"other",[Lt.UNGROUPED]:"other",[Lt.UNKNOWN]:"other"},Ice="other",Sce=e=>e?yce[e]??e:Ice,Ws=(e,t,n)=>{if(e){const o=Sce(n),r=t?`-${t}`:"";return`${e}${r}: ${o}`}return null},Cce={},Tce=(e=Cce)=>e,_ce=({data:e})=>e?.retailer?.retailerConfig||{},Ep=({data:e})=>e.retailer?.retailerConfig?.languages||[];class v1{queue=[];timer=null;options;constructor(t){this.options=t}async enqueue(t){this.queue.push(t),this.queue.length>=this.options.maxQueueLength?await this.flush():this.timer||this.startFlushTimer()}async flush(){if(this.queue.length===0)return;const t=[...this.queue];this.queue=[],this.clearFlushTimer();try{await this.options.onFlush(t)}catch(n){Me.api.pushError(n instanceof Error?n:new Error(`EventBatcher flush error: ${JSON.stringify(n)}`),{context:{events:JSON.stringify(t)}})}}startFlushTimer(){this.timer=setTimeout(async()=>{await this.flush()},this.options.flushIntervalMs)}clearFlushTimer(){this.timer&&(clearTimeout(this.timer),this.timer=null)}}const dj=e=>e?.price?.current?.amount,uj=e=>e?.price?.current?.currency,nd=e=>["featured","shoppable_banner"].some(t=>e?.includes(t)),vce="webp",Ace="300x300",bce="500x500",xce="108x108",Rce="108x60",Dce=["jpg","jpeg","JPG","JPEG"],Oce=["100x100","150x150","200x200","300x300","350x350","410x410","500x500"],Pce=["300x300","500x500","640x640","800x800","960x960","1120x1120","1280x1280"],Nce=e=>{if(e.length===0||!e[0])throw Error("Promotions array is empty");const{description:t,type:n,promoId:o,presentationMode:r,requiredProductQuantity:a,retailerPromotionId:i}=e[0];return{id:o,description:t,type:n,retailerPromotionId:i,...a&&{requiredProductQuantity:a},...r&&{presentationMode:r}}},pj=e=>e.map(({promoId:t,...n})=>({id:t,...n})),Lce=({origPrice:e,promoPrice:t,unitPrice:n,promoUnitPrice:o,grossPrice:r,referencePrice:a})=>{const i=o?o.price:void 0;return{...t&&{original:e},...t?{current:t}:{current:e},...n&&{unit:{label:n.unit,...n.pricePerSuffix&&{pricePerSuffix:n.pricePerSuffix},...i&&{original:n.price},...i?{current:i}:{current:n.price}}},...r&&{gross:r},...a&&{reference:{...a.price,type:a.type}}}},yy=(e,t,n,o)=>({src:`${e}/${n}.${o}`,description:t}),kce=e=>e.substring(0,e.indexOf("x")),Mce=(e,t,n,o)=>e.filter(r=>t.includes(r)).map(r=>`${o}/${r}.${n} ${kce(r)}w`).join(", "),mj=(e,t,n,o)=>n.reduce((r,a)=>{const i=Mce(t,o,a,e);return r?a===vce?`${i}, ${r}`:`${r}, ${i}`:i},""),jce=(e,t,n,o)=>({fopSrcset:`${mj(e,t.availableResolutions,t.availableFormats,n)}`,bopSrcset:`${mj(e,t.availableResolutions,t.availableFormats,o)}`}),wce=e=>{const t=[];return e&&e.forEach(n=>t.push({icon:n.file.replace("-icon",""),label:n.label})),t},A1=(e,t,n)=>{if(t&&n){const{availableFormats:r}=n;if(r.length>0){const[a]=r;return a}}const o=e.filter(r=>Dce.includes(r));return o.length>0?o[0]:e[0]},b1=(e,t,n,o,r)=>{if(r&&r.length>0){const a=jce(t,n,Oce,Pce);return{...e,...a}}return{src:"",description:o,fopSrcset:"",bopSrcset:""}},Fce=e=>{const{format:t,imagePaths:n,isDynamicImagesEnabled:o,productName:r,imageConfig:a}=e;if(t&&n&&n.length>0&&n[0]){const i=yy(n[0],r,Ace,t);return o&&a?b1(i,n[0],a,r,n):i}return o?{src:"",description:r,fopSrcset:"",bopSrcset:""}:{src:"",description:r}},Bce=e=>{const{format:t,imagePaths:n,isDynamicImagesEnabled:o,productName:r,imageConfig:a}=e;return t&&n&&n.length>0?n.map(i=>{const l=yy(i,r,bce,t);return o&&a?b1(l,i,a,r,n):l}):[]},tl=(e,t,n,o=[],r=void 0,a=void 0)=>{const{name:i,imageConfig:l,imagePaths:c,icons:d,packSizeDescription:u,iconAttributes:m,price:g,promoPrice:f,unitPrice:y,promoUnitPrice:I,promotions:S,catchweight:C,isInShoppingList:_,basketLines:A,type:x,alternatives:R,grossPrice:O,referencePrice:N,...k}=e,j=A1(t,n,l),w={format:j,imagePaths:c,isDynamicImagesEnabled:n,productName:i,imageConfig:l},L={...k,name:i,price:Lce({origPrice:g,promoPrice:f,unitPrice:y,promoUnitPrice:I,grossPrice:O,referencePrice:N}),isInProductList:_||!1,image:Fce(w),images:Bce(w),icons:{certification:[],legal:[]},featured:typeof a<"u"&&typeof r<"u"?"true":"false"};return R&&R.length>0&&(L.alternatives=R),A&&A.length>0&&(L.basketLines=A),j&&d&&d.length>0&&d.forEach(B=>{if(B.type==="CERTIFICATION"){const W=yy(B.path,B.label,xce,j);L.icons.certification.push(W)}if(B.type==="LEGAL"){const W=yy(B.path,B.label,Rce,j);L.icons.legal.push(W)}}),o&&o.length>0?L.offers=pj(o):S&&S.length>0&&(L.offers=pj(S)),S&&S.length>0&&(L.offer=Nce(S)),m?.length>0&&(L.attributes=wce(m)),x==="CATCHWEIGHT"&&C?(L.size={value:C.typicalQuantity.value,uom:C.typicalQuantity.uom,catchWeight:!0},L.catchweight=C):u&&(L.size={value:u}),L},x1={S:"xs",M:"sm",L:"md",XL:"lg"},Uce=(e,t)=>{const{childCategories:n,name:o,categoryId:r,productCount:a,retailerCategoryId:i}=e,l=Co(o),c=t.length===0?l:`${t}/${l}`;return{id:r,name:o,productCount:a,fullURLPath:c,...i&&{retailerCategoryId:i},children:yx(n,c)}},yx=(e=[],t="")=>e.map(n=>Uce(n,t)),Gce=({childCategories:e,name:t,categoryId:n,productCount:o,retailerCategoryId:r})=>({id:n,name:t,productCount:o,...r&&{retailerCategoryId:r},children:Ix(e)}),Ix=(e=[])=>e.map(Gce),R1=(e=[])=>e.reduce((t,{children:n,name:o,id:r,fullURLPath:a,retailerCategoryId:i})=>(t.push({id:r,name:o,fullURLPath:a,retailerCategoryId:i},...R1(n)),t),[]),D1=e=>R1(e),O1=(e=[])=>e.reduce((t,{childCategories:n,name:o,categoryId:r})=>(t.push({id:r,name:o},...O1(n)),t),[]),P1=e=>O1(e),Sx=(e=[])=>e.reduce((t,{name:n,categoryId:o,retailerCategoryId:r})=>{const a={name:n,id:o,retailerCategoryId:r},i=Co(n),{length:l}=t;return l===0?[...t,{...a,fullURLPath:i}]:[...t,{...a,fullURLPath:`${t[l-1]?.fullURLPath}/${i}`}]},[]),Cx=(e=[])=>e.map(({name:t,categoryId:n,retailerCategoryId:o})=>({name:t,id:n,retailerCategoryId:o})),$ce=Object.values(x1).reduce((e,t)=>({...e,[t]:0}),{}),N1=e=>{if(e)return Object.entries(e).reduce((t,[n,o])=>({...t,[x1[n]]:o}),$ce)},Tx=(e,t,n)=>{if(t!=="featured_cross_sell"&&t!=="featured")return;const o=new Set(e.map(a=>a.productId));if(!n||typeof n!="object")return;const r=a=>Array.isArray(a)?a:[];return{S:r(n.S).filter(a=>o.has(a)),M:r(n.M).filter(a=>o.has(a)),L:r(n.L).filter(a=>o.has(a)),XL:r(n.XL).filter(a=>o.has(a))}},L1=(e,t)=>e.filter(n=>t.includes(n.id)),_x=e=>e.map(t=>Co(t.name)).join("/"),vx=(e=[])=>e.map(({sortOptionId:t,messageKey:n,selected:o})=>({id:t,messageKey:n,selected:o})),Hce=({filterAttributeId:e,label:t,selected:n})=>({id:e,label:t,selected:n}),Vce=({filterId:e,label:t,attributes:n=[],type:o})=>({id:e,label:t,attributes:n.map(Hce),type:o}),Ax=(e=[])=>e.map(Vce),Yce=(e,t)=>{const n={};for(const o of t){const r=[{id:o,pathSoFar:""}];for(;r.length;){const{id:a,pathSoFar:i}=r.pop(),l=e[a];if(!l)continue;const c=Co(l.name),d=i?`${i}/${c}`:c;n[a]={...l,fullURLPath:d};for(const u of l.children)r.push({id:u,pathSoFar:d})}}return n},{normalize:Wce}=Ji,{productGroupsSchema:qce}=Zi,Kce=(e,t)=>{if(!e)return{basePath:"",breadcrumbs:[],sortOptions:[],categories:[],filters:[],categoriesFlat:[],query:void 0};const{breadcrumb:n,categories:o,filters:r,sortOptions:a,query:i}=e,l=_x(n),c=t?yx(o,l):Ix(o);return{basePath:l,breadcrumbs:t?Sx(n):Cx(n),sortOptions:vx(a),categories:c,filters:Ax(r),categoriesFlat:t?D1(c):P1(o),query:i}},zce=({type:e,decoratedProducts:t=[],otherProductIds:n=[],name:o,clusterCategories:r=[],promotedProductsCampaignName:a,promotedProductsCampaignId:i,featuredProductsViewportConfig:l,featuredProductsPerViewportMap:c},d,u=[],m=!1)=>({type:e,products:Qce(t,n,a,i,m,d),name:o,clusterBreadcrumbs:L1(u,r),campaignName:a,campaignId:i,viewportConfig:N1(l),featuredProductsPerViewportMap:Tx(t,e,c)}),Qce=(e,t,n,o,r,a)=>{const i=e.map(c=>({productId:c.productId,product:tl(c,a,r,[],n,o)})),l=t.map(c=>({productId:c,product:void 0}));return[...i,...l]},Xce=(e,t,n=[],o=!1)=>t.map(r=>zce(r,e,n,o)),Zce=({productGroups:e,additionalPageInfo:t,metadata:n,missedPromotions:o},r,a,i)=>{const{basePath:l,breadcrumbs:c,sortOptions:d,categories:u,filters:m,categoriesFlat:g,query:f}=Kce(t,a);return{productGroups:Xce(r,e,g,i),breadcrumbs:c,sortOptions:d,categories:u,filters:m,...c.length&&{retailerCategoryId:c[c.length-1]?.retailerCategoryId},...a&&{fullURLPath:l},...n&&n.nextPageToken&&{nextPageToken:n.nextPageToken},...o&&{missedPromotions:o},...f&&{query:f}}},gS=(e,t,n,o)=>{const r=Zce(e,t,n,o),a=["campaignName","campaignId"];return Wce({...r,productGroups:r.productGroups.map(i=>({...i,products:i.products.map(l=>{if(l&&l.product){const c=Object.fromEntries(Object.entries(l.product).filter(([d,u])=>!a.includes(d)));return{productId:l.productId,product:c}}return l}),additionalProductAttributes:i.products.map(l=>l&&l.product?UI(l.product,...a):{})}))},qce)},{normalize:Jce}=Ji,{productGroupsSchema:ede}=Zi,tde=({type:e,products:t=[],name:n,clusterCategories:o=[],promotedProductsCampaignName:r,promotedProductsCampaignId:a,featuredProductsViewportConfig:i,featuredProductsPerViewportMap:l},c,d=[],u=!1)=>({type:e,products:t.map(m=>({productId:m.productId,product:m.product?tl(m.product,c,u,[],r,a):void 0})),name:n,clusterBreadcrumbs:L1(d,o),campaignName:r,campaignId:a,viewportConfig:N1(i),featuredProductsPerViewportMap:Tx(t,e,l)}),sde=(e,t,n=[],o=!1)=>t.map(r=>tde(r,e,n,o)),nde=({productGroups:e,breadcrumbs:t,sortOptions:n,categories:o,filters:r,totalProducts:a,categoryId:i,missedPromotions:l},c,d,u)=>{const m=_x(t),g=d?yx(o,m):Ix(o),f=d?D1(g):P1(o),y=d?Sx(t):Cx(t);return{productGroups:sde(c,e,f,u),breadcrumbs:y,sortOptions:vx(n),categories:g,filters:Ax(r),...t.length&&{retailerCategoryId:t[t.length-1]?.retailerCategoryId},totalProducts:a,...d&&{fullURLPath:m},...d&&i&&{categoryId:i},...l&&{missedPromotions:l}}},ch=(e,t,n,o)=>{const r=nde(e,t,n,o),a=["campaignName","campaignId"];return Jce({...r,productGroups:r.productGroups.map(i=>({...i,products:i.products.map(l=>{if(l&&l.product){const c=Object.fromEntries(Object.entries(l.product).filter(([d,u])=>!a.includes(d)));return{productId:l.productId,product:c}}return l}),additionalProductAttributes:i.products.map(l=>l&&l.product?UI(l.product,...a):{})}))},ede)},ode=e=>{try{return decodeURIComponent(e)}catch{return Object.keys(tt.parse(e)).join()}};function cA(e){const{sublocationId:t,...n}=e;return tt.stringify(n)}function fp(e){const{q:t,sortBy:n,sublocationId:o,sort:r,category:a,source:i,...l}=e;return Object.keys(l).reduce((c,d)=>({...c,[d]:ode(l[d]).split(",")}),{})}function rde(e){return Object.keys(e).reduce((t,n)=>({...t,[n]:e[n].join(",")}),{})}function ES({category:e,filters:t,sortOption:n,additional:o={}}){return tt.stringify({...o,sublocationId:e,sortBy:n,...rde(t)})}const ade=ee("GET_PROMOTION_CATALOGUE"),ide=ee("GET_SEARCH_CATALOGUE"),lde=ee("GET_FAVORITES_CATALOGUE"),cde=ee("GET_REGULARS_CATALOGUE"),k1=ee("GET_CATALOGUE"),dde=ee("GET_HOMEPAGE_CATALOGUE"),ude=ee("GET_PROMOTION_CATALOGUE_SCROLL"),M1=ee("GET_NEXT_CATALOGUE_PAGE"),pde=ee("GET_NEXT_PROMOTION_CATALOGUE_PAGE"),mde=ee("GET_NEXT_SEARCH_CATALOGUE_PAGE"),hde=ee("GET_NEXT_FAVORITES_CATALOGUE_PAGE"),j1=ee("GET_CROSS_SELL_PRODUCTS"),w1="SET_LAST_FETCHED_CATALOGUE_LOCATION",F1="REMOVE_PRODUCT_FROM_REGULARS_PRODUCT_GROUP",B1=ee("GET_CATEGORY_ENTITY"),gde="FILTER_CATALOGUE",bx=({category:e,filters:t={},sortOption:n,offset:o=void 0,pageToken:r,additional:a={},isRetailerCategoryId:i,...l})=>tt.stringify({...i?{retailerCategoryId:e}:{category:e},filters:tt.stringify(t,{arrayFormat:"separator",arrayFormatSeparator:","}),sort:n,...o!==void 0&&{offset:o},pageToken:r,...a,...l},{skipEmptyString:!0}),Ede=(e,t,n,o,r,a,i,l={},c)=>d=>d({type:"API",payload:{url:`${e}?${bx({category:t,filters:n,sortOption:o,offset:r,pageToken:a,isRetailerCategoryId:i,additional:l})}`,...k1,...c?j1:{}}}),fde=(e,t,n={},o=void 0,r,a={},i)=>l=>l({type:"API",payload:{url:`${e}?${bx({category:t,filters:n,sortOption:o,pageToken:r,additional:a,isRetailerCategoryId:i})}`,...M1}}),yde=e=>({type:w1,payload:e}),Ide=e=>({type:F1,payload:{productIdToDelete:e}}),Sde=({queryString:e})=>({type:"API",payload:{url:`/v1/seo/category?${e}`,...B1}}),ft={getCataloguePage:Ede,getNextCataloguePage:fde,setLastFetchedCatalogueLocation:yde,removeProductFromRegularsProductGroup:Ide,getCategoryEntity:Sde,types:{GET_CATALOGUE:k1,GET_HOMEPAGE_CATALOGUE:dde,GET_SEARCH_CATALOGUE:ide,GET_FAVORITES_CATALOGUE:lde,GET_REGULARS_CATALOGUE:cde,GET_PROMOTION_CATALOGUE:ade,GET_PROMOTION_CATALOGUE_SCROLL:ude,GET_NEXT_CATALOGUE_PAGE:M1,GET_NEXT_SEARCH_CATALOGUE_PAGE:mde,GET_NEXT_FAVORITES_CATALOGUE_PAGE:hde,GET_NEXT_PROMOTION_CATALOGUE_PAGE:pde,GET_CROSS_SELL_PRODUCTS:j1,SET_LAST_FETCHED_CATALOGUE_LOCATION:w1,REMOVE_PRODUCT_FROM_REGULARS_PRODUCT_GROUP:F1,GET_CATEGORY_ENTITY:B1,FILTER_CATALOGUE:gde}},{normalize:Cde}=Ji,{productGroupsSchema:Tde}=Zi,_de=(e,t)=>{const{name:n,categoryId:o,productCount:r,retailerCategoryId:a}=e,i=Co(n),l=t.length===0?i:`${t}/${i}`;return{id:o,name:n,productCount:r,fullURLPath:l,...a&&{retailerCategoryId:a}}},vde=(e=[],t="")=>e.map(n=>_de(n,t)),Ade=({name:e,categoryId:t,productCount:n,retailerCategoryId:o})=>({id:t,name:e,productCount:n,...o&&{retailerCategoryId:o}}),bde=(e=[])=>e.map(Ade),xde=({type:e,decoratedProducts:t=[],otherProductIds:n=[],name:o,clusterCategories:r=[],featuredProductsPerViewportMap:a,featuredProductCampaigns:i},l,c,d=!1)=>{const u=e.toLowerCase();return{type:u,products:Rde(t,n,d,l),name:o,clusterBreadcrumbs:c.filter(m=>r.includes(m.id)),featuredProductsPerViewportMap:Tx(t,u,a),featuredProductCampaigns:i}},Rde=(e,t,n,o)=>{const r=e.map(i=>({productId:i.productId,product:tl(i,o,n,[])})),a=t.map(i=>({productId:i,product:void 0}));return[...r,...a]},Dde=(e,t,n,o=!1)=>t.map(r=>xde(r,e,n,o)),Ode=({productGroups:e,additionalPageInfo:{breadcrumb:t,categories:n,filters:o,sortOptions:r},metadata:a,missedPromotions:i},l,c,d)=>{const u=_x(t),m=c?vde(n,u):bde(n),g=c?Sx(t):Cx(t);return{productGroups:Dde(l,e,m,d),breadcrumbs:g,sortOptions:vx(r),categories:m,filters:Ax(o),missedPromotions:i,...t.length&&{retailerCategoryId:t[t.length-1]?.retailerCategoryId},...c&&{fullURLPath:u},...a.nextPageToken&&{nextPageToken:a.nextPageToken}}},dA=(e,t,n,o)=>{const r=Ode(e,t,n,o);return Cde(r,Tde)},{denormalize:U1}=Ji,{productGroupsSchema:G1}=Zi,fS={},yS=[],RE=(e,t)=>{const n=[...e.productGroups];return t.productGroups.forEach(o=>{const r=n.findLastIndex(({name:a})=>a===o.name);if(r>-1){const a=[...n[r].products,...o.products],i=n[r].additionalProductAttributes||[],l=o.additionalProductAttributes||[];n[r]={...n[r],products:a,additionalProductAttributes:[...i,...l]}}else n.push(o)}),n},Pde=(e,t)=>{const n=[...e.productGroups],o=n.find(({type:a})=>a==="featured_cross_sell"),r=t.productGroups.find(({type:a})=>a==="featured_cross_sell");return o&&r&&(o.products=r.products),n},Nde=(e,t,n)=>e?.map(o=>o.type!==t?o:{...o,products:o.products.filter(r=>r!==n)}),Lde=(e,t)=>e.reduce((n,o)=>{if(!t[o.id])return n;const r=o.attributes.map(i=>i.id),a=t[o.id].filter(i=>r.indexOf(i)!==-1);return a.length?{...n,[o.id]:a}:n},{}),kde=(e,t)=>{if(!e)return;const n=t&&t.find(r=>r.selected);return tt.parse(e.search).sortBy||n&&n.id||void 0},yp=e=>e?e.reduce((t,n)=>[...t,...n.products],[]).filter(t=>t!==void 0):[],za=(e,t)=>{const n=e?e.totalProducts:0,o=yp(t.productGroups);return n?n+o.length:o.length},um=(e,t)=>{const{imageFormats:n,isSEOReadableURLEnabled:o,isDynamicImagesEnabled:r}=t;return gS(e,n,o,r)},Mde={...Re,data:{}},jde=(e=Mde,t)=>{switch(t.type){case mn:{const{location:n}=t.payload,o=tt.parse(n&&n.search);return{...e,filtersFromQueryString:fp(o),selectedSortOptionId:kde(n,e.data.sortOptions)}}case ft.types.GET_PROMOTION_CATALOGUE.PENDING:case ft.types.GET_SEARCH_CATALOGUE.PENDING:case ft.types.GET_HOMEPAGE_CATALOGUE.PENDING:case ft.types.GET_REGULARS_CATALOGUE.PENDING:case ft.types.GET_CATALOGUE.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case ft.types.GET_PROMOTION_CATALOGUE.ERROR:case ft.types.GET_SEARCH_CATALOGUE.ERROR:case ft.types.GET_HOMEPAGE_CATALOGUE.ERROR:case ft.types.GET_REGULARS_CATALOGUE.ERROR:case ft.types.GET_CATALOGUE.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case ft.types.GET_PROMOTION_CATALOGUE.SUCCESS:{let{responseData:n}=t.payload;const{imageFormats:o,isSEOReadableURLEnabled:r,isDynamicImagesEnabled:a}=t.transformerConfig;n=dA(n,o,r,a);const{sortOptions:i}=n.result,l=i&&i.find(c=>c.selected);return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),selectedSortOptionId:l&&l.id,data:{...n.result,totalProducts:za(null,n.result)}}}case ft.types.GET_SEARCH_CATALOGUE.SUCCESS:{let{responseData:n}=t.payload;n=um(n,t.transformerConfig);const{sortOptions:o}=n.result,r=o&&o.find(a=>a.selected);return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),selectedSortOptionId:r&&r.id,data:{...n.result,totalProducts:za(null,n.result)}}}case ft.types.GET_FAVORITES_CATALOGUE.SUCCESS:{let{responseData:n}=t.payload;n=um(n,t.transformerConfig);const{sortOptions:o,retailerCategoryId:r}=n.result,a=o&&o.find(i=>i.selected);return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),selectedSortOptionId:a&&a.id,data:{...n.result,totalProducts:za(null,n.result),retailerCategoryId:r}}}case ft.types.GET_NEXT_FAVORITES_CATALOGUE_PAGE.SUCCESS:{let{responseData:n}=t.payload;return n=um(n,t.transformerConfig),{...e,isNextPageFetching:!1,fetchNextPageError:!1,lastUpdated:le(),data:{...e.data,productGroups:RE(e.data,n.result),nextPageToken:n.result.nextPageToken,totalProducts:za(e.data,n.result),retailerCategoryId:t.retailerCategoryId}}}case ft.types.GET_REGULARS_CATALOGUE.SUCCESS:{let{responseData:n}=t.payload;const{imageFormats:o,isSEOReadableURLEnabled:r,isDynamicImagesEnabled:a}=t.transformerConfig;n=ch(n,o,r,a);const{sortOptions:i}=n.result,l=i&&i.find(c=>c.selected);return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),selectedSortOptionId:l&&l.id,data:{...n.result,totalProducts:za(null,n.result)}}}case ft.types.GET_CATALOGUE.SUCCESS:{const{sortOptions:n}=t.payload.responseData.result,o=n&&n.find(r=>r.selected);return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),selectedSortOptionId:o&&o.id,data:{...t.payload.responseData.result,totalProducts:za(null,t.payload.responseData.result)}}}case ft.types.GET_HOMEPAGE_CATALOGUE.SUCCESS:{let{responseData:n}=t.payload;const{imageFormats:o,isSEOReadableURLEnabled:r,isDynamicImagesEnabled:a}=t.transformerConfig;n=ch(n,o,r,a);const{sortOptions:i}=n.result,l=i&&i.find(c=>c.selected);return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),selectedSortOptionId:l&&l.id,data:{...n.result,totalProducts:za(null,n.result),...t.isProductFiltersEnabled&&{catalogueCopy:{...n.result}}}}}case ft.types.FILTER_CATALOGUE:{const n=t.payload?e.data.catalogueCopy.productGroups.filter(o=>o.type===t.payload):e.data.catalogueCopy.productGroups;return{...e,isFetching:!1,fetchError:!1,data:{...e.data,productGroups:[...n.map(o=>({...o,lastUpdated:le()}))]}}}case ft.types.GET_NEXT_PROMOTION_CATALOGUE_PAGE.PENDING:case ft.types.GET_NEXT_SEARCH_CATALOGUE_PAGE.PENDING:case ft.types.GET_NEXT_CATALOGUE_PAGE.PENDING:return{...e,isNextPageFetching:!0,fetchNextPageError:!1,error:null};case ft.types.GET_NEXT_PROMOTION_CATALOGUE_PAGE.ERROR:case ft.types.GET_NEXT_SEARCH_CATALOGUE_PAGE.ERROR:case ft.types.GET_NEXT_CATALOGUE_PAGE.ERROR:return{...e,isNextPageFetching:!1,fetchNextPageError:!0,error:t.payload,data:{...e.data,nextPageToken:void 0}};case ft.types.GET_NEXT_PROMOTION_CATALOGUE_PAGE.SUCCESS:{let{responseData:n}=t.payload;const{imageFormats:o,isSEOReadableURLEnabled:r,isDynamicImagesEnabled:a}=t.transformerConfig;return n=dA(n,o,r,a),{...e,isNextPageFetching:!1,fetchNextPageError:!1,lastUpdated:le(),data:{...e.data,productGroups:RE(e.data,n.result),nextPageToken:n.result.nextPageToken,totalProducts:za(e.data,n.result)}}}case ft.types.GET_NEXT_SEARCH_CATALOGUE_PAGE.SUCCESS:{let{responseData:n}=t.payload;return n=um(n,t.transformerConfig),{...e,isNextPageFetching:!1,fetchNextPageError:!1,lastUpdated:le(),data:{...e.data,productGroups:RE(e.data,n.result),nextPageToken:n.result.nextPageToken,totalProducts:za(e.data,n.result)}}}case ft.types.GET_NEXT_CATALOGUE_PAGE.SUCCESS:return{...e,isNextPageFetching:!1,fetchNextPageError:!1,lastUpdated:le(),data:{...e.data,productGroups:RE(e.data,t.payload.responseData.result),nextPageToken:t.payload.responseData.result.nextPageToken,totalProducts:za(e.data,t.payload.responseData.result)}};case ft.types.GET_CROSS_SELL_PRODUCTS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case ft.types.GET_CROSS_SELL_PRODUCTS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case ft.types.GET_CROSS_SELL_PRODUCTS.SUCCESS:{let{responseData:n}=t.payload;return t.transformerConfig&&(n=um(n,t.transformerConfig)),{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:{...e.data,productGroups:Pde(e.data,n.result)}}}case ft.types.SET_LAST_FETCHED_CATALOGUE_LOCATION:return{...e,lastFetchedLocation:t.payload};case ft.types.REMOVE_PRODUCT_FROM_REGULARS_PRODUCT_GROUP:return{...e,data:{...e.data,productGroups:Nde(e.data.productGroups,"regular",t.payload.productIdToDelete)}};case ft.types.GET_CATEGORY_ENTITY.SUCCESS:return{...e,categoryEntity:{...t.payload.responseData}};default:return e}},$1=e=>({...e,productGroups:(e.productGroups||[]).map(t=>({...t,products:t.products.map((n,o)=>n&&{...n,...t.additionalProductAttributes?.[o]}),additionalProductAttributes:void 0}))}),wde=V(e=>e.data.products.catalogue,e=>e.data.products.productEntities,(e,t)=>({...e,data:$1(U1(e.data,G1,{product:t}))})),Fde=V(e=>e.result,e=>e.entities.product,(e,t)=>({data:$1(U1(e,G1,{product:t}))})),H1=e=>V(e,t=>yp(t.data.productGroups)),V1=V(({data:e})=>e.products.catalogue.data.productGroups,e=>e?.map(t=>({...t,section:t.type}))),F7t=V(({data:e})=>e.products.catalogue.data.catalogueCopy?.productGroups,e=>e?.map(t=>({...t,section:t.type}))),ir=({data:e})=>e.products.productEntities,Bde=e=>V([ir],t=>e?Object.values(t).filter(n=>e.includes(n.productId)):[]),Ude=H1(wde),ng=()=>H1(Fde),Y1=({data:e})=>e.products.catalogue.isFetching,og=({data:e})=>e.products.catalogue.isNextPageFetching||!1,Ip=({data:e})=>e.products.catalogue.fetchError?e.products.catalogue.error:null,W1=({data:e})=>e.products.catalogue.lastUpdated,Gde=({data:e})=>e.products.catalogue.data.categoryId||"",$de=({data:e})=>e.products.catalogue.data.retailerCategoryId||"",_d=({data:e})=>e.products.catalogue.data.breadcrumbs||yS,q1=V(_d,e=>e.length),xx=({data:e})=>e.products.catalogue.data.fullURLPath||"",Hde=({data:e})=>e.products.catalogue.data.categories||[],Rx=({data:e})=>e.products.catalogue.data.sortOptions||yS,rg=({data:e})=>e.products.catalogue.data.filters||yS,Dx=({data:e})=>e.products.catalogue.data.totalProducts||0,Sp=({data:e})=>e.products.catalogue.data.query||fS,Vde=({data:e})=>e.products.catalogue.data.mlModelIds||yS,K1=({data:e})=>e.products.catalogue.data.rankingScoreByProductId||fS,Ox=({data:e})=>e.products.catalogue.lastFetchedLocation||"",z1=({data:e})=>e.products.catalogue.categoryEntity,Yde=({data:e})=>e.products.catalogue.data.nextPageToken||"",Cp=V([rg,({data:e})=>e.products.catalogue.filtersFromQueryString||fS],Lde),Q1=({data:e})=>e.products.catalogue.filtersFromQueryString||fS,Px=({data:e})=>e.products.catalogue.selectedSortOptionId||void 0,IS=e=>V(({data:t})=>t.products.catalogue.data.productGroups,t=>{if(!e)return null;for(const n of t||[])if(n.featuredProductCampaigns&&n.featuredProductCampaigns[e])return n.featuredProductCampaigns[e];return null}),qs=V(({data:e})=>e.products.catalogue.data.productGroups,e=>{const t={};return(e||[]).forEach(n=>{n.featuredProductCampaigns&&Object.assign(t,n.featuredProductCampaigns)}),t}),Hs={hitType:"event",ecommType:"enhanced",eventCategory:"E-commerce",deliveryType:void 0,ecommerce:void 0,eventAction:void 0,eventLabel:void 0,eventValue:void 0,page:void 0,source:void 0},vd="Checkout Funnel",Wde="PROMO_LINK_IMPRESSION",qde="GA_BOP_PROMO_LINK_CLICKED",X1="GA_PRODUCT_DETAILS",Z1="GA4_PRODUCT_DETAILS",Kde="PRODUCT_IMAGE_CLICKED",zde="PRODUCT_IMAGE_ZOOMED_IN",Qde="PRODUCT_IMAGE_ZOOMED_OUT",Xde="PRODUCT_IMAGE_CLOSED",Zde="ACCESSIBILITY_IMAGE_ZOOMED_IN",Jde="ACCESSIBILITY_IMAGE_ZOOMED_OUT",eue="ACCESSIBILITY_SCREEN_NAVIGATION_CLICKED",tue="ACCESSIBILITY_IMAGE_NAVIGATION_USED",sue="PRODUCT_ID",nue="BRAND_BUTTON_CLICKED",oue="BREADCRUMBS",fo={PROMO_LINK_IMPRESSION:Wde,GA_BOP_PROMO_LINK_CLICKED:qde,GA_PRODUCT_DETAILS:X1,GA4_PRODUCT_DETAILS:Z1,PRODUCT_IMAGE_CLICKED:Kde,PRODUCT_IMAGE_ZOOMED_IN:zde,PRODUCT_IMAGE_ZOOMED_OUT:Qde,PRODUCT_IMAGE_CLOSED:Xde,ACCESSIBILITY_IMAGE_ZOOMED_IN:Zde,ACCESSIBILITY_IMAGE_ZOOMED_OUT:Jde,ACCESSIBILITY_SCREEN_NAVIGATION_CLICKED:eue,ACCESSIBILITY_IMAGE_NAVIGATION_USED:tue,PRODUCT_ID:sue,BRAND_BUTTON_CLICKED:nue,BREADCRUMBS:oue},B7t=e=>({type:X1,payload:{...e,category:"E-commerce"}}),U7t=e=>({type:Z1,payload:e.payload}),rue=["search","categories"],aue=["featured","featured_cross_sell"],iue={FEATURED_PRODUCT_IMPRESSION:ee("CX_FEATURED_PRODUCT_IMPRESSION"),FEATURED_PRODUCT_CLICK:ee("CX_FEATURED_PRODUCT_CLICK")},Iy=(e,t,n="")=>{const o=t?.featuredProductCampaign?.source==="CITRUS_AD",r=aue.includes(n),a=rue.includes(e);return o&&r&&a},lue=e=>e.filter(({page:t,product:n,group:o})=>Iy(t,n,o.type)).map(({product:t})=>t),J1=e=>(t,n)=>({type:"API",payload:{url:n?"/v1/events":"/v4/content/events",service:n?"cxhub":"webuniversalapi",...n?{pathPrefix:{client:"/api/cxhub",server:"/core-api"}}:{},options:{method:"POST",body:{eventType:e,externalAdvertIds:t.map(o=>o.featuredProductCampaign?.externalAdvertId)}},...iue[e]}}),eH=J1("FEATURED_PRODUCT_CLICK"),cue=J1("FEATURED_PRODUCT_IMPRESSION"),due="BREADCRUMBS_LIST_CLICKED",uue="CLUSTER_EXPANDED",pue="FOP_CLICKED",mue="PRODUCT_IMPRESSION",hue="QUEUE_PRODUCT_IMPRESSION",gue="PROMO_LINK_CLICKED",Eue="ELLIPSIS_CLICKED",fue="MESSAGE_ALERT_DISPLAYED",yue="SHOW_SUBSTITUTES",Iue="GA_FOP_PROMO_LINK_CLICKED",Sue="GA_IMPRESSION",Cue="GA_BATCH_IMPRESSION",Tue="GA4_BATCH_IMPRESSION",_ue="GA_PRODUCT_CLICK",vue="GA4_PRODUCT_CLICK",zt={BREADCRUMBS_LIST_CLICKED:due,CLUSTER_EXPANDED:uue,FOP_CLICKED:pue,PRODUCT_IMPRESSION:mue,QUEUE_PRODUCT_IMPRESSION:hue,PROMO_LINK_CLICKED:gue,ELLIPSIS_CLICKED:Eue,MESSAGE_ALERT_DISPLAYED:fue,SHOW_SUBSTITUTES:yue,GA_FOP_PROMO_LINK_CLICKED:Iue,GA_IMPRESSION:Sue,GA_BATCH_IMPRESSION:Cue,GA4_BATCH_IMPRESSION:Tue,GA_PRODUCT_CLICK:_ue,GA4_PRODUCT_CLICK:vue},bm=15,Aue=0,DE=[],tH=e=>[...Array(Math.ceil(e.length/bm))].map((n,o)=>e.slice(o*bm,(o+1)*bm)),hj=(e,t,n)=>{if(!n.length)return;const o=D("cxe.by")(t()),r=lue(n);r.length>0&&e(cue(r,o)),e({type:zt.PRODUCT_IMPRESSION,payload:{pageViewId:n[0].pageViewId,products:n.map(({page:l,breadcrumbValue:c,...d})=>{const u=d.cluster?.clusterName.trim()?d.cluster.clusterName.trim():null,m=d.group.type?.trim()?d.group.type.trim():null;return{...d.product,sequence:d.sequence,isPersonalised:d.group.type===Lt.PERSONALIZED||d.group.type===Lt.INSPIRATION_CAROUSEL,groupName:d.group.groupTitle,rankingScore:d.rankingScore,groupType:m,clusterName:u,...d.pageEventId&&{pageEventId:d.pageEventId},...d.orderId&&{orderId:d.orderId},...d.missedPromotion&&{missedPromotion:d.missedPromotion},...d.customAnalyticsData&&{customAnalyticsData:d.customAnalyticsData}}})}}),e({type:zt.GA_BATCH_IMPRESSION,payload:{category:n[0].breadcrumbValue,page:n[0].page,impressions:n.map(({page:l,breadcrumbValue:c,...d})=>({product:{...d.product,cmsProductAttributes:d.group&&d.group.type===Lt.FEATURED?["featured"]:[],isPersonalised:d.group&&d.group.type===Lt.PERSONALIZED},productListName:d.productListName,position:d.position}))}}),n[0].page!=="basket"&&e({type:zt.GA4_BATCH_IMPRESSION,payload:{page:n[0].page,currency:n[0].product.price?.current.currency||null,impressions:n.map(l=>({product:{...l.product},productListName:l.productListName,position:l.position}))}});const i=n.filter(({product:l})=>l&&!!l.offer);i.length>0&&e({type:fo.PROMO_LINK_IMPRESSION,payload:{pageViewId:n[0].pageViewId,promoLinkImpressions:i.map(({product:l,position:c})=>({promotionId:l.offer.id,promotionText:l.offer.description,promotionType:l.offer.type,promotionPresentation:l.offer.presentationMode,promotionSequence:l.offers?l.offers.reduce((d,u,m)=>u.id===l.offer.id?m:d,0):0,productId:l.productId,productSequence:c}))}})},dh=({dispatch:e,getState:t})=>{const n=()=>hj(e,t,DE.splice(0));return o=>r=>{const a=o(r);switch(r.type){case mn:return n(),a;case zt.QUEUE_PRODUCT_IMPRESSION:return r.payload&&(DE.push(r.payload),dh.beforeUnload(n),dh.setTimeout(n)),DE.length>=bm&&hj(e,t,DE.splice(0,bm)),a;default:return a}}};let gj=0;dh.setTimeout=e=>{typeof window>"u"||(window.clearTimeout(gj),gj=window.setTimeout(e,Aue))};let Ej=!1;dh.beforeUnload=e=>{typeof window>"u"||Ej||(window.addEventListener("beforeunload",e),Ej=!0)};const sH=e=>e.size?e.size.value:null,nH=(e={})=>e.price&&e.price.current&&{currencyCode:e.price.current.currency},Nx=e=>e.quantity&&e.quantity.quantityInBasket||typeof e.quantity!="object"&&e.quantity||e.addedAmount||0,bue=e=>typeof e>"u"?!1:typeof e=="object"?!0:e,oH=(e,t)=>{const n=t&&IS(e.productId)(t)||e.featuredProductCampaign,{favorite:o,offers:r,available:a,maxQuantityReached:i,isPersonalised:l}=e,c={};c.isFeatured=!!n,n&&(c.featuredCampaignName=n.campaignName,c.featuredCampaignId=n.campaignId),c.isFavorite=bue(o),c.isPersonalised=!!l;const d=typeof r<"u"&&r.length>0;c.isOnPromotion=d;const u=[],m=[];return d&&(r.forEach(g=>{m.push(g.description),g.retailerPromotionId&&u.push(g.retailerPromotionId)}),c.promotionIds=u,c.promotionNames=m),c.canAddToBasket=a&&!i,c},xue=(e,{productListName:t,position:n,product:o},r)=>({id:o.retailerProductId,name:o.name,list:t,brand:o.brand||null,category:e||null,variant:sH(o),position:n,price:kl(o),hfssDisplayRestrictionGroup:o.hfssDisplayRestrictionGroup||null,...oH(o,r)}),Rue=(e,t,n)=>({impressions:t.map(o=>xue(e,o,n)),...nH(t[0].product)}),Ys=(e,t,n,o)=>({id:e.retailerProductId,productId:e.productId,name:e.name,brand:e.brand||null,category:t||null,variant:sH(e),price:kl(e),quantity:Nx(e),position:n,...oH(e,o)}),Due=(e,t,n)=>{const{category:o,position:r,product:a,productListName:i}=t;return{[e]:{actionField:{...i?{list:i}:{}},products:a.map(l=>Ys(l,o,r,n))},...nH(a[0])}},Lx=(e,t)=>(n,o)=>({...Hs,eventAction:n.type,eventLabel:t,ecommerce:Due(e,n.payload,o)}),Oue=(e,t)=>Lx("detail",e.payload.product[0].retailerProductId)(e,t),rH=(e,t,n)=>({...Hs,eventAction:"view_item_list",eventLabel:t.length===1?t[0].product.retailerProductId:"Not Set",ecommerce:Rue(e,t,n)}),Pue=(e,t)=>{const{category:n,productListName:o,position:r,product:a}=e.payload;return rH(n,[{product:a,position:r,productListName:o}],t)},Nue=(e,t)=>{const{category:n,impressions:o}=e.payload;return tH(o).map(a=>rH(n,a,t))},Lue=e=>({...Hs,eventLabel:e.payload.productId,eventAction:"product_click",event:"productClick",ecommerce:{currencyCode:e.payload.currencyCode,click:{actionField:{list:e.payload.productListName},products:[{name:e.payload.productName,id:e.payload.productId,price:e.payload.productPrice,position:e.payload.productPosition}]}}}),kue=e=>({event:"select_item_promotion",id:e.payload.itemId,name:e.payload.itemName,index:e.payload.index,promotion_id:e.payload.promotionId,promotion_name:e.payload.promotionName,list:e.payload.list}),i_=15,aH=e=>[...Array(Math.ceil(e.length/i_))].map((t,n)=>e.slice(n*i_,(n+1)*i_)),iH=e=>e&&e.price&&e.price.current&&{currencyCode:e.price.current.currency},kx=([e,t,n,o,r,...a])=>({...e&&{item_category:e},...t&&{item_category2:t},...n&&{item_category3:n},...o&&{item_category4:o},...r&&{item_category5:r},...a.length&&{item_category_more:a.join("/")}}),Mx=(e,t)=>!!(e.available&&!e.maxQuantityReached&&!e.timeRestricted&&e.isInCurrentCatalog&&t!=="regulars"),Mue=e=>typeof e>"u"?!1:typeof e=="object"?!0:e,jue=e=>e.size?e.size.value:null,wue=({product:e,category:t,position:n,featuredProductCampaign:o})=>{const r=typeof e.offers<"u"&&e.offers.length>0,a=[],i=[];return r&&e.offers?.forEach(l=>{i.push(l.description),l.retailerPromotionId&&a.push(l.retailerPromotionId)}),{id:e.retailerProductId,productId:e.productId,name:e.name,brand:e.brand||null,category:t||null,variant:jue(e)?.toString()||null,price:kl(e),quantity:Nx(e),isFeatured:!!o,...o&&{featuredCampaignName:o.campaignName,featuredCampaignId:o.campaignId},isFavorite:Mue(e.favorite),canAddToBasket:e.available&&!e.maxQuantityReached,promotionIds:a,promotionNames:i,position:n,isOnPromotion:r}},ag=({product:e,position:t,productListName:n,page:o,featuredProductCampaign:r})=>{const{campaignId:a=null,campaignName:i=null}=r||{},l=nd(n);return{item_id:e.retailerProductId,item_name:e.name,index:t,item_brand:e.brand||null,hfss_display_restriction_group:e.hfssDisplayRestrictionGroup||null,item_list_name:n,item_variant:e.size?.value.toString()||null,price:kl(e),rating:Ex(e),quantity:1,is_on_promotion:!!e.offers?.length,promotion_ids:fx(e),is_favorite:!!e.favorite,is_featured:l&&!!r,featured_campaign_id:l?a:null,featured_campaign_name:l?i:null,can_add_to_cart:Mx(e,o),...e.categoryPath&&kx(e.categoryPath),seller_id:e.seller?.id||null}},Fue=e=>{const t=e.at(0)?.product.retailerProductId;return{ecommType:"enhanced",event:"event",eventCategory:"E-commerce",eventAction:"view_item_list",eventLabel:e.length===1&&t?t:"Not Set",ecommerce:{impressions:e.map(n=>({...wue({product:n.product,category:n.category,featuredProductCampaign:n.featuredProductCampaign}),position:n.position,isPersonalised:n.isPersonalised,list:n.productListName})),currencyCode:iH(e.at(0)?.product)?.currencyCode}}},Bue=e=>({event:"view_item_list",ecommerce:{currency:iH(e.at(0)?.product)?.currencyCode,items:e.map(t=>ag({product:t.product,position:t.position,productListName:t.productListName,page:t.page,featuredProductCampaign:t.featuredProductCampaign}))}}),Uue=e=>aH(e).map(Fue),Gue=e=>aH(e).map(Bue);class $ue{queue=[];isLocked=!1;acquire(){return new Promise(t=>{this.queue.push({resolve:t}),this.dispatch()})}async runExclusive(t){const n=await this.acquire();try{return await t()}finally{n()}}dispatch(){if(this.isLocked)return;const t=this.queue.shift();t&&(this.isLocked=!0,t.resolve(this.buildRelease()))}buildRelease(){let t=!1;return()=>{t||(t=!0,this.isLocked=!1,this.dispatch())}}}class Hue{gate=new $ue;impressionsHandler=new v1({maxQueueLength:10,flushIntervalMs:500,onFlush:t=>this.handleProductImpressionsBatch(t)});async flushProductImpressions(){await this.impressionsHandler.flush()}async queueProductImpressionEvent(t){await this.impressionsHandler.enqueue(t)}async sendEvent(t){await this.gate.runExclusive(async()=>{(t.event==="page_view"||t.event==="pageview")&&await this.impressionsHandler.flush(),this.sendEventToGTM(t)})}handleProductImpressionsBatch(t){if(!t.at(0))return;const o=Gue(t),r=Uue(t);o.forEach(a=>this.sendEventToGTM(a)),r.forEach(a=>this.sendEventToGTM(a))}validateAndLogEvent(t){this.isValidationEnabled()&&I0([t])}isValidationEnabled(){if(typeof window>"u")return!1;const t=window?.__INITIAL_STATE__;return t?D("aev")(t):!1}sendEventToGTM(t){if(typeof window>"u")return;this.validateAndLogEvent(t);const n=window.dataLayer;if(!n||typeof n?.push!="function")throw new Error("GoogleTagManager error: window.dataLayer is not defined. Have you forgotten to include Google Tag Manager and dataLayer?");n.push(t)}}class Vue{async sendEvent(){}handleProductImpressionsBatch(){}async queueProductImpressionEvent(){}async flushProductImpressions(){}}class Yue{googleAnalyticsHandler=new Hue;webAnalyticsHandler=new Vue;async sendEvent(t){const n=[];this.isEnabled()&&(t.GA&&n.push(this.googleAnalyticsHandler.sendEvent(t.GA)),t.WA&&n.push(this.webAnalyticsHandler.sendEvent()),await Promise.allSettled(n))}async queueProductImpressionEvent(t){const n=[];this.isEnabled()&&(t.GA&&n.push(this.googleAnalyticsHandler.queueProductImpressionEvent(t.GA)),t.WA&&n.push(this.webAnalyticsHandler.queueProductImpressionEvent()),await Promise.allSettled(n))}async flushProductImpressions(){this.isEnabled()&&(await this.googleAnalyticsHandler.flushProductImpressions(),await this.webAnalyticsHandler.flushProductImpressions())}isEnabled(){if(typeof window>"u")return!1;const t=window?.__INITIAL_STATE__;return t?D("al")(t):!1}}const J=new Yue,lH=(e,t)=>{try{const n=Koe(e,t);if(n.country)return n.format("E.164")}catch{throw new Error("Invalid phone number provided")}return null},Wue=(e,t)=>n=>{const o={...e};return e.mobilePhone&&(o.mobilePhone=lH(e.mobilePhone,t)),n(bs.updateCustomerDetails(o)).then(()=>{const r={event:"event",eventCategory:"Settings",eventAction:"UPDATE_CUSTOMER_DETAILS_SUCCESS",eventLabel:"Not Set"};J.sendEvent({GA:r,WA:null})}).catch(r=>{const a={event:"event",eventCategory:"Settings",eventAction:"UPDATE_CUSTOMER_DETAILS_ERROR",eventLabel:"Not Set"};throw J.sendEvent({GA:a,WA:null}),r?.response?.statusCode===400?new Error("Invalid details submitted"):r})},cH=ee("GET_CURRENT_CUSTOMER"),dH=ee("GET_REQUIRES_ADDITIONAL_DETAILS"),uH=ee("UPDATE_ADDITIONAL_DETAILS"),pH=ee("UPDATE_CUSTOMER_DETAILS"),mH=ee("UPDATE_CUSTOMER_LANGUAGE"),que=()=>({type:"API",payload:{url:"/v3/customers/current",service:"web_customer_ws",pathPrefix:{client:"/api/customer",server:"/core-api"},...cH}}),Kue=()=>({type:"API",payload:{url:"/v5/customers/current/details/complete",service:"web_customer_ws",pathPrefix:{client:"/api/customer",server:"/core-api"},...dH}}),zue=e=>({type:"API",payload:{url:"/v5/customers/current/details",service:"web_customer_ws",pathPrefix:{client:"/api/customer",server:"/core-api"},options:{body:e,method:"PUT",responseType:"text"},...pH}}),Que=(e,t)=>({type:"API",payload:{url:"/v5/customers/current/details/additional",service:"web_customer_ws",pathPrefix:{client:"/api/customer",server:"/core-api"},options:{body:{...e,mobilePhone:e.mobilePhone?lH(e.mobilePhone,t):null},method:"PUT",responseType:"text"},...uH}}),Xue=e=>({type:"API",payload:{url:"/v5/customers/current/details/default-language",service:"web_customer_ws",pathPrefix:{client:"/api/customer",server:"/core-api"},options:{body:{language:e},method:"PUT"},...mH}}),bs={getCurrentCustomer:que,getRequiresAdditionalDetails:Kue,updateCustomerDetails:zue,updateAdditionalDetails:Que,updateCustomerLanguage:Xue,types:{GET_CURRENT_CUSTOMER:cH,UPDATE_CUSTOMER_DETAILS:pH,GET_REQUIRES_ADDITIONAL_DETAILS:dH,UPDATE_ADDITIONAL_DETAILS:uH,UPDATE_CUSTOMER_LANGUAGE:mH}},Zue={...Re,data:{}},Jue=D("lng"),epe=D("ads");function tpe({details:e,attributes:t=[]}){return{...t.reduce((n,o)=>({...n,[`attr.${o.attributeKey}`]:o.attributeValue}),{}),...e??{}}}const spe=(e=Zue,t={})=>{switch(t.type){case bs.types.GET_CURRENT_CUSTOMER.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case bs.types.GET_CURRENT_CUSTOMER.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case bs.types.GET_CURRENT_CUSTOMER.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:tpe(t.payload.responseData)};default:return e}},npe=({data:e})=>e.customer?.details?.data?.["attr.registrationPostcode"],ec=({data:e})=>e.customer?.details,ope=({data:e})=>e.customer?.details?.lastUpdated,rpe=({data:e})=>e.customer?.details?.data?.email,hH=({data:e})=>e.customer?.details?.data?.defaultLanguage??"",ape={...Re,required:!1},ipe=(e=ape,t={})=>{switch(t.type){case bs.types.GET_REQUIRES_ADDITIONAL_DETAILS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case bs.types.GET_REQUIRES_ADDITIONAL_DETAILS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case bs.types.GET_REQUIRES_ADDITIONAL_DETAILS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),required:t.payload.responseData.additionalDetailsRequired};case bs.types.UPDATE_ADDITIONAL_DETAILS.SUCCESS:return{...e,lastUpdated:le(),required:!1};default:return e}},gH=({session:e})=>e.additionalDetails||{},jx=V(epe,Jue,Ep,(e,t,n)=>e&&t&&n.length>1),Us={hitType:void 0,deliveryType:void 0,ecommerce:void 0,ecommType:void 0,eventAction:void 0,eventCategory:void 0,eventLabel:void 0,eventValue:void 0,page:void 0,source:void 0},zr=(e,t)=>n=>({...Us,hitType:"event",eventCategory:e,eventAction:n.type,eventLabel:"Not Set"}),uA=(e,t,n)=>{const o=_1(e),r=pa(n)?.amount,a=ec(n),{pagePartType:i,location:{pathname:l}}=e.payload;return{...Us,hitType:"pageview",page:l,pageViewId:On(n),pageType:i||Td(n,window.location),sessionId:Kl(t),loggedInStatus:Ze(n),retailerCustomerId:ua(t),customerFirstname:a.data["attr.firstName"],customerLastname:a.data["attr.surname"],customerEmail:a.data.email,transactionId:At(n),...o&&{source:o},...r&&{basketTotalAmount:r}}},lpe="UPDATE_MARKETING_PREFERENCES_SUCCESS",cpe="UPDATE_MARKETING_PREFERENCES_ERROR",dpe={[bs.types.UPDATE_CUSTOMER_DETAILS.SUCCESS]:zr("Settings"),[bs.types.UPDATE_CUSTOMER_DETAILS.ERROR]:zr("Settings"),[lpe]:zr("Settings"),[cpe]:zr("Settings")},wx="Address Lookup",upe=e=>({...Us,hitType:"event",eventCategory:wx,eventAction:"AddressSelected",eventLabel:e.payload.addressDescription,eventValue:"1"}),ppe=e=>({...Us,hitType:"event",eventCategory:wx,eventAction:"Undeliverable",eventLabel:e.payload.addressDescription,eventValue:"1"}),mpe=e=>({...Us,hitType:"event",eventCategory:wx,eventAction:"Abandoned",eventLabel:e.payload.lastSearchString,eventValue:"1"}),hpe=()=>({event:"add_address_success"}),gpe=()=>({event:"address_lookup_abandoned"}),Epe=()=>({event:"address_lookup_address_not_found"}),fpe=()=>({event:"address_lookup_address_selected"}),ype=()=>({event:"address_lookup_success"}),Ipe=()=>({event:"address_lookup_undeliverable"}),Spe=()=>({event:"remove_address"}),Cpe=()=>({event:"update_address"}),xe={ADDRESS_LOOKUP_SELECTED:"ADDRESS_LOOKUP_SELECTED",ADD_ADDRESS_SUCCESS:"ADD_ADDRESS_SUCCESS",ADDRESS_LOOKUP_ABANDONED:"ADDRESS_LOOKUP_ABANDONED",ADDRESS_LOOKUP_ABANDONED_GA4:"ADDRESS_LOOKUP_ABANDONED_GA4",ADDRESS_LOOKUP_ADDRESS_NOT_FOUND:"ADDRESS_LOOKUP_ADDRESS_NOT_FOUND",ADDRESS_LOOKUP_ADDRESS_SELECTED:"ADDRESS_LOOKUP_ADDRESS_SELECTED",ADDRESS_LOOKUP_SUCCESS:"ADDRESS_LOOKUP_SUCCESS",ADDRESS_LOOKUP_UNDELIVERABLE:"ADDRESS_LOOKUP_UNDELIVERABLE",ADDRESS_LOOKUP_UNDELIVERABLE_GA4:"ADDRESS_LOOKUP_UNDELIVERABLE_GA4",REMOVE_ADDRESS:"REMOVE_ADDRESS",UPDATE_ADDRESS:"UPDATE_ADDRESS",ADDRESS_ERROR:"ADDRESS_ERROR",ADDRESS_POSTCODE:"ADDRESS_POSTCODE",ADD_ADDRESS_BUTTON_CLICKED:"ADD_ADDRESS_BUTTON_CLICKED",FORM_ADD_ADDRESS_BUTTON_CLICKED:"FORM_ADD_ADDRESS_BUTTON_CLICKED",EDIT_ADDRESS_BUTTON_CLICKED:"EDIT_ADDRESS_BUTTON_CLICKED",REMOVE_ADDRESS_BUTTON_CLICKED:"REMOVE_ADDRESS_BUTTON_CLICKED",SAVE_ADDRESS_BUTTON_CLICKED:"SAVE_ADDRESS_BUTTON_CLICKED",ADDRESS_IMPRESSION:"ADDRESS_IMPRESSION",TOAST_NOTIFICATION_DISPLAYED:"TOAST_NOTIFICATION_DISPLAYED",FIND_ADDRESS_BUTTON_CLICKED:"FIND_ADDRESS_BUTTON_CLICKED",FIND_ADDRESS_AGAIN_BUTTON_CLICKED:"FIND_ADDRESS_AGAIN_BUTTON_CLICKED",CANCEL_BUTTON_CLICKED:"CANCEL_BUTTON_CLICKED",USER_DETAILS_FORM_MODAL_DISPLAYED:"USER_DETAILS_FORM_MODAL_DISPLAYED",USER_DETAILS_FORM_MODAL_CLOSED:"USER_DETAILS_FORM_MODAL_CLOSED",SAVE_DETAILS_BUTTON_CLICKED:"SAVE_DETAILS_BUTTON_CLICKED",ADDRESS_DROPDOWN_OPENED:"ADDRESS_DROPDOWN_OPENED",DROPDOWN_ADDRESS_SELECTED:"DROPDOWN_ADDRESS_SELECTED",ADD_ADDRESS_MODAL_DISPLAYED:"ADD_ADDRESS_MODAL_DISPLAYED",ADD_ADDRESS_MODAL_CLOSED:"ADD_ADDRESS_MODAL_CLOSED",SELECT_ADDRESS_MODAL_DISPLAYED:"SELECT_ADDRESS_MODAL_DISPLAYED",SELECT_ADDRESS_MODAL_CLOSED:"SELECT_ADDRESS_MODAL_CLOSED",CONFIRM_ADDRESS_MODAL_DISPLAYED:"CONFIRM_ADDRESS_MODAL_DISPLAYED",CONFIRM_ADDRESS_MODAL_CLOSED:"CONFIRM_ADDRESS_MODAL_CLOSED",ZOOM_BUTTON_CLICKED:"ZOOM_BUTTON_CLICKED",LOCATE_ME_BUTTON_CLICKED:"LOCATE_ME_BUTTON_CLICKED",SAVE_ADDRESS_MODAL_DISPLAYED:"SAVE_ADDRESS_MODAL_DISPLAYED",SAVE_ADDRESS_MODAL_CLOSED:"SAVE_ADDRESS_MODAL_CLOSED",SEARCH_ADDRESS_POSTCODE_MODAL_DISPLAYED:"SEARCH_ADDRESS_POSTCODE_MODAL_DISPLAYED",SEARCH_ADDRESS_POSTCODE_MODAL_CLOSED:"SEARCH_ADDRESS_POSTCODE_MODAL_CLOSED",SEARCH_ADDRESS_POSTCODE_END_TYPING:"SEARCH_ADDRESS_POSTCODE_END_TYPING",CONTINUE_ADDRESS_ADD_BUTTON_CLICKED:"CONTINUE_ADDRESS_ADD_BUTTON_CLICKED",ENTER_ADDRESS_MANUALLY_BUTTON_CLICKED:"ENTER_ADDRESS_MANUALLY_BUTTON_CLICKED",SEARCH_ADDRESS_MODAL_CLOSED:"SEARCH_ADDRESS_MODAL_CLOSED",SEARCH_ADDRESS_CONTINUE_CLICKED:"SEARCH_ADDRESS_CONTINUE_CLICKED"},EH=ee("UPDATE_CUSTOMER_ADDRESS"),Tpe=({id:e,nickname:t,notes:n})=>({type:"API",payload:{url:`/v2/accounts/current/addresses/${e}`,service:"web_customer_ws",pathPrefix:{client:"/api/customer",server:"/core-api"},options:{method:"PUT",body:{nickname:t,notes:n}},...EH}}),Sy={types:{UPDATE_CUSTOMER_ADDRESS:EH},updateCustomerAddress:Tpe},fH=ee("REMOVE_CUSTOMER_ADDRESS"),_pe=e=>({type:"API",payload:{url:`/v2/accounts/current/addresses/${e}`,service:"web_customer_ws",pathPrefix:{client:"/api/customer",server:"/core-api"},options:{body:{},method:"DELETE"},...fH},id:e}),Cy={removeCustomerAddress:_pe,types:{REMOVE_CUSTOMER_ADDRESS:fH}},vpe={[Sy.types.UPDATE_CUSTOMER_ADDRESS.SUCCESS]:zr("Settings"),[Sy.types.UPDATE_CUSTOMER_ADDRESS.ERROR]:zr("Settings"),[Cy.types.REMOVE_CUSTOMER_ADDRESS.SUCCESS]:zr("Settings"),[Cy.types.REMOVE_CUSTOMER_ADDRESS.ERROR]:zr("Settings"),[xe.ADDRESS_LOOKUP_SELECTED]:upe,[xe.ADD_ADDRESS_SUCCESS]:hpe,[xe.ADDRESS_LOOKUP_ABANDONED]:mpe,[xe.ADDRESS_LOOKUP_ABANDONED_GA4]:gpe,[xe.ADDRESS_LOOKUP_ADDRESS_NOT_FOUND]:Epe,[xe.ADDRESS_LOOKUP_ADDRESS_SELECTED]:fpe,[xe.ADDRESS_LOOKUP_SUCCESS]:ype,[xe.ADDRESS_LOOKUP_UNDELIVERABLE]:ppe,[xe.ADDRESS_LOOKUP_UNDELIVERABLE_GA4]:Ipe,[xe.REMOVE_ADDRESS]:Spe,[xe.UPDATE_ADDRESS]:Cpe},SS=(e,t,n)=>({...Hs,eventAction:e,ecommerce:{[t]:{promotions:n}}}),Ape=e=>({event:"view_promotion_details",id:e.payload.retailerPromotionId,name:e.payload.name,type:e.payload.promotionType}),bpe={MEDIUM_RECTANGLE:"MEDIUM_RECTANGLE",PRODUCT_CARD:"PRODUCT_CARD",HORIZONTAL:"HORIZONTAL",DOUBLE_TILE:"DOUBLE_TILE",SHOPPABLE:"SHOPPABLE_BANNER"},Fx=e=>({BOP:"product_details",FOP:"product_card",KEYWORD:"product_search",SHOP_IN_SHOP_TEMPLATED:"shop_in_shop"})[e]??e.toLowerCase(),Bx=(e,t,n)=>{if(t==="CITRUS_AD"||!t)return e;const o=n?.split("/").pop()??"";return o.slice(0,o.lastIndexOf("."))},xpe=e=>({HERO:"ABOVE_GRID"})[e]??e,Ux=(e,t)=>{const n=xpe(e).toLowerCase(),o=t?`_${bpe[t].toLowerCase()}`:"";return`${n}${o}`},Rpe=e=>{const{altText:t,contentSource:n,id:o,linkType:r,name:a,placement:i,sequence:l,targetUrl:c,format:d,imageUrl:u,size:m}=e;return{event:"ga4_select_promotion",ecommerce:{creative_name:Bx(t,n,u),creative_slot:Ux(i,d),creative_index:l??null,link_type:r?Fx(r):"",promotion_id:o,promotion_name:a,content_source:n?.toLowerCase()||"",target:c||null,...m&&{size:m}}}},Dpe=e=>{const{altText:t,contentSource:n,id:o,linkType:r,name:a,placement:i,sequence:l,targetUrl:c,format:d,imageUrl:u,size:m}=e;return{event:"ga4_view_promotion",ecommerce:{creative_name:Bx(t,n,u),creative_slot:Ux(i,d),creative_index:l??null,link_type:r?Fx(r):"",promotion_id:o,promotion_name:a,content_source:n?.toLowerCase()||"",target:c||null,...m&&{size:m}}}},Ope=(e,t)=>{const{id:n,name:o,altText:r,targetUrl:a,linkType:i,advertisingBannerType:l}=e;return{event:"select_promotion",ecommType:"enhanced",eventCategory:"E-commerce",eventAction:t,ecommerce:{promoClick:{promotions:[{promotionType:"Advertising Banner",id:n,name:o,creative:r,position:l,targetUrl:a,linkType:i}]}}}},Ppe=(e,t)=>{const{id:n,name:o,altText:r,targetUrl:a,linkType:i,advertisingBannerType:l}=e;return{event:"view_promotion",ecommType:"enhanced",eventCategory:"E-commerce",eventAction:t,ecommerce:{promoView:{promotions:[{promotionType:"Advertising Banner",id:n,name:o,creative:r,position:l,targetUrl:a,linkType:i}]}}}},Npe=e=>{const{id:t,name:n,altText:o,advertisingBannerType:r,targetUrl:a,linkType:i}=e;return{promotionType:"Advertising Banner",id:t,name:n,creative:o,position:r,targetUrl:a,linkType:i}},Lpe={ADVERTISING_BANNER_CLICKED:"select_promotion",ADVERTISING_BANNER_IMPRESSION:"view_promotion",RESPONSIVE_ADVERTISING_BANNER_CLICKED:"select_promotion",RESPONSIVE_ADVERTISING_BANNER_IMPRESSION:"view_promotion"},kpe={ADVERTISING_BANNER_CLICKED:"ga4_select_promotion",ADVERTISING_BANNER_IMPRESSION:"ga4_view_promotion",RESPONSIVE_ADVERTISING_BANNER_CLICKED:"ga4_select_promotion",RESPONSIVE_ADVERTISING_BANNER_IMPRESSION:"ga4_view_promotion"},yH=(e,t)=>{const{type:n,payload:o}=e,r=Npe(o);return{...SS(n,t,[r]),event:Lpe[n]}},IH=e=>{const{type:t,payload:n}=e,{altText:o,contentSource:r,id:a,linkType:i,name:l,placement:c,sequence:d,targetUrl:u,format:m,imageUrl:g,size:f}=n;return{event:kpe[t],ecommerce:{creative_name:Bx(o,r,g),creative_slot:Ux(c,m),creative_index:d??null,link_type:i?Fx(i):null,promotion_id:a,promotion_name:l,content_source:r?.toLowerCase()||"",target:u||null,...f&&{size:f}}}},fj=e=>yH(e,"promoView"),yj=e=>yH(e,"promoClick"),Ij=e=>IH(e),Sj=e=>IH(e),Mpe={ADVERTISING_BANNER_CLICKED:Sj,ADVERTISING_BANNER_IMPRESSION:Ij,RESPONSIVE_ADVERTISING_BANNER_CLICKED:Sj,RESPONSIVE_ADVERTISING_BANNER_IMPRESSION:Ij},ba={SMART_BANNER_IMPRESSION:"SMART_BANNER_IMPRESSION",SMART_BANNER_CLICKED:"SMART_BANNER_CLICKED",SMART_BANNER_CLOSED:"SMART_BANNER_CLOSED"},SH=()=>({...Hs,ecommerce:{creative_name:null,creative_slot:"mobile_app_prompt",creative_index:null,promotion_name:"Go to app",promotion_id:"go_to_app",target:null,link_type:"app",size:null,content_source:"config"}}),jpe=()=>({...SH(),event:"ga4_view_promotion"}),wpe=()=>({...SH(),event:"ga4_select_promotion"}),Fpe={[ba.SMART_BANNER_CLICKED]:wpe,[ba.SMART_BANNER_IMPRESSION]:jpe},Bpe={ADVERTISING_BANNER_CLICKED:yj,ADVERTISING_BANNER_IMPRESSION:fj,RESPONSIVE_ADVERTISING_BANNER_CLICKED:yj,RESPONSIVE_ADVERTISING_BANNER_IMPRESSION:fj},Gx=e=>{const t=e?.split("/").pop()??"";return t.slice(0,t.lastIndexOf("."))},Upe=e=>{const{id:t,name:n,targetUrl:o,contentSource:r,linkType:a,imageUrl:i}=e;return{event:"ga4_select_promotion",ecommerce:{creative_slot:"popup_campaign",creative_name:Gx(i),promotion_id:t,promotion_name:n,link_type:a.toLowerCase(),content_source:r.toLowerCase(),target:o}}},Gpe=e=>{const{id:t,name:n,targetUrl:o,contentSource:r,linkType:a,imageUrl:i}=e;return{event:"ga4_view_promotion",ecommerce:{creative_slot:"popup_campaign",creative_name:Gx(i),promotion_id:t,promotion_name:n,link_type:a.toLowerCase(),content_source:r.toLowerCase(),target:o}}},$pe=e=>{const{id:t,name:n,targetUrl:o,linkType:r}=e;return{event:"popup_banner_close",id:t,name:n,target:o,link_type:r.toLowerCase(),location:"popup_campaign"}},Hpe=e=>{const{id:t,name:n,altText:o,targetUrl:r,linkType:a}=e;return{event:"select_promotion",ecommType:"enhanced",eventCategory:"E-commerce",eventAction:"POPUP_BANNER_CLICKED",ecommerce:{promoClick:{promotions:[{promotionType:"PopUp Banner",id:t,name:n,creative:o,targetUrl:r,linkType:a,position:""}]}}}},Vpe=e=>{const{id:t,name:n,targetUrl:o,linkType:r,altText:a}=e;return{event:"select_promotion",ecommType:"enhanced",eventCategory:"E-commerce",eventAction:"POPUP_BANNER_CLOSE",ecommerce:{promoClick:{promotions:[{promotionType:"PopUp Banner",id:t,name:n,targetUrl:o,linkType:r,position:"",creative:a}]}}}},Ype=e=>{const{id:t,name:n,altText:o,targetUrl:r,linkType:a}=e;return{event:"view_promotion",ecommType:"enhanced",eventCategory:"E-commerce",eventAction:"POPUP_BANNER_IMPRESSION",ecommerce:{promoView:{promotions:[{promotionType:"PopUp Banner",id:t,name:n,creative:o,targetUrl:r,linkType:a,position:""}]}}}},CH={POPUP_BANNER_CLICKED:"ga4_select_promotion",POPUP_BANNER_IMPRESSION:"ga4_view_promotion",POPUP_BANNER_CLOSE:"popup_banner_close"},Cj=e=>{const{type:t,payload:n}=e,{id:o,name:r,targetUrl:a,contentSource:i,linkType:l,imageUrl:c}=n;return{event:CH[t],ecommerce:{creative_slot:"popup_campaign",creative_name:Gx(c),promotion_id:o,promotion_name:r,link_type:l.toLowerCase(),content_source:i.toLowerCase(),target:a}}},Wpe=e=>{const{type:t,payload:n}=e,{id:o,name:r,targetUrl:a,linkType:i}=n;return{event:CH[t],id:o,name:r,target:a,link_type:i.toLowerCase(),location:"popup_campaign"}},qpe={POPUP_BANNER_CLICKED:"select_promotion",POPUP_BANNER_IMPRESSION:"view_promotion",POPUP_BANNER_CLOSE:"popup_banner_close"},Kpe=e=>{const{id:t,name:n,altText:o,targetUrl:r,linkType:a}=e;return{promotionType:"PopUp Banner",id:t,name:n,creative:o,targetUrl:r,linkType:a}},$x=(e,t)=>{const{type:n,payload:o}=e,r=Kpe(o);return{...SS(n,t,[r]),event:qpe[n]}},zpe=e=>$x(e,"promoView"),Qpe=e=>$x(e,"promoClick"),Xpe=e=>$x(e,"promoClick"),Zpe={POPUP_BANNER_CLICKED:Cj,POPUP_BANNER_IMPRESSION:Cj,POPUP_BANNER_CLOSE:Wpe},Jpe={POPUP_BANNER_CLICKED:Qpe,POPUP_BANNER_IMPRESSION:zpe,POPUP_BANNER_CLOSE:Xpe},eme="LOGIN_REGISTER_MODAL_CLICKED",tme="LOGIN_REGISTER_MODAL_DISPLAYED",sme="LOGIN_CLICKED",nme="LOGIN_FAILURE_ANALYTICS",ome="LOGIN_SUCCESS_ANALYTICS",rme="LOGIN_SUCCESS_ANALYTICS_GA4",ame="REGISTER_SUCCESS_ANALYTICS",ime="REGISTER_SUCCESS_ANALYTICS_GA4",lme="LOGOUT_ANALYTICS",cme="REGISTER_CLICKED",on={LOGIN_REGISTER_MODAL_CLICKED:eme,LOGIN_REGISTER_MODAL_DISPLAYED:tme,LOGIN_CLICKED:sme,LOGIN_FAILURE_ANALYTICS:nme,LOGIN_SUCCESS_ANALYTICS:ome,LOGIN_SUCCESS_ANALYTICS_GA4:rme,REGISTER_SUCCESS_ANALYTICS:ame,REGISTER_SUCCESS_ANALYTICS_GA4:ime,LOGOUT_ANALYTICS:lme,REGISTER_CLICKED:cme},dme=e=>({...Us,hitType:"event",eventCategory:"Login",eventAction:"LoginFailure",eventLabel:e.payload.error}),ume=e=>({...Us,hitType:"event",eventCategory:"Login",eventAction:"LoginSuccess",eventLabel:"LoginSuccess",retailerCustomerId:e.payload.retailerCustomerId,visitorId:e.payload.visitorId}),pme=e=>({event:"login",customer_id:e.payload.retailerCustomerId}),mme=e=>({...Us,hitType:"event",eventCategory:"Registration",eventAction:"RegistrationSuccess",eventLabel:"RegistrationSuccess",retailerCustomerId:e.payload.retailerCustomerId,visitorId:e.payload.visitorId}),hme=e=>({event:"sign_up",customer_id:e.payload.retailerCustomerId}),gme=e=>({...Us,hitType:"event",eventCategory:"Login",eventAction:"LogoutSuccess",eventLabel:"LogoutSuccess",retailerCustomerId:e.payload.retailerCustomerId}),Eme={[on.LOGIN_FAILURE_ANALYTICS]:dme,[on.LOGIN_SUCCESS_ANALYTICS]:ume,[on.LOGIN_SUCCESS_ANALYTICS_GA4]:pme,[on.REGISTER_SUCCESS_ANALYTICS]:mme,[on.REGISTER_SUCCESS_ANALYTICS_GA4]:hme,[on.LOGOUT_ANALYTICS]:gme},Te={ADD_BASKET_ITEM:"ADD_BASKET_ITEM",CHECKOUT_ORDER_BUTTON_CLICKED:"CHECKOUT_ORDER_BUTTON_CLICKED",CHECKOUT_ORDER_BUTTON_VIEWED:"CHECKOUT_ORDER_BUTTON_VIEWED",BOOK_SLOT_BUTTON_CLICKED:"BOOK_SLOT_BUTTON_CLICKED",BOOK_SLOT_BUTTON_VIEWED:"BOOK_SLOT_BUTTON_VIEWED",EMPTY_BASKET:"EMPTY_BASKET",EMPTY_TROLLEY_CARD_IMPRESSION:"EMPTY_TROLLEY_CARD_IMPRESSION",UNAVAILABLE_PRODUCTS:"UNAVAILABLE_PRODUCTS",MERGE_BASKET_CONFLICT:"MERGE_BASKET_CONFLICT",REDEEM_PAYMENT_CHECK_BUTTON_CLICKED:"REDEEM_PAYMENT_CHECK_BUTTON_CLICKED",REDIRECT_TO_SLOT_BOOKING:"REDIRECT_TO_SLOT_BOOKING",REMOVE_BASKET_ITEM:"REMOVE_BASKET_ITEM",START_SHOPPING:"START_SHOPPING",INSTANT_SHOP_TROLLEY_CARD_CLICKED:"INSTANT_SHOP_TROLLEY_CARD_CLICKED",INSTANT_SHOP_REMOVE_FROM_BASKET_MODAL:"INSTANT_SHOP_REMOVE_FROM_BASKET_MODAL",TROLLEY_VIEW_CHANGE_VIEW_TYPE_BUTTON_CLICKED:"TROLLEY_VIEW_CHANGE_VIEW_TYPE_BUTTON_CLICKED",UNAVAILABLE_ITEMS_MODAL_DISPLAYED:"UNAVAILABLE_ITEMS_MODAL_DISPLAYED",VOUCHER_ADD_SUCCESS:"VOUCHER_ADD_SUCCESS",VOUCHER_ADD_FAILURE:"VOUCHER_ADD_FAILURE",VOUCHER_REMOVED:"VOUCHER_REMOVED",SMART_CART_BUTTON_CLICKED:"SMART_CART_BUTTON_CLICKED",BUY_ALL_PRODUCTS:"BUY_ALL_PRODUCTS",EMPTY_BUTTON_CLICKED:"EMPTY_BUTTON_CLICKED",OPEN_MENU_CLICKED:"OPEN_MENU_CLICKED",MULTIPLE_DELIVERIES_MODAL:"MULTIPLE_DELIVERIES_MODAL",MINIMUM_BASKET_VALUE_NOT_REACHED_NOTIFICATION_DISPLAYED:"MINIMUM_BASKET_VALUE_NOT_REACHED_NOTIFICATION_DISPLAYED",MINIMUM_BASKET_VALUE_CHANGED_NOTIFICATION_DISPLAYED:"MINIMUM_BASKET_VALUE_CHANGED_NOTIFICATION_DISPLAYED",REMOVE_ALL_OUT_OF_STOCK_ITEMS_FROM_BASKET:"REMOVE_ALL_OUT_OF_STOCK_ITEMS_FROM_BASKET",VIEW_CART:"VIEW_CART",ADD_TO_CART_GA4:"ADD_TO_CART_GA4",SOME_ITEMS_UNABLE_TO_ADD_MODAL_DISPLAYED:"SOME_ITEMS_UNABLE_TO_ADD_MODAL_DISPLAYED",SOME_ITEMS_UNABLE_TO_ADD_IMPRESSION:"SOME_ITEMS_UNABLE_TO_ADD_IMPRESSION",ADD_PRODUCT_TO_ORDER_WITH_NO_ITEMS_REQUESTED:"ADD_PRODUCT_TO_ORDER_WITH_NO_ITEMS_REQUESTED",ADD_PRODUCT_TO_ORDER_MODAL_DISPLAYED:"ADD_PRODUCT_TO_ORDER_MODAL_DISPLAYED",NOT_NOW_BUTTON_CLICKED:"NOT_NOW_BUTTON_CLICKED",CLOSE_BUTTON_CLICKED:"CLOSE_BUTTON_CLICKED",MERGE_CART:"MERGE_CART",EMPTY_CART:"EMPTY_CART",SMALL_ORDER_CHARGE_MODAL_DISPLAYED:"SMALL_ORDER_CHARGE_MODAL_DISPLAYED",SMALL_ORDER_CHARGE_MODAL_LEARN_MORE_BUTTON_CLICKED:"SMALL_ORDER_CHARGE_MODAL_LEARN_MORE_BUTTON_CLICKED",SMALL_ORDER_CHARGE_MODAL_CLOSE_BUTTON_CLICKED:"SMALL_ORDER_CHARGE_MODAL_CLOSE_BUTTON_CLICKED",SMALL_ORDER_CHARGE_COMPONENT_CLICKED:"SMALL_ORDER_CHARGE_COMPONENT_CLICKED",SMALL_ORDER_CHARGE_SLOT_BOOKED_LEARN_MORE_BUTTON_CLICKED:"SMALL_ORDER_CHARGE_SLOT_BOOKED_LEARN_MORE_BUTTON_CLICKED"},l_=(e,t)=>(n,o)=>{const{payload:{addedByFunction:r,basket:a,page:i}}=n,l=a?.totals?.display?.itemPriceAfterPromos?.amount,c=a?.basketId;return{...Lx(e,t)(n,o),...l&&{basketTotalAmount:l},...c&&{basketId:c},addedByFunction:r,page:i}},fme={[Te.ADD_BASKET_ITEM]:l_("add","Add to Cart"),[Te.REMOVE_BASKET_ITEM]:l_("remove","Remove from Cart"),[Te.BUY_ALL_PRODUCTS]:l_("add","Add to Cart"),[Te.EMPTY_BASKET]:zr("Basket"),[Te.MERGE_BASKET_CONFLICT]:Lx("merge","Basket merge conflict"),[Te.START_SHOPPING]:zr("Basket")},Bn=(e,t)=>{if(e)return t&&t[e.productId]||e.featuredProductCampaign},yme=(e,t)=>{const{page:n,product:o,position:r,productListName:a}=e.payload,i=o.price?.current.currency||null,l=qs(t),c=Bn(o,l);return{event:"select_item",ecommerce:{currency:i,items:[ag({product:o,position:r,productListName:a,page:n,featuredProductCampaign:c})]}}},Ime=(e,t,n)=>e.map(o=>{const{product:r,productListName:a,position:i}=o,l=Bn(r,n),{campaignId:c=null,campaignName:d=null}=l||{},u=nd(a);return{item_id:r.retailerProductId,item_name:r?.name||null,index:i,item_brand:r?.brand||null,hfss_display_restriction_group:r?.hfssDisplayRestrictionGroup||null,item_list_name:a,item_variant:r?.size?.value||null,price:kl(r),rating:Ex(r),quantity:1,is_on_promotion:!!r?.offers?.length,promotion_ids:fx(r),is_favorite:!!r?.favorite,is_featured:u&&!!l,featured_campaign_id:u?c:null,featured_campaign_name:u?d:null,can_add_to_cart:Mx(r,t),...r.categoryPath&&kx(r.categoryPath),seller_id:r.seller?.id||null}}),Sme=(e,t)=>{const{impressions:n,page:o,currency:r}=e.payload,a=qs(t);return tH(n).map(l=>({event:"view_item_list",ecommerce:{currency:r,items:Ime(l,o,a)}}))},Cme=(e,t)=>{const{product:n,productListName:o,position:r}=e.payload,a=n.price?.current.currency||null,i=IS(n.productId)(t)||n.featuredProductCampaign,{campaignId:l=null,campaignName:c=null}=i||{},d=nd(o);return{event:"view_item",ecommerce:{currency:a,items:[{item_id:n.retailerProductId,item_name:n?.name||null,index:typeof r=="number"?r:null,item_brand:n?.brand||null,hfss_display_restriction_group:n?.hfssDisplayRestrictionGroup||null,item_list_name:o||null,item_variant:n?.size?.value||null,price:kl(n),rating:Ex(n),quantity:1,is_on_promotion:!!n?.offers?.length,promotion_ids:fx(n),is_favorite:!!n?.favorite,is_featured:d&&!!i,featured_campaign_id:d?l:null,featured_campaign_name:d?c:null,can_add_to_cart:Mx(n,"BOP"),image_count:n.images.length,...n.categoryPath&&kx(n.categoryPath),seller_id:n.seller?.id||null}]}}},Tme=e=>({event:"select_item_promotion",id:e.payload.itemId,name:e.payload.itemName,index:e.payload.index,promotion_id:e.payload.promotionId,promotion_name:e.payload.promotionName,list:e.payload.list}),_me={[fo.GA_BOP_PROMO_LINK_CLICKED]:Tme,[fo.GA_PRODUCT_DETAILS]:Oue,[fo.GA4_PRODUCT_DETAILS]:Cme},vme=e=>({...Us,hitType:"event",eventCategory:"Catalogue",eventAction:"NoResults",eventLabel:e.payload.term}),Ame=e=>({...Us,hitType:"event",eventCategory:"Catalogue",eventAction:"NoResultsBrowseClicked",eventLabel:e.payload.term}),bme=e=>({...Us,hitType:"event",eventCategory:"Catalogue",eventAction:"NoFilteredResults",eventLabel:e.payload.term}),xme=e=>({...Us,hitType:"event",eventCategory:"Catalogue",eventAction:"NoFilteredResultsClearFiltersClicked",eventLabel:e.payload.term}),Rme=e=>({...Us,hitType:"event",eventCategory:"Catalogue",eventAction:"ShowCategory",eventLabel:e.payload.retailerId,categoryName:e.payload.categoryName}),Dme=(e,t)=>{const n=e.payload.product.at(0),o=t.data.products.productEntities[n?.productId];if(!(!o||!("favorite"in n)))return n.favorite===void 0?{...Us,hitType:"event",eventCategory:"FAVORITES",eventAction:"ManualRemoveFromFavorites",eventLabel:o.retailerProductId}:{...Us,hitType:"event",eventCategory:"FAVORITES",eventAction:"ManualAddToFavorites",eventLabel:o.retailerProductId}},Ome=e=>({event:"search_no_results",search_term:e.payload.term}),Pme=e=>({event:"apply_filter",type:e.payload.pageType,filters:e.payload.filters}),Nme=e=>({event:"filter_no_results",type:e.payload.pageType,filters:e.payload.filters}),Lme=e=>({event:"apply_sort",type:e.payload.pageType,sort:e.payload.sortOptionId}),kme="CATALOGUE_ATTRIBUTES",Mme="CATALOGUE_NO_RESULTS",jme="SEARCH_NO_RESULTS",wme="CATALOGUE_NO_RESULTS_BROWSE_CLICKED",Fme="NO_FILTERED_RESULTS_RETURNED",Bme="OPEN_MENU",Ume="OPEN_MENU_CLICKED",Gme="CLEAR_ALL_FILTERS_BUTTON_CLICKED",$me="SHOW_CATEGORY_PAGE_EVENT",Hme="FAVORITES_TAB_CLICKED",Vme="LISTS_TAB_CLICKED",Yme="SMART_CART_TAB_CLICKED",Wme="REGULARS_TAB_CLICKED",qme="NO_FILTERED_RESULTS_RETURNED_CLEAR_FILTERS_BUTTON_CLICKED",Kme="CLEAR_SELECTED_FILTERS_BUTTON_CLICKED",zme="SHOW_ALL_FAVORITES_FILTER_BUTTON_CLICKED",Qme="SHOW_ALL_FAVORITES_FILTER_BUTTON_IMPRESSION",Xme="APPLY_FILTER_EVENT",Zme="FILTER_NO_RESULT",Jme="APPLY_SORT_EVENT",ehe="BACK_TO_TOP_BUTTON_CLICKED",gt={CATALOGUE_ATTRIBUTES:kme,CATALOGUE_NO_RESULTS:Mme,SEARCH_NO_RESULTS:jme,CATALOGUE_NO_RESULTS_BROWSE_CLICKED:wme,NO_FILTERED_RESULTS_RETURNED:Fme,OPEN_MENU:Bme,OPEN_MENU_CLICKED:Ume,CLEAR_ALL_FILTERS_BUTTON_CLICKED:Gme,SHOW_CATEGORY_PAGE_EVENT:$me,FAVORITES_TAB_CLICKED:Hme,LISTS_TAB_CLICKED:Vme,REGULARS_TAB_CLICKED:Wme,SMART_CART_TAB_CLICKED:Yme,CLEAR_SELECTED_FILTERS_BUTTON_CLICKED:Kme,NO_FILTERED_RESULTS_RETURNED_CLEAR_FILTERS_BUTTON_CLICKED:qme,SHOW_ALL_FAVORITES_FILTER_BUTTON_CLICKED:zme,SHOW_ALL_FAVORITES_FILTER_BUTTON_IMPRESSION:Qme,APPLY_FILTER_EVENT:Xme,FILTER_NO_RESULT:Zme,APPLY_SORT_EVENT:Jme,BACK_TO_TOP_BUTTON_CLICKED:ehe},TH=ee("DECORATE_PRODUCTS"),ig={SET_PRODUCTS:"SET_PRODUCTS",SET_CHECKOUT_VALIDATION_PRODUCTS:"SET_CHECKOUT_VALIDATION_PRODUCTS",CLEAR_PRODUCTS:"CLEAR_PRODUCTS",UPDATE_PRODUCTS:"UPDATE_PRODUCTS"},the=e=>({type:ig.UPDATE_PRODUCTS,payload:e}),she=e=>({type:ig.SET_PRODUCTS,payload:e}),nhe=e=>({type:ig.SET_CHECKOUT_VALIDATION_PRODUCTS,payload:{products:e}}),ohe=()=>({type:ig.CLEAR_PRODUCTS}),rhe=e=>({type:"API",payload:{url:"/v6/products",service:"web_product_page_ws",pathPrefix:{client:"/api/webproductpagews",server:"/core-api"},skipLoginRedirect:!0,options:{method:"PUT",body:e},...TH}}),Ft={setProducts:she,setCheckoutValidationProducts:nhe,clearProducts:ohe,decorateProductsPPWSAction:rhe,updateProducts:the,types:{...ig,DECORATE_PRODUCTS:TH}},ahe={[gt.CATALOGUE_NO_RESULTS]:vme,[gt.CATALOGUE_NO_RESULTS_BROWSE_CLICKED]:Ame,[gt.NO_FILTERED_RESULTS_RETURNED]:bme,[gt.NO_FILTERED_RESULTS_RETURNED_CLEAR_FILTERS_BUTTON_CLICKED]:xme,[gt.SHOW_CATEGORY_PAGE_EVENT]:Rme,[gt.SEARCH_NO_RESULTS]:Ome,[gt.APPLY_FILTER_EVENT]:Pme,[gt.FILTER_NO_RESULT]:Nme,[gt.APPLY_SORT_EVENT]:Lme,[Ft.types.UPDATE_PRODUCTS]:Dme},tn={SHOP_IN_SHOP_CATEGORY_PAGE_VIEW:"SHOP_IN_SHOP_CATEGORY_PAGE_VIEW",HORIZONTAL_HERO_BANNER_IMPRESSION:"CA_HERO_IMAGE_BANNER_IMPRESSION",SUB_CATEGORY_IMAGE_IMPRESSION:"CA_SUB_CATEGORY_IMAGE_IMPRESSION",SUB_CATEGORY_IMAGE_CLICKED:"CA_SUB_CATEGORY_IMAGE_CLICKED",VIEW_CATEGORY_PAGE_VIEW:"VIEW_CATEGORY_PAGE_VIEW",SELECT_CATEGORY_GA4_EVENT:"SELECT_CATEGORY_GA4_EVENT",CATEGORY_FILTER_OPTION_CLICKED:"CATEGORY_FILTER_OPTION_CLICKED"},Ad={HORIZONTAL_HERO_BANNER_IMPRESSION:"HERO_IMAGE_BANNER_IMPRESSION",SUB_CATEGORY_IMAGE_IMPRESSION:"SUB_CATEGORY_IMAGE_IMPRESSION",SUB_CATEGORY_IMAGE_CLICKED:"SUB_CATEGORY_IMAGE_CLICKED",CATEGORY_FILTER_OPTION_CLICKED:"CATEGORY_FILTER_OPTION_CLICKED"},ihe=({payload:e})=>({...Hs,event:"view_promotion",eventCategory:"Event page",eventAction:Ad.HORIZONTAL_HERO_BANNER_IMPRESSION,ecommerce:{promoView:{promotions:[{promotionType:"Category Event",id:e.id,name:e.name,creative:e.imageId,position:"Hero Image"}]}}}),lhe=({payload:e})=>({...Hs,event:"view_promotion",eventCategory:"Event page",eventAction:Ad.SUB_CATEGORY_IMAGE_IMPRESSION,ecommerce:{promoView:{promotions:[{promotionType:"Category Event",id:e.id,name:e.subCategoryName,creative:e.imageId,position:`Sub category image ${e.sequence}`}]}}}),che=({payload:e})=>({...Hs,event:"select_promotion",eventCategory:"Event page",eventAction:Ad.SUB_CATEGORY_IMAGE_CLICKED,ecommerce:{promoClick:{promotions:[{promotionType:"Category Event",id:e.id,name:e.subCategoryName,creative:e.imageId,position:`Sub category image ${e.sequence}`}]}}}),dhe=({payload:e})=>({event:e.event,name:e.name,id:e.id,type:e.pageType}),uhe=({payload:e})=>({id:e.id,name:e.subCategoryName,event:e.event,navigation:"subcategory",type:e.pageType,index:Number(e.sequence)}),phe=({payload:e})=>({id:e.retailerCategoryId,name:e.categoryName,event:"view_category",category1:e.category1,category2:e.category2,category3:e.category3,category4:e.category4,category5:e.category5,category_more:e.categoryMore}),mhe=({payload:e})=>({id:e.retailerCategoryId,name:e.categoryName,event:"select_category",location:e.location}),hhe={[tn.HORIZONTAL_HERO_BANNER_IMPRESSION]:ihe,[tn.SUB_CATEGORY_IMAGE_IMPRESSION]:lhe,[tn.SUB_CATEGORY_IMAGE_CLICKED]:che,[tn.VIEW_CATEGORY_PAGE_VIEW]:phe,[tn.SELECT_CATEGORY_GA4_EVENT]:mhe},ghe={[tn.SHOP_IN_SHOP_CATEGORY_PAGE_VIEW]:dhe,[tn.SUB_CATEGORY_IMAGE_CLICKED]:uhe},Ehe=(e,t)=>{const n=e[t];return n?.price?.original?{...n,price:{current:n.price?.original,unit:{label:n.price.unit.label,current:n.price.unit.original??n.price.unit.current}}}:n},fhe=ns.products.productEntities,yhe=(e=fhe,t)=>{switch(t.type){case Ft.types.SET_PRODUCTS:return{...e,...t.payload.product};case Ft.types.UPDATE_PRODUCTS:{const n=t.payload.product.reduce((o,r)=>{const{productId:a}=r;if(a){if(e[a])return o[a]={...e[a],...r},o;t.payload.upsert&&(o[a]=r)}return o},{});return{...e,...n}}case Ft.types.CLEAR_PRODUCTS:return{};default:return e}},Ts=({data:e})=>e.products.productEntities,sl=(e,t)=>V(Ts,n=>n&&n[t])(e),G7t=(e,t)=>V(Ts,n=>n&&Object.values(n).find(o=>o.retailerProductId===t))(e),Ihe=(e,t)=>V(Ts,n=>n&&Ehe(n,t))(e),She=V(sl,e=>e&&e.maxQuantityReached),Hx=e=>t=>t.data.basket?.checkoutGroups?.find(n=>n?.checkout?.shippingGroupType===e)?.items||[],Vx=e=>e.data.products.basket.isFetching,Che=e=>e.data.products.basket.lastUpdated!==null,Yx=(e,t)=>e?.length?e.map(({productId:n,quantity:o})=>({...t[n],productId:n,quantity:o})):[],Jn=V(Id,Ts,Yx),The=V(Jn,e=>e.filter(({available:t})=>t===!1)),_he=e=>V(Hx(e),Ts,Yx),CS=e=>e.data.basket?.unassignedItems||[],vhe=V(CS,Ts,Yx),Ahe=V(Jn,e=>!!e.filter(t=>t.alcohol).length),bhe=(e,t)=>{const n=Jn(t).map(o=>Ys(o));return{...Hs,eventCategory:vd,eventLabel:"Not Set",eventAction:"CheckoutWalk",ecommerce:{checkout:{actionField:{step:3},products:n}}}},Kn={CHECKOUT_WALK:"CHECKOUT_WALK",CHECKOUT_WALK_GA4:"CHECKOUT_WALK_GA4",CHECKOUT_WALK_FREE_GIFT:"CHECKOUT_WALK_FREE_GIFT",ADD_FREE_GIFT_CLICKED:"ADD_FREE_GIFT_CLICKED",REMOVE_FREE_GIFT_CLICKED:"REMOVE_FREE_GIFT_CLICKED",CONTINUE_SHOPPING_CLICKED:"CONTINUE_SHOPPING_CLICKED"},xhe={[Kn.CHECKOUT_WALK]:bhe},uh="newlyCreatedOrderId",Rhe=D("co.last"),Dhe=e=>{if(e.nonSavedFundingInstrument)return"NOT SAVED";switch(e.paymentMethodV2){case"CARDS":return"CARD";case"PAYPAL":return"PAYPAL";case"INVOICE":return"INVOICE";default:return"UNKNOWN"}},Ohe=e=>{const t=Mt(e);return{slotBookingDay:t.isoWeekday(),slotBookingTime:t.format(vn),slotBookingDate:t.format(oa)}},_H=(e,t,n,o)=>({...e&&{deliveryType:e},...t&&{loyaltyDiscount:t},...o&&{paymentMethodType:Dhe(o)},...n&&Ohe(n)}),Tj=(e,t,n,o)=>{const{orderId:r,editedOrder:a,revenue:i,tax:l,orderTotals:c,deliveryType:d,paymentInfo:u,appliedVouchers:m,charges:g,loyalty:f,deliveryStartDate:y}=e;let I,S,C,_=a?"edited-order":"new-order";const A=g.delivery.amount,x=m.map(O=>O.id).join(", "),R=c.totalPrice.currency;return n===0?(I=i,S=l,C=f&&f.spent.money.amount):(_+="-continued",I="0",S="0",C=f&&"0"),o&&(_+="-last"),{...Hs,eventLabel:_,eventAction:"OrderPurchased",ecommerce:{currencyCode:R,purchase:{actionField:{id:r,revenue:Number(I),tax:S,coupon:x,shipping:Number(A)},products:t.map(O=>Ys({...O,quantity:`${O.quantity}`},void 0,void 0))}},..._H(d,C,y,u)}},Phe=(e,t)=>{const{product:n}=e.payload,o=25;if(!n.length)return[Tj(e.payload,[],0,!1)];const r=Math.ceil(n.length/o),a=[];for(let i=0;i<r;i+=1)a.push(n.slice(i*o,(i+1)*o));return a.map((i,l)=>Tj(e.payload,i,l,l+1===r&&Rhe(t)))},Nhe=ee("GET_DELIVERY_STATUS"),Lhe=e=>({type:"API",payload:{url:`/ecomfulfillments/v1/order-tracking/delivery-status?orderId=${e}`,options:{method:"GET"},service:"ecomfulfillments",...Nhe}}),vH="SET_DELIVERY_STATUS",khe=e=>({type:vH,payload:e}),Mhe=e=>{const{currentState:t,fulfillmentDeliveryStartedState:n,upcomingFulfillmentDeliveryState:o,fulfillmentArrivedState:r,deliveryTimeData:a}=e;switch(t){case"PLANNED_DELIVERY":return pm(t,a?.expectedDeliveryTime,a?.expectedDeliveryTimeWindow);case"WE_ARE_ON_THE_WAY":return pm(t,n?.estimatedTimeArrival,n?.estimatedTimeWindowOfArrival);case"YOU_ARE_NEXT":return pm(t,o?.estimatedTimeArrival,o?.estimatedTimeWindowOfArrival,o?.status);case"WE_ARE_HERE":return pm(t,r.arrivalTime);default:return pm(t)}},pm=(e,t,n,o)=>({deliveryInfo:{currentState:e,deliveryState:{status:o,estimatedTimeArrival:t,estimatedTimeWindowOfArrival:n}}}),Af=ee("GET_ORDERS"),jhe=()=>({type:"API",payload:{url:"/v6/orders",service:"web_order_ws",pathPrefix:{client:"/api/order",server:"/core-api"},options:{method:"GET"},...Af}}),whe="SET_ORDERS",lg=e=>({type:"SET_ORDERS",payload:e}),AH=ee("GET_PAST_ORDERS"),bH=ee("GET_PAST_ORDERS_PAGE"),Fhe=()=>({type:"API",payload:{url:"/v6/orders/past",service:"web_order_ws",pathPrefix:{client:"/api/order",server:"/core-api"},options:{method:"GET"},...AH}}),Bhe=e=>({type:"API",payload:{url:"/v6/orders/past",service:"web_order_ws",pathPrefix:{client:"/api/order",server:"/core-api"},options:{headers:{"next-page-token":e?e.nextPageToken:null},method:"GET"},...bH}}),Uhe="SET_PAST_ORDERS",xH=e=>({type:"SET_PAST_ORDERS",payload:e}),iu={actionTypes:{GET_PAST_ORDERS:AH,GET_PAST_ORDERS_PAGE:bH}},c_=(e,t)=>(e&&e.length)>0?e:t,Ghe=({oldEntity:e,entityFromAction:t})=>({...t,loyalty:t.loyalty?t.loyalty:null,paymentInfo:t.paymentInfo.paymentMethod!=="UNKNOWN"?t.paymentInfo:e.paymentInfo,items:c_(t.items,e.items),missingItems:c_(t.missingItems,e.missingItems),substitutedItems:c_(t.substitutedItems,e.substitutedItems)}),d_=(e,t)=>{const n={...e,...t};return t&&Object.keys(t).forEach(o=>{if(e[o]){const r=e[o],a=t[o];n[o]=Ghe({oldEntity:r,entityFromAction:a})}}),n},$he=(e,t)=>{if(!e||!t||!e[t.orderId])return e;const n={...e[t.orderId],...Mhe(t)},o={...e};return o[t.orderId]=n,o},Hhe=(e=ns.orders.orderEntities,t)=>{switch(t.type){case whe:return{...d_(e,t.payload.order),lastUpdated:le()};case e1:return d_(e,t.payload.order);case Uhe:return d_(e,t.payload.order);case vH:return $he(e,t.payload);default:return e}},Vhe=({data:e})=>e.orders.orderEntities,nl=(e,t)=>V(Vhe,n=>n&&n[t])(e);function Yhe(e,t){const{orderId:n}=e.payload,o=nl(t,n);return{...Hs,eventLabel:o.wasEdited?"edited-confirmed-order":"new-confirmed-order",eventAction:"OrderConfirmed",ecommerce:{currencyCode:o.orderTotals?.totalPrice?.currency,purchase:{actionField:{id:o.orderId,editedOrder:o.wasEdited,coupon:o.appliedVouchers.map(r=>r.id).join(", "),shipping:Number(o.charges.delivery.amount)},products:o.products?.length?[o.products[0]]:[]}}}}const Whe=(e,t)=>{const n=Jn(t).map(o=>Ys(o));return{...Hs,eventCategory:vd,eventLabel:"Not Set",eventAction:"PaymentSelected",ecommerce:{checkout:{actionField:{step:5},products:n}}}},qhe=(e,t)=>{const n=Jn(t).map(o=>Ys(o));return{...Hs,eventCategory:vd,eventAction:"CheckoutConfirmation",eventLabel:"Not Set",ecommerce:{checkout:{actionField:{step:6,option:e.payload.isEditedOrder?"edited-order":"new-order"},products:n}}}},Khe=(e,t)=>{const n=Jn(t).map(o=>Ys(o));return{...Hs,eventCategory:vd,eventAction:"BeginCheckout",eventLabel:"Not Set",ecommerce:{checkout:{actionField:{step:1},products:n}}}},zhe=(e,t)=>{const n=Jn(t).map(o=>Ys(o));return{...Hs,eventCategory:vd,eventLabel:"Not Set",eventAction:"CheckoutSummary",ecommerce:{checkout:{actionField:{step:4},products:n}}}},_e={APPLICABLE_LOYALTY:"APPLICABLE_LOYALTY",PLACE_ORDER_CONFIRMATION:"PLACE_ORDER_CONFIRMATION",BEGIN_CHECKOUT:"BEGIN_CHECKOUT",RECURRING_SHOPPING_DEFINITION_FORM_CARD_IMPRESSION:"RECURRING_SHOPPING_DEFINITION_FORM_CARD_IMPRESSION",RECURRING_SHOPPING_DEFINITION_LABEL_WRITTEN:"RECURRING_SHOPPING_DEFINITION_LABEL_WRITTEN",RECURRING_SHOPPING_DEFINITION_FREQUENCY_SELECTED:"RECURRING_SHOPPING_DEFINITION_FREQUENCY_SELECTED",TOAST_NOTIFICATION_DISPLAYED:"TOAST_NOTIFICATION_DISPLAYED",CHECKOUT_SUMMARY_DISPLAYED:"CHECKOUT_SUMMARY_DISPLAYED",DELIVERY_CARD_IMPRESSION:"DELIVERY_CARD_IMPRESSION",CHANGE_DELIVERY_BUTTON_CLICKED:"CHANGE_DELIVERY_BUTTON_CLICKED",SELECT_PAYMENT:"SELECT_PAYMENT",PAYMENT_BUFFER_MODAL_DISPLAYED:"PAYMENT_BUFFER_MODAL_DISPLAYED",FIND_OUT_MORE_BUTTON_CLICKED:"FIND_OUT_MORE_BUTTON_CLICKED",VOUCHER_BUTTON_CLICKED:"VOUCHER_BUTTON_CLICKED",VOUCHERS_ADDED_TO_ORDER:"VOUCHERS_ADDED_TO_ORDER",AGE_CHECK_CONFIRMED:"AGE_CHECK_CONFIRMED",ORDER_PURCHASED:"ORDER_PURCHASED",SELECT_PLACE_ORDER:"SELECT_PLACE_ORDER",ORDER_CONFIRMED:"ORDER_CONFIRMED",PLACE_ORDER:"PLACE_ORDER",RECURRING_ORDER_CREATED:"RECURRING_ORDER_CREATED",PAYMENT_CHECK_BUTTON_CLICKED:"PAYMENT_CHECK_BUTTON_CLICKED",CONCIERGE_CHECK_BOX_CHECKED:"CONCIERGE_CHECK_BOX_CHECKED",CONCIERGE_CHECK_BOX_UNCHECKED:"CONCIERGE_CHECK_BOX_UNCHECKED",CONCIERGE_TERMS_AND_CONDITIONS_CLICKED:"CONCIERGE_T&C_CLICKED",PHARMACY_FORM_DISPLAYED:"PHARMACY_FORM_DISPLAYED",PHARMACY_FORM_DELETE_ITEM_CLICKED:"PHARMACY_FORM_DELETE_ITEM_CLICKED",PHARMACY_FORM_SUBMIT_CLICKED:"PHARMACY_FORM_SUBMIT_CLICKED",PHARMACY_FORM_IFRAME_LOADING_ERROR:"PHARMACY_FORM_IFRAME_LOADING_ERROR",SUBMIT_FEEDBACK_INTERACTION:"SUBMIT_FEEDBACK_INTERACTION",SUBMIT_FEEDBACK_BUTTON_CLICKED:"SUBMIT_FEEDBACK_BUTTON_CLICKED",SUBMIT_FEEDBACK_IMPRESSION:"SUBMIT_FEEDBACK_IMPRESSION",LOYALTY_POINTS_BUTTON_CLICKED:"LOYALTY_POINTS_BUTTON_CLICKED",LOYALTY_POINTS_DISPLAYED:"LOYALTY_POINTS_DISPLAYED",LOYALTY_POINTS_ADD_SUCCESS:"LOYALTY_POINTS_ADD_SUCCESS",LOYALTY_POINTS_ADD_FAILURE:"LOYALTY_POINTS_ADD_FAILURE",LOYALTY_POINTS_REMOVED_ALERT_DISPLAYED:"LOYALTY_POINTS_REMOVED_ALERT_DISPLAYED",LOYALTY_POINTS_REFUNDED_ALERT_DISPLAYED:"LOYALTY_POINTS_REFUNDED_ALERT_DISPLAYED",PAYMENT_PROMOTION_APPLIED_TOAST_DISPLAYED:"PAYMENT_PROMOTION_APPLIED_TOAST_DISPLAYED",LOYALTY_POINTS_CANNOT_BE_APPLIED_ALERT_DISPLAYED:"LOYALTY_POINTS_CANNOT_BE_APPLIED_ALERT_DISPLAYED",PAYMENT_TYPE_SELECTED:"PAYMENT_TYPE_SELECTED"},RH={[_e.CHANGE_DELIVERY_BUTTON_CLICKED]:"User clicked change delivery button",[_e.SUBMIT_FEEDBACK_INTERACTION]:"Customer interacted with the next order feedback options",[_e.SUBMIT_FEEDBACK_BUTTON_CLICKED]:"Customer submitted the next order feedback"},Qhe={[_e.PLACE_ORDER_CONFIRMATION]:qhe,[_e.BEGIN_CHECKOUT]:Khe,[_e.CHECKOUT_SUMMARY_DISPLAYED]:zhe,[_e.SELECT_PAYMENT]:Whe,[_e.ORDER_PURCHASED]:Phe,[_e.ORDER_CONFIRMED]:Yhe},ol=e=>{const[t,n,o,r,a,...i]=e;return{item_category:t||null,item_category2:n||null,item_category3:o||null,item_category4:r||null,item_category5:a||null,item_category_more:i.length?i.join(","):null}},DH=e=>{const{item:t,itemsAnalyticsPayload:n,getState:o}=e,r=o(),{productId:a}=t,i=n.find(({product:y})=>y.productId===a),l=On(r),c=Td(r,window.location),d=i?.productListName||Ws(i?.page,"",i?.section),u=IS(i?.product?.productId)(r)||i?.product?.featuredProductCampaign,m=u?.campaignId,g=u?.campaignName,f={itemListName:d||void 0,featured:m||g?{campaignId:m,campaignName:g}:void 0,favorite:!!i?.product?.favorite,pageViewId:l,pageType:c};return{...t,meta:f}},tc=e=>{const{productId:t,item:n,meta:o}=e,r=o?.items?.find(({productId:f})=>t===f);if(!r)return n;const{meta:{itemListName:a,favorite:i,featured:{campaignName:l,campaignId:c}={}}}=r,d=a??n.item_list_name,u=nd(d),m=c??n.featured_campaign_id,g=l??n.featured_campaign_name;return{...n,is_favorite:i??n.is_favorite,item_list_name:d,is_featured:u&&!!(l||c||n.is_featured),featured_campaign_id:u?m:null,featured_campaign_name:u?g:null}},Xhe={BRANDED_VAN:"home_delivery",C_N_C:"click_and_collect"},Zhe=e=>{const t=e?Mt(e):null;return{slot_day:t?.isoWeekday(),slot_start_time:t?.format(vn),slot_date:t?.format(oa),slot_end_time:""}},OH=(e,t,n)=>{const{id:o,name:r,brand:a,price:i,quantity:l,isOnPromotion:c,isFavorite:d,productId:u}=Ys(e),m=Bn(e,n),g={item_id:o||null,item_name:r,index:null,item_brand:a,hfss_display_restriction_group:e?.hfssDisplayRestrictionGroup||null,item_list_name:null,item_variant:e.variant,price:i?Number(i):null,rating:null,quantity:Number(l),is_on_promotion:c,promotion_ids:e.offers?.map(f=>f.retailerPromotionId).join(",")||null,is_favorite:d,is_featured:!!m,featured_campaign_id:m?.campaignId||null,featured_campaign_name:m?.campaignName||null,...ol(e?.categoryPath??[]),seller_id:e.sellerId||null};return tc({productId:u,item:g,meta:t})},PH=(e,t,n,o,r,a,i)=>{const{orderId:l,groupId:c,editedOrder:d,tax:u,orderTotals:{totalPrice:m,finalPrice:g},appliedVouchers:f,charges:y,loyalty:I,deliveryStartDate:S,deliveryType:C}=e,_=d?"edited-order":"new-order",A=y.delivery.amount,x=f.map(w=>w.id).join(", "),R=m.currency,O=le(),N=I?.spent?.money.amount,k=w=>`${l}-${O}-part${w}`,j=Object.entries(y).reduce((w,[L,B])=>"amount"in B&&L!=="delivery"?w+Number(B.amount):w,0);return{event:"select_place_order",osp_transaction_id:l,ecommerce:{transaction_type:_,transaction_id:k(r),group_id:c||null,total_value:m.amount?Number(m.amount):null,value:g.amount?Number(g.amount):null,tax:n?Number(u):0,shipping:A?Number(A):null,loyalty:N?Number(N):null,currency:R,coupon:x,charges:j,items:t.map(w=>o(w,a,i))},...Zhe(S),fulfillment_method:Xhe[C]}},Jhe=(e,t)=>{const{product:n,meta:o}=e.payload,r=15,a=qs(t),i=Math.ceil(n.length/r),l=[];for(let d=0;d<i;d+=1)l.push(n.slice(d*r,(d+1)*r));const c=d=>d===0;return l.map((d,u)=>PH(e.payload,d,c(u),OH,u,o,a))},ege={CUSTOMER_COLLECTION:"click_and_collect",HOME_DELIVERY:"home_delivery"},tge=e=>{const t=e?Zr(e):null;return{slot_day:t?.isoWeekday(),slot_start_time:t?.format(vn),slot_date:t?.format(oa),slot_end_time:""}},Ty=(e,t,n)=>{const o=Ys(e),r=Bn(e,n),a={item_id:o.id||null,item_name:o.name,index:null,item_brand:o.brand,hfss_display_restriction_group:e?.hfssDisplayRestrictionGroup||null,item_list_name:null,item_variant:e.variant,price:o.price?Number(o.price):null,rating:null,quantity:Number(o.quantity),is_on_promotion:o.isOnPromotion,promotion_ids:e.offers?.map(i=>i.retailerPromotionId).join(",")||null,is_favorite:o.isFavorite,is_featured:!!r,featured_campaign_id:r?.campaignId||null,featured_campaign_name:r?.campaignName||null,...ol(e?.categoryPath??[]),seller_id:e.sellerId||null};return tc({productId:o.productId,item:a,meta:t})},_y=e=>{const{payload:t,productChunk:n,isFirstChunk:o,index:r,mapProductToItem:a,featuredProductCampaigns:i}=e,{orderId:l,groupId:c,editedOrder:d,tax:u,orderTotals:{totalPrice:m},appliedVouchers:g,charges:f,loyalty:y,deliveryStartDate:I,deliveryMethod:S,meta:C,revenue:_}=t,A=d?"edited-order":"new-order",x=f.delivery.amount,R=g.map(L=>L.id).join(", "),O=m.currency,N=le(),k=y?.spent?.money.amount,j=L=>`${l}-${N}-part${L}`,w=Object.entries(f).reduce((L,[B,W])=>"amount"in W&&B!=="delivery"?L+Number(W.amount):L,0);return{event:"purchase",ecommerce:{osp_transaction_id:l,transaction_type:A,transaction_id:j(r),group_id:c||null,total_value:m.amount?Number(m.amount):null,value:o?Number(_):0,tax:o?Number(u):0,shipping:x?Number(x):null,loyalty:k?Number(k):null,currency:O,coupon:R,charges:w,items:n.map(L=>a(L,C,i))},...tge(I),fulfillment_method:ege[S]}},sge=(e,t)=>{const{product:n}=e.payload,o=qs(t);if(!n.length)return[_y({payload:e.payload,productChunk:[],isFirstChunk:!0,mapProductToItem:Ty,index:0,featuredProductCampaigns:o})];const r=15,a=Math.ceil(n.length/r),i=[];for(let c=0;c<a;c+=1)i.push(n.slice(c*r,(c+1)*r));const l=c=>c===0;return i.map((c,d)=>_y({payload:e.payload,productChunk:c,isFirstChunk:l(d),mapProductToItem:Ty,index:d,featuredProductCampaigns:o}))},nge=(e,t,n)=>{const{brand:o,variant:r,price:a,quantity:i,isFavorite:l,isOnPromotion:c,position:d,productId:u}=Ys(e),m=e.ratingSummary?.overallRating,g=Bn(e,n),f={item_id:e.retailerProductId||null,item_name:e.name,index:d||null,item_brand:o,hfss_display_restriction_group:e.hfssDisplayRestrictionGroup??null,item_list_name:null,item_variant:r,price:a,rating:m?Number(m):null,quantity:Number(i),is_on_promotion:c,is_favorite:l,is_featured:!!g,featured_campaign_id:g?.campaignId||null,featured_campaign_name:g?.campaignName||null,...ol(e?.categoryPath??[]),seller_id:e.seller?.id||null};return tc({productId:u,item:f,meta:t})},oge=(e,t)=>{const{payload:{meta:n}}=e,o=At(t)||null,r=qs(t),a=Jn(t).map(c=>nge(c,n,r)),i=pa(t),l=Fo(t);return{event:"begin_checkout",ecommerce:{currency:i?.currency||null,value:i?.amount?Number(i.amount):null,osp_transaction_id:o,group_id:l,items:a}}},NH=ee("GET_DELIVERABILITY_BY_ADDRESS_DETAILS"),LH=ee("FETCH_DETAILS_FOR_ADDRESS"),kH=ee("GET_CUSTOMER_ADDRESSES"),MH=ee("POST_CUSTOMER_ADDRESSES"),jH=ee("FETCH_ADDRESSES_BY_SEARCH_TERM"),wH=ee("FETCH_ADDRESSES_BY_POSTCODE"),rge=(e,t)=>({type:"API",payload:{url:`/v3/address-deliverability/by-address-details?countryCode=${t}`,service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},options:{method:"POST",body:e},...NH}}),age=e=>({type:"API",payload:{url:"/v1/addresses/by-search-term",service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},options:{method:"PUT",body:{query:e}},...jH}}),ige=(e,t=!1)=>{const n=new URLSearchParams;return t&&n.append("sorted",t.toString()),{type:"API",payload:{url:`/v1/addresses/by-postcode${n.toString()?`?${n.toString()}`:""}`,service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},options:{method:"PUT",body:{postcode:e}},...wH}}},lge=e=>({type:"API",payload:{url:`/v1/addresses/lookup/${e}/details`,service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},...LH}}),FH=()=>({type:"API",payload:{service:"ecomdeliverydestinations",url:"/ecomdeliverydestinations/v4/delivery-addresses?deliveryMethod=HOME_DELIVERY",...kH}}),cge=e=>({type:"API",payload:{url:"/v3/customer-addresses",service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},options:{method:"POST",body:e},...MH}}),wn={types:{GET_DELIVERABILITY_BY_ADDRESS_DETAILS:NH,FETCH_ADDRESSES_BY_SEARCH_TERM:jH,FETCH_ADDRESSES_BY_POSTCODE:wH,FETCH_DETAILS_FOR_ADDRESS:LH,GET_CUSTOMER_ADDRESSES:kH,POST_CUSTOMER_ADDRESSES:MH},getDeliverabilityByAddressDetails:rge,fetchAddressesBySearchTerm:age,fetchAddressesByPostcode:ige,fetchDetailsForAddress:lge,getCustomerAddresses:FH,postCustomerAddresses:cge},dge=(e=ns.customer.addresses,t)=>{switch(t.type){case wn.types.GET_CUSTOMER_ADDRESSES.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case wn.types.GET_CUSTOMER_ADDRESSES.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case wn.types.GET_CUSTOMER_ADDRESSES.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:t.payload.responseData};case Cy.types.REMOVE_CUSTOMER_ADDRESS.SUCCESS:return{...e,lastUpdated:le(),data:e.data.filter(n=>n.id?n.id!==t.id:n.addressId!==t.id)};default:return e}},uge=e=>e.map(t=>({...t,id:t.addressId,regionId:t.resolvedRegionId||t.regionId,deliverable:t.deliverability==="DELIVERABLE",nickname:t.name,addressLine:t.formattedAddress,notes:t.deliveryInstructions})),bd=({data:e})=>({...e.customer.addresses,data:uge(e.customer.addresses.data)}),pge=({data:e})=>(e.customer.addresses.data||[]).length,Wx=({data:e})=>e.customer.addresses.isFetching,mge=({data:e})=>!!e.customer.addresses.data.length;V(({data:e})=>e.customer.addresses,e=>!!e.data.length&&e.data.find(t=>t.deliverable)!==void 0);const BH=V(bd,e=>e.data.reduce((t,n)=>({...t,[n.addressId]:n.deliverable}),{})),hge=e=>qe(e,"address-lookup-flow-main"),gge=e=>qe(e,"address-lookup-flow-secondary"),Ege=e=>parseInt(qe(e,"address-lookup-flow-page-size"),10),fge=e=>parseInt(qe(e,"address-lookup-flow-warning-threshold"),10),yge=e=>parseInt(qe(e,"address-lookup-flow-max-candidates"),10),cg=V(({retailerSettings:e})=>e["customer-addresses-supported-lookup-countries"],e=>typeof e=="string"?e.split(",").map(t=>t.trim()):[]),Ige="deliveryPassSubscription",Sge="dp.r",Cge="dp",UH="dp.by.store",Tge="sub3ds",_ge="spt",vge="dp.fft",Age="dp.freetrial",bge="dp.ctf",xge="w.sbc",Ml="left",Zs=(()=>{const e=D(UH),t=D(Cge),n=D(Sge),o=D(bge),r=D(Tge),a=D(xge),i=V(a,r,(c,d)=>!c||d),l=V(a,r,(c,d)=>c&&!d);return{isDeliveryPassByStoreEnabled:e,isSubscriptionEnabled:t,isRegionAwareEnabled:n,isSubscriptionPlanTransitionEnabled:D(_ge),is3dsSubscriptionsFlowEnabled:r,isBlockSubscriptionPurchaseAndEditEnabled:a,isSubscriptionPurchaseDisabled:l,isChangeAndEditPaymentEnabled:i,isFlexibleFreeTrialEnabled:D(vge),isFreeTrialEnabled:D(Age),isContentfulEnabled:o,canLoadBenefitGroupSelectionScene:c=>t(c)&&n(c)}})();function Rge(e){const t=Zs.isDeliveryPassByStoreEnabled(e),n=Zs.isSubscriptionEnabled(e),o=Zs.isRegionAwareEnabled(e),r=Zs.isSubscriptionPlanTransitionEnabled(e),a=Zs.is3dsSubscriptionsFlowEnabled(e),i=Zs.isBlockSubscriptionPurchaseAndEditEnabled(e),l=Zs.canLoadBenefitGroupSelectionScene(e),c=Zs.isFlexibleFreeTrialEnabled(e),d=Zs.isFreeTrialEnabled(e),u=Zs.isContentfulEnabled(e),m=Zs.isChangeAndEditPaymentEnabled(e),g=Zs.isSubscriptionPurchaseDisabled(e);return{isSubscriptionEnabled:n,isRegionAwareEnabled:o,isSubscriptionPlanTransitionEnabled:r,is3dsSubscriptionsFlowEnabled:a,isBlockSubscriptionPurchaseAndEditEnabled:i,canLoadBenefitGroupSelectionScene:l,isFlexibleFreeTrialEnabled:c,isFreeTrialEnabled:d,isContentfulEnabled:u,isChangeAndEditPaymentEnabled:m,isSubscriptionPurchaseDisabled:g,isDeliveryPassByStoreEnabled:t}}function po(){const e=E(t=>t);return Rge(e)}const Dge="web_customer_ws",Oge=()=>({client:"/api/customer",server:"/core-api"});function xd(e,t,n,o=Dge,r=Oge()){return{type:"API",payload:{...ee(e),url:t,options:n,service:o,pathPrefix:r}}}const Pge=e=>xd("ENABLE_AUTO_RENEWAL",`/v1/benefit-groups/delivery-pass/subscription/${e}/autoRenewalStatus`,{method:"PUT",body:{autoRenewalStatus:!0}}),Nge=e=>xd("DISABLE_AUTO_RENEWAL",`/v1/benefit-groups/delivery-pass/subscription/${e}/autoRenewalStatus`,{method:"PUT",body:{autoRenewalStatus:!1}});function GH(){return xd("GET_CUSTOMER_SUBSCRIPTIONS","/v2/benefit-groups/delivery-pass/subscriptions",{method:"GET"})}function $H(e){return e(GH()).then(n=>n?.type==="GET_CUSTOMER_SUBSCRIPTIONS_SUCCESS"?n?.payload?.responseData:n?.payload)}const Lge=e=>({type:"WALLET_ITEM_UPDATED",payload:{walletItemId:e}}),HH=e=>({type:"SET_SELECTED_SUBSCRIPTION_CARD",payload:{paymentInformation:e}});function kge(e,t){const n=o=>t[o.addressId];return e.filter(n)}function _j({customerSubscription:{subscription:{nextRenewal:e}}}){return e?.planId!==null}function Mge(e){return e.customerSubscription.subscription.autoRenewalStatus}function jge(e){return!!(e.customerSubscription.subscription.walletItem||e.customerSubscription.subscription.paymentInformation?.details)}function wge(e){const{customerSubscription:{plan:{freeTrial:t}}}=e;return!!t}function Fge({customerSubscriptionResponse:e}){return e.customerSubscription.subscription.nextRenewal?.planIsTransitioning}function Bge(e,{isSubscriptionPlanTransitionEnabled:t,isFreeTrialEnabled:n,isBlockSubscriptionPurchaseAndEditEnabled:o,isChangeAndEditPaymentEnabled:r,is3dsSubscriptionsFlowEnabled:a},i){const l=_j(e)&&Mge(e),c=jge(e),d=kge(e.deliveryAddresses,i);return{...e,metadata:{isPlanRenewable:_j(e),isPlanAutoRenewing:l,canCancelAutoRenewal:l&&(c||o),canChangePaymentMethod:r&&l,isReauthRequired:a&&!!e.customerSubscription.subscription.paymentInformation?.authRequired,isPaymentMethodLinkedToPlan:c,isSubscriptionPlanTransitioning:Fge({customerSubscriptionResponse:e})&&t,isFreeTrialAvailable:n&&wge(e),filteredAddresses:d,isCardDisabled:d.length===0}}}function Uge(e,t){if(e.data)return e.data.map(n=>n.customerSubscription?.subscription.subscriptionId===t.payload.responseData.subscriptionId?{...n,customerSubscription:{...n.customerSubscription,subscription:{...n.customerSubscription?.subscription,autoRenewalStatus:t.payload.responseData.autoRenewalStatus}}}:n)}const Gge=(e={...Re,error:null,data:void 0,selectedSubscriptionCard:void 0},t)=>{switch(t.type){case"ENABLE_AUTO_RENEWAL_PENDING":case"GET_CUSTOMER_SUBSCRIPTIONS_PENDING":return{...e,isFetching:!0,fetchError:!1,error:null};case"GET_CUSTOMER_SUBSCRIPTIONS_ERROR":return{...e,isFetching:!1,fetchError:!0,error:t.payload};case"GET_CUSTOMER_SUBSCRIPTIONS_SUCCESS":return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:t.payload.responseData};case"DISABLE_AUTO_RENEWAL_SUCCESS":case"ENABLE_AUTO_RENEWAL_SUCCESS":return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:Uge(e,t)};case"WALLET_ITEM_UPDATED":return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le()};case"SET_SELECTED_SUBSCRIPTION_CARD":return{...e,selectedSubscriptionCard:{paymentInformation:t.payload.paymentInformation}};default:return e}},qx="deliveryPass.subscription",$ge=({data:e})=>!!wo(e,`${qx}.data`,[])[0]?.customerSubscription,Hge=({data:e})=>!!wo(e,`${qx}.data`,[])?.[0]?.customerSubscription?.subscription?.autoRenewalStatus,Vge=({data:e})=>wo(e,`${qx}.selectedSubscriptionCard.paymentInformation`),{isSubscriptionPlanTransitionEnabled:Yge,isFreeTrialEnabled:Wge,isBlockSubscriptionPurchaseAndEditEnabled:qge,isChangeAndEditPaymentEnabled:Kge,is3dsSubscriptionsFlowEnabled:zge}=Zs;function VH(e){const t=$ge(e),n=Hge(e),o=Vge(e),r=Yge(e),a=Wge(e),i=qge(e),l=Kge(e),c=zge(e),{data:d}=e.data.deliveryPass.subscription;return{...e.data.deliveryPass.subscription,data:d?d.map(u=>Bge(u,{isSubscriptionPlanTransitionEnabled:r,isFreeTrialEnabled:a,isBlockSubscriptionPurchaseAndEditEnabled:i,isChangeAndEditPaymentEnabled:l,is3dsSubscriptionsFlowEnabled:c},BH(e))):void 0,metadata:{hasCustomerSubscriptions:t,isSubscriptionAutoRenewalEnabled:n,selectedSubscriptionCardPaymentInformation:o}}}function Qge(e){return VH(e)}function Xge(){const e=E(VH),t=F();return ie.useMemo(()=>({fetch:()=>$H(t),getComputedState:()=>e,disableAutoRenewal:n=>t(Nge(n)),enableAutoRenewal:n=>t(Pge(n)),walletItemUpdated:n=>t(Lge(n)),setSelectedSubscriptionCard:n=>t(HH(n))}),[e])}const Pr={server:{fetch:$H,getComputedState:Qge},client:{useHooks:Xge}},Zge="deliveryPass.benefitGroupsAddresses",Jge={...Re,error:null,data:[]},eEe=(e=Jge,t)=>{switch(t.type){case"GET_DELIVERY_PASS_BENEFIT_GROUPS_ADDRESSES_PENDING":return{...e,isFetching:!0,fetchError:!1,error:null};case"GET_DELIVERY_PASS_BENEFIT_GROUPS_ADDRESSES_ERROR":return{...e,isFetching:!1,fetchError:!0,error:t.payload};case"GET_DELIVERY_PASS_BENEFIT_GROUPS_ADDRESSES_SUCCESS":return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:t.payload.responseData};default:return e}},tEe=({data:e})=>wo(e,Zge);function sEe({data:e}){const t=o=>{if((o||[]).length!==0)return o[0]};return(o=>t(o)?.benefitGroupId)(e.deliveryPass?.benefitGroupsAddresses?.data)}const nEe=()=>xd("GET_DELIVERY_PASS_BENEFIT_GROUPS_ADDRESSES","/v3/benefit-groups/delivery-pass",{method:"GET"}),oEe=({benefitGroupId:e}={})=>xd("GET_DELIVERY_PASS_BENEFITS",`/v4/benefit-groups/delivery-pass${e?`?benefitGroupId=${e}`:""}`,{method:"GET"}),rEe=e=>xd("GET_CUSTOMER_SELECTED_SUBSCRIPTION",`/v2/benefit-groups/delivery-pass/subscription/${e}`,{method:"GET"}),aEe=(e,t)=>e(rEe(t)),Rd={getDeliveryPassBenefits:oEe,getDeliveryPassBenefitGroupsAddresses:nEe,setSelectedSubscriptionCard:HH,fetchCustomerSelectedSubscription:aEe,getCustomerSubscriptions:GH};function YH(e){return{...tEe(e),metadata:{benefitGroupIdFromDefaultAddress:sEe(e)}}}function iEe(){const e=E(YH),t=F(),n=()=>t(Rd.getDeliveryPassBenefitGroupsAddresses());return ie.useMemo(()=>({getComputedState:()=>e,fetch:n}),[e])}const Nr={server:{getComputedState:YH,fetch:e=>e(Rd.getDeliveryPassBenefitGroupsAddresses())},client:{useHooks:iEe}},lEe=e=>({...e.subscription,planName:e.name,cost:e.cost}),vj=e=>{const t=e.plans.find(n=>!!n.subscription);return t?lEe(t):void 0},cEe=(e={...Re,data:void 0,error:null},t)=>{switch(t.type){case"GET_DELIVERY_PASS_BENEFITS_PENDING":return{...e,isFetching:!0,fetchError:!1,error:null};case"GET_DELIVERY_PASS_BENEFITS_ERROR":return{...e,isFetching:!1,fetchError:!0,error:t.payload};case"GET_DELIVERY_PASS_BENEFITS_SUCCESS":return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:t.payload.responseData};default:return e}},dEe=e=>e.data.deliveryPass.benefits,Kx=e=>e.data.deliveryPass.benefits.data?.benefits??[],WH=e=>(e.data.deliveryPass.benefits.data?.benefits||[]).flatMap(t=>t.plans),uEe=e=>WH(e).some(n=>n.freeTrial?.eligible),pEe=V(Kx,e=>e?.some(({plans:t})=>t.some(({subscription:n})=>n?.autoRenewalStatus))),mEe=V(Kx,e=>{const t=e.find(n=>!!vj(n));if(t)return{benefitName:t.name,benefitDescription:t.description,...vj(t)}});function qH(e){const t=dEe(e),n=Kx(e),o=WH(e),r=uEe(e),a=pEe(e),i=mEe(e);return{...t,error:t.error,metadata:{benefits:n,plans:o,isFreeTrial:r,isPurchasedSubscriptionAutoRenewalEnabled:a,benefitGroupSubscription:i}}}function hEe(){const e=E(qH),t=F();return ie.useMemo(()=>({getComputedState:()=>e,fetch:n=>t(Rd.getDeliveryPassBenefits(n))}),[e])}const En={server:{getComputedState:qH,fetch:(e,t={})=>e(Rd.getDeliveryPassBenefits(t))},client:{useHooks:hEe}},gEe="deliveryPass.selectedSubscription",EEe=(e={...Re,error:null,data:void 0},t)=>{switch(t.type){case"GET_CUSTOMER_SELECTED_SUBSCRIPTION_PENDING":return{...e,isFetching:!0,fetchError:!1,error:null};case"GET_CUSTOMER_SELECTED_SUBSCRIPTION_ERROR":return{...e,isFetching:!1,fetchError:!0,error:t.payload};case"GET_CUSTOMER_SELECTED_SUBSCRIPTION_SUCCESS":return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:t.payload.responseData};default:return e}},KH=({data:e})=>wo(e,gEe),{fetchCustomerSelectedSubscription:zH}=Rd;function fEe(){const e=E(KH),t=F();return ie.useMemo(()=>({fetch:n=>zH(t,n),getComputedState:()=>e}),[e])}const QH={server:{fetch:zH,getComputedState:KH},client:{useHooks:fEe}},yEe=(e={...Re,data:void 0,error:null},t)=>{switch(t.type){case"GET_DELIVERY_PASS_CONTENTFUL_PAGE_PENDING":return{...e,isFetching:!0,fetchError:!1,error:null};case"GET_DELIVERY_PASS_CONTENTFUL_PAGE_ERROR":return{...e,isFetching:!1,fetchError:!0,error:t.payload};case"GET_DELIVERY_PASS_CONTENTFUL_PAGE_SUCCESS":return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:t.payload.responseData};default:return e}},XH=e=>e.data.deliveryPass.contentful;function IEe(){return E(XH)}const Ii=({basePath:e="",target:t=""}={})=>`${e}/api${t}`,SEe=({basePath:e=""}={})=>`${e}/change-credentials`,od=e=>`/stores/${e}`;function CEe({postFetchOptions:{basePath:e,options:t},isFreeTrialEnabled:n,resultToken:o}){const r=Ii({basePath:e,target:"/customer/v3/benefit-groups/delivery-pass/subscription/complete3ds"});return fetch(r,{...t,body:JSON.stringify({freeTrialEnabled:n,details:{resultToken:o}})})}function ZH({postFetchOptions:{basePath:e,options:t},isFreeTrialEnabled:n,planId:o,walletItemId:r,regionId:a,checkoutUrl:i}){const l=Ii({basePath:e,target:"/customer/v3/benefit-groups/delivery-pass/subscription"});return fetch(l,{...t,body:JSON.stringify({planId:o,walletItemId:r,startTime:n0(),freeTrialEnabled:n,checkoutUrl:i,source:"web",regionId:a})})}const TEe=({clientRouteId:e,csrfToken:t,basePath:n})=>({basePath:n,options:{method:"POST",credentials:"same-origin",headers:{"client-route-id":e,"content-type":"application/json; charset=utf-8","X-CSRF-TOKEN":t}}}),_Ee=()=>xd("GET_DELIVERY_PASS_CONTENTFUL_PAGE","/v1/subscriptions/contentful",{method:"GET"}),vEe={getDeliveryPassContentfulPage:_Ee},AEe=(e,t)=>{const n=Zr(e),o=Zr(t);return{slot_day:n.isoWeekday(),slot_start_time:n.format(vn),slot_date:n.format(oa),slot_end_time:o.format(vn)}},JH=(e,t,n)=>{const{productEntity:o,quantity:r}=e,a=Ys(o),i=o?.ratingSummary?.overallRating,l=Bn(o,n),c={item_id:a?.id||null,item_name:a?.name,index:null,item_brand:a?.brand,hfss_display_restriction_group:o?.hfssDisplayRestrictionGroup||null,item_list_name:null,item_variant:o?.size?.value||null,price:a?.price?Number(a.price):null,rating:i?Number(i):null,quantity:r,is_on_promotion:!!a?.isOnPromotion,promotion_ids:o?.offers?.map(d=>d.retailerPromotionId).join(",")||null,is_favorite:!!a?.isFavorite,is_featured:!!l,featured_campaign_id:l?.campaignId||null,featured_campaign_name:l?.campaignName||null,...ol(o?.categoryPath??[]),seller_id:o?.seller?.id||null};return tc({productId:a.productId,item:c,meta:t})},eV=e=>{const{data:t,productChunk:n,isFirstChunk:o,index:r,hasDeliveryPass:a,groupId:i,mapEventItem:l,meta:c,featuredProductCampaigns:d}=e,{orderId:u,orderTotals:{taxesTotals:m,totalPrice:g,finalPrice:f},appliedVouchers:y,charges:I,loyalty:S,dates:{deliveryStartDate:C,deliveryEndDate:_},deliveryMethod:A,wasEdited:x}=t,R=x?"edited-order":"new-order",O=y.map(K=>K.id).join(", "),{currency:N,amount:k}=g,j=le(),w=S?.spent?.money.amount,L=()=>`${u}-${j}-part${r}`,B=o?m.taxes.components.reduce((K,Q)=>K+Number(Q.taxAmount.amount),0):0,W=Object.entries(I).reduce((K,[Q,X])=>"amount"in X&&Q!=="delivery"?K+Number(X.amount):K,0),$=()=>a?0:I.delivery.amount?Number(I.delivery.amount):null;return{event:"order_confirmed",ecommerce:{osp_transaction_id:u,transaction_type:R,transaction_id:L(),group_id:i,value:f.amount?Number(f.amount):null,total_value:k?Number(k):null,tax:B,shipping:$(),loyalty:w?Number(w):null,currency:N,coupon:O,charges:W,items:n.map(K=>l(K,c,d))},...AEe(C,_),fulfillment_method:A.toLowerCase()}},bEe=(e,t)=>{const n=nl(t,e.payload.orderId),o=Ts(t),r=Fo(t),a=qs(t),i=Pr.server.getComputedState(t).metadata.hasCustomerSubscriptions,{items:l}=n,c=15,d=Math.ceil(l.length/c),u=[];for(let g=0;g<d;g+=1)u.push(l.slice(g*c,(g+1)*c).map(f=>({...f,productEntity:o[f.product]})));const m=g=>g===0;return u.map((g,f)=>eV({data:n,productChunk:g,isFirstChunk:m(f),mapEventItem:JH,index:f,groupId:r,hasDeliveryPass:i,meta:e.payload.meta,featuredProductCampaigns:a}))},xEe={[_e.BEGIN_CHECKOUT]:oge,[_e.ORDER_PURCHASED]:sge,[_e.SELECT_PLACE_ORDER]:Jhe,[_e.ORDER_CONFIRMED]:bEe},REe=e=>{const{ITEM_ID:t,ITEM_NAME:n,SEQUENCE:o,SEQUENCE_OF_ITEM_ON_PAGE:r,PAGE_TYPE:a,PAGE_NAME:i,LINK_TYPE:l,LINK_VALUE:c}=e.payload;return i==="homepage"?{id:t,name:n,event:"select_homepage_tile",navigation:"grid",index:o,location:r,link_type:l,target:c}:{id:t,name:n,event:`${i}_navigation`,navigation:"grid-tile",type:a,index:r,location:null,link_type:l,target:c}},DEe=e=>{const{ITEM_ID:t,ITEM_NAME:n,SEQUENCE:o,SEQUENCE_OF_ITEM_ON_PAGE:r,LINK_TYPE:a,LINK_VALUE:i}=e.payload;return{id:t,name:n,event:"select_homepage_tile",navigation:"carousel",index:o,location:r,link_type:a,target:i}},OEe=e=>{const{ITEM_ID:t,ITEM_NAME:n,LOCATION:o,PAGE_TYPE:r,PAGE_NAME:a,LINK_TYPE:i,LINK_VALUE:l}=e.payload;return{id:t,name:n,event:`${a}_navigation`,navigation:"navigation",type:r,index:null,location:o,link_type:i,target:l}},PEe=e=>{const{ITEM_ID:t,ITEM_NAME:n,LOCATION:o,PAGE_TYPE:r,PAGE_NAME:a,LINK_TYPE:i,LINK_VALUE:l}=e.payload;return{id:t,name:n,event:`${a}_navigation`,navigation:"lead-image",type:r,index:null,location:o,link_type:i,target:l}},NEe=e=>{const{BANNER_ID:t,BANNER_NAME:n,PAGE_NAME:o,PAGE_TYPE:r,LINK_TYPE:a,TARGET_URL:i,SEQUENCE:l}=e.payload;return{id:t,name:n,event:`${o}_navigation`,navigation:"hero",type:r,index:l,location:null,link_type:a,target:i}},LEe=e=>{const{RICH_TEXT_ID:t,LINK_TYPE:n,LINK_VALUE:o,PAGE_NAME:r,PAGE_TYPE:a,LOCATION:i}=e.payload;return{id:t,name:t,event:`${r}_navigation`,navigation:"link",type:a,index:null,location:i,link_type:n,target:o}},vs={COMPONENTIZED_ATTRIBUTES:"COMPONENTIZED_ATTRIBUTES",GRID_IMPRESSION:"GRID_IMPRESSION",GRID_ITEM_IMPRESSION:"GRID_ITEM_IMPRESSION",HORIZONTAL_HERO_BANNER_CLICK:"IMAGE_CLICKED",HORIZONTAL_HERO_BANNER_IMPRESSION:"HERO_IMAGE_BANNER_IMPRESSION",GRID_ITEM_CLICKED:"GRID_ITEM_CLICKED",CAROUSEL_ITEM_CLICKED:"CAROUSEL_ITEM_CLICKED",NAV_MENU_CLICKED:"NAV_MENU_CLICKED",NAV_ITEM_CLICKED:"NAV_ITEM_CLICKED",RICH_TEXT_IMPRESSION:"RICH_TEXT_IMPRESSION",RICH_TEXT_LINK_CLICKED:"RICH_TEXT_LINK_CLICKED",LEAD_IMAGE_CLICKED:"LEAD_IMAGE_CLICKED"},kEe={[vs.GRID_ITEM_CLICKED]:REe,[vs.CAROUSEL_ITEM_CLICKED]:DEe,[vs.NAV_ITEM_CLICKED]:OEe,[vs.LEAD_IMAGE_CLICKED]:PEe,[vs.HORIZONTAL_HERO_BANNER_CLICK]:NEe,[vs.RICH_TEXT_LINK_CLICKED]:LEe},MEe=(e,t)=>({...Us,userId:ua(t),retailerRegionId:ar(t),retailerBannerId:Qh(t),regionName:eS(t),bannerName:fd(t)}),jEe={[mn]:MEe},wEe=e=>({...Us,hitType:"pageview",page:`/open-${e.payload.modalName.toLowerCase().replace("_","-")}-modal`}),tV="OPEN_MODAL",sV="CLOSE_MODAL",FEe=(e,t)=>({type:tV,payload:{modalName:e,options:t}}),BEe=()=>({type:sV}),Z={actionTypes:{OPEN_MODAL:tV,CLOSE_MODAL:sV},openModal:FEe,closeModal:BEe},Vo=e=>({control:t})=>t.modal?.[e]?.options,Ue=e=>({control:t})=>t.modal?.[e]?.isOpen??!1,wt=e=>{const t=F(),n=E(Ue(e)),o=E(Vo(e));return h.useMemo(()=>({isOpen:n,options:o,open:r=>{t(Z.openModal(e,r))},close:()=>{t(Z.closeModal())}}),[e,t,n,o])},UEe={[Z.actionTypes.OPEN_MODAL]:wEe},GEe={[zt.GA_IMPRESSION]:Pue,[zt.GA_BATCH_IMPRESSION]:Nue,[zt.GA4_BATCH_IMPRESSION]:Sme,[zt.GA_PRODUCT_CLICK]:Lue,[zt.GA4_PRODUCT_CLICK]:yme,[zt.GA_FOP_PROMO_LINK_CLICKED]:kue},$Ee=e=>({...Hs,event:"select_promotion",eventAction:"MENU_CAMPAIGN_ITEM_CLICKED",ecommerce:{promoClick:{promotions:[{promotionType:"Menu Campaign",id:e.payload.menuCampaignItemId,name:e.payload.menuCampaignItemName,creative:e.payload.fileName,position:`Menu campaign item ${e.payload.position}`}]}}}),HEe=e=>({...Hs,event:"view_promotion",eventAction:"MENU_CAMPAIGN_ITEM_IMPRESSION",ecommerce:{promoView:{promotions:e.payload.menuCampaignItemList}}}),VEe=e=>({...Hs,event:"select_promotion",eventAction:"MENU_CAMPAIGN_CLICKED",ecommerce:{promoClick:{promotions:[{promotionType:"Menu Campaign",id:e.payload.menuCampaignId,name:e.payload.menuCampaignName,creative:e.payload.fileName,position:`Menu ${e.payload.position}`}]}}}),YEe=e=>({...Hs,event:"view_promotion",eventAction:"MENU_CAMPAIGN_IMPRESSION",ecommerce:{promoView:{promotions:[{promotionType:"Menu Campaign",id:e.payload.id,name:e.payload.name,creative:e.payload.fileName,position:`Menu ${e.payload.position}`}]}}}),WEe="CATALOGUE_NAVIGATION_BAR_BUTTON_CLICKED",qEe="FAVORITES_NAVIGATION_BAR_BUTTON_CLICKED",KEe="COUPONS_NAVIGATION_BAR_BUTTON_CLICKED",zEe="LISTS_NAVIGATION_BAR_BUTTON_CLICKED",QEe="REGULARS_NAVIGATION_BAR_BUTTON_CLICKED",XEe="DELIVERY_PASS_NAVIGATION_BAR_BUTTON_CLICKED",ZEe="RECIPES_NAVIGATION_BAR_BUTTON_CLICKED",JEe="MEAL_NAVIGATION_BAR_BUTTON_CLICKED",efe="RECURRING_ORDERS_NAVIGATION_BAR_BUTTON_CLICKED",tfe="SHOP_IN_SHOP_NAVIGATION_BAR_BUTTON_CLICKED",sfe="MENU_CAMPAIGN_CLICKED",nfe="MENU_CAMPAIGN_DETAIL_IMPRESSION",ofe="MENU_CAMPAIGN_IMPRESSION",rfe="MENU_CAMPAIGN_ITEM_CLICKED",afe="MENU_CAMPAIGN_ITEM_IMPRESSION",ife="MENU_CAMPAIGN_ITEM_LIST_IMPRESSION",lfe="NAVIGATION_BAR_BUTTON_IMPRESSION",cfe="OFFERS_NAVIGATION_BAR_BUTTON_CLICKED",dfe="LOCALE_DROPDOWN_OPENED",ufe="SMART_CART_NAVIGATION_BAR_BUTTON_CLICKED",Nt={CATALOGUE_NAVIGATION_BAR_BUTTON_CLICKED:WEe,FAVORITES_NAVIGATION_BAR_BUTTON_CLICKED:qEe,COUPONS_NAVIGATION_BAR_BUTTON_CLICKED:KEe,LISTS_NAVIGATION_BAR_BUTTON_CLICKED:zEe,REGULARS_NAVIGATION_BAR_BUTTON_CLICKED:QEe,DELIVERY_PASS_NAVIGATION_BAR_BUTTON_CLICKED:XEe,RECIPES_NAVIGATION_BAR_BUTTON_CLICKED:ZEe,MEAL_NAVIGATION_BAR_BUTTON_CLICKED:JEe,RECURRING_ORDERS_NAVIGATION_BAR_BUTTON_CLICKED:efe,SHOP_IN_SHOP_NAVIGATION_BAR_BUTTON_CLICKED:tfe,MENU_CAMPAIGN_CLICKED:sfe,MENU_CAMPAIGN_DETAIL_IMPRESSION:nfe,MENU_CAMPAIGN_IMPRESSION:ofe,MENU_CAMPAIGN_ITEM_CLICKED:rfe,MENU_CAMPAIGN_ITEM_IMPRESSION:afe,MENU_CAMPAIGN_ITEM_LIST_IMPRESSION:ife,NAVIGATION_BAR_BUTTON_IMPRESSION:lfe,OFFERS_NAVIGATION_BAR_BUTTON_CLICKED:cfe,LOCALE_DROPDOWN_OPENED:dfe,SMART_CART_NAVIGATION_BAR_BUTTON_CLICKED:ufe},pfe={[Nt.MENU_CAMPAIGN_ITEM_LIST_IMPRESSION]:HEe,[Nt.MENU_CAMPAIGN_IMPRESSION]:YEe,[Nt.MENU_CAMPAIGN_ITEM_CLICKED]:$Ee,[Nt.MENU_CAMPAIGN_CLICKED]:VEe},mfe=e=>({event:"select_menu_campaign_item",name:e.payload.menuCampaignItemName,id:e.payload.menuCampaignItemId,promotion_id:e.payload.menuCampaignId,index:e.payload.index}),hfe=e=>({event:"view_menu_campaign",name:e.payload.menuCampaignName,id:e.payload.menuCampaignId,index:e.payload.index}),gfe={[Nt.MENU_CAMPAIGN_DETAIL_IMPRESSION]:hfe,[Nt.MENU_CAMPAIGN_ITEM_CLICKED]:mfe},Efe=e=>({event:"select_tab",name:e.payload.label,id:e.payload.id,index:e.payload.tabPosition,location:e.payload.isInDropdown?"in-drop-down":"not-in-drop-down",target:e.payload.targetURL}),ffe="TOP_TAB_CLICKED",yfe="TOP_TAB_DROPDOWN_OPENED",Ife="TOP_TAB_IMPRESSION",si={TOP_TAB_CLICKED:ffe,TOP_TAB_DROPDOWN_OPENED:yfe,TOP_TAB_IMPRESSION:Ife},Sfe={[si.TOP_TAB_CLICKED]:Efe},Cfe=e=>{const{id:t,label:n,tabPosition:o,isInDropdown:r}=e.payload,a={promotionType:"Top Tab",id:t,name:n,creative:null,position:o,topTabIsInDropdown:r};return SS(e.type,"promoClick",[a])},Tfe=()=>({...Us,hitType:"event",eventCategory:"Top Tabs",eventAction:"TopTabDropdownOpened",eventLabel:"Not Set"}),_fe=e=>{const t=e.payload.links.map(n=>({promotionType:"Top Tab",id:n.id,name:n.label,creative:null,position:n.positionSeen,topTabIsInDropdown:n.isInDropdown}));return SS(e.type,"promoView",t)},vfe={[si.TOP_TAB_CLICKED]:Cfe,[si.TOP_TAB_DROPDOWN_OPENED]:Tfe,[si.TOP_TAB_IMPRESSION]:_fe},Afe=e=>({...Us,hitType:"event",eventCategory:"Locale",eventAction:e.type,eventLabel:e.payload.language}),bfe=e=>({event:"locale_changed",locale:e.payload.locale}),xfe="LOCALE_CHANGED",Rfe="LOCALE_CHANGED_GA4",Dfe="LOCALE_MODAL_DISPLAYED",nr={LOCALE_CHANGED:xfe,LOCALE_CHANGED_GA4:Rfe,LOCALE_MODAL_DISPLAYED:Dfe},Ofe={[nr.LOCALE_CHANGED]:Afe,[nr.LOCALE_CHANGED_GA4]:bfe},Pfe=e=>({...Hs,eventLabel:"cancelled-order",eventAction:"OrderCancelled",ecommerce:{refund:{actionField:{id:e.payload.orderId}}}}),Nfe=e=>({...Hs,eventLabel:"edit-order-clicked",eventAction:"EditOrderButtonClicked",ecommerce:{transactionId:e.payload.orderId}}),js={BUY_ALL_PRODUCTS:"BUY_ALL_PRODUCTS",CANCEL_ORDER_MODAL_DISPLAYED:"CANCEL_ORDER_MODAL_DISPLAYED",DISCARD_CHANGES_MODAL_DISPLAYED:"DISCARD_CHANGES_MODAL_DISPLAYED",EDIT_ORDER_BUTTON_CLICKED:"EDIT_ORDER_BUTTON_CLICKED",ORDER_CANCELLED:"ORDER_CANCELLED",EDIT_PAGE_SLOT_BOOKING_CARD_CLICKED:"EDIT_PAGE_SLOT_BOOKING_CARD_CLICKED",ORDER_CANCELLED_GA4:"ORDER_CANCELLED_GA4",EDIT_ORDER_GA4:"EDIT_ORDER_GA4",EDIT_ORDER_PAGE_VIEW_EVENT:"EDIT_ORDER_PAGE_VIEW_EVENT"},Lfe={[js.ORDER_CANCELLED]:Pfe,[js.EDIT_ORDER_BUTTON_CLICKED]:Nfe,[js.EDIT_ORDER_PAGE_VIEW_EVENT]:uA},kfe=e=>{switch(e){case"START":return"AddWalletItemStart";case"COMPLETE":return"AddWalletItemSuccess";case"ERROR":return"AddWalletItemError";default:return"AddWalletItemError"}},Mfe=e=>t=>({...Us,hitType:"event",eventAction:kfe(t.payload.event),eventCategory:e,walletItemId:t.payload.walletItemId}),jfe=e=>({...Us,hitType:"event",eventCategory:"Payment",eventAction:"failedPaymentWarningAlert",eventLabel:e.payload.pathname}),wfe=e=>({...Us,hitType:"pageview",page:e.payload.pathname}),Ffe=e=>({...Us,hitType:"event",eventCategory:"Payment",eventAction:"failedPaymentWarningAlertLinkClicked",eventLabel:e.payload.pathname}),Bfe=e=>t=>({...Us,hitType:"event",eventCategory:e,eventAction:"SelectWalletItem",eventLabel:t.payload.pageEventAttributes.page,walletItemId:t.payload.pageEventAttributes.walletItemId}),Ufe="ADD_WALLET_ITEM",Gfe="BACK_TO_SHOP",$fe="FAILED_PAYMENT",Hfe="FAILED_PAYMENT_SUCCESS",Vfe="FAILED_PAYMENT_WARNING_ALERT",Yfe="FAILED_PAYMENT_WARNING_ALERT_LINK_CLICKED",Wfe="FAILED_PAYMENT_WARNING_MODAL",qfe="FAILED_PAYMENT_WARNING_MODAL_UPDATE_PAYMENT_DETAILS_BUTTON_CLICKED",Kfe="PAYMENT_CHECK_ADD_MODAL_DISPLAYED",zfe="PAYMENT_CHECKS_AVAILABILITY_FETCHED_ANALYTICS",Qfe="WALLET_ITEM_IMPRESSION",Xfe="SELECT_WALLET_ITEM",Zfe="ADD_WALLET_ITEM_REQUEST",Jfe="ADD_PAYMENT_METHOD_MODAL_DISPLAYED",eye="PAYMENT_METHOD_DETAILS_MODAL_DISPLAYED",tye="UNAUTHORIZED_POST_MESSAGE_ATTEMPT",xt={ADD_WALLET_ITEM:Ufe,BACK_TO_SHOP:Gfe,FAILED_PAYMENT:$fe,FAILED_PAYMENT_SUCCESS:Hfe,FAILED_PAYMENT_WARNING_ALERT:Vfe,FAILED_PAYMENT_WARNING_ALERT_LINK_CLICKED:Yfe,FAILED_PAYMENT_WARNING_MODAL:Wfe,FAILED_PAYMENT_WARNING_MODAL_UPDATE_PAYMENT_DETAILS_BUTTON_CLICKED:qfe,PAYMENT_CHECK_ADD_MODAL_DISPLAYED:Kfe,PAYMENT_CHECKS_AVAILABILITY_FETCHED_ANALYTICS:zfe,WALLET_ITEM_IMPRESSION:Qfe,SELECT_WALLET_ITEM:Xfe,ADD_WALLET_ITEM_REQUEST:Zfe,ADD_PAYMENT_METHOD_MODAL_DISPLAYED:Jfe,PAYMENT_METHOD_DETAILS_MODAL_DISPLAYED:eye,UNAUTHORIZED_POST_MESSAGE_ATTEMPT:tye},nV=ee("REMOVE_WALLET_ITEM"),Aj="walletservice",sye=(e,t)=>({type:"API",payload:{service:Aj,url:`/${Aj}/v1/customers/${t}/wallet-items/${e}`,options:{method:"DELETE",body:{}},...nV},id:e}),ph={removeCustomerWalletItem:sye,types:{REMOVE_WALLET_ITEM:nV}},nye={[xt.ADD_WALLET_ITEM]:Mfe("Payment"),[xt.FAILED_PAYMENT_WARNING_ALERT]:jfe,[xt.FAILED_PAYMENT_WARNING_MODAL]:wfe,[xt.FAILED_PAYMENT_WARNING_ALERT_LINK_CLICKED]:Ffe,[xt.SELECT_WALLET_ITEM]:Bfe("Payment"),[ph.types.REMOVE_WALLET_ITEM.SUCCESS]:zr("Settings"),[ph.types.REMOVE_WALLET_ITEM.ERROR]:zr("Settings")},fn={REVIEW_IMAGE_GALLERY_CLOSED:"REVIEW_IMAGE_GALLERY_CLOSED",REVIEW_IMAGE_GALLERY_OPENED:"REVIEW_IMAGE_GALLERY_OPENED",REVIEW_IMAGE_NAVIGATED:"REVIEW_IMAGE_NAVIGATED",REVIEW_HELPFUL_BUTTON_CLICK:"REVIEW_HELPFUL_BUTTON_CLICK",GA_SELECT_REVIEW_HELPFUL:"GA_SELECT_REVIEW_HELPFUL",GA_UNSELECT_REVIEW_HELPFUL:"GA_UNSELECT_REVIEW_HELPFUL",ADD_A_REVIEW_BUTTON_CLICKED:"ADD_A_REVIEW_BUTTON_CLICKED",PRODUCT_RATINGS_CLICKED:"PRODUCT_RATINGS_CLICKED",SEE_NEXT_REVIEW_PAGE_BUTTON_CLICKED:"SEE_NEXT_REVIEW_PAGE_BUTTON_CLICKED",SEE_PREVIOUS_REVIEW_PAGE_BUTTON_CLICKED:"SEE_PREVIOUS_REVIEW_PAGE_BUTTON_CLICKED",REVIEW_SUBMITTED_TOAST_DISPLAYED:"REVIEW_SUBMITTED_TOAST_DISPLAYED",WRITE_REVIEW_ERROR_ALERT_DISPLAYED:"WRITE_REVIEW_ERROR_ALERT_DISPLAYED",VIEW_RESPONSE_BUTTON_CLICKED:"VIEW_RESPONSE_BUTTON_CLICKED",HIDE_RESPONSE_BUTTON_CLICKED:"HIDE_RESPONSE_BUTTON_CLICKED",REVIEW_SORT_PREFERENCE_CHANGED:"REVIEW_SORT_PREFERENCE_CHANGED",PRODUCT_REVIEW_IMPRESSION:"PRODUCT_REVIEW_IMPRESSION",PRODUCT_OVERALL_RATINGS_DASHBOARD_IMPRESSION:"PRODUCT_OVERALL_RATINGS_DASHBOARD_IMPRESSION",WRITE_NON_VERIFIED_REVIEW_BLOCK_TOAST_DISPLAYED:"WRITE_NON_VERIFIED_REVIEW_BLOCK_TOAST_DISPLAYED"},oye=e=>({event:"select_review_helpful",id:e.payload.id,review_id:e.payload.reviewId}),rye=e=>({event:"unselect_review_helpful",id:e.payload.id,review_id:e.payload.reviewId}),aye={[fn.GA_SELECT_REVIEW_HELPFUL]:oye,[fn.GA_UNSELECT_REVIEW_HELPFUL]:rye},hs={SEARCH_PAGE_VIEWED:"SEARCH_PAGE_VIEWED",SEARCH_SUGGESTION_CHOSEN:"SEARCH_SUGGESTION_CHOSEN",SEARCH_FORM_SUBMISSION:"SEARCH_FORM_SUBMISSION",GA_SHOW_SEARCH_PAGE:"GA_SHOW_SEARCH_PAGE",SEARCH_REDIRECT:"SEARCH_REDIRECT",SEARCH_SUGGESTION_IMPRESSION:"SEARCH_SUGGESTION_IMPRESSION",SEARCH_SUGGESTION_CLICKED:"SEARCH_SUGGESTION_CLICKED",SELECT_SEARCH_SUGGESTION:"SELECT_SEARCH_SUGGESTION",SEARCH_EVENT:"SEARCH_EVENT"},iye=e=>({...Us,hitType:"event",eventCategory:"Search",eventAction:"SuggestionClicked",eventLabel:e.payload.searchSuggestion}),lye=e=>({event:"select_search_suggestion",search_suggestion:e.payload.searchSuggestion,type:e.payload.suggestionType,index:e.payload.suggestionIndex,location:e.payload.location}),cye=e=>({event:"search",search_term:e.payload.searchTerm,corrected_search_term:e.payload.correctedSearchTerm,locale:e.payload.locale}),dye=e=>({event:"search_redirect",search_term:e.payload.searchTerm,target:e.payload.redirectURL}),uye=e=>({...Us,hitType:"event",eventCategory:"Search",pagePartType:"SEARCH",eventAction:hs.GA_SHOW_SEARCH_PAGE,eventLabel:e.payload.searchTerm,searchTerm:e.payload.searchTerm,correctedSearchTerm:e.payload.correctedSearchTerm,locale:e.payload.locale}),pye={[hs.SEARCH_SUGGESTION_CHOSEN]:iye,[hs.SELECT_SEARCH_SUGGESTION]:lye,[hs.SEARCH_EVENT]:cye,[hs.GA_SHOW_SEARCH_PAGE]:uye,[hs.SEARCH_REDIRECT]:dye},mye=(e,t)=>{const n=Jn(t).map(r=>Ys(r)),{slot:o}=e.payload;return{...Hs,eventCategory:vd,eventLabel:`${o.startTime} - ${o.endTime}`,eventValue:parseFloat(e.deliveryPrice.amount),eventAction:"SlotBooked",ecommerce:{checkout:{actionField:{step:2,option:e.deliveryType===Et.clickAndCollect.type?"click&collect":"homeDelivery"},products:n}}}},hye=(e,t)=>{const n=Jn(t).map(o=>Ys(o));return{...Hs,eventCategory:vd,eventLabel:e.slotId,eventValue:parseFloat(e.deliveryPrice.amount),eventAction:"SelectSlotError",ecommerce:{checkout:{actionField:{step:2,option:e.deliveryType===Et.clickAndCollect.type?"click&collect":"homeDelivery"},products:n}}}},oV="CLEAR_SELECTED_SLOT",rV="CANCEL_SELECTED_SLOT",aV=ee("SELECT_SLOT"),iV="INVALIDATE_SLOTS_CONFIRMATION_DATA",lV=ee("GET_SLOT_BOOKING_LIMITED_PRODUCTS"),cV="SET_SELECTED_SLOT",gye=()=>({type:oV}),Eye=()=>({type:rV}),fye=({slotId:e,deliveryDestinationId:t,deliveryPrice:n,deliveryType:o,minimumOrder:r,orderId:a,externalAddress:i,carrierName:l,regionId:c,ecoSlot:d})=>({type:"API",payload:{pathPrefix:{client:"/api/ecomslots",server:"/core-api"},service:"ecomslots",url:"/v1/slots/reservation",options:{method:"POST",body:{regionId:c,slotId:e,deliveryDestinationId:t,externalAddress:i}},...aV},deliveryPrice:n,deliveryType:o,slotId:e,minimumOrder:r,orderId:a,carrierName:l,ecoSlot:d}),yye=()=>({type:iV}),Iye=({slotId:e,slotRegionId:t,limitedProducts:n})=>({type:"API",payload:{url:"/v5/products/slot-booking",options:{method:"PUT",body:{slotId:e,slotRegionId:t,limitedProducts:n}},...lV}}),Sye=({selectSlotData:e,params:t})=>({...t,type:cV,payload:e}),yo={clearSelectedSlot:gye,cancelSelectedSlot:Eye,selectSlot:fye,invalidateSlotsConfirmationData:yye,getSlotBookingLimitedProducts:Iye,setSelectedSlot:Sye,types:{CANCEL_SELECTED_SLOT:rV,CLEAR_SELECTED_SLOT:oV,SELECT_SLOT:aV,INVALIDATE_SLOTS_CONFIRMATION_DATA:iV,GET_SLOT_BOOKING_LIMITED_PRODUCTS:lV,SET_SELECTED_SLOT:cV}},Cye={[yo.types.SET_SELECTED_SLOT]:mye,[yo.types.SELECT_SLOT.ERROR]:hye},Qr={SHOP_IN_SHOP_PAGE_VIEW:"SIS_PAGE_VIEW",HORIZONTAL_HERO_BANNER_IMPRESSION:"SIS_HERO_IMAGE_BANNER_IMPRESSION",SUB_CATEGORY_IMAGE_IMPRESSION:"SIS_SUB_CATEGORY_IMAGE_IMPRESSION",SUB_CATEGORY_IMAGE_CLICKED:"SIS_SUB_CATEGORY_IMAGE_CLICKED"},Tp={HORIZONTAL_HERO_BANNER_IMPRESSION:"HERO_IMAGE_BANNER_IMPRESSION",SUB_CATEGORY_IMAGE_IMPRESSION:"SUB_CATEGORY_IMAGE_IMPRESSION",SUB_CATEGORY_IMAGE_CLICKED:"SUB_CATEGORY_IMAGE_CLICKED"},Tye=({payload:e})=>({...Hs,event:"view_promotion",eventCategory:"Shop in Shop page",eventAction:Tp.HORIZONTAL_HERO_BANNER_IMPRESSION,ecommerce:{promoView:{promotions:[{promotionType:"Shop in Shop",id:e.id,name:e.name,creative:e.imageId,position:"Hero Image"}]}}}),_ye=({payload:e})=>({...Hs,event:"view_promotion",eventCategory:"Shop in Shop page",eventAction:Tp.SUB_CATEGORY_IMAGE_IMPRESSION,ecommerce:{promoView:{promotions:[{promotionType:"Shop in Shop",id:e.id,name:e.subCategoryName,creative:e.imageId,position:`Sub category image ${e.sequence}`}]}}}),vye=({payload:e})=>({...Hs,event:"select_promotion",eventCategory:"Shop in Shop page",eventAction:Tp.SUB_CATEGORY_IMAGE_CLICKED,ecommerce:{promoClick:{promotions:[{promotionType:"Shop in Shop",id:e.id,name:e.subCategoryName,creative:e.imageId,position:`Sub category image ${e.sequence}`}]}}}),Aye=({payload:e})=>({event:e.event,name:e.name,id:e.id,type:e.pageType}),bye=({payload:e})=>({event:"shop_in_shop_navigation",navigation:"subcategory",name:e.subCategoryName,id:e.id,index:Number(e.sequence),type:"curated"}),xye={[Qr.SHOP_IN_SHOP_PAGE_VIEW]:Aye,[Qr.HORIZONTAL_HERO_BANNER_IMPRESSION]:Tye,[Qr.SUB_CATEGORY_IMAGE_IMPRESSION]:_ye,[Qr.SUB_CATEGORY_IMAGE_CLICKED]:vye},Rye={[Qr.SUB_CATEGORY_IMAGE_CLICKED]:bye},mh={SAVED_RECIPES:"SAVED_RECIPES",RECIPE_ASSISTANT:"RECIPE_ASSISTANT"},u_={RECIPE:"RECIPE",RECIPE_COLLECTION:"RECIPE_COLLECTION",RECIPE_HOME_PAGE:"RECIPE_HOME_PAGE"},Sl={TEXT:"TEXT",RECIPE_IMPRESSION:"RECIPE_IMPRESSION"},Dye=e=>({hitType:"recipe_shop_for_ingredients_click",id:e.payload.RECIPE_ID,name:e.payload.RECIPE_NAME}),Oye=e=>({hitType:"recipe_ingredients_no_result",id:e.payload.RECIPE_ID,name:e.payload.RECIPE_NAME,search_term:e.payload.SEARCH_TERM,ingredient_name:e.payload.INGREDIENT_NAME}),Pye=e=>({hitType:e.payload.RECIPE_SEARCH_RESULTS_COUNT?"recipe_search":"recipe_search_no_results",search_term:e.payload.RECIPE_SEARCH_TERM}),Nye=e=>({hitType:"select_recipe",id:e.payload.RECIPE_ID,name:e.payload.RECIPE_NAME,collection_id:e.payload.RECIPE_COLLECTION_ID,servings:e.payload.SERVINGS,total_time:e.payload.TOTAL_TIME,index:e.payload.INDEX,list:e.payload.LIST}),Lye=e=>{const{RECIPE_ID:t,RECIPE_NAME:n,SEQUENCE:o,LIST:r,TOTAL_TIME:a,SERVES:i}=e.payload;return{event:"select_recipe_card",id:t,name:n,...i&&{servings:i},total_time:a,index:o,list:r}},kye=e=>({hitType:"view_recipe",id:e.payload.RECIPE_ID,name:e.payload.RECIPE_NAME,collection_id:e.payload.RECIPE_COLLECTION_ID,servings:e.payload.SERVINGS,total_time:e.payload.TOTAL_TIME,prep_time:e.payload.PREP_TIME,cooking_time:e.payload.COOK_TIME,metrics:e.payload.METRICS,ingredient_count:e.payload.INGREDIENT_COUNT,step_count:e.payload.STEP_COUNT}),Mye=e=>({hitType:"view_recipe_collection",id:e.payload.RECIPE_COLLECTION_ID,name:e.payload.RECIPE_COLLECTION_NAME,recipe_count:e.payload.RECIPE_COUNT}),jye=e=>({hitType:"select_recipe_collection",id:e.payload.RECIPE_COLLECTION_ID,name:e.payload.RECIPE_COLLECTION_NAME,recipe_count:e.payload.RECIPE_COUNT,list:e.payload.LIST,index:e.payload.INDEX}),wye=e=>({hitType:"select_recipe_collection_card",id:e.payload.RECIPE_COLLECTION_ID,name:e.payload.RECIPE_COLLECTION_NAME,index:e.payload.SEQUENCE,list:e.payload.LIST}),Fye=e=>{const{RECIPE_ID:t,RECIPE_NAME:n,SEQUENCE:o,LIST:r,TOTAL_TIME:a,RECIPE_COLLECTION_ID:i,SERVES:l,GROUP_TYPE:c,GROUP_SEQUENCE:d}=e.payload.recipeImpression;return{hitType:"view_recipe_list",id:t,name:n,index:o,list:r,total_time:a,...i&&{collection_id:i},...l&&{servings:l},...c&&{group_type:c},...(d||d===0)&&{group_sequence:d}}},Bye=e=>{const{RECIPE_ID:t,RECIPE_NAME:n,SEQUENCE:o,LIST:r,TOTAL_TIME:a,SERVES:i}=e.payload.recipeImpression;return{event:"view_recipe_card",id:t,name:n,index:o,list:r,total_time:a,...i&&{servings:i}}},Uye=e=>{const{RECIPE_COLLECTION_ID:t,RECIPE_COLLECTION_NAME:n,RECIPE_COUNT:o,SEQUENCE:r,LIST:a,GROUP_TYPE:i,GROUP_SEQUENCE:l}=e.payload.collectionImpression;return{hitType:"view_recipe_collection_list",id:t,name:n,recipe_count:o,list:a,index:r,...i&&{group_type:i},...(l||l===0)&&{group_sequence:l}}},Gye=e=>{const{RECIPE_COLLECTION_ID:t,RECIPE_COLLECTION_NAME:n,SEQUENCE:o,LIST:r}=e.payload.collectionImpression;return{hitType:"view_recipe_collection_card",id:t,name:n,list:r,index:o}},dV={[u_.RECIPE]:"recipe",[u_.RECIPE_COLLECTION]:"recipe-collection",[u_.RECIPE_HOME_PAGE]:"recipe-homepage"},$ye=e=>({event:"select_recipe_homepage_card",type:dV[e.payload.LINK_TYPE],id:e.payload.RECIPE_CARD_ID,name:e.payload.RECIPE_CARD_TITLE,target:e.payload.ENTITY_ID??null,index:e.payload.SEQUENCE}),Hye=e=>({event:"view_recipe_homepage_card",type:dV[e.payload.recipeCardImpression.LINK_TYPE],id:e.payload.recipeCardImpression.RECIPE_CARD_ID,name:e.payload.recipeCardImpression.RECIPE_CARD_TITLE,target:e.payload.recipeCardImpression.ENTITY_ID??null,index:e.payload.recipeCardImpression.SEQUENCE}),Vye=({payload:e})=>({event:"select_recipe_card",id:e.RECIPE_ID,type:"recipe",index:e.INDEX,list:e.LIST}),Yye=({payload:e})=>({event:"view_recipe_card",id:e.RECIPE_ID,type:"recipe",index:e.INDEX,list:e.LIST}),Wye=e=>({event:"save_recipe",id:e.payload.RECIPE_ID,name:e.payload.RECIPE_NAME}),qye=e=>({event:"remove_saved_recipe",id:e.payload.RECIPE_ID,name:e.payload.RECIPE_NAME}),Kye=()=>({event:"select_navigation",navigation:"View all recipes",target:"/recipes",location:"shop-for-ingredients"}),zye=e=>({event:"recipe_assistant_message",id:e.payload.CHAT_ID,type:e.payload.MESSAGE_TYPE,origin:e.payload.MESSAGE_FROM,index:e.payload.SEQUENCE}),Qye=()=>({event:"reopen_recipe_assistant"}),Xye=()=>({event:"minimize_recipe_assistant"}),Zye=()=>({event:"open_recipe_assistant"}),zx="SHOP_FOR_INGREDIENTS_CLICKED",Qx="RECIPE_CLICKED",uV="RECIPE_ADVERT_CLICKED",Xx="RECIPE_ADVERT_IMPRESSION",Zx="RECIPE_COLLECTION_ADVERT_CLICKED",Jx="RECIPE_COLLECTION_ADVERT_IMPRESSION",dg="RECIPE_IMPRESSION",ug="RECIPE_COLLECTION_IMPRESSION",TS="RECIPE_COLLECTION_CLICKED",eR="RECIPE_SEARCH_INPUT_FOCUS",pV="BROWSE_IN_RECIPE_SEARCH_CLICKED",mV="RECIPES_COLLECTIONS_BROWSE_BUTTON_CLICKED",tR="INGREDIENTS_NO_RESULTS",hV="RECIPES_COLLECTIONS_LOAD_MORE_BUTTON_CLICKED",sR="RECIPE_SEARCH_VIEW",nR="RECIPE_DETAILS_VIEW",oR="RECIPE_COLLECTION_DETAILS_VIEW",gV="HOMEPAGE_RECIPE_CARD_CLICKED",EV="HOMEPAGE_RECIPE_CARD_IMPRESSION",fV="RECIPE_CARD_CLICKED",yV="RECIPE_CARD_IMPRESSION",rR="RECIPE_SAVE_BUTTON_CLICKED",aR="RECIPE_UNSAVE_BUTTON_CLICKED",iR="RECIPE_BROWSE_ALL_BUTTON_CLICKED",lR="RECIPE_BROWSE_ALL_BUTTON_IMPRESSION",IV="SAVED_RECIPES_LOAD_MORE_BUTTON_CLICKED",cR="RECIPE_ASSISTANT_BUTTON_CLICKED",dR="RECIPE_ASSISTANT_RESTART_BUTTON_CLICKED",uR="RECIPE_ASSISTANT_MODAL_MINIMIZE_BUTTON_CLICKED",pR="RECIPE_ASSISTANT_REOPENED",SV="RECIPE_ASSISTANT_FLOWOUT_CLOSED",CV="RECIPE_ASSISTANT_RESTART_CANCELLED",TV="RECIPE_ASSISTANT_RESTART_CONFIRMED",_V="RECIPE_ASSISTANT_ERROR_MESSAGE_DISPLAYED",vV="RECIPE_ASSISTANT_TRY_AGAIN_BUTTON_CLICKED",xm="RECIPE_ASSISTANT_MESSAGE_DISPLAYED",Jye={[zx]:Dye,[tR]:Oye,[sR]:Pye,[Qx]:Nye,[uV]:Lye,[nR]:kye,[TS]:jye,[Zx]:wye,[oR]:Mye,[dg]:Fye,[Xx]:Bye,[ug]:Uye,[Jx]:Gye,[gV]:$ye,[EV]:Hye,[fV]:Vye,[yV]:Yye,[rR]:Wye,[aR]:qye,[iR]:Kye,[cR]:Zye,[uR]:Xye,[pR]:Qye,[xm]:zye},AV="MEALS_VIEW",bV="RECIPES_HOME_MEAL_PLANNING_CLICKED",xV="MEAL_DETAILS_DIALOG_DISPLAYED",eIe="SEARCH_RECIPES_CLICKED",tIe="MEAL_CREATE_NEW_DIALOG_DISPLAYED",mR="MEAL_CREATED_SUCCESS",RV="MEAL_PASTE_INGREDIENTS_FROM_CLIPBOARD",DV="MEAL_EDIT_DIALOG_DISPLAYED",hR="MEAL_EDITED_SUCCESS",OV="MEAL_CANCEL_EDIT_DIALOG_DISPLAYED",PV="MEAL_CANCEL_EDIT_CONFIRMED",sIe="MEAL_CREATE_YOUR_FIRST_MEAL_CLICKED",NV="MEAL_DELETE_DIALOG_DISPLAYED",gR="MEAL_DELETE_SUCCESS",nIe=({payload:e})=>({event:"meal_plan_create_meal",id:e.MEAL_ID}),oIe=({payload:e})=>({event:"meal_plan_edit_meal",id:e.MEAL_ID}),rIe=({payload:e})=>({event:"meal_plan_delete_meal",id:e.MEAL_ID}),aIe=({payload:e})=>({event:"meal_plan_view_meal_details",id:e.MEAL_ID}),iIe={[mR]:nIe,[hR]:oIe,[gR]:rIe,[xV]:aIe},lIe="ADD_TO_REGULARS_MODAL_DISPLAYED",cIe="REMOVE_ALL_REGULARS_MODAL_DISPLAYED",dIe="REMOVE_ALL_REGULARS_FROM_BASKET_MODAL_DISPLAYED",uIe="PRODUCT_ADDED_TO_REGULARS",pIe="PRODUCT_REMOVED_FROM_REGULARS",mIe="TOAST_NOTIFICATION_DISPLAYED",hIe="REGULARS_TOTAL_COUNT",gIe="REGULARS_IN_TROLLEY_TOTAL_COUNT",EIe="REGULARS_PARAMETERS_CHANGED",fIe="REMOVE_ALL_REGULARS_FROM_BASKET",yIe="REGULARS_GA_EVENT",IIe="REMOVE_ALL_REGULARS_GA_EVENT",fs={ADD_TO_REGULARS_MODAL_DISPLAYED:lIe,REMOVE_ALL_REGULARS_MODAL_DISPLAYED:cIe,REMOVE_ALL_REGULARS_FROM_BASKET_MODAL_DISPLAYED:dIe,PRODUCT_ADDED_TO_REGULARS:uIe,PRODUCT_REMOVED_FROM_REGULARS:pIe,TOAST_NOTIFICATION_DISPLAYED:mIe,REGULARS_TOTAL_COUNT:hIe,REGULARS_IN_TROLLEY_TOTAL_COUNT:gIe,REGULARS_PARAMETERS_CHANGED:EIe,REMOVE_ALL_REGULARS_FROM_BASKET:fIe,REGULARS_GA_EVENT:yIe,REMOVE_ALL_REGULARS_GA_EVENT:IIe},SIe=e=>({event:e.payload.event,id:e.payload.retailerProductId,name:e.payload.productName,index:e.payload.productIndex,list:e.payload.list,quantity:e.payload.quantity,frequency:e.payload.frequency}),CIe=e=>({event:"remove_all_regulars",count:e.payload.count}),TIe={[fs.REGULARS_GA_EVENT]:SIe,[fs.REMOVE_ALL_REGULARS_GA_EVENT]:CIe},_Ie="ADD_DELIVERY_ADDRESS_SELECTED",vIe="BENEFIT_GROUP_SELECTED",AIe="DELIVERY_PASS_PLAN_SEEN",bIe="DELIVERY_PASS_SUBSCRIPTION_STARTED",xIe="DELIVERY_PASS_TERMS_CONDITIONS_CLICKED",RIe="DELIVERY_PASS_BUTTON_CLICKED",DIe="BUY_PLAN_BUTTON_CLICKED",OIe="FREE_TRIAL_BUTTON_CLICKED",PIe="MANAGE_CURRENT_PLAN_BUTTON_CLICKED",NIe="SELECTED_DELIVERY_PASS_PLAN_MODAL_DISPLAYED",LIe="VIEW_ALL_PLANS_BUTTON_CLICKED",kIe="DELIVERY_PASS_SIGN_UP",MIe="DELIVERY_PASS_CANCEL_AUTO_RENEW",jIe="DELIVERY_PASS_ENABLE_AUTO_RENEW",Es={ADD_DELIVERY_ADDRESS_SELECTED:_Ie,BENEFIT_GROUP_SELECTED:vIe,DELIVERY_PASS_PLAN_SEEN:AIe,DELIVERY_PASS_SUBSCRIPTION_STARTED:bIe,DELIVERY_PASS_TERMS_CONDITIONS_CLICKED:xIe,VIEW_ALL_PLANS_BUTTON_CLICKED:LIe,DELIVERY_PASS_BUTTON_CLICKED:RIe,BUY_PLAN_BUTTON_CLICKED:DIe,FREE_TRIAL_BUTTON_CLICKED:OIe,MANAGE_CURRENT_PLAN_BUTTON_CLICKED:PIe,SELECTED_DELIVERY_PASS_PLAN_MODAL_DISPLAYED:NIe,DELIVERY_PASS_SIGN_UP:kIe,DELIVERY_PASS_CANCEL_AUTO_RENEW:MIe,DELIVERY_PASS_ENABLE_AUTO_RENEW:jIe};function ER(e,t){const{retailerSubscriptionPlanId:n,price:o,currency:r}=t;return{event:e,id:n,price:o,currency:r}}const wIe=e=>ER("delivery_pass_sign_up",e.payload),FIe=e=>ER("delivery_pass_cancel_auto_renew",e.payload),BIe=e=>ER("delivery_pass_enable_auto_renew",e.payload),UIe={[Es.DELIVERY_PASS_SIGN_UP]:wIe,[Es.DELIVERY_PASS_CANCEL_AUTO_RENEW]:FIe,[Es.DELIVERY_PASS_ENABLE_AUTO_RENEW]:BIe},GIe="GA_ADD_TO_WISHLIST",$Ie="GA_REMOVE_FROM_WISHLIST",HIe="GA_CREATE_LIST",VIe="GA_DELETE_LIST",xl={GA_ADD_TO_WISHLIST:GIe,GA_REMOVE_FROM_WISHLIST:$Ie,GA_CREATE_LIST:HIe,GA_DELETE_LIST:VIe},YIe=e=>({event:"add_to_wishlist",type:e.payload.eventType,ecommerce:e.payload.ecommerce}),WIe=e=>({event:"remove_from_wishlist",type:e.payload.eventType,id:e.payload.id,name:e.payload.name,index:e.payload.index,quantity:e.payload.quantity,list:e.payload.list}),qIe=e=>({event:e.payload.event}),KIe=e=>({event:e.payload.event}),zIe={[xl.GA_ADD_TO_WISHLIST]:YIe,[xl.GA_REMOVE_FROM_WISHLIST]:WIe,[xl.GA_CREATE_LIST]:qIe,[xl.GA_DELETE_LIST]:KIe},QIe=({payload:e})=>({event:"view_coupon",id:e.id,name:e.name,index:e.index}),XIe=({payload:e})=>({event:"select_coupon",id:e.id,name:e.name,index:e.index}),Ca={ONBOARDING_CARD_CLOSED:"ONBOARDING_CARD_CLOSED",LEARN_MORE_BUTTON_CLICKED:"LEARN_MORE_BUTTON_CLICKED",COUPON_ONBOARDING_CARD_IMPRESSION:"COUPON_ONBOARDING_CARD_IMPRESSION",LEARN_MORE_BUTTON_IMPRESSION:"LEARN_MORE_BUTTON_IMPRESSION",PROMOTIONS_TAB_CLICKED:"PROMOTIONS_TAB_CLICKED",EMPTY_COUPONS_PROMO_BUTTON_CLICKED:"EMPTY_COUPONS_PROMO_BUTTON_CLICKED",COUPON_CLICKED:"COUPON_CLICKED",COUPON_IMPRESSION:"COUPON_IMPRESSION",COUPONS_AVAILABLE:"COUPONS_AVAILABLE",GA4_COUPON_IMPRESSION:"GA4_COUPON_IMPRESSION",GA4_COUPON_CLICKED:"GA4_COUPON_CLICKED"},ZIe={[Ca.GA4_COUPON_CLICKED]:XIe,[Ca.GA4_COUPON_IMPRESSION]:QIe},JIe=e=>{const{payload:{index:t,name:n,currency:o,value:r,transactionId:a,groupId:i}}=e;return{event:"checkout_walk",index:t??null,name:n??null,currency:o,value:r?Number(r):null,osp_transaction_id:a,group_id:i}},eSe={[Kn.CHECKOUT_WALK_GA4]:JIe},tSe="quick-view-trolley",LV=e=>typeof e.quantity=="object"&&e.quantity?.quantityInBasket||typeof e.quantity!="object"&&e.quantity||e.quantityInBasket||e.addedAmount||0,sSe=e=>!!(e.available&&!e.maxQuantityReached),nSe=e=>e?.offers?.filter(t=>t.retailerPromotionId)?.map(t=>t.retailerPromotionId).join(","),kV=(e,t=15)=>{function*n(o,r){for(let a=0;a<o.length;a+=r)yield o.slice(a,a+r)}return[...n(e,t)]},oSe=e=>e.reduce((t,n)=>{const o=LV(n),r=n?.price?.current?.amount??0;return t+Number(r)*o},0),MV=e=>{const{position:t,product:n,productListName:o,event:r,page:a,section:i,meta:l,featuredProductCampaigns:c}=e;return n.map(d=>{const u=Bn(d,c),m=!!d?.offers?.length,g=nSe(d),f=d?.price?.current?.amount,y=d?.ratingSummary?.overallRating,I=o||Ws(a,"",i||""),S=nd(I),{campaignId:C=null,campaignName:_=null}=u||{},A={item_id:d.retailerProductId||null,item_name:d?.name||null,index:t??null,item_brand:d?.brand||null,hfss_display_restriction_group:d?.hfssDisplayRestrictionGroup||null,item_list_name:I,item_variant:d?.size?.value||null,price:f?Number(f):null,rating:y?Number(y):null,quantity:LV(d)||null,is_on_promotion:m,is_favorite:!!d?.favorite,is_featured:S&&!!u,featured_campaign_id:S?C:null,featured_campaign_name:S?_:null,promotion_ids:m&&g?g:null,...ol(d?.categoryPath??[]),seller_id:d.seller?.id||null};if(r!=="add_to_cart"){const x={...A,can_add_to_cart:sSe(d)};return r==="view_cart"?tc({productId:d.productId,item:x,meta:l}):x}return A})},bj=e=>(t,n)=>{const{payload:{addedByFunction:o,basket:r,product:a,productListName:i,position:l,page:c,section:d}}=t,u=r?.totals?.display?.itemPriceAfterPromos?.amount||null,m=kV(a),g=qs(n);return m.map(f=>{const y=oSe(f);return{event:e,ecommerce:{currency:a[0]?.price?.current?.currency||null,cart_value:u?Number(u):null,cart_update_value:null,value:y,osp_transaction_id:r?.orderId||null,items:MV({event:e,product:f,position:l,productListName:i,page:c,section:d,featuredProductCampaigns:g})},cart_function:o}})},rSe=(e,t)=>{const{payload:n}=e,o=qs(t);return kV(n.products).map(a=>({event:"view_cart",type:n.cartType,ecommerce:{currency:n.currencyCode||null,cart_value:n.total?Number(n.total):null,osp_transaction_id:n.orderId??null,group_id:n.groupId||null,items:MV({event:"view_cart",product:a,position:n.position,productListName:Ws(n.page,"",n.cartType==="expanded"?tSe:""),page:n.page,meta:n.meta,featuredProductCampaigns:o})}}))},aSe=e=>{const t=e?.payload?.prevOrderId,n=e?.payload?.nextOrderId;return{event:"merge_cart",type:"edit-merge",previous_transaction_id:t,osp_transaction_id:n}},xj=e=>t=>({event:e,order_id:t.payload.orderId}),iSe=()=>({event:"view_cart_checkout"}),lSe=()=>({event:"view_cart_book_slot"}),cSe={[Te.ADD_TO_CART_GA4]:bj("add_to_cart"),[Te.REMOVE_BASKET_ITEM]:bj("remove_from_cart"),[Te.VIEW_CART]:rSe,[Te.MERGE_CART]:aSe,[Te.CHECKOUT_ORDER_BUTTON_CLICKED]:xj("cart_checkout"),[Te.CHECKOUT_ORDER_BUTTON_VIEWED]:iSe,[Te.BOOK_SLOT_BUTTON_CLICKED]:xj("cart_book_slot"),[Te.BOOK_SLOT_BUTTON_VIEWED]:lSe},dSe={...Re,fetchError:!1,isFetching:!1,error:null,customerSegments:[{name:"segment_list_01",shortCodes:null}]},uSe=(e=dSe,t)=>{switch(t.type){case"GET_CUSTOMER_SEGMENTS_PENDING":return{...e,isFetching:!0,fetchError:!1};case"GET_CUSTOMER_SEGMENTS_SUCCESS":return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),customerSegments:t.payload.responseData};case"GET_CUSTOMER_SEGMENTS_ERROR":return{...e,isFetching:!1,fetchError:!0,error:t.payload};default:return e}},fR=({data:e})=>e.customer.segments,pSe=(e,t,n)=>{const o=pa(n)?.amount,r=ec(n),{pagePartType:a}=e.payload;return{event:"page_view",session_id:Kl(t)||null,page_view_id:On(n)||null,page_type:a||Td(n,window.location)||null,customer_id:ua(t)||null,osp_transaction_id:At(n)||null,transaction_type:Mr(n)?"edit":"new",region_id:ar(t)||null,banner_id:Qh(t)||null,region_name:eS(t)||null,banner_name:fd(t)||null,cart_value:o?Number(o):null,customer_email:r.data.email||null,customer_first_name:r.data["attr.firstName"]||null,customer_last_name:r.data["attr.surname"]||null,is_logged_in:!!Ze(n)}},mSe=e=>({event:"select_navigation",name:e.payload.name,location:e.payload.location}),hSe=(e,t,n)=>{if(!D("seg.dl")(t)||!Ze(n))return{};const{customerSegments:r}=fR(n);return{event:"active_segments",...(r||[]).reduce((i,l)=>({...i,[l.name]:l.shortCodes}),{})}},gSe="PAGE_ATTRIBUTES_MULTIPLE",ESe="SELECT_NAVIGATION",As={PAGE_ATTRIBUTES_MULTIPLE:gSe,SELECT_NAVIGATION:ESe},jl=(...e)=>(...t)=>e.map(n=>n(...t)),fSe={[mn]:jl(pSe,hSe),[As.SELECT_NAVIGATION]:mSe},Rj=e=>t=>{const{payload:{loyaltyAmount:n,transactionId:o,groupId:r}}=t;return{event:e,osp_transaction_id:o||null,loyalty_amount:n,group_id:r}},vy={USE_LOYALTY:"USE_LOYALTY",REMOVE_LOYALTY:"REMOVE_LOYALTY"},ySe={[vy.USE_LOYALTY]:Rj("use_loyalty"),[vy.REMOVE_LOYALTY]:Rj("remove_loyalty")},ISe="SKIPPED_ADDRESS_SELECTION",SSe="C_N_C_GEOLOCATION_EVENT",CSe="C_N_C_ADDRESS_SEARCH_TERM",TSe="C_N_C_ADDRESS_SEARCH_FOCUS",_Se="C_N_C_ADDRESS_SELECT",vSe="C_N_C_ADDRESS_PIN_CLICK",ASe="C_N_C_HOME_DELIVERY_TAB_CLICKED",bSe="DELIVERY_DESTINATION_HEADER_CLICKED",xSe="HOMEPAGE_DELIVERY_DESTINATION_CARD_CLICKED",RSe="CHANGE_ADDRESS_BUTTON_CLICKED",DSe="DELIVERY_DESTINATION_MODAL_CLOSED",OSe="DELIVERY_DESTINATIONS_SELECTOR_SEARCH_FOCUS",PSe="DELIVERY_DESTINATIONS_SELECTOR_GEOLOCATION_EVENT",NSe="SELECT_DELIVERY_DESTINATION",LSe="DELIVERY_OPTION_MODAL_TRIGGERED",kSe="HOMEPAGE_BOX_DDS_IMPRESSION",_s={SKIPPED_ADDRESS_SELECTION:ISe,C_N_C_GEOLOCATION_EVENT:SSe,C_N_C_ADDRESS_SEARCH_TERM:CSe,C_N_C_ADDRESS_SEARCH_FOCUS:TSe,C_N_C_ADDRESS_SELECT:_Se,C_N_C_ADDRESS_PIN_CLICK:vSe,C_N_C_HOME_DELIVERY_TAB_CLICKED:ASe,HOMEPAGE_DELIVERY_DESTINATION_CARD_CLICKED:xSe,DELIVERY_DESTINATION_HEADER_CLICKED:bSe,CHANGE_ADDRESS_BUTTON_CLICKED:RSe,DELIVERY_DESTINATION_MODAL_CLOSED:DSe,DELIVERY_DESTINATIONS_SELECTOR_SEARCH_FOCUS:OSe,DELIVERY_DESTINATIONS_SELECTOR_GEOLOCATION_EVENT:PSe,SELECT_DELIVERY_DESTINATION:NSe,DELIVERY_OPTION_MODAL_TRIGGERED:LSe,HOMEPAGE_BOX_DDS_IMPRESSION:kSe},MSe={CUSTOMER_COLLECTION:"click_and_collect",HOME_DELIVERY:"home_delivery"},jSe=e=>{const{payload:{deliveryMethod:t,groupId:n}}=e;return{event:"select_delivery_destination",method:MSe[t],group_id:n}},jV={HOMEPAGE_BOX_CLICKED:"homebox",HEADER_CLICKED:"header",MORE_CLICKED:"menu",HOMEPAGE_CARD_CLICKED:"homepage-card"},wSe=e=>{const t=jV[e.payload.userAction];return t?{event:"select_navigation",name:"delivery-destination",location:t}:null},FSe={[_s.SELECT_DELIVERY_DESTINATION]:jSe,[_s.DELIVERY_OPTION_MODAL_TRIGGERED]:wSe},Dj=e=>t=>{const{payload:{transactionId:n,voucherCode:o,groupId:r}}=t;return{event:e,id:o||null,osp_transaction_id:n||null,group_id:r}},Ay={USE_PROMOTION_CODE:"USE_PROMOTION_CODE",REMOVE_PROMOTION_CODE:"REMOVE_PROMOTION_CODE"},BSe={[Ay.USE_PROMOTION_CODE]:Dj("use_promotion_code"),[Ay.REMOVE_PROMOTION_CODE]:Dj("remove_promotion_code")},USe="CONFIRM_REQUEST_BUTTON_CLICKED",GSe="REFUND_REQUEST_ITEM_CANCELLED",$Se="REFUND_REQUEST_ITEM_SELECTED",HSe="REQUEST_REFUND_BUTTON_CLICKED",VSe="REQUEST_REFUND_GA4",vu={CONFIRM_REQUEST_BUTTON_CLICKED:USe,REFUND_REQUEST_ITEM_CANCELLED:GSe,REFUND_REQUEST_ITEM_SELECTED:$Se,REQUEST_REFUND_BUTTON_CLICKED:HSe,REQUEST_REFUND_GA4:VSe},YSe=e=>{const{payload:{refundTotal:t,requestedItems:n,orderId:o}}=e,r=n.map(i=>({item_id:i?.retailerProductId||null,item_name:i?.productName||null,quantity:i?.requestedQuantity||null,refund_reason:i?.refundReasonDescription||null,seller_id:i?.sellerId||null})),a=le();return{event:"refund",ecommerce:{osp_transaction_id:o||null,transaction_id:`${o}-${a}`,value:t?.amount?Number(t.amount):null,currency:t?.currency||null,items:r}}},WSe={[vu.REQUEST_REFUND_GA4]:YSe},wV=e=>e.map(t=>t.id).join(", "),FV=e=>Object.keys(e).reduce((n,o)=>{if(o==="delivery"||o==="deliveryPromotions")return n;const r=e[o];return r?.amount?n+Number(r.amount):n},0),BV=(e,t)=>{const n=Mt(e),o=Mt(t);return{slot_start_time:n.format(vn),slot_end_time:o.format(vn),slot_date:n.format(oa),slot_day:n.isoWeekday()}},qSe=e=>{const{orderId:t,state:n,meta:o}=e,r=nl(n,t),a=Ts(n),i=qs(n),{orderTotals:l,charges:c,items:d,loyalty:u,appliedVouchers:m,deliveryMethod:g,dates:f}=r,{currency:y,amount:I}=l.totalPrice,{amount:S}=l.finalPrice,{components:C}=l.taxesTotals.taxes,{amount:_}=c.delivery,A=C.reduce(($,K)=>$+Number(K?.taxAmount?.amount??0),0),x=Fo(n),R=u?.spent?.money.amount,O=wV(m),N=FV(c),{slot_day:k,slot_start_time:j,slot_end_time:w,slot_date:L}=BV(f.deliveryStartDate,f.deliveryEndDate),B=d.map($=>{const{product:K,quantity:Q}=$,X=a[K],re=Bn(X,i),ue=!!X?.offers?.length,te=X?.offers?.map(Ae=>Ae.retailerPromotionId).join(","),ce=X?.price?.current.amount,de=X?.ratingSummary?.overallRating,ye={item_id:X?.retailerProductId||null,item_name:X?.name||null,index:null,item_brand:X?.brand||null,hfss_display_restriction_group:X?.hfssDisplayRestrictionGroup||null,item_list_name:Ws("order","details",""),item_variant:X?.size?.value.toString()||null,price:ce?Number(ce):null,rating:de?Number(de):null,quantity:Q?-Number(Q):null,is_on_promotion:ue,promotion_ids:ue&&te?te:null,is_favorite:!!X?.favorite,is_featured:!!re,featured_campaign_id:re?.campaignId||null,featured_campaign_name:re?.campaignName||null,...ol(X?.categoryPath??[]),seller_id:X?.seller?.id||null};return tc({productId:K,item:ye,meta:o})});return{event:"purchase",fulfillment_method:{CUSTOMER_COLLECTION:"click_and_collect",HOME_DELIVERY:"home_delivery"}[g],slot_day:k,slot_date:L,slot_end_time:w,slot_start_time:j,ecommerce:{osp_transaction_id:t||null,group_id:x,transaction_type:"cancel-order",transaction_id:`${t}-${le()}`,value:S?-Number(S):null,total_value:I?-Number(I):null,tax:A?-Number(A):null,shipping:_?-Number(_):null,currency:y||null,loyalty:R?-Number(R):null,coupon:O.length?O:null,charges:N?-N:null,items:B}}},KSe=e=>({event:"edit_order",osp_transaction_id:e.payload.orderId||null,group_id:e.payload.groupId||null}),zSe=e=>{const{payload:{orderId:t,state:n,meta:o}}=e,r=nl(n,t),a=Ts(n),i=qs(n),{orderTotals:l,charges:c,items:d,loyalty:u,appliedVouchers:m,deliveryMethod:g,dates:f}=r,{currency:y,amount:I}=l.totalPrice,{amount:S}=l.finalPrice,{components:C}=l.taxesTotals.taxes,{amount:_}=c.delivery,A=C.reduce(($,K)=>$+Number(K?.taxAmount?.amount??0),0),x=Fo(n),R=u?.spent?.money.amount,O=wV(m),N=FV(c),{slot_day:k,slot_start_time:j,slot_end_time:w,slot_date:L}=BV(f.deliveryStartDate,f.deliveryEndDate),B=d.map($=>{const{product:K,quantity:Q}=$,X=a[K],re=Bn(X,i),ue=!!X?.offers?.length,te=X?.offers?.map(Ae=>Ae.retailerPromotionId).join(","),ce=X?.price?.current.amount,de=X?.ratingSummary?.overallRating,ye={item_id:X?.retailerProductId||null,item_name:X?.name||null,index:null,item_brand:X?.brand||null,hfss_display_restriction_group:X?.hfssDisplayRestrictionGroup||null,item_list_name:Ws("order","details",""),item_variant:X?.size?.value||null,price:ce?Number(ce):null,rating:de?Number(de):null,quantity:Q?-Number(Q):null,is_on_promotion:ue,promotion_ids:ue&&te?te:null,is_favorite:!!X?.favorite,is_featured:!!re,featured_campaign_id:re?.campaignId||null,featured_campaign_name:re?.campaignName||null,...ol(X?.categoryPath??[]),seller_id:X?.seller?.id||null};return tc({productId:K,item:ye,meta:o})});return{event:"purchase",fulfillment_method:{CUSTOMER_COLLECTION:"click_and_collect",HOME_DELIVERY:"home_delivery"}[g],slot_day:k,slot_date:L,slot_end_time:w,slot_start_time:j,ecommerce:{osp_transaction_id:t||null,group_id:x,transaction_type:"cancel-order",transaction_id:`${t}-${le()}`,value:S?-Number(S):null,total_value:I?-Number(I):null,tax:A?-Number(A):null,shipping:_?-Number(_):null,currency:y||null,loyalty:R?-Number(R):null,coupon:O.length?O:null,charges:N?-N:null,items:B}}},QSe={[js.EDIT_ORDER_GA4]:KSe,[js.ORDER_CANCELLED_GA4]:zSe},XSe="SLOT_IMPRESSION",ZSe="ALERT_IMPRESSION",JSe="SLOT_BOOKING_MODAL_DISPLAYED",eCe="SLOT_BOOKED",tCe="GA4_SLOT_BOOKED",UV="ADDRESS_SELECTION_DROP_DOWN_CLICKED",GV="ADDRESS_FROM_DROP_DOWN_SELECTED",$V="COLLECTION_POINT_FROM_DROP_DOWN_SELECTED",HV="CHOOSE_DIFFERENT_COLLECTION_POINT_BUTTON_CLICKED",sCe="SELECT_FULFILLMENT_LOCATION",VV="ITEM_WINDOW_EXPANDED",YV="ITEM_WINDOW_REDUCED",WV="STANDARD_SLOTS_BUTTON_CLICKED",qV="SAVER_SLOTS_BUTTON_CLICKED",nCe="MAP_RENDERED_REASON",KV="CARRIER_SELECTION_CLICKED",zV="CONTINUE_CHECKOUT_BUTTON_CLICKED",QV="CHOOSE_CARRIER_MODAL_DISPLAYED",XV="SELECT_PICK_UP_POINT_BUTTON_CLICKED",oCe="CARRIER_SELECTION_CARD_IMPRESSION",ZV="SHIPPING_METHOD_NOT_VALID_MODAL_DISPLAYED",JV="SELECT_SHIPPING_METHOD_BUTTON_CLICKED",e2="CHANGE_DELIVERY_METHOD_MODAL_DISPLAYED",t2="CONTINUE_AND_SEE_TROLLEY_BUTTON_CLICKED",s2="CHANGE_DELIVERY_METHOD_CANCEL_BUTTON_CLICKED",n2="EXTERNAL_COLLECTION_POINT_SELECT_BUTTON_CLICKED",o2="DELIVERY_DETAILS_MODAL_DISPLAYED",rCe="DELIVERY_OPTIONS_VIEWED",r2="DELIVERY_ASSET_CHANGED",aCe="SEASONAL_SLOTS_BANNER_IMPRESSION",a2="SEASONAL_SLOTS_BANNER_CLICKED",iCe="SLOTBOOKING_NO_SAVED_ADDRESS_DISPLAYED",lCe="CALENDAR_CLICKED",cCe="CALENDAR_DATE_SELECTED",Fe={SLOT_IMPRESSION:XSe,ALERT_IMPRESSION:ZSe,SLOT_BOOKING_MODAL_DISPLAYED:JSe,SLOT_BOOKED:eCe,GA4_SLOT_BOOKED:tCe,ADDRESS_SELECTION_DROP_DOWN_CLICKED:UV,ADDRESS_FROM_DROP_DOWN_SELECTED:GV,COLLECTION_POINT_FROM_DROP_DOWN_SELECTED:$V,CHOOSE_DIFFERENT_COLLECTION_POINT_BUTTON_CLICKED:HV,SELECT_FULFILLMENT_LOCATION:sCe,ITEM_WINDOW_REDUCED:YV,ITEM_WINDOW_EXPANDED:VV,STANDARD_SLOTS_BUTTON_CLICKED:WV,SAVER_SLOTS_BUTTON_CLICKED:qV,MAP_RENDERED_REASON:nCe,CARRIER_SELECTION_CLICKED:KV,CONTINUE_CHECKOUT_BUTTON_CLICKED:zV,CHOOSE_CARRIER_MODAL_DISPLAYED:QV,SELECT_PICK_UP_POINT_BUTTON_CLICKED:XV,CARRIER_SELECTION_CARD_IMPRESSION:oCe,SHIPPING_METHOD_NOT_VALID_MODAL_DISPLAYED:ZV,SELECT_SHIPPING_METHOD_BUTTON_CLICKED:JV,CHANGE_DELIVERY_METHOD_MODAL_DISPLAYED:e2,CONTINUE_AND_SEE_TROLLEY_BUTTON_CLICKED:t2,CHANGE_DELIVERY_METHOD_CANCEL_BUTTON_CLICKED:s2,EXTERNAL_COLLECTION_POINT_SELECT_BUTTON_CLICKED:n2,DELIVERY_DETAILS_MODAL_DISPLAYED:o2,DELIVERY_OPTIONS_VIEWED:rCe,DELIVERY_ASSET_CHANGED:r2,SEASONAL_SLOTS_BANNER_IMPRESSION:aCe,SEASONAL_SLOTS_BANNER_CLICKED:a2,SLOTBOOKING_NO_SAVED_ADDRESS_DISPLAYED:iCe,CALENDAR_CLICKED_EVENT:lCe,CALENDAR_DATE_SELECTED_EVENT:cCe},xr={[GV]:"User selected an address from the address drop-down",[$V]:"User selected a different collection point from the collection point drop-down",[UV]:"User clicked on address selection drop down",[HV]:"User clicked the 'Choose a different collection point' button",[YV]:"The user reduced the product images",[VV]:"The user expanded the product images to see all",[WV]:"User clicked standard slots button",[qV]:"User clicked saver slots button",[KV]:"User clicked carrier option",[zV]:"User clicked continue_checkout button for a selected carrier",[QV]:"User clicked on show_all_carriers button",[XV]:"User clicked select_pick_up_point button in the customer collection view",[ZV]:"Shipping method not valid modal displayed",[JV]:"User clicked select_shipping_method_button",[e2]:"Change delivery method modal displayed when user changed the address and some items might not be available",[t2]:"User clicked continue_and_see_trolley button on the change_delivery_method modal",[s2]:"User clicked cancel button on the change_delivery_method modal",[n2]:"User clicked select_external_collection_point button",[o2]:"A delivery details modal was displayed",[r2]:"Delivery asset was changed from packaging card",[a2]:"User clicked on the seasonal slots banner action button"},hh={CUSTOMER_COLLECTION:"click_and_collect",HOME_DELIVERY:"home_delivery"},dCe=e=>{const{payload:{deliveryMethod:t,deliveryDestinationId:n}}=e;return{event:"select_fulfillment_location",method:hh[t],fulfillment_location_id:n}},uCe=(e,t)=>{const{slot:n}=e.payload,o=At(t)??"",r=Fo(t),a=Mt(n.startTime),i=Mt(n.endTime),l=()=>n.type==="ON_DEMAND"?{}:{slot_start_time:a.format(vn),slot_end_time:i.format(vn)};return{event:"slot_booked",method:hh[n.deliveryMethod],osp_transaction_id:o,group_id:r,...l(),slot_date:a.format(oa),slot_day:a.isoWeekday(),slot_type:n.type,slot_price:parseFloat(e.deliveryPrice.amount),site_id:""}},pCe={[Fe.SELECT_FULFILLMENT_LOCATION]:dCe,[Fe.GA4_SLOT_BOOKED]:uCe},mCe=e=>{const{ENTRY_ID:t,ENTRY_NAME:n,TYPE:o}=e.payload;return{event:"view_componentized_homepage",name:n,id:t,type:o}},hCe="HOMEPAGE_SLOT_BOOKING_CARD_CLICKED",gCe="HOME_CARD_IMPRESSION",ECe="HOMEPAGE_UPCOMING_ORDER_CARD_CLICKED",fCe="MULTIPLE_UPCOMING_ORDERS_CARD_CLICKED",yCe="HOMEPAGE_ADD_FUNCTION_CARD_CLICKED",ICe="HOMEPAGE_COMPONENTIZED_AREA_IMPRESSION",SCe="PRODUCT_CLUSTERS_FILTER_CLICKED",CCe="PRODUCT_CLUSTERS_FILTERS_IMPRESSION",Ss={HOMEPAGE_SLOT_BOOKING_CARD_CLICKED:hCe,HOME_CARD_IMPRESSION:gCe,HOMEPAGE_UPCOMING_ORDER_CARD_CLICKED:ECe,MULTIPLE_UPCOMING_ORDERS_CARD_CLICKED:fCe,HOMEPAGE_ADD_FUNCTION_CARD_CLICKED:yCe,HOMEPAGE_COMPONENTIZED_AREA_IMPRESSION:ICe,PRODUCT_CLUSTERS_FILTER_CLICKED:SCe,PRODUCT_CLUSTERS_FILTERS_IMPRESSION:CCe},TCe={[Ss.HOMEPAGE_COMPONENTIZED_AREA_IMPRESSION]:mCe},_S=e=>{if(!e)return null;const{unit:t,value:n}=e;return`every_${n}_${t.toLowerCase()}`},vS=e=>e.dayOfWeekIso?Number(e.dayOfWeekIso):e.day?Zr().day(e.day).isoWeekday():null,i2=e=>t=>{const{payload:{recurringOrderType:n,recurringShoppingDefinition:o}}=t;return{event:e,frequency:_S(o.frequency),type:n,slot_day:vS(o.deliveryWindow),slot_start_time:o.deliveryWindow?.from||null,slot_end_time:o.deliveryWindow?.to||null}},_Ce=e=>i2("recurring_order_creation")(e),vCe=e=>i2("recurring_order_cancellation")(e),ACe="RECURRING_ORDER_CARD_CLICKED",bCe="RECURRING_ORDER_CANCEL_MODAL_EVENT",xCe="PLACEHOLDER_RECURRING_ORDER_DETAILS_CANCEL_MODAL_EVENT",RCe="RECURRING_ORDER_CREATED_GA4_EVENT",DCe="RECURRING_ORDER_CANCELED_GA4_EVENT",OCe="MANAGE_RECURRING_ORDER_BUTTON_CLICKED",PCe="EDIT_PAYMENT_BUTTON_CLICKED",NCe="CANCEL_RECURRING_ORDER_BUTTON_CLICKED",LCe="CANCEL_SELECTED_RECURRING_ORDERS_BUTTON_CLICKED",kCe="CHECKBOX_FOR_UPCOMING_RECURRING_ORDERS_CLICKED",MCe="CLEAR_SELECTED_BUTTON_CLICKED",jCe="CHOOSE_PAYMENT_METHOD_MODAL_DISPLAYED",wCe="CONFIRM_RECURRING_ORDER_CANCELLATION_MODAL_DISPLAYED",FCe="CONFIRMED_RECURRING_ORDER_CANCEL_MODAL",BCe="NO_BUTTON_CLICKED",UCe="RECURRING_ORDER_DAY_AND_TIME_MODAL_DISPLAYED",GCe="RECURRING_ORDER_TIME_REJECTED_FROM_DROPDOWN",$Ce="RECURRING_ORDER_DAY_AND_TIME_SAVED",HCe="RECURRING_ORDER_DAY_AND_TIME_MODAL_CLOSED",ht={RECURRING_ORDER_CARD_CLICKED:ACe,RECURRING_ORDER_CANCEL_MODAL_EVENT:bCe,PLACEHOLDER_RECURRING_ORDER_DETAILS_CANCEL_MODAL_EVENT:xCe,MANAGE_RECURRING_ORDER_BUTTON_CLICKED:OCe,RECURRING_ORDER_CREATED_GA4_EVENT:RCe,RECURRING_ORDER_CANCELED_GA4_EVENT:DCe,EDIT_PAYMENT_BUTTON_CLICKED:PCe,CANCEL_RECURRING_ORDER_BUTTON_CLICKED:NCe,CANCEL_SELECTED_RECURRING_ORDERS_BUTTON_CLICKED:LCe,CHECKBOX_FOR_UPCOMING_RECURRING_ORDERS_CLICKED:kCe,CLEAR_SELECTED_BUTTON_CLICKED:MCe,CHOOSE_PAYMENT_METHOD_MODAL_DISPLAYED:jCe,CONFIRM_RECURRING_ORDER_CANCELLATION_MODAL_DISPLAYED:wCe,CONFIRMED_RECURRING_ORDER_CANCEL_MODAL:FCe,NO_BUTTON_CLICKED:BCe,RECURRING_ORDER_DAY_AND_TIME_MODAL_DISPLAYED:UCe,RECURRING_ORDER_TIME_REJECTED_FROM_DROPDOWN:GCe,RECURRING_ORDER_DAY_AND_TIME_SAVED:$Ce,RECURRING_ORDER_DAY_AND_TIME_MODAL_CLOSED:HCe},VCe={[ht.RECURRING_ORDER_CREATED_GA4_EVENT]:_Ce,[ht.RECURRING_ORDER_CANCELED_GA4_EVENT]:vCe},Pc={PROMOTIONS_NO_RESULTS:"PROMOTIONS_NO_RESULTS",COMBO_PROMO_COMPLETED:"COMBO_PROMO_COMPLETED",COMBO_PROMO_ACCORDION_EXPANDED:"COMBO_PROMO_ACCORDION_EXPANDED",COMBO_PROMO_ACCORDION_COLLAPSED:"COMBO_PROMO_ACCORDION_COLLAPSED",COUPONS_TAB_CLICKED:"COUPONS_TAB_CLICKED",VIEW_PROMOTION_DETAILS:"VIEW_PROMOTION_DETAILS"},YCe={[Pc.VIEW_PROMOTION_DETAILS]:Ape},WCe="CONTENT_BLOCK_CLICKED",qCe="CONTENT_BLOCK_IMPRESSION",KCe="CONTENT_BLOCK_CLOSE_BUTTON_CLICKED",Xr={CONTENT_BLOCK_CLICKED:WCe,CONTENT_BLOCK_IMPRESSION:qCe,CONTENT_BLOCK_CLOSE_BUTTON_CLICKED:KCe},zCe=({payload:e})=>({event:"content_block_navigation",name:e.entryName,id:e.entryId,link_type:e.linkType,target:e.targetUrl}),QCe={[Xr.CONTENT_BLOCK_CLICKED]:zCe},XCe={[mn]:uA,[JI]:uA},ZCe=[jEe],JCe=[...ZCe,XCe,dpe,vpe,Bpe,Mpe,Zpe,Jpe,Eme,fme,cSe,_me,ahe,hhe,ghe,Qhe,xEe,xhe,eSe,kEe,UEe,GEe,pfe,gfe,vfe,Sfe,Ofe,Lfe,fSe,nye,aye,pye,Cye,Rye,xye,Jye,iIe,TIe,zIe,UIe,ZIe,ySe,BSe,FSe,WSe,QSe,pCe,QCe,VCe,YCe,TCe,Fpe],eTe=JCe.reduce((e,t)=>(Object.keys(t).forEach(n=>{e[n]=e[n]?jl(e[n],t[n]):t[n]}),e),{}),tTe=e=>{const t=D("al")(e.getState());return n=>o=>x$.createMiddleware(eTe,r=>{if(e.getState().session.features.enabledFeatures.includes("aev")&&I0(r),!t)return zoe()(r)})(e)(n)(o)},sTe=D("wa.log.err"),nTe=D("beacon");class oTe{#e=null;constructor(){this.eventPromises=[],this.resolveEventPromises=this.resolveEventPromises.bind(this),this.sendEventPromise=this.sendEventPromise.bind(this),this.sendEvent=this.sendEvent.bind(this),this.sendEventBeacon=this.sendEventBeacon.bind(this),this.dispatchEvents=this.dispatchEvents.bind(this),this.handleFailedEvent=this.handleSentEvent.bind(this),this.handleBeaconApiEventEnabled=this.handleBeaconApiEventEnabled.bind(this),document.readyState!=="complete"&&window.addEventListener("load",this.resolveEventPromises)}set getState(t){this.#e=t}get state(){return this.#e?this.#e():null}isBasketQuantityUpdateEventV5=t=>!!t?.basketQuantityUpdateEventV5;getBasketQuantityUpdateEventV5EmptyFields=t=>{const n=["retailerProductId","updateQuantity"];return this.isBasketQuantityUpdateEventV5(t)?n.filter(o=>!t?.basketQuantityUpdateEventV5?.[o]):[]};handleBeaconApiEventEnabled(){const{state:t}=this;return!!t&&nTe(t)}handleSentEvent({responseHeaders:t,body:n,responseCode:o,responseData:r,errorData:a,locationPrev:i}){const{state:l}=this;if(!sTe(l))return;const c=this.getBasketQuantityUpdateEventV5EmptyFields(n);c?.length&&Me.api.pushError(new Error(`WebAnalytics: basketQuantityUpdateEventV5 empty fields (${c.join(",")})`),{context:{requestBody:JSON.stringify(n),...o&&{responseCode:o},...r&&{responseData:r},...t&&{responseHeaders:t},...a&&{errorData:a},locationPrev:i,locationNext:window.location.href}})}sendEventPromise({targetUrl:t,body:n}){const o=window.location.href;return fetch(`${t}/v1/event`,{body:JSON.stringify(n),headers:{"Content-Type":"application/json",Accept:"text/plain, */*; q=0.01"},method:"POST"}).then(async r=>{this.handleSentEvent({body:n,responseCode:r?.status,responseData:await r?.text(),responseHeaders:JSON.stringify([...r?.headers.entries()]),locationPrev:o})}).catch(r=>{this.handleSentEvent({body:n,errorData:JSON.stringify(r,Object.getOwnPropertyNames(r)),locationPrev:o})})}sendEventBeacon({targetUrl:t,body:n}){const o=JSON.stringify(n),r={type:"application/json"},a=new Blob([o],r);return navigator.sendBeacon(`${t}/v1/event`,a)?Promise.resolve():this.sendEventPromise({targetUrl:t,body:n})}sendEvent(t){return this.handleBeaconApiEventEnabled()&&"sendBeacon"in navigator?this.sendEventBeacon(t):this.sendEventPromise(t)}resolveEventPromises(){this.eventPromises.map((t,n)=>t(n)),this.eventPromises=[]}dispatchEvents(t){return Promise.all(t.map(({body:n,targetUrl:o})=>{if(n){if(document.readyState==="complete")return this.sendEvent({targetUrl:o,body:n});this.eventPromises.push(r=>this.sendEvent({targetUrl:o,body:n}))}return Promise.resolve()}))}}const by="BASKET_UNAVAILABLE_DATA_NOTIFICATION_ID",gh="CART_MULTIPLE_DELIVERIES_SHOWN",Fs={DETAIL:"detail",GRID:"grid",LIST:"list"},pA={[Fs.DETAIL]:"view_details",[Fs.GRID]:"view_grid",[Fs.LIST]:"view_list"},mA={[Fs.DETAIL]:"basket.details.view.button",[Fs.GRID]:"basket.grid.view.button",[Fs.LIST]:"basket.list.view.button"},Sr={SUCCESSFUL:"SUCCESSFUL",WITH_CONFLICTS:"WITH_CONFLICTS",ALL_WITH_CONFLICTS:"ALL_WITH_CONFLICTS",NO_ACTION:"NO_ACTION"},Oj={OUT_OF_STOCK:"OUT_OF_STOCK",LIMITED_AVAILABILITY:"LIMITED_AVAILABILITY",EXCEEDED_MAX_QUANTITY:"EXCEEDED_MAX_QUANTITY",EXCEEDED_BASKET_MAX_QUANTITY:"EXCEEDED_BASKET_MAX_QUANTITY",TIME_RESTRICTION:"TIME_RESTRICTION",UNKNOWN:"UNKNOWN"},Pj={"skip-edit-order-modal":"skipEditOrderModal","skip-payment-buffer-modal":"skipPaymentBufferModal","basket-view":"basketView"},rTe="web_customer_preference_ws",l2="/v1/customer-preferences",c2={service:rTe,pathPrefix:{client:"/api/customer-preferences",server:"/core-api"}},d2=({actionType:e,url:t,options:n,service:o,pathPrefix:r})=>({type:"API",payload:{url:t,...!!n&&{options:n},...ee(e),...!!o&&{service:o},...!!r&&{pathPrefix:r}}}),yR=({actionType:e,preferenceKey:t})=>n=>d2({actionType:e,url:l2,...c2,options:{body:{preferenceKey:t,preferenceValue:n},method:"PUT"}}),IR=({actionType:e,preferenceKey:t})=>()=>d2({actionType:e,url:`${l2}/${t}`,...c2}),aTe=e=>({type:"SET_CUSTOMER_PREFERENCES_SKIP_EDIT_ORDER_MODAL",payload:{skipEditOrderModal:e}}),iTe=e=>({type:"SET_CUSTOMER_PREFERENCES_SKIP_PAYMENT_BUFFER_MODAL",payload:{skipPaymentBufferModal:e}}),lTe=IR({actionType:"GET_CUSTOMER_PREFERENCES_SKIP_EDIT_ORDER_MODAL",preferenceKey:"skip-edit-order-modal"}),cTe=yR({actionType:"UPDATE_CUSTOMER_PREFERENCES_SKIP_EDIT_ORDER_MODAL",preferenceKey:"skip-edit-order-modal"}),dTe=IR({actionType:"GET_CUSTOMER_PREFERENCES_SKIP_PAYMENT_BUFFER_MODAL",preferenceKey:"skip-payment-buffer-modal"}),uTe=yR({actionType:"UPDATE_CUSTOMER_PREFERENCES_SKIP_PAYMENT_BUFFER_MODAL",preferenceKey:"skip-payment-buffer-modal"}),pTe=IR({actionType:"GET_CUSTOMER_PREFERENCES_BASKET_VIEW",preferenceKey:"basket-view"}),mTe=yR({actionType:"UPDATE_CUSTOMER_PREFERENCES_BASKET_VIEW",preferenceKey:"basket-view"}),hTe=e=>({type:"SET_CUSTOMER_PREFERENCES_BASKET_VIEW",payload:{basketView:e}}),Da={getCustomerPreferenceSkipEditOrderModal:lTe,getCustomerPreferenceSkipPaymentBufferModal:dTe,getCustomerPreferenceBasketView:pTe,setCustomerPreferenceSkipEditOrderModal:aTe,setCustomerPreferenceSkipPaymentBufferModal:iTe,setCustomerPreferenceBasketView:hTe,updateCustomerPreferenceSkipEditOrderModal:cTe,updateCustomerPreferenceSkipPaymentBufferModal:uTe,updateCustomerPreferenceBasketView:mTe},gTe={data:{skipEditOrderModal:!1,skipPaymentBufferModal:!1,basketView:null},...Re,error:null},ETe=(e=gTe,t)=>{switch(t.type){case"GET_CUSTOMER_PREFERENCES_SKIP_EDIT_ORDER_MODAL_SUCCESS":case"GET_CUSTOMER_PREFERENCES_SKIP_PAYMENT_BUFFER_MODAL_SUCCESS":{const{preferenceKey:n,preferenceValue:o}=t.payload.responseData,r=Pj[n];return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:{...e.data,...!!r&&{[r]:o==="true"}}}}case"GET_CUSTOMER_PREFERENCES_BASKET_VIEW_SUCCESS":{const{preferenceKey:n,preferenceValue:o}=t.payload.responseData,r=Pj[n];return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:{...e.data,...!!r&&{[r]:o}}}}case"SET_CUSTOMER_PREFERENCES_SKIP_EDIT_ORDER_MODAL":return{...e,data:{...e.data,skipEditOrderModal:t.payload.skipEditOrderModal}};case"SET_CUSTOMER_PREFERENCES_SKIP_PAYMENT_BUFFER_MODAL":return{...e,data:{...e.data,skipPaymentBufferModal:t.payload.skipPaymentBufferModal}};case"SET_CUSTOMER_PREFERENCES_BASKET_VIEW":return{...e,data:{...e.data,basketView:t.payload.basketView}};case"GET_CUSTOMER_PREFERENCES_SKIP_EDIT_ORDER_MODAL_ERROR":case"GET_CUSTOMER_PREFERENCES_SKIP_PAYMENT_BUFFER_MODAL_ERROR":case"GET_CUSTOMER_PREFERENCES_BASKET_VIEW_ERROR":return{...e,isFetching:!1,fetchError:!0,error:t.payload};default:return e}};function fTe(e){return Object.values(Fs).some(t=>t===e)}const yTe=({data:e})=>e.customer.preferences,SR=e=>yTe(e)?.data||{},u2=e=>SR(e).skipEditOrderModal||!1,ITe=e=>SR(e).skipPaymentBufferModal||!1,AS=e=>{const t=qe(e,"basket-view");return SR(e)?.basketView??(fTe(t)?t:Fs.DETAIL)},sc=({orderId:e,queryString:t}={})=>{const n=e?`/${e}`:"",o=t?`?${t}`:"";return`/failed-payment${n}${o}`},p2=e=>`${sc({orderId:e})}/3ds`,CR=e=>`${sc({orderId:e})}/complete`,bS=e=>wo(e,"router.location"),_p=e=>wo(e,"router.location.pathname"),STe=(e="",t=[])=>{const n=[jt(),kr(),sc()],o=[CR(),Zh(),...t],r=n.some(i=>Or({path:i,end:!1},e)),a=o.some(i=>Or({path:i,end:!1},e));return r&&!a},CTe=e=>(tt.parse(e)||{})["in-checkout-walk"]==="true",pg=(e,t=[])=>{const{pathname:n,search:o}=bS(e);return STe(n,t)||CTe(o)},TTe=()=>le()-document.clientLoadTime,mg=e=>{const n=parseInt(kae(e),10)+TTe();return Vb(n)},It={targetUrl:"/events"},St=(e,t,n)=>{const{payload:o}=n??{payload:{}};return{id:o?.pageEventId??vt(),sessionId:o?.sessionId??Kl(e),timestamp:mg(e),pageViewId:o?.pageViewId??On(t),bannerId:ja(t)}},hA=e=>e==null||typeof e=="string"&&e.trim()==="",bt=(e,t,n,o)=>{const r=n?.map(i=>{const c=(i?.fields||[])?.filter(d=>!hA(d?.value))||[];return{...i,...c?.length&&{fields:c}}}),a={pageComponentEvent:{...St(e,t),pageComponents:r,...o&&{pageViewId:o}}};return{...It,body:a}},Rt=(e,t,n)=>({fields:Object.entries(e).flatMap(([r,a])=>Array.isArray(a)?a.map(i=>({name:r,value:i})):{name:r,value:a}),createdAt:mg(t),type:n}),_Te=e=>Object.entries(e).map(([t,n])=>({pageAttributeType:t,pageAttributeValues:Array.isArray(n)?n:[n]})),jr=(e,t,n,o)=>({...It,body:{pageAttributeEvent:{...St(e,t),pageAttributeType:n,pageAttributeValues:Array.isArray(o)?o:[o]}}}),wr=(e,t,n)=>{const{attributes:o}=e.payload;return{...It,body:{pageAttributesEvent:{...St(t,n),pageAttributes:_Te(o)}}}},vTe=(e,t,n)=>jr(t,n,"ENABLED_FEATURES",zh(t)),gA=(e,t,n)=>{const{pathname:o}=e.payload.location;if(I2.includes(o))return{};const{basketId:r,checkoutCorrelationId:a,activeCheckoutGroupId:i}=Zt(n);if(!Ze(n)||!a)return{};const l=pa(n);if(!l)return{};const{currency:c,amount:d}=l;return wr({payload:{attributes:{CHECKOUT_CORRELATION_ID:a,...i?{ACTIVE_CHECKOUT_GROUP_ID:i}:{},BASKET_ID:r,ORDER_VALUE_AMOUNT:d,ORDER_VALUE_CURRENCY:c}}},t,n)},ATe="PLACE_ORDER",bTe="PLACE_ORDER_3DS_COMPLETE",xTe="PLACE_ORDER_POST_EXTERNAL_REDIRECT_3DS_COMPLETE",RTe="CHECKOUT_COMPLETE_PAGE_RENDERED",m2="CONFIRM_SLOT_MODAL_RENDERED",DTe="DELIVERY_TYPE_SELECT",OTe="MAP_RENDERED",xS="NAVIGATE_TO_BOOK_SLOT_FLOW",PTe="OUT_OF_STOCK_MODAL_RENDERED",$7t="OUT_OF_STOCK_PAGE_RENDERED",NTe="SELECT_SLOT_ERROR_MODAL_RENDERED",LTe="SEARCH_PRODUCTS_VISIBLE",h2="SLOTS_RENDERED",g2="SLOT_SELECTED",kTe="SLOTS_ADDRESS_UPDATED",MTe="CATEGORY_PRODUCTS_VISIBLE",jTe="SHOP_IN_SHOP_CATEGORY_PRODUCTS_VISIBLE",H7t="HOMEPAGE_PRODUCTS_VISIBLE",wTe="FAVORITES_PRODUCTS_VISIBLE",FTe="PERFORMANCE_ROUTE_CHANGE",BTe="NAVIGATE_TO_TROLLEY",UTe="TROLLEY_RENDERED",GTe="TROLLEY_CHECKOUT",$Te="SUMMARY_RENDERED",V7t="BOP_MOUNT",Y7t="OFFER_PRODUCTS_VISIBLE",HTe="SMART_CHECKOUT_WALK_CONTINUE",VTe="SMART_CHECKOUT_WALK_PRODUCTS_RENDERED",YTe="SMART_CHECKOUT_WALK_SUMMARY_REDIRECT",WTe="PROMOTIONS_PRODUCTS_VISIBLE",Nj="NAV_BUTTON_CLICKED",qTe="NAV_DISPLAYED",W7t="LIST_PRODUCTS_VISIBLE",q7t="SHOPPING_LISTS_VISIBLE",KTe="PERFORMANCE",TR={PERFORMANCE:KTe},E2=[{name:"homepage",startEvents:["PAGE_HOMEPAGE"],endEvents:["HOMEPAGE_PRODUCTS_VISIBLE"]},{name:"slot_booking_confirmation",startEvents:["SLOT_SELECTED"],endEvents:["CONFIRM_SLOT_MODAL_RENDERED"]},{name:"slot_booking_home_delivery",startEvents:["PAGE_HOME_DELIVERY_SLOTBOOKING"],endEvents:["SLOTS_RENDERED"]},{name:"slot_booking_customer_collection",startEvents:["PAGE_COLLECT_SLOTBOOKING"],endEvents:["SLOTS_RENDERED"]},{name:"slot_booking_change_address",startEvents:["SLOTS_ADDRESS_UPDATED"],endEvents:["SLOTS_RENDERED"]},{name:"search",startEvents:["PAGE_SEARCH"],endEvents:["SEARCH_CONTENT_VISIBLE","SEARCH_PRODUCTS_VISIBLE"]},{name:"browse",startEvents:["PAGE_SHOP_PRODUCTS","PAGE_ALL_SHOP_PRODUCTS"],endEvents:["CATEGORY_CONTENT_VISIBLE","CATEGORY_PRODUCTS_VISIBLE","SHOP_IN_SHOP_CATEGORY_PRODUCTS_VISIBLE"]},{name:"favorites",startEvents:["PAGE_FAVORITES"],endEvents:["FAVORITES_CONTENT_VISIBLE","FAVORITES_PRODUCTS_VISIBLE"]},{name:"checkout",startEvents:["PLACE_ORDER"],endEvents:["CHECKOUT_COMPLETE_PAGE_RENDERED"]},{name:"product_details",startEvents:["PAGE_BOP"],endEvents:["BOP_MOUNT"]},{name:"promotion_details",startEvents:["PAGE_OFFERS"],endEvents:["OFFER_PRODUCTS_VISIBLE"]},{name:"shopping_lists",startEvents:["PAGE_LISTS"],endEvents:["SHOPPING_LISTS_VISIBLE"]},{name:"shopping_list_products",startEvents:["PAGE_LIST_DETAILS"],endEvents:["LIST_PRODUCTS_VISIBLE"]},{name:"promotions",startEvents:["PAGE_PROMOTIONS","PAGE_ALL_PROMOTIONS"],endEvents:["PROMOTIONS_PRODUCTS_VISIBLE"]}],zTe=E2.flatMap(e=>[...e.startEvents,...e.endEvents]),QTe=10,lu=[],f2=e=>{const t=E2.filter(n=>n.endEvents.some(o=>o===e.name));if(!t.length){lu.push(e),lu.length>QTe&&lu.shift();return}for(let n=lu.length-1;n>=0;n--){const o=lu[n],r=t.find(a=>a.startEvents.some(i=>i===o.name));if(r){const a=e.timestamp-o.timestamp,i={is_full_page_load:`${e.isFullPageLoad}`,is_user_logged_in:`${e.isUserLoggedIn}`,reporting_level:`${e.reportingLevel}`};e.variant&&(i.variant=e.variant),XTe(r.name,a,i),lu.splice(n,1);return}}},XTe=(e,t,n)=>{Me.api.pushMeasurement({type:"client-performance",values:{[e]:t}},{context:{...n,measurement_name:e}})},ZTe=e=>zTe.includes(e),JTe=e=>e?Object.entries(e).flatMap(([t,n])=>hA(n)?[]:Array.isArray(n)?n.filter(o=>!hA(o)).map(o=>({type:t,value:o})):{type:t,value:n}):[],q=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n,e),pageEventType:e.type,pageEventDescription:e.payload.description,pageEventAttributes:JTe(e.payload.pageEventAttributes)}}}),e_e=(e,t,n)=>{if(typeof window>"u"||!window.performance)return!1;const o=Td(n,e.payload.location),r=window.performance.now(),a=D("faro")(n),i=sS(n),l=rr(n)!==void 0,c=y0(n),d={type:TR.PERFORMANCE,payload:{description:"Performance mark for the changing of a route",pageEventAttributes:{name:FTe,pageName:o,timestamp:r,isFullPageLoad:i}}};return a&&f2({name:`PAGE_${o}`,timestamp:i?0:r,isFullPageLoad:i,isUserLoggedIn:l,reportingLevel:c}),q(d,t,n)},y2=e=>{const t=_p(e);return t?document.location.origin+t:document.referrer},I2=[kr(),Zb()],xy=(e,t,n)=>{const{pagePartType:o,location:r}=e.payload,{pathname:a}=r;if(I2.includes(a))return{};const i=pa(n)?.amount,l=o||Td(n,r),c=ec(n);let d=_1(e);const u=fce(e),m=sS(n);return l==="SEARCH"&&m&&(d="REFRESHED"),{...It,body:{pageViewEvent:{id:On(n),timestamp:mg(t),regionId:hn(n),bannerId:ja(n),location:a,pageType:l,referer:y2(t),sessionId:Kl(t),retailerCustomerId:ua(t),customerFirstname:c.data["attr.firstName"],customerLastname:c.data["attr.surname"],customerEmail:c.data.email,source:d,sourceEventId:u,transactionId:At(n),statistics:{...a===jt()&&{displayType:AS(n)},isFullPageLoad:m,routeChangeCount:E0(n)},...i&&{basketTotalAmount:i}}}}},RS=(e={payload:{}},t,n,o,r)=>{const{payload:a}=e||{},{source:i,sourceEventId:l}=a||{};return{...It,body:{pageViewEvent:{id:On(n),timestamp:mg(t),regionId:hn(n),bannerId:ja(n),location:o,pageType:r,referrer:y2(t),sessionId:Kl(t),transactionId:At(n),...i&&{source:i},...l&&{sourceEventId:l}}}}},Ry="customerAddressId",so={UK_POSTCODE:"UK_POSTCODE",UK_POSTCODE_MAP_BACKUP:"UK_POSTCODE_MAP_BACKUP",INTERNATIONAL:"INTERNATIONAL",MANUAL_FORM:"MANUAL_FORM",MANUAL_FORM_POSTCODE:"MANUAL_FORM_POSTCODE",MANUAL_FORM_MAP:"MANUAL_FORM_MAP",KOREAN_ROAD_NAME:"KOREAN_ROAD_NAME",MAP_LOOKUP:"MAP_LOOKUP"},lr="addAddress",hg="addAddressDDS",S2="/addresses",_R=`${S2}/add-address`,t_e=`${S2}/confirm-address`,s_e=`${t_e}/:${Ry}`,Ba=e=>{const t={};return Object.keys(e).forEach(n=>{e[n]!==void 0&&(t[n]=e[n])}),t},n_e=(e,t,n)=>({...It,body:{addressUndeliverableEvent:{...St(t,n),address:e.payload.addressDescription}}}),o_e=(e,t,n)=>({...It,body:{abandonedAddressSearchEvent:{...St(t,n),searchText:e.payload.lastSearchString,failedSearches:e.payload.failedSearches}}}),r_e=(e,t,n)=>({...RS(e,t,n,_R,"ADDRESS_ERROR")}),a_e=(e,t,n)=>({...RS(e,t,n,_R,"ADDRESS_POSTCODE")}),i_e=(e,t,n)=>{const o={type:e.type,payload:{description:'User clicked the "Add new address" button'}};return q(o,t,n)},l_e=(e,t,n)=>{const o={type:e.type,payload:{description:"User clicked the form add address button",pageEventAttributes:{...e.payload}}};return e.payload.missingMandatoryFieldName!==void 0&&(o.payload.pageEventAttributes.missingMandatoryFieldName=`[${e.payload.missingMandatoryFieldName.toString()}]`),q(o,t,n)},c_e=(e,t,n)=>{const o={type:e.type,payload:{description:'User clicked the "edit" button'}};return e.payload.addressId&&(o.payload={...o.payload,pageEventAttributes:{addressId:e.payload.addressId}}),q(o,t,n)},d_e=(e,t,n)=>q({type:e.type,payload:{description:'User clicked the "remove" button',pageEventAttributes:{...e.payload}}},t,n),u_e=(e,t,n)=>q({type:e.type,payload:{description:'User clicked the "cancel" button',pageEventAttributes:{status:e.payload.status}}},t,n),p_e=(e,t,n)=>{const{missingMandatoryField:o,isDeliveryInstructionsFilled:r,additionalDetailsFilled:a,addressNameFilled:i,invalidCharacters:l,invalidFields:c}=e.payload;return q({type:e.type,payload:{description:"User clicked the save address button",pageEventAttributes:{missingMandatoryField:o,isDeliveryInstructionsFilled:r,addressNameFilled:i,...c!==void 0&&{invalidFields:c},...a!==void 0&&{additionalDetailsFilled:a},...l!==void 0&&{invalidCharacters:l}}}},t,n)},m_e=(e,t,n)=>q({type:e.type,payload:{description:"User clicked the find address button, again"}},t,n),h_e=(e,t,n)=>q({type:e.type,payload:{description:"User clicked the find address button",pageEventAttributes:{...e.payload}}},t,n),g_e=(e,t,n)=>q({type:e.type,payload:{description:"Open dropdown list"}},t,n),E_e=(e,t,n)=>q({type:e.type,payload:{description:"Choose an address from the list",pageEventAttributes:{...e.payload}}},t,n),f_e=(e,t,n)=>{const o=e.payload.addressesImpression.map((r,a)=>P_e({addressId:r.id,position:a},t,xe.ADDRESS_IMPRESSION));return bt(t,n,o)},y_e=(e,t,n)=>q({type:xe.USER_DETAILS_FORM_MODAL_DISPLAYED,payload:{description:"The modal where to add details such as phone, age confirmation or SMS subscription was shown"}},t,n),I_e=(e,t,n)=>q({type:xe.USER_DETAILS_FORM_MODAL_CLOSED,payload:{description:"The modal where to add details such as phone, age confirmation or SMS subscription was closed",pageEventAttributes:{...e.payload}}},t,n),S_e=(e,t,n)=>q({type:xe.SAVE_DETAILS_BUTTON_CLICKED,payload:{description:"The user clicked on 'Done' when the phone and age confirmation was requested",pageEventAttributes:{...e.payload}}},t,n),C_e=(e,t,n)=>q({type:xe.ADD_ADDRESS_MODAL_DISPLAYED,payload:{description:"A modal was shown with fields to add an address",pageEventAttributes:{...e.payload}}},t,n),T_e=(e,t,n)=>q({type:xe.ADD_ADDRESS_MODAL_CLOSED,payload:{description:"The customer closed the modal by clicking to add an address or a closing button",pageEventAttributes:{...Ba(e.payload)}}},t,n),__e=(e,t,n)=>q({type:xe.SELECT_ADDRESS_MODAL_DISPLAYED,payload:{description:"The modal to select the introduced address or the ones found by the feature was shown",pageEventAttributes:{...Ba(e.payload)}}},t,n),v_e=(e,t,n)=>q({type:xe.SELECT_ADDRESS_MODAL_CLOSED,payload:{description:"The customer closed the modal to select the introduced address or the ones found by the feature",pageEventAttributes:{...Ba(e.payload)}}},t,n),A_e=(e,t,n)=>q({type:xe.CONFIRM_ADDRESS_MODAL_DISPLAYED,payload:{description:"The modal to confirm the introduced address was shown",pageEventAttributes:{...Ba(e.payload)}}},t,n),b_e=(e,t,n)=>q({type:xe.CONFIRM_ADDRESS_MODAL_CLOSED,payload:{description:"The customer closed the modal to confirm the introduced address",pageEventAttributes:{...Ba(e.payload)}}},t,n),x_e=(e,t,n)=>q({type:xe.ZOOM_BUTTON_CLICKED,payload:{description:"The customer zoomed the map in/out",pageEventAttributes:{...Ba(e.payload)}}},t,n),R_e=(e,t,n)=>q({type:xe.LOCATE_ME_BUTTON_CLICKED,payload:{description:"The customer zoomed the map in/out"}},t,n),D_e=(e,t,n)=>q({type:xe.SAVE_ADDRESS_MODAL_DISPLAYED,payload:{description:"The modal to save the address was shown",pageEventAttributes:{...Ba(e.payload)}}},t,n),O_e=(e,t,n)=>q({type:xe.SAVE_ADDRESS_MODAL_CLOSED,payload:{description:"The customer closed the modal to save the address",pageEventAttributes:{...Ba(e.payload)}}},t,n),P_e=({addressId:e,position:t},n,o)=>({fields:[{name:"addressId",value:e},{name:"position",value:t}],createdAt:mg(n),type:o}),N_e=(e,t,n)=>q({type:e.type,payload:{description:"A modal was shown to look up for an address via postcode"}},t,n),L_e=(e,t,n)=>q({type:e.type,payload:{description:"The customer closed the modal to look up for an address via postcode",pageEventAttributes:{...Ba(e.payload)}}},t,n),k_e=(e,t,n)=>q({type:e.type,payload:{description:"The user has ended typing or the timer has triggered an error",pageEventAttributes:{...Ba(e.payload)}}},t,n),M_e=(e,t,n)=>q({type:e.type,payload:{description:"The user clicked on the Continue button"}},t,n),j_e=(e,t,n)=>q({type:e.type,payload:{description:"The user clicked on the Enter address manually button"}},t,n),w_e=(e,t,n)=>q({type:e.type,payload:{description:"The customer closed the modal when the selected suggestion was shown"}},t,n),F_e=(e,t,n)=>q({type:e.type,payload:{description:"The user clicked on Continue in the Address Search suggestions",pageEventAttributes:{...Ba(e.payload)}}},t,n),B_e={[xe.ADDRESS_LOOKUP_ABANDONED]:o_e,[xe.ADDRESS_LOOKUP_UNDELIVERABLE]:n_e,[xe.ADDRESS_ERROR]:r_e,[xe.ADDRESS_POSTCODE]:a_e,[xe.ADD_ADDRESS_BUTTON_CLICKED]:i_e,[xe.FORM_ADD_ADDRESS_BUTTON_CLICKED]:l_e,[xe.EDIT_ADDRESS_BUTTON_CLICKED]:c_e,[xe.REMOVE_ADDRESS_BUTTON_CLICKED]:d_e,[xe.CANCEL_BUTTON_CLICKED]:u_e,[xe.SAVE_ADDRESS_BUTTON_CLICKED]:p_e,[xe.ADDRESS_IMPRESSION]:f_e,[xe.FIND_ADDRESS_BUTTON_CLICKED]:h_e,[xe.FIND_ADDRESS_AGAIN_BUTTON_CLICKED]:m_e,[xe.USER_DETAILS_FORM_MODAL_DISPLAYED]:y_e,[xe.USER_DETAILS_FORM_MODAL_CLOSED]:I_e,[xe.SAVE_DETAILS_BUTTON_CLICKED]:S_e,[xe.ADDRESS_DROPDOWN_OPENED]:g_e,[xe.DROPDOWN_ADDRESS_SELECTED]:E_e,[xe.ADD_ADDRESS_MODAL_DISPLAYED]:C_e,[xe.ADD_ADDRESS_MODAL_CLOSED]:T_e,[xe.SELECT_ADDRESS_MODAL_DISPLAYED]:__e,[xe.SELECT_ADDRESS_MODAL_CLOSED]:v_e,[xe.CONFIRM_ADDRESS_MODAL_DISPLAYED]:A_e,[xe.CONFIRM_ADDRESS_MODAL_CLOSED]:b_e,[xe.ZOOM_BUTTON_CLICKED]:x_e,[xe.LOCATE_ME_BUTTON_CLICKED]:R_e,[xe.SAVE_ADDRESS_MODAL_DISPLAYED]:D_e,[xe.SAVE_ADDRESS_MODAL_CLOSED]:O_e,[xe.SEARCH_ADDRESS_POSTCODE_MODAL_DISPLAYED]:N_e,[xe.SEARCH_ADDRESS_POSTCODE_MODAL_CLOSED]:L_e,[xe.SEARCH_ADDRESS_POSTCODE_END_TYPING]:k_e,[xe.CONTINUE_ADDRESS_ADD_BUTTON_CLICKED]:M_e,[xe.ENTER_ADDRESS_MANUALLY_BUTTON_CLICKED]:j_e,[xe.SEARCH_ADDRESS_MODAL_CLOSED]:w_e,[xe.SEARCH_ADDRESS_CONTINUE_CLICKED]:F_e},C2={MEDIUM_RECTANGLE:"MEDIUM_RECTANGLE",PRODUCT_CARD:"PRODUCT_CARD",HORIZONTAL:"HORIZONTAL",DOUBLE_TILE:"TILE",SHOPPABLE:"SHOPPABLE_BANNER"},T2={basket:"CART","logged-in-homepage":"LIHP","logged-out-homepage":"LOHP","product-details":"PRODUCT_DETAILS",categories:"CATEGORY",search:"SEARCH",favorites:"FAVORITES",promotions:"PROMOTIONS","promotion-details":"PROMOTION_DETAILS",regulars:"REGULARS","slot-booking":"SLOT_BOOKING","edit-order":"EDIT_ORDER","order-confirmation":"ORDER_CONFIRMATION"},_2={STATIC_ADVERT:{click:{type:"IMAGE_CLICKED",description:"User clicked an ad banner image displayed on the page"},impression:{eventType:"IMAGE_IMPRESSION"}},RESPONSIVE_ADVERT:{click:{type:"RESPONSIVE_BANNER_CLICKED",description:"User clicked a responsive banner displayed on the page"},impression:{eventType:"RESPONSIVE_BANNER_IMPRESSION"}}},v2=e=>e.map(({segmentId:t})=>t),Lj=e=>(t,n,o)=>{const{id:r,name:a,location:i,placement:l,contentSource:c,targetUrl:d,linkType:u,segments:m,sequence:g,format:f,size:y}=t.payload,I=_2[e].click;return q({type:I.type,payload:{description:I.description,pageEventAttributes:{entryId:r,entryName:a,location:T2[i],placement:l,contentSource:c||"UNKNOWN",targetUrl:d,linkType:u,...m?.length&&{segmentId:v2(m)},...g!==void 0&&{sequence:g.toString()},...f&&{FORMAT:C2[f]},...y&&{SIZE:y.toString()}}}},n,o)},kj=e=>(t,n,o)=>{const{id:r,name:a,location:i,placement:l,contentSource:c,targetUrl:d,linkType:u,segments:m,sequence:g,format:f,size:y}=t.payload,I=_2[e].impression,S=[Rt({ENTRY_ID:r,ENTRY_NAME:a,LOCATION:T2[i],PLACEMENT:l,CONTENT_SOURCE:c||"UNKNOWN",...d&&{TARGET_URL:d},...u&&{LINK_TYPE:u},...m?.length&&{SEGMENT_ID:v2(m)},...g!==void 0&&{SEQUENCE:g.toString()},...f&&{FORMAT:C2[f]},...y&&{SIZE:y.toString()}},n,I.eventType)];return bt(n,o,S,void 0)},U_e={ADVERTISING_BANNER_CLICKED:Lj("STATIC_ADVERT"),ADVERTISING_BANNER_IMPRESSION:kj("STATIC_ADVERT"),RESPONSIVE_ADVERTISING_BANNER_CLICKED:Lj("RESPONSIVE_ADVERT"),RESPONSIVE_ADVERTISING_BANNER_IMPRESSION:kj("RESPONSIVE_ADVERT")},A2=e=>e.map(({segmentId:t})=>t),G_e=(e,t,n)=>{const{id:o,advertId:r,name:a,location:i,contentSource:l,placement:c,targetUrl:d,linkType:u,segments:m}=e.payload;return q({type:"IMAGE_CLICKED",payload:{description:"User clicked a popup banner image displayed on the page",pageEventAttributes:{entryId:o,entryName:a,location:i,placement:c,contentSource:l,targetUrl:d,linkType:u,...r&&{advertId:r},...m?.length&&{segmentId:A2(m)}}}},t,n)},$_e=(e,t,n)=>{const{id:o,advertId:r,name:a,location:i,contentSource:l,placement:c,targetUrl:d,linkType:u,segments:m}=e.payload;return bt(t,n,[Rt({ENTRY_ID:o,ENTRY_NAME:a,LOCATION:i,PLACEMENT:c,CONTENT_SOURCE:l,TARGET_URL:d,LINK_TYPE:u,...r&&{ADVERT_ID:r},...m?.length&&{SEGMENT_ID:A2(m)}},t,"IMAGE_IMPRESSION")])},H_e=(e,t,n)=>{const{id:o,advertId:r,name:a}=e.payload;return q({type:"POPUP_CLOSE_BUTTON_CLICKED",payload:{description:"User clicked on a close button on a Pop-Up ad banner",pageEventAttributes:{entryId:o,entryName:a,buttonType:"crossButton",...r&&{advertId:r}}}},t,n)},V_e={POPUP_BANNER_CLICKED:G_e,POPUP_BANNER_IMPRESSION:$_e,POPUP_BANNER_CLOSE:H_e},Y_e=(e,t,n)=>q({type:e.type,payload:{description:"User clicked button on the login and register modal",pageEventAttributes:{...e.payload}}},t,n),W_e=(e,t,n)=>q({type:e.type,payload:{description:"A login and register modal was displayed",pageEventAttributes:{...e.payload}}},t,n),q_e=(e,t,n)=>({...It,body:{loginClickedEvent:{...St(t,n),source:e.payload.source}}}),K_e=(e,t,n)=>({...It,body:{registerClickedEvent:{...St(t,n),source:e.payload.source}}}),z_e={[on.LOGIN_REGISTER_MODAL_CLICKED]:Y_e,[on.LOGIN_REGISTER_MODAL_DISPLAYED]:W_e,[on.LOGIN_CLICKED]:q_e,[on.REGISTER_CLICKED]:K_e},Q_e=(e,t)=>{if(!e?.items?.length)return 0;const n=e.items.find(o=>o?.productId===t);return n?.quantity?.quantityInBasket?n.quantity.quantityInBasket:0},DS=({basketId:e,basketTotalValue:t,updateQuantity:n,totalQuantity:o,prevState:r,nextState:a,product:i,addedByFunction:l,addedFromSection:c})=>{const d=i?.productId,u=Ts(a)?.[d],m=i?.retailerProductId??u?.retailerProductId,g=dj(i)??dj(u),f=uj(i)??uj(u),y=i?.cmsProductAttributes??u?.cmsProductAttributes??[],I=(i?.offers??u?.offers)?.map(({id:C})=>C)??[];return{body:{basketQuantityUpdateEventV5:{...St(r,a),totalQuantity:o,basketTotalAmount:t?.amount,basketTotalCurrency:t?.currency,updateQuantity:n,addedByFunction:l,addedFromSection:c,retailerProductId:m,productId:d,priceAmount:g,priceCurrency:f,...I?.length&&{availablePromotionIds:I},...y?.length&&{cmsProductAttributes:y},...e&&{basketId:e}}}}},Mj=(e,t,n)=>{const[o]=e.payload.product.map(r=>{const a=Nx(r),i=e.type===Te.ADD_BASKET_ITEM?a:-a,l=Q_e(e.payload.basket,r?.productId);return DS({basketId:e.payload.basket.basketId,basketTotalValue:e.payload.basket?.totals?.display?.itemPriceAfterPromos??e.payload.basket?.total,updateQuantity:i,totalQuantity:l,prevState:t,nextState:n,product:r,addedByFunction:e.payload.addedByFunction,addedFromSection:e.payload.section})}).slice(-1);return{...It,...o}},X_e=(e,t,n)=>q({type:e.type,payload:{description:"User clicked checkout order button",pageEventAttributes:{orderId:e.payload.orderId,minSpendReached:e.payload.minSpendReached}}},t,n),Z_e=(e,t,n)=>q({type:e.type,payload:{description:"User has seen the checkout order button",pageEventAttributes:{minSpendReached:e.payload.minSpendReached}}},t,n),J_e=(e,t,n)=>q({type:e.type,payload:{description:"User clicked book a slot button",pageEventAttributes:{orderId:e.payload.orderId}}},t,n),eve=(e,t,n)=>q({type:e.type,payload:{description:"User has seen book a slot button"}},t,n),tve=e=>{const t=e?.payload?.prevState,n=e?.payload?.nextState,o=n?.data?.basket;return t.data.basket.items?.map(a=>{const i=-1*a.quantity.quantityInBasket,c=DS({basketId:o?.basketId,basketTotalValue:o?.totals?.display?.itemPriceAfterPromos,updateQuantity:i,totalQuantity:0,prevState:t,nextState:n,product:t.data.products.productEntities[a.productId]});return{...It,...c}})},sve=(e,t,n)=>{const o=e.payload.emptyTrolleyCardImpressions.map(r=>Rt(r,t,"CARD_IMPRESSION"));return bt(t,n,o)},nve=(e,t,n)=>{const o=e.payload.unavailableProducts.map(r=>Rt(r,t,"PRODUCT_UNAVAILABLE"));return bt(t,n,o)},ove=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n),pageEventType:e.type,pageEventDescription:"User clicked on the trolley instant shop card"}}}),rve=(e,t,n)=>q({type:e.type,payload:{description:"Voucher successfully added to order",pageEventAttributes:{voucherId:e.payload.voucherId,voucherDescription:e.payload.voucherDescription,tickboxName:e.payload.tickboxName,tickboxSelected:e.payload.tickboxSelected}}},t,n),ave=(e,t,n)=>q({type:e.type,payload:{description:"Voucher unsuccessfully added to order",pageEventAttributes:{voucherId:e.payload.voucherId,failureMessage:e.payload.failureMessage}}},t,n),ive=(e,t,n)=>q({type:e.type,payload:{description:"User removed voucher",pageEventAttributes:{voucherId:e.payload.voucherId,voucherDescription:e.payload.voucherDescription}}},t,n),lve=(e,t,n)=>q({type:e.type,payload:{description:"User clicked empty button"}},t,n),cve=(e,t,n)=>q({type:e.type,payload:{description:"Minimum basket value not reached notification displayed.",pageEventAttributes:{minimumBasketValueAmount:e.payload.minimumBasketValueAmount,basketValueAmount:e.payload.basketValueAmount,basketValueCurrency:e.payload.basketValueCurrency}}},t,n),dve=(e,t,n)=>q({type:e.type,payload:{description:"Minimum basket value changed notification displayed.",pageEventAttributes:{minimumBasketValueAmount:e.payload.minimumBasketValueAmount,basketValueAmount:e.payload.basketValueAmount,basketValueCurrency:e.payload.basketValueCurrency}}},t,n),uve=(e,t,n)=>{const o=n.data.basket?.totals?.display?.itemPriceAfterPromos;return{...It,body:{basketQuantityUpdateEventV5:{...St(t,n),...e.payload,basketTotalAmount:o?.amount,basketTotalCurrency:o?.currency,bannerId:ja(n)}}}},pve=(e,t,n)=>q({type:e.type,payload:{description:"Some items could add to basket",pageEventAttributes:{orderId:e?.payload?.orderId,productId:e?.payload?.productId?.join(",")}}},t,n),mve=(e,t,n)=>{const o=[Rt(e.payload.pageComponents,t,Te.SOME_ITEMS_UNABLE_TO_ADD_IMPRESSION)];return bt(t,n,o,e.payload.pageViewId)},hve=(e,t,n)=>q({type:e.type,payload:{description:'User confirmed "Add products to order" but the basket was empty',pageEventAttributes:{orderId:e?.payload?.checkoutCorrelationId}}},t,n),gve=(e,t,n)=>{const{orderId:o}=e.payload;return q({type:Te.ADD_PRODUCT_TO_ORDER_MODAL_DISPLAYED,payload:{description:"After click edit order button show a modal",pageEventAttributes:{orderId:o}}},t,n)},Eve=(e,t,n)=>{const{orderId:o}=e.payload;return q({type:Te.NOT_NOW_BUTTON_CLICKED,payload:{description:"User clicks not now button on add product to order modal",pageEventAttributes:{orderId:o}}},t,n)},fve=(e,t,n)=>{const{checkoutCorrelationId:o}=e.payload;return q({type:Te.CLOSE_BUTTON_CLICKED,payload:{description:"User clicks close (X) button on add product to order modal",pageEventAttributes:{orderId:o}}},t,n)},yve=(e,t,n)=>{const o={type:Te.SMALL_ORDER_CHARGE_MODAL_DISPLAYED,payload:{description:"Small Order Charge modal displayed",pageEventAttributes:{orderId:e.payload.orderId}}};return q(o,t,n)},Ive=(e,t,n)=>{const o={type:Te.SMALL_ORDER_CHARGE_MODAL_LEARN_MORE_BUTTON_CLICKED,payload:{description:"User clicked learn more button in Small Order Charge modal",pageEventAttributes:{orderId:e.payload.orderId}}};return q(o,t,n)},Sve=(e,t,n)=>{const o={type:Te.CLOSE_BUTTON_CLICKED,payload:{description:"User clicked close button in Small Order Charge modal",pageEventAttributes:{orderId:e.payload.orderId}}};return q(o,t,n)},Cve=(e,t,n)=>{const o={type:Te.SMALL_ORDER_CHARGE_SLOT_BOOKED_LEARN_MORE_BUTTON_CLICKED,payload:{description:"User clicked Small Order Charge Learn More button in Slot Booked modal",pageEventAttributes:{orderId:e.payload.orderId}}};return q(o,t,n)},Tve=(e,t,n)=>{const o={type:Te.SMALL_ORDER_CHARGE_COMPONENT_CLICKED,payload:{description:"User clicked the small order charge information icon or Learn More Link",pageEventAttributes:{orderId:e.payload.orderId,chargeInfo:e.payload.chargeInfo,pageType:e.payload.pageType}}};return q(o,t,n)},_ve={[Te.ADD_BASKET_ITEM]:Mj,[Te.CHECKOUT_ORDER_BUTTON_CLICKED]:X_e,[Te.CHECKOUT_ORDER_BUTTON_VIEWED]:Z_e,[Te.BOOK_SLOT_BUTTON_CLICKED]:J_e,[Te.BOOK_SLOT_BUTTON_VIEWED]:eve,[Te.EMPTY_CART]:tve,[Te.EMPTY_TROLLEY_CARD_IMPRESSION]:sve,[Te.UNAVAILABLE_PRODUCTS]:nve,[Te.REDEEM_PAYMENT_CHECK_BUTTON_CLICKED]:q,[Te.REDIRECT_TO_SLOT_BOOKING]:q,[Te.REMOVE_BASKET_ITEM]:Mj,[Te.INSTANT_SHOP_TROLLEY_CARD_CLICKED]:ove,[Te.INSTANT_SHOP_REMOVE_FROM_BASKET_MODAL]:q,[Te.TROLLEY_VIEW_CHANGE_VIEW_TYPE_BUTTON_CLICKED]:q,[Te.UNAVAILABLE_ITEMS_MODAL_DISPLAYED]:q,[Te.VOUCHER_ADD_SUCCESS]:rve,[Te.VOUCHER_ADD_FAILURE]:ave,[Te.VOUCHER_REMOVED]:ive,[Te.EMPTY_BUTTON_CLICKED]:lve,[Te.MINIMUM_BASKET_VALUE_NOT_REACHED_NOTIFICATION_DISPLAYED]:cve,[Te.MINIMUM_BASKET_VALUE_CHANGED_NOTIFICATION_DISPLAYED]:dve,[Te.REMOVE_ALL_OUT_OF_STOCK_ITEMS_FROM_BASKET]:uve,[Te.SOME_ITEMS_UNABLE_TO_ADD_MODAL_DISPLAYED]:pve,[Te.SOME_ITEMS_UNABLE_TO_ADD_IMPRESSION]:mve,[Te.ADD_PRODUCT_TO_ORDER_WITH_NO_ITEMS_REQUESTED]:hve,[Te.ADD_PRODUCT_TO_ORDER_MODAL_DISPLAYED]:gve,[Te.NOT_NOW_BUTTON_CLICKED]:Eve,[Te.CLOSE_BUTTON_CLICKED]:fve,[Te.SMALL_ORDER_CHARGE_MODAL_DISPLAYED]:yve,[Te.SMALL_ORDER_CHARGE_MODAL_CLOSE_BUTTON_CLICKED]:Sve,[Te.SMALL_ORDER_CHARGE_MODAL_LEARN_MORE_BUTTON_CLICKED]:Ive,[Te.SMALL_ORDER_CHARGE_COMPONENT_CLICKED]:Tve,[Te.SMALL_ORDER_CHARGE_SLOT_BOOKED_LEARN_MORE_BUTTON_CLICKED]:Cve},jj=(e=[])=>e.map(({promoId:t,...n})=>({id:t,...n})),vve=({origPrice:e,promoPrice:t,unitPrice:n,promoUnitPrice:o,grossPrice:r,referencePrice:a})=>{const i=o?o.price:void 0;return{...t&&{original:e},...t?{current:t}:{current:e},...n&&{unit:{label:n.unit,...n.pricePerSuffix&&{pricePerSuffix:n.pricePerSuffix},...i&&{original:n.price},...i?{current:i}:{current:n.price}}},...r&&{gross:r},...a&&{reference:{...a.price,type:a.type}}}},Ave=(e,t,n)=>{if(e&&t)return{value:t.typicalQuantity.value,uom:t.typicalQuantity.uom,catchWeight:!0};if(n)return{value:n}},bve=e=>e.reduce((t,n)=>n.type==="LEGAL"?{...t,legal:[...t.legal,n]}:n.type==="CERTIFICATION"?{...t,certification:[...t.certification,n]}:t,{legal:[],certification:[]}),b2=(e,t=[],n,o)=>{const{unitPrice:r,type:a,imageConfig:i,iconAttributes:l,imageIds:c,packSizeDescription:d,...u}=e,{price:m,promoPrice:g,promoUnitPrice:f,grossPrice:y,referencePrice:I,isInShoppingList:S,promotions:C,catchweight:_,icons:A}=e,x=a==="CATCHWEIGHT",R={...u,price:vve({origPrice:m,promoPrice:g,unitPrice:r,promoUnitPrice:f,grossPrice:y,referencePrice:I}),isInProductList:S||!1,...x&&{catchweight:_},icons:bve(A),...o},O=jj(C);return R.offers=t.length>0?jj(t):O,R.offer=O.at(0),R.size=Ave(x,_,d),R.attributes=l.map(N=>({icon:N.file.replace("-icon",""),label:N.label})),R},x2=({product:e,bopData:t,bopPromotions:n,detailedImages:o})=>{const r=b2(e,n);return{result:{bopData:t,detailedImages:o,product:r.productId},entities:{product:{[r.productId]:r}}}},R2=ee("GET_BOP"),D2={SET_ACTIVE_BOP:"SET_ACTIVE_BOP"},xve="web_product_page_ws",Rve=e=>({type:"API",payload:{service:xve,url:`/webproductpagews/v5/products/bop?retailerProductId=${e}`,...R2}}),Dve=e=>({type:D2.SET_ACTIVE_BOP,payload:{productId:e}}),Ja={getBop:Rve,setActiveBop:Dve,types:{GET_BOP:R2,SET_ACTIVE_BOP:D2.SET_ACTIVE_BOP}},Ove=Re,Pve=(e=Ove,t)=>{switch(t.type){case Ja.types.GET_BOP.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Ja.types.GET_BOP.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Ja.types.GET_BOP.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:(()=>{const o=t.payload.responseData;return x2(o).result})(),lastUpdated:le()};case Ja.types.SET_ACTIVE_BOP:return{...e,active:t.payload.productId};default:return e}},K7t=V(e=>e.data.bop.details,Ts,(e,t)=>{if(e.data?.product&&(e.data.product===e.active||e.active===void 0)){const n=t[e.data.product];if(n)return{...e,data:{product:n,bopData:e.data?.bopData}}}return{...e,data:{product:{}}}}),z7t=({data:e})=>e.bop.details.isFetching,Nve=({data:e})=>e.bop.details.fetchError?e.bop.details.error:null,Q7t=V(e=>e.data.bop.details,e=>e.data?.bopData),Lve=({data:e})=>e.bop.details.active,X7t=({data:e})=>e.bop.details.data?.detailedImages,kve=({data:e})=>e.bop.details.data?.bopData?.breadcrumbs?.map(t=>t.categoryId)||[],Mve=e=>{const t=Lve(e);return t?Ts(e)[t]:void 0},Hn=e=>t=>{const n=Mve(t);if(n)return n[e]},O2=Hn("icons"),Z7t=V(O2,e=>e?.certification),J7t=V(O2,e=>e?.legal),eXt=Hn("favorite"),tXt=Hn("image"),sXt=Hn("offers"),nXt=Hn("offer"),oXt=Hn("attributes"),rXt=Hn("price"),aXt=Hn("taxCodesDisplayNames"),iXt=Hn("size"),lXt=Hn("guaranteedProductLife"),cXt=Hn("depositPrice"),dXt=Hn("isInProductList"),uXt=Hn("name"),pXt=Hn("countryOfOrigin"),mXt=({data:e})=>e.bop.details.data?.bopData?.detailedDescription,hXt=({data:e})=>e.bop.details.data?.bopData?.fields?.find(t=>t.title==="brand")?.content,gXt=Hn("retailerProductId"),jve=Hn("productId"),EXt=Hn("isVerifiedPurchase"),fXt=Hn("seller"),wve=(e,t,n)=>{const o=e.payload.promoLinkImpressions.map(a=>Rt(a,t,"PROMO_LINK_IMPRESSION")),{pageViewId:r}=e.payload;return bt(t,n,o,r)},Fve=(e,t,n)=>jr(t,n,"PRODUCT_ID",[jve(n)]),Bve=(e,t,n)=>jr(t,n,"BREADCRUMBS",kve(n)),Uve={[fo.PROMO_LINK_IMPRESSION]:wve,[fo.PRODUCT_IMAGE_CLICKED]:q,[fo.PRODUCT_IMAGE_ZOOMED_IN]:q,[fo.PRODUCT_IMAGE_ZOOMED_OUT]:q,[fo.PRODUCT_IMAGE_CLOSED]:q,[fo.ACCESSIBILITY_IMAGE_ZOOMED_IN]:q,[fo.ACCESSIBILITY_IMAGE_ZOOMED_OUT]:q,[fo.ACCESSIBILITY_SCREEN_NAVIGATION_CLICKED]:q,[fo.ACCESSIBILITY_IMAGE_NAVIGATION_USED]:q,[fo.PRODUCT_ID]:Fve,[fo.BRAND_BUTTON_CLICKED]:q,[fo.BREADCRUMBS]:Bve};function wj(e){return[{type:"productId",value:e.productId},{type:"retailerProductId",value:e.retailerProductId}]}const Gve=(e,t,n)=>({...It,body:{catalogueNoResultsBrowseClickedEvent:{...St(t,n),term:e.payload.term,locale:e.payload.locale}}}),$ve=(e,t,n)=>q({type:e.type,payload:{description:"Applying filter(s) causes a new page view to be displayed to the user with no results.",pageEventAttributes:e.payload.filtersFromQueryString}},t,n),Hve=(e,t,n)=>q({type:e.type,payload:{description:"The user is on a page that should have results, but applying filters produced no results, so the user clicked the button to clear filters.",pageEventAttributes:e.payload.filtersFromQueryString}},t,n),Vve=(e,t,n)=>({...It,body:{openMenuEvent:{...St(t,n),...e.payload}}}),Yve=(e,t,n)=>{const{type:o,payload:{menuId:r}}=e;return q({type:o,payload:{description:"User clicked to open a menu",pageEventAttributes:{MENU_OPENED:r}}},t,n)},Wve=(e,t,n)=>q({type:e.type,payload:{description:"On a page view with results, the user clicked the clear all filters button.",pageEventAttributes:e.payload}},t,n),qve=(e,t,n)=>q({type:e.type,payload:{description:"Monitors when a user clicks the Favorites filter button, showing engagement with the feature to filter search results to favorite products."}},t,n),Kve=(e,t,n)=>{const o=[Rt({},t,e.type)];return bt(t,n,o)},zve=(e,t,n)=>{const o=e.payload.product.at(0),r=t.data.products.productEntities[o?.productId];if(!(!r||!("favorite"in o)))return o.favorite===void 0?{...It,body:{pageEvent:{...St(t,n),pageEventType:"MANUAL_REMOVE_FROM_FAVORITES",pageEventDescription:"User manually removed product from favorites",pageEventAttributes:wj(r)}}}:{...It,body:{pageEvent:{...St(t,n),pageEventType:"MANUAL_ADD_TO_FAVORITES",pageEventDescription:"User manually added product to favorites",pageEventAttributes:wj(r)}}}},Qve=(e,t,n)=>{const{type:o,payload:{pageEventAttributes:r}}=e;return q({type:o,payload:{description:"User clicked button to clear selected filters from the menu drop down",pageEventAttributes:r}},t,n)},Xve=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the back to top button."}},t,n),Zve={[gt.CATALOGUE_ATTRIBUTES]:wr,[gt.CATALOGUE_NO_RESULTS_BROWSE_CLICKED]:Gve,[gt.NO_FILTERED_RESULTS_RETURNED_CLEAR_FILTERS_BUTTON_CLICKED]:Hve,[gt.NO_FILTERED_RESULTS_RETURNED]:$ve,[gt.OPEN_MENU]:Vve,[gt.CLEAR_ALL_FILTERS_BUTTON_CLICKED]:Wve,[gt.OPEN_MENU_CLICKED]:Yve,[gt.FAVORITES_TAB_CLICKED]:q,[gt.LISTS_TAB_CLICKED]:q,[gt.REGULARS_TAB_CLICKED]:q,[gt.SMART_CART_TAB_CLICKED]:q,[gt.CLEAR_SELECTED_FILTERS_BUTTON_CLICKED]:Qve,[Ft.types.UPDATE_PRODUCTS]:zve,[gt.SHOW_ALL_FAVORITES_FILTER_BUTTON_CLICKED]:qve,[gt.SHOW_ALL_FAVORITES_FILTER_BUTTON_IMPRESSION]:Kve,[gt.BACK_TO_TOP_BUTTON_CLICKED]:Xve},Jve=(e,t,n)=>{const o=[Rt({CATEGORY_ID:e.payload.categoryId,EVENT_ID:e.payload.eventId,EVENT_HEADLINE:e.payload.eventHeadline},t,Ad.HORIZONTAL_HERO_BANNER_IMPRESSION)];return bt(t,n,o)},eAe=(e,t,n)=>{const o=[Rt({CATEGORY_ID:e.payload.categoryId,SUB_CATEGORY_ID:e.payload.subCategoryId,SUB_CATEGORY_NAME:e.payload.subCategoryName,SEQUENCE:e.payload.sequence},t,Ad.SUB_CATEGORY_IMAGE_IMPRESSION)];return bt(t,n,o)},tAe=(e,t,n)=>q({type:Ad.SUB_CATEGORY_IMAGE_CLICKED,payload:{description:"User clicked an Events sub category",pageEventAttributes:{TYPE:e.payload.linkType,PARENT_CATEGORY_ID:e.payload.parentCategoryId,SUB_CATEGORY_ID:e.payload.subCategoryId,SUB_CATEGORY_NAME:e.payload.subCategoryName,VALUE:e.payload.value}}},t,n),sAe=(e,t,n)=>q({type:Ad.CATEGORY_FILTER_OPTION_CLICKED,payload:{description:"User clicked an option in the category filter drop down",pageEventAttributes:{FILTER_OPTION_CLICKED:e.payload.categoryName}}},t,n),nAe={[tn.HORIZONTAL_HERO_BANNER_IMPRESSION]:Jve,[tn.SUB_CATEGORY_IMAGE_IMPRESSION]:eAe,[tn.SUB_CATEGORY_IMAGE_CLICKED]:tAe,[tn.CATEGORY_FILTER_OPTION_CLICKED]:sAe},oAe=(e,t,n)=>jr(t,n,"IN_CHECKOUT_WALK",[pg(n)]),p_=(e,t,n)=>q(e,t,n),rAe=(e,t,n)=>xy({...e,payload:{...e.payload,pagePartType:e.payload.pagePartType||e.type}},t,n),aAe={[mn]:oAe,[Kn.CHECKOUT_WALK_FREE_GIFT]:rAe,[Kn.ADD_FREE_GIFT_CLICKED]:p_,[Kn.REMOVE_FREE_GIFT_CLICKED]:p_,[Kn.CONTINUE_SHOPPING_CLICKED]:p_},iAe=(e,t,n)=>({...RS(e,t,n,tr(),"APPLY_LOYALTY")}),lAe=(e,t,n)=>({...It,body:{applicableLoyaltyPageComponentEvent:{...St(t,n),...e.payload}}}),cAe=(e,t,n)=>{const o=[Rt(e.payload.recurringShoppingDefinitionCreateFormImpression,t,_e.RECURRING_SHOPPING_DEFINITION_FORM_CARD_IMPRESSION)];return bt(t,n,o)},dAe=(e,t,n)=>jr(t,n,_e.VOUCHERS_ADDED_TO_ORDER,e.payload.voucherIds),uAe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked the voucher button"}},t,n),pAe=(e,t,n)=>q({type:e.type,payload:{description:"User checked the checkbox agreeing for delivery to be left with concierge"},...St(t,n)},t,n),mAe=(e,t,n)=>q({type:e.type,payload:{description:"User unchecked the checkbox agreeing for delivery to be left with concierge"},...St(t,n)},t,n),hAe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked the link for the concierge T&C's"},...St(t,n)},t,n),gAe=(e,t,n)=>q({type:e.type,payload:{description:"User has confirmed their age"}},t,n),EAe=(e,t,n)=>({...It,body:{placeOrderEvent:{...St(t,n),status:e.payload.status,error:e.payload.error,walletItemId:e.payload.walletItemId,isRecurringShoppingDefinitionCreationRequested:e.payload.isRecurringShoppingDefinitionCreationRequested}}}),fAe=(e,t,n)=>{const{definitionId:o,name:r,frequency:a}=e.payload.recurringShoppingDefinition;return q({type:e.type,payload:{description:"User has created a recurring order",pageEventAttributes:{definitionId:o,recurringOrderName:r,recurringOrderFrequency:`${a.unit.toUpperCase()}_${a.value}`}},...St(t,n)},t,n)},yAe=({type:e,payload:t},n,o)=>q({type:e,payload:{description:RH[e],pageEventAttributes:{...t}}},n,o),IAe=(e,t,n)=>yAe(e,t,n),SAe=(e,t,n)=>{const o=[Rt(e.payload.impression,t,e.type)];return bt(t,n,o)},Fj=(e,t,n)=>q({type:e.type,payload:{description:RH[e.type],pageEventAttributes:e.payload.pageEventAttributes}},t,n),vR=e=>(t,n)=>{const{description:o,pageEventAttributes:r}=e.payload;return q({type:e.type,payload:{description:o,pageEventAttributes:r}},t,n)},CAe=e=>vR({type:_e.LOYALTY_POINTS_BUTTON_CLICKED,payload:{description:"User clicked the Loyalty points button",pageEventAttributes:e}}),TAe=e=>vR({type:_e.LOYALTY_POINTS_DISPLAYED,payload:{description:"A modal or page to add loyalty points was displayed",pageEventAttributes:e}}),_Ae=e=>{},vAe=e=>vR({type:_e.LOYALTY_POINTS_ADD_FAILURE,payload:{description:"Loyalty points addition failed",pageEventAttributes:e}}),AAe=(e,t,n)=>{const o=[Rt(e.payload.impression,t,e.type)];return bt(t,n,o,void 0)},bAe={[_e.APPLICABLE_LOYALTY]:jl(iAe,lAe),[_e.RECURRING_SHOPPING_DEFINITION_FORM_CARD_IMPRESSION]:cAe,[_e.RECURRING_SHOPPING_DEFINITION_FREQUENCY_SELECTED]:q,[_e.RECURRING_SHOPPING_DEFINITION_LABEL_WRITTEN]:q,[_e.TOAST_NOTIFICATION_DISPLAYED]:q,[_e.PAYMENT_BUFFER_MODAL_DISPLAYED]:q,[_e.FIND_OUT_MORE_BUTTON_CLICKED]:q,[_e.VOUCHERS_ADDED_TO_ORDER]:dAe,[_e.VOUCHER_BUTTON_CLICKED]:uAe,[_e.AGE_CHECK_CONFIRMED]:gAe,[_e.PLACE_ORDER]:EAe,[_e.RECURRING_ORDER_CREATED]:fAe,[_e.PAYMENT_CHECK_BUTTON_CLICKED]:q,[_e.CONCIERGE_CHECK_BOX_CHECKED]:pAe,[_e.CONCIERGE_CHECK_BOX_UNCHECKED]:mAe,[_e.CONCIERGE_TERMS_AND_CONDITIONS_CLICKED]:hAe,[_e.PHARMACY_FORM_DISPLAYED]:q,[_e.PHARMACY_FORM_DELETE_ITEM_CLICKED]:q,[_e.PHARMACY_FORM_SUBMIT_CLICKED]:q,[_e.DELIVERY_CARD_IMPRESSION]:SAe,[_e.CHANGE_DELIVERY_BUTTON_CLICKED]:IAe,[_e.SUBMIT_FEEDBACK_BUTTON_CLICKED]:Fj,[_e.SUBMIT_FEEDBACK_INTERACTION]:Fj,[_e.SUBMIT_FEEDBACK_IMPRESSION]:AAe,[_e.LOYALTY_POINTS_BUTTON_CLICKED]:CAe,[_e.LOYALTY_POINTS_DISPLAYED]:TAe,[_e.LOYALTY_POINTS_ADD_SUCCESS]:_Ae,[_e.LOYALTY_POINTS_ADD_FAILURE]:vAe,[_e.LOYALTY_POINTS_REFUNDED_ALERT_DISPLAYED]:q,[_e.LOYALTY_POINTS_REMOVED_ALERT_DISPLAYED]:q,[_e.PAYMENT_PROMOTION_APPLIED_TOAST_DISPLAYED]:q,[_e.PAYMENT_TYPE_SELECTED]:q},xAe=(e,t,n)=>wr({payload:{attributes:{TOTAL_GRIDS:e.payload.TOTAL_GRIDS,TOTAL_CAROUSELS:e.payload.TOTAL_CAROUSELS,TOTAL_HERO_IMAGE_BANNERS:e.payload.TOTAL_HERO_IMAGE_BANNERS,ENTRY_ID:e.payload.ENTRY_ID}}},t,n),RAe=(e,t,n)=>{const o={ENTRY_ID:e.payload.ENTRY_ID,GRID_ID:e.payload.GRID_ID,GRID_LAYOUT:e.payload.GRID_LAYOUT,SEQUENCE:e.payload.SEQUENCE,GRID_TYPE:e.payload.GRID_TYPE};return e.payload.ENTRY_PUBLISHED_TIMESTAMP&&(o.ENTRY_PUBLISHED_TIMESTAMP=e.payload.ENTRY_PUBLISHED_TIMESTAMP),bt(t,n,[Rt(o,t,"GRID_IMPRESSION")])},DAe=(e,t,n)=>{const o={ENTRY_ID:e.payload.ENTRY_ID,ENTRY_NAME:e.payload.ENTRY_NAME,GRID_ID:e.payload.GRID_ID,ITEM_TYPE:e.payload.ITEM_TYPE,ITEM_ID:e.payload.ITEM_ID,SEQUENCE:e.payload.SEQUENCE,ALT_TEXT:e.payload.ALT_TEXT};return e.payload.LINK_TYPE&&(o.LINK_TYPE=e.payload.LINK_TYPE),e.payload.LINK_VALUE&&(o.LINK_VALUE=e.payload.LINK_VALUE),e.payload.LABEL&&(o.LABEL=e.payload.LABEL),e.payload.ENTRY_PUBLISHED_TIMESTAMP&&(o.ENTRY_PUBLISHED_TIMESTAMP=e.payload.ENTRY_PUBLISHED_TIMESTAMP),bt(t,n,[Rt(o,t,"GRID_ITEM_IMPRESSION")])},OAe=(e,t,n)=>q({type:"IMAGE_CLICKED",payload:{description:"User clicked an ad banner image displayed on the page",pageEventAttributes:{entryId:e.payload.BANNER_ID,entryName:e.payload.BANNER_NAME,location:e.payload.LOCATION,placement:e.payload.PLACEMENT,contentSource:e.payload.CONTENT_SOURCE,linkType:e.payload.LINK_TYPE,targetUrl:e.payload.TARGET_URL,segmentId:e.payload.SEGMENT_ID,sequence:e.payload.SEQUENCE}}},t,n),PAe=(e,t,n)=>{const o={ENTRY_ID:e.payload.ENTRY_ID,ENTRY_NAME:e.payload.ENTRY_NAME,SEQUENCE:e.payload.SEQUENCE,HERO_IMAGE_ID:e.payload.HERO_IMAGE_ID,LINK_TYPE:e.payload.LINK_TYPE,TARGET_URL:e.payload.TARGET_URL};return e.payload.ENTRY_PUBLISHED_TIMESTAMP&&(o.ENTRY_PUBLISHED_TIMESTAMP=e.payload.ENTRY_PUBLISHED_TIMESTAMP),bt(t,n,[Rt(o,t,"HERO_IMAGE_BANNER_IMPRESSION")])},NAe=(e,t,n)=>q({type:"GRID_ITEM_CLICKED",payload:{description:"User Clicked on an image from the Grid",pageEventAttributes:{ENTRY_ID:e.payload.ENTRY_ID,GRID_ID:e.payload.GRID_ID,ITEM_ID:e.payload.ITEM_ID,ITEM_TYPE:e.payload.ITEM_TYPE,SEQUENCE:e.payload.SEQUENCE,LINK_TYPE:e.payload.LINK_TYPE,LINK_VALUE:e.payload.LINK_VALUE}}},t,n),LAe=(e,t,n)=>q({type:"CAROUSEL_ITEM_CLICKED",payload:{description:"User Clicked on an image from the Carousel",pageEventAttributes:{ENTRY_ID:e.payload.ENTRY_ID,GRID_ID:e.payload.GRID_ID,ITEM_ID:e.payload.ITEM_ID,ITEM_TYPE:e.payload.ITEM_TYPE,SEQUENCE:e.payload.SEQUENCE,LINK_TYPE:e.payload.LINK_TYPE,LINK_VALUE:e.payload.LINK_VALUE}}},t,n),kAe=(e,t,n)=>q({type:"NAV_MENU_CLICKED",payload:{description:"User clicked on the navigation menu button",pageEventAttributes:{TOTAL_ITEMS:e.payload.TOTAL_ITEMS}}},t,n),MAe=(e,t,n)=>q({type:"NAV_ITEM_CLICKED",payload:{description:"User clicked on a navigation item",pageEventAttributes:{ITEM_ID:e.payload.ITEM_ID,LABEL:e.payload.LABEL,ITEM_TYPE:e.payload.ITEM_TYPE,CAMPAIGN_ID:e.payload.CAMPAIGN_ID,LOCATION:e.payload.LOCATION,LINK_TYPE:e.payload.LINK_TYPE,LINK_VALUE:e.payload.LINK_VALUE}}},t,n),jAe=(e,t,n)=>bt(t,n,[Rt({CAMPAIGN_ID:e.payload.CAMPAIGN_ID,CAMPAIGN_NAME:e.payload.CAMPAIGN_NAME,RICH_TEXT_ID:e.payload.RICH_TEXT_ID,SEQUENCE:e.payload.SEQUENCE},t,"RICH_TEXT_IMPRESSION")]),wAe=(e,t,n)=>q({type:"RICH_TEXT_LINK_CLICKED",payload:{description:"User clicked on a link within the rich text component",pageEventAttributes:{RICH_TEXT_ID:e.payload.RICH_TEXT_ID,LINK_TYPE:e.payload.LINK_TYPE,LINK_VALUE:e.payload.LINK_VALUE}}},t,n),FAe={[vs.COMPONENTIZED_ATTRIBUTES]:xAe,[vs.GRID_IMPRESSION]:RAe,[vs.GRID_ITEM_IMPRESSION]:DAe,[vs.HORIZONTAL_HERO_BANNER_CLICK]:OAe,[vs.HORIZONTAL_HERO_BANNER_IMPRESSION]:PAe,[vs.GRID_ITEM_CLICKED]:NAe,[vs.CAROUSEL_ITEM_CLICKED]:LAe,[vs.NAV_MENU_CLICKED]:kAe,[vs.NAV_ITEM_CLICKED]:MAe,[vs.RICH_TEXT_IMPRESSION]:jAe,[vs.RICH_TEXT_LINK_CLICKED]:wAe},BAe="PERF_FIRST_INPUT_DELAY",AR={PERF_FIRST_INPUT_DELAY:BAe},UAe=(e,t,n)=>jr(t,n,AR.PERF_FIRST_INPUT_DELAY,e.payload.delay),GAe={[AR.PERF_FIRST_INPUT_DELAY]:UAe},$Ae=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n),pageEventType:e.type,pageEventDescription:"Address selection skipped"}}}),HAe=(e,t,n)=>q({type:e.type,payload:{description:"The click and collect map tried to fetch the user location",pageEventAttributes:{didLocationUpdate:e.payload.didLocationUpdate,error:e.payload.error,errorMessage:e.payload.errorMessage||""}}},t,n),VAe=(e,t,n)=>q({type:e.type,payload:{description:"The click and collect search input gained focus"}},t,n),YAe=(e,t,n)=>q({type:e.type,payload:{description:"The user selected an address",pageEventAttributes:{origin:e.payload.origin,addressId:e.payload.addressId}}},t,n),WAe=(e,t,n)=>q({type:e.type,payload:{description:"The user click on a pin on the map",pageEventAttributes:{addressId:e.payload.addressId}}},t,n),qAe=(e,t,n)=>q({type:e.type,payload:{description:"The user has clicked on the home delivery tab while on the click and collect page"}},t,n),KAe=(e,t,n)=>jr(t,n,_s.C_N_C_ADDRESS_SEARCH_TERM,e.payload.searchTerm),zAe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the homepage delivery destination card",pageEventAttributes:{deliveryMethod:e.payload.deliveryMethod}}},t,n),QAe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the delivery destination header",pageEventAttributes:{deliveryMethod:e.payload.deliveryMethod}}},t,n),XAe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked  'Change address/ Collection point' or 'Choose collection point/ Delivery' buttons",pageEventAttributes:{existingDeliveryMethodChanged:e.payload.existingDeliveryMethodChanged,deliveryMethod:e.payload.deliveryMethod}}},t,n),ZAe=(e,t,n)=>q({type:e.type,payload:{description:"The delivery destination search input gained focus"}},t,n),JAe=(e,t,n)=>q({type:e.type,payload:{description:"Map tried to fetch the user location",pageEventAttributes:{didLocationUpdate:!!e.payload.didLocationUpdate,error:!!e.payload.error,errorMessage:e.payload.errorMessage||""}}},t,n),ebe=(e,t,n)=>q({type:e.type,payload:{description:"The delivery destination modal is closed",pageEventAttributes:e.payload}},t,n),tbe=(e,t,n)=>q({type:_s.DELIVERY_OPTION_MODAL_TRIGGERED,payload:{description:"DDS modal triggered as a result of user action",pageEventAttributes:{...e.payload}}},t,n),sbe=(e,t,n)=>{const o=[Rt(e.payload,t,"HOMEPAGE_BOX_DDS_IMPRESSION")];return bt(t,n,o)},nbe={[_s.SKIPPED_ADDRESS_SELECTION]:$Ae,[_s.C_N_C_GEOLOCATION_EVENT]:HAe,[_s.C_N_C_ADDRESS_SEARCH_TERM]:KAe,[_s.C_N_C_ADDRESS_SEARCH_FOCUS]:VAe,[_s.C_N_C_ADDRESS_SELECT]:YAe,[_s.C_N_C_ADDRESS_PIN_CLICK]:WAe,[_s.C_N_C_HOME_DELIVERY_TAB_CLICKED]:qAe,[_s.HOMEPAGE_DELIVERY_DESTINATION_CARD_CLICKED]:zAe,[_s.DELIVERY_DESTINATION_HEADER_CLICKED]:QAe,[_s.CHANGE_ADDRESS_BUTTON_CLICKED]:XAe,[_s.DELIVERY_DESTINATIONS_SELECTOR_SEARCH_FOCUS]:ZAe,[_s.DELIVERY_DESTINATIONS_SELECTOR_GEOLOCATION_EVENT]:JAe,[_s.DELIVERY_DESTINATION_MODAL_CLOSED]:ebe,[_s.DELIVERY_OPTION_MODAL_TRIGGERED]:tbe,[_s.HOMEPAGE_BOX_DDS_IMPRESSION]:sbe},obe=(e,t,n)=>({...It,body:{deliveryPassPlanSeenEvent:{...St(t,n),plan:e.payload.plan,deliveryPassBenefitGroupId:e.payload.deliveryPassBenefitGroupId,bannerId:ja(n)??null}}}),rbe=(e,t,n)=>({...It,body:{deliveryPassSubscriptionStartedEvent:{...St(t,n),plan:e.payload.plan,deliveryPassBenefitGroupId:e.payload.deliveryPassBenefitGroupId,bannerId:ja(n)??null}}}),abe=(e,t,n)=>({...It,body:{deliveryPassTermsConditionsClickedEvent:{...St(t,n),bannerId:ja(n)??null}}}),ibe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on a 'Try Delivery Pass' or 'Manage Delivery Pass Options' button",pageEventAttributes:{isFreeTrialEligible:e.payload.isFreeTrialEligible,isManageDeliveryPass:e.payload.isManageDeliveryPass}}},t,n),m_=(e,t,n)=>q({type:e.type,payload:{description:`User clicked on a '${e.payload.buttonName}' button`,pageEventAttributes:{subscriptionId:e.payload.subscriptionId,retailerSubscriptionPlanId:e.payload.retailerSubscriptionPlanId,string:e.payload.buttonLabel}}},t,n),lbe=(e,t,n)=>q({type:e.type,payload:{description:"A Delivery Pass plan with its price and length and per default payment details (if any) was displayed in a modal",pageEventAttributes:{type:"userAction",value:e.payload.userAction}}},t,n),cbe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the button to view all plans"}},t,n),dbe={[Es.ADD_DELIVERY_ADDRESS_SELECTED]:q,[Es.BENEFIT_GROUP_SELECTED]:q,[Es.DELIVERY_PASS_PLAN_SEEN]:obe,[Es.DELIVERY_PASS_SUBSCRIPTION_STARTED]:rbe,[Es.DELIVERY_PASS_TERMS_CONDITIONS_CLICKED]:abe,[Es.VIEW_ALL_PLANS_BUTTON_CLICKED]:cbe,[Es.DELIVERY_PASS_BUTTON_CLICKED]:ibe,[Es.BUY_PLAN_BUTTON_CLICKED]:m_,[Es.FREE_TRIAL_BUTTON_CLICKED]:m_,[Es.MANAGE_CURRENT_PLAN_BUTTON_CLICKED]:m_,[Es.SELECTED_DELIVERY_PASS_PLAN_MODAL_DISPLAYED]:lbe},ube=(e,t,n)=>q({type:e.type,payload:{description:"User expanded cluster breadcrumbs",pageEventAttributes:e.payload.attributes}},t,n),pbe=e=>{const{groupType:t}=e;return["featured","featured_cross_sell","shoppable_banner"].includes((t||"").toLowerCase())},mbe=(e,t,n)=>{const o=e.payload.products.map(a=>{const{missedPromotion:i}=a,l=pbe(a),c=IS(a.productId)(n)||a.featuredProductCampaign,d={retailerProductId:a.retailerProductId,productId:a.productId,sequence:a.sequence,position:a.position,isFavorite:!!a.favorite,rankingScore:a.rankingScore,isPersonalised:!!a.isPersonalised,groupName:a.groupName,clusterName:a.clusterName,groupType:a.groupType,isInList:a.isInProductList,isRegular:!!a.regular,pageEventId:a.pageEventId};if(l&&c&&(d.campaignId=c.campaignId,d.campaignName=c.campaignName,d.advertId=c.externalAdvertId),a.ratingSummary&&(d.productStarRating=a.ratingSummary.overallRating),a.customAnalyticsData&&Object.entries(a.customAnalyticsData).forEach(([u,m])=>{d[u]=m}),a.offers){const u=a.offers.map(m=>({promotionId:m.id,promotionText:m.description,promotionType:m.type,promotionPresentation:m.presentationMode,...i?.id===m.id&&{orderId:a.orderId,missedPromotionProductsRequired:i?.requiredProductQuantity,missedPromotionProductsInBasket:i?.addedProductQuantity,missedPromotionText:i?.missedPromotionText,missedPromotionMessageType:i?.missedPromotionTextType}}));d.promotion=u}if(a.offer){const{description:u,id:m,presentationMode:g}=a.offer;d.promotionId=m,d.promotionText=u,d.promotionPresentation=g}return d}),r={};return r.productImpressionEventV3={...St(t,n),pageViewId:e.payload.pageViewId,products:o},{...It,body:r}},hbe=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n),pageEventType:e.type,pageEventDescription:"user clicked on a promotional link",pageEventAttributes:[{type:"promotionId",value:e.payload.promotionId},{type:"productId",value:e.payload.productId},...e.payload.sequence!==void 0?[{type:"sequence",value:`${e.payload.sequence}`}]:[]]}}}),gbe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked the ellipsis on a product front of pack",pageEventAttributes:{productId:e.payload.productId,retailerProductId:e.payload.retailerProductId}}},t,n),Ebe=(e,t,n)=>{const{missedPromotion:{id:o,missedPromotionText:r,requiredProductQuantity:a,addedProductQuantity:i,missedPromotionTextType:l},orderId:c,productId:d,missedPromotionType:u}=e.payload;return q({type:e.type,payload:{description:"Message shown to the customer",pageEventAttributes:{productId:d,...c&&{orderId:c},missedPromotionId:o,missedPromotionType:u,missedPromotionText:r,missedPromotionProductsRequired:a,missedPromotionProductsInBasket:i,missedPromotionMessageType:l}}},t,n)},fbe=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n,e),pageEventType:e.type,pageEventDescription:"User has clicked to reveal Out Of Stock Alternatives",pageEventAttributes:[{type:"productId",value:e.payload.productId},{type:"retailerProductId",value:e.payload.retailerProductId},{type:"totalCount",value:e.payload.totalCount},{type:"hideSubstitutes",value:e.payload.hideSubstitutes},{type:"productSequence",value:`${e.payload.productSequence}`}]}}}),ybe={[zt.BREADCRUMBS_LIST_CLICKED]:q,[zt.CLUSTER_EXPANDED]:ube,[zt.FOP_CLICKED]:q,[zt.PRODUCT_IMPRESSION]:mbe,[zt.PROMO_LINK_CLICKED]:hbe,[zt.ELLIPSIS_CLICKED]:gbe,[zt.MESSAGE_ALERT_DISPLAYED]:Ebe,[zt.SHOW_SUBSTITUTES]:fbe},Ibe=(e,t,n)=>({...It,body:{errorEvent:{...St(t,n),errorType:e.payload.errorType,boundaryType:e.payload.boundaryType}}}),Sbe="ERROR",OS={ERROR:Sbe},Cbe={[OS.ERROR]:Ibe},Tbe=(e,t,n)=>{const o=e.payload.navigationBarButtonImpressions.map(r=>Rt(r,t,"NAVIGATION_BAR_BUTTON"));return bt(t,n,o)},_be=(e,t,n)=>q({type:e.type,payload:{description:"A dropdown to select language was opened",pageEventAttributes:{userAction:e.payload.userAction,...e.payload.localeSelected&&{localeSelected:e.payload.localeSelected}}}},t,n),vbe=(e={},t,n)=>{const{payload:{analyticsEventId:o,destinationLinkType:r,menuCampaignItemName:a,menuCampaignItemId:i,menuCampaignId:l,position:c}={},type:d}=e;return q({type:d,payload:{description:"User clicked on a menu campaign sub item",pageEventId:o,pageEventAttributes:{destinationLinkType:r,menuCampaignItemName:a,menuCampaignItemId:i,menuCampaignId:l,sequence:c}}},t,n)},Abe=(e,t,n)=>{const{menuCampaignId:o,menuCampaignItemId:r,menuCampaignItemName:a,sequence:i}=e.payload,l=[Rt({menuCampaignItemName:a,menuCampaignItemId:r,menuCampaignId:o,sequence:i},t,"MENU_CAMPAIGN_ITEM_IMPRESSION")];return bt(t,n,l)},bbe=(e,t,n)=>{const{menuCampaignName:o,menuCampaignId:r,position:a}=e.payload,i=[Rt({menuCampaignName:o,menuCampaignId:r,sequence:a},t,"MENU_CAMPAIGN_IMPRESSION")];return bt(t,n,i)},xbe=(e,t,n)=>q({type:"MENU_CAMPAIGN_CLICKED",payload:{description:"User clicked on a menu campaign.",pageEventId:e.payload.analyticsEventId,pageEventAttributes:{menuCampaignName:e.payload.menuCampaignName,menuCampaignId:e.payload.menuCampaignId,sequence:e.payload.position}}},t,n),Rbe={[Nt.CATALOGUE_NAVIGATION_BAR_BUTTON_CLICKED]:q,[Nt.FAVORITES_NAVIGATION_BAR_BUTTON_CLICKED]:q,[Nt.COUPONS_NAVIGATION_BAR_BUTTON_CLICKED]:q,[Nt.LISTS_NAVIGATION_BAR_BUTTON_CLICKED]:q,[Nt.REGULARS_NAVIGATION_BAR_BUTTON_CLICKED]:q,[Nt.RECIPES_NAVIGATION_BAR_BUTTON_CLICKED]:q,[Nt.RECURRING_ORDERS_NAVIGATION_BAR_BUTTON_CLICKED]:q,[Nt.SHOP_IN_SHOP_NAVIGATION_BAR_BUTTON_CLICKED]:q,[Nt.MENU_CAMPAIGN_IMPRESSION]:bbe,[Nt.MENU_CAMPAIGN_CLICKED]:xbe,[Nt.DELIVERY_PASS_NAVIGATION_BAR_BUTTON_CLICKED]:q,[Nt.MENU_CAMPAIGN_ITEM_CLICKED]:vbe,[Nt.MENU_CAMPAIGN_ITEM_IMPRESSION]:Abe,[Nt.NAVIGATION_BAR_BUTTON_IMPRESSION]:Tbe,[Nt.OFFERS_NAVIGATION_BAR_BUTTON_CLICKED]:q,[Nt.LOCALE_DROPDOWN_OPENED]:_be,[Nt.SMART_CART_NAVIGATION_BAR_BUTTON_CLICKED]:q},Dbe=(e,t,n)=>{const{id:o,label:r,tabPosition:a,isInDropdown:i}=e.payload;return q({type:e.type,payload:{description:"User clicked top tab to be redirected to the page linked to the top tab",pageEventAttributes:{id:o,label:r,positionSeen:a,isInDropdown:i}}},t,n)},Obe=(e,t,n)=>({...It,body:{topTabImpressionsEvent:{...St(t,n),links:e.payload.links}}}),Pbe={[si.TOP_TAB_CLICKED]:Dbe,[si.TOP_TAB_IMPRESSION]:Obe,[si.TOP_TAB_DROPDOWN_OPENED]:q},Nbe="INSTANT_SHOP_BUTTON_CLICKED",Lbe="INSTANT_SHOP_MODAL_DISPLAYED",kbe="INSTANT_SHOP_ADD_TO_CART_CLICKED",Uc={INSTANT_SHOP_BUTTON_CLICKED:Nbe,INSTANT_SHOP_MODAL_DISPLAYED:Lbe,INSTANT_SHOP_ADD_TO_CART_CLICKED:kbe},Mbe={[Uc.INSTANT_SHOP_BUTTON_CLICKED]:q,[Uc.INSTANT_SHOP_MODAL_DISPLAYED]:q,[Uc.INSTANT_SHOP_ADD_TO_CART_CLICKED]:q},P2="SET_LANGUAGE_REQUIRES_CONFIRMATION",jbe=e=>({type:P2,payload:e}),N2={setLanguageRequiresConfirmation:jbe,types:{SET_LANGUAGE_REQUIRES_CONFIRMATION:P2}},wbe={active:"",direction:"ltr",strings:{}},Fbe=(e=wbe,t)=>{switch(t.type){case N2.types.SET_LANGUAGE_REQUIRES_CONFIRMATION:return{...e,languageRequiresConfirmation:t.payload};default:return e}},bR=({data:e})=>e.locale,Vs=V(bR,e=>e.active),L2=V(Vs,e=>e.split("-")[0]),k2=V(Vs,e=>e.split("-")[1]),Bbe=V(bR,e=>e.languageRequiresConfirmation),Ube=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n),pageEventType:e.type,pageEventDescription:"User changed locale",pageEventAttributes:[{type:"locale",value:e.payload.locale}]}}}),Gbe=(e,t,n)=>q({type:e.type,payload:{description:"A modal to select language was displayed",pageEventAttributes:{userAction:e.payload.userAction,...e.payload.localeSelected&&{localeSelected:e.payload.localeSelected}}}},t,n),$be=(e,t,n)=>jr(t,n,"LOCALE",Vs(t)),Hbe={[mn]:$be,[nr.LOCALE_CHANGED]:Ube,[nr.LOCALE_MODAL_DISPLAYED]:Gbe},Vbe={[TR.PERFORMANCE]:q},Ybe=e=>-1*e.quantity.quantityInBasket,Wbe=e=>e.data.basket?.totals?.display?.itemPriceAfterPromos?.currency,qbe=e=>({amount:0,currency:Wbe(e)});function Kbe(e,t,n){return e.payload&&e.payload.basketFinalPrice?e.payload.product.filter(o=>o.totalAmount!==void 0).map(o=>{const r=DS({basketId:t.data.basket.basketId,basketTotalValue:e.payload.basketFinalPrice,updateQuantity:o.addedAmount,totalQuantity:o.totalAmount,prevState:t,nextState:n,product:o,addedByFunction:e.payload.addedByFunction,addedFromSection:e.payload.section});return{...It,...r}}):[]}function zbe(e,t,n){return e.payload.productsRemoved.map(o=>{const r=t.data.products.productEntities[o.productId],a=DS({basketId:t.data.basket.basketId,basketTotalValue:qbe(t),updateQuantity:Ybe(o),totalQuantity:0,prevState:t,nextState:n,product:r,addedByFunction:e.payload.addedByFunction,addedFromSection:e.payload.section});return{...It,...a}})}const Qbe=(e,t,n)=>q({type:e.type,payload:{description:"A modal was shown to confirm discarding changes to an edited order",pageEventAttributes:{orderId:e.payload.orderId,userAction:e.payload.userAction}}},t,n),Xbe=(e,t,n)=>q({type:e.type,payload:{description:"A modal was shown to cancel an upcoming order",pageEventAttributes:{orderId:e.payload.orderId,userAction:e.payload.userAction}}},t,n),Zbe=(e,t,n)=>{const o=Kbe(e,t,n),r=zbe(e,t,n);return[...o,...r]},Jbe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked the edit order button",pageEventAttributes:{orderId:e.payload.orderId}}},t,n),exe=(e,t,n)=>{const{orderId:o,status:r,pageEventId:a}=e.payload;return q({type:js.EDIT_PAGE_SLOT_BOOKING_CARD_CLICKED,payload:{description:"User clicked slot changing card on order-details",pageEventAttributes:{orderId:o,status:r},pageEventId:a}},t,n)},txe={[js.BUY_ALL_PRODUCTS]:Zbe,[js.CANCEL_ORDER_MODAL_DISPLAYED]:Xbe,[js.DISCARD_CHANGES_MODAL_DISPLAYED]:Qbe,[js.EDIT_ORDER_BUTTON_CLICKED]:Jbe,[js.EDIT_PAGE_SLOT_BOOKING_CARD_CLICKED]:exe,[js.EDIT_ORDER_PAGE_VIEW_EVENT]:jl(xy,gA)},sxe=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n),pageEventType:e.type,pageEventDescription:"User clicked the continue shopping button"}}}),nxe="CONTINUE_SHOPPING_BUTTON_CLICKED",M2={CONTINUE_SHOPPING_BUTTON_CLICKED:nxe},oxe={[M2.CONTINUE_SHOPPING_BUTTON_CLICKED]:sxe},rxe=(e,t,n)=>({...It,body:{addFundingInstrumentEvent:{...St(t,n),action:e.payload.event,walletItemId:e.payload.walletItemId}}}),axe=(e,t,n)=>({...It,body:{addWalletItemRequestEvent:{...St(t,n),type:e.payload.event,resultToken:e.payload.resultToken}}}),ixe=(e,t,n)=>({...It,body:{failedPaymentEvent:{...St(t,n),orderId:e.payload.orderId}}}),lxe=(e,t,n)=>({...It,body:{failedPaymentSuccessEvent:{...St(t,n),orderId:e.payload.orderId}}}),cxe=(e,t,n)=>({...It,body:{failedPaymentWarningAlertEvent:{...St(t,n)}}}),dxe=(e,t,n)=>({...It,body:{failedPaymentWarningAlertLinkClickedEvent:{...St(t,n)}}}),uxe=(e,t,n)=>({...It,body:{failedPaymentWarningModalEvent:{...St(t,n)}}}),pxe=(e,t,n)=>({...It,body:{failedPaymentWarningModalUpdatePaymentDetailsButtonClickedEvent:{...St(t,n)}}}),mxe=(e,t,n)=>({...RS(e,t,n,tr(),"PAYMENT_CHECKS")}),hxe=(e,t,n)=>q({type:"PAYMENT_CHECK_MODAL_DISPLAYED",payload:{description:"Payment check modal displayed",pageEventAttributes:{...e.payload}}},t,n),gxe=(e,t,n)=>{const{customerId:o,orderId:r,paymentChecks:a}=e.payload,i=[],l=({paymentCheckAmount:c,paymentCheckId:d,expiryDate:u,increaseInTotalRequiredBeforeCheckIsAvailable:m,isAvailable:g})=>({...It,body:{paymentCheckEvent:{...St(t,n),orderId:r,customerId:o,paymentCheckAmount:c.amount,paymentCheckCurrency:c.currency,paymentCheckId:d,expiryDate:u,isAvailable:g,remainingToApply:m&&m.amount}}});return a.availablePaymentChecks&&a.availablePaymentChecks.forEach(c=>{c&&i.push(l({...c,isAvailable:!0}))}),a.checksMissingRequiredTotal&&a.checksMissingRequiredTotal.forEach(c=>{i.push(l({...c,isAvailable:!1}))}),i},Exe=(e,t,n)=>{const o=e.payload.walletItemImpressions.map(r=>Rt(r,t,"WALLET_ITEM_IMPRESSION"));return bt(t,n,o)},fxe=(e,t,n)=>q({type:e.type,payload:{description:"The payment methods available were displayed",pageEventAttributes:{type:"userAction",value:e.payload.userAction}}},t,n),yxe=(e,t,n)=>q({type:e.type,payload:{description:"The details for the payment method chosen were displayed",pageEventAttributes:{type:"userAction",value:e.payload.userAction}}},t,n),Ixe=(e,t,n)=>({...It,body:{unauthorizedPostMessageAttemptEvent:{...St(t,n),description:`Unauthorized postMessage attempt from origin: ${e.payload.origin}.`,bannerId:ja(n)}}}),Sxe={[xt.ADD_WALLET_ITEM]:rxe,[xt.BACK_TO_SHOP]:q,[xt.FAILED_PAYMENT]:ixe,[xt.FAILED_PAYMENT_SUCCESS]:lxe,[xt.FAILED_PAYMENT_WARNING_ALERT]:cxe,[xt.FAILED_PAYMENT_WARNING_ALERT_LINK_CLICKED]:dxe,[xt.FAILED_PAYMENT_WARNING_MODAL]:uxe,[xt.FAILED_PAYMENT_WARNING_MODAL_UPDATE_PAYMENT_DETAILS_BUTTON_CLICKED]:pxe,[xt.PAYMENT_CHECK_ADD_MODAL_DISPLAYED]:jl(mxe,hxe),[xt.PAYMENT_CHECKS_AVAILABILITY_FETCHED_ANALYTICS]:gxe,[xt.ADD_PAYMENT_METHOD_MODAL_DISPLAYED]:fxe,[xt.PAYMENT_METHOD_DETAILS_MODAL_DISPLAYED]:yxe,[xt.WALLET_ITEM_IMPRESSION]:Exe,[xt.SELECT_WALLET_ITEM]:q,[xt.ADD_WALLET_ITEM_REQUEST]:axe,[xt.UNAUTHORIZED_POST_MESSAGE_ATTEMPT]:Ixe},Cxe=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n),pageEventType:ht.RECURRING_ORDER_CARD_CLICKED,pageEventDescription:"The user clicked on the recurring order card"}}}),Txe=(e,t,n)=>q({type:ht.RECURRING_ORDER_CANCEL_MODAL_EVENT,payload:{description:"The recurring shopping definition cancel modal is displayed to the user",pageEventAttributes:{userAction:e.payload.userAction,definitionID:e.payload.definitionID}}},t,n),_xe=(e,t,n)=>q({type:ht.PLACEHOLDER_RECURRING_ORDER_DETAILS_CANCEL_MODAL_EVENT,payload:{description:"The upcoming recurring order cancel modal is displayed to the user",pageEventAttributes:{userAction:e.payload.userAction,definitionID:e.payload.definitionID,referenceID:e.payload.referenceID}}},t,n),vxe=(e,t,n)=>q({type:ht.MANAGE_RECURRING_ORDER_BUTTON_CLICKED,payload:{description:"The user clicked the manage recurring order button",pageEventAttributes:{definitionId:e.payload.definitionId}}},t,n),Axe=(e,t,n)=>q({type:ht.EDIT_PAYMENT_BUTTON_CLICKED,payload:{description:"User clicks edit payment in order page",pageEventAttributes:{definitionID:e.payload.definitionId}}},t,n),bxe=(e,t,n)=>q({type:e.type,payload:{description:"User clicks cancel recurring order in order page",pageEventAttributes:{definitionID:e.payload.definitionId}}},t,n),xxe=(e,t,n)=>q({type:ht.CANCEL_SELECTED_RECURRING_ORDERS_BUTTON_CLICKED,payload:{description:"User clicks cancel selected orders in order page",pageEventAttributes:{definitionID:e.payload.definitionId}}},t,n),Rxe=(e,t,n)=>q({type:ht.CHECKBOX_FOR_UPCOMING_RECURRING_ORDERS_CLICKED,payload:{description:"User clicks checkbox for upcoming orders",pageEventAttributes:{definitionID:e.payload.definitionId}}},t,n),Dxe=(e,t,n)=>q({type:ht.CLEAR_SELECTED_BUTTON_CLICKED,payload:{description:"User clicks clear selected button",pageEventAttributes:{definitionID:e.payload.definitionId}}},t,n),Oxe=(e,t,n)=>q({type:ht.CONFIRM_RECURRING_ORDER_CANCELLATION_MODAL_DISPLAYED,payload:{description:"A modal for confirm order cancellation or not",pageEventAttributes:{definitionID:e.payload.definitionId}}},t,n),Pxe=(e,t,n)=>q({type:ht.CONFIRMED_RECURRING_ORDER_CANCEL_MODAL,payload:{description:"User clicks yes in confirm order cancellation modal",pageEventAttributes:{definitionID:e.payload.definitionId,referenceIds:e.payload.referenceIds}}},t,n),Nxe=(e,t,n)=>q({type:ht.NO_BUTTON_CLICKED,payload:{description:"User clicks no in confirm order cancellation modal",pageEventAttributes:{definitionID:e.payload.definitionId}}},t,n),Lxe=(e,t,n)=>q({type:ht.CHOOSE_PAYMENT_METHOD_MODAL_DISPLAYED,payload:{description:"A modal for choose payment method",pageEventAttributes:{definitionID:e.payload.definitionId}}},t,n),kxe=(e,t,n)=>q({type:ht.RECURRING_ORDER_DAY_AND_TIME_MODAL_DISPLAYED,payload:{description:"A modal with recurring order day and time displayed",pageEventAttributes:e.payload}},t,n),Mxe=(e,t,n)=>q({type:ht.RECURRING_ORDER_TIME_REJECTED_FROM_DROPDOWN,payload:{description:"The user was shown slot not available message for time selection drop down",pageEventAttributes:e.payload}},t,n),jxe=(e,t,n)=>q({type:ht.RECURRING_ORDER_DAY_AND_TIME_SAVED,payload:{description:"The recurring order definition day and time changes were saved by the user",pageEventAttributes:e.payload}},t,n),wxe=(e,t,n)=>q({type:ht.RECURRING_ORDER_DAY_AND_TIME_MODAL_CLOSED,payload:{description:"A modal with recurring order day and time closed",pageEventAttributes:e.payload}},t,n),Fxe={[ht.RECURRING_ORDER_CARD_CLICKED]:Cxe,[ht.RECURRING_ORDER_CANCEL_MODAL_EVENT]:Txe,[ht.PLACEHOLDER_RECURRING_ORDER_DETAILS_CANCEL_MODAL_EVENT]:_xe,[ht.NO_BUTTON_CLICKED]:Nxe,[ht.CONFIRMED_RECURRING_ORDER_CANCEL_MODAL]:Pxe,[ht.CONFIRM_RECURRING_ORDER_CANCELLATION_MODAL_DISPLAYED]:Oxe,[ht.CLEAR_SELECTED_BUTTON_CLICKED]:Dxe,[ht.CHECKBOX_FOR_UPCOMING_RECURRING_ORDERS_CLICKED]:Rxe,[ht.CANCEL_SELECTED_RECURRING_ORDERS_BUTTON_CLICKED]:xxe,[ht.CANCEL_RECURRING_ORDER_BUTTON_CLICKED]:bxe,[ht.EDIT_PAYMENT_BUTTON_CLICKED]:Axe,[ht.MANAGE_RECURRING_ORDER_BUTTON_CLICKED]:vxe,[ht.CHOOSE_PAYMENT_METHOD_MODAL_DISPLAYED]:Lxe,[ht.RECURRING_ORDER_DAY_AND_TIME_MODAL_DISPLAYED]:kxe,[ht.RECURRING_ORDER_TIME_REJECTED_FROM_DROPDOWN]:Mxe,[ht.RECURRING_ORDER_DAY_AND_TIME_SAVED]:jxe,[ht.RECURRING_ORDER_DAY_AND_TIME_MODAL_CLOSED]:wxe},Bxe={},Uxe=(e=Bxe,t)=>{switch(t.type){case hs.SEARCH_SUGGESTION_CLICKED:case hs.SEARCH_SUGGESTION_CHOSEN:{const{id:n}=t.payload;return{triggerEvent:{id:n,type:"SUGGESTION_SEARCH"}}}case hs.SEARCH_FORM_SUBMISSION:return{triggerEvent:{id:void 0,type:"TEXT_SEARCH"}};case hs.BANNER_CLICKED:return{triggerEvent:{id:t.payload.analyticsEventId,type:"BANNER"}};case Nt.MENU_CAMPAIGN_ITEM_CLICKED:return{triggerEvent:{id:t.payload?.analyticsEventId,type:t.payload?.source}};default:return e}},Gxe=({data:e})=>e.search.analytics.triggerEvent,$xe=(e,t,n)=>({...It,body:{searchSuggestionClickedEvent:{...St(t,n),id:e.payload.id,userInput:e.payload.userInput,searchSuggestion:e.payload.searchSuggestion,locale:e.payload.locale,positionInSuggestionList:e.payload.positionInSuggestionList}}}),Hxe=(e,t,n)=>{const{id:o}=Gxe(n)||{},{searchTerm:r,correctedSearchTerm:a,locale:i,mlModelIds:l,sort:c,searchSuggestionType:d}=e.payload,u=sS(n);return{...It,body:{searchViewEvent:{...St(t,n),id:vt(),searchTerm:r,correctedSearchTerm:a,locale:i,...o&&{sourceEventId:o},mlModelIds:l,sort:c,source:u?"REFRESHED":d}}}},Vxe=(e,t,n)=>{const{searchTerm:o,redirectURL:r,locale:a,id:i}=e.payload;return{...It,body:{searchRedirectEvent:{...St(t,n),id:i,searchTerm:o,redirectURL:r,locale:a}}}},Yxe=e=>Object.keys(e).reduce((t,n)=>n==="id"?t:[...t,{type:n,value:e[n]}],[]),Wxe=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n),pageEventType:e.type,pageEventDescription:"User clicked a search suggestion shown to them to trigger a search.",pageEventAttributes:Yxe(e.payload)}}}),qxe=(e,t,n)=>{const o=e.payload.searchSuggestionImpressions.map(r=>Rt({searchTerm:r.searchTerm,sequence:r.sequence,searchSuggestionType:r.searchSuggestionType??e.payload.searchSuggestionType,location:r.location},t,e.type));return bt(t,n,o,e.payload.pageViewId)},Kxe={[hs.SEARCH_PAGE_VIEWED]:Hxe,[hs.SEARCH_SUGGESTION_CHOSEN]:$xe,[hs.SEARCH_REDIRECT]:Vxe,[hs.SEARCH_SUGGESTION_CLICKED]:Wxe,[hs.SEARCH_SUGGESTION_IMPRESSION]:qxe},zxe=(e,t,n)=>{const o=[Rt({SHOP_IN_SHOP_ID:e.payload.shopInShopId,SHOP_IN_SHOP_HEADLINE:e.payload.shopInShopHeadline},t,Tp.HORIZONTAL_HERO_BANNER_IMPRESSION)];return bt(t,n,o)},Qxe=(e,t,n)=>{const o=[Rt({SUB_CATEGORY_ID:e.payload.subCategoryId,SUB_CATEGORY_NAME:e.payload.subCategoryName,SEQUENCE:e.payload.sequence},t,Tp.SUB_CATEGORY_IMAGE_IMPRESSION)];return bt(t,n,o)},Xxe=(e,t,n)=>q({type:Tp.SUB_CATEGORY_IMAGE_CLICKED,payload:{description:"User clicked an Shop in Shop sub category",pageEventAttributes:{TYPE:e.payload.linkType,VALUE:e.payload.value,SUB_CATEGORY_ID:e.payload.subCategoryId,SUB_CATEGORY_NAME:e.payload.subCategoryName}}},t,n),Zxe={[Qr.HORIZONTAL_HERO_BANNER_IMPRESSION]:zxe,[Qr.SUB_CATEGORY_IMAGE_IMPRESSION]:Qxe,[Qr.SUB_CATEGORY_IMAGE_CLICKED]:Xxe},Jxe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked the delivery pass tab"}},t,n),eRe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the Receipt button"}},t,n),tRe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the button to edit the payment details"}},t,n),sRe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the button to change the auto-renewal status",pageAttributesEvent:{type:"string",value:e.payload.autoRenewalStatus}}},t,n),nRe=(e,t,n)=>q({type:e.type,payload:{description:"The modal to enable the auto renewal Free Delivery Pass was displayed",pageEventAttributes:{type:"userAction",value:e.payload.userAction}}},t,n),oRe=(e,t,n)=>q({type:e.type,payload:{description:"The modal to cancel the auto renewal of the Delivery Pass plan was displayed",pageEventAttributes:{type:"userAction",value:e.payload.userAction}}},t,n),rRe=(e,t,n)=>q({type:e.type,payload:{description:"The modal to confirm the change of Delivery Pass plan was displayed",pageEventAttributes:{type:"userAction",value:e.payload.userAction}}},t,n),aRe=(e,t,n)=>q({type:e.type,payload:{description:"The subscribed Delivery Pass plan summary was displayed",pageEventAttributes:{type:"userAction",value:e.payload.userAction}}},t,n),iRe=(e,t,n)=>wr({payload:{attributes:{CURRENT_SUBSCRIPTION_ID:e.payload.CURRENT_SUBSCRIPTION_ID}}},t,n),lRe="DELIVERY_PASS_SETTINGS_TAB_CLICKED",cRe="DELIVERY_PASS_RECEIPT_BUTTON_CLICKED",dRe="EDIT_PAYMENT_DETAILS_BUTTON_CLICKED",uRe="AUTO_RENEWAL_BUTTON_CLICKED",pRe="ENABLE_DELIVERY_PASS_AUTO_RENEWAL_MODAL_DISPLAYED",mRe="CANCEL_DELIVERY_PASS_AUTO_RENEWAL_MODAL_DISPLAYED",hRe="CHANGE_DELIVERY_PASS_PLAN_MODAL_DISPLAYED",gRe="DELIVERY_PASS_SUBSCRIBED_PLAN_MODAL_DISPLAYED",Mn={DELIVERY_PASS_SETTINGS_TAB_CLICKED:lRe,DELIVERY_PASS_RECEIPT_BUTTON_CLICKED:cRe,EDIT_PAYMENT_DETAILS_BUTTON_CLICKED:dRe,AUTO_RENEWAL_BUTTON_CLICKED:uRe,ENABLE_DELIVERY_PASS_AUTO_RENEWAL_MODAL_DISPLAYED:pRe,CANCEL_DELIVERY_PASS_AUTO_RENEWAL_MODAL_DISPLAYED:mRe,CHANGE_DELIVERY_PASS_PLAN_MODAL_DISPLAYED:hRe,DELIVERY_PASS_SUBSCRIBED_PLAN_MODAL_DISPLAYED:gRe},ERe={[Mn.DELIVERY_PASS_SETTINGS_TAB_CLICKED]:Jxe,[Mn.DELIVERY_PASS_RECEIPT_BUTTON_CLICKED]:eRe,[Mn.EDIT_PAYMENT_DETAILS_BUTTON_CLICKED]:tRe,[Mn.AUTO_RENEWAL_BUTTON_CLICKED]:sRe,[Mn.ENABLE_DELIVERY_PASS_AUTO_RENEWAL_MODAL_DISPLAYED]:nRe,[Mn.CANCEL_DELIVERY_PASS_AUTO_RENEWAL_MODAL_DISPLAYED]:oRe,[Mn.CHANGE_DELIVERY_PASS_PLAN_MODAL_DISPLAYED]:rRe,[Mn.DELIVERY_PASS_SUBSCRIBED_PLAN_MODAL_DISPLAYED]:aRe,[Mn.CURRENT_SUBSCRIPTION_ID]:iRe},fRe="LIST_CARD_IMPRESSION",yRe="PRODUCT_ADDED_TO_LIST",IRe="PRODUCT_REMOVED_FROM_LIST",SRe="LIST_CREATED",CRe="LIST_NAME_CHANGED",TRe="LIST_DELETED",_Re="LIST_ACTIONS_MODAL_DISPLAYED",vRe="EMPTY_LIST_PRODUCT_SEARCH_CLICKED",ARe="ADD_ALL_TO_TROLLEY_BUTTON_CLICKED",bRe="DELETE_LIST_MODAL_DISPLAYED",xRe="EDIT_NAME_MODAL_DISPLAYED",RRe="LIST_ID",DRe="LIST_TOTAL_COUNT",ORe="ADD_TO_FEATURE_MODAL_DISPLAYED",yn={LIST_CARD_IMPRESSION:fRe,PRODUCT_ADDED_TO_LIST:yRe,PRODUCT_REMOVED_FROM_LIST:IRe,LIST_CREATED:SRe,LIST_NAME_CHANGED:CRe,LIST_DELETED:TRe,LIST_ACTIONS_MODAL_DISPLAYED:_Re,EMPTY_LIST_PRODUCT_SEARCH_CLICKED:vRe,ADD_ALL_TO_TROLLEY_BUTTON_CLICKED:ARe,DELETE_LIST_MODAL_DISPLAYED:bRe,EDIT_NAME_MODAL_DISPLAYED:xRe,LIST_ID:RRe,LIST_TOTAL_COUNT:DRe,ADD_TO_FEATURE_MODAL_DISPLAYED:ORe},PRe=(e,t,n)=>{const o=[Rt(e.payload.listCardImpression,t,"LIST_IMPRESSION")];return bt(t,n,o)},NRe=(e,t,n)=>q({type:e.type,payload:{description:"A product was added to a list",pageEventAttributes:{listId:e.payload.listId,productId:e.payload.productId,retailerProductId:e.payload.retailerProductId,quantity:1}}},t,n),LRe=(e,t,n)=>q({type:e.type,payload:{description:"A product was removed from a list",pageEventAttributes:{listId:e.payload.listId,productId:e.payload.productId,retailerProductId:e.payload.retailerProductId,quantity:1}}},t,n),kRe=(e,t,n)=>q({type:e.type,payload:{description:"A new list was created",pageEventAttributes:{listId:e.payload.listId}}},t,n),MRe=(e,t,n)=>q({type:e.type,payload:{description:"The name of a list was changed",pageEventAttributes:{listId:e.payload.listId}}},t,n),jRe=(e,t,n)=>q({type:e.type,payload:{description:"A list was deleted",pageEventAttributes:{listId:e.payload.listId}}},t,n),wRe=(e,t,n)=>q({type:e.type,payload:{description:"A modal to delete or edit the name of a list was displayed",pageEventAttributes:{listId:e.payload.listId,userAction:e.payload.userAction}}},t,n),FRe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked to add all items to trolley ",pageEventAttributes:{...e.payload.listId&&{listId:e.payload.listId}},pageEventId:e.payload.sourceEventId}},t,n),BRe=(e,t,n)=>q({type:e.type,payload:{description:"A modal to delete a list was displayed",pageEventAttributes:{listId:e.payload.listId,userAction:e.payload.userAction}}},t,n),URe=(e,t,n)=>q({type:e.type,payload:{description:"A modal to edit the name of a list was displayed",pageEventAttributes:{listId:e.payload.listId,userAction:e.payload.userAction}}},t,n),GRe=(e,t,n)=>q({type:e.type,payload:{description:"A more options was displayed",pageEventAttributes:{productId:e.payload.productId,retailerProductId:e.payload.retailerProductId}}},t,n),$Re=(e,t,n)=>jr(t,n,yn.LIST_TOTAL_COUNT,e.payload.count),HRe=(e,t,n)=>jr(t,n,yn.LIST_ID,e.payload.listId),VRe={[yn.LIST_CARD_IMPRESSION]:PRe,[yn.PRODUCT_ADDED_TO_LIST]:NRe,[yn.PRODUCT_REMOVED_FROM_LIST]:LRe,[yn.LIST_CREATED]:kRe,[yn.LIST_DELETED]:jRe,[yn.LIST_NAME_CHANGED]:MRe,[yn.LIST_ACTIONS_MODAL_DISPLAYED]:wRe,[yn.EMPTY_LIST_PRODUCT_SEARCH_CLICKED]:q,[yn.ADD_ALL_TO_TROLLEY_BUTTON_CLICKED]:FRe,[yn.DELETE_LIST_MODAL_DISPLAYED]:BRe,[yn.EDIT_NAME_MODAL_DISPLAYED]:URe,[yn.ADD_TO_FEATURE_MODAL_DISPLAYED]:GRe,[yn.LIST_TOTAL_COUNT]:$Re,[yn.LIST_ID]:HRe},YRe=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n),pageEventType:e.type,pageEventDescription:"The slot booking modal was displayed",pageEventAttributes:[{type:"hasOutOfStock",value:e.payload.hasOutOfStock}]}}}),WRe=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n),pageEventType:e.type,pageEventDescription:"User clicked on the calendar date selector."}}}),qRe=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n),pageEventType:e.type,pageEventDescription:"User selected a date from the calendar."}}}),KRe=(e,t,n)=>({...It,body:{pageEvent:{...St(t,n),pageEventType:e.type,pageEventDescription:"User is displayed a notification stating they have no saved address"}}}),zRe=(e,t,n)=>{const o=[Rt(e.payload.alertImpression,t,"ALERT_IMPRESSION")];return bt(t,n,o)},QRe=(e,t,n)=>{const{slot:o}=e.payload,r={SLOT_ID:o.slotId,SLOT_TYPE:o.type,ORDER_ID:e.orderId,...e.carrierName&&{CARRIER_NAME:e.carrierName}};return q({type:e.type,payload:{description:"User booked a slot",pageEventAttributes:r}},t,n)},XRe=(e,t,n)=>q({type:e.type,payload:{description:e.payload.description,pageEventAttributes:{deliveryMethod:e.payload.deliveryMethod}}},t,n),Bj=(e,t,n)=>q({type:e.type,payload:{description:e.payload.description,pageEventAttributes:{deliveryMethod:e.payload.deliveryMethod,deliveryDestinationId:e.payload.deliveryDestinationId}}},t,n),ZRe=(e,t,n)=>q({type:e.type,payload:{description:e.payload.description,pageEventAttributes:{deliveryMethod:e.payload.deliveryMethod}}},t,n),Uj=(e,t,n)=>q({type:e.type,payload:{description:xr[e.type]}},t,n),Gj=(e,t,n)=>q({type:e.type,payload:{description:e.payload.description}},t,n),JRe=(e,t,n)=>{const o=e.payload.impressions?.map(r=>Rt(r,t,e.type));return bt(t,n,o)},eDe=(e,t,n)=>{const o=Rt({seasonalSlotPeriodId:e.payload.seasonalSlotPeriodId},t,e.type);return bt(t,n,[o])},tDe=(e,t,n)=>q({type:e.type,payload:{description:xr[e.type],pageEventAttributes:{userAction:e.payload.userAction}}},t,n),sDe=(e,t,n)=>wr({payload:{attributes:{[e.type]:"NoAddressNoOrderHistory"}}},t,n),nDe=({type:e,payload:t},n,o)=>{const{RETAILER_CUSTOMER_ID:r,...a}=t;return q({type:e,payload:{description:xr[e],pageEventAttributes:{CUSTOMER_ID:r,...a}}},n,o)},rl=({type:e,payload:t},n,o)=>q({type:e,payload:{description:xr[e],pageEventAttributes:{...t}}},n,o),oDe=(e,t,n)=>rl(e,t,n),rDe=(e,t,n)=>rl(e,t,n),aDe=(e,t,n)=>rl(e,t,n),iDe=(e,t,n)=>{const o=e.payload.impressions.map(r=>Rt(r,t,e.type));return bt(t,n,o)},lDe=(e,t,n)=>rl(e,t,n),cDe=(e,t,n)=>rl(e,t,n),dDe=(e,t,n)=>rl(e,t,n),uDe=(e,t,n)=>rl(e,t,n),pDe=(e,t,n)=>rl(e,t,n),mDe=(e,t,n)=>rl(e,t,n),Dy={DELIVERY_OPTIONS_CLICKED:"DELIVERY_OPTIONS_CLICKED",DELIVERY_OPTIONS_INCOMPLETE:"DELIVERY_OPTIONS_INCOMPLETE"},Xa={DROP_OFF:"DROP_OFF",ENTRY_INSTRUCTIONS:"ENTRY_INSTRUCTIONS",DELIVERY_ASSETS:"DELIVERY_ASSETS",ADDITIONAL_INFORMATION:"ADDITIONAL_INFORMATION",API_ERROR:"API_ERROR"},Oy={CONFIRMED:"CONFIRMED",CLOSED:"CLOSED"},hDe=({type:e,payload:t},n,o)=>{const{trigger:r,deliveryInstructionsEnabled:a,unattendedDeliveryEnabled:i,assetChoiceEnabled:l,dropOffOptionsSelected:c,errorDisplayed:d,modalClosed:u}=t;return q({type:e,payload:{description:xr[e],pageEventAttributes:{trigger:r,deliveryInstructionsEnabled:a,unattendedDeliveryEnabled:i,assetChoiceEnabled:l,...c?{dropOffOptionsSelected:c}:{},...d?{errorDisplayed:d}:{},modalClosed:u}}},n,o)},gDe=({payload:e},t,n)=>wr({payload:{attributes:{DELIVERY_OPTIONS:e.selectedDropOff}}},t,n),EDe=({type:e,payload:t},n,o)=>{const{deliveryAssetId:r,preselectedDeliveryAssetId:a}=t;return q({type:e,payload:{description:xr[e],pageEventAttributes:{deliveryAssetId:r,...a?{preselectedDeliveryAssetId:a}:{}}}},n,o)},fDe={[Fe.SLOT_IMPRESSION]:JRe,[Fe.ALERT_IMPRESSION]:zRe,[Fe.SLOT_BOOKING_MODAL_DISPLAYED]:YRe,[Fe.SLOT_BOOKED]:QRe,[Fe.ADDRESS_SELECTION_DROP_DOWN_CLICKED]:XRe,[Fe.ADDRESS_FROM_DROP_DOWN_SELECTED]:Bj,[Fe.COLLECTION_POINT_FROM_DROP_DOWN_SELECTED]:Bj,[Fe.CHOOSE_DIFFERENT_COLLECTION_POINT_BUTTON_CLICKED]:ZRe,[Fe.ITEM_WINDOW_REDUCED]:Uj,[Fe.ITEM_WINDOW_EXPANDED]:Uj,[Fe.STANDARD_SLOTS_BUTTON_CLICKED]:Gj,[Fe.SAVER_SLOTS_BUTTON_CLICKED]:Gj,[Fe.MAP_RENDERED_REASON]:sDe,[Fe.CARRIER_SELECTION_CLICKED]:nDe,[Fe.CONTINUE_CHECKOUT_BUTTON_CLICKED]:oDe,[Fe.CHOOSE_CARRIER_MODAL_DISPLAYED]:rDe,[Fe.SELECT_PICK_UP_POINT_BUTTON_CLICKED]:aDe,[Fe.CARRIER_SELECTION_CARD_IMPRESSION]:iDe,[Fe.EXTERNAL_COLLECTION_POINT_SELECT_BUTTON_CLICKED]:mDe,[Fe.SHIPPING_METHOD_NOT_VALID_MODAL_DISPLAYED]:lDe,[Fe.SELECT_SHIPPING_METHOD_BUTTON_CLICKED]:cDe,[Fe.CHANGE_DELIVERY_METHOD_MODAL_DISPLAYED]:dDe,[Fe.CONTINUE_AND_SEE_TROLLEY_BUTTON_CLICKED]:uDe,[Fe.CHANGE_DELIVERY_METHOD_CANCEL_BUTTON_CLICKED]:pDe,[Fe.DELIVERY_DETAILS_MODAL_DISPLAYED]:hDe,[Fe.DELIVERY_OPTIONS_VIEWED]:gDe,[Fe.DELIVERY_ASSET_CHANGED]:EDe,[Fe.SEASONAL_SLOTS_BANNER_IMPRESSION]:eDe,[Fe.SEASONAL_SLOTS_BANNER_CLICKED]:tDe,[Fe.SLOTBOOKING_NO_SAVED_ADDRESS_DISPLAYED]:KRe,[Fe.CALENDAR_CLICKED_EVENT]:WRe,[Fe.CALENDAR_DATE_SELECTED_EVENT]:qRe},yDe=(e,t,n)=>{const{entryId:o,contentBlockType:r,entryName:a,linkType:i,targetUrl:l,advertId:c,applyDescriptionByType:d=""}=e.payload;let u="User clicked a Content Block html content";return d&&(u=d==="HEADER"?"User clicked a Content Block Header":"User clicked a Content Block in Page"),q({type:e.type,payload:{description:u,pageEventAttributes:{entryId:o,contentBlockType:r,entryName:a,linkType:i,targetUrl:l,advertId:c}}},t,n)},IDe=(e,t,n)=>{const o=[Rt(e.payload.contentBlockImpression,t,"CONTENT_BLOCK_IMPRESSION")];return bt(t,n,o)},SDe=(e,t,n)=>{const{entryId:o,entryName:r,advertId:a}=e.payload;return q({type:e.type,payload:{description:"User clicked on the close button on a Content Block",pageEventAttributes:{entryId:o,entryName:r,advertId:a}}},t,n)},CDe={[Xr.CONTENT_BLOCK_CLICKED]:yDe,[Xr.CONTENT_BLOCK_IMPRESSION]:IDe,[Xr.CONTENT_BLOCK_CLOSE_BUTTON_CLICKED]:SDe},TDe="SUMMARY_COMPONENT_EXPANDED",_De="SUMMARY_COMPONENT_COLLAPSED",vDe="DELIVERY_PASS_LINK_SHOW_IN_COMPONENT",ADe="DELIVERY_PASS_COMPONENT_CLICKED",bDe="SAVINGS_WITH_PAYMENT_METHOD",Wn={SUMMARY_COMPONENT_EXPANDED:TDe,SUMMARY_COMPONENT_COLLAPSED:_De,DELIVERY_PASS_LINK_SHOW_IN_COMPONENT:vDe,DELIVERY_PASS_COMPONENT_CLICKED:ADe,SAVINGS_WITH_PAYMENT_METHOD:bDe},xDe=(e,t,n)=>wr({payload:{attributes:{DELIVERY_PASS_LINK_SHOW_IN_COMPONENT:e.payload.value}}},t,n),RDe=(e,t,n)=>q({type:e.type,payload:{description:"The user clicked on the Delivery Pass component"}},t,n),DDe={[Wn.SUMMARY_COMPONENT_EXPANDED]:q,[Wn.SUMMARY_COMPONENT_COLLAPSED]:q,[Wn.DELIVERY_PASS_LINK_SHOW_IN_COMPONENT]:xDe,[Wn.DELIVERY_PASS_COMPONENT_CLICKED]:RDe,[Wn.SAVINGS_WITH_PAYMENT_METHOD]:wr},ODe=(e,t,n)=>{const{orderId:o,status:r,pageEventId:a}=e.payload;return q({type:Ss.HOMEPAGE_SLOT_BOOKING_CARD_CLICKED,payload:{description:"User clicked on the homepage left-hand card",pageEventAttributes:{orderId:o,status:r},pageEventId:a}},t,n)},PDe=(e,t,n)=>{const{PAGE_EVENT_ID:o,...r}=e.payload.data||{};return q({type:Ss.HOMEPAGE_UPCOMING_ORDER_CARD_CLICKED,payload:{description:"User clicked on the homepage upcoming order card",pageEventAttributes:{...r},pageEventId:o}},t,n)},NDe=(e,t,n)=>{const{pageEventId:o,...r}=e.payload.data||{};return q({type:Ss.MULTIPLE_UPCOMING_ORDERS_CARD_CLICKED,payload:{description:"User clicked on the card indicating that more than one order is coming up",pageEventAttributes:{...r},pageEventId:o}},t,n)},LDe=(e,t,n)=>{const{pageEventId:o,...r}=e.payload.data||{};return q({type:Ss.HOMEPAGE_ADD_FUNCTION_CARD_CLICKED,payload:{description:"User clicked on the homepage right-hand card",pageEventAttributes:{...r},pageEventId:o}},t,n)},kDe=(e,t,n)=>{const{pageEventId:o,...r}=e.payload.data||{};return q({type:Ss.PRODUCT_CLUSTERS_FILTER_CLICKED,payload:{description:"Customer clicked to select or deselect one of the filters to display products from a cluster",pageEventAttributes:{...r},pageEventId:o}},t,n)},MDe=(e,t,n)=>{const o=[Rt(e.payload.data,t,"CARD_IMPRESSION")];return bt(t,n,o)},jDe=(e,t,n)=>{const o=[Rt(e.payload.data,t,Ss.PRODUCT_CLUSTERS_FILTERS_IMPRESSION)];return bt(t,n,o)},wDe={[Ss.HOMEPAGE_SLOT_BOOKING_CARD_CLICKED]:ODe,[Ss.HOMEPAGE_ADD_FUNCTION_CARD_CLICKED]:LDe,[Ss.HOMEPAGE_UPCOMING_ORDER_CARD_CLICKED]:PDe,[Ss.MULTIPLE_UPCOMING_ORDERS_CARD_CLICKED]:NDe,[Ss.PRODUCT_CLUSTERS_FILTER_CLICKED]:kDe,[Ss.HOME_CARD_IMPRESSION]:MDe,[Ss.PRODUCT_CLUSTERS_FILTERS_IMPRESSION]:jDe},FDe=(e,t,n)=>q({type:e.type,payload:{description:"User Clicked Button to Shop for Ingredients",pageEventAttributes:{RECIPE_ID:e.payload.RECIPE_ID}}},t,n),BDe=(e,t,n)=>{const{RECIPE_ID:o,GROUP_NAME:r,GROUP_TYPE:a,GROUP_SEQUENCE:i}=e.payload;return q({type:e.type,payload:{description:"User clicked on a recipe card",pageEventId:e.payload.pageEventId,pageEventAttributes:{RECIPE_ID:o,...r&&{GROUP_NAME:r},...a&&{GROUP_TYPE:a},...(i||i===0)&&{GROUP_SEQUENCE:i}}}},t,n)},UDe=(e,t,n)=>{const{RECIPE_ID:o}=e.payload;return q({type:"RECIPE_CLICKED",payload:{description:"User clicked on a recipe card",pageEventId:e.payload.pageEventId,pageEventAttributes:{RECIPE_ID:o}}},t,n)},GDe=(e,t,n)=>wr({payload:{attributes:{RECIPE_ID:e.payload.RECIPE_ID,RECIPE_NAME:e.payload.RECIPE_NAME,RECIPE_COLLECTION_ID:e.payload.RECIPE_COLLECTION_ID,RECIPE_COLLECTION_NAME:e.payload.RECIPE_COLLECTION_NAME}}},t,n),$De=(e,t,n)=>{const o=[Rt(e.payload.recipeImpression,t,dg)];return bt(t,n,o,e.payload.pageViewId)},HDe=(e,t,n)=>{const{RECIPE_ID:o,RECIPE_NAME:r,SEQUENCE:a,SERVES:i,TOTAL_TIME:l}=e.payload.recipeImpression,d=[Rt({RECIPE_ID:o,RECIPE_NAME:r,SEQUENCE:a,SERVES:i,TOTAL_TIME:l},t,dg)];return bt(t,n,d,e.payload.pageViewId)},VDe=(e,t,n)=>{const{RECIPE_COLLECTION_ID:o,GROUP_NAME:r,GROUP_TYPE:a,GROUP_SEQUENCE:i}=e.payload;return q({type:e.type,payload:{description:"User Clicked Collection Impression from the Displayed Collections",pageEventAttributes:{RECIPE_COLLECTION_ID:o,...r&&{GROUP_NAME:r},...a&&{GROUP_TYPE:a},...(i||i===0)&&{GROUP_SEQUENCE:i}}}},t,n)},YDe=(e,t,n)=>{const{RECIPE_COLLECTION_ID:o}=e.payload;return q({type:TS,payload:{description:"User Clicked Collection Impression from the Displayed Collections",pageEventId:e.payload.pageEventId,pageEventAttributes:{RECIPE_COLLECTION_ID:o}}},t,n)},WDe=(e,t,n)=>wr({payload:{attributes:{RECIPE_COLLECTION_ID:e.payload.RECIPE_COLLECTION_ID,RECIPE_COLLECTION_NAME:e.payload.RECIPE_COLLECTION_NAME}}},t,n),qDe=(e,t,n)=>{const o=[Rt(e.payload.collectionImpression,t,ug)];return bt(t,n,o,e.payload.pageViewId)},KDe=(e,t,n)=>{const{RECIPE_COLLECTION_ID:o,RECIPE_COLLECTION_NAME:r,SEQUENCE:a}=e.payload.collectionImpression,l=[Rt({RECIPE_COLLECTION_ID:o,RECIPE_COLLECTION_NAME:r,SEQUENCE:a},t,ug)];return bt(t,n,l,e.payload.pageViewId)},zDe=(e,t,n)=>q({type:e.type,payload:{description:"The Recipe Search Input Bar gained Focus"}},t,n),QDe=(e,t,n)=>q({type:e.type,payload:{description:"User Clicked Browse Button in Recipe Search"}},t,n),XDe=(e,t,n)=>q({type:e.type,payload:{description:"User Clicked on Load More Button in Recipe All Collections Page"}},t,n),ZDe=(e,t,n)=>q({type:e.type,payload:{description:"User Clicked on Browse Collections Card from Recipe Homepage"}},t,n),JDe=(e,t,n)=>wr({payload:{attributes:{RECIPE_SEARCH_SOURCE:"RECIPE_TEXT_SEARCH",RECIPE_SEARCH_TERM:e.payload.RECIPE_SEARCH_TERM,RECIPE_SEARCH_RESULTS_COUNT:(e.payload.RECIPE_SEARCH_RESULTS_COUNT??0).toString()}}},t,n),eOe=(e,t,n)=>q({type:"RECIPES_INGREDIENTS_NO_RESULTS",payload:{description:"The ingredient list for a recipe did not include any products for the user to choose from.",pageEventAttributes:{RECIPE_ID:e.payload.RECIPE_ID,SEARCH_TERM:e.payload.SEARCH_TERM}}},t,n),tOe=(e,t,n)=>q({type:fV,payload:{description:"User clicked on a recipe card",pageEventId:e.payload.pageEventId,pageEventAttributes:{RECIPE_CARD_ID:e.payload.RECIPE_CARD_ID,RECIPE_CARD_TITLE:e.payload.RECIPE_CARD_TITLE,TYPE:e.payload.LINK_TYPE,VALUE:e.payload.LINK_PATH}}},t,n),sOe=(e,t,n)=>{const o=[Rt(e.payload.recipeCardImpression,t,yV)];return bt(t,n,o,e.payload.pageViewId)},nOe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on save recipe button",pageEventAttributes:{RECIPE_ID:e.payload.RECIPE_ID}}},t,n),oOe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on unsave recipe button",pageEventAttributes:{RECIPE_ID:e.payload.RECIPE_ID}}},t,n),rOe=(e,t,n)=>q({type:e.type,payload:{description:"User Clicked on Load More Button in Saved Recipes page"}},t,n),aOe=(e,t,n)=>q({type:e.type,payload:{description:"User Clicked on Browse All Recipes Button in Recipe Shop for Ingredients Page",pageEventAttributes:{RECIPE_ID:e.payload.RECIPE_ID}}},t,n),iOe=(e,t,n)=>{const o=[Rt(e.payload.buttonImpression,t,lR)];return bt(t,n,o,e.payload.pageViewId)},lOe=(e,t,n)=>q({type:e.type,payload:{description:"User opened the recipe assistant modal by clicking the button"}},t,n),cOe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the restart button on the recipe assistant modal",pageEventAttributes:{...e.payload}}},t,n),dOe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the button to minimize the recipe assistant"}},t,n),uOe=(e,t,n)=>q({type:e.type,payload:{description:"The user reopened the chat after minimizing it"}},t,n),pOe=(e,t,n)=>q({type:e.type,payload:{description:"User cancelled the chat restart after clicking the Restart Button on the recipe assistant modal"}},t,n),mOe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked the Restart Button on the recipe assistant and restarted the chat"}},t,n),hOe=(e,t,n)=>q({type:e.type,payload:{description:"An error message was displayed to the user on the recipe assistant modal",pageEventAttributes:{...e.payload}}},t,n),gOe=(e,t,n)=>q({type:e.type,payload:{description:"The user clicked 'Try Again' to resend their message after an error"}},t,n),EOe=(e,t,n)=>q({type:e.type,payload:{description:"A message was displayed on the recipe assistant modal",pageEventAttributes:{...e.payload}}},t,n),fOe=(e,t,n)=>q({type:e.type,payload:{description:"User closed the flowout view"}},t,n),yOe={[eR]:zDe,[pV]:QDe,[zx]:FDe,[Qx]:BDe,[uV]:UDe,[dg]:$De,[Xx]:HDe,[TS]:VDe,[Zx]:YDe,[ug]:qDe,[Jx]:KDe,[mV]:ZDe,[hV]:XDe,[sR]:JDe,[nR]:GDe,[oR]:WDe,[tR]:eOe,[gV]:tOe,[EV]:sOe,[rR]:nOe,[aR]:oOe,[IV]:rOe,[iR]:aOe,[lR]:iOe,[cR]:lOe,[dR]:cOe,[uR]:dOe,[pR]:uOe,[CV]:pOe,[TV]:mOe,[_V]:hOe,[vV]:gOe,[xm]:EOe,[SV]:fOe},IOe=(e,t,n)=>jr(t,n,AV,e.payload),SOe=(e,t,n)=>q({type:e.type,payload:{description:"The user clicked the meal planning button on recipes home page"}},t,n),COe=(e,t,n)=>q({type:e.type,payload:{description:"User open the meal details screen for a meal",pageEventAttributes:{MEAL_ID:e.payload.MEAL_ID}}},t,n),TOe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked search recipes from your meals"}},t,n),_Oe=(e,t,n)=>q({type:e.type,payload:{description:"Create new meal dialog displayed"}},t,n),vOe=(e,t,n)=>{const{MEAL_ID:o,NUMBER_OF_INGREDIENTS:r}=e.payload;return q({type:e.type,payload:{description:"User pasted ingredients into their meal from the clipboard",pageEventAttributes:{...o&&{MEAL_ID:o},NUMBER_OF_INGREDIENTS:r}}},t,n)},AOe=(e,t,n)=>q({type:e.type,payload:{description:"Meal was created successfully",pageEventAttributes:{...e.payload}}},t,n),bOe=(e,t,n)=>q({type:e.type,payload:{description:"Edit meal dialog displayed",pageEventAttributes:{MEAL_ID:e.payload.MEAL_ID}}},t,n),xOe=(e,t,n)=>q({type:e.type,payload:{description:"Meal was edited successfully",pageEventAttributes:{...e.payload}}},t,n),ROe=(e,t,n)=>q({type:e.type,payload:{description:"Cancel editing meal dialog displayed",pageEventAttributes:{MEAL_ID:e.payload.MEAL_ID}}},t,n),DOe=(e,t,n)=>q({type:e.type,payload:{description:"User cancelled edit their meal via the dialog",pageEventAttributes:{MEAL_ID:e.payload.MEAL_ID}}},t,n),OOe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on create your first meal"}},t,n),POe=(e,t,n)=>q({type:e.type,payload:{description:"Delete meal dialog displayed",pageEventAttributes:{MEAL_ID:e.payload.MEAL_ID}}},t,n),NOe=(e,t,n)=>q({type:e.type,payload:{description:"User's meal was successfully deleted",pageEventAttributes:{MEAL_ID:e.payload.MEAL_ID}}},t,n),LOe={[AV]:IOe,[bV]:SOe,[xV]:COe,[eIe]:TOe,[tIe]:_Oe,[mR]:AOe,[RV]:vOe,[DV]:bOe,[hR]:xOe,[OV]:ROe,[PV]:DOe,[sIe]:OOe,[NV]:POe,[gR]:NOe},kOe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked confirm request button",pageEventAttributes:{orderId:e.payload.orderId}}},t,n),MOe=(e,t,n)=>q({type:e.type,payload:{description:"User cancelled selection of refund request item",pageEventAttributes:{orderId:e.payload.orderId,productId:e.payload.productId}}},t,n),jOe=(e,t,n)=>q({type:e.type,payload:{description:"User selected item for refund",pageEventAttributes:{orderId:e.payload.orderId,productId:e.payload.productId,quantity:e.payload.quantity,refundReasonCategory:e.payload.refundReasonCategory,refundReason:e.payload.refundReason,comment:e.payload.comment}}},t,n),wOe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked request refund button on refund FOP",pageEventAttributes:{orderId:e.payload.orderId,productId:e.payload.productId}}},t,n),FOe={[vu.CONFIRM_REQUEST_BUTTON_CLICKED]:kOe,[vu.REFUND_REQUEST_ITEM_CANCELLED]:MOe,[vu.REFUND_REQUEST_ITEM_SELECTED]:jOe,[vu.REQUEST_REFUND_BUTTON_CLICKED]:wOe},BOe=({type:e,...t})=>({type:e,payload:t}),U={analyticsEvent:BOe},UOe="User added a product to regulars",GOe="The confirmation modal was displayed",$Oe="The confirmation modal for removing all regulars from basket was displayed",HOe="User added a product to regulars",VOe="User removed a product from regulars",YOe="A toast notification was displayed",WOe="User changed a parameter of regular product",Dd={[fs.ADD_TO_REGULARS_MODAL_DISPLAYED]:UOe,[fs.REMOVE_ALL_REGULARS_MODAL_DISPLAYED]:GOe,[fs.REMOVE_ALL_REGULARS_FROM_BASKET_MODAL_DISPLAYED]:$Oe,[fs.PRODUCT_ADDED_TO_REGULARS]:HOe,[fs.PRODUCT_REMOVED_FROM_REGULARS]:VOe,[fs.TOAST_NOTIFICATION_DISPLAYED]:YOe,[fs.REGULARS_PARAMETERS_CHANGED]:WOe},{analyticsEvent:Od}=U,qOe=({productId:e,retailerProductId:t})=>Od({type:fs.ADD_TO_REGULARS_MODAL_DISPLAYED,description:Dd.ADD_TO_REGULARS_MODAL_DISPLAYED,pageEventAttributes:{productId:e,retailerProductId:t}}),KOe=()=>Od({type:fs.REMOVE_ALL_REGULARS_MODAL_DISPLAYED,description:Dd.REMOVE_ALL_REGULARS_MODAL_DISPLAYED}),zOe=()=>Od({type:fs.REMOVE_ALL_REGULARS_FROM_BASKET_MODAL_DISPLAYED,description:Dd.REMOVE_ALL_REGULARS_FROM_BASKET_MODAL_DISPLAYED}),QOe=({productId:e,retailerProductId:t,frequency:n,quantity:o})=>Od({type:fs.PRODUCT_ADDED_TO_REGULARS,description:Dd.PRODUCT_ADDED_TO_REGULARS,pageEventAttributes:{productId:e,retailerProductId:t,addToBasketFrequency:n,quantity:o}}),XOe=({productId:e="",retailerProductId:t="",removeAll:n=!1})=>Od({type:fs.PRODUCT_REMOVED_FROM_REGULARS,description:Dd.PRODUCT_REMOVED_FROM_REGULARS,pageEventAttributes:{productId:e,retailerProductId:t,removeAll:n}}),ZOe=e=>Od({type:fs.TOAST_NOTIFICATION_DISPLAYED,description:Dd.TOAST_NOTIFICATION_DISPLAYED,pageEventAttributes:{status:e}}),$j=({productId:e,retailerProductId:t,parameter:n,previousValue:o,currentValue:r})=>Od({type:fs.REGULARS_PARAMETERS_CHANGED,description:Dd.REGULARS_PARAMETERS_CHANGED,pageEventAttributes:{productId:e,retailerProductId:t,parameter:n,previousValue:o,currentValue:r}}),JOe=(e,t,n)=>jr(t,n,fs.REGULARS_TOTAL_COUNT,e.payload.count),ePe=(e,t,n)=>jr(t,n,fs.REGULARS_IN_TROLLEY_TOTAL_COUNT,e.payload.count),tPe=(e,t,n)=>({...It,body:{basketQuantityUpdateEventV5:{...St(t,n),...e.payload,totalQuantity:0,addedByFunction:"REGULARS_REMOVED_ALL",bannerId:ja(n)}}}),sPe={[fs.ADD_TO_REGULARS_MODAL_DISPLAYED]:q,[fs.REMOVE_ALL_REGULARS_MODAL_DISPLAYED]:q,[fs.REMOVE_ALL_REGULARS_FROM_BASKET_MODAL_DISPLAYED]:q,[fs.PRODUCT_ADDED_TO_REGULARS]:q,[fs.PRODUCT_REMOVED_FROM_REGULARS]:q,[fs.REGULARS_PARAMETERS_CHANGED]:q,[fs.REGULARS_TOTAL_COUNT]:JOe,[fs.REGULARS_IN_TROLLEY_TOTAL_COUNT]:ePe,[fs.REMOVE_ALL_REGULARS_FROM_BASKET]:tPe},nPe=(e,t,n)=>q({type:e.type,payload:{description:"User click the 'add a review' button"}},t,n),oPe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the product reviews icon badge"}},t,n),rPe=(e,t,n)=>q({type:e.type,payload:{description:"User toggled the helpfulness of a review (either marked helpful or removed the helpful status)",pageEventAttributes:{reviewId:e.payload.reviewId,location:e.payload.location,action:e.payload.action}}},t,n),aPe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the view a retailer response button"}},t,n),iPe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the hide a retailer response button"}},t,n),Hj=(e,t,n)=>q({type:e.type,payload:{description:e.payload.description}},t,n),lPe=(e,t,n)=>q({type:e.type,payload:{description:"User sees the toast notification",pageEventAttributes:{productId:e.payload.productId,retailerProductId:e.payload.retailerProductId,reviewRating:e.payload.reviewRating}}},t,n),cPe=(e,t,n)=>q({type:e.type,payload:{description:"User changed sort preference",pageEventAttributes:{preferenceSelect:e.payload.translation}}},t,n),dPe=(e,t,n)=>q({type:e.type,payload:{description:"User sees the validation errors",pageEventAttributes:e.payload}},t,n),uPe=(e,t,n)=>{const o=e.payload.reviewImpressions.map(r=>Rt(r,t,fn.PRODUCT_REVIEW_IMPRESSION));return bt(t,n,o,e.pageViewId)},pPe=(e,t,n)=>{const o=e.payload.overallRatingImpressions.map(r=>Rt(r,t,fn.PRODUCT_OVERALL_RATINGS_DASHBOARD_IMPRESSION));return bt(t,n,o,e.pageViewId)},mPe=(e,t,n)=>q({type:e.type,payload:{description:"An non-verified user clicks the 'add a review' button"}},t,n),hPe={[fn.ADD_A_REVIEW_BUTTON_CLICKED]:nPe,[fn.PRODUCT_RATINGS_CLICKED]:oPe,[fn.REVIEW_HELPFUL_BUTTON_CLICK]:rPe,[fn.VIEW_RESPONSE_BUTTON_CLICKED]:aPe,[fn.HIDE_RESPONSE_BUTTON_CLICKED]:iPe,[fn.SEE_NEXT_REVIEW_PAGE_BUTTON_CLICKED]:Hj,[fn.SEE_PREVIOUS_REVIEW_PAGE_BUTTON_CLICKED]:Hj,[fn.REVIEW_SUBMITTED_TOAST_DISPLAYED]:lPe,[fn.WRITE_REVIEW_ERROR_ALERT_DISPLAYED]:dPe,[fn.REVIEW_SORT_PREFERENCE_CHANGED]:cPe,[fn.PRODUCT_REVIEW_IMPRESSION]:uPe,[fn.PRODUCT_OVERALL_RATINGS_DASHBOARD_IMPRESSION]:pPe,[fn.WRITE_NON_VERIFIED_REVIEW_BLOCK_TOAST_DISPLAYED]:mPe,[fn.REVIEW_IMAGE_NAVIGATED]:q,[fn.REVIEW_IMAGE_GALLERY_OPENED]:q,[fn.REVIEW_IMAGE_GALLERY_CLOSED]:q},gPe={SEE_MORE_BUTTON_CLICKED:"SEE_MORE_BUTTON_CLICKED"},EPe=(e,t,n)=>q({type:e.type,payload:{description:"The customer clicked on the 'See more' button"}},t,n),fPe={[gPe.SEE_MORE_BUTTON_CLICKED]:EPe},xR={LISTER_PAGE_URL_LENGTH_LIMIT_BREAK:"LISTER_PAGE_URL_LENGTH_LIMIT_BREAK"},yPe=(e,t,n)=>{const{externalAdvertId:o,targetUrlLength:r,productsNumber:a}=e.payload,i=[Rt({externalAdvertId:o,targetUrlLength:r,productsNumber:a},t,xR.LISTER_PAGE_URL_LENGTH_LIMIT_BREAK)];return bt(t,n,i)},IPe={[xR.LISTER_PAGE_URL_LENGTH_LIMIT_BREAK]:yPe},Io={ORDER_DISCOUNT_FORM_MODAL_DISPLAYED:"ORDER_DISCOUNT_FORM_MODAL_DISPLAYED",ORDER_DISCOUNT_FORM_MODAL_CLOSED:"ORDER_DISCOUNT_FORM_MODAL_CLOSED",ORDER_DISCOUNT_FORM_PROMOTION_IMPRESSION:"ORDER_DISCOUNT_FORM_PROMOTION_IMPRESSION",ORDER_DISCOUNT_DROPDOWN_CLICKED:"ORDER_DISCOUNT_DROPDOWN_CLICKED"},SPe=(e,t,n)=>{const o=e.payload.promotionsFormImpression.map(r=>Rt(r,t,Io.ORDER_DISCOUNT_FORM_PROMOTION_IMPRESSION));return bt(t,n,o)},CPe={[Io.ORDER_DISCOUNT_FORM_MODAL_DISPLAYED]:q,[Io.ORDER_DISCOUNT_FORM_MODAL_CLOSED]:q,[Io.ORDER_DISCOUNT_FORM_PROMOTION_IMPRESSION]:SPe,[Io.ORDER_DISCOUNT_DROPDOWN_CLICKED]:q},TPe=(e,t,n)=>q({type:e.type,payload:{description:"User completed the promotion by adding all the requred products from all the required  groups to the basket.",pageEventAttributes:{promoPageId:e.payload.promoPageId}}},t,n),_Pe=(e,t,n)=>q({type:e.type,payload:{description:"A product group accordian was expanded",pageEventAttributes:{productGroupSequence:e.payload.productGroupSequence}}},t,n),vPe=(e,t,n)=>q({type:e.type,payload:{description:"A product group accordian was collapsed",pageEventAttributes:{productGroupSequence:e.payload.productGroupSequence}}},t,n),APe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the coupons tab"}},t,n),bPe={[Pc.COMBO_PROMO_COMPLETED]:TPe,[Pc.COMBO_PROMO_ACCORDION_EXPANDED]:_Pe,[Pc.COMBO_PROMO_ACCORDION_COLLAPSED]:vPe,[Pc.COUPONS_TAB_CLICKED]:APe},xPe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the learn more button on the page.",pageEventAttributes:{...e.payload}}},t,n),RPe=(e,t,n)=>q({type:e.type,payload:{description:"User closed coupon onboarding card.",pageEventAttributes:{...e.payload}}},t,n),DPe=(e,t,n)=>{const o=[Rt({...e.payload},t,e.type)];return bt(t,n,o)},OPe=(e,t,n)=>{const o=[Rt({...e.payload},t,e.type)];return bt(t,n,o)},PPe=(e,t,n)=>q({type:e.type,payload:{description:"After encountering an empty coupon page, the customer clicked the promotions button.",pageEventAttributes:{...e.payload}}},t,n),NPe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on a coupon presented to them.",pageEventAttributes:{...e.payload}}},t,n),LPe=(e,t,n)=>{const o=[Rt({...e.payload},t,e.type)];return bt(t,n,o)},kPe=(e,t,n)=>wr({payload:{attributes:{COUPONS_AVAILABLE:e.payload.COUPONS_AVAILABLE}}},t,n),MPe=(e,t,n)=>q({type:e.type,payload:{description:"User clicked on the promotions tab"}},t,n),jPe={[Ca.LEARN_MORE_BUTTON_CLICKED]:xPe,[Ca.ONBOARDING_CARD_CLOSED]:RPe,[Ca.COUPON_ONBOARDING_CARD_IMPRESSION]:DPe,[Ca.LEARN_MORE_BUTTON_IMPRESSION]:OPe,[Ca.PROMOTIONS_TAB_CLICKED]:MPe,[Ca.EMPTY_COUPONS_PROMO_BUTTON_CLICKED]:PPe,[Ca.COUPON_CLICKED]:NPe,[Ca.COUPON_IMPRESSION]:LPe,[Ca.COUPONS_AVAILABLE]:kPe},j2=ee("GET_CATEGORIES"),w2="SET_CATEGORY_EVENT",F2="RESET_CATEGORY_EVENT",B2="SET_CATEGORY_RICH_TEXT_CONTENT",U2="RESET_CATEGORY_RICH_TEXT_CONTENT_EVENT",wPe=e=>({type:w2,payload:e}),FPe=()=>({type:F2}),BPe=({depth:e,isSEOReadableURLEnabled:t=!1})=>({type:"API",payload:{url:`/v1/categories?decoration=false&categoryDepth=${e}`,service:"web_product_page_ws",pathPrefix:{client:"/api/webproductpagews",server:"/core-api"},...j2},isSEOReadableURLEnabled:t,depth:e}),UPe=e=>({type:B2,payload:e}),GPe=()=>({type:U2}),Cr={getCategories:BPe,setCategoryEvent:wPe,resetCategoryEvent:FPe,setCategoryRichTextContent:UPe,resetCategoryRichTextContentEvent:GPe,actionTypes:{GET_CATEGORIES:j2,SET_CATEGORY_EVENT:w2,RESET_CATEGORY_EVENT:F2,SET_CATEGORY_RICH_TEXT_CONTENT:B2,RESET_CATEGORY_RICH_TEXT_CONTENT_EVENT:U2}},{normalize:$Pe}=Ji,{categoriesSchema:HPe}=Zi,VPe={...Re,depth:null,root:null,categories:null,categoryEvent:null,richTextContent:null},YPe=(e=VPe,t)=>{switch(t.type){case Cr.actionTypes.GET_CATEGORIES.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Cr.actionTypes.GET_CATEGORIES.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Cr.actionTypes.GET_CATEGORIES.SUCCESS:{const n=t.payload.responseData,o=$Pe(n,HPe),r=t.isSEOReadableURLEnabled?Yce(o.entities.categories,o.result):o.entities.categories;return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),root:o.result,categories:r,depth:t.depth}}case Cr.actionTypes.SET_CATEGORY_EVENT:return{...e,categoryEvent:t.payload};case Cr.actionTypes.RESET_CATEGORY_EVENT:return{...e,categoryEvent:null};case Cr.actionTypes.SET_CATEGORY_RICH_TEXT_CONTENT:return{...e,richTextContent:t.payload};case Cr.actionTypes.RESET_CATEGORY_RICH_TEXT_CONTENT_EVENT:return{...e,richTextContent:null};default:return e}},WPe=({data:e})=>e.categories.isFetching,qPe=({data:e})=>e.categories.depth,G2=({data:e})=>e.categories.categories,$2=({data:e})=>e.categories.root,yXt=V($2,G2,(e,t)=>e===null?[]:e.map(n=>({id:n,name:t[n].name,fullURLPath:t[n].fullURLPath||"",retailerCategoryId:t[n].retailerId||""}))),KPe=({data:e})=>e.categories.categoryEvent,zPe=({data:e})=>e.categories.richTextContent,H2=({data:e})=>e.categories.richTextContent?.categoryId||"",QPe=(e,t,n)=>q({type:e.type,payload:{description:"The customer clicked on an item within the text block intended for SEO positioning",pageEventAttributes:{...e.payload}}},t,n),XPe=(e,t,n)=>{const o=[Rt({...e.payload,regionId:hn(n),categoryId:H2(n)},t,e.type)];return bt(t,n,o)},ZPe=(e,t,n)=>{const o=[Rt({...e.payload,regionId:hn(n),categoryId:H2(n)},t,e.type)];return bt(t,n,o)},ku={SEO_TEXT_BLOCK_ITEM_CLICKED:"SEO_TEXT_BLOCK_ITEM_CLICKED",SEO_CATEGORY_DESCRIPTION_LOADED:"SEO_CATEGORY_DESCRIPTION_LOADED",SEO_CATEGORY_DESCRIPTION_IMPRESSION:"SEO_CATEGORY_DESCRIPTION_IMPRESSION"},JPe={[ku.SEO_TEXT_BLOCK_ITEM_CLICKED]:QPe,[ku.SEO_CATEGORY_DESCRIPTION_LOADED]:XPe,[ku.SEO_CATEGORY_DESCRIPTION_IMPRESSION]:ZPe},eNe=(e,t,n)=>bt(t,n,[Rt({},t,"FOOTER_LEGAL_TEXT_IMPRESSION")]),tNe=(e,t,n)=>q({type:"FOOTER_LEGAL_TEXT_LINK_CLICKED",payload:{description:"User clicked on a link within the footer legal text component",pageEventAttributes:{LINK_VALUE:e.payload.LINK_VALUE}}},t,n),Py={FOOTER_LEGAL_TEXT_LINK_CLICKED:"FOOTER_LEGAL_TEXT_LINK_CLICKED",FOOTER_LEGAL_TEXT_IMPRESSION:"FOOTER_LEGAL_TEXT_IMPRESSION"},sNe={[Py.FOOTER_LEGAL_TEXT_LINK_CLICKED]:tNe,[Py.FOOTER_LEGAL_TEXT_IMPRESSION]:eNe},nNe=(e,t,n)=>q({type:e.type,payload:{description:"User clicks recurring orders",pageEventAttributes:{customerId:e.payload.customerId,source:e.payload.source}}},t,n),oNe=(e,t,n)=>q({type:e.type,payload:{description:"User clicks on create recurring order button",pageEventAttributes:{customerId:e.payload.customerId}}},t,n),rNe=(e,t,n)=>q({type:e.type,payload:{description:"User clicks on learn more button",pageEventAttributes:{customerId:e.payload.customerId}}},t,n),aNe=(e,t,n)=>q({type:e.type,payload:{description:"User clicks on edit payment button when they finish created",pageEventAttributes:{customerId:e.payload.customerId,value:e.payload.paymentMethodType}}},t,n),iNe=(e,t,n)=>q({type:e.type,payload:{description:"User clicks on cancle button for existed one recurring order",pageEventAttributes:{customerId:e.payload.customerId,value:e.payload.paymentMethodType}}},t,n),lNe=(e,t,n)=>q({type:e.type,payload:{description:"User clicks on edit upcoming orders",pageEventAttributes:{customerId:e.payload.customerId}}},t,n),cNe=(e,t,n)=>q({type:e.type,payload:{description:"A modal for create recurring order was displayed",pageEventAttributes:{customerId:e.payload.customerId}}},t,n),dNe=(e,t,n)=>q({type:e.type,payload:{description:"A modal for create recurring order was displayed",pageEventAttributes:{customerId:e.payload.customerId,position:e.payload.position}}},t,n),uNe=(e,t,n)=>q({type:e.type,payload:{description:"User clicks on address for a recurring order",pageEventAttributes:{customerId:e.payload.customerId}}},t,n),pNe=(e,t,n)=>q({type:e.type,payload:{description:"User clicks on address for a recurring order",pageEventAttributes:{customerId:e.payload.customerId}}},t,n),mNe=(e,t,n)=>q({type:e.type,payload:{description:"User select a day and time for a recurring order",pageEventAttributes:{customerId:e.payload.customerId}}},t,n),hNe=(e,t,n)=>q({type:e.type,payload:{description:"User clicks on choose payment method button",pageEventAttributes:{customerId:e.payload.customerId}}},t,n),gNe=(e,t,n)=>q({type:e.type,payload:{description:"User clicks edit when they created their recurring order",pageEventAttributes:{customerId:e.payload.customerId}}},t,n),ENe="RECURRING_ORDERS_CLICKED",fNe="CREATE_RECURRING_ORDER_BUTTON_CLICKED",yNe="LEARN_MORE_RECURRING_ORDER_BUTTON_CLICKED",INe="CREATED_RECURRING_ORDER_EDIT_PAYMENT_BUTTON_CLICKED",SNe="CREATED_RECURRING_ORDER_CANCEL_BUTTON_CLICKED",CNe="EDIT_UPCOMING_ORDERS_BUTTON_CLICKED",TNe="CREATE_RECURRING_ORDER_MODAL_DISPLAYED",_Ne="IS CANCEL_CREATE_RECURRING_ORDER_CLICKED",vNe="CREATE_RECURRING_ORDER_ADDRESS_CLICKED",ANe="CREATE_RECURRING_ORDER_FREQUENCY_CLICKED",bNe="CREATE_RECURRING_ORDER_TIME_CLICKED",xNe="CREATE_RECURRING_ORDER_CHOOSE_PAYMENT_BUTTON_CLICKED",RNe="EDIT_CREATED_RECURRING_ORDER_CLICKED",hr={RECURRING_ORDERS_CLICKED:ENe,CREATE_RECURRING_ORDER_BUTTON_CLICKED:fNe,LEARN_MORE_RECURRING_ORDER_BUTTON_CLICKED:yNe,CREATED_RECURRING_ORDER_EDIT_PAYMENT_BUTTON_CLICKED:INe,CREATED_RECURRING_ORDER_CANCEL_BUTTON_CLICKED:SNe,EDIT_UPCOMING_ORDERS_BUTTON_CLICKED:CNe,CREATE_RECURRING_ORDER_MODAL_DISPLAYED:TNe,CANCEL_CREATE_RECURRING_ORDER_CLICKED:_Ne,CREATE_RECURRING_ORDER_ADDRESS_CLICKED:vNe,CREATE_RECURRING_ORDER_FREQUENCY_CLICKED:ANe,CREATE_RECURRING_ORDER_TIME_CLICKED:bNe,CREATE_RECURRING_ORDER_CHOOSE_PAYMENT_BUTTON_CLICKED:xNe,EDIT_CREATED_RECURRING_ORDER_CLICKED:RNe},DNe={[hr.RECURRING_ORDERS_CLICKED]:nNe,[hr.CREATE_RECURRING_ORDER_BUTTON_CLICKED]:oNe,[hr.LEARN_MORE_RECURRING_ORDER_BUTTON_CLICKED]:rNe,[hr.CREATED_RECURRING_ORDER_EDIT_PAYMENT_BUTTON_CLICKED]:aNe,[hr.CREATED_RECURRING_ORDER_CANCEL_BUTTON_CLICKED]:iNe,[hr.EDIT_UPCOMING_ORDERS_BUTTON_CLICKED]:lNe,[hr.CREATE_RECURRING_ORDER_MODAL_DISPLAYED]:cNe,[hr.CANCEL_CREATE_RECURRING_ORDER_CLICKED]:dNe,[hr.CREATE_RECURRING_ORDER_ADDRESS_CLICKED]:uNe,[hr.CREATE_RECURRING_ORDER_FREQUENCY_CLICKED]:pNe,[hr.CREATE_RECURRING_ORDER_TIME_CLICKED]:mNe,[hr.CREATE_RECURRING_ORDER_CHOOSE_PAYMENT_BUTTON_CLICKED]:hNe,[hr.EDIT_CREATED_RECURRING_ORDER_CLICKED]:gNe},ONe=(e,t,n)=>{const o=[Rt({POSITION:"top"},t,ba.SMART_BANNER_IMPRESSION)];return bt(t,n,o)},PNe=(e,t,n)=>q({type:ba.SMART_BANNER_CLICKED,payload:{description:"The user clicked on the smart banner to open it"}},t,n),NNe=(e,t,n)=>q({type:ba.SMART_BANNER_CLOSED,payload:{description:"The user closed the smart banner"}},t,n),LNe={[ba.SMART_BANNER_CLICKED]:PNe,[ba.SMART_BANNER_CLOSED]:NNe,[ba.SMART_BANNER_IMPRESSION]:ONe},kNe="CHAT_WITH_US_SESSION_STARTED",MNe="CHAT_WITH_US_SESSION_ENDED",Yu={CHAT_WITH_US_SESSION_STARTED:kNe,CHAT_WITH_US_SESSION_ENDED:MNe},V2={[Yu.CHAT_WITH_US_SESSION_STARTED]:"The user clicked on the chat with us option to start session",[Yu.CHAT_WITH_US_SESSION_ENDED]:"The user clicked on end chat to end the session"},jNe=(e,t,n)=>q({type:e.type,payload:{description:V2.CHAT_WITH_US_SESSION_STARTED}},t,n),wNe=(e,t,n)=>q({type:e.type,payload:{description:V2.CHAT_WITH_US_SESSION_ENDED}},t,n),FNe={[Yu.CHAT_WITH_US_SESSION_STARTED]:jNe,[Yu.CHAT_WITH_US_SESSION_ENDED]:wNe},BNe={[mn]:jl(e_e,xy,gA,vTe),[JI]:jl(xy,gA),[As.PAGE_ATTRIBUTES_MULTIPLE]:wr},UNe=[BNe,B_e,ERe,U_e,fPe,V_e,z_e,_ve,Uve,Zve,nAe,aAe,bAe,FAe,GAe,nbe,dbe,ybe,sNe,Cbe,Rbe,Pbe,Mbe,Hbe,Vbe,txe,oxe,Sxe,Fxe,Kxe,Zxe,VRe,fDe,CDe,DDe,wDe,FOe,sPe,yOe,LOe,hPe,IPe,CPe,bPe,jPe,JPe,DNe,FNe,LNe],GNe=UNe.reduce((e,t)=>(Object.keys(t).forEach(n=>{e[n]=e[n]?jl(e[n],t[n]):t[n]}),e),{}),$Ne=D("beacon"),HNe=3,VNe=1e3,h_=(e,t)=>{Me.api.pushError(new Error(e),{context:{error:JSON.stringify(t)}})};async function EA(e,t=HNe,n=VNe){try{return await e()}catch(o){if(t>0)return await new Promise(r=>setTimeout(r,n)),EA(e,t-1,n*2);throw o}}class YNe{#e=null;impressionsHandler=new v1({maxQueueLength:20,flushIntervalMs:500,onFlush:t=>this.handleBatchedEvents(t)});eventPromises;constructor(){this.eventPromises=[],document.readyState!=="complete"&&window.addEventListener("load",this.resolveEventPromises)}set getState(t){this.#e=t}get state(){return this.#e?this.#e():null}handleBeaconApiEventEnabled=()=>{const{state:t}=this;return!!t&&$Ne(t)};handleBatchedEvents=async t=>{const n=t.reduce((r,a)=>(r[a.targetUrl]||(r[a.targetUrl]=[]),r[a.targetUrl]?.push(a.body),r),{}),o=Object.entries(n).map(([r,a])=>this.handleBeaconApiEventEnabled()&&"sendBeacon"in navigator?this.sendBatchedEventsBeacon({targetUrl:r,body:a}):this.sendBatchedEventsPromise({targetUrl:r,body:a}));try{await Promise.all(o)}catch(r){h_("handleBatchedEvents: Failed operation after all retries",r)}};sendBatchedEventsPromise=async({targetUrl:t,body:n})=>{const o=()=>fetch(`${t}/v1/events`,{body:JSON.stringify(n),headers:{"Content-Type":"application/json",Accept:"text/plain, */*; q=0.01"},method:"POST"}).then(r=>{if(!r.ok)throw new Error(`Fetch Failed with status ${r.status}`)});try{await EA(o)}catch(r){h_("sendBatchedEventsPromise: Failed operation after all retries",r)}};sendBatchedEventsBeacon=async({targetUrl:t,body:n})=>{const o=JSON.stringify(n),r={type:"application/json"},a=new Blob([o],r),i=()=>new Promise((l,c)=>{const d=navigator.sendBeacon(`${t}/v1/events`,a);d?l(d):c(new Error("Beacon send failed"))});try{await EA(i)}catch(l){h_("sendBatchedEventsBeacon: Failed operation after all retries",l),await this.sendBatchedEventsPromise({targetUrl:t,body:n})}};sendEvent=t=>this.impressionsHandler.enqueue(t);resolveEventPromises=()=>{this.eventPromises.map((t,n)=>t(n)),this.eventPromises=[]};dispatchEvents=t=>Promise.all(t.map(({body:n,targetUrl:o})=>{if(n){if(document.readyState==="complete")return this.sendEvent({targetUrl:o,body:n});this.eventPromises.push(()=>this.sendEvent({targetUrl:o,body:n}))}return Promise.resolve()}))}const Vj=window?.__INITIAL_STATE__,WNe=Vj?D("wab")(Vj):!1,Yj=WNe?new YNe:new oTe,qNe=e=>(Yj.getState=e.getState,t=>n=>x$.createMiddleware(GNe,Yj.dispatchEvents)(e)(t)(n)),Y2=()=>"/out-of-stock",KNe=(e,t)=>e&&t&&e!==t,zNe=()=>{window&&window.location.reload()},QNe=(e,{regionId:t})=>{const n=Wt(e),{pathname:o}=e.router.location,r=hn(e),a=t,l=[yd(n),pp(n),Y2()].includes(o);KNe(r,a)&&!l&&zNe()},RR={handleBasketRegion:QNe},W2={INVALID_SLOT:"INVALID_SLOT"};function Cs(e){return E(n=>n.retailerSettings[e])}const XNe=({children:e,assetPath:t})=>{const n=Cs("theme-asset-version"),[o]=ip(),r=o.get("themeAssetVersion"),a=t??`/theme-assets/${r||n}/icons/icons.svg`;return s.jsx(Qoe,{src:a,children:e})},T="default"in r_?r_.default:r_,Ke={xs:0,sm:36,md:48,lg:62},OE=e=>(...t)=>De`
        @media (min-width: ${Ke[e]}em) {
            ${De(...t)}
        }
    `,g_=(e,t)=>(...n)=>De`
        @media (min-width: ${Ke[e]}em) {
            @media not all and (min-width: ${Ke[t]}em) {
                ${De(...n)}
            }
        }
    `,oe={xs:g_("xs","sm"),sm:g_("sm","md"),md:g_("md","lg"),xsUp:OE("xs"),smUp:OE("sm"),mdUp:OE("md"),lgUp:OE("lg")},or={"xs-up":{mediaQueryKey:"xsUp",breakpointKey:"xs"},"sm-up":{mediaQueryKey:"smUp",breakpointKey:"sm"},"md-up":{mediaQueryKey:"mdUp",breakpointKey:"md"},"lg-up":{mediaQueryKey:"lgUp",breakpointKey:"lg"}},Hi={xs:`(min-width: ${Ke.xs}em) and (max-width: ${Ke.sm-.01}em)`,sm:`(min-width: ${Ke.sm}em) and (max-width: ${Ke.md-.01}em)`,md:`(min-width: ${Ke.md}em) and (max-width: ${Ke.lg-.01}em)`,lg:`(min-width: ${Ke.lg}em)`},Ln={1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10},Qt={icon:Ln[1],badge:Ln[1],select:Ln[1],"fop-overlay":Ln[2],"fop-options":Ln[3],dropdown:Ln[4],"bottom-bar":Ln[5],"sticky-add-button":Ln[4],header:Ln[5],popup:Ln[6],headerWithOverlay:Ln[7],"nav-button":Ln[5],"top-tabs":Ln[6],"content-block-header":Ln[6],overlay:Ln[7],"collapsible-box":Ln[7],"nav-menu":Ln[8],"dialog-close":Ln[9],"skip-link":Ln[10]},ZNe=De`
    :root {
        --z-index-icon: 1;
        --z-index-badge: 1;
        --z-index-select: 1;
        --z-index-carousel: 1;
        --z-index-fop-overlay: 2;
        --z-index-fop-options: 3;
        --z-index-dropdown: 4;
        --z-index-bottom-bar: 4;
        --z-index-sticky-add-button: 4;
        --z-index-header: 5;
        --z-index-popup: 6;
        --z-index-nav-button: 5;
        --z-index-top-tabs: 6;
        --z-index-content-block-header: 6;
        --z-index-search-suggestion: 6;
        --z-index-overlay: 7;
        --z-index-collapsible-box: 7;
        --z-index-header-with-overlay: 7;
        --z-index-nav-menu: 8;
        --z-index-dialog-close: 9;
        --z-index-notification: 9;
        --z-index-skip-link: 10;
    }
`,JNe=87.5,eLe=()=>parseFloat(typeof window<"u"&&window.getComputedStyle(document.documentElement).fontSize)||14,tLe=()=>eLe()*(100/JNe),sLe=De`
    html {
        overflow-x: hidden;
    }

    body {
        background-color: var(--background-color);
        line-break: strict;
    }

    /* stylelint-disable-next-line selector-class-pattern */
    .site--content {
        flex: 1 0 auto;
    }

    /* stylelint-disable-next-line selector-class-pattern */
    .ReactModal__Body--open {
        block-size: 100%;
        overflow: hidden;
        position: fixed;
        inline-size: 100%;
    }

    .scroll-locked {
        position: relative;
        overflow: hidden;
    }

    iframe {
        border: none;
    }

    ${ZNe}
`,nLe="Xs",oLe="Sm",rLe="SmUp",aLe="Md",iLe="MdUp",lLe="Lg",E_={},Vi=e=>{const t=tLe();if(E_[`${t}-${e}`])return E_[`${t}-${e}`];const n=Xoe(Zoe(e,t));return E_[`${t}-${e}`]=n,n},cLe=()=>typeof window<"u"&&Vi(window.innerWidth)<Ke.sm,q2=()=>typeof window<"u"&&Vi(window.innerWidth)>=Ke.sm&&Vi(window.innerWidth)<Ke.md,K2=()=>typeof window<"u"&&Vi(window.innerWidth)>=Ke.sm,z2=()=>typeof window<"u"&&Vi(window.innerWidth)>=Ke.md&&Vi(window.innerWidth)<Ke.lg,Q2=()=>typeof window<"u"&&Vi(window.innerWidth)>=Ke.md,X2=()=>typeof window<"u"&&Vi(window.innerWidth)>=Ke.lg,dLe=()=>{let e=nLe;return q2()?e=oLe:K2()?e=rLe:z2()?e=aLe:Q2()?e=iLe:X2()&&(e=lLe),e},uLe={getViewport:dLe,isXs:cLe,isSm:q2,isSmUp:K2,isMd:z2,isMdUp:Q2,isLg:X2,pxToEm:Vi},f_={50:.12,100:.3,200:.5,300:.7,400:.85,600:.13,700:.3,800:.46,900:.75},pLe=e=>{let[,t,n,o,r,a,i]=e;return e.length===4&&([,t,o,a]=e,[,n,r,i]=e),[`${t}${n}`,`${o}${r}`,`${a}${i}`].map(c=>parseInt(c,16))},mLe=e=>{const{red:t,green:n,blue:o}=Joe(e);return ere(parseInt(t**2/255,10),parseInt(n**2/255,10),parseInt(o**2/255,10))},Wj=(e,t)=>{if(f_[t]){if(t>400){const o=mLe(e);return sj(1-f_[t],e,o)}return sj(f_[t],e,"#ffffff")}return e},hLe=(e,t="#000",n="#fff")=>{const[o,r,a]=pLe(e);return(o*299+r*587+a*114)/1e3<128?n:t};T.div`
    align-items: center;
    background-color: ${e=>Wj(e.color,e.tone)};
    color: ${e=>hLe(Wj(e.color,e.tone))};
    display: flex;
    padding: 20px;
`;const jn={sm:30,md:40,lg:50},cu={xs:4,sm:8},Ny=42,Z2=45,ra={v2:{sm:jn.lg+cu.xs*2+jn.md+cu.xs*2+cu.xs*2+1,lgUp:jn.md+cu.xs*2+jn.sm+cu.sm*2+cu.xs*2+1}},H=e=>R$(parseFloat(e),14),DR=De`
    border: 0;
    clip: rect(0 0 0 0);
    block-size: 1px;
    margin: -1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    inline-size: 1px;
`,qj=(e,t)=>`
    ::-webkit-scrollbar {
        inline-size: 20px;
        block-size: 27px;
    }

    ::-webkit-scrollbar-track {
        border-radius: 12px;
    }

    ::-webkit-scrollbar-thumb {
        border-radius: 18px;
        background-color: ${e};
        border: 6px solid ${t};
    }

    ::-webkit-scrollbar-button {
        inline-size: 0;
        block-size: 0;
        display: none;
    }

    ::-webkit-scrollbar-corner {
        background-color: transparent;
    }
`,gLe={fill:p.string,height:p.number,hidden:p.string,name:p.string.isRequired,info:p.bool,success:p.bool,primary:p.bool,warning:p.bool,error:p.bool,width:p.number,verticalAlign:p.string,visible:p.string,source:p.string,lineHeight:p.oneOfType([p.string,p.number])},ELe=({fill:e,info:t,success:n,primary:o,warning:r,error:a})=>t?"var(--intent-secondary-900)":n?"var(--intent-success)":o?"var(--intent-primary)":r?"var(--intent-warning)":a?"var(--intent-error)":e,J2=T.svg.withConfig({shouldForwardProp:(e,t)=>!["name","fill","height","width","type"].includes(e)&&t(e)}).attrs(({name:e,"data-test":t})=>({"data-test":t||`icon__${e}`,"data-icon":`icon__${e}`}))`
    line-height: ${e=>e.lineHeight};
    vertical-align: ${e=>e.verticalAlign};
    display: inline-block;
    fill: ${ELe};
    block-size: ${({height:e})=>typeof e=="string"?e:H(e)};
    min-block-size: ${({height:e})=>typeof e=="string"?e:H(e)};
    inline-size: ${({width:e})=>typeof e=="string"?e:H(e)};
    min-inline-size: ${({width:e})=>typeof e=="string"?e:H(e)};

    [dir="rtl"] &[data-icon="icon__arrow_left"],
    [dir="rtl"] &[data-icon="icon__arrow_right"]
    {
        transform: scaleX(-1);
    }



    ${({visible:e,hidden:t})=>e||t?[oe[e||t]`
                  display: ${e?"inline-block":"none"}`,`display: ${e?"none":"inline-block"}`]:null};
`,fLe=({title:e,...t})=>s.jsxs(J2,{...t,children:[e?s.jsx("title",{children:e}):null,s.jsx("use",{href:t.source})]}),vp=T(fLe)``;vp.displayName="Icon";const eY={fill:"currentColor",height:20,width:20,lineHeight:0};J2.defaultProps=eY;vp.defaultProps=eY;vp.propTypes=gLe;const me=e=>{const t=tre(e.name);return s.jsx(vp,{source:t,...e})},tY=T.button`
    inline-size: 100%;
    border: none;
    align-items: center;
    background-color: var(--intent-contrast);
    border-block-end: ${({active:e})=>e?"var(--salt-border-1) solid var(--intent-secondary)":0};
    border-radius: var(--salt-radius-default);
    cursor: pointer;
    display: flex;
    font-weight: 700;
    block-size: ${H(jn.lg)};
    margin-inline: 0;
    margin-block: 0 ${({active:e})=>e?"0":"var(--salt-spacing-1)"};
    padding-inline: var(--salt-spacing-2);
    padding-block: 0;
`;tY.displayName="AccordionTitle";const sY=T(me)`
    block-size: ${H(18)};
    margin-inline-start: auto;
    transform: ${({active:e})=>e?"rotate(180deg)":"rotate(0deg)"};
    transition: 0.3s transform ease-in-out;
    inline-size: ${H(18)};
`;sY.displayName="AccordionIcon";const nY=T.section`
    block-size: ${({active:e})=>e?"auto":"0px"};
    overflow: hidden;
    padding: ${({active:e})=>e?"var(--salt-spacing-4)":0};
`;nY.displayName="AccordionContent";const bf={StyledAccordionTitle:tY,StyledIcon:sY,StyledAccordionContent:nY},yLe={href:p.string,to:p.string,width:p.oneOfType([p.string,p.number]),images:p.arrayOf(p.shape({url:p.string.isRequired,width:p.number.isRequired,height:p.number.isRequired})).isRequired},ILe={width:"auto",href:void 0,to:void 0},SLe=1e4,y_=e=>e/3,PE=(e,t,n)=>{const o=e.find(a=>y_(a.width)>=t&&y_(a.width)<n)||{url:"none",height:0},r=y_(o.height);return`
        background-image: url(${o.url});
        block-size: ${H(r)};
        background-size: auto ${r}px;
    `},OR=T.a.withConfig({shouldForwardProp:e=>!["width","images"].includes(e)})`
    background-color: var(--intent-secondary-100);
    background-repeat: no-repeat;
    background-position: center;
    cursor: pointer;
    display: block;
    inline-size: ${({width:e})=>e};
    margin-block: 0 var(--salt-spacing-4);
    margin-inline: var(--salt-spacing-2);
    border-radius: var(--border-radius);

    ${({images:e})=>PE(e,Ke.xs*16,Ke.sm*16)}

    ${oe.smUp`
        ${({images:e})=>PE(e,Ke.sm*16,Ke.md*16)}
    `}

    ${oe.mdUp`
        ${({images:e})=>PE(e,Ke.md*16,Ke.lg*16)}
    `}

    ${oe.lgUp`
        ${({images:e})=>PE(e,Ke.lg*16,SLe)}
    `};
`;OR.propTypes=yLe;OR.defaultProps=ILe;const oY=T.div`
    display: flex;
    min-block-size: 50vi;
    min-inline-size: 100%;
    margin-block-end: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-2);

    ${oe.smUp`
        flex-basis: 50%;
        flex-grow: 2;
        min-block-size: ${H(270)};
        min-inline-size: ${H(400)};
        margin-block-start: calc(${H(20)} + var(--salt-spacing-2));
    `}

    ${oe.mdUp`
        flex-basis: 40%;
    `}

    ${oe.lgUp`
        flex-basis: ${Ke.lg/5*2}rem;
    `}
`;oY.displayName="AdvertisingBanner";const rY=T.div`
    position: relative;
    inline-size: 100%;
    block-size: 100%;
    border-radius: var(--border-radius);
    overflow: hidden;

    > a {
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
        block-size: 100%;
        position: absolute;
        inline-size: 100%;
    }

    img {
        block-size: 100%;
        object-fit: cover;
        object-position: center;
        inline-size: 100%;
    }
`;rY.displayName="AdvertisingBannerContent";const aY={AdvertisingBanner:oY,AdvertisingBannerContent:rY},CLe=e=>{const t=E(Wt);return e&&e.startsWith("/")?`${t||""}${e}`:e},TLe=()=>{const t=`(${M().formatMessage("accessibility.link.open.in.new.window")})`;return s.jsx(Ee,{children:t})},_Le=({children:e,target:t=""})=>s.jsxs(h.Fragment,{children:[e,t==="_blank"&&s.jsx(TLe,{})]}),rt=h.forwardRef((e,t)=>{const{children:n,target:o,rel:r,size:a,standalone:i,intent:l,asChild:c,href:d,...u}=e,m=CLe(d),g=o==="_blank"?"noopener noreferrer":r,f=c?n:s.jsx(_Le,{target:o,children:n});if(l==="ghost"){const{bold:y,...I}=u;return s.jsx(nj,{href:m,ref:t,intent:l,asChild:c,rel:g,target:o,...I,children:f})}return s.jsx(nj,{href:m,ref:t,size:a,standalone:i,intent:l,asChild:c,rel:g,target:o,...u,children:f})}),vLe=T.ul`
    list-style: none;
    margin: 0;
    padding: 0;
`,ALe=T.li`
    display: none;
    vertical-align: middle;

    &:nth-last-child(-n + 2) {
        display: inline-block;
    }

    ${oe.smUp`
        display: inline-block;
    `};
`,PR=T(ne)`
    display: inline-block;
    font-size: var(--salt-text-m-font-size);
    vertical-align: middle;
    margin: 0;

    ${oe.smUp`
        font-size: var(--salt-display-font-size);
    `};
`;PR.defaultProps={as:"h1"};const bLe=T(PR)`
    font-size: var(--salt-display-font-size);
`,xLe=T(rt).attrs({standalone:!0})`
    display: inline-block;

    && {
        font-weight: bold;
        vertical-align: middle;

        &:hover,
        &:active {
            font-weight: bold;
        }
    }
`,RLe=T(me)`
    margin-block: 0;
    margin-inline: var(--salt-spacing-1);
    vertical-align: middle;
    inline-size: ${H(20)};
`,DLe={List:vLe,Item:ALe,CurrentBreadcrumbText:PR,HeadingBreadcrumb:bLe,BreadcrumbLinkComponent:xLe,Chevron:RLe},OLe=T.section`
    display: flex;
    margin: calc(-1 * var(--salt-spacing-2));
    flex-wrap: wrap;
    transform: translateZ(0);
`,PLe={CardSection:OLe},NLe=De`
    display: flex;
    margin: var(--salt-spacing-2);
    position: relative;
    inline-size: ${({xs:e})=>`calc(${100/e}% - var(--salt-spacing-4))`};

    ${oe.smUp`
        inline-size: ${({sm:e})=>`calc(${100/e}% - var(--salt-spacing-4))`};
    `}

    ${oe.mdUp`
        inline-size: ${({md:e})=>`calc(${100/e}% - var(--salt-spacing-4))`};
    `};

    ${oe.lgUp`
        inline-size: ${({lg:e})=>`calc(${100/e}% - var(--salt-spacing-4))`};
    `}
`,NR=e=>{switch(e){case"start":case"left":return"start";case"end":case"right":return"end";default:return e}},LLe=T.article`
    ${NLe};
    align-self: stretch;
    background-color: var(--intent-contrast);
    border-radius: var(--border-radius);
    color: ${({muted:e})=>e?"var(--intent-content)":""};
    flex-direction: column;
    justify-content: center;
    padding: var(--salt-spacing-4);
    text-align: ${e=>NR(e.align)||"center"};
`,kLe=T.div`
    align-items: center;
    display: flex;
    justify-content: center;
    text-align: center;
    margin-inline: 0;
    margin-block: 0 var(--salt-spacing-2);
    ${vp} {
        margin-inline-end: var(--salt-spacing-2);
    }
`,MLe=T.h2`
    font-size: var(--salt-display-font-size);
    margin: 0;
    ${({singleLine:e})=>e&&De`
            text-align: start;
            white-space: pre;
            text-overflow: ellipsis;
            overflow: hidden;
            inline-size: 100%;
            padding-inline-end: var(--salt-spacing-4);
        `}
`,jLe=T.div`
    margin-block-end: var(--salt-spacing-1);
    overflow-wrap: anywhere;
    padding-block-end: var(--salt-spacing-2);
    ${({align:e})=>e?`text-align: ${NR(e)};`:""}
`,wLe=T.div`
    margin-block-start: auto;
    ${({align:e})=>e?`text-align: ${NR(e)};`:""}
`,FLe=T.div`
    position: absolute;
    inset-block-start: 5px;
    inset-inline-end: 5px;

    &:hover {
        cursor: pointer;
    }
`,BLe={Body:jLe,CardWrapper:LLe,Footer:wLe,Header:kLe,HeaderText:MLe,Options:FLe},iY=e=>e==="small"?`
        min-inline-size: ${H(243)};
        max-inline-size: ${H(493)};
        `:`min-inline-size: ${H(328)};
  max-inline-size: ${H(663)};`,ULe=Yl`
    0% {
        transform: translateX(0);
    }

    50% {
        transform: translateX(${H(4)});
    }

    100% {
        transform: translateX(0);
    }
`,lY=T(me)`
    align-self: center;
    position: absolute;
    inset-block-start: calc(50% - ${({height:e})=>H(Number(e||20)/2)});
    inset-inline-end: 0%;
`,GLe=T(rt).attrs({intent:"ghost"})`
    display: block;

    &:hover {
        text-decoration: none;
    }

    &:active {
        text-decoration: none;
    }

    block-size: 100%;
    ${({formatting:e})=>iY(e)}
`,$Le=T.div`
    display: flex;
    flex-direction: column;
    transition: box-shadow 0.2s;
    border-radius: var(--salt-radius-default);
    background-color: var(--intent-contrast);

    &:hover {
        box-shadow: var(--salt-elevation-shadow-1);

        ${lY} {
            animation: ${ULe} 0.8s ease-in-out;
        }
    }

    overflow: hidden;
    block-size: 100%;
`,HLe=T.div`
    position: relative;
    margin-block: ${({variant:e})=>e==="default"?"var(--salt-spacing-4) 0":"0"};
    margin-inline: ${({variant:e})=>e==="default"?"var(--salt-spacing-4)":"0"};
`,VLe=T.img`
    block-size: ${H(144)};
    object-fit: cover;
    object-position: center;
    inline-size: 100%;
    vertical-align: middle;
`,YLe=T.div`
    display: block;
    position: relative;
    block-size: 100%;
    margin-block: var(--salt-spacing-2);
    margin-inline: var(--salt-spacing-4);
    padding-inline-end: ${H(20)};
    white-space: initial;
    word-break: break-word;
`,WLe=T(P).attrs(()=>({bold:!0,size:"l"}))`
    display: block;
    line-height: normal;
`,qLe=T(P)`
    display: block;
    margin-block-start: var(--salt-spacing-1);
    line-height: normal;
`,KLe=T.div`
    ${({formatting:e})=>iY(e)}
`,zLe=T(Pe)`
    block-size: ${H(144)};
`,QLe=T(Pe)`
    block-size: ${H(18)};
    inline-size: ${H(192)};
`,XLe=T(Pe)`
    block-size: ${H(16)};
    inline-size: ${H(111)};
    margin-block-start: var(--salt-spacing-1);
`,ZLe={Base:GLe,Body:$Le,ImageWrapper:HLe,StyledImage:VLe,TitleWrapper:YLe,Chevron:lY,Content:qLe,Title:WLe,BasePlaceholder:KLe,ImagePlaceholder:zLe,TitlePlaceholder:QLe,ContentPlaceholder:XLe},JLe=e=>e==="small"?243:328,eke=e=>e==="auto-fill"?"auto-fill":"auto-fit",tke=T.div`
    display: grid;
    grid-template-columns: ${({formatting:e,gridVariant:t})=>`repeat(${eke(t)}, minmax(${H(JLe(e))}, 1fr))`};
    grid-gap: var(--salt-spacing-4);
`,ske={MediaCardSection:tke},gg={Collection:PLe,Action:BLe,MediaNavigation:ZLe,MediaCollection:ske},NE={xs:"var(--salt-spacing-1)",sm:"calc(var(--salt-spacing-1) + var(--salt-spacing-2) / 2)",md:"var(--salt-spacing-2)"},nke=T.section`
    overflow: hidden;
    position: relative;
    display: flex;
    gap: var(--salt-spacing-4);
    flex-direction: column-reverse;
`,oke=T.div`
    display: flex;
    justify-content: center;
    align-items: center;
`,rke=T.ul`
    display: flex;
    align-self: stretch;
    flex-direction: row;
    list-style: none;
    padding: 0;
    margin: 0;
    gap: var(--salt-spacing-2);
    transition: all 250ms linear;
    justify-content: ${({isOverflowing:e})=>e?"center":"flex-start"};
    inline-size: 100%;
`,ake=T.li`
    flex-basis: ${({applyEqualWidth:e})=>e?"min-content":"100%"};
    flex-shrink: 0;
    transition: all 1ms;
`,ike=T.div`
    -ms-overflow-style: none;
    overflow: hidden;
    padding: 0;
    display: flex;
    align-items: center;
    border-radius: var(--border-radius);
`,lke=T.div`
    display: flex;
    align-items: center;
    padding-block: 0;
    padding-inline: var(--salt-spacing-8);
    gap: var(--salt-spacing-05);
`,cke=T.div`
    display: flex;
    overflow: auto;
    flex-direction: row;
    align-items: center;
    padding: var(--salt-spacing-2);
    gap: var(--salt-spacing-2);
    -ms-overflow-style: none;

    & > * {
        transition: all 250ms linear;
    }
`,dke=T.div`
    min-block-size: ${({size:e})=>NE[e]||NE.md};
    min-inline-size: ${({size:e})=>NE[e]||NE.md};
    border-radius: 50%;
    background-color: ${({active:e})=>e?"var(--intent-primary-900)":"var(--intent-secondary-900)"};
`,PS={Container:nke,Controls:oke,Body:ike,ControlsInnerContainer:lke,ItemsContainer:rke,Item:ake,IndicatorContainer:cke,Dot:dke},uke=h.forwardRef((e,t)=>{const{formatMessage:n}=M(),o=n("button.loading.aria.label");return s.jsx(eh,{...e,"aria-label":e.loading?o:e["aria-label"],ref:t})}),b={...uke,Icon:eh.Icon,Text:eh.Text};b.Icon=eh.Icon;b.Text=eh.Text;const pke=T.div`
    align-items: stretch;
    border-radius: var(--salt-radius-default);
    display: flex;
    block-size: ${({size:e})=>H(jn[e])};
    justify-content: center;
`,mke=T.input`
    min-inline-size: ${H(35)};
    block-size: 100%;
    border: none;
    padding-block: 0;
    padding-inline: var(--salt-spacing-2);
    background-color: var(--intent-contrast);
    text-align: center;
    font-size: var(--salt-text-l-font-size);
    font-weight: 600;
    font-family: var(--font-family);
    appearance: textfield;

    &::-webkit-outer-spin-button,
    &::-webkit-inner-spin-button {
        appearance: none;
        margin-inline: 0;
        margin-block: 0;
    }
`,hke=T.div`
    align-items: center;
    background-color: var(--intent-contrast);
    display: flex;
    flex: 1 0 20%;
    justify-content: center;
`,LR=T(b)`
    max-inline-size: 100%;
    inline-size: ${({fullWidth:e,text:t,size:n})=>e===!0||t?"100%":H(jn[n??"md"])};
    min-inline-size: ${({size:e})=>H(jn[e])};
    ${oe.smUp`
        ${({text:e,fullWidth:t})=>e&&t===!1&&"inline-size: auto;"}
    `}
    background-color: ${({disabled:e})=>e?"var(--intent-action-50)":"var(--intent-action)"};
    border: var(--salt-border-1) solid
        ${({disabled:e})=>e?"var(--intent-action-50)":"var(--intent-action)"};
    flex: 1 0 auto;
    white-space: nowrap;
    color: ${({disabled:e})=>e?"var(--intent-content-200)":"var(--intent-action-contrast)"};
    touch-action: manipulation;

    &:hover:enabled {
        background-color: var(--intent-action-900);
        border-color: var(--intent-action-900);
        color: var(--intent-action-900-contrast);
    }
`,gke=T(LR)`
    background-color: ${({disabled:e})=>e?"var(--intent-action-50)":"var(--intent-action-200)"};
    border: var(--salt-border-1) solid
        ${({disabled:e})=>e?"var(--intent-action-50)":"var(--intent-action-200)"};
    color: ${({disabled:e})=>e?"var(--intent-content-200)":"var(--intent-action-200-contrast)"};

    &:hover:enabled {
        background-color: var(--intent-action-900);
        border-color: var(--intent-action-900);
        color: var(--intent-action-900-contrast);
    }

    border-start-end-radius: 0;
    border-end-end-radius: 0;
    border-inline-end-width: 0;
    border-start-start-radius: var(--salt-radius-default);
    border-end-start-radius: var(--salt-radius-default);
`,Eke=T(LR)`
    border-start-start-radius: 0;
    border-end-start-radius: 0;
    border-inline-start-width: 0;
    border-start-end-radius: var(--salt-radius-default);
    border-end-end-radius: var(--salt-radius-default);
`,Si={Container:pke,CountInput:mke,CountInputContainer:hke,Operator:LR,OperatorLeft:gke,OperatorRight:Eke},cY={disabled:.4},fke=T.div`
    position: relative;
`,dY=T.div`
    background-color: var(--intent-contrast);
    box-shadow: var(--salt-elevation-shadow-1);
    min-block-size: ${H(340)};
    margin-block-start: var(--salt-spacing-2);
    overflow: hidden;
    padding-block: ${H(20)};
    padding-inline: ${H(22)};
    position: absolute;
    inline-size: ${H(296)};
    inset-inline-end: ${`calc(50% - ${H(296/2)})`};
    z-index: ${Qt.dropdown};
    border-radius: var(--salt-radius-default);
`;dY.displayName="DatePicker-Container";const yke=T.div`
    display: flex;
    line-height: 1;
    block-size: ${H(36)};
    margin-block: 0 ${H(8)};
    margin-inline-end: 0;
    inline-size: 100%;
`,uY=T.div`
    align-items: center;
    display: flex;
    flex-grow: 1;
    font-weight: bold;
    justify-content: center;
    text-transform: uppercase;
`;uY.displayName="DatePicker-Month";const pY=T.button`
    align-items: center;
    background-color: inherit;
    border-radius: var(--salt-radius-default);
    cursor: pointer;
    display: flex;
    block-size: ${H(36)};
    justify-content: center;
    inline-size: ${H(36)};
    padding: 0;
`;pY.displayName="DatePicker-MonthArrow";const Ike=T.table`
    border-spacing: 0;
    position: relative;
`,mY=T.tr`
    display: flex;
    justify-content: space-between;
    text-align: center;
`;mY.displayName="DatePicker-Row";const kR=T.td`
    align-items: center;
    background-color: ${({selected:e})=>e?"var(--intent-primary)":"transparent"};
    border: var(--salt-border-1) solid;
    border-color: ${({selected:e})=>e?"var(--intent-primary)":"transparent"};
    border-start-start-radius: var(--border-radius);
    border-start-end-radius: ${({selected:e})=>e?0:"var(--border-radius)"};
    border-end-end-radius: ${({selected:e})=>e?0:"var(--border-radius)"};
    border-end-start-radius: var(--border-radius);
    color: ${({selected:e})=>e?"var(--intent-primary-contrast)":"var(--intent-content)"};
    cursor: pointer;
    display: flex;
    font-size: var(--salt-text-s-font-size);
    font-weight: bold;
    block-size: ${H(36)};
    justify-content: center;
    opacity: ${({muted:e})=>e?cY.disabled:1};
    padding-block: ${H(3)};
    padding-inline: ${H(6)};
    pointer-events: ${({muted:e})=>e?"none":"auto"};
    text-transform: uppercase;
    inline-size: ${H(36)};

    &:hover {
        border-color: ${({muted:e})=>e?"transparent":"var(--intent-primary)"};
    }
`;kR.displayName="DatePicker-Item";const hY=T(kR)`
    border-color: var(--intent-primary);
    border-inline-start: 0;
    border-start-start-radius: 0;
    border-start-end-radius: ${({last:e})=>e?"var(--border-radius)":"0"};
    border-end-end-radius: ${({last:e})=>e?"var(--border-radius)":"0"};
    border-end-start-radius: 0;
    border-inline-end-width: ${({last:e})=>e?`${H(1)}`:"0"};
    border-inline-end-style: solid;
`;hY.displayName="DatePicker-HighlightedItem";const gY=T.th`
    align-items: center;
    background-color: ${({selected:e})=>e?"var(--intent-primary)":"transparent"};
    border: var(--salt-border-1) solid;
    border-color: ${({selected:e})=>e?"var(--intent-primary)":"transparent"};
    border-start-start-radius: var(--border-radius);
    border-start-end-radius: ${({selected:e})=>e?0:"var(--border-radius)"};
    border-end-end-radius: ${({selected:e})=>e?0:"var(--border-radius)"};
    border-end-start-radius: var(--border-radius);
    color: ${({selected:e})=>e?"var(--intent-primary-contrast)":"var(--intent-content)"};
    cursor: auto;
    display: flex;
    font-size: var(--salt-text-s-font-size);
    font-weight: bold;
    block-size: ${H(36)};
    justify-content: center;
    opacity: ${({muted:e})=>e?cY.disabled:1};
    padding-block: ${H(3)};
    padding-inline: ${H(6)};
    pointer-events: ${({muted:e})=>e?"none":"auto"};
    text-transform: uppercase;
    inline-size: ${H(36)};

    &:hover {
        border-color: transparent;
    }
`;gY.displayName="DatePicker-ItemColumnTitle";const Ske=T.div`
    border: var(--intent-secondary) solid;
    border-block-start-width: var(--salt-border-1);
    border-inline-start-width: 0;
    border-inline-end-width: 0;
    border-block-end-width: 0;
    margin-block-start: var(--salt-spacing-2);
    padding-block-start: var(--salt-spacing-2);
    text-align: center;
`,Cke=T.button`
    border: 0;
    padding: 0;
    text-align: center;
    background-color: inherit;
    color: inherit;
    inline-size: ${({fillSpace:e})=>e?"100%":""};
    block-size: ${({fillSpace:e})=>e?"100%":""};
    cursor: pointer;

    &:hover {
        ${({available:e})=>e&&"cursor: pointer"};
        ${({available:e})=>e&&`
            background-color: var(--intent-primary-100)
        `};
        text-decoration: ${({underline:e})=>e?"underline":"none"};
    }

    &:active {
        color: inherit;
        font-weight: inherit;
        text-decoration: none;
    }
`,Tke={Container:fke,DatePickerContainer:dY,MonthContainer:yke,Month:uY,MonthArrow:pY,DatePickerTable:Ike,Row:mY,Item:kR,HighlightedItem:hY,ItemColumnTitle:gY,Footer:Ske,EmptyButton:Cke},pe=T.dl`
    margin: 0;
    -webkit-margin-after: 0;
    -webkit-margin-before: 0;

    > div {
        display: flex;
    }
`,Ly={xs:1,sm:2,md:4,lg:8,xl:16,xxl:32},_ke=T.dt`
    flex: 1 1 auto;
    padding-block: ${({padding:e})=>e?`0 var(--salt-spacing-${Ly[e]})`:0};
    padding-inline: ${({padding:e})=>e?`0 var(--salt-spacing-${Ly[e]})`:0};
    text-align: ${({align:e})=>e||"start"};
    ${({hyphenate:e})=>e&&"hyphens: auto;word-break: break-word;"}
`,vke=e=>{switch(e){case"left":case"start":return"start";case"right":case"end":return"end";default:return e}},Ake=T.dd`
    -webkit-margin-start: 0;
    flex: 1 1 auto;
    font-weight: 600;
    padding-block: ${({padding:e})=>e?`0 var(--salt-spacing-${Ly[e]})`:0};
    padding-inline: ${({padding:e})=>e?`var(--salt-spacing-${Ly[e]}) 0`:0};
    text-align: ${({align:e})=>vke(e)||"end"};
    white-space: ${({nowrap:e})=>e?"nowrap":"normal"};
`;pe.DescriptionListTitle=_ke;pe.DescriptionListDescription=Ake;const bke=T.div`
    padding-block: var(--salt-spacing-4);
    padding-inline: var(--salt-spacing-1);
`,xke=T.div`
    padding-block: 0;
    padding-inline: var(--salt-spacing-2);

    ${oe.smUp`
        padding-block: var(--salt-spacing-4);
        padding-inline: var(--salt-spacing-2);
    `}
`,Rke=T.div`
    padding-block: 0;
    padding-inline: var(--salt-spacing-2);
`,Dke=T.div`
    display: flex;
    padding-block-start: var(--salt-spacing-2);
    justify-content: space-between;

    ${oe.lgUp`
        justify-content: flex-start;
    `};
`,Oke=T.div.withConfig({shouldForwardProp:(e,t)=>!["display"].includes(e)&&t(e)})`
    display: none;
    flex-wrap: wrap;
    ${({breakpoint:e})=>oe[or[e].mediaQueryKey]`
                display: ${({display:t})=>t||"block"};
            `};
`,Pke=T.div`
    inline-size: ${H(250)};

    a {
        text-decoration: none;
    }
`,Nke=T.div`
    margin-inline-start: ${e=>e.right?"auto":0};
`,In=T.footer`
    border-block-start: var(--salt-border-1) solid var(--intent-secondary);
    margin-block-start: var(--salt-spacing-8);
`;In.Leading=bke;In.Body=xke;In.Supplementary=Rke;In.Row=Dke;In.List=Pke;In.Image=Nke;In.Visible=Oke;const Lke={justify:p.oneOf(["flex-start","flex-end","center","space-between","space-around","initial","start","inherit"]),align:p.oneOf(["stretch","center","flex-start","flex-end","baseline","initial","inherit"]),gap:p.arrayOf(p.oneOf(["xs","sm","md","lg","xl","xxl",null])),gapSmUp:p.arrayOf(p.oneOf(["xs","sm","md","lg","xl","xxl",null])),gapMdUp:p.arrayOf(p.oneOf(["xs","sm","md","lg","xl","xxl",null])),gapLgUp:p.arrayOf(p.oneOf(["xs","sm","md","lg","xl","xxl",null])),wrap:p.oneOf(["nowrap","unset","wrap","wrap-reverse","initial","inherit"]),direction:p.oneOf(["row","row-reverse","column","column-reverse"])},kke={justify:"inherit",align:null,wrap:"wrap",direction:"row",gap:null,gapSmUp:null,gapMdUp:null,gapLgUp:null},Mke={xs:4,sm:8,md:16,lg:32,xl:64,xxl:128},jke=e=>e.map(t=>t?`${H(Mke[t])}`:"0").join(" "),LE=e=>e?`gap: ${jke(e)};`:"",zs=T.div.withConfig({shouldForwardProp:(e,t)=>!["wrap","direction","justify","align","gap"].includes(e)&&t(e)})`
    display: flex;
    flex-flow: ${({direction:e})=>e} ${({wrap:e})=>e};
    flex-basis: ${({basis:e})=>e||"auto"};
    justify-content: ${({justify:e})=>e};
    ${({align:e})=>e&&`align-items:${e}`};

    ${({gap:e})=>LE(e)};

    ${oe.smUp`
        ${({gapSmUp:e})=>LE(e)};
    `}

    ${oe.mdUp`
        ${({gapMdUp:e})=>LE(e)};
    `}

    ${oe.lgUp`
        ${({gapLgUp:e})=>LE(e)};
    `}
`;zs.displayName="Flex";zs.propTypes=Lke;zs.defaultProps=kke;const wke=T.div`
    flex-grow: 1;
`;wke.displayName="FlexGrow";const EY=Yl`
    0% {
        opacity: .5;
    }
    50% {
        opacity: 1;
    }
    100% {
        opacity: .5;
    }
`,Fke=Yl`
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
`,Bke=T.img.withConfig({shouldForwardProp:(e,t)=>!["name","fill","height","width","info","success","primary","warning","error"].includes(e)&&t(e)})`
    display: inline-block;
    line-height: 0;
    vertical-align: middle;
    block-size: ${H(20)};
    inline-size: ${H(20)};
`,fY={ProductAttributeIconImage:Bke},{ProductAttributeIconImage:Uke}=fY,ky=20,My=`calc(${H(ky)} + var(--salt-spacing-2))`,Gke=18,fA=20,Wu=Math.max(Gke,fA),$ke=22,yA=28,yY=T.div`
    visibility: initial;
    margin-block-end: var(--salt-spacing-2);
    block-size: ${H(ky)};
    inline-size: 100%;
    position: relative;

    :empty {
        display: none;
    }

    ${oe.smUp`
        :empty {
            display: block;
        }
    `}
`;yY.displayName="BreadcrumbHeader";const IY=T.div`
    white-space: normal;
    position: static;
`;IY.displayName="BreadcrumbDropdown";const SY=T.button.withConfig({shouldForwardProp:(e,t)=>!["width","height"].includes(e)&&t(e)})`
    inline-size: ${({width:e})=>H(e||ky)};
    block-size: ${({height:e})=>H(e||ky)};
    margin: 0;
    padding: 0;
    border: 0;
    background: transparent;
    cursor: pointer;
`;SY.displayName="BreadcrumbDropdownButton";const Hke=20,CY=T(P)`
    inline-size: ${({breadcrumbChild:e})=>e?`calc(100% - ${H(Hke*2)})`:"100%"};
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    vertical-align: top;
`;CY.displayName="BreadcrumbText";const MR=200,jR=`calc(${H(MR)} - var(--salt-spacing-2) * 2)`,Kj=5,Eh=T.div`
    background-color: ${({active:e})=>e?"var(--intent-action-50)":"var(--intent-contrast)"};
    border-block-end: ${()=>`${H(Kj)} solid var(--intent-secondary-100);`};
    display: flex;
    flex-basis: 100%;
    flex-direction: row;
    flex-grow: 1;
    margin: 0;
    padding: var(--salt-spacing-2);
    position: relative;
    text-align: start;

    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
                border: solid var(--intent-secondary-100);
                border-width: ${H(Kj/2)};
                flex-basis: 25%;
                flex-direction: column;
                min-inline-size: ${H(MR)};
            `}

            ${oe.mdUp`
                flex-basis: 20%;
            `}

            ${oe.lgUp`
                flex-basis: ${Ke.lg/5}rem;
                inline-size:  ${Ke.lg/5}rem;
            `}
        `}
`;Eh.displayName="Card";const fh=T.div`
    inline-size: 100%;
    max-block-size: 100%;
    display: flex;
    flex-direction: row;
    margin: 0;
    padding: 0;
    position: relative;
    text-align: start;
    border: 0;
    border-radius: var(--salt-radius-default);

    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
                flex-direction: column;
                min-inline-size: ${jR};
            `}
        `}
`;fh.displayName="BoxCard";const Vke=T.div`
    display: flex;
    flex-basis: 100%;
    flex-direction: column;
    flex-grow: 1;
    margin: 0;
    position: relative;

    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
                flex-basis: 25%;
                flex-direction: column;
                min-inline-size: ${H(MR)};
            `}

            ${oe.mdUp`
                flex-basis: 20%;
            `}

            ${oe.lgUp`
                flex-basis: ${Ke.lg/5}rem;
                inline-size: ${Ke.lg/5}rem;

                ${Eh}, ${fh} {
                    inline-size: 100%;
                }
            `}
        `}
`,Yke=T.div`
    background: var(--intent-contrast);
    inset-block: 0;
    inset-inline: 0;
    opacity: 0.5;
    pointer-events: none;
    position: absolute;
    z-index: ${Qt["fop-overlay"]};
`,TY=T.a`
    color: ${({presentationMode:e})=>e==="MUTE_STYLE"?"black":"var(--typography-promotion, var(--intent-promotion))"};
    text-decoration: none;

    &:hover {
        text-decoration: underline;
    }
`;TY.displayName="OfferLink";const _Y=T(P).attrs({intent:"promotion"})`
    line-height: 18px;
    font-weight: ${({presentationMode:e})=>e==="MUTE_STYLE"?"bold":"normal"};
    text-decoration: none;
`;_Y.displayName="OfferText";const vY=T(me)`
    color: var(--intent-primary);
`;vY.displayName="FopTopBarIcon";const AY=T.div`
    -ms-flex-negative: 0;
    display: flex;
    flex-direction: column;
    background-color: var(--intent-contrast);
    border-start-start-radius: var(--border-radius);
    border-start-end-radius: 0;
    border-end-end-radius: 0;
    border-end-start-radius: var(--border-radius);
    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
                border-start-start-radius: var(--border-radius);
                border-start-end-radius: 0;
                border-end-end-radius: 0;
                border-end-start-radius: 0;
        `}
        `};
`;AY.displayName="Header";const jy=135,I_=175,Wke=320,qke=`calc(${H(Wke)-jR} - var(--salt-spacing-4) * 2 - var(--salt-spacing-1) * 2)`,bY=T.div`
    -ms-flex-negative: 0;
    min-inline-size: ${qke};
    max-inline-size: calc(${H(jy)} + var(--salt-spacing-1) * 2);
    position: relative;

    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
                margin-inline-end: 0;
                max-inline-size: unset;
            `}
        `}
`;bY.displayName="Media";const xY=T.div`
    position: absolute;
    inset-block-start: 0;
    inset-inline-end: 0;
    z-index: ${Qt["fop-options"]};
`;xY.displayName="ActionsWrapper";const RY=T.div`
    display: flex;
    align-items: flex-start;
    position: absolute;
    inset-block-start: var(--salt-spacing-1);
    inset-inline: var(--salt-spacing-1);
    z-index: ${Qt["fop-overlay"]};
`;RY.displayName="ImageTopBar";const DY=T(zs)`
    align-items: flex-start;
    row-gap: var(--salt-spacing-1);
    min-block-size: ${H($ke)};
    padding-inline-end: 0;
    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
                padding-inline-end: ${H(Z2)};
            `}
        `};
`;DY.displayName="ImageTopBarTopRow";const OY=T.div`
    position: relative;
`;OY.displayName="ImageTopBarBottomRow";const PY=T.div`
    position: absolute;
    inset-block-start: 0;
    inset-inline: 0;
    padding-block-start: var(--salt-spacing-1);
`;PY.displayName="ImageTopBarBottomRowInner";const Kke=T(Fn)``,zke=T.div`
    padding-inline: var(--salt-spacing-2) var(--salt-spacing-2);
`;zke.displayName="MissedPromotionFopWrapper";T.div`
    padding-inline: 0;
`;const Qke=T.div`
    inset-block-end: calc(
        -1 * (var(--salt-spacing-4) + ${H(Wu)} / 2)
    );
    position: absolute;
    inline-size: 100%;
    padding-block: var(--salt-spacing-2);
    font-weight: 600;
    background: var(--intent-contrast);
    box-shadow: 0 -1px ${H(1)} 0 rgb(0 0 0 / 7%);

    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
                inset-block-end: 0px;
            `}
        `}
`;Qke.displayName="MissedPromotion";const NS=T.div`
    inset-block-end: calc(-1 * var(--salt-spacing-4));
    inset-inline: var(--salt-spacing-2);
    line-height: 0;
    position: absolute;

    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
            inset-block-end: ${({hasMultipleAttributeGroups:t})=>t?`-${H(Wu/2)}`:`calc(var(--salt-spacing-1) + ${H(Wu)} / 2)`};
        `}
        `}
`;NS.displayName="ImageBottomBar";NS.propTypes={hasMultipleAttributeGroups:p.bool};NS.defaultProps={hasMultipleAttributeGroups:!1};const NY=T.a`
    display: block;
    margin-block: calc(var(--salt-spacing-8) - var(--salt-spacing-1)) var(--salt-spacing-1);
    margin-inline: var(--salt-spacing-1);
    max-block-size: ${H(jy)};
    max-inline-size: ${H(jy)};

    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
                margin-block-start: calc(var(--salt-spacing-8) - var(--salt-spacing-1));
                margin-inline: auto;
                margin-block-end: var(--salt-spacing-1);
                block-size: ${H(I_)};
                min-block-size: ${H(I_)};
                max-block-size: unset;
                inline-size: ${H(I_)};
                max-inline-size: unset;
            `}
        `};
`;NY.displayName="ImageWrapper";const LY=T.img`
    block-size: 100%;
    inline-size: 100%;
`;LY.displayName="StyledImage";const LS=T.div`
    ${e=>e.multiLine?`min-block-size: ${H(Wu)};`:`overflow: hidden; block-size: ${H(Wu)};`}
    margin-block-start: var(--salt-spacing-1);

    svg,
    ${Uke} {
        padding-block-end: var(--salt-spacing-05);
        padding-inline-end: var(--salt-spacing-05);

        &:last-child {
            padding-inline-end: 0;
        }
    }
`;LS.displayName="ProductAttributes";LS.propTypes={multiLine:p.bool};LS.defaultProps={multiLine:!1};const kY=T(me).attrs(({name:e})=>({fill:e==="favourite"?"var(--intent-primary)":void 0,height:fA,width:fA,"data-test":`lifestyle-icon__${e}`}))``;kY.displayName="ProductAttribute";const MY=T(rt).attrs({standalone:!0})`
    display: block;
    min-inline-size: ${H(115)};
    overflow: hidden;
    inline-size: 100%;

    ${oe.smUp`
        min-inline-size: ${H(165)};
    `}
`;MY.displayName="Title";const jY=T.div`
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    block-size: ${H(25)};
    margin-block-end: var(--salt-spacing-1);
`;jY.displayName="PriceWrapper";const wY=T.strong.withConfig({shouldForwardProp:(e,t)=>!["type"].includes(e)&&t(e)})`
    color: ${({type:e})=>e==="offer"?"var(--typography-promotion, var(--intent-promotion))":"var(--intent-content)"};
    font-size: var(--salt-display-font-size);
    font-weight: 700;
    margin-inline-end: var(--salt-spacing-1);
`;wY.displayName="Price";const wR=T.s`
    color: var(--intent-content);
    font-size: var(--salt-text-s-font-size);
    font-weight: 400;
`;wR.displayName="StrikethroughPrice";T(wR)`
    float: inline-end;
`;const FY=T(zs)`
    inline-size: calc(100% - (${H(jy)} + var(--salt-spacing-1) * 2));
    min-inline-size: ${jR};
    padding: var(--salt-spacing-2);
    margin-block-start: 0;
    border-inline-start: 1px solid rgb(0 0 0 / 10%);
    border-block-start: none;
    position: relative;

    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
            inline-size: 100%;
            padding-block-start: var(--salt-spacing-1);
            padding-inline: var(--salt-spacing-2);
            padding-block-end: var(--salt-spacing-2);
            margin-block-start: -1px;
            border-inline-start: none;
            border-block-start: 1px solid rgba(0, 0, 0, 0.1);
        `}
        `};
`;FY.displayName="BodyContainer";const BY=T.div`
    flex-direction: column;
    flex-grow: 1;
    max-inline-size: 100%;
    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
            padding-block: ${H(Wu/2)} 0;
            padding-inline: 0;
        `}
        `};
`;BY.displayName="Body";const UY=T.div`
    flex-direction: column;
    text-align: center;
    inline-size: 100%;
`;UY.displayName="Footer";const GY=De`
    z-index: ${Qt["fop-overlay"]};
`;GY.displayName="NavigationButton";const $Y=T.div`
    block-size: ${H(yA)};
    overflow: auto;
`;$Y.displayName="Status";const HY=T.div`
    block-size: ${H(18)};
    margin-inline-end: var(--salt-spacing-1);
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
`;HY.displayName="Size";const VY=T(P)`
    color: ${({branded:e})=>e?"var(--intent-primary)":"currentColor"};
    margin-inline-end: var(--salt-spacing-1);
`;VY.displayName="SizeText";const YY=T.div`
    overflow: hidden;
    block-size: ${H(36)};
    margin-block-end: var(--salt-spacing-1);
`;YY.displayName="OfferContainer";const WY=T.span`
    margin-inline: ${({post:e})=>e&&"var(--salt-spacing-1)"}
        ${({pre:e})=>e&&"var(--salt-spacing-1)"};
`;WY.displayName="CatchWeightText";const zj=404,Qj=191,FR=T(Vke)`
    inline-size: 100%;
    margin-block-end: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-2);
    block-size: ${({breadcrumbsHeader:e,firstInGroup:t,status:n})=>`calc(
            ${H(Qj)} +
                ${e&&t?My:"0px"} +
                ${n?`calc(${H(yA)} + 'var(--salt-spacing-1)')`:"0px"}
        )`};
    /* stylelint-disable-next-line no-descending-specificity */
    ${Eh}, ${fh} {
        block-size: ${H(Qj)};
    }

    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
            block-size: ${({breadcrumbsHeader:t,status:n})=>`calc(
                    ${H(zj)} +
                        ${t?My:"0px"} +
                        ${n?`calc(${H(yA)} + 'var(--salt-spacing-1)')`:"0px"}
                )`};

            ${Eh}, ${fh} {
                block-size: ${H(zj)};
            }
        `}
        `}
`;FR.displayName="FixedHeightWrapper";const qY=T(FR)`
    && {
        animation: ${EY} 1s infinite;
        background-image: url('/static/images/fopSkeletonMobile.jpg');
        background-size: 100% 100%;
        background-position: center center;
        background-repeat: no-repeat;
        border: none;
        position: absolute;
        inset-block: ${({firstInGroup:e})=>e?H(My):0} 0;
        inset-inline: var(--salt-spacing-2) var(--salt-spacing-2);
        margin: 0;
        inline-size: unset;
        min-inline-size: unset;
        padding: 0;

        ${({displayLandscapeLayout:e})=>!e&&De`
                ${oe.smUp`
                background-image: url("/static/images/fopSkeletonDesktop.jpg");
                inset-block-start: ${My};
            `}
            `}
    }
`;qY.displayName="FixedHeightSkeleton";const KY=T(MY)`
    block-size: ${H(40)};
    margin-block-end: var(--salt-spacing-1);
    margin-inline-end: ${H(Z2)};
    inline-size: auto;
    ${oe.smUp`
        margin-inline-end: 0;
        inline-size: 100%;
    `}
`;KY.displayName="FixedHeightTitle";const Xke=T.div`
    display: flex;
    justify-content: center;
    align-items: center;
    margin-inline-end: var(--salt-spacing-2);
    inline-size: ${H(40)};
    block-size: ${H(40)};
    border: var(--salt-border-1) solid var(--intent-secondary-900);
    border-radius: var(--border-radius);
    background: var(--intent-contrast);
`,Zke=T.span`
    ${DR}
`;Zke.displayName="CountryOfOriginA11yPrefix";const Jke=e=>e==="xl"?"var(--salt-display-font-size)":`var(--salt-text-${e}-font-size)`,eMe=e=>e==="xl"?"var(--salt-display-line-height)":`var(--salt-text-${e}-line-height)`,zY=T(Fn)`
    > * {
        font-size: ${({size:e})=>e&&Jke(e)};
        line-height: ${({size:e})=>e&&eMe(e)};
    }

    max-inline-size: 100%;
`;zY.displayName="CountryOfOrigin";const nt={FixedHeightWrapper:FR,FixedHeightSkeleton:qY,FixedHeightTitle:KY,ActionsWrapper:xY,Body:BY,BodyContainer:FY,BoxCard:fh,BreadcrumbDropdown:IY,BreadcrumbDropdownButton:SY,BreadcrumbHeader:yY,BreadcrumbText:CY,Card:Eh,CatchWeightText:WY,CountryOfOrigin:zY,FopTopBarIcon:vY,Footer:UY,Header:AY,Image:LY,ImageWrapper:NY,Media:bY,NavigationButton:GY,OfferContainer:YY,OfferLink:TY,OfferText:_Y,OrderQuantity:Xke,OutOfStockBadge:Kke,Overlay:Yke,Price:wY,PriceWrapper:jY,ProductAttribute:kY,ProductAttributes:LS,Status:$Y,Size:HY,SizeText:VY,StrikethroughPrice:wR,ImageTopBar:RY,ImageTopBarTopRow:DY,ImageTopBarBottomRow:OY,ImageTopBarBottomRowInner:PY,ImageBottomBar:NS},tMe=T.div`
    border: 0;
    display: flex;
    flex-wrap: wrap;
    margin-inline: calc(-1 * var(--salt-spacing-2));
`,sMe=T(nt.Card)`
    && {
        border: none;
        block-size: 0;
        padding: 0;
        visibility: hidden;
        inline-size: 0;
    }
`,no={Container:tMe,Placeholder:sMe},nMe=T(Pe)`
    padding-block-end: 100%;
    ${oe.smUp`
        inline-size: auto;
        padding-inline-end: 100%;
    `};
`,oMe={PlaceholderImage:nMe},rn={errorMessage:{padding:3},label:{color:"var(--intent-content)","font-size":14,"font-weight":400,padding:4,error:{color:"var(--typography-error, var(--intent-error))"}},checkboxOrRadio:{size:20,label:{padding:2}},outlineBoxShadow:()=>"0 0 3px 2px rgb(59, 153, 252)",dropdown:{arrow:{size:10,color:"var(--intent-content)"}},radio:{off:{color:"var(--intent-content)"},on:{fill:"var(--intent-content)"},disabled:{color:"var(--typography-error, var(--intent-error)"}},checkbox:{off:{color:"var(--intent-content)"},on:{fill:"var(--intent-content)","tick-color":"white"}}},BR=T(me)`
    border-radius: var(--salt-border-radius);
    block-size: ${H(rn.checkboxOrRadio.size)};
    margin-inline-end: var(--salt-spacing-2);
    inline-size: ${H(rn.checkboxOrRadio.size)};

    input[type='checkbox']:focus + & {
        outline: 5px auto Highlight;
        outline: 5px auto -webkit-focus-ring-color;
    }
`,rMe=T(BR)`
    color: ${rn.checkbox.off.color};
`,aMe=T(BR)`
    > svg {
        fill: ${rn.checkbox.on.fill};

        path:nth-child(2) {
            fill: ${rn.checkbox.on["tick-color"]};
        }
    }
`,iMe=T(P)`
    overflow: hidden;
`,lMe=T(P)`
    align-items: center;
    white-space: ${e=>e.whiteSpace};
    display: block;
    text-overflow: ellipsis;
    overflow: hidden;

    ::after {
        content: '\\0020'; /* space */
    }
`,cMe=T.span`
    font-weight: 400;
`,kS={CheckboxText:lMe,CheckboxIcon:BR,CheckboxIconOff:rMe,CheckboxIconOn:aMe,ContentWrapper:cMe,CheckboxTextWrapper:iMe},Ua=T(P)`
    margin-block-start: ${H(rn.errorMessage.padding)};
    display: block;
`;Ua.displayName="FormErrorMessage";Ua.defaultProps={intent:"error",italic:!0};const dMe=De`
    color: ${({hasError:e})=>e?rn.label.error.color:rn.label.color};
    cursor: ${({disabled:e})=>e?"not-allowed":"pointer"};
    display: flex;
    font-weight: ${rn.label["font-weight"]};
    font-size: ${H(rn.label["font-size"])};
    margin-block-end: ${H(rn.label.padding)};
    ${({isRequired:e})=>e&&"&:before { content: '*' }"}
`,uMe=De`
    input[type='checkbox'],
    input[type='radio'] {
        block-size: 1px;
        inline-size: 1px;
        margin: -1px;
        opacity: 0;

        &:focus ~ ${vp} {
            display: inline-table;
        }
    }
`,pMe=De`
    ${dMe}
    ${uMe}
`,QY=T.label`
    ${({visuallyConcealed:e})=>e?DR:pMe}
`,MS=T(me).attrs(()=>({height:rn.checkboxOrRadio.size,width:rn.checkboxOrRadio.size}))`
    border-radius: 50%;
    margin-inline-end: var(--salt-spacing-2);
`,mMe=T(MS)`
    color: ${rn.radio.off.color};
`,hMe=T(MS)`
    > svg {
        fill: ${rn.radio.on.fill};
    }
`,gMe=T(MS)`
    color: ${rn.radio.disabled.color};
`,EMe=T(P)`
    display: block;

    ::after {
        content: '\\0020'; /* space */
    }
`,fMe=T.span`
    font-weight: 400;
`,ha={RadioIcon:MS,RadioIconOff:mMe,RadioIconOn:hMe,RadioIconDisabled:gMe,ContentWrapper:fMe,RadioText:EMe},Oa=T.div`
    inline-size: ${({fill:e})=>e&&"100%"};
    margin-block-end: ${({last:e})=>e?0:"var(--salt-spacing-4)"};
    position: relative;

    &:last-child {
        margin-block-end: 0;
    }
`,jS=T.input`
    background-color: ${({hasError:e})=>e?"var(--intent-error-50)":"var(--intent-contrast)"};
    border: var(--salt-border-1) solid
        ${({hasError:e})=>e?"var(--typography-error)":"var(--intent-secondary-800)"};
    border-radius: var(--border-radius);
    color: ${({hasError:e})=>e?"var(--typography-error)":"var(--intent-content)"};
    cursor: text;
    font-family: var(--font-family);
    block-size: ${({blockSize:e})=>H(jn[e||"md"])};
    padding: var(--salt-spacing-2);
    position: relative;
    inline-size: 100%;
    appearance: none;
    line-height: var(--salt-text-l-line-height);
    font-size: var(--salt-text-l-font-size);

    &::placeholder {
        color: ${({hasError:e})=>e?"var(--typography-error)":"var(--intent-content)"};
    }

    &[readonly] {
        border: none;
    }
`,UR=T(jS)`
    min-block-size: ${H(150)};

    ${({isNewFormsStyled:e,hasError:t})=>e&&`
        background-color: var(--salt-form-element-background-color);
        color: var(--salt-text-color);
        font-size: var(--salt-text-m-font-size);
        border: ${t?"var(--salt-border-2) solid var(--salt-form-element-error-color)":"var(--salt-border-1) solid transparent"};

        outline-offset: 3px;

        &:hover {
          border-color: ${!t&&"var(--salt-form-element-hover-border-color)"};
        }

        &::placeholder {
          color: var(--salt-form-element-placeholder-color)
        }
    `}
`,XY=Object.freeze(Object.defineProperty({__proto__:null,Checkbox:kS,ErrorMessage:Ua,Label:QY,Radio:ha,Row:Oa,Textarea:UR},Symbol.toStringTag,{value:"Module"})),yMe=T.li.withConfig({shouldForwardProp:(e,t)=>!["disabled"].includes(e)&&t(e)})`
    align-items: center;
    border: var(--salt-border-1) solid var(--intent-secondary);
    display: flex;
    flex: 1 0 auto;
    justify-content: space-between;
    overflow: hidden;
    padding-block: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-4);

    &:hover {
        background-color: ${({disabled:e})=>e?void 0:"var(--intent-secondary-50)"};
        color: ${({disabled:e})=>e?void 0:"var(--intent-content)"};
        cursor: ${({disabled:e})=>e?"not-allowed":"pointer"};
    }

    &:active {
        background-color: ${({disabled:e})=>e?void 0:"var(--intent-secondary-100)"};
        color: ${({disabled:e})=>e?void 0:"var(--intent-content)"};
    }

    > div {
        margin-block-end: 0;
        padding-block-start: ${H(7)};
    }
`,aa=T.ul`
    display: flex;
    flex-direction: column;
    list-style: none;
    margin: 0;
    padding: 0;

    > li {
        margin-block: ${H(-1)} 0;
        margin-inline: 0;
    }

    > li:first-child {
        border-start-start-radius: var(--border-radius);
        border-start-end-radius: var(--border-radius);
        margin-block-start: 0;
    }

    > li:last-child {
        border-end-start-radius: var(--border-radius);
        border-end-end-radius: var(--border-radius);
    }
`;aa.Row=yMe;const GR=T.li`
    display: ${({inline:e})=>e?"inline-block":"block"};
    margin-block: ${({inline:e})=>e?0:"0 var(--salt-spacing-2)"};
    margin-inline: ${({inline:e})=>e?"var(--salt-spacing-2)":0};

    &:last-child {
        margin-block-end: 0;
    }

    &:empty {
        display: none;
    }
`;GR.displayName="ListItem";const $R=T.ul`
    list-style: none;
    margin: 0;
    padding: 0;
`;$R.displayName="List";$R.Item=GR;const ZY={StyledList:$R,ListItem:GR},JY=4,IMe=T.div.withConfig({shouldForwardProp:(e,t)=>!["size"].includes(e)&&t(e)})`
    position: relative;
    inline-size: ${({size:e})=>H(e)};
    block-size: ${({size:e})=>H(e)};
`,SMe=T.svg.withConfig({shouldForwardProp:(e,t)=>!["size","radius"].includes(e)&&t(e)})`
    inline-size: ${({size:e})=>H(e)};
    block-size: ${({size:e})=>H(e)};
    fill: transparent;
    transform: rotate(-90deg);

    & circle {
        stroke-width: ${H(JY)};
        stroke-dashoffset: 0;
        transition: stroke-dashoffset 1s linear;
        stroke-dasharray: ${({radius:e})=>Math.PI*e*2};
    }

    & .path {
        stroke: var(--intent-secondary-900);
    }

    & .progress {
        stroke: ${({colorName:e})=>`var(--intent-${e})`};
        stroke-dashoffset: ${({progress:e,radius:t})=>Math.PI*t*2*((100-e)/100)};
    }
`,CMe=T.div.withConfig({shouldForwardProp:(e,t)=>!["size"].includes(e)&&t(e)})`
    display: flex;
    justify-content: center;
    align-items: center;
    position: absolute;
    block-size: ${({size:e})=>H(e)};
    inline-size: ${({size:e})=>H(e)};
    inset-block-start: 0;
    inset-inline-start: 0;
`,TMe={strokeWidth:JY,Wrapper:IMe,Ring:SMe,ContentContainer:CMe},eW=e=>{switch(e){case"start":case"left":return"start";case"end":case"right":return"end";default:return e}},tW=T.div`
    border-start-start-radius: var(--border-radius);
    border-start-end-radius: var(--border-radius);
    flex-shrink: 0;
    padding-block: var(--salt-spacing-2);
    padding-inline: ${({align:e})=>e==="center"?`${H(36)}`:"var(--salt-spacing-4)"} ${H(36)};
    text-align: ${({align:e})=>eW(e)};

    ${({condensed:e=!1})=>!e&&oe.smUp`
            padding-block: var(--salt-spacing-4);
            padding-inline: ${H(50)};
    `};
`;tW.displayName="Dialog-Header";const sW=T.div`
    border-end-end-radius: var(--border-radius);
    border-end-start-radius: var(--border-radius);
    display: flex;
    flex-shrink: 0;
    flex-wrap: nowrap;
    ${({flow:e})=>`flex-flow:${e}`};
    padding-block: var(--salt-spacing-4);
    padding-inline: var(--salt-spacing-4);

    ${({condensed:e=!1})=>!e&&oe.smUp`
            padding-block: ${H(20)};
            padding-inline: ${H(50)};
            text-align: ${({align:t})=>eW(t)};
    `};
`;sW.displayName="Dialog-Footer";const _Me={width:{sm:492,md:742,lg:984}},vMe=()=>"calc(100vw - var(--salt-spacing-2))",AMe=T.div`
    background-color: var(--background-color);
    border-radius: var(--border-radius);
    display: flex;
    flex-direction: column;
    flex-grow: 0;
    max-inline-size: ${({maxWidth:e})=>H(_Me.width[e])};
    position: relative;
    inline-size: ${vMe};
    -webkit-overflow-scrolling: touch;
    max-block-size: 100%;
    min-block-size: 0;
    overflow: hidden;

    ${({viewHeight:e})=>e&&`block-size: ${e};`}

    ${oe.smUp`
        flex-grow: 0;
    `};
`,bMe=T(b)`
    position: absolute;
    inset-block-start: var(--salt-spacing-2);
    inset-inline-end: var(--salt-spacing-2);
    z-index: ${Qt["dialog-close"]};
`,xMe=T.div.withConfig({shouldForwardProp:(e,t)=>!["direction"].includes(e)&&t(e)})`
    /* stylelint-disable scss/dollar-variable-pattern */
    ${({grow:e})=>`flex-grow: ${e};`}

    ${oe.smUp`
        ${({grow:e})=>`flex-grow: ${e};`}
    `}
    ${({direction:e})=>e==="row"?"block-size":"inline-size"}: 100%;
    ${({direction:e})=>e==="row"?"min-inline-size":"min-block-size"}: var(--salt-spacing-1);
    /* stylelint-enable scss/dollar-variable-pattern */
`,RMe=T.form`
    display: flex;
    flex-direction: column;
    overflow: auto;
`,DMe=T.div`
    display: flex;
    flex-direction: column;
    block-size: 100%;
`,nW={Content:AMe,DialogForm:RMe,StyledHeader:tW,StyledFooter:sW,Fill:xMe,CloseButton:bMe,FlexColumn:DMe},OMe={"navigation-list":"_navigation-list_rphzh_1","navigation-list__item":"_navigation-list__item_rphzh_7","navigation-list__item--bold":"_navigation-list__item--bold_rphzh_21"},oW=Wl.bind(OMe);function Vn({children:e,className:t,...n}){return s.jsx("ul",{className:oW("navigation-list",t),...n,children:e})}function PMe({bold:e,children:t,className:n,...o}){const r=oW({"navigation-list__item":!0,"navigation-list__item--bold":e},n);return s.jsx("li",{className:r,...o,children:t})}Vn.Item=PMe;const NMe=T.div`
    display: inline-block;
`,LMe=T.div`
    display: inline-block;
    float: inline-start;
    inline-size: calc(100% - (100px + var(--salt-spacing-2)));
`,kMe=T.div`
    float: inline-start;
    margin-inline-end: var(--salt-spacing-2);
    position: relative;
`,MMe=T.img`
    inline-size: ${H(100)};
    max-inline-size: ${H(100)};
`,jMe=T(P)`
    display: inline-block;
    margin-block-end: var(--salt-spacing-2);
    min-inline-size: ${H(175)};
    overflow: hidden;

    ${oe.smUp`
        block-size: ${H(40)};
    `};
`,wMe={Wrapper:NMe,Body:LMe,Media:kMe,Image:MMe,Title:jMe},al=h.forwardRef((e,t)=>{const{formatMessage:n}=M(),o=n("quantity.badge.number.above.maximum",{count:e.count}),r=e.overflowAccessibilityText||e.accessibilityText;return s.jsx(sre,{overflowText:o,overflowAccessibilityText:r,...e,ref:t})}),S_=(e,t)=>(...n)=>De`
        @media (min-width: ${Ke[e]}em) and (max-width: ${Ke[t]}em) {
            @media not screen and (width: ${Ke[t]}em) {
                ${De(...n)}
            }
        }
    `,rW=H(40),HR=`
    max-block-size: ${rW};
    @supports (-webkit-line-clamp: 2) {
        block-size: auto;
        min-inline-size: 0;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: initial;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }
`,FMe=T(nt.Body)`
    inline-size: 100%;
`;FMe.displayName="Body";T(nt.FixedHeightTitle)`
    ${HR}
    min-inline-size: 100%;
`;const BMe=T.div`
    > ${nt.OfferLink} {
        ${HR}
    }

    margin-block-end: 0;
`;BMe.displayName="OfferContainer";const UMe=T(P)`
    ${HR};

    max-block-size: ${rW};
    margin-block-end: 0;
`;UMe.displayName="Size";const aW=T(al)`
    position: absolute;
    inset-block-start: -${H(3)};
    inset-inline-end: -${H(3)};
    z-index: ${Qt.badge};
`;aW.displayName="TileQuantityBadge";const iW=T(nt.Media)`
    min-inline-size: auto;
    margin-inline-end: 0;
`;iW.displayName="TileMedia";const GMe=T.a`
    display: block;
    margin-block: 0;
    margin-inline: auto;
`;GMe.displayName="ImageWrapper";const $Me=T.div`
    overflow: auto;
`;$Me.displayName="Status";const lW=T(nt.ImageTopBar)`
    inset-block-start: -${H(10)};
    inset-inline-start: -${H(10)};
`;lW.displayName="ImageTopBar";const Eg=T.div`
    -ms-flex-negative: 0;
    display: flex;
    flex-direction: column;
    inline-size: 100%;
    block-size: auto;
    border-radius: var(--salt-radius-default);
    padding-block: var(--salt-spacing-2) var(--salt-spacing-1);
    padding-inline: var(--salt-spacing-2);
    margin: 0;
    background-color: var(--intent-contrast);
`;Eg.displayName="Tile";const cW=T(Eg)`
    && {
        animation: ${EY} 1s infinite;
        background-color: var(--intent-secondary);
        inline-size: 100%;
        padding-block-start: calc(100% - var(--salt-spacing-1));
        box-shadow: none;
    }
`;cW.displayName="TileSkeleton";const qu=T.div`
    background-color: var(--intent-contrast);
    inline-size: calc(100% + ${H(50)});
    border-radius: var(--border-radius);
    box-shadow: var(--salt-elevation-shadow-1);
    position: absolute;
    inset-block-start: -${H(5)};
    inset-inline-start: -${H(25)};
    visibility: hidden;
    padding: var(--salt-spacing-2);

    ${oe.smUp`
        padding-block: 0 var(--salt-spacing-1);
        padding-inline: var(--salt-spacing-2);
    `}
`;qu.displayName="Fop";const HMe=T.div`
    -ms-flex-negative: 0;
    display: flex;
    flex-direction: column;
    background-color: var(--intent-contrast);

    ${oe.smUp`
        margin-block-end: var(--salt-spacing-2);
        margin-block-start: var(--salt-spacing-1);
    `};
`;HMe.displayName="FopHeader";const VMe=T(zs)`
    inline-size: 100%;
`;VMe.displayName="FopBodyContainer";const kE=e=>`
    &:nth-child(${e}n) > ${qu} {
        inset-inline-start: auto;
        inset-inline-end: 0;
    }
    &:nth-child(${e}n + 1) > ${qu} {
        inset-inline-start: 0;
    }
`,dW="var(--salt-spacing-2)",ME=e=>{const t=`calc(100% / ${e})`,n=`calc(${t} - ${dW})`;return`
        max-inline-size: ${t};
        &:nth-child(${e}n + 1) {
            border-inline-start-width: 0;
            max-inline-size: ${n};
            margin-inline-start: var(--salt-spacing-2);
        }
        &:nth-child(${e}n) {
            border-inline-end-width: 0;
            max-inline-size: ${n};
            margin-inline-end: var(--salt-spacing-2);
        }
    `},Xj=`
    outline: none;
    padding: 0;
    @supports (position: sticky) {
        position: sticky;
    }
    inset-block-end: 0;
    z-index: ${Qt.header};
    > ${Eg} {
        visibility: hidden;
    }
    > ${qu} {
        visibility: visible;
    }
`,Zj=3,C_=4,T_=5,__=7,uW=T.div.attrs({tabIndex:0})`
    contain: layout;
    padding: 0;
    position: relative;
    flex: 1 1 calc(100% / 3);
    flex-wrap: wrap;
    max-inline-size: calc(100% / 3);
    min-inline-size: auto;
    border: solid transparent ${dW};

    ${S_("xs","sm")`
        ${({fopTilesInRow:e})=>kE(e?.xs||Zj)}
        ${({fopTilesInRow:e})=>ME(e?.xs||Zj)}
    `}
    ${S_("sm","md")`
        ${({fopTilesInRow:e})=>kE(e?.sm||C_)}
        ${({fopTilesInRow:e})=>ME(e?.sm||C_)}
        flex: 1 1 calc(100% / ${({fopTilesInRow:e})=>e?.sm||C_});
    `}
    ${S_("md","lg")`
        ${({fopTilesInRow:e})=>kE(e?.md||T_)}
        ${({fopTilesInRow:e})=>ME(e?.md||T_)}
        flex: 1 1 calc(100% / ${({fopTilesInRow:e})=>e?.md||T_});
    `} {
        /*
            --bar-bottom-height: css variable set to overwrite the inline css (injected first time tile gets focus) variable in the container
        */
    }

    ${oe.mdUp`
        --bar-bottom-height: 5px;
    `};
    ${oe.lgUp`
        ${({fopTilesInRow:e})=>kE(e?.lg||__)}
        ${({fopTilesInRow:e})=>ME(e?.lg||__)}
        flex: 1 1 calc(100% / ${({fopTilesInRow:e})=>e?.lg||__});
    `}
    &:hover {
        position: relative;
        inset-block-end: 0;
        cursor: pointer;
    }

    /* stylelint-disable-next-line selector-class-pattern */
    &.focusWithin {
        ${Xj}
        inset-block-start: 0;
        ${oe.mdUp`
            z-index: ${Qt["fop-overlay"]};
        `};
    }

    &:focus-within {
        ${Xj}
        ${oe.mdUp`
            z-index: ${Qt["fop-overlay"]};
        `};
    }

    &:not(:focus-within) {
        inset-block-end: 0 !important;
    }

    /*
        - @media (hover: none): aiming mobile devices in particular iOS
        - &:not(:hover): on iOS (tested on version 11.4) the event blur get triggered only when focus on other element.
        Losing hover instead of rely on blur
        &:focus-within:not(:hover): reset the position of the wrapper when you tap out
    */
    @media (hover: none) {
        &:not(:hover) > ${qu} {
            visibility: hidden;
        }
        &:not(:hover) > ${Eg} {
            visibility: visible;
        }

        &:focus-within:not(:hover) {
            position: relative;
            inset-block-end: 0 !important;
            z-index: ${Qt["fop-overlay"]};
        }
    }
`;uW.displayName="Wrapper";const pW={TileQuantityBadge:aW,TileMedia:iW,ImageTopBar:lW,Tile:Eg,TileSkeleton:cW,Fop:qu,Wrapper:uW},mm=20,jE=24,YMe=T.progress`
    appearance: none;
    border-radius: ${jE}px;
    block-size: ${jE}px;
    inline-size: 100%;
    color: var(--intent-action-50);
    background-color: var(--intent-action-50);

    &::-webkit-progress-bar {
        block-size: ${mm}px;
        border-radius: ${mm}px;
        background-color: var(--intent-action-50);
    }

    &::-webkit-progress-value {
        block-size: ${jE}px;
        border-radius: ${jE}px;
        background-color: var(--intent-action);
        position: relative;
        display: ${({value:e})=>!e||e===0?"none":"inline-block"};
    }

    &::-moz-progress-bar {
        block-size: ${({value:e})=>!e||e===0?0:`${mm}px`};
        border-radius: ${mm}px;
        background-color: var(--intent-action);
    }

    &::-ms-fill {
        border: none;
        border-radius: ${mm}px;
        background-color: var(--intent-action);
    }
`,WMe={ProgressBarElement:YMe},qMe=T.div`
    color: var(--intent-content);
    line-height: var(--salt-text-m-line-height);
    padding-block-start: ${H(ra.v2.sm)};
    @supports (position: sticky) {
        padding-block-start: 0 !important;
    }

    display: flex;
    block-size: 100vb;
    flex-direction: column;

    ${oe.lgUp`
        padding-block-start: ${H(ra.v2.lgUp)};
    `}
`,KMe=T.select`
    block-size: 100%;
    opacity: 0;
    position: absolute;
    inset-block-start: 0;
    inset-inline-start: 0;
    inline-size: 100%;
    z-index: ${Qt.select};
    appearance: none;
`,zMe=T.span`
    align-items: center;
    box-shadow: ${({focus:e})=>e?rn.outlineBoxShadow():"none"};
    background-color: ${({hasError:e})=>e?"var(--intent-error-50)":"var(--intent-contrast)"};
    border: var(--salt-border-1) solid
        ${({hasError:e})=>e?"var(--typography-error)":"var(--intent-secondary-800)"};
    border-radius: var(--border-radius);
    color: ${({hasError:e})=>e?"var(--typography-error)":"var(--intent-content)"};
    display: flex;
    block-size: ${({size:e})=>H(jn[e])};
    padding-inline: var(--salt-spacing-2)
        calc(var(--salt-spacing-4) + ${H(rn.dropdown.arrow.size)});
    position: relative;
    inline-size: 100%;
    z-index: ${Qt.select-1};
    font-size: var(--salt-text-l-font-size);

    &::after {
        border-block-start: ${()=>`${H(rn.dropdown.arrow.size/2)} solid ${rn.dropdown.arrow.color}`};
        border-inline-start: ${H(rn.dropdown.arrow.size/2)} solid transparent;
        border-inline-end: ${H(rn.dropdown.arrow.size/2)} solid transparent;
        content: '';
        display: inline-block;
        block-size: 0;
        position: absolute;
        inset-inline-end: ${H(10.5)};
        inset-block-start: 50%;
        transform: translateY(-50%);
        inline-size: 0;
    }
`,QMe=T.span`
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
`,XMe=T.span`
    color: ${({hasError:e})=>e?"var(--typography-error)":"var(--intent-content)"};
`,Au={RawSelect:KMe,SelectWrapper:zMe,SelectResult:QMe,Placeholder:XMe},ZMe={s:32,m:52,l:64},JMe={s:4,m:5,l:5},wE=({size:e})=>H(ZMe[e]),wS=T.div`
    block-size: ${wE};
    inline-size: ${wE};
    margin-inline: auto;

    &::before,
    &::after {
        content: '';
        display: block;
        block-size: ${wE};
        inline-size: ${wE};
        border-radius: ${H(60)};
        position: absolute;
        border-width: ${({size:e})=>H(JMe[e])};
        border-style: solid;
    }

    &::before {
        border-color: var(--intent-primary-100);
    }

    &::after {
        animation: ${Fke} 0.6s linear infinite;
        border-color: var(--intent-primary) transparent transparent;
        z-index: ${Qt.icon};
    }
`,mW=T.div`
    inline-size: 70%;
    position: absolute;
    inset-block: 50% 0;
    inset-inline: 50% 0;
    transform: translateX(-50%) translateY(-50%);
`,hW=T(P)`
    display: block;
    margin-block-start: var(--salt-spacing-2);
    font-weight: bold;
    ${nre("break-word")};
    word-break: break-word;
    text-align: center;
`,IXt=T.div`
    overflow-x: scroll;

    ${oe.smUp`
        overflow-x: visible;
    `}

    table {
        text-align: end;
        border-collapse: collapse;
        inline-size: 100%;
    }

    th {
        text-align: end;
        padding: var(--salt-spacing-2);

        :nth-child(1) {
            text-align: start;
        }
    }

    tr {
        :nth-child(even) {
            background-color: var(--intent-secondary-100);
        }
    }

    td {
        padding: var(--salt-spacing-2);

        :nth-child(1) {
            text-align: start;
        }
    }

    thead + tbody tr {
        :first-child {
            text-align: inherit;
        }
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 0;
        line-height: var(--salt-text-l-line-height);
        font-family: var(--font-family);
    }

    h1 {
        font-size: var(--salt-display-font-size);
        font-weight: 600;
    }

    h2 {
        font-size: var(--salt-text-l-font-size);
        font-weight: 600;
    }

    h3 {
        font-size: var(--salt-text-m-font-size);
        font-weight: 600;
        text-transform: uppercase;
    }

    h4,
    h5,
    h6 {
        font-size: var(--salt-text-m-font-size);
        font-weight: 600;
    }

    p,
    ul,
    ol {
        color: currentcolor;
        display: block;
        font-size: var(--salt-text-m-font-size);
        font-weight: normal;
        line-height: var(--salt-text-l-line-height);
    }

    p {
        margin: 0;
    }

    strong,
    b {
        font-weight: bold;
    }

    a {
        border-radius: var(--border-radius);
        color: var(--intent-content);
        cursor: pointer;
        display: inline-block;
        font-weight: 400;

        &:hover {
            color: var(--intent-content);
            font-weight: 400;
            text-decoration: none;
        }

        &:active {
            color: var(--intent-content);
            font-weight: 400;
            text-decoration: none;
        }
    }
`,eje=T.div`
    align-items: center;
    background-color: var(--intent-secondary-900);
    border-radius: var(--border-radius);
    color: var(--intent-secondary-contrast);
    display: inline-flex;
    ${({size:e,minSize:t})=>t?`min-block-size: ${H(jn[t])}`:`block-size: ${H(jn[e])}`};
    padding: var(--salt-spacing-2);
    vertical-align: middle;
    max-inline-size: 100%;
`,tje=T(P)`
    margin-inline-end: var(--salt-spacing-2);
`,sje={StyledTag:eje,TagText:tje},{StyledAccordionContent:nje,StyledAccordionTitle:oje,StyledIcon:rje}=bf,gW=e=>s.jsxs(oje,{type:"button","aria-expanded":e.active,...e,children:[e.children,s.jsx(rje,{height:18,width:18,name:"arrow_down",active:e.active})]}),EW=e=>s.jsx(nje,{hidden:!e.active,...e,children:e.children}),Jj=e=>e.type===gW,aje=e=>e.type===EW;class is extends h.Component{constructor(t){super(t);const n=[];let o=-1;h.Children.map(t.children,r=>{Jj(r)&&(o+=1,r.props.active&&n.push(o))}),this.state={activeIndexes:n}}static Title=gW;static Content=EW;static StyledAccordionTitle=bf.StyledAccordionTitle;static StyledAccordionContent=bf.StyledAccordionContent;static StyledIcon=bf.StyledIcon;static displayName="Accordion";handleTitleClick(t,n,o){t.preventDefault();const{activeIndexes:r}=this.state,a=r.indexOf(n)!==-1;o&&o(a),a?this.setState({activeIndexes:r.filter(i=>i!==n)}):this.setState({activeIndexes:[...new Set([...r,n])]})}renderChildren(){const{children:t}=this.props,{activeIndexes:n}=this.state,o=i=>n.indexOf(i)!==-1;let r=0,a=0;return h.Children.map(t,i=>{const l=Jj(i),c=aje(i);if(l){const{active:d,...u}=i.props,m=r,g=y=>this.handleTitleClick(y,m,i.props.onActiveToggle),f=o(r);return r+=1,h.cloneElement(i,{active:f,...u,onClick:g})}if(c){const{active:d,...u}=i.props,m=o(a);return a+=1,h.cloneElement(i,{active:m,...u})}return i})}render(){return s.jsx("div",{"data-test":this.props["data-test"],children:this.renderChildren()})}}OR.displayName="AdvertisingBanner";const FS=e=>{switch(e){case"end":case"right":return"end";case"start":case"left":return"start";default:return e}},An=T.div`
    padding-block: var(--salt-spacing-4);
    padding-inline: var(--salt-spacing-2);
    text-align: ${({align:e="left"})=>FS(e)};
`,{List:ije,Item:BS,CurrentBreadcrumbText:lje,HeadingBreadcrumb:cje,BreadcrumbLinkComponent:dje,Chevron:fW}=DLe,uje=(e,t,n)=>s.jsxs(BS,{children:[s.jsx(dje,{as:t,href:e.url,to:e.to,state:e.navigationState,onClick:()=>n?n(e):{},children:e.name}),s.jsx(fW,{height:16,width:16,name:"arrow_right","aria-hidden":"true"})]},e.id??e.name),pje=(e,t)=>s.jsx(BS,{children:s.jsx(lje,{...t,children:e.name})},e.id??e.name),mje=(e,t)=>s.jsxs(BS,{children:[s.jsx(P,{className:"salt-d--inline-block",...t,children:e}),s.jsx(fW,{name:"arrow_right","aria-hidden":"true"})]}),hje=(e,t,n,o,r)=>e.length===1&&!o?s.jsx(BS,{children:s.jsx(cje,{...r,children:e[0].name})}):e.map((a,i)=>e.length>i+1?uje(a,t,n):pje(a,r)),VR=({preface:e,trail:t,linkElement:n,"data-test":o,className:r,onClick:a,...i})=>s.jsxs(ije,{"data-test":o,className:r,children:[e&&mje(e),hje(t,n,a,e,i)]});VR.displayName="Breadcrumb";const oo=e=>{const t=h.useRef();return h.useEffect(()=>{t.current=e},[e]),t.current},yW=T.section`
    background-color: var(--intent-contrast-900);
    box-sizing: border-box;
    inset-block-end: 0;
    box-shadow: var(--salt-elevation-shadow-3);
    inset-inline: 0;
    margin: 0;
    padding: 0;
    position: fixed;
    text-align: ${({align:e})=>FS(e)};
    z-index: ${Qt["bottom-bar"]};
`,US=T.div.withConfig({shouldForwardProp:(e,t)=>!["height"].includes(e)&&t(e)})`
    block-size: ${({height:e})=>H(e)};
`,YR=({align:e="left",children:t=null,id:n,light:o=!1,className:r="",fixedBottomSpacing:a=void 0,"data-test":i=""})=>{const l=h.useRef(null),c=150,[d,u]=h.useState(c),m=oo(d),g=()=>a||document&&l.current&&l.current.offsetHeight||c;return h.useEffect(()=>{const f=g();f&&u(f)},[]),h.useEffect(()=>{const f=g();f&&m!==f&&u(f)},[d,a]),s.jsxs(h.Fragment,{children:[s.jsx(US,{height:d}),s.jsx(yW,{"data-test":i,ref:l,align:e,id:n,light:o,className:r,children:t})]})};YR.StyledBottomBar=yW;YR.displayName="BottomBar";const{Header:IW,Body:SW,Footer:CW,CardWrapper:TW,HeaderText:gje,Options:Eje}=gg.Action,fje={children:p.oneOfType([p.string,p.element,p.array]),chip:p.node,innerRef:p.oneOfType([p.shape(),p.func,p.string]),muted:p.bool,xs:p.number,sm:p.number,md:p.number,lg:p.number},yje={children:null,chip:void 0,innerRef:void 0,muted:void 0,xs:void 0,sm:void 0,md:void 0,lg:void 0},Ga=({innerRef:e,chip:t,...n})=>s.jsxs(TW,{ref:e,...n,children:[t,n.children]}),Ije=e=>s.jsxs(TW,{...e,children:[s.jsx(IW,{children:s.jsx(Pe,{className:"salt-m-b--2",height:"25px"})}),s.jsxs(SW,{children:[s.jsx(Pe,{height:"15px",className:"salt-m-b--1"}),s.jsx(Pe,{height:"15px"})]}),s.jsxs(CW,{children:[s.jsx(Pe.Button,{className:"salt-d--inline-block salt-m-r--2"}),s.jsx(Pe.Button,{className:"salt-d--inline-block"})]})]});Ga.Skeleton=Ije;Ga.defaultProps=yje;Ga.propTypes=fje;Ga.Header=IW;Ga.HeaderText=gje;Ga.Body=SW;Ga.Footer=CW;Ga.Options=Eje;Ga.displayName="Card";Ga.Skeleton.displayName="SkeletonCard";const{CardSection:Sje}=gg.Collection,Cje={children:p.oneOfType([p.string,p.element,p.array]),className:p.string,xs:p.number,sm:p.number,md:p.number,lg:p.number},Tje={children:null,className:"",xs:1,sm:1,md:3,lg:3},GS=e=>s.jsx(Sje,{...e,children:h.Children.toArray(e.children).filter(t=>t).map(t=>h.cloneElement(t,{xs:e.xs,sm:e.sm,md:e.md,lg:e.lg}))});GS.defaultProps=Tje;GS.propTypes=Cje;GS.displayName="CardCollection";const Rr={ALL_ANCHORS:"ALL_ANCHORS",ALL_SPA_LINKS:"ALL_SPA_LINKS",MIXED:"MIXED"},_je=()=>({type:Rr.ALL_ANCHORS}),ew=(e=[])=>({type:Rr.MIXED,payload:{anchorLinks:e}}),vje={type:Rr.ALL_SPA_LINKS},Aje=(e=vje,t)=>{switch(t.type){case Rr.ALL_ANCHORS:case Rr.ALL_SPA_LINKS:return{type:t.type};case Rr.MIXED:return{type:t.type,anchorLinks:[...new Set([...e.anchorLinks||[],...t.payload.anchorLinks.map(n=>n.source)])]};default:return e}},$S=({session:e})=>e.linkTypeDetector||{},bje=new RegExp("^(?:[a-z]+:)?//","i"),xje=(e,t)=>{if(bje.test(e)){const o=new URL(e);return o.pathname=`${t}${o.pathname}`,o.toString()}return`${t}${e}`},Rje=e=>{let t;return typeof e=="string"?t=e:(t=e.pathname||"",e.search&&(e.search.charAt(0)==="?"?t+=e.search:t+=`?${e.search}`)),t},Dje=()=>{const t=`(${M().formatMessage("accessibility.link.open.in.new.window")})`;return s.jsx(Ee,{children:t})};class Oje{cache;constructor(){this.cache=new Map}get(t){return this.cache.get(t)}set(t,n){this.get(t)||this.cache.set(t,n)}}const tw=new Oje,Pje=e=>{const t=E($S);return tw.get(e)?!0:t.anchorLinks?.find(o=>!!e.match(o))?(tw.set(e,!0),!0):!1},_W=h.forwardRef((e,t)=>{const{href:n,intent:o,...r}=e,{standalone:a,bold:i,size:l,...c}=r,d=o==="ghost"?c:r;return s.jsx(rt,{href:n,intent:o,ref:t,...d})}),vW=h.forwardRef((e,t)=>{const{href:n,to:o,children:r,onClick:a,onContextMenu:i,intent:l,...c}=e,{standalone:d,bold:u,size:m,...g}=c,f=l==="ghost"?g:c,y=e.state||o.state;return s.jsx(rt,{asChild:!0,onClick:a,onContextMenu:i,intent:l,ref:t,...f,children:s.jsxs(ore,{to:o,state:y,...f,children:[r,c.target==="_blank"&&s.jsx(Dje,{})]})})}),Nje=h.forwardRef((e,t)=>{const{href:n,to:o,...r}=e;return Pje(n)?s.jsx(_W,{href:n,ref:t,...r}):s.jsx(vW,{to:o,ref:t,...r})}),Qe=h.forwardRef((e,t)=>{const{href:n,to:o,...r}=e,a=E($S),i=o||n||"",l=Rje(i);return a.type===Rr.ALL_ANCHORS?s.jsx(_W,{href:l,ref:t,...r}):a.type===Rr.MIXED?s.jsx(Nje,{href:l,to:i,ref:t,...r}):s.jsx(vW,{to:i,ref:t,...r})});Qe.displayName="WrappedLink";const{Base:Lje,Body:sw,ImageWrapper:nw,StyledImage:ow,TitleWrapper:AW,Content:kje,Title:Mje,BasePlaceholder:jje,ImagePlaceholder:bW,TitlePlaceholder:wje,ContentPlaceholder:Fje}=gg.MediaNavigation,Bje=T(bW)`
    background-color: var(--intent-secondary-200);
`,Uje=T(AW)`
    padding-inline-end: 0;
`,Gje=T.img`
    object-fit: cover;
    object-position: center;
    inline-size: 100%;
    vertical-align: middle;
`,WR=ie.forwardRef(({variant:e="default",formatting:t="normal",dynamicHeight:n=!1,src:o,breakpointSrcSet:r,fallbackSrc:a,typeSrcSet:i,href:l,target:c,alt:d,title:u,content:m,onClick:g,to:f,navigationState:y,isLoading:I,loading:S="lazy",decoding:C="async",showContentPlaceholder:_,titleDataTest:A,truncateTitle:x,className:R},O)=>{if(I)return s.jsx(jje,{"data-test":"media-navigation-card-base-placeholder",formatting:t,className:R,children:s.jsxs(sw,{children:[s.jsx(nw,{variant:e,children:s.jsx(bW,{"data-test":"media-navigation-card-image-placeholder"})}),s.jsxs(AW,{children:[s.jsx(wje,{"data-test":"media-navigation-card-title-placeholder"}),_&&s.jsx(Fje,{"data-test":"media-navigation-card-content-placeholder"})]})]})});const N=()=>n&&r?s.jsxs("picture",{"data-test":"media-navigation-card-picture",children:[Object.entries(r).map(([k,j])=>{const[w,L]=j;return s.jsxs(ie.Fragment,{children:[s.jsx("source",{media:Hi[k],srcSet:w,type:"image/avif"},k),s.jsx("source",{media:Hi[k],srcSet:L,type:"image/webp"},k)]})}),s.jsx(Gje,{src:a,alt:d,loading:S,decoding:C})]}):i?s.jsxs("picture",{"data-test":"media-navigation-card-picture",children:[Object.entries(i).map(([k,j])=>s.jsx("source",{srcSet:j,type:k})),s.jsx(ow,{src:a,alt:d,loading:S,decoding:C})]}):o?s.jsx(ow,{alt:d,src:o}):s.jsx(Bje,{});return s.jsx(Lje,{ref:O,as:f?Qe:rt,...f?{to:f}:{href:l},formatting:t,target:c,state:y,onClick:g,className:R,children:s.jsxs(sw,{children:[s.jsx(nw,{variant:e,children:N()}),s.jsxs(Uje,{children:[s.jsx(Mje,{"data-test":A,...x&&{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:u}),m&&s.jsx(kje,{children:m})]})]})})}),{MediaCardSection:qR}=gg.MediaCollection,$je={formatting:p.oneOf(["normal","small"]),gridVariant:p.oneOf(["auto-fill","auto-fit"])},Hje={formatting:"normal",gridVariant:"auto-fill"};qR.propTypes=$je;qR.defaultProps=Hje;const He={Collection:GS,Action:Ga,MediaNavigationCard:WR,MediaCardCollection:qR},{Dot:rw,IndicatorContainer:Vje}=PS,aw="md",du=6,Yje=({currentIndex:e,numberOfItems:t})=>{const[n,o]=h.useState(1),r=h.useRef(e);h.useEffect(()=>{const i=Math.min(du,t);e===0?o(1):e===t-1?o(i):e-r.current>1||e-r.current===0?e<i-2?o(e+1):o(i-1):e>r.current?n!==i-1&&o(n+1):e<r.current&&n!==2&&o(n-1),r.current=e},[e]);const a=h.useMemo(()=>{const i=[];if(t<=du)for(let l=0;l<t;l+=1){const c=l===e;i.push(s.jsx(rw,{size:aw,active:c,"data-test-type":`${aw}${c?"-active":""}`},l))}else{const l=e+1===t,c=e>0&&!l;for(let d=0;d<du;d+=1){let u="md";l?(d===0&&(u="xs"),d===1&&(u="sm")):c?(d===0||d===du-1)&&(u="sm"):(d===du-1&&(u="xs"),d===du-2&&(u="sm"));const m=d===n-1;i.push(s.jsx(rw,{active:m,size:u,"data-test-type":`${u}${m?"-active":""}`},d))}}return i},[e,t,n]);return s.jsx(Vje,{"data-test":"carousel-v2-indicator-container",children:a})},{Controls:Wje,ControlsInnerContainer:qje}=PS,IA=T(b)`
    cursor: pointer;
`,Kje=T(IA)`
    inline-size: ${H(28)};
`,zje=T(Zn)`
    block-size: ${H(15)};
`,Qje=(e,t)=>e<0?t-1:e>=t?0:e,xW=({isPaused:e,currentIndex:t,numberOfItems:n,handleNextButtonPress:o,handlePauseButtonPress:r,handlePrevButtonPress:a})=>{const{formatMessage:i}=M(),l=e?"pause":"play";return s.jsxs(Wje,{"data-test":"carousel-v2-controls",role:"toolbar",children:[s.jsx(IA,{"data-test":"carousel-v2-controls-left-button",intent:"tertiary",size:"s",fill:!1,onClick:a,"aria-label":i("scroller.accessibility.viewPrevious"),children:s.jsx(b.Icon,{name:"arrow_left"})}),s.jsxs(qje,{children:[s.jsx(Kje,{"data-test":`carousel-v2-controls-${l}-button`,intent:"tertiary",size:"s",fill:!1,onClick:r,"aria-label":i(`scroller.accessibility.${l}`),children:s.jsx(b.Icon,{name:l})}),s.jsx(zje,{orientation:"vertical"}),s.jsx(Yje,{currentIndex:Qje(t,n),numberOfItems:n})]}),s.jsx(IA,{"data-test":"carousel-v2-controls-right-button",intent:"tertiary",size:"s",fill:!1,onClick:o,"aria-label":i("scroller.accessibility.viewNext"),children:s.jsx(b.Icon,{name:"arrow_right"})})]})},{Body:Xje,ItemsContainer:Zje,Item:Jje}=PS,v_=(e,t,n)=>{if(!h.isValidElement(e))return null;const o={"data-id":t,...n&&{"data-test":`carousel-v2-item-hidden-${t}`},...n&&{tabIndex:-1}};return s.jsx(Jje,{children:h.cloneElement(e,{...o})},t.toString())},ewe=({bodyRef:e,itemsContainerRef:t,currentIndex:n,children:o,onMouseEnter:r,onMouseLeave:a,onBodyKeyDown:i,onBodyFocus:l,onBodyBlur:c})=>s.jsx(Xje,{tabIndex:-1,ref:e,"data-test":`carousel-v2-body-selected-${n}`,onKeyDown:i,onFocus:l,onBlur:c,children:s.jsxs(Zje,{tabIndex:-1,ref:t,applyEqualWidth:!0,"data-test":"carousel-v2-body-container",snapAlignment:"center",onMouseEnter:r,onMouseLeave:a,children:[o.length>1&&v_(o[o.length-1],o.length,!0),o.map((u,m)=>v_(u,m)),o.length>1&&v_(o[0],-1,!0)]})}),RW=({onVisibilityChange:e})=>{const t=()=>document.visibilityState==="visible",n=()=>e(t());h.useEffect(()=>(document.addEventListener("visibilitychange",n,!1),()=>{document.removeEventListener("visibilitychange",n)}),[])},twe=(e,t=5e3,n=500)=>{const[o,r]=h.useState(t),[a,i]=h.useState(n),[l,c]=h.useState([]);RW({onVisibilityChange:y=>{y?f("focus"):g("focus")}});const d=l.length!==0;h.useEffect(()=>{if(n&&a===0){const y=setTimeout(()=>{r(t)},n);return()=>{clearTimeout(y)}}return()=>{}},[a,t,n]),h.useEffect(()=>{if(e===void 0||d)return;const y=o!==0;e&&y||!e&&!y||(e&&!y&&m(),!e&&y&&u())},[e,d,o]);const u=h.useCallback(()=>{n&&i(n),r(0)},[n]),m=h.useCallback(()=>{n&&i(0),r(a||t)},[n,a,t]),g=y=>{c(I=>[...I,y]),u()},f=y=>{c(I=>{const S=I.filter(C=>C!==y);return S.length===0&&m(),S})};return{autoPlayIntervalMs:o,pauseCarousel:g,resumeCarousel:f}},swe=(e,t)=>{const n=h.useRef(),o=h.useRef();h.useEffect(()=>{n.current=e},[e]),h.useEffect(()=>(a(t),()=>{r()}),[t]);const r=h.useCallback(()=>{o.current&&(clearInterval(o.current),o.current=void 0)},[]),a=h.useCallback(i=>{r(),t&&(o.current=setInterval(()=>{n.current?.()},i||t))},[t]);return[a,r]},nwe=45,owe=(e,t)=>{const n=e.clientX-t.clientX,o=e.clientY-t.clientY;return Math.atan2(Math.abs(o),Math.abs(n))*180/Math.PI},iw=e=>e<=nwe,rwe=({ref:e,eventHandlers:t})=>{const{onNext:n,onPause:o,onPrev:r,onResetToCurrent:a,onResume:i}=t,[l,c]=h.useState({clientX:0,clientY:0});let d;const u=f=>{if(f.changedTouches.length!==1)return;const{clientX:y,clientY:I}=f.changedTouches[0];c({clientX:y,clientY:I}),o("mouse")},m=h.useCallback(f=>{if(d!==void 0&&iw(d)){const{clientX:y}=l,{clientX:I}=f.changedTouches[0];I>y?r():n()}else a();i("mouse"),d=void 0},[l]),g=f=>{if(d===void 0&&(d=owe(l,f.changedTouches[0])),iw(d)){f.preventDefault();const y=f.target.closest("li");if(y){const I=l.clientX-f.changedTouches[0].clientX;e.current?.scroll?.({left:y.offsetLeft+I,behavior:"instant"})}}};h.useEffect(()=>(e.current&&(e.current.addEventListener("touchstart",u,{passive:!0}),e.current.addEventListener("touchend",m,{passive:!0}),e.current.addEventListener("touchmove",g)),()=>{e.current?.removeEventListener("touchstart",u),e.current?.removeEventListener("touchend",m),e.current?.removeEventListener("touchmove",g)}),[e.current,m])},awe=5,iwe=3,lwe=10,cwe=250,dwe=(e,t,n)=>{const[o,r]=h.useState(new Array(awe).fill(0)),a=h.useMemo(()=>Jr(c=>{c<0?t():e()},cwe,{leading:!0,trailing:!1}),[n.current]),i=(c,d)=>!!(c.some(u=>d>u*iwe)||c.every(u=>u===d)&&d>lwe),l=c=>{const d=Math.abs(c.deltaX),u=Math.abs(c.deltaY);d>u&&(c.preventDefault(),c.deltaMode!==WheelEvent.DOM_DELTA_PIXEL?a(c.deltaX):(i(o,d)&&a(c.deltaX),r(m=>[...m.slice(1),d])))};h.useEffect(()=>(n.current&&n.current.addEventListener("wheel",l),()=>{n.current?.removeEventListener("wheel",l)}),[n.current,o])},uwe=(e,t,n)=>{const o=r=>{const a=["ArrowLeft","ArrowRight"],i=r.key,l={ArrowLeft:t,ArrowRight:e};a.includes(i)&&l[i]?.(r)};h.useEffect(()=>(n.current&&n.current.addEventListener("keydown",o),()=>{n.current?.removeEventListener("keydown",o)}),[n.current])},pwe=(e,t,n)=>{const[o,r]=h.useState(!1),a=(c,d="smooth")=>{if(!e.current||!t)return;const u=t[c+1];!u||typeof u?.offsetLeft!="number"||e.current.scroll?.({left:u.offsetLeft,behavior:o?"instant":d})};h.useEffect(()=>{if(window){const{matches:c}=window.matchMedia("(prefers-reduced-motion)");r(c)}},[]),rwe({ref:e,eventHandlers:n});const{onNext:i,onPrev:l}=n;return dwe(i,l,e),uwe(i,l,e),{scrollToCarouselItem:a}},mwe=2,hwe=({bodyRef:e,listChildren:t,length:n,moveToItem:o})=>{const r=()=>{if(!(t&&e.current))return;const a=Math.abs(e.current.scrollLeft-t[t.length-1].offsetLeft)<mwe;e.current.scrollLeft===0?o(n-1):a&&o(0)};h.useEffect(()=>(e.current?.addEventListener("scroll",r,{passive:!0}),()=>{e.current?.removeEventListener("scroll",r)}),[e,t,n,o])},gwe=(e,t,n,o)=>{const r=h.useRef(null);h.useEffect(()=>{if(!e?.current)return;const a=()=>{o(n,"instant")},i=new ResizeObserver(l=>{const d=l[0]?.contentRect.width??0;d!==0&&(!r.current||r.current?.width!==d)&&(r.current={width:d},a())});return i.observe(e.current),()=>i.disconnect()},[e?.current,t,n])},{Container:Ewe}=PS,fwe=750,ywe=e=>[...e].every(t=>t instanceof HTMLElement),Iwe=({isVisible:e,startFromIndex:t=0,activeItemIndex:n,loopIntervalMs:o,playDelayMs:r,areControlsHidden:a,children:i,fwBodyRef:l,onCurrentIndexChange:c,...d},u)=>{const m=h.useRef(null),g=l||m,f=h.useMemo(()=>i?.length||0,[i]),y=f>1,[I,S]=h.useState(!1),[C,_]=h.useState(t),[A,x]=h.useState(),{autoPlayIntervalMs:R,pauseCarousel:O,resumeCarousel:N}=twe(e,o,r),[k]=swe(()=>{B()},y?R:0),j=h.useCallback(de=>{de&&x(ywe(de.children)?de.children:void 0)},[]),w=de=>A?.[de+1]?.querySelector("a")?.focus();h.useEffect(()=>{c(C);let de;return I&&(de=setTimeout(()=>w(C),fwe)),()=>{de&&clearTimeout(de)}},[C,I]);const L=h.useCallback(de=>{R&&k();const ye=de??C;K(ye,"auto"),_(ye)},[A,R]);hwe({bodyRef:g,listChildren:A,length:f,moveToItem:L}),h.useEffect(()=>{n!==void 0&&L(n)},[n]);const B=de=>{de?.preventDefault(),R&&k(),S(!!de),_(ye=>{const Ae=ye+1;return K(Ae),Ae})},W=de=>{de?.preventDefault(),R&&k(),S(!!de),_(ye=>{const Ae=ye-1;return K(Ae),Ae})},$=de=>{const ye=C+(de.shiftKey?-1:1);ye<f&&ye>-1&&(de.preventDefault(),R&&k(),S(!1),_(ye),w(ye))},{scrollToCarouselItem:K}=pwe(g,A,{onNext:B,onResetToCurrent:()=>K(C),onResume:N,onPause:O,onPrev:W});gwe(g,A,C,K);const Q=()=>{R?O("button"):N("button")},X=h.useCallback(()=>O("mouse"),[]),re=h.useCallback(()=>N("mouse"),[]),ue=h.useCallback(de=>{const ye=de.relatedTarget;g.current&&!g.current.contains(ye)&&(O("focus"),w(C))},[C]),te=h.useCallback(de=>{const ye=de.relatedTarget;g.current&&!g.current.contains(ye)&&N("focus")},[]),ce=de=>{de.key==="Tab"&&$(de)};return h.useEffect(()=>{R&&k(),K(t,"auto"),_(t)},[t,A]),h.useEffect(()=>{const de=C===0,ye=C===f-1;(de||ye)&&K(C)},[C]),s.jsxs(Ewe,{ref:u,...d,children:[y&&!a&&s.jsx(xW,{isPaused:!!R,currentIndex:C,numberOfItems:f,handlePrevButtonPress:()=>W(),handleNextButtonPress:()=>B(),handlePauseButtonPress:Q}),s.jsx(ewe,{bodyRef:g,itemsContainerRef:j,currentIndex:C,onMouseEnter:X,onMouseLeave:re,onBodyKeyDown:ce,onBodyFocus:ue,onBodyBlur:te,children:i})]})},Swe=h.forwardRef(Iwe),Cwe={expanded:!1,onToggle:()=>{},aria:void 0,name:void 0},HS=ie.createContext(Cwe),VS=()=>h.useContext(HS),Twe=T.button`
    padding-block: 0;
    padding-inline: 0;
    background: transparent;
    border: none;
    color: currentcolor;
    inline-size: 100%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    text-align: start;
`,_we=({children:e})=>{const{expanded:t,onToggle:n,aria:o,name:r}=VS();return s.jsx(Twe,{type:"button",onClick:n,"aria-label":t?o?.expandedLabel:o?.collapsedLabel,"aria-expanded":t,"data-test":`${r||"collapsible-box"}-control-section-${t?"expanded":"collapsed"}`,children:e})},DW="all 300ms ease-in-out;",OW="ADD_MISSED_PROMOTIONS",vwe=e=>({type:OW,payload:e}),Ao={addMissedPromotions:vwe,types:{ADD_MISSED_PROMOTIONS:OW}},Awe=D("cat.evt"),bwe=D("seo.cf"),KR=D("di"),PW=({uri:e,category:t,filters:n,sortOption:o,offset:r,pageToken:a,isRetailerCategoryId:i,additionalParams:l})=>(c,d)=>c(ft.getCataloguePage(e,t,n,o,r,a,i,l)).then(u=>{if(!u)return;const{payload:{responseData:m}}=u,{entities:g,categoryEvent:f,richTextContent:y,result:{productGroups:I,missedPromotions:S,breadcrumbs:C,retailerCategoryId:_}}=m,A=d();return c(Ft.setProducts(g)),Rwe(c,{uri:e,category:t,filters:n,sortOption:o,pageToken:a,isRetailerCategoryId:i,additionalParams:l},m),S?.length&&c(Ao.addMissedPromotions(S)),Awe(A)&&(c(Cr.resetCategoryEvent()),f&&c(Cr.setCategoryEvent(f))),bwe(A)&&(c(Cr.resetCategoryRichTextContentEvent()),y&&c(Cr.setCategoryRichTextContent(y))),{products:ng()(m),productGroups:I,breadcrumbs:C,retailerCategoryId:_}}),xwe=({uri:e,category:t,filters:n={},sortOption:o=void 0,pageToken:r,additionalParams:a={},isRetailerCategoryId:i})=>l=>l(ft.getNextCataloguePage(e,t,n,o,r,a,i)).then(c=>{if(!c)return;const{payload:{responseData:d}}=c,{entities:u,result:{productGroups:m,missedPromotions:g,nextPageToken:f}}=d;return l(Ft.setProducts(u)),g?.length&&l(Ao.addMissedPromotions(g)),{products:ng()(d),nextPageToken:f,productCount:yp(m).length}}),Rwe=(e,t,n)=>{const{uri:o,category:r,filters:a,sortOption:i,pageToken:l,isRetailerCategoryId:c,additionalParams:d}=t,{entities:u,result:{productGroups:m}}=n,g=m?.find(y=>y.type==="featured_cross_sell")?.products;if(g?.find(y=>!u.product[y])){const I=m.reduce((S,{products:C})=>[...S,...C],[]).findIndex(S=>S===g[0]);e(ft.getCataloguePage(o,r,a,i,I,l,c,d,!0)).then(({payload:{responseData:S}})=>{e(Ft.setProducts(S.entities))})}},Dwe=(e,t,n)=>{const o=e.map(a=>a.id);if(n)return o;const r=Ts(t);return o.filter(a=>!r[a])},Owe=(e={},t={})=>Object.entries(e).reduce((n,[o,r])=>{const a=t[o];return a&&!a.featuredProductCampaign?{...n,[o]:{...a,featuredProductCampaign:{...r}}}:n},{}),lw=(e={},t={},n=[])=>{const o={};if(n.forEach(a=>{o[a.productId]=a}),!Object.keys(t).length)return o;const r=Owe(t,{...e,...o});return{...o,...r}},Pwe=(e,t,n)=>{const o=io(t);return e(Ft.decorateProductsPPWSAction(n)).then(r=>{const{payload:{responseData:a}}=r,i={};return a.products.forEach(l=>{i[l.productId]=tl(l,o??[],KR(t))}),a.missedPromotions?.length&&e(Ao.addMissedPromotions(a.missedPromotions)),e(Ft.setProducts({product:i}))})},Ci=({products:e,ignoreProductCache:t=!1,featuredProductsData:n={},updateProducts:o=!1})=>(r,a)=>{const i=a(),l=Dwe(e,i,t);if(l.filter(d=>!!d).length===0){if(!Object.keys(n).length)return Promise.resolve();const d=lw(Ts(i),n);return Object.keys(d).length&&r(Ft.setProducts({product:d})),Promise.resolve()}return r(Ft.decorateProductsPPWSAction(l)).then(d=>{const{payload:{responseData:u}}=d,m=u.products.map(f=>tl(f,io(i)??[],KR(i))),g=lw(Ts(i),n,m);return u.missedPromotions?.length&&r(Ao.addMissedPromotions(u.missedPromotions)),r(o?Ft.updateProducts({product:g?Object.values(g):[],upsert:!0}):Ft.setProducts({product:g}))})},Nwe=({productIds:e,ignoreProductCache:t=!1})=>(n,o)=>{const r=o(),a=Ts(r),i=t?e:e.filter(l=>!a[l]);return i.filter(l=>!!l).length===0?Promise.resolve():n(Ft.decorateProductsPPWSAction(i)).then(l=>{const{payload:{responseData:c}}=l,d={};return c.products.forEach(u=>{d[u.productId]=tl(u,io(r)??[],KR(r))}),c.missedPromotions?.length&&n(Ao.addMissedPromotions(c.missedPromotions)),n(Ft.setProducts({product:d}))})},NW=e=>(t,n)=>{const o=n();return Pwe(t,o,e)},zR=ee("GET_BASKET_PRODUCTS"),LW="SET_BASKET_FETCHING_DONE",Lwe=()=>({type:"API",payload:{url:"/v5/products/basket",...zR}}),kwe=({limit:e,transformerConfig:t})=>({type:"API",payload:{url:`/v5/product-pages/basket?limit=${e}`,service:"web_product_page_ws",pathPrefix:{client:"/api/webproductpagews",server:"/core-api"},...zR},transformerConfig:t}),Mwe=()=>({type:LW}),Nc={getBasketProducts:Lwe,getPPWSBasketProducts:kwe,setFetchingDone:Mwe,types:{GET_BASKET_PRODUCTS:zR,SET_BASKET_FETCHING_DONE:LW}},cw=D("b.ppws"),dw=D("seo.rdbl"),uw=D("di"),nc=()=>(e,t)=>{const n=t(),o=Sae(n),r={imageFormats:io(n)??[],isSEOReadableURLEnabled:dw(n),isDynamicImagesEnabled:uw(n)},a={limit:o,transformerConfig:r},i=cw(n)?Nc.getPPWSBasketProducts:Nc.getBasketProducts;return e(i(a)).then(l=>{if(l){let{payload:{responseData:c}}=l;cw(n)&&(c=ch(c,io(n)??[],dw(n),uw(n)));const{entities:d,result:u}=c;for(const g in d.product)d.product[g]===void 0&&delete d.product[g];e(Ft.updateProducts({product:d.product?Object.values(d.product):[],upsert:!0}));const{missedPromotions:m}=u||{};m?.length&&e(Ao.addMissedPromotions(m))}}).then(()=>{e(Nc.setFetchingDone())})},jwe=e=>({event:"page_view",session_id:e.sessionId,page_view_id:e.pageViewId,page_type:e.pagePartType||e.pageType,customer_id:e.customerId,osp_transaction_id:e.ospTransactionId,transaction_type:e.isBasketUnderEdit?"edit":"new",region_id:e.regionId,banner_id:e.bannerId,region_name:e.regionName,banner_name:e.bannerName,cart_value:e.basketTotalAmount?Number(e.basketTotalAmount):null,customer_email:e.customerData?.data?.email,customer_first_name:e.customerData?.data?.["attr.firstName"],customer_last_name:e.customerData?.data?.["attr.surname"],is_logged_in:!!e.isLoggedIn}),wwe=e=>({event:"pageview",page:e.page,pageViewId:e.pageViewId,pageType:e.pagePartType||e.pageType,sessionId:e.sessionId,loggedInStatus:e.isLoggedIn,retailerCustomerId:e.customerId,customerEmail:e.customerData?.data?.email,customerFirstname:e.customerData?.data?.["attr.firstName"],customerLastname:e.customerData?.data?.["attr.surname"],transactionId:e.ospTransactionId,source:e.source,basketTotalAmount:e.basketTotalAmount}),Fwe=e=>!e.isSendingSegmentsToDatalayerEnabled||!e.isLoggedIn?null:{event:"active_segments",...(e.customerSegments||[]).reduce((n,o)=>({...n,[o.name]:o.shortCodes}),{})},Lc=(e,t={})=>{const n=Kl(e),o=On(e),r=Td(e,window.location),a=ua(e),i=At(e),l=Mr(e),c=ar(e),d=Qh(e),u=eS(e),m=fd(e),g=pa(e)?.amount,f=ec(e),y=Ze(e),I=D("seg.dl")(e),S=fR(e)?.customerSegments,{pagePartType:C,source:_,page:A}=t,x=()=>{const k=jwe({sessionId:n,pageViewId:o,pageType:r,pagePartType:C,customerId:a,ospTransactionId:i,isBasketUnderEdit:l,regionId:c,bannerId:d,regionName:u,bannerName:m,basketTotalAmount:g,customerData:f,isLoggedIn:y});J.sendEvent({GA:k,WA:null})},R=()=>{const k=wwe({page:A,pageViewId:o,pagePartType:C,pageType:r,sessionId:n,isLoggedIn:y,customerId:a,customerData:f,ospTransactionId:i,source:_,basketTotalAmount:g});J.sendEvent({GA:k,WA:null})},O=()=>{const k=Fwe({isSendingSegmentsToDatalayerEnabled:I,isLoggedIn:y,customerSegments:S});J.sendEvent({GA:k,WA:null})};return{sendGA4Event:x,sendUAEvent:R,sendActiveSegmentsEvent:O,sendPageViewEvent:()=>{x(),R(),O()}}},QR=()=>{const e=lp();return{sendUAPageViewEvent:a=>{Lc(e.getState(),a).sendUAEvent()},sendGA4PageViewEvent:()=>{Lc(e.getState()).sendGA4Event()},sendActiveSegmentsEvent:()=>{Lc(e.getState()).sendActiveSegmentsEvent()},sendPageViewEvent:a=>{Lc(e.getState(),a).sendPageViewEvent()}}},ji={INITIAL:"INITIAL",LOADING:"LOADING",LOADED:"LOADED"},Bwe="EXPANDED_TROLLEY",yh="expandedTrolley",Uwe={loadingState:ji.INITIAL,setLoadingState:()=>{}},Gwe=7,kW=ie.createContext(Uwe),XR=()=>h.useContext(kW),fg=()=>E(zl),ZR=(e,t)=>{const[n,o]=h.useState(e);return h.useEffect(()=>{const r=setTimeout(()=>o(e),t);return()=>{clearTimeout(r)}},[e,t]),n},$we=()=>{const[e,t]=h.useState([]),n=E(Ts),{loadingState:o,setLoadingState:r}=XR();return h.useEffect(()=>{if(!e.length)return;o!==ji.LOADING&&r(ji.LOADING);const a=e.filter(i=>!n[i]);$i(e,a)||(!a.length&&o!==ji.LOADED&&r(ji.LOADED),t(a))},[e,o,n,r]),{loadingIds:e,setLoadingIds:t}},Hwe=()=>{const t=F(),{loadingIds:n,setLoadingIds:o}=$we(),r=h.useCallback(a=>{const i=a.slice(0,25);t(Ci({products:i.map(c=>({id:c})),updateProducts:!0})),o([...n,...i]);const l=a.slice(25);l.length&&setTimeout(()=>r(l),250)},[t,n,o]);return r},JR=()=>{const e=E(Ts),t=fg(),n=Hwe(),[o,r]=h.useState([]),a=h.useCallback(l=>{const c=t.findIndex(({productId:u})=>u===l);if(c===-1)return;const d=t.slice(0,c+2).filter(({productId:u})=>!e[u]&&!o.includes(u)).map(({productId:u})=>u);r([...new Set([...o,...d])])},[t,o,e]),i=ZR(o,250);return h.useEffect(()=>{i.length!==0&&(n(i),r(o.filter(l=>!i.includes(l))))},[i]),a},eD=()=>{const e=F(),t=Ne(),{sendUAPageViewEvent:n}=QR();return h.useCallback(o=>{e(_f(t,o)),n({page:t.pathname,pagePartType:o})},[e,t])},Vwe=()=>{const e=F(),t=E(Ue(yh)),n=eD();return h.useCallback(()=>{t||(e(Z.openModal(yh)),n(Bwe))},[e,t,n])},MW=(e=!0)=>{const t=F(),{setLoadingState:n}=XR(),o=E(Ue(yh)),r=eD();return h.useCallback(()=>{o&&(t(Z.closeModal()),e&&r(),n(ji.INITIAL))},[o,t,e,n,r])},Ywe=e=>{const t=Ne(),n=oo(t);h.useEffect(()=>{!t||$i(n,t)||e()},[n,t,e]),h.useEffect(()=>(window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}))},Wwe=()=>{const e=JR(),t=fg(),n=E(r=>qe(r,"seller-sales-enabled")==="true"),o=E(lS);h.useEffect(()=>{(n?o?.reduce((a,i)=>[...a,...i?.items?.map(l=>l)||[]],[]):t?.map(({productId:a})=>a))?.slice(0,Gwe)?.forEach(a=>e(a))},[])},qwe=()=>{const e=F(),t=E(Ue(yh)),n=oo(t),o=h.useRef(!1);h.useEffect(()=>{!o.current&&n!==void 0&&n!==t&&t&&(o.current=!0,e(nc()))},[n,t,e])},Kwe=e=>{const t=h.useRef(null);return h.useLayoutEffect(()=>{const n=t?.current;if(!n)return()=>{};const o=new ResizeObserver(([r])=>{e(n,r)});return o.observe(n),()=>{o.disconnect()}},[e,t]),t},jW=()=>{const[e,t]=h.useState(void 0),n=ZR(e,250),o=h.useCallback(a=>{const i=a?.clientHeight;i&&t(`${i}px`)},[]);return[Kwe(o),n]},tD=T.div`
    ${({isExpanded:e,overflow:t})=>e&&t?`overflow: ${t};`:`
        overflow-x: hidden;
        overflow-y: auto;
    `}
`,wW=T(tD)`
    transition: ${DW};
    ${({isExpanded:e,maxHeight:t,isScrollHidden:n})=>e?`
        opacity: 1;
        visibility: visible;
        ${n?"overflow: hidden;":""}
        ${t?`max-block-size: ${t};`:""}
    `:`
        opacity: 0;
        ${n?"visibility: visible;":"visibility: hidden;"}
        ${n?"overflow: hidden;":""}
        max-block-size: 0px;
    `}
`,zwe=({children:e,maxHeight:t,overflow:n,isScrollHidden:o})=>{const{expanded:r,name:a}=VS(),[i,l]=jW();return s.jsx(wW,{isExpanded:r,"aria-hidden":!r,maxHeight:t||l,overflow:n,isScrollHidden:o,"data-test":`${a||"collapsible-box"}-content-expanded`,children:s.jsx(tD,{ref:i,isExpanded:r,overflow:n,children:e})})},Qwe=T(me)`
    transform: ${({down:e})=>e?"rotate(0deg)":"rotate(180deg)"};
    fill: currentcolor;
    transition: ${DW};
`,Xwe=T.span`
    display: flex;
    align-items: center;
    margin-inline-start: var(--salt-spacing-2);
`,Zwe=()=>{const{expanded:e,name:t}=VS();return s.jsx(Xwe,{"data-test":`${t||"collapsible-box"}-toggle-switch`,children:s.jsx(Qwe,{down:!e,name:"arrow_down",height:18,width:18})})},Jwe=({children:e,maxHeight:t})=>{const{expanded:n,name:o}=VS(),[r,a]=jW();return s.jsx(wW,{isExpanded:!n,"aria-hidden":n,maxHeight:t||a,"data-test":`${o||"collapsible-box"}-content-collapsed`,children:s.jsx(tD,{ref:r,children:e})})},st=({expanded:e=!1,children:t,onToggle:n=()=>{},aria:o,name:r})=>s.jsx(HS.Provider,{value:{expanded:e,onToggle:n,aria:o,name:r},children:s.jsx(ve,{children:t})});st.ControlSection=_we;st.ToggleSwitch=Zwe;st.ContentExpanded=zwe;st.ContentCollapsed=Jwe;st.displayName="CollapsibleBox";const Pn=h.createContext({currentBreakpoint:void 0}),FW=({children:e})=>{const[t,n]=h.useState(void 0);return h.useEffect(()=>{const o=Object.keys(Hi).map(i=>({breakpoint:i,result:window.matchMedia(Hi[i])})),r={xs:()=>{},sm:()=>{},md:()=>{},lg:()=>{}};o.forEach(({breakpoint:i,result:l})=>{r[i]=c=>{c.matches&&n(i)};try{l.addEventListener("change",r[i])}catch{l.addListener(r[i])}});const a=o.find(({result:i})=>i.matches);return a&&n(a.breakpoint),()=>{o.forEach(({breakpoint:i,result:l})=>{try{l.removeEventListener("change",r[i])}catch{l.removeListener(r[i])}})}},[]),s.jsx(Pn.Provider,{value:{currentBreakpoint:t},children:e})};FW.displayName="BreakpointsProvider";const Ih=({currentBreakpoint:e,breakpoint:t})=>{if(!e||!t||!(e in Ke)||!(t in or))return!1;const n=Ke[e],o=Ke[or[t].breakpointKey];return n<o},eFe={breakpoint:p.oneOf(["sm-up","md-up","lg-up"]),children:p.oneOfType([p.arrayOf(p.node),p.node]).isRequired,display:p.string,remainInDom:p.bool},tFe={breakpoint:null,display:"block",remainInDom:!0},sFe=T.div.withConfig({shouldForwardProp:(e,t)=>!["display"].includes(e)&&t(e)})`
    display: ${({display:e})=>e};

    ${({breakpoint:e})=>oe[or[e].mediaQueryKey]`
        display: none;
    `}
`,Kt=({children:e,breakpoint:t,display:n,remainInDom:o})=>{const{currentBreakpoint:r}=h.useContext(Pn);return o?s.jsx(sFe,{breakpoint:t,display:n,children:e}):Ih({currentBreakpoint:r,breakpoint:t})?e:null};Kt.defaultProps=tFe;Kt.propTypes=eFe;const BW=({children:e,renderTo:t})=>{if(typeof window>"u")return null;const n=document.querySelector(t);return n?Boe.createPortal(e,n):null},sD="transition: all 0.3s ease-in-out;",UW=16,nFe=28,oFe=jn.md,rFe=2,aFe=2*UW+rFe,GW=aFe+oFe+nFe+UW,$W=ie.createContext(),YS=()=>h.useContext($W),iFe={children:p.element},lFe={children:null},cFe=T.div`
    inset: 0;
    position: fixed;
    background-color: rgb(0 0 0 / 75%);
    opacity: 0.7;
    ${sD}
    ${({expanded:e})=>!e&&`
        opacity: 0;
        visibility: hidden;
    `}
    z-index: ${Qt.overlay};

    ${({breakpoint:e})=>oe[or[e].mediaQueryKey]`
            display: none;
    `}
`,dFe=T.div`
    ${({sticky:e})=>e?`
        position: fixed;
        inset-block-end: 0;
        z-index: ${Qt["collapsible-box"]};
    `:`
        position: static;
        inset-block-end: auto;
    `};
    inset-inline: 0;
    ${({sticky:e,breakpoint:t})=>e?oe[or[t].mediaQueryKey]`
            position: static;
            inset-block-end: auto;
            z-index: 1;
    `:""}
`,uFe=De`
    ${oe.sm`
        border-end-end-radius: 0;
        border-end-start-radius: 0;
        box-shadow: var(--salt-elevation-shadow-3);
    `}
    ${oe.md`
        border-end-end-radius: 0;
        border-end-start-radius: 0;
        box-shadow: var(--salt-elevation-shadow-3);
    `}
`,pFe=T(ve)`
    ${({breakpoint:e})=>e==="lg-up"&&uFe}

    ${oe.xs`
        border-end-end-radius: 0;
        border-end-start-radius: 0;
        box-shadow: var(--salt-elevation-shadow-3);
    `}
`,nD=({children:e})=>{const{breakpoint:t,expanded:n,onToggle:o,stickyBarEnabled:r,name:a}=YS();return s.jsxs(h.Fragment,{children:[r&&s.jsx(cFe,{expanded:n,onClick:o,breakpoint:t}),s.jsx(dFe,{sticky:r,breakpoint:t,id:a?`${a}-summary-box`:"summary-box","data-test":`${a||"styled-summary"}-box`,children:s.jsx(pFe,{breakpoint:t,children:e})})]})};nD.propTypes=iFe;nD.defaultProps=lFe;const mFe={children:p.node},hFe={children:null},gFe=T.button`
    padding-inline: 0;
    padding-block: 0;
    background: transparent;
    border: none;
    color: currentcolor;
    inline-size: 100%;
    cursor: pointer;
`,EFe=T.span`
    display: flex;
    align-items: center;
    justify-content: space-between;
    text-align: start;
`,oD=({children:e})=>{const{breakpoint:t,expanded:n,onToggle:o,name:r,aria:a}=YS(),{formatMessage:i}=M(),l=i("order.details.summary.title"),c=i("summary.total"),d=()=>a?.contentLabel&&a?.totalPrice?`${a?.contentLabel} - ${c} ${a?.totalPrice}`:a?.contentLabel?a?.contentLabel:a?.totalPrice?`${l} - ${c} ${a?.totalPrice}`:l;return s.jsx(gFe,{visible:!0,breakpoint:t,onClick:o,"aria-expanded":n,tabIndex:"0",type:"button","data-test":`${r||"summary"}-control-section-${n?"expanded":"collapsed"}`,"aria-label":d(),children:s.jsx(EFe,{children:e})})};oD.propTypes=mFe;oD.defaultProps=hFe;const fFe={down:p.bool.isRequired},yFe=T(me)`
    ${sD}
    ${({down:e})=>!e&&"transform: rotate(180deg);"}
`,HW=({down:e})=>s.jsx(yFe,{down:e,name:"arrow_down",height:18,width:18,fill:!0});HW.propTypes=fFe;const IFe={children:p.node},SFe={children:null},CFe=T.span`
    display: flex;
    align-items: center;
    margin-inline-start: var(--salt-spacing-2);

    &::before {
        content: '';
        position: absolute;
        inset-block-start: 0;
        inset-inline-end: 0;
        block-size: ${H(45)};
        inline-size: 50%;
    }
    ${({breakpoint:e})=>oe[or[e].mediaQueryKey]`
            &:before {
                content: none;
            }
    `}
    ${({expanded:e,concealedWhenActive:t})=>e&&t&&"display: none;"}
`,rD=({children:e})=>{const{expanded:t,concealable:n,hiddenByParent:o,breakpoint:r,name:a,reverseToggleBreakpoint:i}=YS(),{currentBreakpoint:l}=h.useContext(Pn),c=r&&Ih({currentBreakpoint:l,breakpoint:r}),d=i&&!Ih({currentBreakpoint:l,breakpoint:i});let u=c?t:!t;return d&&(u=!u),s.jsxs(CFe,{"data-test":`${a||"collapsible-box"}-toggle-switch${(n&&t||o)&&"-concealed"||""}`,active:t,concealedWhenActive:n,breakpoint:r,children:[e&&s.jsx(st.StyledToggleSwitchText,{"data-test":`${a||"collapsible-box"}-toggle-switch-text`,children:s.jsx(P,{asChild:!0,size:"l",bold:!0,children:s.jsx("strong",{children:e})})}),s.jsx(HW,{down:u})]})};rD.propTypes=IFe;rD.defaultProps=SFe;const TFe={children:p.node},_Fe={children:null},vFe=H(64),AFe=H(28),bFe=T.div`
    max-block-size: 0;
    opacity: 0;
    overflow: hidden auto;
    visibility: hidden;
    ${sD}
    ${({expanded:e,maxHeight:t})=>e&&`
        max-block-size: ${t||`calc(100vh - (${vFe} + (2 * var(--salt-spacing-4)) + ${AFe} + var(--salt-spacing-2)))`};
        opacity: 1;
        visibility: visible;
        padding-block-start: var(--salt-spacing-2);
        &:last-of-type {
            margin-block-end: 0;
        }
    `}
    ${({breakpoint:e})=>oe[or[e].mediaQueryKey]`
            max-block-size: ${({expanded:t})=>t&&"100vh"};
    `}
`,aD=({children:e})=>{const{expanded:t,contentMaxHeight:n,breakpoint:o,name:r,aria:a}=YS();return s.jsx(bFe,{expanded:t,"aria-hidden":!t,tabIndex:0,maxHeight:Number(n),"data-test":`${r||"collapsible-box"}-content`,breakpoint:o,name:r,children:s.jsxs(s.Fragment,{children:[a?.contentLabel&&s.jsx(Ee,{children:a.contentLabel}),e]})})};aD.propTypes=TFe;aD.defaultProps=_Fe;const xFe={expanded:p.bool,onToggle:p.func,children:p.node,breakpoint:p.oneOf(["xs-up","sm-up","md-up","lg-up"]),stickyBarEnabled:p.bool,overlay:p.bool,sticky:p.bool,name:p.string,aria:p.shape({contentLabel:p.string,totalPrice:p.string})},RFe={children:null,breakpoint:"sm-up",stickyBarEnabled:!0,overlay:void 0,sticky:!0,name:void 0,aria:void 0,expanded:!1,onToggle:()=>{}},gs=({children:e,...t})=>{const{sticky:n,breakpoint:o}=t,[r,a]=h.useState(!1);return h.useEffect(()=>{a(!0)},[]),s.jsxs($W.Provider,{value:t,children:[s.jsx(nD,{children:e}),n&&r&&s.jsx(BW,{renderTo:"#StickyCollapsibleSummary",children:s.jsx(Kt,{breakpoint:o,remainInDom:!1,children:s.jsx(US,{height:GW})})})]})};gs.propTypes=xFe;gs.defaultProps=RFe;gs.ControlSection=oD;gs.ToggleSwitch=rD;gs.Content=aD;const{Container:FE,CountInput:pw,CountInputContainer:mw,Operator:hw,OperatorLeft:gw,OperatorRight:A_}=Si;let DFe=class extends h.Component{static displayName="Counter";static Container=FE;static CountInput=pw;static CountInputContainer=mw;static Operator=hw;static OperatorLeft=gw;static OperatorRight=A_;static defaultProps={interval:1,max:99,min:1,size:"md",count:1,plusDisabled:!1,minusDisabled:!1,action:void 0,addInfo:!1,addIcon:void 0};inputRef;constructor(t){super(t),this.onCountBlur=this.onCountBlur.bind(this),this.onCountKeyDown=this.onCountKeyDown.bind(this),this.onCountClick=this.onCountClick.bind(this),this.onOperatorMouseDown=this.onOperatorMouseDown.bind(this),this.onOperatorClick=this.onOperatorClick.bind(this),this.handleQuantityUpdate=this.handleQuantityUpdate.bind(this),this.inputRef=h.createRef(),this.state={preventOperatorClick:!1}}componentDidUpdate(t){t.count!==this.props.count&&this.inputRef&&this.inputRef.current&&(this.inputRef.current.value=String(this.props.count))}handleQuantityUpdate(t){const{count:n=1,min:o=1,max:r=99,onQuantityUpdate:a}=this.props;if(t===""){this.inputRef.current&&(this.inputRef.current.value=String(n));return}let i=parseInt(t,10);isNaN(i)&&(i=n),i<o?i=o:i>r&&(i=r);const l=document.activeElement===this.inputRef.current;if(i===n&&!l){this.inputRef.current&&(this.inputRef.current.value=String(n));return}a(i)}onCountClick(){this.inputRef.current?.select()}onCountKeyDown(t){t.key==="Enter"&&this.inputRef.current?.blur(),t.key==="Tab"&&this.inputRef.current&&this.handleQuantityUpdate(this.inputRef.current.value)}onCountBlur(t){this.handleQuantityUpdate(t.target.value)}onOperatorMouseDown(){document.activeElement===this.inputRef.current&&this.setState({preventOperatorClick:!0})}onOperatorClick(t){if(this.state.preventOperatorClick){this.setState({preventOperatorClick:!1});return}const{count:n=1,min:o=1,max:r=99,interval:a=1,onQuantityUpdate:i}=this.props,c=n+(t??a);c>=o&&c<=r&&i(c)}render(){const{interval:t,max:n,min:o,onQuantityUpdate:r,count:a,plusDisabled:i,minusDisabled:l,addText:c,addTextAlternative:d,increaseQuantityTextAlternative:u,decreaseQuantityTextAlternative:m,editQuantityTextAlternative:g,quantityDescriptionTextAlternative:f,action:y,addInfo:I,addIcon:S,...C}=this.props;return a===0&&I?s.jsx(FE,{...C,children:s.jsxs(b,{onClick:y,intent:"secondary",fill:!0,"data-test":"counter-button","aria-label":d,children:[s.jsx(b.Icon,{name:S}),s.jsx(b.Text,{children:c})]})}):a===0?s.jsx(FE,{...C,children:s.jsx(hw,{type:"button",fullWidth:!0,appearance:"action",onClick:()=>this.onOperatorClick(t),disabled:i,"data-synthetics":"add-button","data-test":"counter-button","aria-label":d,className:C.className,children:c})}):s.jsxs(FE,{...C,children:[s.jsx(Ee,{children:f}),s.jsx(gw,{type:"button",appearance:"action",disabled:l,onClick:()=>this.onOperatorClick(-(t??1)),onMouseDown:this.onOperatorMouseDown,...C,"data-test":"counter:decrement","aria-label":m,children:s.jsx(me,{name:"minus",height:18})}),s.jsx(mw,{children:s.jsx(pw,{defaultValue:a,type:"number",min:o,max:n,onBlur:this.onCountBlur,onKeyDown:this.onCountKeyDown,onClick:this.onCountClick,ref:this.inputRef,"aria-label":g,"data-test":"quantity-in-basket","data-synthetics":"quantity-in-basket"})}),I?s.jsx(A_,{type:"button",appearance:"action",onClick:y,"data-test":"counter:increment","data-synthetics":"add-button","aria-label":u,children:s.jsx(me,{name:S,height:18})}):s.jsx(A_,{type:"button",appearance:"action",disabled:i,onClick:()=>this.onOperatorClick(t),onMouseDown:this.onOperatorMouseDown,...C,"data-test":"counter:increment","data-synthetics":"add-button","aria-label":u,children:s.jsx(me,{name:"plus",height:18})})]})}};const VW=T(DFe)``;VW.displayName="Counter";const YW={padding:p.oneOf(["xs","sm","md","lg","xl",null]),hyphenate:p.bool},WW={padding:"sm",hyphenate:!1},{DescriptionListTitle:iD,DescriptionListDescription:lD}=pe,OFe=T.div``,PFe=()=>s.jsxs("div",{children:[s.jsxs("div",{className:"salt-m-b--2 salt-d--flex",children:[s.jsx(Pe,{height:"15px",width:"25%"}),s.jsx(Pe,{height:"15px",className:"salt-m-l--4"})]}),s.jsxs("div",{className:"salt-m-b--2 salt-d--flex",children:[s.jsx(Pe,{height:"15px",width:"25%"}),s.jsx(Pe,{height:"15px",className:"salt-m-l--4"})]}),s.jsxs("div",{className:"salt-d--flex",children:[s.jsx(Pe,{height:"15px",width:"25%"}),s.jsx(Pe,{height:"15px",className:"salt-m-l--4"})]})]});iD.propTypes=YW;iD.defaultProps=WW;lD.propTypes=YW;lD.defaultProps=WW;pe.Title=e=>s.jsx(iD,{...e});pe.Description=e=>s.jsx(lD,{...e});pe.Skeleton=PFe;pe.Group=OFe;const NFe={xs:4,sm:8,md:16,lg:32,xl:64,xxl:128},BE=e=>{switch(e.length){case 1:return Rl(e[0]);case 2:case 3:return`${Rl(e[1])}`;case 4:return`${Rl(e[3])} ${Rl(e[1])}`;default:return"0"}},UE=e=>{switch(e.length){case 1:case 2:return`${Rl(e[0])}`;case 3:case 4:return`${Rl(e[0])} ${Rl(e[2])}`;default:return"0"}},Rl=e=>e?`${H(NFe[e])}`:"0",LFe=e=>e.map(t=>Rl(t)).join(" "),GE=e=>e?`gap: ${LFe(e)};`:"",se=T.div.withConfig({shouldForwardProp:(e,t)=>!["wrap","direction","justify","align","gap"].includes(e)&&t(e)})`
    display: flex;
    flex-flow: ${({direction:e="row"})=>e} ${({wrap:e="wrap"})=>e};
    flex-basis: ${({basis:e})=>e||"auto"};
    justify-content: ${({justify:e="inherit"})=>e};
    ${({align:e})=>e&&`align-items:${e}`};

    ${({gap:e})=>GE(e)};

    ${({margin:e})=>e&&`margin-block: ${UE(e)};`};
    ${({margin:e})=>e&&`margin-inline: ${BE(e)};`};

    ${({additionalCss:e})=>e};

    ${oe.smUp`
        ${({gapSmUp:e})=>GE(e)}

        ${({wrapSmUp:e})=>e&&`flex-wrap: ${e};`}

        ${({marginSmUp:e})=>e&&`margin-block: ${UE(e)};`}

        ${({marginSmUp:e})=>e&&`margin-inline: ${BE(e)};`}

        ${({directionSmUp:e})=>e&&`flex-direction: ${e};`}
    `}

    ${oe.mdUp`
        ${({gapMdUp:e})=>GE(e)}

        ${({wrapMdUp:e})=>e&&`flex-wrap: ${e};`}

        ${({marginMdUp:e})=>e&&`margin-block: ${UE(e)};`}

        ${({marginMdUp:e})=>e&&`margin-inline: ${BE(e)};`}

        ${({directionMdUp:e})=>e&&`flex-direction: ${e};`}
    `}

    ${oe.lgUp`
        ${({gapLgUp:e})=>GE(e)}

        ${({directionLgUp:e})=>e&&`flex-direction: ${e};`}

        ${({marginLgUp:e})=>e&&`margin-block: ${UE(e)};`}

        ${({marginLgUp:e})=>e&&`margin-inline: ${BE(e)};`}

        ${({additionalCssLgUp:e})=>e}
    `}
`;se.displayName="Flex";const Bo=T.div`
    flex-grow: 1;
`;Bo.displayName="FlexGrow";In.displayName="Footer";const kFe={trail:p.arrayOf(p.shape({position:p.string.isRequired,name:p.string.isRequired})).isRequired},qW=T.ul`
    list-style: none;
    margin: 0;
    padding: 0;
`,KW=T.li`
    display: inline-block;
    vertical-align: middle;
`,zW=T(me).attrs({"aria-hidden":"true"})`
    margin-block: 0;
    margin-inline: var(--salt-spacing-2);
    vertical-align: middle;
    inline-size: ${H(20)};
`,QW=(e,t)=>e>t+1,Ap=({trail:e})=>s.jsx(qW,{children:e.map((t,n)=>s.jsx(KW,{"data-test":"progress-steps-item","aria-current":t.selected?"step":void 0,children:s.jsxs(P,{size:"l",bold:t.selected,children:[t.position,". ",t.name,QW(e.length,n)?s.jsx(zW,{name:"arrow_right"}):null]})},t.name))});Ap.propTypes=kFe;Ap.List=qW;Ap.Item=KW;Ap.Chevron=zW;Ap.isLastItem=QW;const XW=T.div`
    color: ${({light:e})=>e?"var(--intent-content)":"var(--intent-contrast)"};
    line-height: 3;
    float: inline-start;
`,ZW=T.div`
    &::after {
        clear: both;
        content: '';
        display: table;
    }
`,MFe=T.div`
    float: inline-end;
`,cD=({messages:e,trail:t,url:n="",onClick:o=()=>{},v2Enabled:r=!1,"data-test":a})=>{const{formatMessage:i}=M();return s.jsx(YR,{"data-test":"checkout-bottom-bar",light:r,id:"checkout-progress",children:s.jsxs(ZW,{className:"salt-p--4",children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:i("checkout.walk.progress.accessibility.title")})}),s.jsx(XW,{light:r,children:s.jsx(Ap,{trail:t})}),s.jsx(MFe,{children:s.jsx(b,{"data-synthetics":"next-step",intent:"action",onClick:o,asChild:!0,children:s.jsx(Qe,{intent:"ghost",to:n,"data-test":a?`${a}-link`:void 0,children:s.jsx(b.Text,{children:e.button})})})})]})})};cD.Progress=XW;cD.CheckoutBarContentWrapper=ZW;const{Label:bn}=XY,jFe={hasError:p.bool,visuallyConcealed:p.bool,isRequired:p.bool},wFe={hasError:!1,visuallyConcealed:!1,isRequired:!1};bn.propTypes=jFe;bn.defaultProps=wFe;bn.displayName="Label";const{RadioIconOff:FFe,RadioIconOn:BFe,RadioIconDisabled:UFe,RadioText:GFe,ContentWrapper:$Fe}=ha,HFe={bold:p.bool,checked:p.bool,children:p.node,"data-test":p.string,error:p.string,label:p.oneOfType([p.string,p.node]).isRequired,last:p.bool,value:p.string.isRequired,disabled:p.bool,role:p.string},VFe={bold:!0,checked:!1,children:void 0,"data-test":void 0,error:"",last:!1,disabled:!1,role:void 0},YFe=T(Oa)`
    overflow: inherit;
`,ia=({bold:e,checked:t,children:n,error:o,label:r,value:a,last:i,disabled:l,"data-test":c,role:d,...u})=>s.jsx(YFe,{last:i,children:s.jsxs(bn,{hasError:!!o,role:d,children:[s.jsx("input",{value:a,type:"radio",disabled:l,...u,checked:t}),t&&!l&&s.jsx(BFe,{name:"radio_on"}),!t&&!l&&s.jsx(FFe,{name:"radio_off"}),l&&s.jsx(UFe,{name:"status_no"}),s.jsxs(P,{"data-test":c,intent:o?"error":void 0,children:[s.jsx(GFe,{asChild:!0,bold:e,children:s.jsx("strong",{children:r})}),s.jsxs($Fe,{children:[n,!!o&&s.jsx(Ua,{children:o})]})]})]})});ia.propTypes=HFe;ia.defaultProps=VFe;ia.displayName="Radio";const WFe=(()=>{let e=0;return{next(){return e+=1,`uid-${e}`}}})(),Pd=({onBlur:e,onFocus:t,onChange:n,value:o,children:r,placeholder:a="",size:i="md",id:l="",error:c,label:d="",hideLabel:u,helperText:m="",flush:g=!1,className:f,fill:y,...I})=>{const C=h.useRef(l||WFe.next()).current,_=`${C}-error-message`,A=!!c,[x,R]=h.useState(!1),O=B=>{R(!0),t?.(B)},N=B=>{R(!1),e?.(B)},k=B=>{n?.(B)},j=()=>{const B=K=>Array.isArray(K.props?.children)&&K.props.children.length>0,W=K=>B(K)&&K.type!=="option"?K.props.children.map(Q=>W(Q).flat()):[K],$=h.Children.toArray(r).map(K=>W(K).flat()).flat().filter(K=>K.type==="option"&&K.props.value===o).pop();return $&&$.props.children||s.jsx(Au.Placeholder,{hasError:A,children:a})},w=B=>{const W={...I,onBlur:N,onFocus:O,onChange:k};return s.jsxs(Au.RawSelect,{id:B,value:o,"aria-invalid":A?!0:void 0,"aria-describedby":A?_:void 0,...W,children:[a&&s.jsx("option",{value:"",disabled:!0,selected:!0,children:a}),r]})},L=I["data-test"]&&I["data-test"]!==""?`${I["data-test"]}-select-result`:"select-result";return s.jsxs(Oa,{"data-test":"input-wrapper",fill:y,className:f,children:[!!d&&s.jsx(bn,{visuallyConcealed:!!u,hasError:!!c,htmlFor:C,isRequired:I.required,children:d}),m&&s.jsx(P,{className:"salt-d--block salt-m-b--1",children:m}),s.jsxs(Au.SelectWrapper,{hasError:A,size:i,focus:x,children:[s.jsx(Au.SelectResult,{"data-test":L,children:j()}),w(C)]}),A&&s.jsx(Ua,{"data-test":"form-field-error-message",id:_,children:c})]})};Pd.displayName="Select";const{ErrorMessage:qFe,Row:KFe}=XY,{CheckboxIconOff:zFe,CheckboxIconOn:QFe,CheckboxText:XFe,CheckboxTextWrapper:ZFe}=kS,mo=({bold:e,children:t,label:n,input:o,meta:r,className:a,labelClassName:i,whiteSpace:l,last:c,...d})=>{const u=s.jsx("input",{type:"checkbox",...o,...d}),m=r&&r.touched&&r.invalid||!1,g=r?r.error:"";return s.jsx(KFe,{className:a,last:c,children:s.jsxs(bn,{className:i,hasError:m,children:[u,o.checked?s.jsx(QFe,{name:"checkbox_on"}):s.jsx(zFe,{name:"checkbox_off"}),s.jsxs(ZFe,{children:[s.jsx(XFe,{whiteSpace:l,bold:e,children:n}),t,m&&s.jsx(qFe,{children:g})]})]})})};mo.displayName="Checkbox";const JFe={error:"",meta:{touched:!1,invalid:!1},onChange:()=>{},requiredMessage:"",validation:{}},eBe=(e,t=!0)=>({...JFe,...e,value:e.value||(t?"":null)}),Ew=(e,{checked:t,value:n,type:o})=>({...e,[n]:{value:n,checked:o==="radio"?!0:t}}),JW=e=>{class t extends h.Component{static getCheckboxValue({checkboxes:o,isCheckboxGroup:r}){const a=Object.keys(o).map(i=>o[i]).reduce((i,{checked:l,value:c})=>l?[...i,c]:i,[])||null;return r?a:a[0]||null}static getRadioValue({radios:o}){const r=Object.keys(o).map(a=>o[a]).filter(a=>a.checked);return r.length?r[0]:null}static generateGenericFieldState(o){const r=["error","meta","name","onChange","requiredMessage","type","validation","value"];return t.filterAttrs(o,r)}static setRadioGroupToUnchecked(o){const r={...o};return Object.keys(r).reduce((a,i)=>({...a,[i]:{...r[i],checked:!1}}),{})}static filterAttrs(o,r){return Object.keys(o).filter(a=>!!r.includes(a)).reduce((a,i)=>({...a,[i]:o[i]}),{})}static generateCheckboxState(o,r){const a=["error","meta","isCheckboxGroup","name","onChange","requiredMessage","type","validation"],i=t.filterAttrs(o,a),l=({checked:d,value:u},m={})=>({...m,[u]:{value:u,checked:!!d}});let c={};return r?r.checkboxes[o.value]?c={...r}:c={...r,...i,checkboxes:l(o,r.checkboxes)}:c={...i,checkboxes:l(o)},c}static generateRadioState(o,r){const a=["error","name","meta","onChange","requiredMessage","type","validation"],i=t.filterAttrs(o,a),l=({checked:d,value:u},m={})=>({...m,[u]:{value:u,checked:!!d}});let c={};return r?r.radios[o.value]?c={...r}:c={...r,...i,radios:l(o,r.radios)}:c={...i,radios:l(o)},c}constructor(){super(),this.createFieldStateObj=this.createFieldStateObj.bind(this),this.generateFieldProps=this.generateFieldProps.bind(this),this.getFieldValue=this.getFieldValue.bind(this),this.getFieldValues=this.getFieldValues.bind(this),this.isValid=this.isValid.bind(this),this.onBlur=this.onBlur.bind(this),this.onChange=this.onChange.bind(this),this.onFocus=this.onFocus.bind(this),this.registerField=this.registerField.bind(this),this.validateField=this.validateField.bind(this),this.resetForm=this.resetForm.bind(this),this.updateForm=this.updateForm.bind(this),this.setFieldDefaults=this.setFieldDefaults.bind(this),this.defaults={},this.state={}}onFocus(o){this.clearError(o.target.name)}onBlur(o){this.validateField(o.target.name)}onChange(o){const{target:{name:r,type:a,value:i,checked:l}}=o;this.setState(c=>{const d={...c[r]};if(a==="radio"){const u=t.setRadioGroupToUnchecked(c[r].radios);d.radios=Ew(u,{type:a,value:i,checked:l})}else a==="checkbox"?d.checkboxes=Ew(d.checkboxes,{type:a,value:i,checked:l}):d.value=i;return{[r]:d}},()=>this.state[r].onChange(o))}setError(o,r){this.setState(a=>{const i=a[o];return i.hasError=!0,i.error=r,i.meta={error:r,invalid:!0,touched:!0},{[o]:i}})}getFieldValues(){return Object.keys(this.state).reduce((o,r)=>({...o,[r]:this.getFieldValue(this.state[r].name)}),{})}getFieldValue(o){const r=this.state[o];let a=r.value;return r.type==="radio"?a=t.getRadioValue(r):r.type==="checkbox"&&(a=t.getCheckboxValue(r)),a}setFieldDefaults(o){this.defaults[o]||(this.defaults[o]={...this.state[o]})}createFieldStateObj(o){const r=this.state[o.name];let a={};return o.type==="radio"?a=t.generateRadioState(o,r):o.type==="checkbox"?a=t.generateCheckboxState(o,r):!this.state[o.name]||this.state[o.name].value===null?a=t.generateGenericFieldState(o):a={...this.state[o.name]},a}clearError(o){this.setState(r=>{const a=r[o];return a.hasError=!1,a.error="",a.meta={error:"",invalid:!1,touched:!1},{[o]:a}})}isValid(){return!Object.keys(this.state).filter(o=>!this.validateField(o)).length}validateField(o){const r=this.state[o],a=this.getFieldValue(o);let i,l;r.requiredMessage&&!a?(l=r.requiredMessage,i=!0):r.validation&&r.validation.test&&(l=r.validation.error,typeof r.validation.test=="function"?i=!r.validation.test(a):i=!new RegExp(r.validation.test).test(a));let c;return i&&l?(this.setError(o,l),c=!1):(this.clearError(o),c=!0),c}generateFieldProps({name:o,type:r,value:a}){const i={error:this.state[o].error,meta:this.state[o].meta,name:this.state[o].name,onBlur:this.onBlur,onChange:this.onChange,onFocus:this.onFocus};return r==="radio"?(i.checked=this.state[o].radios[a].checked,i.value=this.state[o].radios[a].value):r==="checkbox"?(i.checked=this.state[o].checkboxes[a].checked,i.value=this.state[o].checkboxes[a].value):i.value=this.state[o].value,i}registerField(o,r=!0){const a=eBe(o,r);return this.state[o.name]=this.createFieldStateObj(a),this.setFieldDefaults(o.name),this.generateFieldProps(a)}resetForm(){Object.keys(this.defaults).forEach(o=>{this.setState({[o]:this.defaults[o]})})}updateForm(o){this.setState(r=>({...r,...Object.keys(o).map(a=>Object.assign(r[a],{value:o[a]}))}))}render(){const o={...this.props,registerField:this.registerField,validateField:this.validateField,isValid:this.isValid,getFieldValues:this.getFieldValues,resetForm:this.resetForm,updateForm:this.updateForm};return s.jsx(e,{...o})}}return t},tBe=()=>{let e=0;return{next(){return e+=1,`uid-${e}`}}},eq=tBe(),sBe=({isNewFormsStyled:e,text:t})=>e?s.jsx(P,{intent:"error",size:"s",className:"salt-m-t--2 salt-m-l--2",children:t}):s.jsx(Ua,{children:t}),nBe=({isNewFormsStyled:e,input:t,meta:n,label:o,...r})=>{const a=eq.next();return s.jsxs(Oa,{children:[e?s.jsx(bn,{className:"salt-m-l--2",hasError:n.touched&&n.invalid,htmlFor:a,isRequired:r.required,children:s.jsx(P,{intent:n.touched&&n.invalid?"error":void 0,bold:!0,size:"s",children:o})}):s.jsx(bn,{hasError:n.touched&&n.invalid,htmlFor:a,isRequired:r.required,children:o}),s.jsx(UR,{as:"textarea",isNewFormsStyled:e,hasError:n.touched&&n.invalid,id:a,...t,...r}),n.touched&&n.invalid&&s.jsx(sBe,{isNewFormsStyled:e,text:n.error})]})};nBe.displayName="TextareaField";const tq=({id:e,type:t="text",input:n,meta:o={touched:!1,invalid:!1},label:r,last:a=!1,hideLabel:i=!1,required:l,className:c,size:d,...u},m)=>{const g=eq.next(),f=e||g;return s.jsxs(Oa,{"data-test":"input-wrapper",last:a,children:[s.jsx(bn,{visuallyConcealed:i,hasError:o.touched&&o.invalid,htmlFor:f,isRequired:l,children:r}),s.jsx(jS,{type:t,className:c,ref:m,hasError:o.touched&&o.invalid,blockSize:d,...n,...u,id:f}),o.touched&&o.invalid&&s.jsx(Ua,{id:`${f}-error`,"data-test":"form-field-error-message",role:"alert",children:o.error})]})};tq.displayName="InputField";const ii=h.forwardRef(tq),oBe={children:p.oneOfType([p.string,p.element,p.array]),xs:p.number,sm:p.number,md:p.number,lg:p.number},rBe={children:null},sq=T.article`
    align-self: stretch;
    background-color: var(--intent-contrast);
    border-radius: var(--salt-radius-default);
    display: flex;
    flex-direction: column;
    justify-content: center;
    margin:var(--salt-spacing-1);
    padding: 0;
    text-align: center;
    inline-size: ${"calc(100% - var(--salt-spacing-2))"};
    @supports(--css: variables) {
        block-size: calc((100vmax - var(--frameBoxPosition, 0)) - var(--salt-spacing-8));
        position: relative;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
    }

    ${oe.smUp`
        inline-size: ${"calc(100% - var(--salt-spacing-2))"};
    `}

    ${oe.mdUp`
        inline-size: ${"calc(100% - var(--salt-spacing-2))"};
        padding: var(--salt-spacing-4);
        block-size: auto;
    `};

    ${oe.lgUp`
        inline-size: ${"calc(100% - var(--salt-spacing-2))"};
    `}

    iframe {
        inline-size: 100%;
        @media (hover: none) {
            min-block-size: 100%;
        }
    }
`,WS=e=>s.jsx(sq,{...e,children:e.children});WS.defaultProps=rBe;WS.propTypes=oBe;WS.FrameBoxWrapper=sq;aa.displayName="GridList";const aBe={children:p.node,title:p.string,tight:p.bool},iBe={children:void 0,tight:!1,title:void 0},nq=T(P)`
    margin-block-end: ${({tight:e})=>!e&&"var(--salt-spacing-2)"};
    text-align: center;
`,Ns=({children:e,title:t,tight:n})=>s.jsxs("div",{children:[t?s.jsx(nq,{tight:n,asChild:!0,bold:!0,children:s.jsx("h2",{children:t})}):null,s.jsx("div",{children:e})]}),lBe=()=>s.jsxs("div",{children:[s.jsx(Pe,{height:"24px",className:"salt-m-b--4"}),s.jsx(pe.Skeleton,{})]});Ns.Title=nq;Ns.Skeleton=lBe;Ns.propTypes=aBe;Ns.defaultProps=iBe;const oq="var(--intent-contrast)",cBe={targetName:p.string.isRequired,children:p.oneOfType([p.arrayOf(p.node),p.node])},dBe={children:void 0},uBe=T.div`
    inline-size: 100%;
    block-size: 20px;
    background-color: ${oq};
    position: relative;
    text-align: center;
    font-weight: bold;
`,pBe=T.div`
    border: 2px solid ${oq};
    min-inline-size: 60px;
    min-block-size: 30px;
    position: relative;
`,Sh=e=>s.jsxs("div",{className:"salt-m-b--4",children:[s.jsx(uBe,{children:e.targetName}),s.jsx(pBe,{children:e.children})]});Sh.propTypes=cBe;Sh.defaultProps=dBe;Sh.displayName="GtmTarget";const{ProductAttributeIconImage:mBe}=fY,hBe={src:p.string,"data-test":p.string,alt:p.string,fill:p.string,height:p.number,name:p.string,info:p.bool,success:p.bool,primary:p.bool,warning:p.bool,error:p.bool,width:p.number,ariaHidden:p.bool},gBe={src:void 0,"data-test":void 0,alt:void 0,fill:"currentColor",height:20,width:20,name:void 0,info:void 0,success:void 0,primary:void 0,warning:void 0,error:void 0,svgDefsEnabled:!1,ariaHidden:!1},qS=({src:e,alt:t,"data-test":n,ariaHidden:o,...r})=>e?s.jsx(mBe,{src:e,alt:t,className:r.className,"data-test":n,"aria-hidden":o}):s.jsx(me,{"data-test":n??`lifestyle-icon__${r.name}`,...r});qS.displayName="ProductAttributeIcon";qS.propTypes=hBe;qS.defaultProps=gBe;const CXt=T(qS)``,EBe={children:p.arrayOf(p.element)},fBe={children:null},KS=T.div`
    display: flex;
    align-items: end;
    position: relative;
    inline-size: auto;

    > ${Oa} {
        inline-size: auto;
        display: flex;
        flex: 1 1 auto;
        flex-direction: column;
        justify-content: center;
    }

    > ${Oa} ${jS} {
        border-start-end-radius: 0;
        border-end-end-radius: 0;
    }
`;KS.defaultProps=fBe;KS.propTypes=EBe;const Ve=({inline:e,children:t,innerRef:n,...o})=>s.jsx(ZY.StyledList,{...o,ref:n,children:ie.Children.map(t,r=>r&&h.isValidElement(r)&&ie.cloneElement(r,{inline:e}))});Ve.Item=ZY.ListItem;const{strokeWidth:yBe,Wrapper:IBe,Ring:SBe,ContentContainer:CBe}=TMe,TBe={children:p.element,autoProgress:p.bool,progressValue:p.number,colorName:p.string,size:p.number,className:p.string},_Be={children:void 0,progressValue:void 0,autoProgress:!0,colorName:"primary",size:58,className:""},oc=({children:e,progressValue:t,autoProgress:n,colorName:o,size:r,className:a})=>{const[i,l]=h.useState(0),c=r/2,d=r/2-yBe/2;return!n&&i!==t&&l(t),h.useEffect(()=>{if(n){const u=setTimeout(()=>{l(100)},10);return()=>clearTimeout(u)}return()=>{}}),s.jsxs(IBe,{size:r,className:a,children:[s.jsxs(SBe,{viewBox:`0 0 ${r} ${r}`,progress:i,colorName:o,size:r,radius:d,children:[s.jsx("circle",{className:"path",r:d,cx:c,cy:c}),s.jsx("circle",{className:"progress",r:d,cx:c,cy:c})]}),s.jsx(CBe,{colorName:o,size:r,children:e})]})};oc.displayName="ProgressRing";oc.propTypes=TBe;oc.defaultProps=_Be;const vBe=T.span.withConfig({shouldForwardProp:(e,t)=>!["height","width","name"].includes(e)&&t(e)}).attrs(({svg:e,name:t,"data-test":n})=>({dangerouslySetInnerHTML:{__html:e},"data-test":n||`icon__${t}`}))`
    display: block;
    line-height: 0;

    > svg {
        block-size: ${({height:e})=>e};
        inline-size: ${({width:e})=>e};
    }
`,ABe=T(vBe)``,bBe=T.span`
    display: block;
    line-height: 0;
`,SA=({type:e,title:t})=>{const n={width:138,height:36},o=e==="default"?"logo":"small",r=e==="default"?`calc(var(--logo-${e}-width, ${n.width}) / 14 * 1rem)`:`calc(var(--logo-${e}-width) / 14 * 1rem)`,a=e==="default"?`calc(var(--logo-${e}-height, ${n.height}) / 14 * 1rem)`:`calc(var(--logo-${e}-height) / 14 * 1rem)`,i=`logo${o==="small"?"_small":""}`;return s.jsx(bBe,{children:s.jsx(me,{name:i,width:r,height:a,title:t})})};SA.LogoIcon=ABe;p.string.isRequired,p.string.isRequired;const Ch={label:{color:"var(--intent-primary-contrast)","font-size":10},selectedIconFill:"var(--intent-primary-900)",unselectedIconFill:"var(--intent-primary)",stroke:"#ffffff","fill-opacity":1,"stroke-weight":2,selectedIconScale:1.84,unselectedIconScale:1.38,location:{fill:"#3c96ff","fill-opacity":1,stroke:"#ffffff","stroke-opacity":1,"stroke-weight":2,scale:6}};T(P)`
    color: ${Ch.label.color};
    font-size: ${H(Ch.label["font-size"])};
    block-size: 20px;
    padding-block-start: 1px;
    position: absolute;
    text-align: center;
    inline-size: 20px;
`;T(me)`
    position: absolute;

    > svg {
        fill: ${()=>Ch.unselectedIconFill};
    }
`;const xBe=()=>{const e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",document.body.appendChild(e);const t=document.createElement("div");e.appendChild(t);const n=e.offsetWidth-t.offsetWidth;return e.parentNode.removeChild(e),n},RBe=()=>!window||!window?.innerHeight?!1:document.documentElement.scrollHeight>window.innerHeight,wy=()=>{document.documentElement.style.overflow="hidden",RBe()?document.documentElement.style.width=`calc(100% - ${xBe()}px)`:document.documentElement.style.width="100%"},Mu=()=>{document.documentElement.style.overflow="",document.documentElement.style.width=""},Vr=h.forwardRef((e,t)=>{const{isSSRNavigation:n,label:o}=e,{formatMessage:r}=M(),a=r(o);if(n){const{href:u,isSSRNavigation:m,...g}=e;return s.jsx(th.Link,{ref:t,asChild:!0,children:u?s.jsx(rt,{href:u,...g,children:a}):s.jsx("a",{...g,children:a})})}const{to:i,href:l,isSSRNavigation:c,...d}=e;return s.jsx(th.Link,{ref:t,asChild:!0,children:i?s.jsx(Qe,{to:i,...d,children:a}):s.jsx("a",{...d,children:a})})}),ot=e=>t=>({actions:Ki(e,t)});class DBe extends h.Component{static getDerivedStateFromError(){return{hasError:!0}}constructor(t){super(t),this.state={hasError:!1}}componentDidCatch(t){try{throw t}catch(n){this.props.actions.analyticsEvent({type:OS.ERROR,boundaryType:this.props.type,errorType:"ERROR_BOUNDARY"}),Me.api.pushError(n instanceof Error?n:new Error(`GracefulErrorBoundary error: ${JSON.stringify(n)}`),{context:{requestId:this.props.requestId,message:`ErrorBoundary (${this.props.type}) component caught the following error: ${n instanceof Error?n.message:"unknown"}`,type:this.props.type}})}}render(){return this.state.hasError&&!this.props.fallback?s.jsx("div",{"data-test":"default-error",children:"Error"}):this.state.hasError?this.props.fallback:this.props.children}}const OBe=e=>({requestId:tS(e)}),PBe=ot({analyticsEvent:U.analyticsEvent}),NBe=ke(OBe,PBe),LBe=NBe(DBe),zS=(e,t)=>n=>o=>s.jsx(LBe,{type:e,fallback:t,children:s.jsx(n,{...o})}),fw=[{duration:"-1",string:"settings.accessibility.notification.system-default",displayAsNumberOfSeconds:!1},{duration:"0",string:"settings.accessibility.notification.do-not-dismiss",displayAsNumberOfSeconds:!1},{duration:"5",string:"settings.accessibility.notification.duration",displayAsNumberOfSeconds:!0},{duration:"10",string:"settings.accessibility.notification.duration",displayAsNumberOfSeconds:!0},{duration:"20",string:"settings.accessibility.notification.duration",displayAsNumberOfSeconds:!0},{duration:"30",string:"settings.accessibility.notification.duration",displayAsNumberOfSeconds:!0},{duration:"60",string:"settings.accessibility.notification.duration",displayAsNumberOfSeconds:!0}],Fy="-1",QS="accessibility-notification-duration-seconds",rq=ee("GET_ACCESSIBILITY_SETTINGS"),aq=ee("UPDATE_ACCESSIBILITY_SETTINGS"),iq={service:"web_customer_preference_ws",pathPrefix:{client:"/api/customer-preferences",server:"/core-api"}},kBe=()=>({type:"API",payload:{url:`/v1/customer-preferences?preferenceKeys=${QS}`,...iq,...rq}}),MBe=e=>({type:"API",payload:{url:"/v1/customer-preferences-batch",options:{method:"PUT",body:e},...iq,...aq}}),Gc={getAccessibilitySettings:kBe,updateAccessibilitySettings:MBe,types:{GET_ACCESSIBILITY_SETTINGS:rq,UPDATE_ACCESSIBILITY_SETTINGS:aq}},jBe={data:{},...Re,error:null},wBe=e=>e.reduce((t,n)=>({...t,[n.preferenceKey]:n}),{}),FBe=(e=jBe,t)=>{switch(t.type){case Gc.types.GET_ACCESSIBILITY_SETTINGS.PENDING:return{...e,isFetching:!0,fetchError:!1};case Gc.types.GET_ACCESSIBILITY_SETTINGS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Gc.types.GET_ACCESSIBILITY_SETTINGS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:wBe(t.payload.responseData)};default:return e}},lq=({data:e})=>e.customer.accessibilitySettings,BBe=e=>{if(!e||e===Fy)return;const t=Number(e);if(!isNaN(t))return t===0?null:t*1e3},$E={value:new Set(["default"]),has(e){return this.value.has(e)},subscribers:Array(),publish(){this.subscribers.forEach(e=>e())},unsubscribe(e,t){const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1),this.value.delete(e),this.publish()},subscribe(e,t){this.value.add(e),this.subscribers.push(t),this.publish()}},UBe=T(th.Container)`
    --salt-notification-inset-inline-end: 0rem;

    ${oe.smUp`
        --salt-notification-inset-inline-end: ${({context:e,width:t})=>e==="drawer"?t:"0rem"};
    `};
    position: ${({context:e})=>e==="drawer"||e==="modal"?"fixed":"relative"};
    visibility: ${({hide:e})=>e?"hidden":"visible"};
`,GBe=({context:e="default",width:t="360px"})=>{const[n,o]=h.useState(!1),{notifications:r}=th.useNotifications(),a=M(),{data:i}=E(lq)??{},l=()=>{const S=($E.has("drawer")||$E.has("modal"))&&e==="default";o(S)};h.useEffect(()=>($E.subscribe(e,l),()=>{$E.unsubscribe(e,l)}),[]);const c=I=>typeof I=="string"?a.formatMessage(I):"formattedMessage"in I?I.formattedMessage:a.formatMessage(I.key,I.substitutions),d=I=>({warning:a.formatMessage("accessibility.warning.message"),info:a.formatMessage("accessibility.info.message"),error:a.formatMessage("accessibility.error.message"),success:a.formatMessage("accessibility.success.message")})[I],u=r.map(I=>({...I,a11y:{labels:{prefix:d(I.intent)}},text:c(I.text)})),m=i?.[QS]?.preferenceValue,g=!!m&&m!==Fy,y=BBe(m??Fy);return s.jsx(UBe,{context:e,notifications:u,hide:n,width:t,ariaLabels:{closeButton:a.formatMessage("filter.accessibility.bottom.sheet.close.button")},overridePersistence:g,duration:y})},cq=zS("salt:notifications",s.jsx("div",{"data-test":"notifications-error"}))(GBe),{Button:$Be,notify:bu}=th,HBe={close:bu.close,getNotifications:bu.getNotifications},z={...HBe,success:(e,t)=>bu.success(e,t),error:(e,t)=>{const n={...t,stack:new Error().stack};return bu.error(e,n)},warning:(e,t)=>bu.warning(e,t),info:(e,t)=>bu.info(e,t)},VBe=({size:e="m",className:t,children:n,...o})=>s.jsxs(mW,{children:[s.jsx(wS,{size:e,className:t,...o}),n&&s.jsx(hW,{size:e,children:n})]}),YBe=({size:e="m",className:t,children:n,...o})=>s.jsxs(se,{direction:"column",justify:"center",align:"center",children:[s.jsx(wS,{size:e,className:t,...o}),n&&s.jsx(hW,{size:e,children:n})]}),WBe=({size:e="m",className:t,...n})=>s.jsx(mW,{children:s.jsx(wS,{size:e,className:t,...n})}),Rs=({size:e="m",className:t,...n})=>s.jsx(wS,{size:e,className:t,...n});Rs.WithCaption=VBe;Rs.WithCustomCaption=YBe;Rs.WithContainer=WBe;const{Fill:xu,FlexColumn:qBe,Content:KBe,CloseButton:yw,StyledFooter:bp,StyledHeader:xp,DialogForm:zBe}=nW,rc={fill:{grow:p.number,direction:p.oneOf(["row","column"])},modal:{children:p.oneOfType([p.arrayOf(p.node),p.node]),onRequestClose:p.func,showCloseIcon:p.bool,loadingPlaceholder:p.oneOf(["skeleton","spinner"]),viewHeight:p.string,scrollToTop:p.bool},styledModal:{isLoading:p.bool,onRequestClose:p.func,maxWidth:p.oneOf(["sm","md","lg"])},header:{align:p.string,condensed:p.bool},body:{lastUpdated:p.number,condensed:p.bool},footer:{flow:p.oneOf(["column","inherit","initial","nowrap","row","wrap","row nowrap","column wrap"]),align:p.string,condensed:p.bool}},Nd={modal:{onRequestClose:void 0,loadingPlaceholder:"skeleton",showCloseIcon:!0,scrollToTop:!1},styledModal:{isLoading:!1,onRequestClose:void 0,maxWidth:"sm"},header:{align:"center",condensed:!1},body:{lastUpdated:0,condensed:!1},footer:{flow:void 0,align:"center",condensed:!1}},dq=T(KBe)`
    ${({context:e})=>e==="drawer"&&De`
            position: fixed;
            inset-block-start: 0;
            inset-inline-end: 0;
            block-size: 100%;
            border-start-end-radius: 0;
            border-end-end-radius: 0;
            inline-size: ${H(360)};
            ${oe.xs`
                min-inline-size: 100%;
                border-start-start-radius: 0;
                border-end-start-radius: 0;
            `}
        `}
    ${({asBottomSheet:e=!1})=>e&&oe.xs`
                position: fixed;
                inset-block-end: 0;
                inset-inline-start: 0;
                min-inline-size: 100%;
                border-start-start-radius: 0;
                border-start-end-radius: 0;
                border-end-start-radius: 0;
                border-end-end-radius: 0;
            `}
    ${({additionalCss:e})=>e}
`;xp.propTypes=rc.header;xp.defaultProps=Nd.header;xp.displayName="Modal-Header";const QBe=()=>[s.jsx(xp,{"data-test":"skeleton-modal-content-header",children:s.jsx(Pe,{height:"15px",width:"250px"})},"header"),s.jsxs(il,{"data-test":"skeleton-modal-content-body",children:[s.jsx(Pe.Typography,{className:"salt-m-b--2"}),s.jsx(Pe.Typography,{className:"salt-m-b--2"}),s.jsx(Pe.Typography,{className:"salt-m-b--2"}),s.jsx(Pe.Typography,{className:"salt-m-b--2"}),s.jsx(Pe,{className:"salt-m-b--2",height:"15px",width:"150px"})]},"body"),s.jsx(bp,{"data-test":"skeleton-modal-content-footer",children:s.jsx(b,{fill:!0,intent:"primary",disabled:!0,children:s.jsx(Pe.Button,{size:"s"})})},"footer")],XBe=()=>[s.jsx(xp,{"data-test":"spinner-modal-content-header"},"header"),s.jsx(il,{"data-test":"spinner-modal-content-body",children:s.jsx(Rs,{className:"salt-m-y--16"},"inner")},"body"),s.jsx(bp,{"data-test":"spinner-modal-content-footer"},"footer")],ZBe={skeleton:s.jsx(QBe,{}),spinner:s.jsx(XBe,{})};let dD=class extends ie.Component{bodyElRef;constructor(t){super(t),this.handleScroll=this.handleScroll.bind(this),this.initBotShadow=this.initBotShadow.bind(this),this.bodyElRef=ie.createRef(),t.bodyElRef&&(this.bodyElRef=t.bodyElRef)}componentDidMount(){window.addEventListener("scroll",this.handleScroll,!0),this.initBotShadow()}componentDidUpdate(t){t.lastUpdated!==this.props.lastUpdated&&setTimeout(()=>this.initBotShadow,0)}componentWillUnmount(){window.removeEventListener("scroll",this.handleScroll,!0)}handleScroll(){this.bodyElRef.current&&(this.putShadow('[name="modal-header-shadow"]',"inset 0px 3px 6px 0px rgba(158,158,158,0.5)",!0),this.putShadow('[name="modal-footer-shadow"]',"inset 0px -3px 6px 0px rgba(158,158,158,0.5)"))}putShadow(t,n,o=!1){const r=document.querySelector(t),a=this.bodyElRef.current,i=a?.scrollHeight??0,l=a?.offsetHeight??0,c=a?.scrollTop??0,d=Math.abs(i-l),u=o?0:d;if(r){const m=r.style.boxShadow&&r.style.boxShadow!=="none";o&&c>u&&!m&&(r.style.boxShadow=n),!o&&c<u&&!m&&(r.style.boxShadow=n),c===u&&m&&(r.style.boxShadow="none")}}initBotShadow(){const t=document.querySelector('[name="modal-footer-shadow"]'),n=this.bodyElRef.current,o=n?.scrollHeight??0,r=n?.clientHeight??0;t&&o>r&&(t.style.boxShadow="inset 0px -3px 6px 0px rgba(158,158,158,0.5)")}render(){return s.jsx("div",{id:"modal-body",ref:this.bodyElRef,className:this.props.className,"data-test":this.props["data-test"],children:this.props.children})}};const il=T(dD)`
    flex-grow: 1;
    overflow: auto;
    padding: var(--salt-spacing-4);

    ${({condensed:e=!1})=>!e&&oe.smUp`
            padding-block: ${H(20)};
            padding-inline: ${H(50)};
    `};
`;il.displayName="Modal-Body";il.propTypes=rc.styledBody;il.defaultProps=Nd.styledBody;dD.propTypes=rc.body;dD.defaultProps=Nd.body;il.displayName="Modal-Body";il.propTypes=rc.styledBody;il.defaultProps=Nd.styledBody;bp.displayName="Modal-Footer";bp.propTypes=rc.footer;bp.defaultProps=Nd.footer;xu.propTypes=rc.fill;xu.defaultProps={grow:1,direction:"row"};const uD=e=>{const{onRequestClose:t,maxWidth:n,viewHeight:o,alternativeBackground:r,isLoading:a,loadingPlaceholder:i="skeleton",closeMessage:l,children:c,showCloseIcon:d,intl:u,isOpen:m,scrollToTop:g,aria:f,onAfterOpen:y,asBottomSheet:I,additionalCss:S,context:C="modal",skipFocusFirst:_,condensed:A,...x}=e,R=h.useRef(!1),O=h.useRef(null),N=oo(m)??!1,k=oo(a)??!1,j=h.useCallback(()=>{if(O.current&&!a&&!_){const $=[...O.current.querySelectorAll('a, button, input, textarea, select, details, [tabindex]:not([tabindex="-1"])')].filter(K=>!K.hasAttribute("disabled"));$.length>0&&$[0].focus()}},[a]),w=h.useCallback(()=>{y&&y(),j()},[y,j]),L=h.useCallback($=>{O.current=$},[]),B=h.useCallback(()=>g?"ReactModal__Body--open":null,[g]);if(h.useEffect(()=>{k&&!a&&j()},[k,a,j]),h.useEffect(()=>{if(N!==m)if(m){const $=document.documentElement.style.overflow==="hidden";R.current=$,wy()}else R.current||Mu()},[N,m]),h.useEffect(()=>(m&&wy(),()=>{Mu()}),[]),!m)return null;const W=ie.Children.map(c,$=>ie.isValidElement($)&&($.type===G.Header||$.type===G.Footer||$.type===G.Body)?ie.cloneElement($,{condensed:A}):$);return s.jsxs(sh,{id:"modal",...x,contentRef:L,onAfterOpen:w,bodyOpenClassName:B(),isOpen:m,aria:f,children:[s.jsx(xu,{onClick:t,"data-test":"modal-top-fill"}),s.jsxs(qBe,{children:[s.jsx(xu,{onClick:t,direction:"column",maxWidth:n}),s.jsxs(dq,{maxWidth:n,viewHeight:o,alternativeBackground:r,asBottomSheet:I,additionalCss:S,context:C,children:[a?ZBe[i]:W,t&&d&&s.jsx(yw,{size:"s",fill:!1,intent:"tertiary","aria-label":l||u.formatMessage("modal.close"),onClick:t,children:s.jsx(yw.Icon,{"data-test":"icon__close_default",name:"close_default"})})]}),s.jsx(xu,{onClick:t,direction:"column",grow:3})]}),s.jsx(xu,{onClick:t}),s.jsx(cq,{context:C})]})},Ti=T(uD)`
    ${()=>(sh.defaultStyles.overlay.backgroundColor="rgba(0, 0, 0, 0.75)",sh.defaultStyles.overlay.zIndex=Qt.overlay,"")};
    display: flex;
    block-size: 100%;
    font-family: var(--font-family);
`;uD.propTypes=rc.modal;uD.defaultProps=Nd.modal;Ti.displayName="Modal";Ti.propTypes=rc.styledModal;Ti.defaultProps=Nd.styledModal;Ti.Content=dq;Ti.Body=il;Ti.Header=xp;Ti.Footer=bp;Ti.ModalForm=zBe;Ti.ReactModal=sh;const G=Ct(Bt)(Ti);G.displayName="Modal";const JBe={breakpoint:p.oneOf(["sm-up","md-up","lg-up"]).isRequired,children:p.oneOfType([p.arrayOf(p.node),p.node]).isRequired,display:p.string,remainInDom:p.bool,as:p.oneOfType([p.string,p.func])},eUe=T.div.withConfig({shouldForwardProp:(e,t)=>!["display"].includes(e)&&t(e)})`
    display: none;

    ${({breakpoint:e})=>oe[or[e].mediaQueryKey]`
                display: ${({display:t})=>t||"block"};
            `};
`,cs=({breakpoint:e,children:t,display:n,remainInDom:o,as:r})=>{const{currentBreakpoint:a}=h.useContext(Pn),i=Ih({currentBreakpoint:a,breakpoint:e});return o?s.jsx(eUe,{breakpoint:e,display:n,as:r,children:t}):i?null:t};cs.propTypes=JBe;cs.defaultProps={display:"block",remainInDom:!0,as:void 0};const ll=()=>{const{currentBreakpoint:e}=h.useContext(Pn);return e},uq=T.div`
    position: relative;
`,pq=T.div`
    background-color: var(--intent-contrast);
    border-radius: var(--salt-radius-default);
    box-shadow: var(--salt-elevation-shadow-1);
    display: ${({isOpen:e})=>e?"block":"none"};
    position: absolute;
    /* stylelint-disable-next-line declaration-block-no-redundant-longhand-properties -- The ternary is causing this to fail if shorthand is initial */
    inset-inline-start: ${({align:e})=>e==="left"?"0":"initial"};
    /* stylelint-disable-next-line declaration-block-no-redundant-longhand-properties -- The ternary is causing this to fail if shorthand is initial */
    inset-inline-end: ${({align:e})=>e==="right"?"0":"initial"};
    inset-block-start: ${({verticalAlign:e})=>e==="top"?"0":"calc(100% + var(--salt-spacing-2))"};
    white-space: ${({textWrap:e})=>e?"normal":"nowrap"};
    inline-size: 100%;
    min-inline-size: 100%;
    z-index: ${Qt.dropdown};
    overflow-x: hidden;
    ${oe.smUp`
        inline-size: ${({fill:e})=>e?"100%":"auto"};
    `};
`,mq=T.div`
    max-block-size: ${({maxHeight:e})=>e||H(400)};
    padding-inline: var(--salt-spacing-2);
    padding-block: var(--salt-spacing-2);
    overflow-y: auto;
`;T.div`
    display: block;

    ${oe.smUp`
        display: inline-block;
        block-align: start;
    `};

    & + & {
        border: solid var(--salt-intent-secondary-100);
        border-block-width: var(--salt-border-1) 0;
        border-inline-width: 0;
        margin-block-start: var(--salt-spacing-2);
        padding-block-start: var(--salt-spacing-2);

        ${oe.smUp`
            border-block-width: 0;
            border-inline-width: 0 var(--salt-border-1);
            margin-block: 0;
            margin-inline: 0 var(--salt-spacing-2);
            padding-block: 0;
            padding-inline: 0 var(--salt-spacing-2);
        `};
    }
`;const tUe=T.div`
    background-color: var(--intent-contrast);
    border-radius: var(--salt-radius-default);
    margin-block: var(--salt-spacing-2);
    margin-inline: var(--salt-spacing-2);
    text-align: center;
`,Iw="close_default",Sw="arrow_down",hq=h.forwardRef(({iconName:e,text:t,isOpen:n,...o},r)=>s.jsxs(b,{ref:r,...o,children:[e&&s.jsx(b.Icon,{name:e,"data-test":`icon__${e}`}),t&&s.jsx(b.Text,{children:t}),s.jsx(b.Icon,{name:n?Iw:Sw,"data-test":n?`icon__${Iw}`:`icon__${Sw}`})]})),sUe="ko-KR",nUe={hasChildren:p.bool,numPanes:p.number,name:p.string,href:p.oneOfType([p.string,p.shape()]),icon:p.string,count:p.number,iconUrl:p.string,ItemComponent:p.func,itemComponentType:p.string,id:p.string,onClickListItem:p.func,onMouseOverListItem:p.func,generateItemUrl:p.func,onKeyDownListItem:p.func,paneIndex:p.number.isRequired,parentItemObj:p.shape({data:p.array,selectedItemId:p.string,name:p.string,parentItemObj:p.shape(),retailerId:p.string}),selected:p.bool,selectedItemId:p.string,header:p.bool,linkElement:p.oneOfType([p.string,p.func,p.elementType]),firstItem:p.bool,retailerCategoryId:p.string,intl:p.any.isRequired},oUe={hasChildren:!1,id:void 0,name:"",href:"",icon:null,count:void 0,iconUrl:"",ItemComponent:null,itemComponentType:null,selected:!1,parentItemObj:null,selectedItemId:"",header:!1,onClickListItem:void 0,onMouseOverListItem:void 0,onKeyDownListItem:void 0,generateItemUrl:void 0,linkElement:void 0,firstItem:!1,numPanes:null,retailerCategoryId:void 0},rUe=T.li`
    white-space: normal;
    ${oe.lgUp`
        inline-size: auto;
    `}
`,Cw=T(rt)`
    align-items: center;
    display: flex;
    justify-content: space-between;
    padding-block: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-4);
    font-size: var(--salt-text-m-font-size);
    inline-size: 100%;
    ${oe.lgUp`
        padding-block: var(--salt-spacing-2);
        padding-inline: var(--salt-spacing-4) var(--salt-spacing-1);
        background-color: ${({selected:e})=>e?"var(--intent-secondary-100)":"var(--intent-contrast)"};
    `}

    &:hover,
    &:focus {
        outline-offset: -${H(2)};
        background-color: var(--intent-secondary-100);
        text-decoration: ${({hasSubPanes:e})=>e?"none":"underline"};
    }
`,aUe=T.div`
    text-decoration: none;
`,iUe=T.div`
    align-items: center;
    display: flex;
    justify-content: space-between;
    padding-block: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-4);
`,Th=20,lUe=T.img`
    block-size: ${Th}px;
    inline-size: ${Th}px;
    display: inline-block;
`,cUe=T(P)`
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    inline-size: calc(100% - ${Th+8}px);
    display: inline-block;
`,CA=16,dUe=T.div`
    display: flex;
    align-items: center;
    inline-size: calc(100% - ${CA}px);
    min-block-size: ${Th}px;
`;class XS extends h.Component{getItemComponent(){const{ItemComponent:t,itemComponentType:n,paneIndex:o,firstItem:r}=this.props;return t?n==="link"?s.jsx(t,{linkElement:Cw,"data-first":r?`nav-pane-${o}`:void 0}):s.jsx(iUe,{children:s.jsx(t,{"data-first":r?`nav-pane-${o}`:void 0})}):null}getNavItemLink(){const{intl:t,hasChildren:n,onClickListItem:o,onMouseOverListItem:r,onKeyDownListItem:a,paneIndex:i,parentItemObj:l,selected:c,selectedItemId:d,numPanes:u,header:m,linkElement:g,firstItem:f,generateItemUrl:y,retailerCategoryId:I,count:S}=this.props,{id:C,name:_,href:A,icon:x,iconUrl:R}=this.props,O=t.locale,N=y&&y(m?l.name:_,C,I||l.retailerId),k={hasChildren:n,id:C,paneIndex:i,parentItemObj:l,selectedItemId:d},j=i<u-1,w=n&&j,L=!!S,B=!!(A||N),W=B?g:"a",$=B?void 0:"0",K=x?s.jsx(me,{name:x,height:Th,className:"salt-m-r--2"}):R&&s.jsx(lUe,{src:R,alt:"",className:"salt-m-r--2"}),Q=R?cUe:P,X=!!(m||R),re=!w&&l&&m,te=O===sUe?`${_} ${t.formatMessage("navigation.all")}`:`${t.formatMessage("navigation.all")} ${_}`;return s.jsxs(Cw,{as:W,href:A||N,to:A||N,"aria-haspopup":w,"aria-expanded":w?!m&&c:void 0,onClick:ce=>o&&o(ce,k),onMouseOver:()=>r&&r(k),onFocus:()=>{},onKeyDown:ce=>a&&a(ce,k),selected:c,"data-test":_,"data-first":f?`nav-pane-${i}`:void 0,hasSubPanes:w,tabIndex:$,standalone:!!B,children:[s.jsxs(dUe,{children:[K,s.jsx(Q,{size:"m",bold:X,children:re?te:_})]}),L&&s.jsx(aUe,{children:s.jsx(al,{intent:"secondary",count:S,"data-test":"nav-list-item-badge"})}),w&&s.jsx(me,{name:"arrow_right",height:CA,width:CA,fill:null})]})}render(){const t=this.getItemComponent()||this.getNavItemLink();return s.jsx(rUe,{role:"menuitem",children:t})}}XS.propTypes=nUe;XS.defaultProps=oUe;XS.displayName="NavListItem";const pD=Bt(XS),uUe={data:p.arrayOf(p.shape()),onClickListItem:p.func.isRequired,onMouseOverListItem:p.func.isRequired,generateItemUrl:p.func.isRequired,onKeyDownListItem:p.func.isRequired,paneIndex:p.number.isRequired,parentItemObj:p.shape({data:p.array,selectedItemId:p.string,parentItemObj:p.shape(),id:p.string,name:p.string}),selectedItemId:p.string,numPanes:p.number.isRequired,linkElement:p.oneOfType([p.string,p.func,p.elementType]),onClickListHeaderItem:p.func.isRequired,additionalBrowseShopLinks:p.arrayOf(p.shape()),menuCampaigns:p.arrayOf(p.shape())},pUe={data:[],parentItemObj:{},selectedItemId:"",linkElement:void 0,additionalBrowseShopLinks:[],menuCampaigns:[]},mUe=T.ul`
    list-style: none;
    margin: 0;
    padding: 0;
    position: relative;
    inline-size: 100%;
`,hUe=({paneIndex:e,linkElement:t,onClickListHeaderItem:n,onKeyDownListItem:o,onMouseOverListItem:r,additionalBrowseShopLinks:a,containsFirstItem:i,isLgDevice:l})=>(l&&e===0||!l&&e===1)&&a&&a.map(u=>s.jsx(pD,{header:!0,onClickListItem:n,onKeyDownListItem:o,linkElement:t,onMouseOverListItem:r,name:u.message,href:u.href,paneIndex:e,firstItem:i,count:u.count},u.message)),gq=({data:e,onClickListItem:t,onMouseOverListItem:n,paneIndex:o,parentItemObj:r,selectedItemId:a,numPanes:i,linkElement:l,onKeyDownListItem:c,generateItemUrl:d,containsFirstItem:u,isLgDevice:m})=>e.map((g,f)=>{const y=!!g.children.length,I=a===g.id,S=!m&&o===0;return s.jsx(pD,{linkElement:l,hasChildren:y,numPanes:i,id:g.id,name:g.name,icon:g.icon,count:g.count,href:g.href,retailerCategoryId:g.retailerId,ItemComponent:g.component,itemComponentType:g.componentType,onClickListItem:(C,_)=>{g.onClick&&g.onClick(),t(C,{retailerCategoryId:g.retailerId,categoryName:g.name,..._})},onMouseOverListItem:n,onKeyDownListItem:c,paneIndex:o,parentItemObj:r,selected:I,selectedItemId:a,firstItem:(u||S)&&f===0,generateItemUrl:d,iconUrl:g.iconUrl,role:"menuitem"},g.id)}),gUe=({onClickListItem:e,onMouseOverListItem:t,paneIndex:n,parentItemObj:o,selectedItemId:r,numPanes:a,linkElement:i,onKeyDownListItem:l,menuCampaigns:c,isLgDevice:d})=>(d&&n===0||!d&&n===1)&&gq({data:c,onClickListItem:e,onMouseOverListItem:t,paneIndex:n,parentItemObj:o,selectedItemId:r,numPanes:a,linkElement:i,onKeyDownListItem:l,containsFirstItem:!0,isLgDevice:d}),EUe=({paneIndex:e,linkElement:t,onClickListHeaderItem:n,onKeyDownListItem:o,onMouseOverListItem:r,parentItemObj:a,generateItemUrl:i,isLgDevice:l})=>{const c=e!==0,d=Object.keys(a).length!==0;return(l||c)&&d&&s.jsx(pD,{header:!0,onClickListItem:n,onKeyDownListItem:o,linkElement:t,name:a.name,id:a.id,paneIndex:e,onMouseOverListItem:r,parentItemObj:a,"data-test":"header",firstItem:!0,generateItemUrl:i})},fUe=({data:e,onClickListItem:t,onMouseOverListItem:n,paneIndex:o,parentItemObj:r,selectedItemId:a,numPanes:i,linkElement:l,onKeyDownListItem:c,generateItemUrl:d,isLgDevice:u})=>gq({data:e,onClickListItem:t,onMouseOverListItem:n,paneIndex:o,parentItemObj:r,selectedItemId:a,numPanes:i,linkElement:l,onKeyDownListItem:c,generateItemUrl:d,isLgDevice:u}),ZS=({data:e,onClickListItem:t,onMouseOverListItem:n,paneIndex:o,parentItemObj:r,selectedItemId:a,numPanes:i,linkElement:l,onKeyDownListItem:c,onClickListHeaderItem:d,additionalBrowseShopLinks:u,generateItemUrl:m,menuCampaigns:g})=>{const y=ll()==="lg",I=!!g?.length;return s.jsxs(mUe,{id:`nav-menu-pane-${o}`,"aria-labelledby":"nav-menu-button",role:"menu",children:[gUe({onClickListItem:t,onMouseOverListItem:n,paneIndex:o,parentItemObj:r,selectedItemId:a,numPanes:i,linkElement:l,onKeyDownListItem:c,menuCampaigns:g,isLgDevice:y}),hUe({paneIndex:o,linkElement:l,onMouseOverListItem:n,onClickListHeaderItem:d,onKeyDownListItem:c,additionalBrowseShopLinks:u,containsFirstItem:!I,isLgDevice:y}),EUe({paneIndex:o,linkElement:l,onMouseOverListItem:n,onClickListHeaderItem:d,onKeyDownListItem:c,parentItemObj:r,generateItemUrl:m,isLgDevice:y}),fUe({data:e,onClickListItem:t,onMouseOverListItem:n,paneIndex:o,parentItemObj:r,selectedItemId:a,numPanes:i,linkElement:l,onKeyDownListItem:c,generateItemUrl:m,isLgDevice:y})]})};ZS.propTypes=uUe;ZS.defaultProps=pUe;ZS.displayName="NavList";const yUe=T(ZS)``,JS={MENU_CAMPAIGNS:"MENU_CAMPAIGNS"},IUe=({isInDropdown:e,numberOfVisibleTabs:t=0,tabs:n})=>(e?n.slice(t):n.slice(0,t)).map((r,a)=>{const{label:i,id:l}=r,d=(e?t:0)+a+1;return{id:l,label:i,positionSeen:d,isInDropdown:e}}),SUe=(e,t)=>{const n="([^&?/]*)";return{KEYWORD:`search\\?.*q=${n}`,CATEGORY:t?`categories.*/${n}`:`sublocationId=${n}`,PROMOTION:`/offers.*/${n}`,SHOP_IN_SHOP_TEMPLATED:`\\/shop-in-shop\\/${n}`,CMS_STATIC_PAGE:`\\/content\\/${n}`}[e]},CUe=(e,t,n)=>{const o=e.match(new RegExp(SUe(t,n)));return o?o[1]:void 0},TA={tabsAnalyticsTransformer:IUe,extractUniqueIdentifierFromURL:CUe},Dt={FOP:"FOP",KEYWORD:"KEYWORD",PROMOTION:"PROMOTION",PROMOTIONS_LANDING:"PROMOTIONS_LANDING",BOP:"BOP",CATEGORY:"CATEGORY",INTERNAL_PAGE:"INTERNAL_PAGE",WEB_ADDRESS:"WEB_ADDRESS",INTERNAL_WEB_ADDRESS:"INTERNAL_WEB_ADDRESS",ABSOLUTE_WEB_ADDRESS:"ABSOLUTE_WEB_ADDRESS",CMS_STATIC_PAGE:"CMS_STATIC_PAGE",SLOT_BOOKING:"SLOT_BOOKING",FAVORITES:"FAVORITES",ORDERS:"ORDERS",SHOP_IN_SHOP:"SHOP_IN_SHOP",SHOP_IN_SHOP_TEMPLATED:"SHOP_IN_SHOP_TEMPLATED",RETAIL_BANNER:"RETAIL_BANNER",DEFAULT_TAB:"DEFAULT_TAB"},eC=(e,{threshold:t=0,rootMargin:n="0%",freezeOnceVisible:o=!1})=>{const[r,a]=h.useState(void 0),i=r?.isIntersecting&&o,l=([c])=>{a(c)};return h.useEffect(()=>{const c=e?.current;if(!!!window.IntersectionObserver||i||!c)return()=>{};const u={threshold:t,root:null,rootMargin:n},m=new IntersectionObserver(l,u);return m.observe(c),()=>m.disconnect()},[e?.current,n,i,t]),r},Eq=e=>{const t=h.useRef(null),n=eC(t,{freezeOnceVisible:!0}),o=h.useMemo(()=>!!n?.isIntersecting,[n]);return h.useEffect(()=>{o&&e()},[o,e]),t},TUe=()=>{const e=F(),t=h.useCallback(({menuCampaignName:i,menuCampaignId:l,index:c})=>{e(U.analyticsEvent({type:Nt.MENU_CAMPAIGN_DETAIL_IMPRESSION,menuCampaignName:i,menuCampaignId:l,index:c}));const d={event:"view_menu_campaign",id:l,index:c,name:i};J.sendEvent({GA:d,WA:null})},[e]),n=h.useCallback(({menuCampaignItemName:i,menuCampaignItemId:l,menuCampaignId:c,position:d})=>{e(U.analyticsEvent({type:Nt.MENU_CAMPAIGN_ITEM_IMPRESSION,menuCampaignItemName:i,menuCampaignItemId:l,menuCampaignId:c,sequence:d}));const u={ecommType:"enhanced",eventCategory:"E-commerce",event:"view_promotion",eventAction:"MENU_CAMPAIGN_ITEM_IMPRESSION",ecommerce:{promoView:{promotions:[{promotionType:"Menu Campaign",id:l,name:i,creative:"",position:`Menu campaign item ${d}`}]}}};J.sendEvent({GA:u,WA:null})},[e]),o=h.useCallback(({destinationLinkType:i,menuCampaignName:l,menuCampaignItemId:c,menuCampaignId:d,analyticsEventId:u,source:m,menuCampaignItemName:g,position:f,index:y,fileName:I})=>{e(U.analyticsEvent({type:Nt.MENU_CAMPAIGN_ITEM_CLICKED,destinationLinkType:i,menuCampaignName:l,menuCampaignItemId:c,menuCampaignId:d,menuCampaignItemName:g,position:f,index:y,fileName:I,...u?{analyticsEventId:u}:{},...m?{source:m}:{}}));const S={ecommType:"enhanced",eventCategory:"E-commerce",event:"select_promotion",eventAction:"MENU_CAMPAIGN_ITEM_CLICKED",ecommerce:{promoClick:{promotions:[{promotionType:"Menu Campaign",id:c,name:g,creative:I,position:`Menu campaign item ${f}`}]}}};J.sendEvent({GA:S,WA:null})},[e]),r=h.useCallback(({menuCampaignName:i,menuCampaignId:l,position:c,fileName:d})=>{e(U.analyticsEvent({type:Nt.MENU_CAMPAIGN_CLICKED,menuCampaignName:i,menuCampaignId:l,position:c,fileName:d}));const u={ecommType:"enhanced",eventCategory:"E-commerce",event:"select_promotion",eventAction:"MENU_CAMPAIGN_CLICKED",ecommerce:{promoClick:{promotions:[{promotionType:"Menu Campaign",id:l,name:i,creative:d,position:`Menu ${c}`}]}}};J.sendEvent({GA:u,WA:null})},[e]),a=h.useCallback(i=>{e(U.analyticsEvent({type:Nt.MENU_CAMPAIGN_ITEM_LIST_IMPRESSION,menuCampaignItemList:i}));const l={ecommType:"enhanced",eventCategory:"E-commerce",event:"view_promotion",eventAction:"MENU_CAMPAIGN_ITEM_LIST_IMPRESSION",ecommerce:{promoView:{promotions:i.map(c=>({promotionType:"Menu Campaign",id:c.id,name:c.name,creative:c.creative,position:`Menu campaign item ${c.position}`}))}}};J.sendEvent({GA:l,WA:null})},[e]);return{reportMenuCampaignDetailImpression:t,reportMenuCampaignItemImpression:n,reportMenuCampaignItemClick:o,reportMenuCampaignClick:r,reportMenuCampaignItemListImpression:a}},_Ue={onKeyDownListItem:p.func.isRequired,paneIndex:p.number.isRequired,parentItemObj:p.shape({iconUrl:p.string.isRequired,id:p.string,menuCampaignId:p.string.isRequired,menuCampaignIndex:p.number.isRequired,menuCampaignName:p.string.isRequired,name:p.string}).isRequired,items:p.arrayOf(p.shape()),onItemClick:p.func.isRequired},vUe={items:[]},Tw=e=>[Dt.WEB_ADDRESS,Dt.ABSOLUTE_WEB_ADDRESS,Dt.CATEGORY,Dt.PROMOTION,Dt.PROMOTIONS_LANDING].includes(e?.target?.linkType);let b_=[],HE="";const x_=e=>e?e.substring(e.lastIndexOf("/")+1):"",mD=e=>{const t=Ne(),[n,o]=h.useState(vt()),r=h.useRef([]),{items:a,onItemClick:i,onKeyDownListItem:l,paneIndex:c,parentItemObj:d}=e,{iconUrl:u,menuCampaignId:m,menuCampaignIndex:g,menuCampaignName:f,name:y}=d,I=TUe(),S=({targetUrl:N})=>{if(!N)return"";const k=nn(N),j=tt.parse(k.search);return{...k,search:`?${tt.stringify({...j,source:"IMAGE_CLICKED",sourceEventId:n})}`}},C=()=>{HE!==t&&(HE=t,b_=[])},_=()=>{r.current.length&&(I.reportMenuCampaignItemListImpression(r.current),r.current=[])};h.useEffect(()=>(HE=HE||t,C(),I.reportMenuCampaignClick({menuCampaignId:m,menuCampaignName:f,position:g.toString(),fileName:x_(u)}),I.reportMenuCampaignDetailImpression({menuCampaignId:m,menuCampaignName:f,index:g}),()=>{_()}),[d.id]);const A=h.useCallback(({destinationLinkType:N,menuCampaignItemId:k,targetUrl:j,position:w,index:L,fileName:B,menuCampaignItemName:W})=>{let $={};TA.extractUniqueIdentifierFromURL(j,"KEYWORD")&&($={source:"IMAGE_CLICKED"}),I.reportMenuCampaignItemClick({analyticsEventId:n,destinationLinkType:N,menuCampaignName:y,menuCampaignItemId:k,menuCampaignId:m,menuCampaignItemName:W,position:w,index:L,fileName:B,...$}),o(vt())},[]),x=h.useCallback(({menuCampaignItemId:N,fileName:k,position:j,menuCampaignItemName:w})=>{const L={promotionType:"Menu Campaign",id:N,name:w,creative:k,position:`Menu campaign item ${j}`},B=`${g}-${j}`;b_.includes(B)||(b_.push(B),r.current.push(L)),I.reportMenuCampaignItemImpression({menuCampaignItemName:w,menuCampaignItemId:N,menuCampaignId:m,position:j})},[a]);if(!a.length)return null;const R=({reportImpression:N,children:k})=>{const j=Eq(N);return s.jsx("div",{ref:j,"data-test":"menu-campaigns-item",children:k})};R.propTypes={reportImpression:p.func.isRequired,children:p.element.isRequired};const O={paneIndex:c,parentItemObj:d};return s.jsxs("div",{className:"salt-p-b--2 salt-m--4 lg:salt-m-r--0 lg:salt-p-b--1 lg:salt-p-x--1",children:[y&&s.jsx(P,{size:"l",className:"salt-m-t--4",children:y}),s.jsx("div",{className:"salt-m-t--4",children:s.jsx(He.MediaCardCollection,{formatting:"small",gridVariant:"auto-fill",tabIndex:"0","aria-label":y,"data-first":`nav-pane-${c}`,onKeyDown:N=>l&&l(N,O),"data-test":"menu-campaigns",children:a.map((N,k)=>s.jsx(R,{reportImpression:()=>{x({menuCampaignItemId:N.id,menuCampaignItemName:N.name,position:k,fileName:x_(N.imageUrl)})},children:s.jsx(He.MediaNavigationCard,{variant:"fullImage",formatting:"small",src:N.imageUrl,alt:N.altText,title:N.label,href:Tw(N)?N.targetUrl:void 0,to:Tw(N)?void 0:S(N),target:N.target?.openInNewTab?"_blank":void 0,onClick:j=>{A({destinationLinkType:N.target?.linkType,menuCampaignItemId:N.id,menuCampaignItemName:N.name,targetUrl:N?.targetUrl,position:k,index:k,fileName:x_(N.imageUrl)}),i(j,O)}},N.id)},N.id))})})]})};mD.propTypes=_Ue;mD.defaultProps=vUe;const AUe={data:p.arrayOf(p.shape()),showSpinner:p.bool,messages:p.shape({back:p.string,products:p.string}).isRequired,numPanes:p.number.isRequired,onClickListBack:p.func.isRequired,onClickListItem:p.func.isRequired,onClickListHeaderItem:p.func.isRequired,onMouseOverListItem:p.func.isRequired,onKeyDownListItem:p.func.isRequired,generateItemUrl:p.func.isRequired,paneIndex:p.number.isRequired,activePaneIndex:p.number,parentItemObj:p.shape({name:p.string,id:p.string,iconUrl:p.string,menuCampaignId:p.string,menuCampaignIndex:p.number,menuCampaignName:p.string}),prevPaneSelectedItemId:p.string,selectedItemId:p.string,linkElement:p.oneOfType([p.string,p.func,p.elementType]),additionalBrowseShopLinks:p.arrayOf(p.shape()),menuCampaigns:p.arrayOf(p.shape())},bUe={data:[],showSpinner:!1,activePaneIndex:0,parentItemObj:{},prevPaneSelectedItemId:"",selectedItemId:"",linkElement:void 0,additionalBrowseShopLinks:[],menuCampaigns:[]},xUe=Yl`
    0% { opacity: 0; }
    100% { opacity: 1; }
`,_w=25,vw=(e,t)=>e?t>1?H(550):H(300):H(240),RUe=T.div.withConfig({shouldForwardProp:(e,t)=>!["data","containsMenuCampaigns"].includes(e)&&t(e)})`
    background-color: ${({containsMenuCampaigns:e})=>e?"var(--background-color)":"var(--intent-contrast)"};
    box-sizing: border-box;
    overflow: hidden auto;
    backface-visibility: hidden;
    inline-size: 100%;
    max-block-size: calc(
        100vb - (var(--salt-spacing-4) - ${H(jn.lg+_w+Ny)})
    );

    ${oe.lgUp`
        overflow-y: scroll;
        ${({containsMenuCampaigns:e})=>e?qj("var(--intent-secondary-900)","var(--background-color)"):qj("var(--intent-secondary-900)","var(--intent-contrast)")}
        ${({data:e})=>e.length?De`
                      animation: ${xUe} 0.2s;
                  `:""}
        max-inline-size: ${({containsMenuCampaigns:e,data:t})=>De`
            ${vw(e,t[0]?.children?.length)}
        `};
        max-block-size: calc(100vh - (var(--salt-spacing-8) - ${H(jn.md+jn.sm+_w+Ny)}));
        opacity: ${({data:e})=>e.length?1:0};
        inline-size: ${({containsMenuCampaigns:e,data:t})=>De`
            ${vw(e,t[0]?.children?.length)}
        `};
        border-inline-start: var(--salt-border-1) solid var(--intent-secondary);

        &:first-child {
            border-inline-start: 0;
        }
        `}
`,DUe=T.button`
    display: flex;
    flex-direction: row;
    align-items: center;
    inline-size: 100%;
    line-height: 0;
    padding-block: var(--salt-spacing-4);
    padding-inline: var(--salt-spacing-4) 0;
    background-color: transparent;
    border: none;

    &:hover,
    &:focus {
        outline: none;
        background-color: var(--intent-secondary-100);
    }
`,tC=e=>{const{activePaneIndex:t,additionalBrowseShopLinks:n,data:o,generateItemUrl:r,linkElement:a,menuCampaigns:i,messages:l,numPanes:c,onClickListHeaderItem:d,onClickListItem:u,onKeyDownListItem:m,onMouseOverListItem:g,paneIndex:f,parentItemObj:y,prevPaneSelectedItemId:I,selectedItemId:S,showSpinner:C}=e,_={paneIndex:f,parentItemObj:y},A=o[0]?.navContentType===JS.MENU_CAMPAIGNS&&o[0]?.children?.length>0;return s.jsx(RUe,{id:`nav-pane-${f}`,"data-test":"nav-pane",data:o,numPanes:c,paneIndex:f,activePaneIndex:t,prevPaneSelectedItemId:I,containsMenuCampaigns:A,children:C?s.jsx(Rs,{"data-test":"nav-pane-spinner",className:"salt-m-t--16"}):s.jsxs(h.Fragment,{children:[f!==0&&s.jsx(Kt,{breakpoint:"lg-up",children:s.jsxs(DUe,{type:"button",onFocus:x=>x.stopPropagation(),onClick:x=>e.onClickListBack(x,_),children:[s.jsx(me,{verticalAlign:"middle",name:"arrow_left",height:18,width:18}),s.jsx(P,{className:"salt-m-l--2 salt-d--inline-block",size:"l",children:e.messages.back})]})}),A?s.jsx(mD,{items:o[0].children,paneIndex:f,parentItemObj:{iconUrl:y.iconUrl,id:y.id,menuCampaignId:y.menuCampaignId,menuCampaignIndex:y.menuCampaignIndex,menuCampaignName:y.menuCampaignName,name:y.name},onKeyDownListItem:m,eventData:_,onItemClick:u}):s.jsx(yUe,{linkElement:a,onMouseOverListItem:g,data:o,messages:l,numPanes:c,onClickListItem:u,onClickListHeaderItem:d,onKeyDownListItem:m,paneIndex:f,parentItemObj:y,selectedItemId:S,generateItemUrl:r,additionalBrowseShopLinks:n,menuCampaigns:i})]})})};tC.propTypes=AUe;tC.defaultProps=bUe;tC.displayName="NavPane";const OUe=T(tC)``,PUe=e=>{e&&e()},Aw=(e,t,{activePaneIndex:n,goToChildPane:o,goToPreviousPane:r,reset:a,keyboard:i})=>{const{charCode:l,keyCode:c}=e,d=l||c;d===i.ESC?PUe(a):d===i.ARROW_LEFT&&n>0?r(t.paneIndex):(d===i.ARROW_RIGHT||d===i.ENTER)&&t.hasChildren&&o(e,t)},NUe={categoriesDictionary:p.shape({categories:p.shape(),rootCategories:p.array}),"data-test":p.string,"data-loading":p.bool,entryPointsInHeader:p.arrayOf(p.shape()),additionalBrowseShopLinks:p.arrayOf(p.shape()),menuCampaigns:p.arrayOf(p.shape()),messages:p.shape({back:p.string,products:p.string,title:p.string,browse:p.string,attributeTitle:p.string}).isRequired,numPanes:p.number,onShowNavigation:p.func.isRequired,onHideNavigation:p.func,generateItemUrl:p.func.isRequired,currentBreakpoint:p.string.isRequired,paneWidth:p.number,linkElement:p.oneOfType([p.string,p.func,p.elementType]),keyboard:p.objectOf(p.number).isRequired,actions:p.shape({onOpen:p.func.isRequired,onOpenLgUp:p.func.isRequired,onFirstPaneDisplayed:p.func.isRequired,analyticsEvent:p.func.isRequired}).isRequired,location:p.shape({pathname:p.string}).isRequired,overheadContentHeight:p.number,theme:p.shape().isRequired,onToggleDropdown:p.func},LUe={numPanes:3,categoriesDictionary:void 0,"data-test":void 0,"data-loading":!1,entryPointsInHeader:[],additionalBrowseShopLinks:[],menuCampaigns:[],paneWidth:240,linkElement:void 0,overheadContentHeight:0,onToggleDropdown:()=>{}},kUe=T.div`
    position: fixed;
    inset: 0;
    ${Nb("transform .2s linear opacity")}
    background-color: rgb(0 0 0 / 75%);
    block-size: 100%;
    opacity: 0.7;
    inline-size: 100%;
    z-index: ${Qt.overlay};
`,fq=300,bw=25,xw=e=>({overheadContentHeight:t})=>{let n=bw;n+=t?t+bw:0,n=e?`calc( ${H(n)} + var(--salt-spacing-8) + ${H(jn.md+jn.sm)})`:`calc( ${H(n)} + var(--salt-spacing-4) + ${H(jn.lg)})`;let o;return typeof window<"u"&&typeof document<"u"&&(o=window.innerHeight),`calc(${o?`${o}px`:"100vh"} - ${n})`},MUe=T(mq)`
    display: flex;
    inline-size: ${({children:e})=>100*e.length}%;
    max-block-size: ${xw()};
    margin: 0;
    padding: 0;

    --nav-panel-direction: -1;

    html[dir='rtl'] & {
        --nav-panel-direction: 1;
    }

    transform: translateX(
        ${({activePaneIndex:e,children:t})=>`calc(var(--nav-panel-direction) * ${e*(100/t.length)}%)`}
    );
    transition: transform ${fq}ms ease-in-out;
    ${oe.lgUp`
        max-block-size: ${xw(!0)};
        transform: translateX(0);
        inline-size: 100%;
    `}
    overflow-y: hidden;
`,jUe=T(uq)`
    position: relative;
`,wUe=T(pq)`
    z-index: ${Qt["nav-menu"]};
    max-inline-size: 525px;
    inline-size: ${"calc(100vi - var(--salt-spacing-4))"};
    ${oe.mdUp`
        max-inline-size: 455px;
    `}
    ${oe.lgUp`
        inline-size: auto;
        max-inline-size: initial;
    `}
    display: ${({isDropdownOpen:e})=>e?"block":"none"};
`,Rm={data:[],parentItemObj:{},selectedItemId:""},FUe=()=>[Rm,Rm,Rm],BUe=({panes:e,paneIndex:t})=>e.map((n,o)=>t!==null&&o>=t?{...n,...Rm}:n),UUe=({categoriesDictionary:e,parentCategoryId:t})=>t&&e.categories[t]?{...e.categories[t]}:{},GUe=({categoriesDictionary:e,paneIndex:t,parentCategoryId:n})=>((n&&e.categories[n]&&t>-1?e.categories[n].children:e.rootCategories)||[]).map(r=>e.categories[r]),$Ue=(e,t)=>[yq(e,t)],yq=(e,t)=>e.find(n=>n.id===t),HUe=e=>{const t=e.map((n,o)=>n.Component?{id:`links${o}`,component:n.Component,componentType:n.componentType,children:{}}:{id:`links${o}`,href:n.href,name:n.message,icon:n.icon,children:n.children||{},onClick:n.onClick,count:n.count});return[{...Rm,data:t}]},VUe=({menuCampaigns:e,categoriesDictionary:t,clearPanesAfterIndex:n=null,currentPanes:o,highlightedCategoryId:r=null,paneIndex:a=-1,parentCategoryId:i=null,isLgDevice:l})=>{const c=GUe({categoriesDictionary:t,paneIndex:a,parentCategoryId:i}),d=BUe({panes:o,paneIndex:n}),u=l?a:a-1,m=yq(e,i)||UUe({categoriesDictionary:t,parentCategoryId:i}),g=m.navContentType===JS.MENU_CAMPAIGNS?$Ue(e,i):c;return d[u]={...d[u],data:g,parentItemObj:m,selectedItemId:r||"",menuCampaigns:e},d},Iq=De`
    z-index: ${({isOpen:e})=>e?Qt["nav-menu"]:Qt["nav-button"]};
`,YUe=T(hq)`
    ${Iq};
`,WUe=e=>e==="alternate"?"var(--header-top-bar-background-color-contrast)":void 0,Rw=T(b)`
    ${Iq};

    color: ${({headerColorScheme:e})=>WUe(e)};
`;let R_=!1,D_=!1;class hD extends h.Component{constructor(t){super(t),this.state={panes:FUe(this.props.numPanes),activePaneIndex:0,isDropdownOpen:!1},this.navListItemIntentTimer=null,this.onClickListBack=this.onClickListBack.bind(this),this.onClickListItem=this.onClickListItem.bind(this),this.onClickListHeaderItem=this.onClickListHeaderItem.bind(this),this.onMouseOverListItem=this.onMouseOverListItem.bind(this),this.onKeyDownListItem=this.onKeyDownListItem.bind(this),this.preparePane=this.preparePane.bind(this),this.generateMenuData=this.generateMenuData.bind(this),this.goToPreviousPane=this.goToPreviousPane.bind(this),this.goToChildPane=this.goToChildPane.bind(this),this.addWindowResizeListener=this.addWindowResizeListener.bind(this),this.removeWindowResizeListener=this.removeWindowResizeListener.bind(this),this.windowResize=this.windowResize.bind(this),this.toggleDropdownButton=this.toggleDropdownButton.bind(this),this.resetDropdown=this.resetDropdown.bind(this),this.onDropdownMouseUp=this.onDropdownMouseUp.bind(this),this.withDelayedMouseInteraction=this.withDelayedMouseInteraction.bind(this)}componentDidMount(){this.regeneratePanesState(),this.generateMenuData(),this.addWindowResizeListener()}componentDidUpdate(t,n){const{categoriesDictionary:o}=this.props;this.props.location.pathname!==t.location.pathname&&this.setState({isDropdownOpen:!1}),$i(t.categoriesDictionary,o)||this.regeneratePanesState(),n.isDropdownOpen!==this.state.isDropdownOpen&&this.props.onToggleDropdown(this.state.isDropdownOpen)}componentWillUnmount(){Mu(),this.removeWindowResizeListener()}isLgDevice(){return this.props.currentBreakpoint==="lg"}withDelayedMouseInteraction(t){clearTimeout(this.navListItemIntentTimer);const n=250;this.navListItemIntentTimer=setTimeout(()=>{t()},n)}onMouseOverListItem({hasChildren:t,id:n,paneIndex:o,selectedItemId:r}){this.withDelayedMouseInteraction(()=>{if(this.isLgDevice())if(!t)this.setState(a=>({panes:this.preparePane({parentCategoryId:a.id,clearPanesAfterIndex:o+1,paneIndex:a.paneIndex,highlightedCategoryId:null,currentPanes:a.panes,activePaneIndex:o})}));else{const a=o<this.props.numPanes-1;r!==n&&a&&this.setState(i=>{const l=t?o+1:o;return{panes:this.preparePane({parentCategoryId:n,clearPanesAfterIndex:o+1,paneIndex:o+1,highlightedCategoryId:null,currentPanes:i.panes}),activePaneIndex:l}})}})}onClickListItem(t,n,o){return this.goToChildPane(t,n,o)}onClickListHeaderItem(t,n){this.resetMenuAndPanes(n)}onClickListBack(t,{paneIndex:n}){t.stopPropagation(),t.preventDefault(),this.goToPreviousPane(n)}onKeyDownListItem(t,n){Aw(t,n,{activePaneIndex:this.state.activePaneIndex,goToChildPane:this.goToChildPane,goToPreviousPane:this.goToPreviousPane,keyboard:this.props.keyboard})}onDropdownMouseUp(){this.generateMenuData(),this.removeWindowResizeListener()}getNavButton(t,n){return s.jsxs(h.Fragment,{children:[s.jsx(cs,{breakpoint:"lg-up",display:"inline-block",children:s.jsx(YUe,{intent:t?"tertiary-contrast":"tertiary",size:"s",isOpen:t,text:this.props.messages.title,id:"nav-menu-button","data-test":"shop-button","aria-controls":t?"nav-menu":void 0,"aria-expanded":t,"aria-haspopup":"true",onClick:()=>{t||this.props.actions.onOpenLgUp(),n()},onMouseUp:t?void 0:this.onDropdownMouseUp})}),s.jsx(Kt,{breakpoint:"lg-up",display:"inline-block",children:s.jsxs(Rw,{isOpen:t,intent:t?"tertiary-contrast":"tertiary","data-test":"shop-button","aria-label":this.props.messages.title,onClick:()=>{t||this.props.actions.onOpen(),n()},headerColorScheme:this.props.headerColorScheme,onMouseUp:t?void 0:this.onDropdownMouseUp,children:[s.jsx(Rw.Icon,{name:`${t?"close_default":"menu"}`,"data-test":`${t?"icon__close_default":"icon__menu"}`}),s.jsx(Ee,{children:this.props.messages.attributeTitle})]})})]})}goToChildPane(t,{hasChildren:n,id:o,paneIndex:r,retailerCategoryId:a,categoryName:i,parentItemObj:l},c){if(n&&r<(this.isLgDevice()?this.props.numPanes-1:this.props.numPanes))return t.persist(),t.stopPropagation(),t.preventDefault(),this.isLgDevice()?(setTimeout(()=>{document.querySelector(`[data-first="nav-pane-${r+1}"]`)?.focus()},0),this.setState(u=>{const m=l?l.id:null;let g=this.preparePane({parentCategoryId:m,clearPanesAfterIndex:r,paneIndex:r,highlightedCategoryId:o,currentPanes:u.panes});return n&&(g=this.preparePane({parentCategoryId:o,clearPanesAfterIndex:r+1,paneIndex:r+1,highlightedCategoryId:null,currentPanes:g})),{panes:g,activePaneIndex:r+1}})):this.setState(u=>({panes:this.preparePane({parentCategoryId:o,clearPanesAfterIndex:r+1,paneIndex:r+1,highlightedCategoryId:o,currentPanes:u.panes}),activePaneIndex:r+1}));if(a){this.props.actions.analyticsEvent({type:tn.SELECT_CATEGORY_GA4_EVENT,location:"browse",categoryName:i,retailerCategoryId:a});const u={event:"select_category",id:a,location:"browse",name:i};J.sendEvent({GA:u,WA:null})}return c&&c()}windowResize(){D_!==this.isLgDevice()&&(D_=this.isLgDevice(),this.resetMenuAndPanes())}addWindowResizeListener(){R_||(R_=!0,D_=this.isLgDevice(),window.addEventListener("resize",this.windowResize))}removeWindowResizeListener(){R_=!1,window.removeEventListener("resize",this.windowResize)}goToPreviousPane(t){let n=0;if(!this.isLgDevice()){n=fq;const o=this.state.panes[t-2]&&this.state.panes[t-2].selectedItemId||null;this.setState(r=>({panes:this.preparePane({parentCategoryId:o,clearPanesAfterIndex:t-1,paneIndex:t-1,highlightedCategoryId:o,currentPanes:r.panes}),activePaneIndex:t-1}))}setTimeout(()=>{t!==0&&document.querySelector(`[data-first="nav-pane-${t-1}"]`)?.focus()},n)}preparePane({clearPanesAfterIndex:t=null,currentPanes:n,highlightedCategoryId:o=null,paneIndex:r=-1,parentCategoryId:a=null}){const{categoriesDictionary:i,menuCampaigns:l}=this.props;return VUe({menuCampaigns:l,categoriesDictionary:i,clearPanesAfterIndex:t,currentPanes:n,highlightedCategoryId:o,paneIndex:r,parentCategoryId:a,isLgDevice:this.isLgDevice()})}resetMenuAndPanes(t){t&&t(),this.generateMenuData()}generateMenuData(){this.setState(t=>({panes:this.preparePane({parentCategoryId:null,clearPanesAfterIndex:-1,paneIndex:0,highlightedCategoryId:null,currentPanes:t.panes}),activePaneIndex:0}))}regeneratePanesState(){this.setState(t=>({panes:this.preparePane({parentCategoryId:t.panes[t.activePaneIndex].parentItemObj.id,clearPanesAfterIndex:null,paneIndex:t.activePaneIndex,highlightedCategoryId:null,currentPanes:t.panes}),activePaneIndex:t.activePaneIndex}))}generatePanes(t){const n=[],{entryPointsInHeader:o,linkElement:r,messages:a,additionalBrowseShopLinks:i,generateItemUrl:l,menuCampaigns:c}=this.props,d=HUe(o);d.push(...this.state.panes);const u=this.state.panes.filter(y=>y.data.length>0),m=this.isLgDevice()?u:d,g=this.isLgDevice()?this.props.numPanes:this.props.numPanes+1,f=Math.min(m.length,g);for(let y=0;y<f;y+=1){const I=m[y-1]?m[y-1].selectedItemId:null,S={...m[y].parentItemObj},C=y!==0;n.push(s.jsx(OUe,{linkElement:r,data:m[y].data,showSpinner:C&&this.props["data-loading"],messages:a,paneIndex:y,numPanes:g,activePaneIndex:this.state.activePaneIndex,onClickListBack:this.onClickListBack,onClickListItem:(_,A)=>this.onClickListItem(_,A,t),onClickListHeaderItem:_=>this.onClickListHeaderItem(_,t),onMouseOverListItem:this.onMouseOverListItem,onKeyDownListItem:this.onKeyDownListItem,parentItemObj:S,prevPaneSelectedItemId:I,selectedItemId:m[y].selectedItemId,generateItemUrl:l,additionalBrowseShopLinks:i,menuCampaigns:c},S?.id??y))}return this.state.isDropdownOpen&&this.state.activePaneIndex===0&&!this.props["data-loading"]&&this.props.actions.onFirstPaneDisplayed(),n}toggleDropdownButton(){const t=!this.state.isDropdownOpen;t===!0?(this.generateMenuData(),this.props.onShowNavigation(),wy(),this.addWindowResizeListener()):(Mu(),this.props.onHideNavigation(),this.removeWindowResizeListener()),this.setState(()=>({isDropdownOpen:t}))}resetDropdown(){Mu(),this.removeWindowResizeListener(),this.setState({isDropdownOpen:!1})}render(){const{isDropdownOpen:t,activePaneIndex:n}=this.state,{overheadContentHeight:o}=this.props;return s.jsxs(jUe,{as:"nav",id:"navigation-dropdown","data-test":this.props["data-test"],onKeyDown:r=>Aw(r,{},{reset:this.resetDropdown,keyboard:this.props.keyboard}),children:[t&&s.jsx(kUe,{"data-test":"overlay",onClick:this.toggleDropdownButton}),this.getNavButton(t,this.toggleDropdownButton),s.jsx(wUe,{isOpen:!0,"data-test":"styled-dropdown",id:"nav-menu",isDropdownOpen:t,children:s.jsx(MUe,{activePaneIndex:n,overheadContentHeight:o,children:this.generatePanes(this.resetDropdown)})})]})}}function qUe(e){const t=ll();return s.jsx(hD,{...e,currentBreakpoint:t})}hD.defaultProps=LUe;hD.propTypes=NUe;const KUe=e=>({location:bS(e)}),zUe=ke(KUe)(T(qUe)``);Vn.displayName="NavigationList";const{ProgressBarElement:QUe}=WMe,XUe={progress:p.number},ZUe={progress:0},sC=({progress:e})=>s.jsx(QUe,{value:e});sC.displayName="ProgressBar";sC.propTypes=XUe;sC.defaultProps=ZUe;const JUe={ringContent:p.element,status:p.string,achievedStatus:p.string,progressFraction:p.string,completed:p.bool,ariaText:p.string,textSize:p.oneOf(["xs","s","m","l","xl"]),textPadding:p.oneOf(["xs","sm","md","lg","xl",null]),textPaddingLeft:p.oneOf(["xs","sm","md","lg","xl",null]),textAs:p.oneOf(["h2","h3","h4","h5","span","p"]),colorName:p.oneOf(["action","promotion"]),size:p.number,overrideText:p.element},Dw={xs:4,sm:8,md:16,lg:32,xl:64,xxl:128},Sq=T.div`
    display: flex;
    flex-wrap: nowrap;
    position: relative;
    inline-size: 100%;
    align-items: center;
`,Cq=T.div.withConfig({shouldForwardProp:(e,t)=>!["size"].includes(e)&&t(e)})`
    position: relative;
    inline-size: ${({size:e})=>H(e)};
    block-size: ${({size:e})=>H(e)};
`,Tq=T.div.withConfig({shouldForwardProp:(e,t)=>!["size"].includes(e)&&t(e)})`
    align-items: center;
    padding: ${({padding:e})=>H(Dw[e])};
    padding-inline-start: ${({paddingLeft:e})=>H(Dw[e])};
    inline-size: calc(100% - ${({size:e})=>e}px);
`,_q=e=>{const[t,n]=e.split("/");return Math.round(parseInt(t,10)/parseInt(n,10)*100)},eGe=T(P)`
    overflow: hidden;
    text-overflow: ellipsis;
`,ga=({status:e,achievedStatus:t,progressFraction:n,completed:o,textSize:r,textPadding:a,textPaddingLeft:i,textAs:l,ariaText:c,colorName:d,size:u,overrideText:m,ringContent:g})=>{const f=l;return s.jsxs(Sq,{"data-test":"progress-status-box",children:[s.jsx("div",{"aria-hidden":"true","data-test":"progress-status-animation",children:o?s.jsx(Cq,{size:u,children:s.jsx(me,{name:"status_yes",height:u,width:u,success:!0})}):s.jsx(oc,{colorName:d,progressValue:_q(n),autoProgress:!1,size:u,children:g})}),s.jsx(Tq,{size:u,padding:a,paddingLeft:i,"aria-hidden":c?"true":"false",children:m||s.jsxs(h.Fragment,{children:[s.jsx(eGe,{asChild:!0,size:r,className:"salt-d--block",children:s.jsx(f,{children:e})}),s.jsx(P,{asChild:!0,size:r,bold:!0,children:s.jsx(f,{children:t})})]})}),c&&s.jsx(Ee,{asChild:!0,children:s.jsx("h1",{children:c})})]})};ga.propTypes=JUe;ga.defaultProps={ringContent:null,overrideText:null,status:null,achievedStatus:null,progressFraction:null,completed:!1,textSize:"m",textPadding:"md",textPaddingLeft:"md",textAs:"span",colorName:"action",size:58,ariaText:null};ga.Wrapper=Sq;ga.IconWrapper=Cq;ga.TextWrapper=Tq;ga.getPercentageFromFractionString=_q;const{StyledTag:tGe,TagText:sGe}=sje,gD=({icon:e,size:t="sm",minSize:n,children:o,onClick:r,as:a,buttonAriaLabel:i,className:l,dataTestId:c})=>s.jsxs(tGe,{as:a,size:t,minSize:n,className:l,"data-test":c,children:[e&&s.jsx(me,{name:e}),s.jsx(sGe,{bold:!0,children:o}),s.jsx(b,{size:"s",intent:"tertiary",fill:!1,onClick:r,"aria-label":i,children:s.jsx(b.Icon,{name:"close_default"})})]});gD.displayName="Tag";const nGe={show:p.bool},vq=T.div`
    display: ${({show:e})=>e?"block":"none"};
    ${oe.mdUp`
        display: block;
    `}
`;vq.propTypes=nGe;const oGe=T.a`
    font-weight: 600;
    display: flex;
    align-items: center;
    text-decoration: none;
    min-block-size: ${H(40)};
    min-inline-size: ${H(40)};
    padding-inline: var(--salt-spacing-4);
    position: absolute;
    inset-block-start: 0;
    inset-inline-start: 0;
    z-index: ${Qt["skip-link"]};
    background-color: #ff9f1c;
    border: none;
    border-radius: var(--salt-radius-default);
    color: #000;
    text-align: start;
    vertical-align: middle;

    &:hover,
    &:active,
    &:enabled {
        background-color: #ff9f1c;
        border: none;
        color: #000;

        &:visited {
            background-color: #e2e8edff;
        }
    }

    &:not(:focus, :active) {
        ${DR}
    }
`,yg=({text:e,location:t,testId:n,onClick:o})=>s.jsx(oGe,{"data-test":n,href:t,onClick:o,children:s.jsx(P,{bold:!0,children:e})});yg.displayName="SkipLink";const Yi="CUSTOMER_COLLECTION",la="HOME_DELIVERY",rGe=e=>{if(e.length){const t=e.map(r=>parseFloat(r.deliveryPrice.amount)),n=Math.min(...t),o=Math.max(...t);return{min:n,max:o,currency:e[0].deliveryPrice.currency}}return null},Aq=(e,t,n)=>{const o=n({amount:e.min,currency:e.currency});if(e.min===e.max)return o;const r=n({amount:e.max,currency:e.currency});return t.formatMessage("slots.price.range",{minPrice:o,maxPrice:r})},ho=F,$e=E,bq=(e,t)=>{const n={KG:e("bop.catch.weight.unit.kg"),G:e("bop.catch.weight.unit.g")};return t&&Object.keys(n).includes(t)?n[t]:""},$a=(e,t,n,o={})=>{const r=e(Number(t.amount),{...o,style:"currency",currency:t.currency,currencyDisplay:n?"code":void 0});return n?.includes("{value}")?n.replace("{value}",r.replace(t.currency,"").trim()):r},ze=()=>{const{formatNumber:e}=M(),t=$e(pi);return(n,o)=>$a(e,n,t,o)},aGe=({price:e})=>{const{formatNumber:t}=M(),n=$e(pi);return $a(t,e,n)},ED=()=>{const{formatMessage:e}=M(),t=ze();return({item:n,withDescription:o=!0})=>{if(!n)return"";const r=parseFloat(n.price.amount)===0?e({id:"delivery-details.delivery-asset-selector.option.price.free.label"}):t(n.price);return o&&n.description?e({id:"delivery-details.delivery-asset-selector.option.label.with-description"},{name:n.displayValue,priceLabel:r,description:n.description}):e({id:"delivery-details.delivery-asset-selector.option.label"},{name:n.displayValue,price:r})}},xq=()=>{const{formatMessage:e}=M();return(t,n)=>e("fop.price.per.flexible_units",{price:t,unitPriceDescription:n})},fD="STANDARD",Pa="ON_DEMAND",_h="AVAILABLE",Rq="GEOWIDGET",yD="GRID",Dq="SIMPLE",Oq="FIXED",Dm="standard",Ku="saver",Ig=e=>{const t=M(),n=ze();return e.type===la?e.deliveryPrice?Aq(e.deliveryPrice,t,n):"":t.formatMessage(e.subtitle)},_A=(e,t)=>!sd(e)&&!Yb(e,t),Pq=e=>e.slotEndDateTimeISO!==void 0,Nq=e=>e.onDemandProperties!==void 0,ID=e=>{const t=Ll(),{deliveryEndDate:n,deliveryStartDate:o,deliveryTimeInMinutes:r,collectionTimeInMinutes:a}=e;if(r!==void 0){const i=tA(r,t),l=tA(a||0,i);return XI(l)?void 0:{type:"fixed",..._A(i,l)&&{startDate:i},endDate:l}}if(n)return{type:"fixed",...(o?_A(o,n):!1)&&{startDate:o},endDate:n}},Lq=e=>{const n=Ll(),{deliveryEndDate:o,deliveryStartDate:r,deliveryTimeInMinutes:a,collectionTimeInMinutes:i}=e;if(a!==void 0)return i?a<1440?{type:"relative",maxDays:Math.ceil(i/1440)}:{type:"relative",minDays:Math.ceil(a/1440),maxDays:Math.ceil(a/1440+(i||0)/1440)}:{type:"relative",maxDays:Math.floor(a/1440)};if(o)return XI(o)?ID(e):{type:"relative",...(r?_A(r,o):!1)&&{minDays:fy(r,n)},maxDays:fy(o,n)}},iGe=e=>({deliveryStartDate:e.slotDateTimeISO,deliveryEndDate:e.slotEndDateTimeISO}),lGe=e=>{const{onDemandProperties:t}=e;return{deliveryTimeInMinutes:t.deliveryTimeInMinutes,collectionTimeInMinutes:t.collectionTimeInMinutes}},cGe=(e,t)=>{let n;if(Pq(t)?n=iGe(t):Nq(t)&&(n=lGe(t)),!!n)return e==="FIXED"?ID(n):Lq(n)},kq=(e,t)=>{switch(e.type){case"fixed":{const{startDate:n,endDate:o}=e;if(n){const r=r0(n,o)?VI:Xo;return t.formatMessage("delivery.fixed.date.format.full",{startDate:yt(n,r),endDate:yt(o,Xo)})}return sd(o)?t.formatMessage("delivery.relative.date.today"):lh(o)?t.formatMessage("delivery.relative.date.tomorrow"):t.formatMessage("delivery.fixed.date.format.short",{date:yt(o,Xo)})}case"relative":{const{minDays:n,maxDays:o}=e;return n?t.formatMessage("delivery.relative.date.format.full",{minDays:n,maxDays:o}):o===0?t.formatMessage("delivery.relative.date.today"):o===1?t.formatMessage("delivery.relative.date.tomorrow"):t.formatMessage("delivery.relative.date.format.short",{days:o})}default:return""}},dGe=(e,t,n)=>{if(!t)return"";const o=cGe(e,t);return o?kq(o,n):""},uGe=(e,t,n)=>{if(!t||!e)return"";const o=e==="FIXED"?ID(t):Lq(t);return o?kq(o,n):""},Mq=(e,t,n,o)=>{const r=dGe(e,t,o);return r?o.formatMessage("carriers-slot-booking.slot-title",{carrierName:n,additionalInfo:r}):n},pGe=e=>{if(Pq(e)){const t=e.slotEndDateTimeISO.split("T")[0];return{SLOT_TYPE:fD,INTERVAL_TIME_ZONE_ID:e.timeZoneId,INTERVAL_START:e.slotDateTimeISO,INTERVAL_END:e.slotEndDateTimeISO,INTERVAL_START_DATE:t||"",IS_AVAILABLE:e.attributes.includes("AVAILABLE"),...e.attributes.includes("AVAILABLE")&&{DELIVERY_PRICE_AMOUNT:e.deliveryPrice.amount,DELIVERY_PRICE_CURRENCY:e.deliveryPrice.currency}}}else if(Nq(e)){const t="1",{collectionTimeInMinutes:n}=e.onDemandProperties;return{SLOT_TYPE:Pa,PRICE_DISPLAYED:e.deliveryPrice.amount,PRICE_CURRENCY:e.deliveryPrice.currency,DELIVERY_TIME_IN_MINUTES:`${e.onDemandProperties.deliveryTimeInMinutes}`,SEQUENCE:t,...n&&{COLLECTION_TIME_IN_MINUTES:`${n}`}}}return{}},jq=ee("SLOTS_ANALYTICS_SEEN"),mGe=e=>({type:"API",payload:{url:"/v2/slots/analytics/seen",...jq,service:"ecomslots",pathPrefix:{client:"/api/ecomslots",server:"/core-api"},options:{method:"POST",body:{...e}}}}),hGe={seenSlots:mGe,types:{SLOTS_ANALYTICS_SEEN:jq}},gGe=D("sl.df"),EGe=({seenSlots:e})=>async(t,n)=>{const o=n(),r=gGe(o),a=e?.length;r&&a&&await t(hGe.seenSlots({seenSlots:e}))},vA={seenSlots:EGe},fGe=e=>{const t=e.match(/[+-]\d{2}:\d{2}$/);if(t)return t[0]},wq=e=>{const t="deliveryPrice"in e?e.deliveryPrice.amount:void 0,n="deliveryPrice"in e?e.deliveryPrice.currency:void 0,o=fGe(e.slotDateTimeISO),r="slotEndDateTimeISO"in e?e.slotEndDateTimeISO:e.endTimeISO;return{SLOT_INTERVAL_START:Ey(e.slotDateTimeISO),SLOT_INTERVAL_END:Ey(r),IS_AVAILABLE:e.attributes.includes(_h),SLOT_TYPE:fD,...t?{DELIVERY_PRICE_AMOUNT:t}:{},...n?{DELIVERY_PRICE_CURRENCY:n}:{},...o?{SLOT_INTERVAL_TIME_OFFSET:o}:{}}},yGe=D("sv.sl"),IGe=D("sv.sl.vb"),SGe=D("sv.sl.def"),CGe="slotGroup",TGe=V(SGe,e=>e?Ku:Dm),_Ge=e=>{const n=e.router.location?.query?.[CGe];return n!==Ku&&n!==Dm?null:n},Rp=V(yGe,IGe,TGe,_Ge,(e,t,n,o)=>{if(!(!e||t))return o||n}),$c="slot-booked",Fq="grocery",SD=`${$c}=true`,CD=`${$c}=${Fq}`,AA="page-reloaded",Ar="saverslots",vGe="date",AGe="SLOT_BOOKING_PAGE",bGe="SEASONAL_SLOT_LINK",xGe="SLOT_BOOKING_PAGE_TEST_3",RGe={id:"check-slots",title:"delivery.type.name.cnc",subtitle:"carriers-selection.customer.collection.title",iconDescription:"Collection",iconUrl:"images/300x300.png",slotTimesDisplayMode:"FIXED",view:yD,type:Yi},DGe=250,Ow=8,kc=(e,t)=>{if(!(!e||!t))return Ge(e,Ge.ISO_8601).tz(t).format()},Bi=e=>Ge.parseZone(e).format("YYYYMMDD"),Bq=e=>Ge.parseZone(e).format("YYYY-MM-DD"),OGe=/\[.*]/,Sn=e=>e?.replace(OGe,""),bA=(e,t)=>Bi(Sn(e))!==Bi(Sn(t)),PGe=(e,t)=>{if(!e||!t)return[];const n=e.endOf("day"),o=t.endOf("day"),r=Math.round(o.diff(n,"days",!0)),a=[];for(let i=0;i<=r;i+=1)a.push(e.clone().add(i,"days"));return a},Pw=(e,t)=>{const n=Mt.parseZone(e),o=Mt(t,"HH:mm").utcOffset(n.utcOffset(),!0);return n.set({hour:o.hour(),minutes:o.minutes()})},NGe=(e,t)=>{const n=Mt.parseZone(Sn(e.localizedStartTime)),o=Mt.parseZone(Sn(t.localizedEndTime));if(n.isSame(o)){const r=Mt.parseZone(Sn(e.localizedEndTime)),a=Mt.parseZone(Sn(t.localizedEndTime));return r.valueOf()-a.valueOf()}return n.valueOf()-o.valueOf()},LGe=e=>e.partId===Ar,Uq=(e,t,n)=>{const o=Sg(e,t),r=n.find(({intervals:l})=>l.some(c=>c.intervalId===o)),i=bA(e,t)&&r&&r?.partId!==Ar;return!r?.partId||i?null:r.partId},kGe=(e,t,n)=>{const o=Mt.parseZone(e.start);if(LGe(t)){const l=Mt.parseZone(e.end);return Mt.duration(l.diff(o)).asMinutes()>=n}const r=t,a=Pw(e.end,r.start),i=Pw(e.end,r.end);return o.isBetween(a,i,null,"[)")},Sg=(e,t)=>{const n=Mt.parseZone(Sn(e)).format("HHmm"),o=Mt.parseZone(Sn(t)).format("HHmm");return`${n}-${o}`},MGe=e=>{const t=new Map;return e.forEach(n=>{const o=Sg(n.localizedStartTime,n.localizedEndTime);t.has(o)||t.set(o,{intervalId:o,start:Sn(n.localizedStartTime),end:Sn(n.localizedEndTime),order:t.size,timeZoneId:n.timeZoneId})}),[...t.values()].sort((n,o)=>n.intervalId.localeCompare(o.intervalId)).map((n,o)=>({...n,order:o}))},jGe=e=>e.map(({partId:t,start:n,end:o})=>({partId:t,start:n,end:o,intervals:[]})),wGe=(e,t,n)=>{const o=MGe(e),r=jGe(t);return o.forEach(a=>{for(let i=0;i<r.length;i+=1){const l=r[i];if(l&&kGe(a,l,n)){l.intervals.push(a);return}}}),r.map(({partId:a,intervals:i})=>({partId:a,intervals:i}))},FGe=(e,t)=>{const n=new Map;for(const o of e){const r=Mt.utc(o.slotWindow.startTime).tz(t),i=Mt.utc(o.slotWindow.endTime).tz(t).diff(r,"minutes"),l=`${r.day()}-${r.hour()}-${r.minute()}-${i}`;n.has(l)||n.set(l,[]),n.get(l)?.push(o)}return n},BGe=(e,t,n,o)=>{const r=t.diff(e,"minutes");for(const a of[1,2]){const i=e.clone().add(a,"weeks"),l=`${i.day()}-${i.hour()}-${i.minute()}-${r}`,c=n.get(l);if(!c)continue;const d=c.find(u=>Mt.utc(u.slotWindow.startTime).tz(o).isSame(i,"minute"));if(d?.deliveryPrice)return d.deliveryPrice}},UGe=(e,t,n,o)=>{const r=Mt.utc(e).tz(n),a=Mt.utc(t).tz(n);return Mt.duration(a.diff(r)).asMinutes()<o?r.isBefore(r.clone().set({hour:20,minute:30}))?7:6:r.isBefore(r.clone().set({hour:18,minute:0}))?5:4},Gq=ee("GET_DEFAULT_SHIPPING_GROUP_TYPE"),GGe=(e,t)=>{let n="";if(t){const o=new URLSearchParams;o.set("deliveryDestinationId",t),n=`?${o.toString()}`}return{type:"API",payload:{url:`/v1/default-shipping-group/${e}${n}`,service:"checkoutgroups",pathPrefix:{client:"/api/checkout-groups",server:"/core-api"},...Gq}}},xf={getDefaultShippingGroupType:GGe,types:{GET_DEFAULT_SHIPPING_GROUP_TYPE:Gq}},$Ge={isFetching:!1,fetchError:!1,didInvalidate:!1,lastUpdated:null,error:null,value:null},HGe=(e=$Ge,t)=>{switch(t.type){case xf.types.GET_DEFAULT_SHIPPING_GROUP_TYPE.PENDING:return{...e,isFetching:!0};case xf.types.GET_DEFAULT_SHIPPING_GROUP_TYPE.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload||null};case xf.types.GET_DEFAULT_SHIPPING_GROUP_TYPE.SUCCESS:{const{defaultShippingGroupType:n}=t.payload.responseData;return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),value:n}}default:return e}},VGe=({data:e})=>e.delivery.defaultShippingGroup.value,YGe="shippingGroup",WGe=e=>e.router.location.search,Dp=V([pg,Cd,iS,Jb,WGe],(e,t,n,o,r)=>{if(!e&&!t)return o;const a=new URLSearchParams(r).get(YGe);return a&&!t?a:n}),Op=V([Cd,VGe,Jb,Dp],(e,t,n,o)=>e?t===o:n===o),qGe={error:null,isFetching:!1,fetchError:!1,didInvalidate:!1,lastUpdated:null,data:null},KGe={CARRIER:"CARRIER"},nC=({data:e})=>e.delivery.slotbooking?.data?.carriers||[],TD=e=>{const t=e.router.location?.search||"";return tt.parse(t)?.carrierId??null},zGe=e=>e.data.delivery.slotsConfiguration.data,QGe=()=>Mt().format("YYYY-MM-DDTHH:mm:ss.SSS[Z]"),$q=e=>!!e&&"onDemandProperties"in e,Hq=({standardSlots:e,onDemandSlots:t,carriers:n})=>{const o=[...new Set(n.map(({carrierId:a})=>a))].map(a=>[a,[],[]]);[e,t].forEach((a,i)=>{a.forEach(l=>{const c=o.find(([d])=>d===l.carrierId);c&&c[i+1].push(l)})});const r=o.filter(([,a,i])=>!!a.length||!!i.length);return Object.fromEntries(r.map(([a,i,l])=>[a,{standardSlots:i,onDemandSlots:l}]))},Vq=({groupedSlots:e,selectedCarrier:t,carriersEnabled:n,standardSlots:o,onDemandSlots:r})=>{if(!n)return{standardSlots:o,onDemandSlots:r};const a={standardSlots:[],onDemandSlots:[]};return t?.type===la&&e[t.id]||a},cr=({data:e})=>e.delivery.slotbooking,_D=V(cr,({data:e})=>e?.days),XGe=V(_D,e=>{if(!e)return[];let t=!1;return e.filter(n=>t||n.hasAnyAvailableSlot?(t=!0,!0):!1)}),Ld=V(cr,({data:e})=>e?.partsOfDay),vD=V(cr,({data:e})=>e?.slots||[]),AD=V(vD,e=>e.filter(({attributes:t})=>t?.includes(_h))),Cg=V(cr,({data:e})=>e?.onDemandSlots||[]),ZGe=V(Cg,e=>!!e.length),bD=V([AD,Cg,nC],(e,t,n)=>Hq({standardSlots:e,onDemandSlots:t,carriers:n})),JGe=V([vD,Cg,nC],(e,t,n)=>Hq({standardSlots:e,onDemandSlots:t,carriers:n})),e$e=V([TD,bD],(e,t)=>!e||!t?.[e]?null:t[e].standardSlots[0]||t[e].onDemandSlots[0]);D("sl.c");const Yq=D("sv.sl.sti"),oC=V(D("sv.sl"),D("sv.sl.vb"),(e,t)=>e&&!t),xD=V(Ld,(e=[])=>e?.filter(({partId:t})=>t!==Ar).some(({intervals:t})=>t.length)),Wq=V(oC,Ld,xD,(e,t,n)=>{if(!e||!t)return!1;const o=t.find(({partId:a})=>a===Ar),r=o?o.intervals.length>0:!1;return n&&r});V(oC,Ld,xD,(e,t,n)=>{if(!e||!t)return!1;const o=t.find(({partId:a})=>a===Ar),r=o?o.intervals.length>0:!1;return!n&&r});const t$e=V(oC,Ld,Rp,xD,(e,t,n,o)=>!t||!o?!1:t.find(({partId:a})=>a===Ar)&&e?n!==Ku:!0),s$e=V(Ld,Wq,Rp,(e,t,n)=>{if(!t)return e;const o=n===Ku;return e?.filter(({partId:r})=>r===Ar?o:!o)}),Tg=e=>V(zGe,t=>!t||!e?!1:t.shippingGroups?.find(o=>o.shippingGroupType===e)?.slotDisplayMode===KGe.CARRIER),_i=e=>{const t=Dp(e);return Tg(t)(e)},Pp=V(cr,e=>e.debouncedSlotListingRequests>0||e.pendingSlotListingRequests>0),RD=V(AD,ZGe,(e,t)=>!e.length&&!t?!1:e.length?e.some(n=>n.attributes.includes("AVAILABLE")):t),Np=V([nC,bD,Pp,cr,RD],(e,t,n,o,r)=>{if(n||!o.data||!r)return[];const a=e.filter(i=>i.carrierId in t).map(i=>{const l=[...t[i.carrierId].standardSlots,...t[i.carrierId].onDemandSlots];return{id:i.carrierId,title:i.name,deliveryPrice:rGe(l),type:la,iconUrl:i.iconUrl,iconDescription:i.iconDescription,slotTimesDisplayMode:i.slotTimesDisplayMode,view:i.slotBookingComponent}});return a.push(RGe),a}),qq=V([Np],e=>e.length?e[0]:null),cl=V([TD,Np,qq],(e,t,n)=>e?t.find(o=>o.id===e)??null:n),Kq=V([_i,cl],(e,t)=>e&&t?.view!==yD),rC=V([bD,cl,_i,AD,Cg],(e,t,n,o,r)=>Vq({groupedSlots:e,selectedCarrier:t,carriersEnabled:n,standardSlots:o,onDemandSlots:r})),n$e=V([JGe,cl,_i,vD,Cg],(e,t,n,o,r)=>Vq({groupedSlots:e,selectedCarrier:t,carriersEnabled:n,standardSlots:o,onDemandSlots:r})),zq=V([n$e],({standardSlots:e})=>{const t={};for(const n of e){const o=`${n.slotDayId}|${n.slotPartId}|${n.slotIntervalId}`;t[o]=n.slotId}return t}),DD=V([rC],({standardSlots:e})=>e.filter(t=>t.slotPartId)),OD=V(cr,({data:e})=>e?.seasonalSlotPeriods||[]),PD=V(Ql,ma,(e,t)=>{if(!e||e.deliveryDestinationId!==t)return;const n=e?.slotId,o=e?.start,r=e?.end,a=Sg(o,r);if(!(!n||!o||!r||!a))return{slotId:n,slotDayId:Bi(Sn(e?.start)),slotDateTimeISO:o,slotEndDateTimeISO:r,slotIntervalId:a,slotPartId:null,timeZoneId:e.timeZoneId,carrierId:e?.carrierId||"",attributes:[],slotType:e.slotType,deliveryPrice:{amount:"0",currency:""}}}),ND=V([rC],e=>e.onDemandSlots),o$e=V([ND],e=>!!e.length),r$e=V(cr,({data:e})=>e?.checkoutGroupsChanged||!1),_g=V(cr,Pp,(e,t)=>!e.lastUpdated||t),Qq=V(cr,Pp,(e,t)=>!t&&e.fetchError),a$e=V(Ld,e=>{if(!e)return null;const t=e.find(n=>n.intervals.length>0);return t?t.intervals[0].timeZoneId:null}),i$e=V(cr,e=>e.successRequestParams),l$e=V(cr,e=>e.persistedPreviousAddress);V(cr,({data:e})=>e?.slotListingId);const c$e=V(xs,DD,(e,t)=>e===Et.vanDelivery.method?t.filter(o=>o.attributes?.includes("GREEN")&&o.attributes?.includes("AVAILABLE")).map(o=>o.slotId):[]),d$e=(e,t)=>({partId:`part${t}`,start:qe(e,`fulfillment-times-of-day-start-${t}`),end:qe(e,`fulfillment-times-of-day-end-${t}`)}),u$e=e=>Number(e.retailerSettings["slot-booking-saver-slots-minimum-length-in-minutes"]),p$e=e=>{const t=parseInt(qe(e,"fulfillment-times-of-day"),10),n=[];for(let o=1;o<=t;o+=1)n.push(d$e(e,o));return n},m$e=(e,t)=>`${t?`${t}-`:""}${e}`,bo=()=>{const e=F(),[t,n]=h.useState(new Set),o=E(Rp),r=ze(),a=E(At),i=E(ua),{onDemandSlots:l}=E(rC),c=E(pS),d=E(ma),u=M(),m=g=>{const{type:f,title:y}=g,I=f===la&&g.deliveryPrice?Aq(g.deliveryPrice,u,r):"";return{carrierName:f===la?y:u.formatMessage(y),priceSubtitle:I}};return{carrierSelectionClicked:({item:g})=>{const{carrierName:f,priceSubtitle:y}=m(g);return e(U.analyticsEvent({type:Fe.CARRIER_SELECTION_CLICKED,ORDER_ID:a,RETAILER_CUSTOMER_ID:i,CARRIER_NAME:f,PRICE:y}))},continueCheckoutButtonClicked:()=>e(U.analyticsEvent({type:Fe.CONTINUE_CHECKOUT_BUTTON_CLICKED,ORDER_ID:a})),chooseCarrierModalDisplayed:()=>e(U.analyticsEvent({type:Fe.CHOOSE_CARRIER_MODAL_DISPLAYED,ORDER_ID:a})),selectPickUpPointButtonClicked:()=>e(U.analyticsEvent({type:Fe.SELECT_PICK_UP_POINT_BUTTON_CLICKED,ORDER_ID:a})),carrierSelectionCardImpression:({items:g})=>{const f=g.map((y,I)=>{const{carrierName:S,priceSubtitle:C}=m(y);return{CARRIER_NAME:S,PRICE:C,POSITION:I.toString()}});return e(U.analyticsEvent({type:Fe.CARRIER_SELECTION_CARD_IMPRESSION,impressions:f}))},selectExternalCollectionPointClicked:g=>{e(U.analyticsEvent({type:Fe.SELECT_PICK_UP_POINT_BUTTON_CLICKED,ORDER_ID:a,POSTCODE:g?.address_details?.post_code,EXTERNAL_COLLECTION_POINT_ID:g.name}))},invalidShippingMethodModalDisplayed:()=>e(U.analyticsEvent({type:Fe.SHIPPING_METHOD_NOT_VALID_MODAL_DISPLAYED,ORDER_ID:a})),selectShippingMethodButtonClicked:()=>e(U.analyticsEvent({type:Fe.SELECT_SHIPPING_METHOD_BUTTON_CLICKED,ORDER_ID:a})),basketChangedModalDisplayed:({addressId:g})=>e(U.analyticsEvent({type:Fe.CHANGE_DELIVERY_METHOD_MODAL_DISPLAYED,ORDER_ID:a,ADDRESS_ID:g,DELIVERY_DESTINATION_ID:d})),basketChangedModalConfirmButtonClicked:()=>e(U.analyticsEvent({type:Fe.CONTINUE_AND_SEE_TROLLEY_BUTTON_CLICKED,ORDER_ID:a})),basketChangedModalCancelButtonClicked:()=>e(U.analyticsEvent({type:Fe.CHANGE_DELIVERY_METHOD_CANCEL_BUTTON_CLICKED,ORDER_ID:a})),courierSlotImpression:g=>{if(g){const f=pGe(g);e(U.analyticsEvent({type:Fe.SLOT_IMPRESSION,impressions:[f]})),e(vA.seenSlots({seenSlots:g.slotId?[g.slotId]:[]}))}},standardSlotsImpressionForGrid:g=>{const f=new Set,y=g.filter(({slotDayId:I})=>{const S=m$e(I,o);return t.has(S)?!1:(f.add(S),!0)});if(y.length>0){const I=y.map(wq);e(U.analyticsEvent({type:Fe.SLOT_IMPRESSION,impressions:I})),n(S=>new Set([...S,...f]))}},dataFeedForGrid:g=>{const f=[...l.map(y=>y.slotId),...g];e(vA.seenSlots({seenSlots:f}))},expressCollectionSlotImpression:g=>{e(U.analyticsEvent({type:Fe.SLOT_IMPRESSION,impressions:[g]}))},deliveryDetailsModalDisplayed:g=>e(U.analyticsEvent({type:Fe.DELIVERY_DETAILS_MODAL_DISPLAYED,...g})),deliveryOptionsViewed:g=>e(U.analyticsEvent({type:Fe.DELIVERY_OPTIONS_VIEWED,...g})),deliveryAssetChanged:g=>e(U.analyticsEvent({type:Fe.DELIVERY_ASSET_CHANGED,...g})),smallOrderChargeSlotImpression:g=>{e(U.analyticsEvent({type:Fe.SLOT_IMPRESSION,impressions:[{chargeInfo:g}]}))},defaultDeliveryDestinationIdAvailable:()=>{e(U.analyticsEvent({type:As.PAGE_ATTRIBUTES_MULTIPLE,attributes:{DEFAULT_DELIVERY_DESTINATION_ID_AVAILABLE:c}}))}}},LD="invalidSlot",h$e=T.span`
    vertical-align: middle;
`,g$e=T(se)`
    flex-grow: 1;
`,Nw=T(b)`
    flex: 1 1 0;
`,Xq=()=>{const{formatMessage:e}=M(),t=F(),n=We(),o=E(Ue(LD)),r=E(D("m.la.h")),{invalidShippingMethodModalDisplayed:a,selectShippingMethodButtonClicked:i}=bo(),l=()=>t(Z.closeModal()),c=()=>{i(),t(Z.closeModal());const d=sr({inCheckoutWalk:!0});n(d)};return h.useEffect(()=>{o&&a()},[o]),s.jsx(G,{isOpen:o,onRequestClose:l,asBottomSheet:!0,children:s.jsxs(G.ModalForm,{"data-test":"invalid-slot-modal",children:[s.jsx(G.Header,{align:"left",children:s.jsxs(ne,{as:"h1",children:[s.jsx(me,{"data-test":"invalid-slot-modal-info-icon",name:"info_default",width:24,height:24,verticalAlign:"middle",className:"salt-m-r--1"}),s.jsx(h$e,{children:e("slot-invalid-view.title")})]})}),s.jsx(G.Body,{children:e("slot-invalid-view.content")}),s.jsx(G.Footer,{align:r?"left":"center",className:"salt-gap-x--2",children:s.jsxs(g$e,{direction:"column",directionSmUp:"row-reverse",gap:["sm"],children:[s.jsx(Nw,{intent:"primary",onClick:c,fill:!0,"data-test":"invalid-slot-modal-confirm-button",children:s.jsx(b.Text,{children:e("slot-invalid-view.confirm-button")})}),s.jsx(Nw,{intent:"secondary",onClick:l,fill:!0,"data-test":"invalid-slot-modal-cancel-button",children:s.jsx(b.Text,{children:e("slot-invalid-view.cancel-button")})})]})})]})})},Zq="LEGACY_ADD_SERVER_SIDE_NOTIFICATIONS",Jq="LEGACY_CLEAR_SERVER_SIDE_NOTIFICATIONS",E$e=e=>({type:Zq,payload:{serverSideNotifications:e}}),f$e=e=>({type:Jq,payload:{serverSideNotifications:e}}),zn={types:{LEGACY_ADD_SERVER_SIDE_NOTIFICATIONS:Zq,LEGACY_CLEAR_SERVER_SIDE_NOTIFICATIONS:Jq},LEGACY_addServerSideNotifications:E$e,LEGACY_clearServerSideNotifications:f$e},$s={ADVERTISING_CONTENT_SOURCE_OVERRIDE:"Advertising-Content-Source-Override",AGE_CONFIRMATION_COOKIE:"ageConfirmed",NOTIFIED_BOOKSLOT:"notified_bookslot",NOTIFIED_EXPIRY:"notified_expiry",NOTIFIED_LOGIN:"notified_login",OPTANON_CONSENT:"OptanonConsent",PRIVACY_ACCEPTED:"privacyAccepted",SELECTED_PLAN_ID:"selectedPlanId",SSO_LOGIN_COMPLETE:"sso.loginComplete",SSO_REGISTRATION_COMPLETE:"sso.registrationComplete"},aC=D("1trust");D("ot.cstm");const eK=ee("UPDATE_COOKIE_CONSENT"),y$e=e=>()=>rre("/cookie-consent").then(t=>t.json()).then(t=>e({type:eK.SUCCESS,payload:t})),tK={actionTypes:{UPDATE_COOKIE_CONSENT:eK},updateCookieConsent:y$e},I$e={},S$e=(e=I$e,t)=>{switch(t.type){case tK.actionTypes.UPDATE_COOKIE_CONSENT.SUCCESS:return t.payload;default:return e}},C$e=e=>e.cookieConsent,kD=e=>V(C$e,aC,(t={},n)=>n?t[e]||!1:!0),MD=kD("language"),T$e=kD($s.NOTIFIED_BOOKSLOT),_$e=kD($s.NOTIFIED_LOGIN),pn=({basePath:e="",queryString:t=""}={})=>{const n=t?`?${t}`:"";return`${e===""?"/":e}${n}`},Fr=({basePath:e="",queryString:t=""}={})=>{const n=t?`?${t}`:"";return`${e}/login${n}`},dr=({basePath:e=""}={})=>`${e}/settings`,rd=()=>`${dr()}/login-details`,ad=({basePath:e="",queryString:t=""}={})=>{const n=t.length?`?${t}`:"";return`${dr({basePath:e})}/user-details${n}`},dn={SAVING:"SAVING",LOYALTY:"LOYALTY",DELIVERY:"DELIVERY"},v$e={PROMOTION_BY_PAYMENT_METHOD_APPLIED:"PROMOTION_BY_PAYMENT_METHOD_APPLIED",LOYALTY_POINTS_TO_BE_REFUNDED:"LOYALTY_POINTS_TO_BE_REFUNDED",LOYALTY_POINTS_REMOVED:"LOYALTY_POINTS_REMOVED"},ju={PROMOTIONS_AVAILABLE:"PROMOTIONS_AVAILABLE",SELECTED_PROMOTION_CHANGED:"SELECTED_PROMOTION_CHANGED",SELECTED_PROMOTION_REPLACED_BY_VOUCHER:"SELECTED_PROMOTION_REPLACED_BY_VOUCHER",...v$e},A$e={CHECKOUT_WALK:"checkout-walk"},By={BASKET:"basket",ORDERS:"orders"},Hc={RETURN:"RETURN",CANCEL:"CANCEL",SAVE:"SAVE"},uu={GENERAL_DISCOUNT_LIMITED:"general_discount_limited",GENERAL_DISCOUNT_ANY:"general_discount_any",DELIVERY_DISCOUNT_LIMITED:"delivery_discount_limited",DELIVERY_DISCOUNT_ANY:"delivery_discount_any",LOYALTY_DISCOUNT_LIMITED:"loyalty_discount_limited",LOYALTY_DISCOUNT_ANY:"loyalty_discount_any"},wl="none-exclusive",b$e="pre-applied",O_=(e,t)=>n=>n(U.analyticsEvent({type:t,description:"User sees the alert message",pageEventAttributes:{orderId:e}})),kd=e=>(t,n)=>e.forEach(o=>{const{data:{basket:{orderId:r}}}=n();switch(o.type){case ju.LOYALTY_POINTS_REMOVED:t(O_(r,_e.LOYALTY_POINTS_REMOVED_ALERT_DISPLAYED)),z.warning("payment.promotion.loyalty.removal.notification");break;case ju.LOYALTY_POINTS_TO_BE_REFUNDED:t(O_(r,_e.LOYALTY_POINTS_REFUNDED_ALERT_DISPLAYED)),z.warning("payment.promotion.loyalty.refund.notification");break;case ju.PROMOTION_BY_PAYMENT_METHOD_APPLIED:t(O_(r,_e.PAYMENT_PROMOTION_APPLIED_TOAST_DISPLAYED)),z.success("payment.promotion.success.notification");break}}),x$e=(e,t="basket.add.item.error")=>{switch(e){case"basket-ws-70":return"max.quantity.in.trolley.error";default:return t}},R$e=(e,t="basket.add.item.error")=>{switch(e){case"EXCEEDED_MAX_QUANTITY":case"LIMITED_AVAILABILITY":return"fop.max.quantity.toast.generic";case"OUT_OF_STOCK":return"fop.oos.toast";default:return t}},iC=({productId:e,quantity:t,maxQuantityReached:n})=>({productId:e,quantity:{quantityInBasket:t,maxQuantityReached:n}});function sK(e){return!!e?.promotionId}function jD(e){return!!e?.promotionId}const D$e=(e={})=>async(t,n)=>{const{withUpdatedItemsResponse:o,updatedItems:r,fetchAllocatedPaymentChecks:a,location:i,productGroupingType:l}=e,c=n(),d=i||c?.router?.location,u=await t(uie(d)),m=e?.cartType||u;try{const f=(await t(en.getCart({fetchAllocatedPaymentChecks:a,withUpdatedItemsResponse:o,updatedItems:r,cartType:m,productGroupingType:l,location:d})))?.payload?.responseData;return f?ti(f):null}catch{return z.error("toast.notification.generic.error"),null}},O$e=({fetchAllocatedPaymentChecks:e,appliedPaymentCheckId:t}={fetchAllocatedPaymentChecks:!1,appliedPaymentCheckId:void 0})=>async n=>{try{const r=(await n(en.getCheckoutCart({fetchAllocatedPaymentChecks:e,appliedPaymentCheckId:t})))?.payload?.responseData;return r?ti(r):null}catch{return z.error("toast.notification.generic.error"),null}},P$e=({paymentMethodGroup:e,fetchAllocatedPaymentChecks:t=!1,appliedPaymentCheckId:n=void 0})=>async(o,r)=>{const{data:{basket:{orderId:a},payments:{paymentMethodGroupsMetadata:{data:i}},orderPayment:{orderPaymentCheckoutSummaryWithPaymentMethodGroups:{data:l}}}}=r(),c=l?.paymentMethodGroups?.find(m=>m.paymentMethodGroupId===e.paymentMethodGroupId)?.name;if(c==="PAYMENTS_INSTALMENTS"&&!e.financingProviderId)return;const d=i?.find(m=>m.paymentMethodGroupId===e.paymentMethodGroupId),u=c==="PAYMENTS_INSTALMENTS"?d?.financingProviders?.find(m=>m.financingProviderId===e?.financingProviderId)?.name:void 0;try{const g=(await o(en.updateCheckoutCart({paymentMethodGroup:e,fetchAllocatedPaymentChecks:t,appliedPaymentCheckId:n})))?.payload?.responseData?.pricingNotifications;g&&o(kd(g)),await o(U.analyticsEvent({type:_e.PAYMENT_TYPE_SELECTED,description:"Payment method was selected",pageEventAttributes:{orderId:a,paymentType:c,cardType:u,promotionAvailable:d?.promotion}}));return}catch{z.error("toast.notification.generic.error")}},Ht={getBasket:D$e,getCheckoutBasket:O$e,updateCheckoutCart:P$e},ct={PAY_NOW:"PAY_NOW",CASH_ON_DELIVERY:"CASH_ON_DELIVERY",B2B_DEFERRED_PAYMENT:"B2B_DEFERRED_PAYMENT",INSTALMENTS:"PAYMENTS_INSTALMENTS",L_PAY:"L_PAY",KAKAOPAY:"KAKAOPAY",NAVERPAY:"NAVERPAY",LOYALTY:"LOYALTY",UNKNOWN:"UNKNOWN"},at={UNKNOWN:"UNKNOWN",CARDS:"CARDS",PAYPAL:"PAYPAL",APPLE_PAY:"APPLE_PAY",GOOGLE_PAY:"GOOGLE_PAY",VISA_MOBILE:"VISA_MOBILE",INVOICE:"INVOICE",BLIK:"BLIK",BANK_TRANSFER:"BANK_TRANSFER",CARD_INSTALMENTS:"CARD_INSTALMENTS",CASH_ON_DELIVERY:"CASH_ON_DELIVERY",L_PAY:"L_PAY",KAKAOPAY:"KAKAOPAY",NAVERPAY:"NAVERPAY"},N$e={AT_CHECKOUT:"AT_CHECKOUT"},gr={AMEX:"AMEX",AMERICAN_EXPRESS:"AMERICAN EXPRESS",CB:"CB",DISCOVER:"DISCOVER",MAESTRO:"MAESTRO",MASTERCARD:"MASTERCARD",MASTERCARD_DEBIT:"MASTERCARD_DEBIT",VISA:"VISA",VISA_DEBIT:"VISA_DEBIT",VISA_ELECTRON:"VISA_ELECTRON",VISA_PURCHASING:"VISA_PURCHASING",PAYMENT_CARD:"PAYMENT_CARD",VISA_PHONE:"VISA_PHONE"},wD={PayPal:"PayPal",Datacash:"Datacash",Bambora:"Bambora",MammockPsp:"MammockPsp",CasinoHub:"CasinoHub",Mastercard:"Mastercard",Conexflow:"Conexflow",Braintree:"Braintree"},FD={Braintree:"Braintree",MammockPsp:"MammockPsp",Payex:"Payex",IcaInvoice:"IcaInvoice",Primer:"Primer",Autopay:"Autopay",Toss:"Toss"},nK={FakePsp:"FakePsp",Unknown:"Unknown"},L$e={DATACASH:"DATACASH"},k$e={...wD,...FD},ds={...wD,...FD,...nK},Lw=(e,t)=>{const[n]=Object.entries(e).find(([,o])=>o===t)||[];return n};class Om{rawId;constructor(t){this.rawId=t}get id(){return Om.isAPsp(this.rawId)?this.rawId:nK.Unknown}get name(){return Lw(kw,this.id)}get activeName(){return Lw(Mw,this.id)}isKnown(){return this.id in k$e}isSavedWallet(){return this.id in wD}isAddCardExternalRedirect(){return this.id===ds.Mastercard&&!D("pay.mcdhf")}static fromName(t){return new Om(kw[t]||t)}static fromActiveName(t){return new Om(Mw[t]||t)}static isAPsp(t){return t in ds}}const kw={PAYPAL:ds.PayPal,DATACASH:ds.Datacash,BRAINTREE_PSPWEB:ds.Braintree,BAMBORA:ds.Bambora,MAMMOCK_PSP:ds.MammockPsp,BRAINTREE:ds.Conexflow,COURGETTE:ds.CasinoHub,PAYEX:ds.Payex,ICE_INVOICE:ds.IcaInvoice,MASTERCARD:ds.Mastercard,UNKNOWN:ds.Unknown,FAKE_PSP:ds.FakePsp,PRIMER:ds.Primer,AUTOPAY:ds.Autopay,TOSS:ds.Toss},Mw={PAYPAL:ds.PayPal,DATACASH:ds.Datacash,BRAINTREE_PSPWEB:ds.Braintree,BRAINTREE:ds.Conexflow,BAMBORA:ds.Bambora,MAMMOCK_FAKE_PSP:ds.MammockPsp,COURGETTE:ds.CasinoHub,PAYEX:ds.Payex,ICEINVOICE:ds.IcaInvoice,MASTERCARD:ds.Mastercard,UNKNOWN:ds.Unknown,FAKE_PSP:ds.FakePsp,PRIMER:ds.Primer,AUTOPAY:ds.Autopay,TOSS:ds.Toss},{denormalize:M$e}=Ji,{decoratedOrderSchema:j$e}=Zi,Ds=V(e=>nl(e,e.data.orders.current.order.order),e=>e.data.orders.current.order,(e,t)=>({...t,order:e}));V(Ds,({order:e})=>e?.slotType===Pa&&e?.deliveryMethod===Et.clickAndCollect.method);const w$e=V(Ds,({order:e})=>e?.slotType===Pa&&e?.deliveryMethod===Et.vanDelivery.method),F$e=V(Ds,({order:e})=>!!e?.dates?.confirmOrderChangesBy),lC=(e,t)=>At(e)===t,vg=V(Ds,({order:e})=>e&&{deliveryStartDate:e.dates.deliveryStartDate,deliveryEndDate:e.dates.deliveryEndDate,addressNickName:e.addressNickName,addressNotes:e.addressNotes,address:e.address,additionalInformation:e.additionalInformation,timeZoneId:e.dates.timeZoneId,deliveryType:e.deliveryType,deliveryMethod:e.deliveryMethod,slotType:e.slotType,shippingGroupType:e.shippingGroupType,carrierId:e.carrierId,externalAddress:e.externalAddress}),_Xt=V(vg,e=>e?.deliveryStartDate),B$e=V(Ds,e=>e.order&&{confirmOrderChangesBy:e.order.dates.confirmOrderChangesBy,orderId:e.order.orderId,timeZoneId:e.order.dates.timeZoneId}),ac=V(Ds,({order:e})=>e&&{orderId:e.orderId,totalItems:e?.totalItems,charges:e?.charges,buybacks:e?.buybacks,orderLevelPromotions:e?.orderLevelPromotions,orderTotals:e?.orderTotals,savings:e?.orderTotals.promoSavings,itemsRetailPrice:e?.orderTotals.retailPrice,depositsPrice:e?.orderTotals.depositsPrice,environmentalHandlingPrice:e?.orderTotals.environmentalHandlingPrice,finalPrice:e?.orderTotals.finalPrice,totalPrice:e?.orderTotals.totalPrice,vouchersSavingsPrice:e?.orderTotals?.vouchersSavingsPrice,taxComponents:e?.orderTotals.taxesTotals.taxes.components,appliedVouchers:e?.appliedVouchers||[],paymentInfo:e?.paymentInfo,itemPriceAfterPromos:e?.orderTotals.itemPriceAfterPromos,loyalty:e?.loyalty,smallOrderChargeThresholds:e?.smallOrderChargeThresholds,paymentMethodSavingsPrice:e?.orderTotals?.paymentMethodPromoSavings,...e?.charges,...e?.buybacks}),U$e=V(Zt,e=>({...e,vouchersSavingsPrice:e.totals?.vouchersSavingsPrice,appliedVouchers:e.vouchers||[],depositsPrice:e?.totals?.depositsPrice,environmentalHandlingPrice:e?.totals?.environmentalHandlingPrice,taxesTotals:e?.totals?.taxesTotals,savings:e?.totals?.savingsPrice,paymentMethodSavingsPrice:e?.totals?.paymentMethodSavingsPrice})),BD=V(ac,e=>e?.totalItems||0),Ha=V(Ds,Ts,(e,t)=>{const n=M$e(e.order,j$e,{product:t});return{...e,order:n}}),id=V(Ds,({order:e})=>e?.loyalty?.earned||null),UD=V(Ds,({order:e})=>e?.loyalty?.spent),GD=V(Ds,({order:e})=>!!e?.rebookable),G$e=V(Ha,({order:e})=>e?.itemsOnCheckout),$D=V(Ha,({order:e})=>e?.items),$$e=V(Ha,({order:e})=>e?.missingItems),H$e=V(Ha,({order:e})=>e?.returnedItems),HD=V(Ha,({order:e})=>e?.groupedProducts),cC=V(Ha,({order:e})=>e?.sellers);V(Ha,({order:e})=>e?.primarySellerId);const V$e=V(Ha,({order:e})=>e?.primarySellerName),Y$e=V(Ha,({order:e})=>e?.substitutedItems?.reduce((t,n)=>(t.push([n,...n.substitutes]),t),[]));V(Ha,({order:e})=>e?.substitutedItems);const Ag=V(Ds,({order:e})=>e?.external),W$e=V(Ds,({order:e})=>e?.paymentInfo?.chargeTime===N$e.AT_CHECKOUT),q$e=e=>V(Ha,({order:t})=>t?.items?.find(n=>n?.product?.productId===e)?.product?.price?.unit),VD=()=>"/register",K$e=({basePath:e=""}={})=>`${e}/logout`,pu="ORDER_DISCOUNT_SUMMARY",z$e={isFetching:!1,fetchError:!1,didInvalidate:!1,lastUpdated:null,error:null,data:null,didInvalidateConfirmationData:!1,isCancelled:!1},Q$e=(e=z$e,t)=>{switch(t.type){case yo.types.SELECT_SLOT.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null,didInvalidateConfirmationData:!1};case yo.types.SELECT_SLOT.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case yo.types.GET_SLOT_BOOKING_LIMITED_PRODUCTS.ERROR:return{...e,isFetching:!1,fetchError:!0};case yo.types.SET_SELECTED_SLOT:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),didInvalidate:!1,isCancelled:!1,error:null,data:{...t.payload,deliveryPrice:t.deliveryPrice,deliveryType:t.deliveryType,minimumOrder:t.minimumOrder,ecoSlot:t.ecoSlot}};case yo.types.CLEAR_SELECTED_SLOT:return{...e,didInvalidate:!0};case yo.types.CANCEL_SELECTED_SLOT:return{...e,isCancelled:!0};case yo.types.INVALIDATE_SLOTS_CONFIRMATION_DATA:return{...e,didInvalidateConfirmationData:!0};default:return e}},oK=({control:e})=>!e.delivery.slot.didInvalidate&&!e.delivery.slot.isFetching&&!!e.delivery.slot.lastUpdated,X$e=e=>e.control.delivery.slot.data?.deliveryType,Z$e=e=>e.control.delivery.slot.data?.deliveryPrice,J$e=e=>e.control.delivery.slot.data?.ecoSlot||!1,dC=e=>e.control.delivery.slot.data?.slot?.minimumCheckoutThreshold,vXt=e=>e.control.delivery.slot.data?.slot?.originalMinimumCheckoutThreshold,YD=({control:e})=>e.delivery.slot.data?.slot?.startTime,WD=({control:e})=>e.delivery.slot.data?.slot?.type,e0e=({control:e})=>e.delivery.slot.data?.slot?.deliveryMethod,rK=({control:e})=>e.delivery.slot.data?.slot?.deliveryTimeInMinutes,aK=({control:e})=>e.delivery.slot.data?.slot?.collectionTimeInMinutes,qD=({control:e})=>e.delivery.slot.data?.slot?.endTime,bg=({control:e})=>e.delivery.slot.data?.slot?.timeZoneId,iK=({control:e})=>e.delivery.slot.data?.slot?.expiryTime,t0e=({control:e})=>e.delivery.slot.data?.slot?.slotId,AXt=({control:e})=>e.delivery.slot.data?.slot,dl=({control:e})=>e.delivery.slot.data?.confirmationData,s0e=V(dl,e=>e?.slotRegionId),n0e=V(dl,e=>e?.invalidVouchers||[]),o0e=V(dl,e=>e?.regionChanged??!1),r0e=V(dl,e=>e?.totalChanged??!1),a0e=V(dl,e=>e?.itemPriceAfterPromos),KD=({control:e})=>e.delivery.slot.data?.slot?.latestUpdateTime,i0e=V(dl,e=>e?.limitedProducts||[]),zD=V(dl,e=>e?.draftBasketId),l0e=V(dl,e=>e?.otherCheckoutGroupsChanged??!1),QD=({control:e})=>e.delivery.slot.data?.slot?.address,XD=({control:e})=>!!e.delivery.slot.data?.slot?.minimumCheckoutThresholdChanged,ZD=e=>e.control.delivery.slot.fetchError,lK=e=>e.control.delivery.slot.error,uC=e=>e.control.delivery.slot.isFetching,c0e=e=>e.control.delivery.slot.didInvalidateConfirmationData,bXt=e=>e.control.delivery.slot.isCancelled,pC=V(dl,e=>!!e),cK=V(pC,oK,ZD,(e,t,n)=>!e&&t&&!n),dK=60,d0e=24*dK,u0e=[{unit:"day",value:d0e},{unit:"hour",value:dK},{unit:"minute",value:1}],mC=(e,t="long",n=!1)=>{const o=", ",r=(a,i)=>e.formatNumber(a,{style:"unit",unit:i,unitDisplay:t});return a=>{if(!a)return"";const i=[];let l=0;return u0e.forEach(({unit:c,value:d})=>{if(n&&c!=="minute")return;const u=Math.floor((a-l)/d);u>0&&(i.push(r(u,c)),l+=u*d)}),i.join(o)}},Md=(e="long",t=!1)=>{const n=M();return mC(n,e,t)},p0e=(e,t,n)=>{const o=ah(t)?t:"UTC";let r,a;return ah(e)?(r=n?ih(o):e,a=!1):(r=o,a=!0),{displayTimeZoneId:r,showTimeZoneAbbreviation:a}},hC=(e,t,n)=>{const o=ah(t)?t:"UTC";let r,a;return ah(e)?(r=n?ih(o):e,a=sA(e)!==sA(ih(o))):(r=o,a=!0),{displayTimeZoneId:r,showTimeZoneAbbreviation:a}},uK=D("mtz"),pK=({dateIsoFrom:e,dateIsoTo:t,timeZoneId:n,dateFormat:o,timeFormat:r,local:a})=>{const i=E(uK),l=E(Ed),c=E(Yt);if(!e||!t)return null;if(!i)return X$(e,t,o,r);if(c)return null;const{displayTimeZoneId:d,showTimeZoneAbbreviation:u}=hC(n,l,a);return Q$(e,t,d,o,r,u)},m0e=e=>{const t=pK(e);return t?s.jsx(h.Fragment,{children:t}):null},h0e=e=>({defaultTimeZoneId:Ed(e),multiTimeZoneEnabled:uK(e),isServerRendered:Yt(e)}),go=Ct(ke(h0e))(m0e),xA=({basketSlot:e})=>{const t=E(Jt),n=E(Vt),{start:o,end:r,timeZoneId:a}=e;return s.jsx(go,{dateIsoFrom:o,dateIsoTo:r,timeZoneId:a,dateFormat:t,timeFormat:n})},g0e=()=>`${dr()}/customerDetails`,Uy=()=>`${dr()}/language`,vh=()=>`${dr()}/wallet`,Na=()=>`${dr()}/addresses`,JD=()=>`${dr()}/delivery`,Uo=({queryString:e=""}={})=>`${dr()}/delivery-pass${e}`,zu=()=>`${dr()}/loyalty`,Gy=()=>`${dr()}/accessibility`,$y=()=>`${dr()}/marketing`,Hy=()=>`${dr()}/delivery-preferences`,Vy=()=>`${dr()}/help-centre`,E0e=Object.freeze(Object.defineProperty({__proto__:null,settingsAccessibilityPath:Gy,settingsAddressesPath:Na,settingsCustomerDetailsPath:g0e,settingsDeliveryPassPath:Uo,settingsDeliveryPath:JD,settingsDeliveryPreferencesPath:Hy,settingsHelpCentrePath:Vy,settingsLanguagePath:Uy,settingsLoginDetailsPath:rd,settingsLoyaltyPath:zu,settingsMarketingPath:$y,settingsPath:dr,settingsUserDetailsPath:ad,settingsWalletPath:vh},Symbol.toStringTag,{value:"Module"})),eO="changeDestinationConfirmationModal",ld="visitorDeliveryDestinationSelectorModal",Lp="deliveryDestinationCustomerCollection",Ah="homeDeliveryAddressChangeModal",kp="yourDeliveryMethod",Fl="chooseDeliveryMethod",gC="deliveryDestinationsMapLookup",tO="chooseDeliveryAddress",mK=ee("GET_HOME_DELIVERY_DESTINATIONS"),hK=ee("GET_CUSTOMER_COLLECTION_DELIVERY_DESTINATIONS"),gK=ee("GET_SELECTED_DELIVERY_DESTINATION_DETAILS"),f0e=ee("GET_DELIVERY_DESTINATION_BY_ID"),EK=ee("GET_SUPPORTED_PROPOSITIONS"),fK=ee("REMOVE_SLOT_IN_CURRENT_SESSION"),yK="INVALIDATE_CUSTOMER_COLLECTION_DELIVERY_DESTINATIONS",IK="INVALIDATE_HOME_DELIVERY_DESTINATIONS",SK=(e,t)=>({type:"API",payload:{url:`/ecomdeliverydestinations/v4/delivery-addresses?deliveryMethod=${t}`,options:{method:"GET"},service:"ecomdeliverydestinations",...e}}),y0e=()=>SK(mK,"HOME_DELIVERY"),I0e=()=>SK(hK,"CUSTOMER_COLLECTION"),S0e=e=>({type:"API",payload:{url:`/ecomdeliverydestinations/v4/delivery-addresses/${e}`,options:{method:"GET"},service:"ecomdeliverydestinations",...gK}}),CK=e=>({type:"API",payload:{url:`/ecomdeliverydestinations/v4/delivery-addresses/${e}`,options:{method:"GET"},service:"ecomdeliverydestinations",...f0e}}),TK=ee("UPDATE_SELECTED_DELIVERY_DESTINATION"),C0e=({deliveryDestinationId:e,customerId:t,visitorId:n,regionId:o})=>({type:"API",payload:{url:"/v2/sessions/active",service:"customersessions",pathPrefix:{client:"/api/customersessions",server:"/core-api"},options:{method:"PUT",headers:{"visitor-id":n,"customer-id":t||""},body:{deliveryDestinationId:e,regionId:o}},...TK}}),T0e=e=>({type:"API",payload:{url:`/customersessions/v1/sessions/customers/${e}/slot`,options:{method:"DELETE"},service:"customersessions",...fK}}),_0e=()=>({type:"API",payload:{url:"/ecomdeliverydestinations/v1/supported-propositions",options:{method:"GET"},service:"ecomdeliverydestinations",...EK}}),v0e=(e,t)=>Z.openModal(eO,{previous:e,deliveryDestination:t}),_K=()=>({type:IK}),A0e=()=>({type:yK}),sn={getHomeDeliveryDestinations:y0e,getCustomerCollectionDeliveryDestinations:I0e,getSelectedDeliveryDestinationData:S0e,getDeliveryDestinationByIdAction:CK,updateDeliveryDestinationInSession:C0e,removeSlotInCurrentSession:T0e,openChangeDeliveryDestinationConfirmationModal:v0e,invalidateHomeDeliveryDestinations:_K,invalidateCustomerCollectionDeliveryDestinations:A0e,getSupportedPropositions:_0e,types:{GET_HOME_DELIVERY_DESTINATIONS:mK,GET_CUSTOMER_COLLECTION_DELIVERY_DESTINATIONS:hK,GET_SELECTED_DELIVERY_DESTINATION_DETAILS:gK,UPDATE_SELECTED_DELIVERY_DESTINATION:TK,REMOVE_SLOT_IN_CURRENT_SESSION:fK,INVALIDATE_CUSTOMER_COLLECTION_DELIVERY_DESTINATIONS:yK,INVALIDATE_HOME_DELIVERY_DESTINATIONS:IK,GET_SUPPORTED_PROPOSITIONS:EK}},b0e=e=>{e(U.analyticsEvent({type:Te.REDIRECT_TO_SLOT_BOOKING,description:"User clicked link to be redirected to slot booking after changing delivery destination",pageEventAttributes:{componentLocation:"Body",componentType:"Toast",linkType:"Link",userInteraction:"LINK_CLICKED"}}))},x0e=(e,t)=>()=>e.customerId?t:t(zn.LEGACY_addServerSideNotifications([ro.LEGACY_showSlotBookingNotificationForNotLoggedInUser.key])),R0e=()=>z.success("delivery.destination.method.update.success",{id:"delivery-destinations-updated-toast"}),D0e=()=>z.error("delivery.destination.method.update.failed",{id:"delivery-destinations-update-failed-toast"}),O0e=(e,t)=>()=>t(ea.setSelectedAddress({addressId:e.addressId,deliveryDestinationId:e.deliveryDestinationId})),P0e=e=>sn.updateDeliveryDestinationInSession(e),N0e=(e,t)=>async()=>{if(!e){await t(Ht.getBasket());return}await t({type:"SKIP_REFRESH_BASKET"})},L0e=e=>()=>e(Z.closeModal()),vK=({shouldRefreshPage:e,currentPathname:t,targetPath:n,targetPathFull:o,skipActionType:r,dispatch:a,navigate:i})=>e&&t!==o&&t!==Na()?i(n):a({type:r}),k0e=({shouldRefreshPage:e,currentPathname:t,basePath:n,dispatch:o,navigate:r})=>vK({shouldRefreshPage:e,currentPathname:t,targetPath:pn(),targetPathFull:pn({basePath:n}),skipActionType:"SKIP_REDIRECT_TO_HOMEPAGE",dispatch:o,navigate:r}),M0e=({shouldRefreshPage:e,currentPathname:t,basePath:n,dispatch:o,navigate:r})=>vK({shouldRefreshPage:e,currentPathname:t,targetPath:jt(),targetPathFull:jt({basePath:n}),skipActionType:"SKIP_REDIRECT_TO_TROLLEY_PAGE",dispatch:o,navigate:r}),j0e=({shouldRefreshPage:e,currentPathname:t,basePath:n,dispatch:o,navigate:r,redirectToTrolley:a})=>()=>(a?M0e:k0e)({shouldRefreshPage:e,currentPathname:t,basePath:n,dispatch:o,navigate:r}),w0e=(e,t)=>()=>(e&&window.location.reload(),t),AK=(e,t,n,o,r,a,i=!1)=>r(P0e(e)).then(N0e(t,r)).then(O0e(e,r)).then(L0e(r)).then(R0e).then(x0e(e,r)).then(j0e({shouldRefreshPage:t,currentPathname:n,basePath:o,dispatch:r,navigate:a,redirectToTrolley:i})).then(w0e(t,r)).catch(D0e),F0e=[],B0e=(e=F0e,t)=>{switch(t.type){case zn.types.LEGACY_ADD_SERVER_SIDE_NOTIFICATIONS:return[...e,...t.payload.serverSideNotifications];case zn.types.LEGACY_CLEAR_SERVER_SIDE_NOTIFICATIONS:return t.payload.serverSideNotifications;default:return e}},bK=({control:e})=>e.notifications,U0e=({product:e,meta:t,featuredProductCampaigns:n})=>{const{brand:o,variant:r,price:a,quantity:i,isFavorite:l,isOnPromotion:c,position:d,productId:u}=Ys(e),m=Bn(e,n),g=e.ratingSummary?.overallRating,f={item_id:e.retailerProductId||null,item_name:e.name,index:d||null,item_brand:o,hfss_display_restriction_group:e.hfssDisplayRestrictionGroup??null,item_list_name:null,item_variant:r,price:a,rating:g?Number(g):null,quantity:Number(i),is_on_promotion:c,is_favorite:l,is_featured:!!m,featured_campaign_id:m?.campaignId||null,featured_campaign_name:m?.campaignName||null,...ol(e?.categoryPath??[]),seller_id:e.seller?.id||null};return tc({productId:u,item:f,meta:t})},G0e=e=>{const t=e.map(n=>Ys(n));return{event:"event",ecommType:"enhanced",eventCategory:"Checkout Funnel",eventAction:"BeginCheckout",eventLabel:"Not Set",ecommerce:{checkout:{actionField:{step:1},products:t}}}},$0e=e=>{const{meta:t,cartOrderId:n,basketProducts:o,basketTotal:r,groupId:a,featuredProductCampaigns:i}=e,l=o.map(c=>U0e({product:c,meta:t,featuredProductCampaigns:i}));return{event:"begin_checkout",ecommerce:{currency:r?.currency||null,value:r?.amount?Number(r.amount):null,osp_transaction_id:n,group_id:a,items:l}}},sO=e=>{const t=Jn(e);return G0e(t)},nO=(e,t)=>{const n=At(e)||null,o=Jn(e),r=pa(e),a=Fo(e),i=qs(e);return $0e({meta:t,cartOrderId:n,basketProducts:o,basketTotal:r,groupId:a,featuredProductCampaigns:i})},ul=()=>{const e=lp();return t=>{const n=e.getState(),o=sO(n);J.sendEvent({GA:o,WA:null});const r=nO(n,t);J.sendEvent({GA:r,WA:null})}},ro={LEGACY_isPromotionsAvailableNotification:{key:"LEGACY_isPromotionsAvailableNotification",notifier:({dispatch:e,location:t,state:n})=>{z.info("toggleablepromotions.notification.promotions.available",{link:s.jsx(Vr,{to:jt(),label:"toggleablepromotions.notification.promotions.link",onClick:()=>{e(_f(t,pu)),Lc(n,{page:t.pathname,pagePartType:pu}).sendPageViewEvent(),e(wu({type:Io.ORDER_DISCOUNT_FORM_MODAL_DISPLAYED,description:"A modal for order promotions is displayed",source:"orderPromotionsAlert"})),e(Z.openModal("discountOnOrder"))}}),id:"toggleablePromotionsToast-toggleablepromotions.notification.promotions.available"})},id:"toggleablePromotionsToast-toggleablepromotions.notification.promotions.available"},LEGACY_isSelectedPromotionsChangedNotification:{key:"LEGACY_isSelectedPromotionsChangedNotification",notifier:({dispatch:e,location:t,state:n})=>{z.info("toggleablepromotions.notification.promotions.selected.promotion.changed",{link:s.jsx(Vr,{to:jt(),label:"toggleablepromotions.notification.promotions.link",onClick:()=>{e(_f(t,pu)),Lc(n,{page:t.pathname,pagePartType:pu}).sendPageViewEvent(),e(wu({type:Io.ORDER_DISCOUNT_FORM_MODAL_DISPLAYED,description:"A modal for order promotions is displayed",source:"orderPromotionsAlert"})),e(Z.openModal("discountOnOrder"))}}),id:"toggleablePromotionsToast-toggleablepromotions.notification.promotions.selected.promotion.changed"})},id:"toggleablePromotionsToast-toggleablepromotions.notification.promotions.selected.promotion.changed"},LEGACY_isSelectedPromotionsReplacedByVoucherNotification:{key:"LEGACY_isSelectedPromotionsReplacedByVoucherNotification",notifier:({dispatch:e,location:t,state:n})=>{z.info("toggleablepromotions.notification.promotions.selected.promotion.replaced.by.voucher",{link:s.jsx(Vr,{to:jt(),label:"toggleablepromotions.notification.promotions.link",onClick:()=>{e(_f(t,pu)),Lc(n,{page:t.pathname,pagePartType:pu}).sendPageViewEvent(),e(wu({type:Io.ORDER_DISCOUNT_FORM_MODAL_DISPLAYED,description:"A modal for order promotions is displayed",source:"orderPromotionsAlert"})),e(Z.openModal("discountOnOrder"))}}),id:"toggleablePromotionsToast-toggleablepromotions.notification.promotions.selected.promotion.replaced.by.voucher"})},id:"toggleablePromotionsToast-toggleablepromotions.notification.promotions.selected.promotion.replaced.by.voucher"},LEGACY_showBasketMergeSucceedPriceChanged:{key:"LEGACY_showBasketMergeSucceedPriceChanged",notifier:()=>{z.info("basket.merge.notification.review.trolley",{link:s.jsx(Vr,{to:jt(),label:"basket.merge.prices.promos.changed.notification"})})}},LEGACY_showBasketMergeSucceed:{key:"LEGACY_showBasketMergeSucceed",notifier:()=>{z.info("basket.merge.notification.review.trolley",{link:s.jsx(Vr,{to:jt(),label:"basket.merge.success.notification"})})}},LEGACY_showBasketMergeFailed:{key:"LEGACY_showBasketMergeFailed",notifier:()=>{z.error("basket.merge.failure.notification",{link:s.jsx(Vr,{to:jt(),label:"basket.merge.notification.review.trolley"})})}},LEGACY_showBasketMergeFailedViaToken:{key:"LEGACY_showBasketMergeFailedViaToken",notifier:()=>{z.error("basket.merge.via.cart.token.failure.notification",{link:s.jsx(Vr,{to:jt(),label:"basket.merge.notification.review.trolley"})})}},LEGACY_handleLoggedOutNotification:{key:"LEGACY_handleLoggedOutNotification",notifier:()=>{z.info("basket.add.availability.reminder",{link:s.jsx(Vr,{to:Fr(),label:"basket.add.availability.reminder.login.or.register"}),id:"logged-out-add-toast"})},id:"logged-out-add-toast"},LEGACY_showSlotBookingNotificationForNotLoggedInUser:{key:"LEGACY_showSlotBookingNotificationForNotLoggedInUser",notifier:({dispatch:e})=>{z.info("delivery.destination.visitor.slot.reminder",{link:s.jsx(Vr,{to:sr({inCheckoutWalk:!1}),label:"delivery.destination.visitor.slot.reminder.book.link",onClick:()=>e(b0e)}),id:"delivery-destinations-bookSlotToast"})},id:"delivery-destinations-bookSlotToast"},LEGACY_expiredNotification:{key:"LEGACY_expiredNotification",notifier:({dispatch:e,state:t})=>{z.info("basket.slot.expired.notification.text",{link:s.jsx(Vr,{to:sr({inCheckoutWalk:!1}),label:"basket.slot.expired.notification.link",onClick:()=>{e(U.analyticsEvent({type:_e.BEGIN_CHECKOUT}));const n=sO(t);J.sendEvent({GA:n,WA:null});const o=nO(t);J.sendEvent({GA:o,WA:null})}}),id:"ExpiryNotification0"})},id:"ExpiryNotification0"},LEGACY_minimumOrderChangedNotification:{key:"LEGACY_minimumOrderChangedNotification",notifier:({intl:e,state:t})=>{const n=dC(t),o=pi(t),{formatNumber:r}=e;if(!n)return;const a=$a(r,n,o);z.info({key:"minimum.order.changed.notification.text",substitutions:{amount:a}},{id:"min.spend.toast"})},id:"min.spend.toast"},LEGACY_showExpressCollectionBookedToast:{key:"LEGACY_showExpressCollectionBookedToast",notifier:({intl:e,state:t})=>{const n=Cn(t);if(!n)return;const o=e.formatMessage("slotbooking.confirm.alert.express.collection",{timeSpan:mC(e)(n.deliveryTimeInMinutes),addressName:n.nickname});z.success({formattedMessage:o},{id:"slotbooking.confirm.alert"})},id:"slotbooking.confirm.alert"},LEGACY_showFastDeliverBookedToast:{key:"LEGACY_showFastDeliverBookedToast",notifier:({intl:e,state:t})=>{Cn(t)&&z.success({formattedMessage:e.formatMessage("slotbooking.fast.delivery.booked.alert")},{id:"slotbooking.confirm.alert"})},id:"slotbooking.confirm.alert"},LEGACY_showSlotBookedToast:{key:"LEGACY_showSlotBookedToast",notifier:({intl:e,state:t})=>{const n=Cn(t);if(!n)return;const o=e.formatMessage("slotbooking.confirm.alert",{dateAndTime:s.jsx(xA,{basketSlot:n}),addressName:n.nickname});z.success({formattedMessage:o},{id:"slotbooking.confirm.alert"})},id:"slotbooking.confirm.alert"},LEGACY_showMultidayOrStandardCustomerCollectioBookedToast:{key:"LEGACY_showMultidayOrStandardCustomerCollectioBookedToast",notifier:({intl:e,state:t})=>{const n=Cn(t);if(!n)return;const o=e.formatMessage("slotbooking.confirm.alert.for.collection",{dateAndTime:s.jsx(xA,{basketSlot:n}),addressName:n.nickname});z.success({formattedMessage:o},{id:"slotbooking.confirm.alert"})},id:"slotbooking.confirm.alert"}},xK=()=>{const e=E(bK),t=F(),n=Ne(),o=M(),r=E(a=>a);return h.useEffect(()=>{e.forEach(a=>{ro[a].notifier({dispatch:t,location:n,intl:o,state:r})}),e.length&&t(zn.LEGACY_clearServerSideNotifications([]))},[e]),null},RK=ee("GET_CONCIERGE_DELIVERY"),DK="SET_CONCIERGE_DELIVERY",OK=ee("SAVE_CONCIERGE_DELIVERY"),H0e=(e,t=!1)=>({type:"API",payload:{service:"ecomslots",pathPrefix:{client:"/api/ecomslots",server:"/core-api"},url:`/v1/slots/${e}/concierge`,...RK},isFakeAvailabilityEnabled:t}),V0e=(e,t=!1)=>({type:DK,conciergeDelivery:e??!1,isFakeAvailabilityEnabled:t}),Y0e=({slotId:e,isLeftAtConcierge:t,orderId:n})=>({type:"API",payload:{service:"ecomslots",pathPrefix:{client:"/api/ecomslots",server:"/core-api"},url:`/v1/slots/${e}/concierge`,options:{method:"POST",body:{isLeftAtConcierge:t,orderId:n}},...OK}}),Lr={getConciergeDelivery:H0e,setConciergeDelivery:V0e,saveConciergeDelivery:Y0e,types:{GET_CONCIERGE_DELIVERY:RK,SET_CONCIERGE_DELIVERY:DK,SAVE_CONCIERGE_DELIVERY:OK}},W0e={initialValue:!1,currentValue:!1,lastUpdated:null,wasFakeSlotBookingPageShown:!1},q0e=(e=W0e,t)=>{switch(t.type){case Lr.types.GET_CONCIERGE_DELIVERY.SUCCESS:{if(t?.isFakeAvailabilityEnabled)return{...e,lastUpdated:le(),wasFakeSlotBookingPageShown:t.payload?.responseData?.isLeftAtConcierge??!1};const n=t.payload?.responseData?.isLeftAtConcierge??!1;return{...e,lastUpdated:le(),initialValue:n,currentValue:n}}case Lr.types.SET_CONCIERGE_DELIVERY:return t?.isFakeAvailabilityEnabled?{...e,wasFakeSlotBookingPageShown:t?.conciergeDelivery}:{...e,currentValue:t?.conciergeDelivery??!1};default:return e}},xg=({control:e})=>e.delivery?.conciergeDelivery?.currentValue??!1,K0e=({control:e})=>e.delivery?.conciergeDelivery,PK=({control:e})=>e.delivery?.conciergeDelivery?.lastUpdated??null,NK=({control:e})=>e.delivery?.conciergeDelivery?.wasFakeSlotBookingPageShown??!1,LK=ee("CHECKOUT"),kK=ee("GET_OVERRIDE_PAYMENT_METHOD_GROUPS"),MK=ee("GET_PAYMENT_CHECKOUT_SUMMARY"),jK=ee("GET_ORDER_MULTI_PAYMENTS"),wK=ee("GET_PAYMENT_CHECKOUT_SUMMARY_WITH_PAYMENT_METHOD_GROUPS"),EC=e=>({type:"API",payload:{service:"orderpayment",pathPrefix:{client:"/api/orderpayment",server:"/core-api"},...e}}),z0e=({leftAtConcierge:e,sellerIds:t=[],productIds:n,orderTotalAmount:o})=>EC({url:"/v1/payment-method-groups",options:{method:"POST",body:{leftAtConcierge:e,sellerIds:t,productIds:n,orderTotalAmount:o}},...kK}),Q0e=()=>EC({url:"/v1/payment-checkout-summary",options:{method:"GET"},...MK}),X0e=({sellerIds:e,productIds:t})=>EC({url:"/v2/payment-checkout-summary",options:{method:"POST",body:{sellerIds:e,productIds:t}},...wK}),Z0e=e=>EC({url:`/v1/order-payments/${e}`,options:{method:"GET"},...jK}),J0e=({billingAddressId:e,paymentMethod:t,paymentCheckIds:n,recurringOrder:o,psp:r})=>({type:"API",payload:{url:"/v1/orderpayment/checkout",options:{headers:{...r?{"X-Override-Psp":r}:{}},method:"POST",body:{billingAddressId:e,paymentMethod:t,paymentCheckIds:n,recurringOrder:o}},...LK}}),Dr={getOverridePaymentMethodGroups:z0e,getPaymentCheckoutSummary:Q0e,getOrderMultiPayments:Z0e,orderPaymentCheckout:J0e,getPaymentCheckoutSummaryWithPaymentMethodGroups:X0e,types:{CHECKOUT:LK,GET_OVERRIDE_PAYMENT_METHOD_GROUPS:kK,GET_PAYMENT_CHECKOUT_SUMMARY:MK,GET_ORDER_MULTI_PAYMENTS:jK,GET_PAYMENT_CHECKOUT_SUMMARY_WITH_PAYMENT_METHOD_GROUPS:wK}},e1e=Dn(["pay.slct","oed"]),t1e=D("pcs.v2"),s1e=e=>(t,n)=>{if(!e)return Promise.resolve(null);const o=n(),r=xg(o),a=(ex(o)||[]).map(u=>u.sellerId),i=(Id(o)||[]).map(u=>u.productId),c=Uie(o)?.amount||"",d=qe(o,"seller-sales-enabled")==="true";return!c||d&&!a?.length||!i?.length?Promise.resolve(null):t(Dr.getOverridePaymentMethodGroups({leftAtConcierge:r,sellerIds:a,orderTotalAmount:c,productIds:i})).catch(u=>{throw z.error("request.error.title"),u})},n1e=()=>(e,t)=>{const n=t(),o=ex(n).map(i=>i.sellerId),r=(Id(n)||[]).map(i=>i.productId);return qe(n,"seller-sales-enabled")==="true"&&!o?.length||!r?.length?Promise.resolve(null):e(Dr.getPaymentCheckoutSummaryWithPaymentMethodGroups({sellerIds:o.length>0?o:void 0,productIds:r})).catch(i=>{throw z.error("request.error.title"),i})},o1e=()=>async(e,t)=>{e1e(t())&&(t1e(t())?await e(Mo.getOrderPaymentCheckoutSummaryWithPaymentMethodGroups()):await e(Dr.getPaymentCheckoutSummary()))},r1e=e=>(t,n)=>{const o=n(),r=Cn(o),a=D("pay.slct")(o),i=D("pay.pmf")(o);return!(a&&i)||!r?Promise.resolve(null):t(e())},Mo={getOverridePaymentMethodGroups:s1e,getOrderPaymentCheckoutSummaryWithPaymentMethodGroups:n1e,getPaymentCheckoutSummaryService:o1e,withOverridePaymentMethodGroups:r1e},FK=ee("GET_AVAILABLE_PROMOTION_SELECTIONS"),BK=ee("GET_PROMOTION_DESCRIPTIONS"),UK=ee("SUBMIT_PROMOTION_SELECTIONS"),GK="SET_TOGGLEABLE_PROMOTIONS",a1e=e=>({type:"API",payload:{service:"promotionspresentation",pathPrefix:{client:"/api/promotionspresentation",server:"/core-api"},...e}}),i1e=e=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},...e}}),l1e=()=>a1e({url:"/v1/available-promotion-selections",...FK}),c1e=e=>({type:"API",payload:{url:"/v2/descriptions",service:"promotions",options:{body:e,method:"PUT"},pathPrefix:{client:"/api/promotions",server:"/core-api"},...BK}}),d1e=(e,t)=>i1e({url:"/v1/carts/active/promotion-selections/order-promotions",options:{body:{orderId:t,promotionSelections:e},method:"PUT"},...UK}),u1e=e=>({type:GK,payload:{toggleablePromotions:e}}),va={getAvailablePromotionSelections:l1e,getPromotionDescriptions:c1e,setToggleablePromotions:u1e,submitOrderPromotionSelections:d1e,actionTypes:{GET_AVAILABLE_PROMOTION_SELECTIONS:FK,GET_PROMOTION_DESCRIPTIONS:BK,SUBMIT_PROMOTION_SELECTIONS:UK,SET_TOGGLEABLE_PROMOTIONS:GK}},jw=(e,t,n)=>(e.applicationGroups.forEach(o=>{o.applicationSubgroups.forEach((r,a)=>{p1e(o,r,a),m1e(t,r),n&&g1e(r)})}),h1e(t,e.preAppliedPromotions),e),p1e=(e,t,n)=>{t.applicationGroupName=`${e.promotionType}_${n+1}`},m1e=(e,t)=>{t.promotions.forEach(n=>{n.description=e[n.promotionId]})},h1e=(e,t)=>{t.forEach(n=>{n.description=e[n.promotionId]})},g1e=e=>{e.limitPerOrder===1&&e.promotions.length&&e.promotions.push({promotionId:wl,selected:!e.promotions.some(t=>t.selected),changeable:!0,description:"None of the above",validityTime:{}})},E1e=e=>e.applicationGroups.reduce((t,n)=>(n.applicationSubgroups.forEach(o=>{if(o.limitPerOrder===1){const r=o.promotions.find(a=>a.selected);r&&(t[o.applicationGroupName]=r.promotionId)}if(!o.limitPerOrder){const r=o.promotions.reduce((a,i)=>(i.selected&&a.push(i.promotionId),a),[]);r.length&&(t[o.applicationGroupName]=r)}}),t),{}),f1e=e=>e.applicationGroups.reduce((t,n)=>(t[n.promotionType]=n.applicationSubgroups,t),{}),y1e=e=>e?.reduce((t,n)=>{const o=n.promotionType;return t[o]||(t[o]=[]),t[o].push(n),t},{})??{},I1e=e=>{const t=[];return{availablePromotions:e.map(o=>{const[r,a]=o.promotions.reduce(([i,l],c)=>(!c.selected&&!c.changeable?l.push(c):c.changeable&&i.push(c),[i,l]),[[],[]]);return t.push(...a),{...o,promotions:r}}),unavailablePromotions:t}},S1e=(e,t)=>e.reduce((n,o)=>{const{promotions:r}=o,a=r.filter(i=>!i.changeable&&i.selected);return a.length&&n.push(...a.map(i=>({promotionType:t,promotionId:i.promotionId,description:i.description}))),n},[]),C1e=e=>{const{applicationGroups:t,preAppliedPromotions:n}=e,o=y1e(n);return[dn.SAVING,dn.LOYALTY,dn.DELIVERY].reduce((a,i)=>{const c=t.find(y=>y.promotionType===i)?.applicationSubgroups??[],d=o[i]||[],{availablePromotions:u,unavailablePromotions:m}=I1e(c),g=S1e(c,i),f=[...d,...g];return a[i]={availablePromotions:u??[],unavailablePromotions:m??[],preAppliedPromotions:f??[]},a},{})??{}},T1e=e=>e.applicationGroups.reduce((t,n)=>(n.applicationSubgroups.forEach(o=>o.promotions.forEach(r=>{r.promotionId!==wl&&t.push(r.promotionId)})),t),[]),_1e=e=>e.preAppliedPromotions.map(t=>t.promotionId),oO=(e,t)=>e.applicationGroups.reduce((n,o)=>(o.applicationSubgroups.forEach(r=>{n.push(...t(r.promotions))}),n),[]),v1e=e=>oO(e,n=>n.filter(({changeable:o,promotionId:r})=>o&&r!==wl).map(({promotionId:o,selected:r})=>({promotionId:o,selected:r}))),A1e=e=>oO(e,n=>n.filter(({changeable:o,selected:r})=>!o&&r).map(({promotionId:o})=>o)),b1e=e=>oO(e,n=>n.filter(({selected:o})=>o).map(({promotionId:o})=>o)),x1e=e=>e.applicationGroups.reduce((t,n)=>(n.applicationSubgroups.forEach(o=>{o.limitPerOrder===1&&o.promotions.some(({changeable:r})=>!r)&&t.push(o.promotions.filter(({promotionId:r})=>r!==wl))}),t),[]),$K=(e,t)=>t.reduce((n,o)=>{const r=o.filter(({changeable:i})=>i),a=o.filter(({changeable:i})=>!i);return!r.length&&a.length?n.push(...a.map(({promotionId:i})=>({promotionId:i,selected:!1}))):a.length&&r.every(({promotionId:i})=>!e.find(l=>l.promotionId===i)?.selected)&&n.push(...a.map(({promotionId:i})=>({promotionId:i,selected:!1}))),n},[]),R1e=e=>e.applicationGroups.reduce((t,n)=>(t[n.promotionType]=n.applicationSubgroups.flatMap(o=>o.promotions.filter(r=>r.selected&&r.promotionId!==wl).map(r=>r.description)),t),{}),D1e=e=>e.preAppliedPromotions.reduce((t,n)=>(t[n.promotionType]=(t[n.promotionType]||[]).concat(n.description),t),{}),O1e=(e,t)=>{const n={};return[...new Set([...Object.keys(e),...Object.keys(t)])].forEach(r=>{n[r]=(e[r]||[]).concat(t[r]||[])}),n},P1e=e=>Object.values(e).flat().length>0,N1e=e=>Object.values(e).flat().length>0,HK=e=>{let t=!1;return e.applicationGroups.forEach(n=>n.applicationSubgroups.forEach(o=>{o.promotions.length&&(t=!0)})),t},VK=e=>e.preAppliedPromotions.length>0,Mp=(e,t,n)=>{if(!t.activeFrom&&!t.activeTo)return{};const o=e.formatMessage("toggleablepromotions.modal.expires.today"),r=e.formatMessage("toggleablepromotions.modal.expires.tomorrow"),a=O=>e.formatMessage("toggleablepromotions.modal.expires",{date:O}),i=O=>e.formatMessage("toggleablepromotions.modal.place.order.date",{date:O}),l=O=>e.formatMessage("toggleablepromotions.modal.place.order.daterange",{dateRange:O}),c=O=>e.formatMessage("toggleablepromotions.modal.place.order.from",{date:O}),d=O=>e.formatMessage("toggleablepromotions.modal.select.slot.date",{date:O}),u=O=>e.formatMessage("toggleablepromotions.modal.select.slot.daterange",{dateRange:O}),m=O=>e.formatMessage("toggleablepromotions.modal.select.slot.from.date",{date:O}),g=O=>e.formatMessage("toggleablepromotions.modal.select.slot.until.date",{date:O}),f=!!t.activeFrom,y=f&&XI(t.activeFrom),I=f&&sd(t.activeFrom),S=f&&lh(t.activeFrom),C=f&&!y&&!I,_=!!t.activeTo,A=_&&sd(t.activeTo),x=_&&lh(t.activeTo),R=_&&!A;if(!f||y||I){if(A)return{tag:o,...t.validityType==="SELECT_SLOT"&&{label:g(Ks(n,t.activeTo))}};if(x)return{tag:r,...t.validityType==="SELECT_SLOT"&&{label:g(Ks(n,t.activeTo))}};if(!_)return{};if(R)return{label:t.validityType==="SELECT_SLOT"?g(Ks(n,t.activeTo)):a(Ks(n,t.activeTo))}}if(S&&x)return{label:t.validityType==="SELECT_SLOT"?d(Ks(n,t.activeFrom)):i(Ks(n,t.activeFrom)),tag:r};if(C){if(!_)return{label:t.validityType==="SELECT_SLOT"?m(Ks(n,t.activeFrom)):c(Ks(n,t.activeFrom))};if(Yb(t.activeFrom,t.activeTo))return{label:t.validityType==="SELECT_SLOT"?d(Ks(n,t.activeFrom)):i(Ks(n,t.activeFrom))};if(R)return{label:t.validityType==="SELECT_SLOT"?u(`${Ks(n,t.activeFrom)} - ${Ks(n,t.activeTo)}`):l(`${Ks(n,t.activeFrom)} - ${Ks(n,t.activeTo)}`)}}return{}},YK=(e,t)=>e===dn.SAVING?t===1?uu.GENERAL_DISCOUNT_ANY:uu.GENERAL_DISCOUNT_LIMITED:e===dn.DELIVERY?t===1?uu.DELIVERY_DISCOUNT_ANY:uu.DELIVERY_DISCOUNT_LIMITED:t===1?uu.LOYALTY_DISCOUNT_ANY:uu.LOYALTY_DISCOUNT_LIMITED,L1e=e=>{const t=[];e.SAVING&&t.push(...e.SAVING),e.DELIVERY&&t.push(...e.DELIVERY),e.LOYALTY&&t.push(...e.LOYALTY);let n=0;return t.reduce((o,r,a)=>(r.promotions.forEach(i=>{o[i.promotionId]={orderDiscountFormSectionSequence:a,promotionIdSequence:n,orderDiscountFormSection:YK(r.applicationGroupName.split("_")[0],r.limitPerOrder)},n+=1}),o),{})},k1e=e=>{const t=[dn.SAVING,dn.DELIVERY,dn.LOYALTY],n=[];let o=0,r=0;const a=(i,l,c,d)=>{n.push({promotionId:i.promotionId,orderDiscountFormSectionSequence:r,promotionIdSequence:o++,orderDiscountFormSection:YK(l,d),promotionIdIsSelected:c,promotionIdText:i.description,validityTime:i.validityTime})};return t.forEach(i=>{const l=e[i];if(!l)return;const{availablePromotions:c,preAppliedPromotions:d,unavailablePromotions:u}=l;c.length>0&&(c.forEach(m=>{m.promotions.forEach(g=>{a(g,i,g.selected,m.limitPerOrder)})}),r++),d.length>0&&(d.forEach(m=>{a({promotionId:m.promotionId,description:m.description,validityTime:{validityType:"PLACE_ORDER",activeFrom:"",activeTo:""}},i,!0)}),r++),u.length>0&&(u.forEach(m=>{a(m,i,!1)}),r++)}),n},WK=vo(["pbpm","pcs.v2"]),cd=()=>e=>e(va.getAvailablePromotionSelections()).then(({payload:{responseData:t}})=>e(M1e(t))),M1e=e=>(t,n)=>{const o=T1e(e),r=_1e(e),a=D("tp.no")(n()),i=[...o,...r];return i.length===0?t(va.setToggleablePromotions(jw(e,{},a))):t(va.getPromotionDescriptions(i)).then(({payload:{responseData:l}})=>{const c=l.reduce((d,u)=>(d[u.promotionId]=u.displayName,d),{});t(va.setToggleablePromotions(jw(e,c,a)))}).catch(()=>{z.error("request.error.title")})},j1e=e=>(t,n)=>{const{data:{basket:{orderId:o}}}=n();return o?t(va.submitOrderPromotionSelections(e,o)).then(()=>t(Ht.getBasket()).then(()=>(WK(n())&&t(Mo.getOrderPaymentCheckoutSummaryWithPaymentMethodGroups()),t(cd())))).catch(()=>{z.error("request.error.title")}):null},w1e=e=>async(t,n)=>{const{data:{basket:{orderId:o}}}=n();try{if(!o)throw new Error("Toggleable promotions applying: no orderId provided");return await t(va.submitOrderPromotionSelections(e,o)),{isSuccessful:!0}}catch(r){const a=r instanceof Error?r:new Error(String(r));return Me.api.pushError(new Error("Couldn't apply toggleable promotions selection"),{context:{errorMessage:a.message}}),z.error("toggleablepromotions.apply.error"),{isSuccessful:!1}}},F1e=()=>async(e,t)=>{try{await e(Ht.getBasket()),WK(t())&&await e(Mo.getOrderPaymentCheckoutSummaryWithPaymentMethodGroups()),await e(cd()),z.success("toggleablepromotions.apply.success")}catch(n){const o=n instanceof Error?n:new Error(String(n));Me.api.pushError(new Error("Couldn't refetch toggleable promotions after applying"),{context:{errorMessage:o.message}})}},jd=(e=void 0,t=!1)=>(n,o)=>{const{router:{location:r},session:{isLoggedIn:a}}=o(),i=o(),l=D("tp")(i)||D("tp.new")(i);if(a&&l&&e){const c=e.some(m=>m.type===ju.PROMOTIONS_AVAILABLE),d=e.some(m=>m.type===ju.SELECTED_PROMOTION_CHANGED),u=e.some(m=>m.type===ju.SELECTED_PROMOTION_REPLACED_BY_VOUCHER);if(c||d||u)return n(cd()).then(()=>{if(![A$e.CHECKOUT_WALK].some(g=>r.pathname.includes(g))){const g=["toggleablePromotionsToast-toggleablepromotions.notification.promotions.available","toggleablePromotionsToast-toggleablepromotions.notification.promotions.selected.promotion.changed","toggleablePromotionsToast-toggleablepromotions.notification.promotions.selected.promotion.replaced.by.voucher"],f=z.getNotifications().find(y=>g.includes(y.id));f?.id&&z.close(f.id),n(c?zn.LEGACY_addServerSideNotifications([ro.LEGACY_isPromotionsAvailableNotification.key]):d?zn.LEGACY_addServerSideNotifications([ro.LEGACY_isSelectedPromotionsChangedNotification.key]):zn.LEGACY_addServerSideNotifications([ro.LEGACY_isSelectedPromotionsReplacedByVoucherNotification.key]))}});if(t)return n(cd())}return Promise.resolve()},wu=e=>(t,n)=>{const{data:{basket:{basketId:o},toggleablePromotions:{data:r}},router:{location:{pathname:a}}}=n(),i=new RegExp("orders/[0-9]+/details"),l=a.match(i);let c,d=!1;if(l&&([,c]=l[0].split("/")),c&&(d=lC(n(),c)),e.type===Io.ORDER_DISCOUNT_FORM_MODAL_DISPLAYED){const{type:u,description:m,source:g}=e;t(U.analyticsEvent({type:u,description:m,pageEventAttributes:{source:g,basketid:o,...d&&{orderid:c}}}))}else if(e.type===Io.ORDER_DISCOUNT_FORM_MODAL_CLOSED){const{type:u,description:m,userAction:g,hasSelectionChange:f,selectedPromotionId:y}=e;t(U.analyticsEvent({type:u,description:m,pageEventAttributes:{basketid:o,userAction:g,hasSelectionChange:f,selectedPromotionId:y?[...y,...A1e(r)]:b1e(r),...d&&{orderid:c}}}))}},B1e=()=>(e,t)=>{const{data:{basket:{orderId:n}}}=t();e(U.analyticsEvent({type:Io.ORDER_DISCOUNT_DROPDOWN_CLICKED,description:"The dropdown for order promotions is clicked",pageEventAttributes:{orderid:n}}))},U1e=e=>async t=>t(Ja.getBop(e)).then(n=>{if(n){const{responseData:o}=n.payload,{result:{product:r},entities:a}=x2(o);return t(Ja.setActiveBop(r)),t(Ft.updateProducts({product:[a.product[r]],upsert:!0})),a.product[r]}return null});function Qu({method:e,body:t,contentType:n,clientRouteId:o,csrfToken:r}){const a={...o&&{"client-route-id":o},...r&&{"X-CSRF-TOKEN":r},...n&&{"content-type":n}};return typeof window<"u"&&(a["ecom-request-source"]="web",a["ecom-request-source-version"]=oS(window.__INITIAL_STATE__)),{method:e,credentials:"same-origin",body:t,headers:a}}const qK=async e=>{const{basePath:t,clientRouteId:n,csrfToken:o,requestId:r,target:a}=e,i=Ii({basePath:t,target:a});return fetch(i,Qu({method:"GET",clientRouteId:n,csrfToken:o})).then(l=>{if(!l.ok)throw new Error("Cannot fetch metadata");return l.json()}).catch(l=>{Me.api.pushError(new Error(`Analytics metadata: Error fetching metadata (${l.message})`),{context:{requestId:r,url:i,errorData:JSON.stringify(l,Object.getOwnPropertyNames(l))}})})},G1e=async e=>qK({...e,target:"/cart/v1/meta/carts/active/products"}),$1e=async(e,t)=>qK({...t,target:`/cart/v1/meta/checkouts/${e}/products`}),Yo={fetchAnalyticsMetadataByActiveCart:G1e,fetchAnalyticsMetadataByCheckoutId:$1e},rO=e=>e?.price&&e.price?.current&&{currencyCode:e.price.current.currency},fC=({products:e,basket:t,page:n,addedByFunction:o,productListName:r,position:a,category:i})=>{const l=t?.totals?.display?.itemPriceAfterPromos?.amount,c=t?.basketId;return{event:"event",ecommType:"enhanced",eventCategory:"E-commerce",eventAction:"ADD_BASKET_ITEM",eventLabel:"Add to Cart",ecommerce:{add:{actionField:{list:r},products:e.map(d=>Ys(d,i,a))},...rO(e.at(0))},...l&&{basketTotalAmount:l},...c&&{basketId:c},...o&&{addedByFunction:o},page:n}},yC=({addedByFunction:e,basket:t,products:n,productListName:o,position:r,page:a,section:i,featuredProductCampaigns:l})=>{const c=t?.totals?.display?.itemPriceAfterPromos?.amount||null,d=iO(n),u=n[0]?.price?.current?.currency;return d.map(m=>{const g=zK(m);return{event:"add_to_cart",ecommerce:{currency:u||null,cart_value:c?Number(c):null,cart_update_value:null,value:g,osp_transaction_id:t?.orderId||null,items:aO({product:m,position:r,productListName:o,page:a,section:i,featuredProductCampaigns:l})},cart_function:e}})},IC=({products:e,basket:t,page:n,addedByFunction:o,productListName:r,position:a,category:i})=>{const l=t?.totals?.display?.itemPriceAfterPromos?.amount,c=t?.basketId;return{event:"event",ecommType:"enhanced",eventCategory:"E-commerce",eventAction:"REMOVE_BASKET_ITEM",eventLabel:"Remove from Cart",ecommerce:{remove:{actionField:{list:r},products:e.map(d=>Ys(d,i,a))},...rO(e[0])},...l&&{basketTotalAmount:l},...c&&{basketId:c},...o&&{addedByFunction:o},page:n}},SC=({addedByFunction:e,basket:t,products:n,productListName:o,position:r,page:a,section:i,featuredProductCampaigns:l})=>{const c=t?.totals?.display?.itemPriceAfterPromos?.amount||null,d=iO(n),u=n[0]?.price?.current?.currency;return d.map(m=>{const g=zK(m);return{event:"remove_from_cart",ecommerce:{currency:u||null,cart_value:c?Number(c):null,cart_update_value:null,value:g,osp_transaction_id:t?.orderId||null,items:aO({product:m,position:r,productListName:o,page:a,section:i,featuredProductCampaigns:l})},cart_function:e}})},H1e=({products:e,cartType:t,currencyCode:n,total:o,orderId:r,groupId:a,position:i,page:l,meta:c,featuredProductCampaigns:d})=>iO(e).map(m=>({event:"view_cart",type:t,ecommerce:{currency:n||null,cart_value:o?Number(o):null,osp_transaction_id:r??null,group_id:a||null,items:aO({product:m,position:i,productListName:Ws(l,"",t==="expanded"?"quick-view-trolley":""),page:l,meta:c,isEnhanced:!0,featuredProductCampaigns:d})}})),aO=e=>{const{position:t,product:n,productListName:o,page:r,section:a,isEnhanced:i,meta:l,featuredProductCampaigns:c}=e;return n.map(d=>{const u=Ta(d,"offers")?d.offers:[],m=Ta(d,"ratingSummary")?d?.ratingSummary?.overallRating:null,g=Ta(d,"retailerProductId")?d.retailerProductId:null,f=Ta(d,"brand")?d.brand:null,y=Ta(d,"size")?d.size:null,I=Ta(d,"favorite")?d.favorite:null,S=Ta(d,"categoryPath")?d.categoryPath:null,C=Ta(d,"seller")?d.seller:null,_=Ta(d,"hfssDisplayRestrictionGroup")?d.hfssDisplayRestrictionGroup:null,A=Bn(d,c),x=!!u?.length,R=W1e(u),O=d.price?.current?.amount,N=o||Ws(r,"",a||""),k=nd(N),{campaignId:j=null,campaignName:w=null}=A||{},L={item_id:g,item_name:d.name,index:t??null,item_brand:f||null,hfss_display_restriction_group:_||null,item_list_name:N,item_variant:y?.value.toString()||null,price:O?Number(O):null,rating:m?Number(m):null,quantity:KK(d)||null,is_on_promotion:x,is_favorite:!!I,is_featured:k&&!!A,featured_campaign_id:k?j:null,featured_campaign_name:k?w:null,promotion_ids:x&&R?R:null,seller_id:C?.id||null,can_add_to_cart:Y1e(d),...ol(S??[])};if(i){const B=l?.items?.find(({productId:ce})=>d.productId===ce);if(!B)return L;const{meta:{itemListName:W,favorite:$,featured:{campaignName:K,campaignId:Q}={}}}=B,X=W??L.item_list_name,re=nd(X),ue=Q??L.featured_campaign_id,te=K??L.featured_campaign_name;return{...L,is_favorite:$??L.is_favorite,item_list_name:X,is_featured:re&&!!(K||Q||L.is_featured),featured_campaign_id:re?ue:null,featured_campaign_name:re?te:null}}return L})};function Ta(e,t){return t in e}function V1e(e,t){return t in e}const KK=e=>typeof e.quantity=="object"?e.quantity?.quantityInBasket:V1e(e,"quantity")&&typeof e.quantity!="object"?e.quantity:Ta(e,"quantityInBasket")&&e.quantityInBasket?e.quantityInBasket:e.addedAmount?e.addedAmount:0,Y1e=e=>Ta(e,"available")&&!!(e.available&&!e.maxQuantityReached),W1e=e=>e?.filter(t=>t.retailerPromotionId)?.map(t=>t.retailerPromotionId).join(","),iO=(e,t=15)=>{function*n(o,r){for(let a=0;a<o.length;a+=r)yield o.slice(a,a+r)}return[...n(e,t)]},zK=e=>e.reduce((t,n)=>{const o=KK(n),r=n?.price?.current?.amount??0;return t+Number(r)*o},0),q1e=e=>({event:"event",ecommType:"enhanced",eventCategory:"E-commerce",eventAction:"MERGE_BASKET_CONFLICT",eventLabel:"Basket merge conflict",ecommerce:{merge:{products:e.map(t=>Ys(t))},...rO(e[0])}}),QK=ee("GET_CHECKOUT_WALK"),XK="TOGGLE_FREE_GIFT_SELECTED",ZK="CLEAR_CHECKOUT_WALK",K1e=()=>({type:"API",payload:{url:"/v2/checkout-walk",...QK}}),z1e=(e,t,n)=>({type:XK,payload:{productId:e,promotionId:t,selected:n}}),Q1e=()=>({type:ZK}),br={getCheckoutWalk:K1e,toggleFreeGiftSelected:z1e,clearCheckoutWalk:Q1e,types:{GET_CHECKOUT_WALK:QK,TOGGLE_FREE_GIFT_SELECTED:XK,CLEAR_CHECKOUT_WALK:ZK}},CC=D("pbpm"),JK=e=>{const t=x$e(e);z.error(t)},X1e=()=>z.error("basket.remove.item.error"),lO=e=>async t=>{const o=(await t(Is.addBasketItems(e)))?.payload?.responseData,r=o?.basketUpdateResult?.items?.map(iC)||[],a=await t(Ht.getBasket({withUpdatedItemsResponse:!0,updatedItems:r}));return a?(o?.basketUpdateResult?.items?.length&&await t(Ft.updateProducts({product:o?.basketUpdateResult.items.map(i=>({productId:i.productId,basketLines:i.basketLines}))})),{basket:Jh({basket:a,updatedItems:r}),limitedItems:o?.limitedItems||[],pricingNotifications:o?.pricingNotifications||[]}):null},Z1e=e=>async(t,n)=>{const r=(await t(Is.addBasketFreeGiftItem(e)).then(l=>{t(br.toggleFreeGiftSelected(e.productId,e.promotionId,!0));const c=n();if(CC(c)){const{payload:{responseData:{pricingNotifications:d}}}=l;t(kd(d))}return l}).catch(l=>{z.error("basket.add.item.error"),z.error("toast.notification.generic.error"),Me.api.pushError(new Error("Could not add free gift to the basket: "),{context:{error:JSON.stringify(l)}}),t(br.toggleFreeGiftSelected(e.productId,e.promotionId,!1))}))?.payload?.responseData,a=r?.basketUpdateResult?.items?.map(iC)||[],i=await t(Ht.getBasket({withUpdatedItemsResponse:!0,updatedItems:a}));return i?(r?.basketUpdateResult?.items?.length&&await t(Ft.updateProducts({product:r?.basketUpdateResult.items.map(l=>({productId:l.productId,basketLines:l.basketLines}))})),{basket:Jh({basket:i,updatedItems:a}),limitedItems:r?.limitedItems||[],pricingNotifications:r?.pricingNotifications||[]}):null},ez=e=>async t=>{const o=(jD(e[0])?await t(Is.removeBasketFreeGiftItem(e[0])):await t(Is.removeBasketItems(e)))?.payload?.responseData,r=o?.basketUpdateResult?.items?.map(iC)||[],a=await t(Ht.getBasket({withUpdatedItemsResponse:!0,updatedItems:r}));return a?(o?.basketUpdateResult?.items?.length&&await t(Ft.updateProducts({product:o?.basketUpdateResult?.items.map(i=>({productId:i.productId,basketLines:i.basketLines}))})),{basket:Jh({basket:a,updatedItems:r}),limitedItems:o?.limitedItems||[],pricingNotifications:o?.pricingNotifications||[]}):null},J1e=e=>async(t,n)=>{const r=(await t(Is.removeBasketFreeGiftItem(e)).then(l=>{t(br.toggleFreeGiftSelected(e.productId,e.promotionId,!1));const c=n();if(CC(c)){const{payload:{responseData:{pricingNotifications:d}}}=l;t(kd(d))}return l}).catch(()=>{Me.api.pushError(new Error("Could not remove free gift from the basket")),t(br.toggleFreeGiftSelected(e.productId,e.promotionId,!0))}))?.payload?.responseData,a=r?.basketUpdateResult?.items?.map(iC)||[],i=await t(Ht.getBasket({withUpdatedItemsResponse:!0,updatedItems:a}));return i?(r?.basketUpdateResult?.items?.length&&await t(Ft.updateProducts({product:r?.basketUpdateResult?.items.map(l=>({productId:l.productId,basketLines:l.basketLines}))})),{basket:Jh({basket:i,updatedItems:a}),limitedItems:r?.limitedItems||[],pricingNotifications:r?.pricingNotifications||[]}):null},eHe=()=>(e,t)=>{const n=t(),o=new zi,r="logged-out-add-toast",a=z.getNotifications().filter(i=>i.id===r).length!==0;!Ze(n)&&!zl(n).length&&!a&&!o.get($s.NOTIFIED_LOGIN)&&(_$e(n)&&o.set($s.NOTIFIED_LOGIN,!0,{secure:!0,path:pn({basePath:Wt(n)})}),_0(n)?e(Z.openModal("loginPrompt")):e(zn.LEGACY_addServerSideNotifications([ro.LEGACY_handleLoggedOutNotification.key])))},tHe=async(e,t)=>{e(U.analyticsEvent({type:Te.REDIRECT_TO_SLOT_BOOKING,description:"User clicked link to be redirected to slot booking",pageEventAttributes:{componentLocation:"Body",componentType:"Toast",linkType:"Link",userInteraction:"LINK_CLICKED"}}));const n=t(),o=Ho(n),r=await Yo.fetchAnalyticsMetadataByActiveCart(o);e(U.analyticsEvent({type:_e.BEGIN_CHECKOUT,meta:r}));const a=sO(n);J.sendEvent({GA:a,WA:null});const i=nO(n,r);J.sendEvent({GA:i,WA:null})},Xu="logged-in-no-slot-toast";let ww=!1;const sHe=e=>{z.close(Xu),e(tHe)},nHe=()=>(e,t)=>{const n=t(),o=new zi,r=z.getNotifications().filter(a=>a.id===Xu).length!==0;!Ze(n)||dS(n)||r||o.get($s.NOTIFIED_BOOKSLOT)||ww||(ww=!0,T$e(n)&&o.set($s.NOTIFIED_BOOKSLOT,!0,{secure:!0,path:pn({basePath:Wt(n)})}),z.info("order.slot.bookSlot.reminder",{link:s.jsx(Vr,{to:sr({inCheckoutWalk:!1}),label:"order.slot.bookSlot.reminder.book.link",onClick:()=>e(sHe)}),id:Xu}))},Fw=({basket:e,payload:t,addedByFunction:n,quantity:o=1,type:r})=>a=>a(U.analyticsEvent({type:r,basket:e,page:t.page,position:t.position,section:t.section,productListName:t.productListName,product:[{...t.product,quantity:o}],addedByFunction:n})),oHe=({basketItems:e,limitedItems:t,productId:n})=>o=>{const r=t?.find(a=>a.productId===n);if(r)z.error(R$e(r.reason));else{const a=e?.find(i=>i.productId===n);a&&o(Ft.updateProducts({product:[{productId:n,maxQuantityReached:!!a.quantity.maxQuantityReached}]}))}},tz=({items:e,response:t,itemsAnalyticsPayload:n,addedByFunction:o})=>(r,a)=>{const i=a(),l=qs(i),{basket:c,limitedItems:d,pricingNotifications:u}=t;c&&(RR.handleBasketRegion(i,c),e.forEach(m=>{const{productId:g,quantity:f}=m;if(r(oHe({basketItems:c.items,limitedItems:d,productId:g})),n){const y=n.find(I=>I.product.productId===g);if(y){const I={...y.product,quantity:f||1};r(Fw({basket:c,payload:y,addedByFunction:o||y.addedByFunction,quantity:f,type:Te.ADD_BASKET_ITEM}));const S=fC({products:[I],basket:c,page:y.page,addedByFunction:o||y.addedByFunction,productListName:y.productListName,position:y.position});J.sendEvent({GA:S,WA:null}),r(Fw({basket:c,payload:y,addedByFunction:o||y.addedByFunction,quantity:f,type:Te.ADD_TO_CART_GA4})),yC({basket:c,products:[I],addedByFunction:o||y.addedByFunction||null,page:y.page,productListName:y.productListName||null,position:y.position,featuredProductCampaigns:l}).forEach(_=>{J.sendEvent({GA:_,WA:null})})}}CC(i)&&r(kd(u)),r(jd(u,[By.BASKET,By.ORDERS].some(y=>i.router.location.pathname.includes(y))))}))};let cO=[];const rHe=e=>{cO.push(e)},aHe=()=>{cO=[]},iHe=async(e,t)=>{const n=cO.slice(),o=K0(n);aHe();const r=Object.keys(o).map(a=>{const i={productId:a,...sK(n[0])&&{promotionId:n[0]?.promotionId},quantity:o[a]};return DH({item:i,getState:t,itemsAnalyticsPayload:n})});try{const a=jD(r[0])?await e(Z1e(r[0])):await e(lO(r));return a?(e(tz({items:r,response:a,itemsAnalyticsPayload:n})),a):null}catch(a){const i=a?.code;JK(i)}return null},lHe=Jr(iHe,250),cHe=()=>e=>(t,n)=>{const{productId:o,quantity:r}=e.product;t(eHe()),t(nHe()),t(Is.setBatchAdd(o,r||1)),rHe(e),lHe(t,n)},dHe=(e,t)=>async(n,o)=>{try{const r=e.map(i=>DH({item:i,getState:o,itemsAnalyticsPayload:t||[]})),a=await n(lO(r));return a?(n(tz({items:r,response:a,itemsAnalyticsPayload:t,addedByFunction:"OFFER_ADD_ALL"})),a):null}catch(r){const a=r?.code;JK(a)}return null},uHe=({basketItems:e,productId:t,retailerProductId:n})=>(o,r)=>{if(e){const d=e.find(m=>m.productId===t),u=d&&d.quantity?!!d.quantity.maxQuantityReached:!1;o(Ft.updateProducts({product:[{productId:t,maxQuantityReached:u}]}))}const a=r(),i=lx(a,t)<=1,l=She(a,t);i&&l&&o(U1e(n))},pHe=({basket:e,product:t,page:n,position:o,section:r,addedByFunction:a,quantity:i=1,featuredProductCampaigns:l})=>c=>{const d=IC({products:[t],basket:e,page:n,addedByFunction:a,position:o});return J.sendEvent({GA:d,WA:null}),SC({products:[t],basket:e,page:n,addedByFunction:a,position:o,featuredProductCampaigns:l,productListName:null}).forEach(m=>{J.sendEvent({GA:m,WA:null})}),c(U.analyticsEvent({type:Te.REMOVE_BASKET_ITEM,basket:e,page:n,position:o,section:r,product:[{...t,quantity:i}],addedByFunction:a}))},sz=({addedByFunction:e,items:t,decoratedItems:n})=>async(o,r)=>{const a=r(),i=qs(a);try{const l=jD(t[0])?await o(J1e(t[0])):await o(ez(t));if(!l)return null;const{basket:c,pricingNotifications:d}=l;return RR.handleBasketRegion(a,c),t.forEach(u=>{const{productId:m}=u,g=n.find(y=>y.product.productId===m);if(!g)return;const{retailerProductId:f}=g.product;o(uHe({basketItems:c?.items||[],productId:m,retailerProductId:f})),o(pHe({basket:c,product:g.product,page:g.page,position:g.position,section:g.section,quantity:u.quantity,addedByFunction:e||g.addedByFunction,featuredProductCampaigns:i}))}),CC(a)&&o(kd(d)),o(jd(d,[By.BASKET,By.ORDERS].some(u=>a.router.location.pathname.includes(u)))),l}catch{X1e()}return null};let dO=[];const mHe=e=>{dO.push(e)},hHe=()=>{dO=[]},gHe=({dispatch:e,addedByFunction:t})=>{const n=dO.slice(),o=K0(n);hHe();const r=Object.keys(o).map(a=>({productId:a,quantity:o[a],...sK(n[0])&&{promotionId:n[0]?.promotionId}}));return e(sz({addedByFunction:t,items:r,decoratedItems:n}))},EHe=Jr(gHe,250),fHe=e=>t=>n=>{const{productId:o,quantity:r}=t.product;n(Is.setBatchRemove(o,r||1)),mHe(t),EHe({dispatch:n,addedByFunction:e})},yHe=e=>t=>{const{items:n,decoratedItems:o}=e;return t(sz({addedByFunction:"SMART_SHOP_REMOVE",items:n,decoratedItems:o}))},IHe=()=>async(e,t)=>{const n=t();await e(Is.emptyCart());const o=zl(n);o.length&&await e(Ft.updateProducts({product:o.map(i=>({productId:i.productId,basketLines:[]}))}));const r=await e(Ht.getBasket({withUpdatedItemsResponse:!0})),a=t();return e(U.analyticsEvent({type:Te.EMPTY_CART,prevState:n,nextState:a})),r},ca={createBatchAddToBasket:cHe,addMultipleItemsToBasketAtOnce:dHe,createBatchRemoveFromBasket:fHe,instantShopRemoveFromBasket:yHe,addBasketItems:lO,removeBasketItems:ez,emptyBasket:IHe},SHe=[tr(),kr(),Zb()];function CHe(e){return!SHe.includes(e)}const THe=[jt(),tr(),Xh()],_He=({path:e="/",actionType:t,checkoutRestrictions:n})=>{const o=t===en.types.GET_CART.SUCCESS,r=n?.includes(W2.INVALID_SLOT)??!1;return o?THe.some(i=>Or({path:i,end:!1},e))&&r:r};function vHe(e,t){const n=Yt(t);return CHe(e)&&!n}const Bw="slot-price-changed-toast",AHe=({state:e,basket:t})=>n=>{const o=e.data.basket?.lastUpdated,r=e.data.basket?.slot?.slotId,a=t?.slot?.slotId;o&&r!==a&&n(ft.setLastFetchedCatalogueLocation(void 0))},bHe=({dispatch:e,getState:t})=>n=>o=>{const r=t(),a=n(o),i=o.type===mn,l=o?.payload?.location||r.router.location,c=l?.pathname;if((i||Pie(o,r))&&vHe(c,r)&&e(Ht.getBasket({location:l})),[en.types.GET_CART.SUCCESS,en.types.GET_CHECKOUT_CART.SUCCESS].includes(o.type)){const d=D0(o);(d||o.payload?.basket)&&RR.handleBasketRegion(r,d||o.payload?.basket);const u=z.getNotifications().find(g=>g.id===Bw);_He({path:c,checkoutRestrictions:d?.checkout?.checkoutRestrictions,actionType:o.type})?e(Z.openModal(LD)):d?.checkout?.delivery?.deliveryPriceChanged&&!u&&z.info("slot-price-changed.toast",{id:Bw}),e(AHe({state:r,basket:d})),d?.slot&&z.getNotifications().find(f=>f?.id===Xu)&&z.close(Xu)}return a},xHe=({dispatch:e})=>t=>n=>{const o=t(n);return n.type===mn&&e(Dae()),o},nz=e=>({type:"API",payload:{service:"customerloyalty",pathPrefix:{client:"/api/customerloyalty",server:"/core-api"},...e}}),oz=ee("GET_CUSTOMER_LOYALTY"),RHe=()=>nz({url:"/v1/web/loyalty/balance",options:{method:"GET"},...oz}),Fu={getCustomerLoyalty:RHe,actionTypes:{GET_CUSTOMER_LOYALTY:oz}},DHe=D("r.glorc"),OHe=D("loyalty"),PHe=({dispatch:e,getState:t})=>n=>o=>{const r=t(),a=n(o);return r.session.isLoggedIn&&o.type===mn&&OHe(r)&&DHe(r)&&!Yt(r)&&e(Fu.getCustomerLoyalty()),a},NHe=/\/checkout\/3ds\/continue\/?(\?.*)?$/,LHe=/\/checkout\/3ds\/?(\?.*)?$/,kHe=/\/checkout\/summary\/?(\?.*)?$/,MHe=/\/delivery-pass\/subscription\/?(\?.*)?$/,jHe=/\/failed-payment(\/[a-zA-Z0-9-+]*)?\/3ds\/?(\?.*)?$/,wHe=/\/failed-payment(\/[a-zA-Z0-9-+]*)?\/?(\?.*)?$/,FHe=/\/settings\/delivery-pass\/?(\?.*)?$/,BHe=/\/settings\/wallet\/?(\?.*)?$/,UHe=/\/delivery-pass\/benefit-group-selection\/?(\?.*)?$/,GHe=/\/orders\/?(\?.*)?$/,$He=[NHe,LHe,MHe,UHe,jHe,wHe,FHe,BHe],HHe=D("tp.pci"),rz=D("gtm.rl"),VHe=D("cs.pe");D("gpc");const YHe=D("ro.su"),Yy=V(VHe,YHe,(e,t)=>{const n=[...$He];return e||n.push(kHe),t&&n.push(GHe),n}),WHe=V(HHe,rz,(e,t)=>e||t),qHe=[{featureFlag:"co.wfe",paths:[/\/checkout\/complete\/?(\?.*)?$/]}],KHe=({getState:e,dispatch:t})=>n=>o=>{if(o.type!==mn||!o.payload)return n(o);const r=e(),a=$S(r);if(WHe(r)){if(!!Yy(r).find(l=>!!o.payload.location.pathname.match(l)))return a.type!==Rr.ALL_ANCHORS&&t(_je()),n(o);a.type!==Rr.MIXED&&t(ew(Yy(r)))}return qHe.forEach(i=>{D(i.featureFlag)(r)&&a.type!==Rr.MIXED&&t(ew(i.paths))}),n(o)},az=ee("CONFIRM_SLOT"),zHe=e=>({type:"API",payload:{service:"ecomslots",pathPrefix:{client:"/api/ecomslots",server:"/core-api"},url:"/v1/slots/confirm",options:{body:e,method:"PUT"},...az}}),uO={confirmSlot:zHe,types:{CONFIRM_SLOT:az}},QHe=D("sen"),pO=new zi,iz=e=>`ExpiryNotification${e}`,XHe=e=>{e(zn.LEGACY_addServerSideNotifications([ro.LEGACY_expiredNotification.key]))},ZHe=(e,t)=>{const n=e.split(",").map(i=>Number(i)).sort((i,l)=>i-l),o=Math.ceil(Kh(t,Ll())/(1e3*60)),r=n.findIndex(i=>i>o),a=n[r];switch(r){case-1:return;case 0:return{key:"basket.slot.soon.expiring.final.notification",substitutions:{timeToExpiry:a}};default:return{key:"basket.slot.soon.expiring.notification",substitutions:{timeToExpiry:a}}}},mO=({state:e},t)=>{t&&(z.close(iz(t)),pO.remove($s.NOTIFIED_EXPIRY,{path:pn({basePath:Wt(e)})}))},lz=({dispatch:e,state:t},n,o,r)=>{mO({state:t},n),o(),pO.set($s.NOTIFIED_EXPIRY,r,{path:pn({basePath:Wt(t)})})},JHe=({dispatch:e,state:t},n)=>{lz({dispatch:e,state:t},n,()=>XHe(e),0)},eVe=({dispatch:e,state:t},n,o,r)=>{const a=ZHe(o,r),i=a?.substitutions?.timeToExpiry;a&&i?Number(n)!==Number(i)&&lz({dispatch:e,state:t},n,()=>z.info(a,{id:iz(i)}),i):mO({state:t},n)},tVe=(e,t)=>{const o=At(e)!==t?.orderId,r=!!aS(e)&&!t?.slot;return o&&r},sVe=(e,t)=>{const n=Fa(e);return!!n&&n!==t?.deliveryDestinationId},nVe=({dispatch:e,getState:t})=>n=>o=>{const r=t(),a=n(o),i=o.type===uO.types.CONFIRM_SLOT.SUCCESS,l=o.type===en.types.GET_CART.SUCCESS||o.type===en.types.GET_CHECKOUT_CART.SUCCESS;if(!i&&!l)return a;const c=qe(r,"slot-expiry-notifications-intervals");if(QHe(r)&&c!=="-1"){const u=Number(pO.get($s.NOTIFIED_EXPIRY)??0),m=D0(o),g=tVe(r,m),f=sVe(r,m);if(i||g||f)return mO({state:r},u),a;const y=fie(r),I=m?.slot?.expiryTime;!I&&y?JHe({dispatch:e,state:r},u):I&&c?.length&&eVe({dispatch:e,state:r},u,c,I)}return a},Uw=e=>{const t=Mt(e.startTime),n=Mt(e.endTime);return e.type==="ON_DEMAND"?{}:{slot_start_time:t.format(vn),slot_end_time:n.format(vn)}},oVe=({data:e})=>e.draftBasket,hO=e=>oVe(e)?.items||[],cz=(e,t)=>V(hO,n=>n?.find(o=>o?.productId===t))(e),rVe=()=>V(cz,e=>e?.quantity?.quantityInBasket??0),aVe=rVe(),dz=ee("GET_ALTERNATIVES"),uz=ee("GET_ALTERNATIVES_V2"),pz="SET_ACTIVE_ALTERNATIVES",mz="web_product_page_ws",iVe=e=>({type:"API",payload:{service:mz,url:`/webproductpagews/v5/products/alternatives?retailerProductId=${e}`,...dz}}),lVe=(e,t)=>({type:"API",payload:{service:mz,url:"/webproductpagews/v5/products/alternatives",options:{method:"POST",body:{...e&&{fulfillment:{fulfillmentId:e.slotId,regionId:e.slotRegionId}},productId:t}},...uz}}),cVe=e=>({type:pz,payload:{productId:e}}),Pi={getAlternatives:iVe,setActiveAlternatives:cVe,getAlternativesV2:lVe,types:{GET_ALTERNATIVES:dz,GET_ALTERNATIVES_V2:uz,SET_ACTIVE_ALTERNATIVES:pz}},dVe=(e=ns.products.alternatives,t)=>{switch(t.type){case Pi.types.GET_ALTERNATIVES.PENDING:case Pi.types.GET_ALTERNATIVES_V2.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Pi.types.GET_ALTERNATIVES.ERROR:case Pi.types.GET_ALTERNATIVES_V2.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Pi.types.GET_ALTERNATIVES.SUCCESS:case Pi.types.GET_ALTERNATIVES_V2.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:t.payload.responseData,lastUpdated:le()};case Pi.types.SET_ACTIVE_ALTERNATIVES:return{...e,active:t.payload.productId};default:return e}},hz=({data:e})=>e.products.alternatives,uVe=({dispatch:e,getState:t})=>{let n=null,o=[];const r=()=>{const i=t(),l=hO(i),c=Zt(i),d=hz(i),u=Ts(i),m=d?.data?.alternatives??[];if(!l.length||!m.length||!u)return;const g=new Map(l.map(S=>[S.productId,S.quantity.quantityInBasket])),f=m.flatMap(S=>{if(!S)return[];const C=(g.get(S.productId)??0)-(S.quantityInBasket??0);return C<0&&u[S.productId]?(o.push({...u[S.productId],missingAmount:Math.abs(C)}),[]):C>0?[{...S,price:{current:{...S.price}},quantity:C}]:[]}),y=fC({products:f,addedByFunction:"CONFIRM_SLOT",page:"slot-booking",basket:c});J.sendEvent({GA:y,WA:null}),e(U.analyticsEvent({type:Te.ADD_TO_CART_GA4,basket:c,page:"slot-booking",addedByFunction:"CONFIRM_SLOT",product:l,productListName:null})),yC({basket:c,page:"slot-booking",addedByFunction:"CONFIRM_SLOT",productListName:null,section:"out-of-stock",products:f,featuredProductCampaigns:qs(i)}).forEach(S=>{J.sendEvent({GA:S,WA:null})}),e(U.analyticsEvent({type:Te.ADD_BASKET_ITEM,basket:c,product:l,addedByFunction:"CONFIRM_SLOT",page:"slot-booking",section:"out-of-stock"}))},a=()=>{const i=[...n?.payload?.confirmationData?.limitedProducts||[],...o];if(!i.length)return;const l=t(),c=Zt(l),d=i.map(g=>({...g,quantity:g.missingAmount??0})),u=IC({products:d,basket:c,page:"slot-booking",addedByFunction:"CONFIRM_SLOT"});J.sendEvent({GA:u,WA:null}),SC({products:d,basket:c,page:"slot-booking",addedByFunction:"CONFIRM_SLOT",productListName:null,section:"out-of-stock",featuredProductCampaigns:qs(l)}).forEach(g=>{J.sendEvent({GA:g,WA:null})}),e(U.analyticsEvent({type:Te.REMOVE_BASKET_ITEM,basket:c,product:d,addedByFunction:"CONFIRM_SLOT",page:"slot-booking",section:"out-of-stock"}))};return i=>l=>{const c=i(l),d=t(),u=l.type===yo.types.SET_SELECTED_SLOT,m=l.type===uO.types.CONFIRM_SLOT.SUCCESS;if(!u&&!m)return c;const g=!!l.payload?.confirmationData?.draftBasketId;if(u&&g)return n=l,c;if(u&&!g){e({...l,type:Fe.SLOT_BOOKED}),e({...l,type:Fe.GA4_SLOT_BOOKED});const{payload:{slot:f},deliveryPrice:y}=l,I=Zr(f.startTime),S=At(d)??"",C=Fo(d),_={event:"slot_booked",method:hh[f.deliveryMethod],osp_transaction_id:S,group_id:C,...Uw(f),slot_date:I.format(oa),slot_day:I.isoWeekday(),slot_type:f.type,slot_price:parseFloat(y.amount),site_id:""};return J.sendEvent({GA:_,WA:null}),n=null,c}if(m){if(n){e({...n,type:Fe.SLOT_BOOKED}),e({...n,type:Fe.GA4_SLOT_BOOKED});const{payload:{slot:f},deliveryPrice:y}=n,I=Zr(f.startTime),S=At(d)??"",C=Fo(d),_={event:"slot_booked",method:hh[f.deliveryMethod],osp_transaction_id:S,group_id:C,...Uw(f),slot_date:I.format(oa),slot_day:I.isoWeekday(),slot_type:f.type,slot_price:parseFloat(y.amount),site_id:""};J.sendEvent({GA:_,WA:null}),r(),a(),o=[],n=null}return c}return c}},pVe=e=>Object.values(en.types).find(t=>t.SUCCESS===e.type);function mVe(e){return e.type===mn&&e.payload?.isFirstRendering}const hVe=({dispatch:e,getState:t})=>n=>o=>{const r=n(o),a=t();if(mVe(o)||pVe(o)){const c=Qs(a),d=fle(a);d&&!c.isFetching&&c.data?.deliveryDestinationId!==d&&e(sn.getSelectedDeliveryDestinationData(d))}const i=sg(a);if(D("dds.a")(a)&&i&&o.type===Is.types.ADD_BASKET_ITEM.SUCCESS){const c=a.data.basket?.items||[],u=Qs(a)?.data?.deliveryDestinationId;if(!c.length&&!u){const m=Ze(a);e(Z.openModal(m?kp:ld))}}return r},gz=()=>"/delivery-pass",ic=({queryString:e=""}={})=>`${gz()}/subscription${e}`,gVe=()=>`${gz()}/benefit-group-selection`,EVe=e=>`/api/customer/v1/benefit-groups/delivery-pass/subscription/${e}/receipt`,Ez="failed-payment-not-updatable",fVe="3ds",yVe="reason",fz="pay.nsc",IVe="pay.ew",yz="pay.ywlt",SVe="dp.freetrial",gO="m.la.h",Iz="pay.slct",CVe="pay.invoice",Sz="lumpSum",Gt={VISA:"visa",MASTERCARD:"mastercard",AMEX:"amex",PAYPAL:"paypal",INVOICE:"invoice",FINANCING_OPTION_ICON:"financing_option_1",BLIK:"blik",BANK_TRANSFER:"bank_transfer",PAYMENT_CARD:"payment_card",VISA_PHONE:"visa_phone",GOOGLE_PAY:"google_pay",APPLE_PAY:"apple_pay",SMARTNEY:"smartney",ONEY:"oney",L_PAY:"lpay",NAVERPAY:"naverpay",KAKAOPAY:"kakaopay"},TVe=({pathname:e})=>{switch(e){case Uo():case ic():return`${e}?openPaymentModal=true`;case tr():case vh():default:return e}},EO=e=>{const t=/^https:\/\/[a-zA-Z0-9-]+\.mastercard\.com$/,{hostname:n}=window.location,r=`https://pspweb.${n.indexOf("www.")===0?n.split("www.")[1]:n}`;return e===r||t.test(e)},_Ve=({lastFourDigits:e,expiryMonth:t,expiryYear:n})=>{const o=`**** ${e}`,r=n?`(${t}/${n.slice(-2)})`:"";return e&&t&&n?`${o} ${r}`:e?o:r},vVe=e=>{e.notification===Ez&&AVe();const t=Gw({queryParams:e,key:fVe});if(!t)return;const n=Gw({queryParams:e,key:yVe});bVe(n||t)},Gw=({queryParams:e,key:t})=>{const n=e[t];return!n||typeof n=="string"?n:Array.isArray(n)?n[0]:n},AVe=()=>z.error(Cz[Ez]),bVe=e=>{const t=Cz[`3ds-${e}`];t&&z.error(t)},Cz={"failed-payment-not-updatable":"payment.failed.not.updatable","3ds-failure":"order.cow.3ds.failure","3ds-cancelled":"order.cow.3ds.user.cancelled","3ds-token-not-found":"payments.notification.token.not.found.error"},xVe=({dispatch:e,getState:t})=>{const n=t(),o=D("mins")(n),r=XD(n);if(!o||!r)return;const a=dC(n),i=pa(n);e(zn.LEGACY_addServerSideNotifications([ro.LEGACY_minimumOrderChangedNotification.key])),e(U.analyticsEvent({type:Te.MINIMUM_BASKET_VALUE_CHANGED_NOTIFICATION_DISPLAYED,minimumBasketValueAmount:a?.amount,basketValueAmount:i?.amount,basketValueCurrency:i?.currency}))},RVe=({getState:e,dispatch:t})=>n=>o=>{if(o.type!==mn||!o.payload)return n(o);const r=e(),{data:{basket:{slot:a}}}=r,i=D("oosa")(r),l=D("bt.spl")(r),c=D("misbc")(r),d=bK(r),u=tt.parse(o.payload.location.search),g=[...d.map(f=>ro[f]),...z.getNotifications()].find(f=>f.id===DVe[$c]);return i&&a&&u[$c]&&!g&&OVe(t,a),a&&u["min-spend-changed"]&&!c&&xVe({dispatch:t,getState:e}),l&&a&&u[$c]===Fq&&kVe(),vVe(u),n(o)},DVe={"slot-booked":"slotbooking.confirm.alert"},OVe=(e,t)=>{const n=t.deliveryMethod===Et.clickAndCollect.method,o=t.deliveryMethod===Et.vanDelivery.method,r=t.slotType===Pa;if(r&&o){NVe(e);return}if(n){if(r){PVe(e);return}LVe(e);return}e(zn.LEGACY_addServerSideNotifications([ro.LEGACY_showSlotBookedToast.key]))},PVe=e=>{e(zn.LEGACY_addServerSideNotifications([ro.LEGACY_showExpressCollectionBookedToast.key]))},NVe=e=>{e(zn.LEGACY_addServerSideNotifications([ro.LEGACY_showFastDeliverBookedToast.key]))},LVe=e=>{e(zn.LEGACY_addServerSideNotifications([ro.LEGACY_showMultidayOrStandardCustomerCollectioBookedToast.key]))},kVe=()=>{z.success("slotbooking.grocery.slot.booked.info")},Zu="outOfStockAlternatives",P_="out-of-stock-alternatives-modal-name-header-label",MVe="OUT_OF_STOCK_ALTERNATIVES",jVe=({dispatch:e,getState:t})=>n=>o=>{const r=t(),a=n(o),i=Ue(Zu)(r);return o.type===mn&&!o.payload?.isFirstRendering&&i&&e(Z.closeModal()),a},qn={ASSISTANT:"ASSISTANT",USER:"USER"},Gs={CREATE_CHAT:ee("CREATE_CHAT"),SEND_MESSAGE:ee("SEND_MESSAGE"),GET_CHAT_HISTORY:ee("GET_CHAT_HISTORY"),SET_CHAT:"SET_CHAT",SET_SHOW_REFRESH_DIALOG:"SET_SHOW_REFRESH_DIALOG",CLEAR_CHAT:"CLEAR_CHAT",DISABLE_FLOWOUT:"DISABLE_FLOWOUT"},fO={service:"ecomllminterface",pathPrefix:{client:"/api/chat",server:"/core-api"}},wVe=()=>({type:"API",payload:{url:"/v1/chat",options:{method:"POST"},...fO,...Gs.CREATE_CHAT},timestamp:le()}),FVe=e=>({type:Gs.SET_CHAT,payload:{chatId:e}}),BVe=()=>({type:Gs.CLEAR_CHAT}),$w=()=>({type:Gs.DISABLE_FLOWOUT}),yO=e=>({type:Gs.SET_SHOW_REFRESH_DIALOG,payload:{showRefreshDialog:e}}),UVe=(e,t)=>({type:"API",payload:{url:`/v1/chat/${e}/messages?imageFormat=avif`,options:{method:"PUT",body:{message:t}},...fO,...Gs.SEND_MESSAGE},message:t,timestamp:le()}),GVe=e=>({type:"API",payload:{url:`/v1/chat/${e}/messages?imageFormat=avif`,...fO,...Gs.GET_CHAT_HISTORY}});class Tz{name;constructor(t){this.name=t}store(t,n){let o;if(n){const r=le()+n;o=Vb(r)}try{localStorage.setItem(this.name,JSON.stringify({data:t,expiryTime:o}))}catch(r){Me.api.pushError(r instanceof Error?r:new Error(`cacheStore error: ${JSON.stringify(r)}`),{context:{items:JSON.stringify(Object.keys(localStorage)),attempted:JSON.stringify(t).slice(0,50),attemptedSize:JSON.stringify(t).length.toString(),isIncognito:JSON.stringify(!window.indexedDB)}})}}get(){const t=localStorage.getItem(this.name);return t?JSON.parse(t):null}remove(){localStorage.removeItem(this.name)}exists(){return localStorage.getItem(this.name)!==null}hasExpired(){const t=le(),n=localStorage.getItem(this.name);if(n){const o=JSON.parse(n);return o.expiryTime&&t>rh(o.expiryTime)}return!1}}let wi;function hm(e,t,n){wi||(wi=new Tz("recipe-chat-cache")),wi.store({chatId:e,isOpen:t},n?rh(n)-le():void 0)}function $Ve(){wi&&wi.remove()}function _z(){if(!(typeof window>"u")&&(wi||(wi=new Tz("recipe-chat-cache")),!wi.hasExpired()))return wi.get()?.data}const HVe=e=>t=>n=>{switch(n.type){case Gs.SEND_MESSAGE.PENDING:{const{chatId:o,messageHistory:r}=e.getState().data.recipes.chat.data;if(!r)break;if(e.dispatch(U.analyticsEvent({type:xm,CHAT_ID:o,MESSAGE_FROM:qn.USER,MESSAGE_TYPE:Sl.TEXT,SEQUENCE:r.length})),o){const a={event:"recipe_assistant_message",id:o,index:r.length,origin:qn.USER,type:Sl.TEXT};J.sendEvent({GA:a,WA:null})}break}case Gs.CLEAR_CHAT:case Gs.CREATE_CHAT.PENDING:$Ve();break;case Gs.CREATE_CHAT.SUCCESS:{const{chatId:o,expiryTime:r}=n.payload.responseData,a=Ue("recipesChatModal")(e.getState());if(hm(o,a,r),e.dispatch(U.analyticsEvent({type:xm,CHAT_ID:o,MESSAGE_FROM:qn.ASSISTANT,MESSAGE_TYPE:Sl.TEXT,SEQUENCE:0})),o){const i={event:"recipe_assistant_message",id:o,index:0,origin:qn.ASSISTANT,type:Sl.TEXT};J.sendEvent({GA:i,WA:null})}break}case Gs.GET_CHAT_HISTORY.SUCCESS:{const{chatId:o,expiryTime:r}=n.payload.responseData,a=Ue("recipesChatModal")(e.getState());hm(o,a,r);break}case Gs.SEND_MESSAGE.SUCCESS:{const{chatId:o,responseMessage:r,expiryTime:a}=n.payload.responseData,i=Ue("recipesChatModal")(e.getState()),{messageHistory:l}=e.getState().data.recipes.chat.data;if(hm(o,i,a),!l)break;if(e.dispatch(U.analyticsEvent({type:xm,CHAT_ID:o,MESSAGE_FROM:r.role,MESSAGE_TYPE:r.results&&r.results.length>0?Sl.RECIPE_IMPRESSION:Sl.TEXT,SEQUENCE:l.length})),o){const c={event:"recipe_assistant_message",id:o,index:l.length,origin:r.role,type:r.results&&r.results.length>0?Sl.RECIPE_IMPRESSION:Sl.TEXT};J.sendEvent({GA:c,WA:null})}break}case Z.actionTypes.OPEN_MODAL:{if(n.payload?.modalName!=="recipesChatModal")break;const{chatId:o,expiryTime:r}=e.getState().data.recipes.chat.data;o&&hm(o,!0,r);break}case Z.actionTypes.CLOSE_MODAL:{const{chatId:o,expiryTime:r}=e.getState().data.recipes.chat.data,a=!!_z()?.isOpen;if(!Ue("recipesChatModal")(e.getState())){if(a)return t(Z.openModal("recipesChatModal"));break}o&&hm(o,!1,r);break}}return t(n)},VVe=e=>t=>n=>{const o=t(n);if(n.type===mn){const r=e.getState(),a=Ue("recipesChatModal")(r),i=n?.payload?.location?.state?.recipeCardClickedInMobile;a&&i&&e.dispatch(Z.closeModal())}return o},YVe={token:""},WVe=(e=YVe)=>e,Va=({session:e})=>e.csrf.token,vz=e=>typeof e=="object"&&e!==null;class RA extends Error{statusCode;code;data;constructor(t,n,o,r,a){super(t),this.statusCode=n,this.message=o,this.data=r,this.code=a}hasData=()=>vz(this.data);hasCode=()=>typeof this.code=="string"&&this.code.length>0}function qVe(e){let t;const n=e.headers&&e.headers.get("content-type");return n&&n.includes("application/json")?t=e.json().catch(()=>Promise.resolve({})):t=e.text().catch(()=>Promise.resolve("")),Promise.all([t,e.status,e.ok])}function KVe([e,t,n]){if(!n){const o=`Request failed with status code ${t}`;return Promise.reject(vz(e)?new RA(o,t,typeof e.message=="string"?e.message:o,e.data,e.code):new RA(o,t,o))}return Promise.resolve(e)}function zVe(e,t,n,o,r=""){const a=e.pathPrefix?e.pathPrefix.client??"":"/api",i=`${r}${a}${e.url}`;return fetch(i,{credentials:"same-origin",...t}).then(qVe).then(KVe).then(l=>(e.onSuccess&&n(e.onSuccess),n({type:e.SUCCESS,payload:{responseData:l},...o}))).catch(l=>{throw n({type:e.ERROR,payload:l,skipLoginRedirect:!!e.skipLoginRedirect,error:!0,...o}),l})}const QVe=({dispatch:e,getState:t})=>n=>o=>{if(o.type!=="API")return n(o);const{payload:r,type:a,...i}=o,{options:l={}}=r,{body:c,headers:d={},method:u}=l,m=u&&u!=="GET"?{"X-CSRF-TOKEN":Va(t())}:{};c&&(Object.keys(d).some(y=>y.toLowerCase()==="content-type")||(l.body=JSON.stringify(c),l.headers={...d,"content-type":"application/json; charset=utf-8"})),l.headers={...m,"client-route-id":wa(t()),"ecom-request-source":"web","ecom-request-source-version":oS(t()),accept:"application/json; charset=utf-8",...l.headers},e({type:r.PENDING,...i});const g=Wt(t());return zVe(r,l,e,i,g)},IO=new zi,XVe={sameSite:"strict",secure:!0,path:"/"},ZVe=()=>{IO.set($s.AGE_CONFIRMATION_COOKIE,!0,{...XVe,domain:window.location.hostname})},SO=()=>{IO.remove($s.AGE_CONFIRMATION_COOKIE,{path:"/",domain:window.location.hostname})},JVe=()=>!!IO.get($s.AGE_CONFIRMATION_COOKIE),e2e=({getState:e})=>t=>{let n=!0;return o=>{if(o.error&&(o.payload?.statusCode===401||o.payload?.statusCode===403)&&!o.skipLoginRedirect){n=!1,SO();const r=Wt(e()),a=`${window.location.pathname}${window.location.search||""}`;return window.location.replace(Fr({basePath:r,queryString:`destination=${encodeURIComponent(a)}`})),Promise.resolve()}return n&&t(o)}},t2e="SET_ADD_CARD_FRAME_URL",s2e="RESET_ADD_CARD_FRAME_URL",n2e=ee("SUBMIT_ADD_CARD_REFERENCE"),DA={actionTypes:{SET_ADD_CARD_FRAME_URL:t2e,RESET_ADD_CARD_FRAME_URL:s2e,SUBMIT_ADD_CARD_REFERENCE:n2e}},o2e=(e=ns.addWalletItemModal,t)=>{switch(t.type){case DA.actionTypes.SET_ADD_CARD_FRAME_URL:return{...e,datacashUrl:t.payload};case DA.actionTypes.RESET_ADD_CARD_FRAME_URL:return{...e,datacashUrl:null};default:return e}},Az="SET_ADD_WALLET_PSPWEB_FRAME_URL",bz="RESET_ADD_WALLET_PSPWEB_FRAME_URL",r2e=e=>({type:Az,payload:e}),a2e=()=>({type:bz}),Wy={setAddWalletPspwebFrameUrl:r2e,resetAddWalletPspwebFrameUrl:a2e,actionTypes:{SET_ADD_WALLET_PSPWEB_FRAME_URL:Az,RESET_ADD_WALLET_PSPWEB_FRAME_URL:bz}},i2e=(e=ns.addWalletItemModal,t)=>{switch(t.type){case Wy.actionTypes.SET_ADD_WALLET_PSPWEB_FRAME_URL:return{...e,pspwebUrl:t.payload};case Wy.actionTypes.RESET_ADD_WALLET_PSPWEB_FRAME_URL:return{...e,pspwebUrl:null};default:return e}},l2e=({control:e})=>e?.addPspwebWalletItemModal?.pspwebUrl,c2e={...Re,settings:{randomizeInitialHorizontalAdvert:!1},placement:{belowGrid:[]}},d2e=(e=c2e,t)=>{switch(t.type){case"GET_CART_ADVERTS_PENDING":return{...e,isFetching:!0,fetchError:!1,settings:{randomizeInitialHorizontalAdvert:!1},placement:{belowGrid:[]}};case"GET_CART_ADVERTS_ERROR":return{...e,isFetching:!1,fetchError:!0,settings:{randomizeInitialHorizontalAdvert:!1},placement:{belowGrid:[]}};case"GET_CART_ADVERTS_SUCCESS":{const{responseData:n}=t.payload;return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),settings:n.advertSettings,placement:{belowGrid:n.advertisingBanners?.belowGrid||[]}}}default:return e}},u2e={...Re,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],withinGrid:[]}},p2e=(e=u2e,t)=>{switch(t.type){case"GET_CATEGORY_PAGE_ADVERTS_PENDING":return{...e,isFetching:!0,fetchError:!1,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],withinGrid:[]}};case"GET_CATEGORY_PAGE_ADVERTS_ERROR":return{...e,isFetching:!1,fetchError:!0,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],withinGrid:[]}};case"GET_CATEGORY_PAGE_ADVERTS_SUCCESS":{const{responseData:n}=t.payload;return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),settings:n.advertSettings,placement:{aboveGrid:n.advertisingBanners?.aboveGrid||[],withinGrid:n.advertisingBanners?.withinGrid||[]}}}default:return e}},m2e={...Re,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],withinGrid:[]}},h2e=(e=m2e,t)=>{switch(t.type){case"GET_SEARCH_PAGE_ADVERTS_PENDING":return{...e,isFetching:!0,fetchError:!1,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],withinGrid:[]}};case"GET_SEARCH_PAGE_ADVERTS_ERROR":return{...e,isFetching:!1,fetchError:!0,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],withinGrid:[]}};case"GET_SEARCH_PAGE_ADVERTS_SUCCESS":{const{responseData:n}=t.payload;return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),settings:n.advertSettings,placement:{aboveGrid:n.advertisingBanners?.aboveGrid||[],withinGrid:n.advertisingBanners?.withinGrid||[]}}}default:return e}},g2e={...Re,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],withinGrid:[]}},E2e=(e=g2e,t)=>{switch(t.type){case"GET_PROMOTIONS_PAGE_ADVERTS_PENDING":return{...e,isFetching:!0,fetchError:!1,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],withinGrid:[]}};case"GET_PROMOTIONS_PAGE_ADVERTS_ERROR":return{...e,isFetching:!1,fetchError:!0,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],withinGrid:[]}};case"GET_PROMOTIONS_PAGE_ADVERTS_SUCCESS":{const{responseData:n}=t.payload;return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),settings:n.advertSettings,placement:{aboveGrid:n.advertisingBanners?.aboveGrid||[],withinGrid:n.advertisingBanners?.withinGrid||[]}}}default:return e}},f2e={...Re,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[]}},y2e=(e=f2e,t)=>{switch(t.type){case"GET_PROMOTION_DETAILS_PAGE_ADVERTS_PENDING":return{...e,isFetching:!0,fetchError:!1,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[]}};case"GET_PROMOTION_DETAILS_PAGE_ADVERTS_ERROR":return{...e,isFetching:!1,fetchError:!0,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[]}};case"GET_PROMOTION_DETAILS_PAGE_ADVERTS_SUCCESS":{const{responseData:n}=t.payload;return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),settings:n.advertSettings,placement:{aboveGrid:n.advertisingBanners?.aboveGrid||[]}}}default:return e}},I2e={...Re,settings:{randomizeInitialHorizontalAdvert:!1},placement:{hero:[],aboveGrid:[],withinGrid:[]}},S2e=(e=I2e,t)=>{switch(t.type){case"GET_HOMEPAGE_ADVERTS_PENDING":return{...e,isFetching:!0,fetchError:!1,settings:{randomizeInitialHorizontalAdvert:!1},placement:{hero:[],aboveGrid:[],withinGrid:[]}};case"GET_HOMEPAGE_ADVERTS_ERROR":return{...e,isFetching:!1,fetchError:!0,settings:{randomizeInitialHorizontalAdvert:!1},placement:{hero:[],aboveGrid:[],withinGrid:[]}};case"GET_HOMEPAGE_ADVERTS_SUCCESS":{const{responseData:n}=t.payload;return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),settings:n.advertSettings,placement:{hero:n.advertisingBanners?.hero||[],aboveGrid:n.advertisingBanners?.aboveGrid||[],withinGrid:n.advertisingBanners?.withinGrid||[]}}}default:return e}},C2e={...Re,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],withinGrid:[]}},T2e=(e=C2e,t)=>{switch(t.type){case"GET_FAVORITES_PAGE_ADVERTS_PENDING":return{...e,isFetching:!0,fetchError:!1,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],withinGrid:[]}};case"GET_FAVORITES_PAGE_ADVERTS_ERROR":return{...e,isFetching:!1,fetchError:!0,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],withinGrid:[]}};case"GET_FAVORITES_PAGE_ADVERTS_SUCCESS":{const{responseData:n}=t.payload;return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),settings:n.advertSettings,placement:{aboveGrid:n.advertisingBanners?.aboveGrid||[],withinGrid:n.advertisingBanners?.withinGrid||[]}}}default:return e}},_2e={...Re,settings:{randomizeInitialHorizontalAdvert:!1},placement:{belowGrid:[]}},v2e=(e=_2e,t)=>{switch(t.type){case"GET_SLOT_BOOKING_PAGE_ADVERTS_PENDING":return{...e,isFetching:!0,fetchError:!1,settings:{randomizeInitialHorizontalAdvert:!1},placement:{belowGrid:[]}};case"GET_SLOT_BOOKING_PAGE_ADVERTS_ERROR":return{...e,isFetching:!1,fetchError:!0,settings:{randomizeInitialHorizontalAdvert:!1},placement:{belowGrid:[]}};case"GET_SLOT_BOOKING_PAGE_ADVERTS_SUCCESS":{const{responseData:n}=t.payload;return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),settings:n.advertSettings,placement:{belowGrid:n?.advertisingBanners?.belowGrid||[]}}}default:return e}},Rf=ee("GET_PRODUCT_DETAILS_PAGE_ADVERTS"),xXt=e=>{const t=tt.stringify({page:"PRODUCT_DETAILS",key:e},{sort:!1});return{type:"API",retailerProductId:e,payload:{url:`/v1/content?${t}`,...Rf}}},A2e={},b2e=(e=A2e,t)=>{switch(t.type){case Rf.PENDING:return{...e,[t.retailerProductId]:{...Re,isFetching:!0,fetchError:!1,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],belowGrid:[]}}};case Rf.ERROR:return{...e,[t.retailerProductId]:{...Re,isFetching:!1,fetchError:!0,settings:{randomizeInitialHorizontalAdvert:!1},placement:{aboveGrid:[],belowGrid:[]}}};case Rf.SUCCESS:return{...e,[t.retailerProductId]:{...Re,isFetching:!1,fetchError:!1,lastUpdated:le(),settings:t.payload.responseData.advertSettings,placement:{aboveGrid:t.payload.responseData.advertisingBanners?.aboveGrid||[],belowGrid:t.payload.responseData.advertisingBanners?.belowGrid||[]}}};default:return e}},x2e={...Re,settings:{randomizeInitialHorizontalAdvert:!1},placement:{belowGrid:[]}},R2e=(e=x2e,t)=>{switch(t.type){case"GET_ORDER_CONFIRMATION_ADVERTS_PENDING":return{...e,isFetching:!0,fetchError:!1,settings:{randomizeInitialHorizontalAdvert:!1},placement:{belowGrid:[]}};case"GET_ORDER_CONFIRMATION_ADVERTS_ERROR":return{...e,isFetching:!1,fetchError:!0,settings:{randomizeInitialHorizontalAdvert:!1},placement:{belowGrid:[]}};case"GET_ORDER_CONFIRMATION_ADVERTS_SUCCESS":{const{responseData:n}=t.payload;return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),settings:n.advertSettings,placement:{belowGrid:n.advertisingBanners?.belowGrid||[]}}}default:return e}},D2e=Ms({cartPage:d2e,categoryPage:p2e,searchPage:h2e,promotionsPage:E2e,promotionDetailsPage:y2e,homepage:S2e,favoritesPage:T2e,productDetailsPage:b2e,slotBookingPage:v2e,orderConfirmationPage:R2e}),Ni={THIS_ORDER_ONLY:"THIS_ORDER_ONLY",THIS_AND_FUTURE_ORDERS:"THIS_AND_FUTURE_ORDERS"},Im="WEEKS",O2e=[Im],xz="WEEKS_1",P2e="WEEKS_2",N2e="WEEKS_3",L2e="WEEKS_4",Lo="NONE",Wi="recurringshopping",k2e={[xz]:{unit:Im,value:1},[P2e]:{unit:Im,value:2},[N2e]:{unit:Im,value:3},[L2e]:{unit:Im,value:4}},xo="recurring-shopping-definition-create-frequency",Ko="recurring-shopping-definition-create-name",M2e={recurringShoppingDefinition:"",recurringName:"",editRecurringOrderOption:Ni.THIS_ORDER_ONLY},j2e=(e=M2e,t)=>{switch(t.type){case _e.RECURRING_SHOPPING_DEFINITION_LABEL_WRITTEN:return{...e,recurringName:t.payload.data.recurringFrequencyName};case _e.RECURRING_SHOPPING_DEFINITION_FREQUENCY_SELECTED:return{...e,recurringShoppingDefinition:t.payload.data.recurringFrequency};case"RECURRING_SHOPPING_DEFINITION_FORM_RESET":return{...e,recurringName:void 0,recurringShoppingDefinition:void 0};case"EDIT_RECURRING_ORDER_OPTION":return{...e,editRecurringOrderOption:t.payload.editOption};default:return e}},TC=({data:{checkout:e}})=>e,Rz=V(TC,e=>e?.recurringName),Rg=V(TC,e=>e?.recurringShoppingDefinition),w2e=V(TC,e=>e?.recurringShoppingDefinition===Lo&&!e?.recurringName||e?.recurringName&&e.recurringShoppingDefinition&&e.recurringShoppingDefinition!==Lo||!e?.recurringShoppingDefinition&&!e?.recurringName),F2e=V(TC,e=>({recurringName:e?.recurringName&&e?.recurringShoppingDefinition&&e?.recurringShoppingDefinition!==Lo||e?.recurringShoppingDefinition===Lo&&!e?.recurringName||!e?.recurringShoppingDefinition&&!e?.recurringName,recurringShoppingDefinition:e?.recurringShoppingDefinition&&e?.recurringShoppingDefinition!==Lo||e?.recurringShoppingDefinition===Lo&&!e?.recurringName||!e?.recurringShoppingDefinition&&!e?.recurringName})),Dz=({data:e})=>e.checkout.editRecurringOrderOption,Oz="SET_UNSELECTED_PAYMENT_WARNING",Pz="INITIATE_PAYMENT",Nz="FINISH_PAYMENT",Lz="SET_TO_SAVE_PAYMENT_METHOD",kz="SET_IS_TO_SAVE_PAYMENT_METHOD_VALID",Mz="SET_PAYMENT_OPTION_AND_TYPE",jz="SET_FINANCING_OPTION",wz="SET_FINANCING_PROVIDERS",B2e=e=>({type:Oz,payload:{show:e}}),U2e=e=>({type:Lz,payload:{toSavePaymentMethod:e}}),G2e=e=>({type:kz,payload:{isToSavePaymentMethodValid:e}}),$2e=()=>({type:Pz}),H2e=()=>({type:Nz}),V2e=e=>({type:Mz,payload:{options:e}}),Y2e=e=>({type:jz,payload:{financingOption:e}}),W2e=({retailerFinancingProviderId:e,financingProviderId:t})=>({type:wz,payload:{financingProviderId:t,retailerFinancingProviderId:e}}),kt={setUnselectedPaymentWarning:B2e,initiatePayment:$2e,finishPayment:H2e,setToSavePaymentMethod:U2e,setIsToSavePaymentMethodValid:G2e,setPaymentOptionAndType:V2e,setFinancingOption:Y2e,setFinancingProviders:W2e,actionTypes:{SET_UNSELECTED_PAYMENT_WARNING:Oz,INITIATE_PAYMENT:Pz,FINISH_PAYMENT:Nz,SET_TO_SAVE_PAYMENT_METHOD:Lz,SET_IS_TO_SAVE_PAYMENT_METHOD_VALID:kz,SET_PAYMENT_OPTION_AND_TYPE:Mz,SET_FINANCING_OPTION:jz,SET_FINANCING_PROVIDERS:wz}},Hw={isFetching:!1,fetchError:!1,didInvalidate:!1,lastUpdated:null},Fz={unselectedPaymentMethodWarning:!1,isPaymentActive:!1,toSavePaymentMethod:!0,isToSavePaymentMethodValid:!0,paymentOption:"UNKNOWN",paymentType:null,threeDsRecoveryUrls:{...Hw,data:{}},paymentChecks:{...Hw,availablePaymentChecks:[],checksMissingRequiredTotal:[]}},q2e=(e=Fz,t)=>{switch(t.type){case kt.actionTypes.SET_UNSELECTED_PAYMENT_WARNING:return{...e,unselectedPaymentMethodWarning:t.payload.show};case kt.actionTypes.INITIATE_PAYMENT:return{...e,isPaymentActive:!0};case kt.actionTypes.FINISH_PAYMENT:return{...e,isPaymentActive:!1};case kt.actionTypes.SET_TO_SAVE_PAYMENT_METHOD:return{...e,toSavePaymentMethod:t.payload.toSavePaymentMethod};case kt.actionTypes.SET_IS_TO_SAVE_PAYMENT_METHOD_VALID:return{...e,isToSavePaymentMethodValid:t.payload.isToSavePaymentMethodValid};case kt.actionTypes.SET_PAYMENT_OPTION_AND_TYPE:return{...e,paymentOption:t.payload.options.paymentOption,paymentType:t.payload.options.paymentType};case kt.actionTypes.SET_FINANCING_OPTION:return{...e,financingOption:t.payload.financingOption};case kt.actionTypes.SET_FINANCING_PROVIDERS:return{...e,financingProviderId:t.payload.financingProviderId,retailerFinancingProviderId:t.payload.retailerFinancingProviderId};default:return e}},K2e=({control:e})=>e.payments.unselectedPaymentMethodWarning,z2e=({control:e})=>e.payments.isPaymentActive,Dg=({control:e})=>e.payments.toSavePaymentMethod,CO=e=>{const t=Rg(e);return!!(t&&t!==Lo)},Q2e=({control:e})=>e.payments.isToSavePaymentMethodValid,TO=({control:e})=>e.payments.paymentOption,X2e=({control:e})=>e.payments.paymentType,jp=V(TO,X2e,(e,t)=>({paymentOption:e,paymentType:t})),_O=({control:e})=>e.payments.retailerFinancingProviderId,vO=({control:e})=>e.payments.financingProviderId,Bz=({control:e})=>e.payments.financingOption;function AO(...e){return(t,n)=>e.reduce((o,r)=>r(o,n),t)}const Z2e=(e=Do,t)=>{switch(t.type){case Is.types.ADD_BASKET_ITEM.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Is.types.REMOVE_BASKET_ITEM.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Is.types.ADD_BASKET_ITEM.SUCCESS:case Is.types.ADD_BASKET_FREE_GIFT_ITEM.SUCCESS:case Is.types.REMOVE_BASKET_ITEM.SUCCESS:case Is.types.REMOVE_BASKET_FREE_GIFT_ITEM.SUCCESS:return{...e,limitedPromotionIds:t.payload.responseData.limitedPromotionIds};case Is.types.EMPTY_CART.SUCCESS:return{...e,limitedPromotionIds:[]};default:return e}},Uz=ee("BASKET_CHECKOUT_START"),J2e=e=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:"/v1/carts/active/checkout-start",options:{body:{shippingGroupType:e},method:"POST"},...Uz}}),Df={basketCheckoutStart:J2e,types:{BASKET_CHECKOUT_START:Uz}},eYe=(e=Do,t)=>{switch(t.type){case Df.types.BASKET_CHECKOUT_START.PENDING:return{...e,isFetching:!0,fetchError:!1};case Df.types.BASKET_CHECKOUT_START.SUCCESS:return{...e,lastUpdated:le(),isFetching:!1,fetchError:!1};case Df.types.BASKET_CHECKOUT_START.ERROR:return{...e,error:t.payload,isFetching:!1,fetchError:!0};default:return e}},Gz=ee("ADD_VOUCHER_TO_BASKET"),$z=ee("ADD_VOUCHER_WITH_MARKETING_CONSENT"),Hz=ee("REMOVE_VOUCHER_FROM_BASKET"),tYe=e=>({type:"API",payload:{url:"/v1/carts/active/vouchers",pathPrefix:{client:"/api/cart",server:"/core-api"},service:"web_basket_ws",options:{body:[e],method:"POST"},...Gz}}),sYe=(e,t)=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},options:{method:"PUT",body:{voucherCode:e,consentProvided:t}},url:"/v2/carts/active/vouchers",...$z}}),nYe=e=>({type:"API",payload:{url:`/v1/carts/active/vouchers/${e}`,pathPrefix:{client:"/api/cart",server:"/core-api"},service:"web_basket_ws",options:{method:"DELETE"},...Hz}}),vl={addVoucherToBasket:tYe,removeVoucherFromBasket:nYe,addVoucherWithMarketingPreferences:sYe,types:{ADD_VOUCHER_TO_BASKET:Gz,REMOVE_VOUCHER_FROM_BASKET:Hz,ADD_VOUCHER_WITH_MARKETING_CONSENT:$z}},oYe=(e=Do,t)=>{switch(t.type){case vl.types.REMOVE_VOUCHER_FROM_BASKET.SUCCESS:return{...t.payload.responseData,isFetching:!1,fetchError:!1,isVoucherError:!1,isVoucherFetching:!1,lastUpdated:le(),voucher:void 0};case vl.types.REMOVE_VOUCHER_FROM_BASKET.ERROR:case vl.types.ADD_VOUCHER_WITH_MARKETING_CONSENT.ERROR:return{...e,isFetching:!1,fetchError:!0,isVoucherError:!0,isVoucherFetching:!1,lastUpdated:le(),error:t.payload};case vl.types.ADD_VOUCHER_WITH_MARKETING_CONSENT.PENDING:return{...e,isVoucherFetching:!0,isVoucherError:!1,lastUpdated:le()};case vl.types.ADD_VOUCHER_WITH_MARKETING_CONSENT.SUCCESS:return{...e,isVoucherFetching:!1,isVoucherError:!1,lastUpdated:le()};default:return e}},Vz=ee("ADD_LOYALTY_UNITS_TO_BASKET"),Yz=ee("REMOVE_LOYALTY_UNITS_FROM_BASKET"),rYe=e=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:"/v1/carts/active/loyalty",options:{...e&&{body:{intendedPoints:e}},method:"POST"},...Vz}}),aYe=()=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:"/v1/carts/active/loyalty",options:{method:"DELETE"},...Yz}}),qy={addLoyaltyUnitsToBasket:rYe,removeLoyaltyUnitsFromBasket:aYe,types:{ADD_LOYALTY_UNITS_TO_BASKET:Vz,REMOVE_LOYALTY_UNITS_FROM_BASKET:Yz}},iYe=(e=Do,t)=>{switch(t.type){case qy.types.ADD_LOYALTY_UNITS_TO_BASKET.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case qy.types.REMOVE_LOYALTY_UNITS_FROM_BASKET.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};default:return e}},Wz="REMOVE_APPLIED_PAYMENT_CHECKS_FROM_BASKET",lYe=()=>({type:Wz}),bO={removedAppliedPaymentChecksFromBasket:lYe,types:{REMOVE_APPLIED_PAYMENT_CHECKS_FROM_BASKET:Wz}},cYe=(e=Do,t)=>{switch(t.type){case bO.types.REMOVE_APPLIED_PAYMENT_CHECKS_FROM_BASKET:return{...e,appliedPaymentChecks:null,removedPaymentChecks:null,totals:{...e.totals,paymentSplit:{paidByLoyalty:void 0,remainingPayment:void 0}}};default:return e}},dYe=AO(Eie,Z2e,oYe,iYe,cYe,eYe),qz=ee("MERGE_BASKET_VIA_CART_TOKEN"),Kz="SET_MERGE_RESULT",zz="CLEAR_MERGE_RESULT",Qz=ee("MERGE_BASKET"),uYe=e=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:"/v1/carts/active/merge-items",options:{method:"POST",body:{...e&&{visitorId:e},...!e&&{mergeBaseBasketToOrderEdition:!0}}},...Qz}}),pYe=e=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:"/v9/baskets/merge",options:{headers:{"content-type":"application/jwt"},method:"POST",body:e},...qz}}),mYe=({limitedItems:e,destination:t,sourceEventId:n})=>({type:Kz,payload:{limitedItems:e,destination:t,sourceEventId:n}}),hYe=()=>({type:zz}),vr={mergeBasketViaCartToken:pYe,mergeBasket:uYe,setMergeResult:mYe,clearMergeResult:hYe,types:{MERGE_BASKET_VIA_CART_TOKEN:qz,MERGE_BASKET:Qz,SET_MERGE_RESULT:Kz,CLEAR_MERGE_RESULT:zz}},Vw={...Re,mergeResults:{}},gYe=(e=Vw,t)=>{switch(t.type){case vr.types.MERGE_BASKET_VIA_CART_TOKEN.ERROR:case vr.types.MERGE_BASKET.ERROR:return{...e,isFetching:!1,fetchError:!0,lastUpdated:le(),error:t.payload};case vr.types.MERGE_BASKET_VIA_CART_TOKEN.SUCCESS:case vr.types.MERGE_BASKET.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),mergeResults:t.payload.responseData};case vr.types.SET_MERGE_RESULT:return{...e,lastUpdated:le(),mergeResults:t.payload};case vr.types.CLEAR_MERGE_RESULT:return Vw;default:return e}},Xz={items:[],currentInFlightRequests:0,currentBouncedAddItemRequests:0,currentBouncedRemoveItemRequests:0,maximumInFlightRequests:0},_C=(e=[],t=[])=>{const n=new Map(e.map(o=>[o.productId,{...o,quantity:{...o.quantity}}]));for(const{productId:o,delta:r}of t){const i=(n.get(o)?.quantity?.quantityInBasket??0)+r;n.set(o,{productId:o,quantity:{maxQuantityReached:!1,quantityInBasket:Math.max(0,i)}})}return Array.from(n.values())},Zz=e=>e&&(e.currentInFlightRequests>=1||e.currentBouncedAddItemRequests>=1||e.currentBouncedRemoveItemRequests>=1),EYe=e=>e?e.currentInFlightRequests+e.currentBouncedAddItemRequests+e.currentBouncedRemoveItemRequests>1:!1,Ky=e=>{const{currentInFlightRequests:t}=e;if(t===1)return{currentInFlightRequests:0,maximumInFlightRequests:0};const n=t-1;return{...e,currentInFlightRequests:n>=0?n:0}},Jz=e=>({currentInFlightRequests:e.currentInFlightRequests+1,maximumInFlightRequests:e.maximumInFlightRequests+1}),fYe=e=>({...e,...Jz(e),currentBouncedRemoveItemRequests:0}),yYe=(e,t)=>({...e,currentBouncedRemoveItemRequests:1,items:_C(e.items,[{productId:t.productId,delta:-t.quantity}])}),IYe=(e,t)=>{const n=t?.items?.map(o=>({productId:o.productId,delta:o.quantity}))??[];return{...e,...Ky(e),items:_C(e.items,n)}},SYe=e=>({...e,...Jz(e),currentBouncedAddItemRequests:0}),CYe=(e,t)=>({...e,currentBouncedAddItemRequests:1,items:_C(e.items,[{productId:t.productId,delta:t.quantity}])}),TYe=(e,t)=>EYe(e)?{...e,...Ky(e)}:{...e,...Ky(e),items:t},_Ye=(e,t)=>{const n=t?.items?.map(o=>({productId:o.productId,delta:-o.quantity}))??[];return{...e,...Ky(e),items:_C(e.items,n)}},vYe=(e,t)=>{const n=t?.withUpdatedItemsResponse??!1,o=t?.updatedItems||[],r=t.payload.responseData;if(!r)return e;const i=ti(r)?.items?.map(aA(o||[]))||[];return n?i?.length?TYe(e,i):{...Xz}:Zz(e)?e:{...e,items:i}},AYe=(e=Xz,t)=>{switch(t.type){case Is.types.BATCH_REMOVE_BASKET_ITEM:return yYe(e,t);case Is.types.REMOVE_BASKET_ITEM.PENDING:case Is.types.REMOVE_BASKET_FREE_GIFT_ITEM.PENDING:return fYe(e);case Is.types.REMOVE_BASKET_ITEM.ERROR:case Is.types.REMOVE_BASKET_FREE_GIFT_ITEM.ERROR:return IYe(e,t);case Is.types.BATCH_ADD_BASKET_ITEM:return CYe(e,t);case Is.types.ADD_BASKET_ITEM.PENDING:case Is.types.ADD_BASKET_FREE_GIFT_ITEM.PENDING:return SYe(e);case Is.types.ADD_BASKET_ITEM.ERROR:case Is.types.ADD_BASKET_FREE_GIFT_ITEM.ERROR:return _Ye(e,t);case en.types.GET_CART.SUCCESS:case en.types.GET_CHECKOUT_CART.SUCCESS:return vYe(e,t);default:return e}},bYe={data:null,isFetching:!1,fetchError:!1,error:null,lastUpdated:null},xYe=(e=bYe,t)=>{switch(t.type){case Nc.types.GET_BASKET_PRODUCTS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Nc.types.GET_BASKET_PRODUCTS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Nc.types.GET_BASKET_PRODUCTS.SUCCESS:{const{imageFormats:n,isSEOReadableURLEnabled:o,isDynamicImagesEnabled:r}=t.transformerConfig||{};return{...e,data:t.transformerConfig?ch(t.payload.responseData,n,o,r).result:t.payload.responseData.result}}case Nc.types.SET_BASKET_FETCHING_DONE:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le()};case Is.types.EMPTY_CART.SUCCESS:return{...e,data:null};default:return e}},RYe=(e,t)=>e.some(n=>n.promoId===t.promoId)?e.map(n=>{if(n.promoId===t.promoId){const[o]=n.counters,[r]=t.counters;return{...n,counters:[{...o,productIds:[...new Set([...o.productIds,...r.productIds])]}]}}return n}):[...e,t],DYe=(e,t)=>t.reduce((n,o)=>RYe(n,o),e),OYe=ns.products.missedPromotions,PYe=(e=OYe,t)=>{switch(t.type){case Ao.types.ADD_MISSED_PROMOTIONS:return DYe(e,t.payload||[]);default:return e}},NYe=Ms({benefitGroupsAddresses:eEe,benefits:cEe,subscription:Gge,selectedSubscription:EEe,contentful:yEe}),LYe=(e,t)=>e.productId===t.productId?{...e,selected:t.selected}:e,kYe=(e,t)=>e.promotionId===t.promotionId?{...e,products:e.products.map(n=>LYe(n,t))}:e,MYe=(e,t)=>e.productGroups[0]?.freeGifts?{...e,productGroups:[{...e.productGroups[0],freeGifts:{...e.productGroups[0].freeGifts,promotions:e.productGroups[0].freeGifts.promotions?.map(n=>kYe(n,t))}}]}:e,jYe=(e=ns.checkoutWalk,t)=>{switch(t.type){case br.types.GET_CHECKOUT_WALK.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null,data:{...e.data,shouldRefetch:!1}};case br.types.GET_CHECKOUT_WALK.ERROR:return{...e,isFetching:!1,fetchError:!0};case br.types.GET_CHECKOUT_WALK.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:{...t.payload.responseData.result,shouldRefetch:!1}};case br.types.CLEAR_CHECKOUT_WALK:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:{...e.data,shouldRefetch:!0}};case br.types.TOGGLE_FREE_GIFT_SELECTED:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:{...e.data,pages:(e.data.pages||[]).map(n=>MYe(n,t.payload)),shouldRefetch:!1}};default:return e}},wd=({data:e})=>e.checkoutWalk,e4=({data:e})=>e.checkoutWalk?.data?.pages?.length||0,wYe=({data:e})=>wo(e,"checkoutWalk.data.pages[0].pageKey",null),xO=e=>e.pathname.split("/").slice(-1)[0],t4=e=>V(wd,t=>{const n=xO(e),o=t?.data?.pages?.find(r=>r.pageKey===n);if(o)return{...o,pageIndex:t.data.pages.indexOf(o)}}),FYe=()=>V(wd,e=>{const t=e.data?.pages?.find(o=>o.productGroups[0]?.freeGifts);let n=0;return t?.productGroups[0]?.freeGifts?.promotions?.reduce((o,r)=>{const a=r.products.reduce((i,l)=>(n+=1,l.selected?i+1:i),0);return{...o,availableProductsCount:n,allSelectedCount:o.allSelectedCount+a,[r.promotionId]:a}},{allSelectedCount:0,availableProductsCount:0})||{allSelectedCount:0,availableProductsCount:0}}),s4=ee("GET_FAILED_ORDER_PAYMENTS"),BYe=ee("VALIDATE_EXTERNAL_WALLET_UPDATE_PAYMENT"),UYe=ee("UPDATE_FAILED_ORDER_PAYMENT"),GYe=e=>({type:"API",payload:{options:{body:{resultToken:e},method:"POST"},pathPrefix:{client:"/api/orderpayment",server:"/core-api"},url:"/v1/update-order-payment/validate",...BYe}}),$Ye=({orderId:e,paymentMethod:t,payerForRecurringOrder:n})=>({type:"API",payload:{options:{body:JSON.stringify({orderId:e,paymentMethod:t,...n!==void 0&&{recurringOrder:{edit:{replacePayment:n}}},frontendContext:{redirectUrl:`${window.location.origin}${p2(e)}`}}),method:"POST",headers:{"content-type":"application/vnd.ocado.orderpayment.failed-payment-flow+json"}},pathPrefix:{client:"/api/orderpayment",server:"/core-api"},url:"/v1/update-order-payment",...UYe}}),HYe=e=>({type:"API",payload:{url:`/payospgateway/v1/customers/${e}/failed-payments`,service:"payospgateway",...s4}}),Vc={getFailedOrderPayments:HYe,validateUpdatePayment:GYe,updateFailedOrderPayment:$Ye,actionTypes:{GET_FAILED_ORDER_PAYMENTS:s4}},VYe=D("fppco"),n4=D("fpdev"),o4=e=>VYe(e)||n4(e),r4=(e,t)=>V(n4,WYe,(n,o)=>n?o.find(r=>r.orderId===t):void 0)(e),YYe=(e=ns.orders.failedPayments,t)=>{switch(t.type){case Vc.actionTypes.GET_FAILED_ORDER_PAYMENTS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Vc.actionTypes.GET_FAILED_ORDER_PAYMENTS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Vc.actionTypes.GET_FAILED_ORDER_PAYMENTS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),orders:t.payload.responseData.map(({updateTime:n,orderId:o,saleId:r})=>({updateTime:n,orderId:o||r}))};default:return e}},RO=({data:e})=>e.orders.failedPayments,vC=({data:e})=>e.orders.failedPayments.orders&&e.orders.failedPayments.orders.length||0,WYe=({data:e})=>e.orders.failedPayments.orders,AC=e=>V(RO,({orders:t})=>{const n=t&&t.length&&t.sort((o,r)=>Kh(o.updateTime,r.updateTime));return n&&n[0]?n[0]:null})(e),a4=e=>{const{isFetching:t}=RO(e);return!Yt(e)&&o4(e)&&vC(e)>0&&!t},qYe=e=>vC(e)?AC(e).orderId:"",bC=300,{GET_FAVORITES_CATALOGUE:KYe,GET_NEXT_FAVORITES_CATALOGUE_PAGE:zYe,GET_CROSS_SELL_PRODUCTS:QYe}=ft.types,i4=ee("HAS_FAVORITES"),l4="CLEAR_HAS_FAVORITES",XYe=e=>t=>t({type:"API",payload:{service:"customerfavorites",pathPrefix:{client:"/api/customer-favorites",server:"/core-api"},url:`/v1/customers/has-favorites?regionId=${e}`,...i4}}),ZYe=()=>e=>e({type:l4}),JYe=({category:e,filters:t,sortOption:n,isRetailerCategoryId:o,pageToken:r,transformerConfig:a,isCrossSellUpdate:i=!1,retailerCategoryId:l})=>(c,d)=>{const u=d(),m=tt.stringify({...o?{retailerCategoryId:e}:{categoryId:e},...t&&{filters:tt.stringify(t,{arrayFormat:"separator",arrayFormatSeparator:","})},sortOptionId:n,pageToken:r,tag:"web",includeAdditionalPageInfo:!r,maxProductsToDecorate:Kb(u),maxPageSize:bC},{skipEmptyString:!0});return c({type:"API",transformerConfig:a,retailerCategoryId:l,payload:{url:`/v6/product-pages/favorites?${m}`,service:"web_product_page_ws",pathPrefix:{client:"/api/webproductpagews",server:"/core-api"},...r?zYe:KYe,...i?QYe:{}}})},Sm={fetchFavorites:XYe,getPPWSFavoritesPage:JYe,clearFavorites:ZYe,actionTypes:{HAS_FAVORITES:i4,CLEAR_HAS_FAVORITES:l4}},eWe=(e=ns.favorite,t)=>{switch(t.type){case Sm.actionTypes.HAS_FAVORITES.PENDING:return{...e,isFetching:!0,fetchError:!1};case Sm.actionTypes.HAS_FAVORITES.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Sm.actionTypes.HAS_FAVORITES.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),hasFavorites:t.payload.responseData.hasFavorites};case Sm.actionTypes.CLEAR_HAS_FAVORITES:return ns.favorite;default:return e}},RXt=({data:e})=>e.favorite,tWe={},sWe=(e=tWe,t)=>{switch(t.type){case Z.actionTypes.OPEN_MODAL:{const{modalName:n,options:o}=t.payload;return{[n]:{isOpen:!0,options:o}}}case Z.actionTypes.CLOSE_MODAL:return{};default:return e}},{denormalize:nWe}=Ji,{ordersSchema:oWe}=Zi;function rWe(e,t,n){return n.indexOf(e)===t}const aWe=(e=ns.orders.past,t)=>{switch(t.type){case iu.actionTypes.GET_PAST_ORDERS.PENDING:case iu.actionTypes.GET_PAST_ORDERS_PAGE.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case iu.actionTypes.GET_PAST_ORDERS.ERROR:case iu.actionTypes.GET_PAST_ORDERS_PAGE.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case iu.actionTypes.GET_PAST_ORDERS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),retentionPeriod:t.payload.responseData.retentionPeriod,nextPageToken:t.payload.responseData.nextPageToken,orders:t.payload.responseData.result};case iu.actionTypes.GET_PAST_ORDERS_PAGE.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),retentionPeriod:t.payload.responseData.retentionPeriod,nextPageToken:t.payload.responseData.nextPageToken,orders:[...e.orders,...t.payload.responseData.result].filter(rWe)};default:return e}},c4=V(e=>e.data.orders.past,e=>e.data.orders.orderEntities,(e,t)=>{const n=nWe(e.orders,oWe,{order:t});return n.includes(void 0)?{isFetching:e.isFetching,nextPageToken:e.nextPageToken,lastUpdated:e.lastUpdated,orders:[]}:{isFetching:e.isFetching,nextPageToken:e.nextPageToken,lastUpdated:e.lastUpdated,orders:n}}),iWe=({data:e})=>e.orders.past.retentionPeriod,{denormalize:lWe}=Ji,{ordersSchema:cWe}=Zi,dWe=(e=ns.orders.all,t)=>{switch(t.type){case Af.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Af.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Af.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),fetchSuccess:!0,retentionPeriod:t.payload.responseData.retentionPeriod,orders:t.payload.responseData.result};default:return e}},d4=V(e=>e.data.orders.all,e=>e.data.orders.orderEntities,(e,t)=>{const n=lWe(e.orders,cWe,{order:t});return{...e,orderEntitiesLastUpdated:t.lastUpdated,orders:n.includes(void 0)?[]:n}}),uWe=e=>{const t=n=>Ge(n).tz(e.dates.timeZoneId).format("YYYY-MM-DDTHH:mm:ss.SSSZ");return{deliveryStartDate:t(e.dates.deliveryStartDate),deliveryEndDate:t(e.dates.deliveryEndDate),orderAvailableAfter:t(e.dates.orderAvailableAfter),timeZoneId:e.dates.timeZoneId}},pWe=e=>({definitionId:e.definitionId,definitionName:e.definitionName,referenceId:e.referenceId,cancelable:e.cancelable,addressName:e.addressName,dates:uWe(e)}),mWe=(e=[])=>e?.map(t=>pWe(t))??[],Su=e=>"orderId"in e?e?.orderId:e?.referenceId,u4=ee("GET_RECURRING_ORDER_PLACEHOLDERS"),p4=ee("CANCEL_RECURRING_ORDER_PLACEHOLDER"),hWe=()=>({type:"API",payload:{service:Wi,url:"/v2/web/definitions/upcoming-orders",pathPrefix:{client:`/api/${Wi}`,server:"/core-api"},...u4}}),gWe=(e,t)=>({type:"API",payload:{url:`/recurringshopping/v1/web/definitions/${e}/upcoming-order/${t}`,service:Wi,options:{method:"DELETE"},...p4}}),Yc={getRecurringShoppingPlaceholders:hWe,cancelRecurringOrderPlaceholder:gWe,actionTypes:{GET_RECURRING_ORDER_PLACEHOLDERS:u4,CANCEL_RECURRING_ORDER_PLACEHOLDER:p4}},EWe={...Re,data:[]},fWe=(e=EWe,t)=>{switch(t.type){case Yc.actionTypes.GET_RECURRING_ORDER_PLACEHOLDERS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Yc.actionTypes.GET_RECURRING_ORDER_PLACEHOLDERS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Yc.actionTypes.GET_RECURRING_ORDER_PLACEHOLDERS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),fetchSuccess:!0,data:mWe(t.payload.responseData)};default:return e}},yWe=({data:e})=>e.orders.recurring,m4=V(yWe,e=>e.placeholders),IWe=(e,t)=>V(m4,n=>({...n,order:n?.data?.filter(o=>o.referenceId===t)[0]}))(e),h4=ee("CANCEL_RECURRING_SHOPPING_DEFINITION"),g4=ee("GET_RECURRING_SHOPPING_DEFINITIONS"),SWe=()=>({type:"API",payload:{url:"/v2/web/definitions",pathPrefix:{client:`/api/${Wi}`,server:"/core-api"},service:Wi,...g4}}),CWe=e=>({type:"API",payload:{url:`/recurringshopping/v1/web/definitions/${e}`,service:Wi,options:{method:"DELETE"},...h4}}),Pm={cancelRecurringShoppingDefinition:CWe,getRecurringShoppingDefinitions:SWe,actionTypes:{CANCEL_RECURRING_SHOPPING_DEFINITION:h4,GET_RECURRING_SHOPPING_DEFINITIONS:g4}},TWe={...Re,data:[],error:null,currentlyEdited:null,fetchSuccess:!1},_We=(e=TWe,t)=>{switch(t.type){case Pm.actionTypes.GET_RECURRING_SHOPPING_DEFINITIONS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Pm.actionTypes.GET_RECURRING_SHOPPING_DEFINITIONS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Pm.actionTypes.GET_RECURRING_SHOPPING_DEFINITIONS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),fetchSuccess:!0,data:t.payload.responseData};default:return e}},xC=({data:e})=>e.orders.recurring.definitions,vWe=V(xC,e=>e?.data||[]),DO=e=>V(vWe,t=>t?.find(n=>n?.definitionId===e)??null),E4="SET_EDIT_RECURRING_DEFINITION_DATA",f4="SET_EDIT_RECURRING_DEFINITION_STATE",y4=ee("FETCH_EDIT_RECURRING_DEFINITION_ADDRESS_DETAILS"),I4=ee("FETCH_EDIT_RECURRING_DEFINITION_DETAILS"),S4=ee("FETCH_EDIT_RECURRING_DEFINITION_SLOTS_OFFERING"),C4=ee("UPDATE_RECURRING_DEFINITION_SLOT"),AWe=e=>({type:E4,payload:e}),bWe=e=>({type:f4,payload:e}),xWe=e=>({type:"API",payload:{url:`/v4/delivery-addresses/${e}`,service:"ecomdeliverydestinations",pathPrefix:{client:"/api/ecomdeliverydestinations",server:"/core-api"},...y4}}),RWe=e=>({type:"API",payload:{url:`/v1/web/definitions/${e}`,service:"recurringshopping",pathPrefix:{client:"/api/recurringshopping",server:"/core-api"},...I4}}),DWe=e=>({type:"API",payload:{url:`/v1/web/definitions/${e}/delivery-window/slots-offering-for-edit`,service:"recurringshopping",pathPrefix:{client:"/api/recurringshopping",server:"/core-api"},...S4}}),OWe=({definitionId:e,dayOfWeekIso:t,startTime:n,endTime:o})=>({type:"API",payload:{url:`/v1/web/definitions/${e}/delivery-window`,service:"recurringshopping",pathPrefix:{client:"/api/recurringshopping",server:"/core-api"},options:{body:{dayOfWeekIso:t,startTime:n,endTime:o},method:"PUT"},...C4}}),Bs={setEditRecurringDefinitionData:AWe,fetchEditRecurringDefinitionAddressDetails:xWe,setEditRecurringDefinitionState:bWe,fetchEditRecurringDefinitionDetails:RWe,fetchEditRecurringDefinitionSlotsOffering:DWe,updateRecurringDefinitionSlot:OWe,types:{SET_EDIT_RECURRING_DEFINITION_DATA:E4,SET_EDIT_RECURRING_DEFINITION_STATE:f4,FETCH_EDIT_RECURRING_DEFINITION_ADDRESS_DETAILS:y4,FETCH_EDIT_RECURRING_DEFINITION_DETAILS:I4,FETCH_EDIT_RECURRING_DEFINITION_SLOTS_OFFERING:S4,UPDATE_RECURRING_DEFINITION_SLOT:C4}},PWe={...Re,data:null,error:null},Yw={RECURRING_ALREADY_EXISTS:"RECURRING_ALREADY_EXISTS",NO_SLOTS:"NO_SLOTS"},NWe=(e=PWe,t)=>{switch(t.type){case Bs.types.SET_EDIT_RECURRING_DEFINITION_DATA:return t.payload?{...e,data:{...e.data,...t.payload}}:{...e,data:null};case Bs.types.SET_EDIT_RECURRING_DEFINITION_STATE:return{...e,...t.payload};default:return e}},T4="SHOW_RECURRING_ORDER_CREATED_NOTIFICATION",_4="HIDE_RECURRING_ORDER_CREATED_NOTIFICATION",LWe=e=>({type:T4,payload:{name:e}}),kWe=()=>({type:_4}),zy={showRecurringOrderCreatedNotification:LWe,hideRecurringOrderCreatedNotification:kWe,types:{SHOW_RECURRING_ORDER_CREATED_NOTIFICATION:T4,HIDE_RECURRING_ORDER_CREATED_NOTIFICATION:_4}},Ww={showRecurringOrderCreatedNotification:!1},MWe=(e=Ww,t)=>{switch(t.type){case zy.types.SHOW_RECURRING_ORDER_CREATED_NOTIFICATION:return{...e,showRecurringOrderCreatedNotification:!0,name:t.payload.name};case zy.types.HIDE_RECURRING_ORDER_CREATED_NOTIFICATION:return Ww;default:return e}},jWe=e=>e.data.orders.recurring.notifications,v4=ee("GET_PRIMARY_SUGGESTIONS"),A4=ee("GET_REFINED_SUGGESTIONS"),b4=ee("GET_FOLLOW_ON_SUGGESTIONS"),x4="LOAD_SMART_SEARCH_SUGGESTIONS",wWe="SET_DISPLAYED_SUGGESTIONS_TYPE",R4="SET_ITEM_ADDED_TO_BASKET",OO=e=>({url:`/v1/${e}`,service:"websearchconfigws",pathPrefix:{client:"/api/search",server:"/core-api"}}),FWe=({searchTerm:e="",limit:t=2e4,maxSuggestionsToDisplay:n=10,regionId:o})=>({type:"API",payload:{...OO(`suggestions/primary?searchTerm=${e}&limit=${t}&regionId=${o}`),...v4},maxSuggestionsToDisplay:n}),BWe=(e,t,n=10)=>({type:"API",payload:{...OO(`suggestions/refined?searchTerm=${e}&limit=${n}&regionId=${t}`),...A4}}),UWe=(e,t,n=10)=>({type:"API",payload:{...OO(`suggestions/follow-on?searchTerm=${e}&limit=${n}&regionId=${t}`),...b4}}),GWe=e=>({type:R4,payload:{itemAddedToBasket:e}}),$We=e=>({type:x4,payload:{data:e}}),Tr={getPrimarySuggestions:FWe,getRefinedSuggestions:BWe,getFollowOnSuggestions:UWe,loadSmartSearchSuggestions:$We,updateItemAddedToBasket:GWe,actionTypes:{GET_PRIMARY_SUGGESTIONS:v4,GET_REFINED_SUGGESTIONS:A4,GET_FOLLOW_ON_SUGGESTIONS:b4,LOAD_SMART_SEARCH_SUGGESTIONS:x4,SET_DISPLAYED_SUGGESTIONS_TYPE:wWe,SET_ITEM_ADDED_TO_BASKET:R4}},HWe="FOLLOW_ON_SEARCH_SUGGESTION",VWe="REFINED_SEARCH_SUGGESTION",OA=e=>e?.itemAddedToBasket?[HWe,e.followOn]:[VWe,e.refined],YWe=ns.search.suggestions,WWe=e=>e.type===mn,qWe=(e=YWe,t)=>{if(WWe(t))return{...e,isSearchPage:t.payload.location.pathname.endsWith("search")};switch(t.type){case Tr.actionTypes.GET_REFINED_SUGGESTIONS.PENDING:case Tr.actionTypes.GET_FOLLOW_ON_SUGGESTIONS.PENDING:case Tr.actionTypes.GET_PRIMARY_SUGGESTIONS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Tr.actionTypes.GET_PRIMARY_SUGGESTIONS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Tr.actionTypes.GET_PRIMARY_SUGGESTIONS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:t.payload.responseData};case Tr.actionTypes.SET_ITEM_ADDED_TO_BASKET:return e.smartSearchSuggestions?{...e,smartSearchSuggestions:{...e.smartSearchSuggestions,itemAddedToBasket:t.payload.itemAddedToBasket}}:e;case Tr.actionTypes.LOAD_SMART_SEARCH_SUGGESTIONS:return{...e,lastUpdated:le(),isFetching:!1,smartSearchSuggestions:t.payload.data};case Is.types.ADD_BASKET_ITEM.SUCCESS:return e.isSearchPage&&e.smartSearchSuggestions?{...e,smartSearchSuggestions:{...e.smartSearchSuggestions,itemAddedToBasket:!0}}:e;default:return e}},D4=({data:e})=>e.search.suggestions,PO=({data:e})=>e.search.suggestions.smartSearchSuggestions,O4=ee("GET_SEARCH_REDIRECTS"),P4="SET_SEARCH_REDIRECT_URL",N4="CLEAR_SEARCH_REDIRECT_URL",KWe=e=>({type:"API",payload:{service:"websearchconfigws",pathPrefix:{client:"/api/search",server:"/core-api"},url:`/v1/redirects/active?regionId=${e}`,...O4}}),zWe=(e,t)=>({type:P4,payload:{redirectURL:e,redirectSearchTerm:t}}),QWe=()=>({type:N4}),Cu={getSearchRedirects:KWe,setSearchRedirectUrl:zWe,clearSearchRedirectUrl:QWe,actionTypes:{GET_SEARCH_REDIRECTS:O4,SET_SEARCH_REDIRECT_URL:P4,CLEAR_SEARCH_REDIRECT_URL:N4}},XWe={...Re,data:[],redirectURL:null,redirectSearchTerm:null},ZWe=(e=XWe,t)=>{switch(t.type){case Cu.actionTypes.GET_SEARCH_REDIRECTS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Cu.actionTypes.GET_SEARCH_REDIRECTS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Cu.actionTypes.GET_SEARCH_REDIRECTS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:t.payload.responseData};case Cu.actionTypes.SET_SEARCH_REDIRECT_URL:return{...e,redirectURL:t.payload.redirectURL,redirectSearchTerm:t.payload.redirectSearchTerm};case Cu.actionTypes.CLEAR_SEARCH_REDIRECT_URL:return{...e,redirectURL:null};default:return e}},L4=({data:e})=>e.search.redirects.data,JWe=Ms({suggestions:qWe,analytics:Uxe,redirects:ZWe}),k4=ee("GET_INSTANT_SHOP_AVAILABILITY"),M4=ee("ADD_INSTANT_SHOP_PRODUCTS"),eqe=()=>({type:"API",payload:{url:"/v1/instant-shop",pathPrefix:{client:"/api/cart",server:"/core-api"},service:"web_basket_ws",...k4}}),tqe=()=>({type:"API",payload:{url:"/v2/instant-shop",pathPrefix:{client:"/api/cart",server:"/core-api"},service:"web_basket_ws",options:{body:{},method:"POST"},...M4}}),Qy={getInstantShopAvailability:eqe,addInstantShopProductsToBasket:tqe,types:{GET_INSTANT_SHOP_AVAILABILITY:k4,ADD_INSTANT_SHOP_PRODUCTS:M4}},sqe={...Re,available:!1},nqe=(e=sqe,t)=>{switch(t.type){case Qy.types.GET_INSTANT_SHOP_AVAILABILITY.ERROR:return{...e,isFetching:!1,fetchError:!0,lastUpdated:le(),error:t.payload};case Qy.types.GET_INSTANT_SHOP_AVAILABILITY.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),available:!!t.payload.responseData?.available};default:return e}},RC=({data:e})=>!!e.instantShop?.available,NO=ee("GET_ORDER"),j4=ee("EDIT_ORDER"),oqe=ee("CANCEL_ORDER"),w4=ee("CANCEL_ORDER_CHANGES"),rqe=ee("CHANGE_ORDER_STATUS"),aqe=e=>({type:"API",payload:{url:`/v6/orders/${e}`,service:"web_order_ws",pathPrefix:{client:"/api/order",server:"/core-api"},...NO}}),iqe=e=>({type:"API",payload:{url:`/v6/orders/${e}/decorated`,service:"web_order_ws",pathPrefix:{client:"/api/order",server:"/core-api"},...NO}}),lqe=(e,t)=>({type:"API",payload:{url:"/v2/sessions/order-edit",service:"customersessions",pathPrefix:{client:"/api/customersessions",server:"/core-api"},options:{method:"POST",body:{orderId:e,regionId:t}},...j4}}),cqe=(e,t)=>({type:"API",payload:{url:`/v2/sessions/order-edit/${e}?regionId=${t}`,service:"customersessions",pathPrefix:{client:"/api/customersessions",server:"/core-api"},options:{method:"DELETE"},...w4}}),dqe=e=>({type:"API",payload:{url:`/v6/orders/${e}/cancel`,service:"web_order_ws",pathPrefix:{client:"/api/order",server:"/core-api"},options:{method:"PUT"},...oqe}}),uqe=e=>e(jt()),ta={getOrder:aqe,getDecoratedOrder:iqe,editOrder:lqe,cancelOrderChanges:cqe,cancelOrder:dqe,saveChanges:uqe,actionTypes:{GET_ORDER:NO,EDIT_ORDER:j4,CANCEL_ORDER_CHANGES:w4,CHANGE_ORDER_STATUS:rqe}},pqe={isFetching:!1,fetchError:!1,lastUpdated:null,order:null,error:null},mqe=(e=pqe,t)=>{switch(t.type){case ta.actionTypes.GET_ORDER.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case ta.actionTypes.GET_ORDER.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case ta.actionTypes.GET_ORDER.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),order:t.payload.responseData.result};default:return e}},DC="refunds",F4=ee("CALCULATE_SELECTED_ITEMS"),B4="CLEAR_SELECTED_ITEMS",hqe=(e,t)=>({type:"API",payload:{url:`/refunds/v6/order-refund-request-summary-view?locale=${t}`,options:{method:"POST",body:e},service:DC,...F4}}),gqe=()=>({type:B4}),VE={calculateSelectedItems:hqe,clearSelectedItems:gqe,actionTypes:{CALCULATE_SELECTED_ITEMS:F4,CLEAR_SELECTED_ITEMS:B4}},Eqe=(e=ns.orders.current.refunds.summary,t)=>{switch(t.type){case VE.actionTypes.CALCULATE_SELECTED_ITEMS.SUCCESS:return{...t.payload.responseData,isFetching:!1,fetchError:!1,error:null};case VE.actionTypes.CALCULATE_SELECTED_ITEMS.PENDING:return{...Cf,isFetching:!0,fetchError:!1,error:null};case VE.actionTypes.CALCULATE_SELECTED_ITEMS.ERROR:return{...Cf,isFetching:!1,fetchError:!0,error:t.payload};case VE.actionTypes.CLEAR_SELECTED_ITEMS:return Cf;default:return e}},U4=ee("GET_CREATED_REFUND_REQUEST_VIEW"),fqe=(e,t)=>({type:"API",payload:{url:`/refunds/v4/orders/${e}/created-refund-requests-view?locale=${t}`,service:DC,...U4}}),Nm={fetchCreatedRefundRequest:fqe,actionTypes:{GET_CREATED_REFUND_REQUEST_VIEW:U4}},yqe=(e=ns.orders.current.refunds.createdRefundRequest,t)=>{switch(t.type){case Nm.actionTypes.GET_CREATED_REFUND_REQUEST_VIEW.SUCCESS:return{...t.payload.responseData,isFetching:!1,fetchError:!1,error:null};case Nm.actionTypes.GET_CREATED_REFUND_REQUEST_VIEW.PENDING:return{...nA.createdRefundRequest,isFetching:!0,fetchError:!1,error:null};case Nm.actionTypes.GET_CREATED_REFUND_REQUEST_VIEW.ERROR:return{...nA.createdRefundRequest,isFetching:!1,fetchError:!0,error:t.payload};default:return e}},G4=ee("GET_NEW_REFUND_REQUEST_VIEW"),$4="UPDATE_ITEM",Iqe=(e,t)=>({type:"API",payload:{url:`/refunds/v4/orders/${e}/new-refund-request-view?locale=${t}`,...G4,service:DC}}),Sqe=(e,t,n)=>({type:$4,payload:{itemId:e,quantity:t,refundReason:n}}),YE={fetchNewRefundRequestView:Iqe,updateItem:Sqe,actionTypes:{GET_NEW_REFUND_REQUEST_VIEW:G4,UPDATE_ITEM:$4}},Cqe=(e,t)=>{const{itemId:n,quantity:o,refundReason:r}=t;return e.map(a=>{const i=a;return a.itemId===n&&(i.selectedQuantity=o,i.selectedRefundReason=r),i})},Tqe=(e=ns.orders.current.refunds.newRefundRequest,t)=>{switch(t.type){case YE.actionTypes.GET_NEW_REFUND_REQUEST_VIEW.PENDING:return{isFetching:!0,fetchError:!1,error:null};case YE.actionTypes.GET_NEW_REFUND_REQUEST_VIEW.ERROR:return{isFetching:!1,fetchError:!0,error:t.payload};case YE.actionTypes.GET_NEW_REFUND_REQUEST_VIEW.SUCCESS:return{...t.payload.responseData,isFetching:!1,fetchError:!1,error:null};case YE.actionTypes.UPDATE_ITEM:return{...e,availableItems:Cqe(e.availableItems,t.payload)};default:return e}},H4=ee("PLACE_REFUND_REQUEST"),_qe=(e,t)=>({type:"API",payload:{url:`/refunds/v4/orders/${e}/refund-requests`,options:{method:"POST",body:t},service:DC,...H4}}),N_={placeRefundRequest:_qe,actionTypes:{PLACE_REFUND_REQUEST:H4}},{placeRefundRequest:vqe}=ns.orders.current.refunds,Aqe=(e=vqe,t)=>{switch(t.type){case N_.actionTypes.PLACE_REFUND_REQUEST.PENDING:return{isFetching:!0,fetchError:!1,error:null};case N_.actionTypes.PLACE_REFUND_REQUEST.ERROR:return{isFetching:!1,fetchError:!0,error:t.payload};case N_.actionTypes.PLACE_REFUND_REQUEST.SUCCESS:return{...t.payload.responseData,isFetching:!1,fetchError:!1,error:null};default:return e}},bqe=Ms({summary:Eqe,createdRefundRequest:yqe,newRefundRequest:Tqe,placeRefundRequest:Aqe}),V4=ee("GET_LOYALTY_SETTINGS"),xqe=()=>nz({url:"/v1/web/loyalty/configurations/latest/display-type",...V4}),Of={getLoyaltySettings:xqe,actionTypes:{GET_LOYALTY_SETTINGS:V4}},Rqe={error:null,fetchError:!1,isFetching:!1,lastUpdated:null,data:null},Dqe={error:null,fetchError:!1,isFetching:!1,lastUpdated:null,lastModified:null,balance:null,registered:!1},Oqe={error:null,fetchError:!1,isFetching:!1,lastUpdated:null,data:null},Pqe=(e=Rqe,t)=>{switch(t.type){case Of.actionTypes.GET_LOYALTY_SETTINGS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Of.actionTypes.GET_LOYALTY_SETTINGS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Of.actionTypes.GET_LOYALTY_SETTINGS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:t.payload.responseData};default:return e}},LO=({data:e})=>wo(e,"loyaltySettings.data.loyaltyDisplayType",null),Nqe=(e=Dqe,t)=>{switch(t.type){case Fu.actionTypes.GET_CUSTOMER_LOYALTY.PENDING:return{...e,isFetching:!0,fetchError:!1};case Fu.actionTypes.GET_CUSTOMER_LOYALTY.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Fu.actionTypes.GET_CUSTOMER_LOYALTY.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),balance:t.payload.responseData.balance,registered:t.payload.responseData.registered};default:return e}},OC=({data:e})=>e.customer.loyalty,bh=e=>OC(e).balance,Lqe=e=>OC(e).isFetching,PC=e=>!!OC(e).registered,kqe=e=>bh(e)?.units!==void 0&&PC(e),Y4=ee("GET_APPLICABLE_LOYALTY"),Mqe=()=>({type:"API",payload:{pathPrefix:{client:"/api/cart",server:"/core-api"},service:"web_basket_ws",url:"/v1/carts/active/applicable-loyalty",...Y4}}),Pf={getApplicableLoyalty:Mqe,actionTypes:{GET_APPLICABLE_LOYALTY:Y4}},jqe=D("loy.waon"),wqe=(e=Oqe,t)=>{switch(t.type){case Pf.actionTypes.GET_APPLICABLE_LOYALTY.PENDING:return{...e,isFetching:!0,fetchError:!1};case Pf.actionTypes.GET_APPLICABLE_LOYALTY.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Pf.actionTypes.GET_APPLICABLE_LOYALTY.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:t.payload.responseData};default:return e}},Br=({data:e})=>e.applicableLoyalty.data,W4=V(Br,e=>e),q4=({data:e})=>e.applicableLoyalty.isFetching,K4=({data:e})=>e.applicableLoyalty.fetchError,NC=V(Br,e=>e?.unusedUnitsReason),Og=V(Br,e=>e&&e.balance),z4=V(Br,e=>e?.minSpend),Fqe=V(Br,e=>e?.minSpendShortfall),PA=V(Br,e=>e?.redeemable||null),kO=V(Og,e=>e?.units||0),Q4=V(z4,e=>e?.units||0),MO=V(PA,e=>e?.units||0),Bqe=V(jqe,MO,kO,(e,t,n)=>e?n>0:t>0),Uqe=V(NC,e=>e==="BALANCE_BELOW_MIN"),Gqe=V(NC,e=>e==="APPLICABLE_ITEMS_BELOW_MIN"),$qe=V(NC,e=>e==="UNAPPLICABLE_ITEMS_RESTRICTED"),Hqe=V(Q4,kO,(e,t)=>e===0?0:t<e?t/e:1),Vqe=V(MO,kO,(e,t)=>e>0&&e<t),Yqe=V(NC,e=>!e||!["BALANCE_ZERO","APPLICABLE_ITEMS_BELOW_MIN","BALANCE_BELOW_MIN"].includes(e)),Wqe=V(Br,e=>e?.spendIncrementStep);V(Br,e=>e?.orderOfferedPrice);const qqe=V(Br,e=>e?.spendConversionRate),Kqe=V(Br,e=>e?.maxSpend),zqe=V(Br,e=>e?.amountToBePaidByCustomer),Qqe=V(Kqe,e=>e?.units||0),Xqe=V(Br,e=>e?.minMonetarySpend),Zqe=V(Br,e=>e?.leftToSpend?.units),X4=ee("GET_DRAFT_BASKET"),Z4=ee("ADD_ITEMS_DRAFT_BASKET"),J4=ee("REMOVE_ITEMS_DRAFT_BASKET"),Jqe=e=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:`/v1/carts/${e}`,...X4}}),eKe=({draftBasketId:e,items:t})=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:`/v1/carts/${e}/add-items`,options:{body:t,method:"POST"},...Z4}}),tKe=({draftBasketId:e,items:t})=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:`/v1/carts/${e}/remove-items`,options:{body:t,method:"POST"},...J4}}),Yr={getDraftBasket:Jqe,addItemsToDraftBasket:eKe,removeItemsFromDraftBasket:tKe,types:{GET_DRAFT_BASKET:X4,ADD_ITEMS_DRAFT_BASKET:Z4,REMOVE_ITEMS_DRAFT_BASKET:J4}},sKe=(e=Do,t)=>{switch(t.type){case Yr.types.GET_DRAFT_BASKET.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Yr.types.GET_DRAFT_BASKET.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Yr.types.GET_DRAFT_BASKET.SUCCESS:{if(!t.payload?.responseData)return{...Do,isFetching:!1,fetchError:!0,error:new Error("No cart data"),lastUpdated:le()};const o=ti(t.payload.responseData);return{...Do,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),...o}}case Yr.types.ADD_ITEMS_DRAFT_BASKET.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Yr.types.ADD_ITEMS_DRAFT_BASKET.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Yr.types.ADD_ITEMS_DRAFT_BASKET.SUCCESS:{const n=t.payload?.responseData?.basketUpdateResult;if(!n)return{...Do,isFetching:!1,fetchError:!0,error:new Error("No cart data"),lastUpdated:le()};const o=ti(n);return{...Do,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),...o}}case Yr.types.REMOVE_ITEMS_DRAFT_BASKET.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Yr.types.REMOVE_ITEMS_DRAFT_BASKET.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Yr.types.REMOVE_ITEMS_DRAFT_BASKET.SUCCESS:{const n=t.payload?.responseData?.basketUpdateResult;if(!n)return{...Do,isFetching:!1,fetchError:!0,error:new Error("No cart data"),lastUpdated:le()};const o=ti(n);return{...Do,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),...o}}default:return e}},e3="UPDATE_ADD_ADDRESS_ORIGIN",nKe=e=>({type:e3,payload:{origin:e}}),t3={types:{UPDATE_ADD_ADDRESS_ORIGIN:e3},updateAddAddressOrigin:nKe},oKe=(e="",t)=>{switch(t.type){case t3.types.UPDATE_ADD_ADDRESS_ORIGIN:return t.payload.origin;default:return e}},s3=e=>e?.control?.addAddressOrigin,n3=e=>s3(e)||Na(),rKe=e=>s3(e)===Na(),o3=ee("VALIDATE_ADDRESS"),aKe=e=>({type:"API",payload:{url:"/v2/addresses",service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},options:{method:"PUT",body:e},...o3}}),Nf={types:{VALIDATE_ADDRESS:o3},validateAddress:aKe},qw={...ns.customer.addressValidation},iKe=(e=ns.customer.addressValidation,t)=>{switch(t.type){case Nf.types.VALIDATE_ADDRESS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,data:t.payload.responseData};case Nf.types.VALIDATE_ADDRESS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null,data:qw};case Nf.types.VALIDATE_ADDRESS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload.responseData,data:qw};default:return e}},lKe=({data:e})=>e.customer.addressValidation.data,r3=ee("FETCH_CUSTOMER_ADDRESS_DETAILS"),cKe=e=>({type:"API",payload:{url:`/v2/accounts/current/addresses/${e}`,service:"web_customer_ws",pathPrefix:{client:"/api/customer",server:"/core-api"},...r3}}),Lm={types:{FETCH_CUSTOMER_ADDRESS_DETAILS:r3},fetchCustomerAddressDetails:cKe},dKe=e=>{const t={...e,formattedAddress:e.address};return delete t.address,t},uKe=(e=ns.customer.addressDetails,t)=>{switch(t.type){case Lm.types.FETCH_CUSTOMER_ADDRESS_DETAILS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,data:dKe(t.payload.responseData)};case Lm.types.FETCH_CUSTOMER_ADDRESS_DETAILS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null,data:null};case Lm.types.FETCH_CUSTOMER_ADDRESS_DETAILS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload,data:null};default:return e}},pKe=({data:e})=>e?.customer?.addressDetails?.data||{formattedAddress:""},a3=ee("FETCH_NEW_ADDRESS_FIELDS"),mKe=(e,t)=>{const n=new URLSearchParams;return e&&n.append("areaLookupId",e),t&&n.append("formVersion",t),{type:"API",payload:{url:`/v1/address-form${n.toString()?`?${n.toString()}`:""}`,service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},...a3}}},Wc={types:{FETCH_NEW_ADDRESS_FIELDS:a3},fetchNewAddressFields:mKe},{addressFields:i3}=ns.customer,{formSection:Kw}=i3;function hKe(e=i3,t){switch(t.type){case Wc.types.FETCH_NEW_ADDRESS_FIELDS.SUCCESS:return{...e,fetchError:!1,isFetching:!1,formSection:t.payload.responseData};case Wc.types.FETCH_NEW_ADDRESS_FIELDS.PENDING:return{...e,fetchError:!1,isFetching:!0,formSection:Kw};case Wc.types.FETCH_NEW_ADDRESS_FIELDS.ERROR:return{...e,isFetching:!1,fetchError:!0,formSection:Kw};default:return e}}const l3=e=>e.data.retailer.addressFields,gKe=e=>l3(e).formSection.fields,EKe=e=>l3(e).isFetching,fKe={...Re,fetchError:!1,isFetching:!1,error:null,preferences:{preferences:[],sections:[]}},yKe=(e=fKe,t)=>{switch(t.type){case"GET_MARKETING_PREFERENCES_PENDING":return{...e,isFetching:!0,fetchError:!1};case"GET_MARKETING_PREFERENCES_SUCCESS":return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),preferences:SKe(t.payload.responseData)};case"GET_MARKETING_PREFERENCES_ERROR":return{...e,isFetching:!1,fetchError:!0,error:t.payload};default:return e}},IKe=({data:e})=>e.customer.marketingPreferences,SKe=({sections:e,...t})=>{const n=e.flatMap(r=>r.groups).flatMap(r=>r.preferences),o=e.map(r=>({...r,footers:r.footers.filter(a=>a.headerText||a.descriptionText)}));return{preferences:n,sections:o,...t}},CKe={"raw-produce-segregation":"rawProduceSegregation"},zw={ERROR:"error",SUCCESS:"success"},TKe={preferences:{},...Re,error:null},_Ke=(e=TKe,t)=>{switch(t.type){case"GET_DELIVERY_PREFERENCES_PENDING":return{...e,isFetching:!0,fetchError:!1};case"GET_DELIVERY_PREFERENCES_SUCCESS":{const{preferenceKey:n,preferenceValue:o}=t.payload.responseData,r=CKe[n],a={preferenceKey:n,preferenceValue:o==="true"};return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),preferences:{...!!r&&{[r]:a}}}}case"GET_DELIVERY_PREFERENCES_ERROR":return{...e,isFetching:!1,fetchError:!0,error:t.payload};default:return e}},vKe=({data:e})=>e.customer.deliveryPreferences,AKe=e=>{if(!e)return null;switch(e.toUpperCase()){case gr.AMEX:case gr.AMERICAN_EXPRESS:return Gt.AMEX;case gr.CB:return"carte_bancaire";case gr.DISCOVER:return"discover";case gr.MAESTRO:return"maestro";case gr.MASTERCARD:case gr.MASTERCARD_DEBIT:return Gt.MASTERCARD;case gr.VISA:case gr.VISA_DEBIT:case gr.VISA_ELECTRON:case gr.VISA_PURCHASING:return Gt.VISA;case gr.PAYMENT_CARD:return Gt.PAYMENT_CARD;case gr.VISA_PHONE:return Gt.VISA_PHONE;default:return null}},c3=({cardType:e,paymentMethod:t})=>{const n=AKe(e);if(n)return n;switch(t){case at.PAYPAL:return Gt.PAYPAL;case at.APPLE_PAY:return Gt.APPLE_PAY;case at.GOOGLE_PAY:return Gt.GOOGLE_PAY;case at.VISA_MOBILE:return Gt.VISA_PHONE;case at.INVOICE:return Gt.INVOICE;case at.BANK_TRANSFER:return Gt.BANK_TRANSFER;case at.BLIK:return Gt.BLIK;case at.L_PAY:return Gt.L_PAY;case at.CARD_INSTALMENTS:return Gt.SMARTNEY;case at.NAVERPAY:return Gt.NAVERPAY;case at.KAKAOPAY:return Gt.KAKAOPAY;default:return Gt.PAYMENT_CARD}},Xy="pspweb",jO=ee("GET_PSP_FRAME_URL"),d3=ee("CREATE_WALLET_ITEM"),bKe=e=>({type:"API",payload:{service:Xy,url:`/${Xy}/v1/wallet-items`,options:{method:"POST",body:{resultToken:e}},...d3}}),xKe=(e,t="")=>({type:"API",payload:{url:`/v2/wallet/${e}/create-url${t?`?${t}`:""}`,...jO}}),RKe=({url:e})=>({type:"API",payload:{service:Xy,url:`/${Xy}/v1/wallet-items/creation-sessions`,options:{method:"POST",body:{requestOriginSource:{platform:"WEB",url:e}}},...jO}}),wO={getPspFrameUrl:xKe,createWalletItemCreationSession:RKe,createWalletItem:bKe,types:{GET_PSP_FRAME_URL:jO,CREATE_WALLET_ITEM:d3}},u3="UPDATE_DEFAULT_WALLET_ITEM",DKe=e=>({type:u3,payload:{walletItemId:e}}),p3={updateDefaultWalletItem:DKe,types:{UPDATE_DEFAULT_WALLET_ITEM:u3}},m3=ee("GET_WALLET_ITEMS"),Qw="walletservice",OKe=e=>({type:"API",payload:{service:Qw,url:`/${Qw}/v3/wallet-items?${tt.stringify({customerId:e})}`,...m3}}),Lf={getWalletItems:OKe,types:{GET_WALLET_ITEMS:m3}},PKe=({cardNumber:e,cardType:t,paymentMethod:n,...o})=>({lastFourDigits:e&&e.length>=4?e.slice(-4):"",cardTypeDisplayName:c3({cardType:t,paymentMethod:n}),cardNumber:e,cardType:t,...o}),Xw=({walletItemId:e,fundingInstrumentId:t,defaultWalletItem:n,paymentMethodType:o,details:r,expired:a})=>({walletItemId:e,fundingInstrumentId:t,isDefault:n,paymentMethodGroup:ct.PAY_NOW,paymentMethod:o,details:PKe({...r,paymentMethod:o}),expired:a}),NKe=(e,t)=>({...e,items:[t,...e.items.map(n=>({...n,isDefault:n.isDefault&&!t.isDefault}))]}),LKe=(e,t)=>({...e,items:e.items.map(n=>({...n,isDefault:n.walletItemId===t}))}),kKe=(e=ns.wallet,t)=>{switch(t.type){case Lf.types.GET_WALLET_ITEMS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Lf.types.GET_WALLET_ITEMS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Lf.types.GET_WALLET_ITEMS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),items:t.payload.responseData.map(Xw)};case p3.types.UPDATE_DEFAULT_WALLET_ITEM:return LKe(e,t.payload.walletItemId);case DA.actionTypes.SUBMIT_ADD_CARD_REFERENCE.SUCCESS:case wO.types.CREATE_WALLET_ITEM.SUCCESS:return NKe(e,Xw(t.payload.responseData));default:return e}},Pg=({data:e})=>e.customer.wallet,MKe=(e=ns.wallet,t)=>{switch(t.type){case ph.types.REMOVE_WALLET_ITEM.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case ph.types.REMOVE_WALLET_ITEM.SUCCESS:return{...e,items:e.items.filter(n=>n.walletItemId!==t.id)};default:return e}},h3=ee("GET_PROMOTION_DETAILS"),g3=ee("GET_PROMOTION_IDS"),{GET_CATALOGUE:jKe,GET_PROMOTION_CATALOGUE:wKe,GET_NEXT_CATALOGUE_PAGE:FKe,GET_NEXT_PROMOTION_CATALOGUE_PAGE:BKe}=ft.types,UKe=(e,t,n,o,r,a)=>{const i=tt.stringify({sortOptionId:r,category:a});return{type:"API",payload:{url:t?`/v4/promotion/retailer-id/${e}?${i}`:`/v4/promotion/${e}?${i}`,service:"web_product_page_ws",pathPrefix:{client:"/api/webproductpagews",server:"/core-api"},...h3},isDynamicIamgesEnabled:n,imageFormats:o}},GKe=e=>({type:"API",payload:{url:`/v1/seo/offer?id=${e}`,...g3}}),$Ke=(e,t,n,o,r)=>a=>a({type:"API",payload:{url:`/v6/products/promotions?${bx({category:e,filters:t,sortOption:n,pageToken:o,isRetailerCategoryId:r})}`,...o?FKe:jKe}}),HKe=(e,t,n,o,r,a)=>(i,l)=>{const c=l(),d=tt.stringify({regionId:hn(c),...a?{retailerCategoryId:t}:{categoryId:t},filters:tt.stringify(n,{arrayFormat:"separator",arrayFormatSeparator:","}),sortOptionId:o,pageToken:r,includeAdditionalPageInfo:!r,maxProductsToDecorate:Kb(c),maxPageSize:bC},{skipEmptyString:!0});return i({type:"API",payload:{url:`/v1/pages/promotions?${d}`,service:"productquerylayer",pathPrefix:{client:"/api/product-listing-pages",server:"/core-api"},...r?BKe:wKe},transformerConfig:e})},Li={getPromotionDetails:UKe,getPromotionIds:GKe,getPQLPromotionsPage:HKe,getPromotionsPage:$Ke,actionTypes:{GET_PROMOTION_DETAILS:h3,GET_PROMOTION_IDS:g3}},VKe=(e,t,n)=>({...e,products:e.products.map(o=>tl(o,n,t))}),YKe=e=>e.map(({sortOptionId:t,messageKey:n,selected:o})=>({id:t,messageKey:n,selected:o})),FO=(e,t,n)=>{const o={promotionPageType:e.promotionPageType,breadcrumbs:e.breadcrumbs,sortOptions:YKe(e.sortOptions),promoId:e.promoId,description:e.description,longDescription:e.longDescription,retailerPromotionId:e.retailerPromotionId,promotionGroups:e.promotionGroups.map(r=>VKe(r,t,n)),presentationMode:e.presentationMode,missedPromotions:e.missedPromotions};return b$(o,Q0)},WKe=ns.products.offers,qKe=(e=WKe,t)=>{switch(t.type){case Li.actionTypes.GET_PROMOTION_DETAILS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Li.actionTypes.GET_PROMOTION_DETAILS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Li.actionTypes.GET_PROMOTION_DETAILS.SUCCESS:{const{payload:n,isDynamicImagesEnabled:o,imageFormats:r}=t,a=n.responseData,i=FO(a,o,r);return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:i.result}}case Li.actionTypes.GET_PROMOTION_IDS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Li.actionTypes.GET_PROMOTION_IDS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Li.actionTypes.GET_PROMOTION_IDS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:{...e.data,promoId:t.payload.responseData.id,retailerPromotionId:t.payload.responseData.retailerId,description:t.payload.responseData.encodedName}};default:return e}},DXt=({data:e})=>e.products.offers.data,OXt=({data:e})=>e.products.offers.isFetching,PXt=({data:e})=>e.products.offers.error,kf=ee("GET_SHOP_IN_SHOP"),KKe="RESET_SHOP_IN_SHOP",NXt=e=>({type:"API",pageId:e,payload:{url:`/v1/shop-in-shop/${e}`,...kf}}),LXt=()=>({type:KKe}),zKe=(e=ns.shopInShop,t)=>{switch(t.type){case kf.PENDING:return{...e,isFetching:!0,fetchError:void 0};case kf.ERROR:return{...e,isFetching:!1,fetchError:t.payload,pageId:t.pageId};case kf.SUCCESS:return{...e,isFetching:!1,fetchError:void 0,id:t.payload?.responseData?.id,name:t.payload?.responseData?.name,label:t.payload?.responseData?.label,images:t.payload?.responseData?.images,contentFormat:t.payload?.responseData?.contentFormat,componentItems:t.payload?.responseData?.componentItems,html:t.payload?.responseData?.html,productIds:t.payload?.responseData?.productIds,pageId:t.pageId};default:return e}},kXt=e=>e.data.shopInShop,E3=ee("GET_RECOMMENDED_PRODUCTS"),QKe="web_product_page_ws",XKe=()=>({type:"API",payload:{url:"/webproductpagews/v5/products/recommendations/promotions",service:QKe,...E3}}),L_={types:{GET_RECOMMENDED_PRODUCTS:E3}},ZKe=Re,JKe=(e=ZKe,t)=>{switch(t.type){case L_.types.GET_RECOMMENDED_PRODUCTS.PENDING:return{...e,data:void 0,isFetching:!0,fetchError:!1,error:null};case L_.types.GET_RECOMMENDED_PRODUCTS.ERROR:return{...e,data:void 0,isFetching:!1,fetchError:!0,error:t.payload};case L_.types.GET_RECOMMENDED_PRODUCTS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:t.payload.responseData,lastUpdated:le()};default:return e}},eze=({data:e})=>e.shopperOptimisations.recommendations,tze={recommendedProductsReducer:JKe},sze=e=>({type:"regular",name:"fop.headertitle.regulars",clusterBreadcrumbs:[],additionalProductAttributes:[{}],products:[e]}),nze=(e,t)=>({...e,products:[...e.products,t]}),oze=e=>e.products.length>0?e:void 0,rze=e=>{const n=[...e].find(o=>o.type==="regular");if(n)return oze(n)},aze=(e,t)=>{if(e)return{...e,products:[...e.products.filter(n=>n!==t)]}},ize=(e,t)=>e.map(n=>{if(n.productId!==t.productId)return n;const{productId:o,frequency:r,quantity:a}=t;return{productId:o,frequency:r,quantity:a}});function lze(e){return e.map(t=>t.productId)}function cze(e,t){return Object.values(e).reduce((n,o)=>{const{quantity:r,frequency:a}=t.find(i=>i.productId===o.productId);return{...n,[o.productId]:{...o,regular:{quantity:r,frequency:a}}}},{})}function dze(e){return Object.keys(e).length===0}function uze(e){return e.length===0}function pze(e,t){if(uze(e)||dze(t))return;const n=UI(t,lze(e));return cze(n,e)}const mze={regulars:{...Re,data:[]},list:{productGroup:void 0},addToRegularsModal:{productId:""},actionInProgress:[]},wp="regulars",Fp="/v1/regulars",Bp={client:"/api/regulars",server:"/core-api"},hze=()=>({type:"API",payload:{service:wp,url:Fp,options:{method:"GET"},pathPrefix:Bp,...Up.types.FETCH_REGULARS}}),gze=e=>({type:"API",payload:{service:wp,url:Fp,options:{method:"POST",body:e},pathPrefix:Bp,...Up.types.CREATE_REGULAR},regular:e}),Eze=()=>({type:"API",payload:{service:wp,url:Fp,options:{method:"DELETE"},pathPrefix:Bp,...Up.types.REMOVE_ALL_REGULARS}}),fze=e=>({type:"API",payload:{service:wp,url:`${Fp}/${e}`,options:{method:"DELETE"},pathPrefix:Bp,...Up.types.REMOVE_REGULAR},productId:e}),yze=e=>({type:"API",payload:{service:wp,url:Fp,options:{method:"PUT",body:e},pathPrefix:Bp,...Up.types.UPDATE_REGULAR},...e}),Ize=Object.freeze(Object.defineProperty({__proto__:null,BASE_PATH:Fp,SERVICE:wp,addRegular:gze,fetchRegulars:hze,pathPrefix:Bp,removeAllRegulars:Eze,removeRegular:fze,updateRegular:yze},Symbol.toStringTag,{value:"Module"})),f3="SET_SELECTED_PRODUCT",y3="REGULARS_SET_PRODUCT_GROUPS",Sze=ee("FETCH_REGULARS"),Cze=ee("REMOVE_ALL_REGULARS"),Tze=ee("CREATE_REGULAR"),_ze=ee("REMOVE_REGULAR"),vze=ee("UPDATE_REGULAR"),Aze={SET_SELECTED_PRODUCT:f3,REGULARS_SET_PRODUCT_GROUPS:y3,FETCH_REGULARS:Sze,REMOVE_ALL_REGULARS:Cze,CREATE_REGULAR:Tze,REMOVE_REGULAR:_ze,UPDATE_REGULAR:vze},{GET_CATALOGUE:bze,GET_REGULARS_CATALOGUE:xze}=ft.types,Rze=e=>({type:f3,payload:e}),Dze=e=>({type:y3,payload:{groups:e}}),Oze=({category:e,transformerConfig:t})=>n=>{const o=tt.stringify({...e&&{categoryId:e},limit:50,tag:["web","regulars"]},{skipEmptyString:!0});return n({type:"API",transformerConfig:t,payload:{url:`/v5/product-pages/regulars?${o}`,service:"web_product_page_ws",pathPrefix:{client:"/api/webproductpagews",server:"/core-api"},...xze}})},Pze=({category:e})=>t=>{const n=tt.stringify({...e&&{category:e}},{skipEmptyString:!0});return t({type:"API",payload:{url:`/v5/products/regulars?${n}`,...bze}})},Up={...Ize,getRegularsPage:Pze,getPPWSRegularsPage:Oze,setSelectedProduct:Rze,setProductGroups:Dze,types:Aze},{setSelectedProduct:LC,setProductGroups:Nze,fetchRegulars:I3,addRegular:Lze,removeAllRegulars:MXt,removeRegular:kze,updateRegular:Mze,getRegularsPage:jze,getPPWSRegularsPage:wze,types:Sa}=Up;function Fze(e,t){return t.filter(n=>n.productId!==e)}function Bze(e=mze,t){switch(t.type){case Sa.SET_SELECTED_PRODUCT:return{...e,addToRegularsModal:{...t.payload}};case Sa.FETCH_REGULARS.PENDING:return{...e,regulars:{...e.regulars,isFetching:!0,fetchError:!1}};case Sa.FETCH_REGULARS.ERROR:return{...e,regulars:{...e.regulars,isFetching:!1,fetchError:!0,data:[]}};case Sa.FETCH_REGULARS.SUCCESS:return{...e,regulars:{...e.regulars,isFetching:!1,fetchError:!1,data:t.payload.responseData}};case Sa.REMOVE_ALL_REGULARS.SUCCESS:return{...e,regulars:{...e.regulars,isFetching:!1,fetchError:!1,data:[]},list:{productGroup:void 0}};case Sa.CREATE_REGULAR.SUCCESS:return{...e,regulars:{...e.regulars,isFetching:!1,fetchError:!1,data:[...e.regulars.data,t.regular]},list:{...e.list,productGroup:e.list.productGroup&&e.list.productGroup.products.length>0?nze(e.list.productGroup,t.regular.productId):sze(t.regular.productId)}};case Sa.REMOVE_REGULAR.SUCCESS:return{...e,regulars:{...e.regulars,isFetching:!1,fetchError:!1,data:Fze(t.productId,e.regulars.data)},list:{...e.list,productGroup:aze(e.list.productGroup,t.productId)}};case Sa.UPDATE_REGULAR.PENDING:return{...e,actionInProgress:[...e.actionInProgress,t.productId]};case Sa.UPDATE_REGULAR.ERROR:return{...e,actionInProgress:e.actionInProgress.filter(n=>n!==t.productId)};case Sa.UPDATE_REGULAR.SUCCESS:return{...e,regulars:{...e.regulars,data:ize(e.regulars.data,t)},actionInProgress:e.actionInProgress.filter(n=>n!==t.productId)};case Sa.REGULARS_SET_PRODUCT_GROUPS:return{...e,list:{...e.list,productGroup:rze(t.payload.groups)}};default:return e}}function S3(e){return e?e.map(t=>t.productId):[]}function Uze(e){return e.data.customer.regulars?.addToRegularsModal}function Gze(e,t){return e.data.customer.regulars?.actionInProgress.includes(t)}function $ze(e){return e.data.customer.regulars?.regulars.isFetching}function Ng(e){return e.data.customer.regulars?.regulars?.data||[]}function Hze(e,t){return V(Ng,n=>n.find(o=>o.productId===t))(e)}const Vze=e=>V(Ng,ir,(t,n)=>{const o=Object.keys(n),r=S3(t),a=o.filter(i=>!r.includes(i));return UI(n,a)})(e),Yze=e=>V(Ng,V1,(t,n)=>{if(!n)return n;const o=S3(t);return n.map(r=>({...r,products:r.products.filter(a=>!o.includes(a))})).filter(r=>r.products.length!==0)})(e);function Wze(e){return e.data.customer.regulars.list.productGroup}const qze=V(Ng,ir,(e,t)=>pze(e,t)),Kze=V(Wze,qze,(e,t)=>{if(!(!e||!t))return{group:e,products:t}}),C3=ee("GET_HOMEPAGE_RECIPE_COMPONENTS"),zze=()=>({type:"API",payload:{url:"/v1/recipes/components/home?imageFormat=avif",...C3,...yi}}),k_={getHomePageComponents:zze,types:{GET_HOMEPAGE_RECIPE_COMPONENTS:C3}},Qze=["http","https"],Xze=["H1","H2","H3","H4","H5","H6","P","DIV","SPAN","BR","B","I","U","LI","OL","UL","TABLE","TR","TD","TH","TBODY","THEAD","TFOOT","A","FONT","CAPTION"],Zze=["WIDTH","HEIGHT","HREF","COLOR","FACE","ID","CLASS","STYLE","TARGET","SCOPE"],Jze=RegExp(`^(${Qze.join("|")}):`,"gim");Lb.addHook("afterSanitizeAttributes",e=>{e.hasAttribute("href")&&(e.tagName!=="A"||"protocol"in e&&!e.protocol.match(Jze))&&e.removeAttribute("href")});const Bu=e=>Lb.sanitize(e,{ALLOWED_TAGS:Xze,ALLOWED_ATTR:Zze}),e4e=e=>Lb.sanitize(e),Un=e=>{try{const t=are(e);return typeof t=="string"?e4e(t):Array.isArray(t)?t.map(Un):t instanceof Object?(Object.keys(t).forEach(n=>{const o=t[n];t[n]=Un(o)}),t):e}catch{return""}},WE={RECIPE_GROUP:"RECIPE_GROUP",COLLECTION_GROUP:"COLLECTION_GROUP",EXPANDED_COLLECTION:"EXPANDED_COLLECTION",SAVED_RECIPES:"SAVED_RECIPES"},Bl={CATEGORY:"CATEGORY",SEARCH:"SEARCH"},t4e={WITHIN_GRID:"WITHIN_GRID"},Zy={RECIPE_CARD:"RECIPE_CARD",COLLECTION_CARD:"COLLECTION_CARD"},dd={default:"avif",fallback:"webp"},Qo=(e,t=0,n=0,o=dd.default)=>{const r=us.parseUrl(e.replace("{width}",`${t}`).replace("{height}",`${n}`),{sort:!1});return r.query.fm=o,us.stringifyUrl(r,{sort:!1})},s4e=e=>{const r={...e};return r?.image?.url&&(r.image.url=Qo(r.image.url,960,200),r.image.fallbackUrl=Qo(r.image.url,960,200,dd.fallback)),r.homePageEntities=[],e?.homePageEntities.forEach(a=>{if(a.type===WE.COLLECTION_GROUP&&a.collections?.length>0){const i={...a};i.collections=a.collections.map(l=>Jy(l)),r.homePageEntities.push(i)}if(a.type===WE.RECIPE_GROUP&&a.recipes?.length>0){const i={...a};i.recipes=a.recipes.map(l=>qc(l,488)),r.homePageEntities.push(i)}if(a.type===WE.EXPANDED_COLLECTION){const i={...a};a.recipes?.length>0&&(i.recipes=a.recipes.map(l=>qc(l,488))),a.collections?.length>0&&(i.collections=a.collections.map(l=>Jy(l))),r.homePageEntities.push(i)}if(a.type===WE.SAVED_RECIPES&&a.recipes?.length>0){const i={...a};i.recipes=a.recipes.map(l=>qc(l,488)),r.homePageEntities.push(i)}}),Un(r)},qc=(e,t=640)=>{const n={...e},o=n.image.url;return n.image.url=Qo(o,t,t),n.image.fallbackUrl=Qo(o,t,t,dd.fallback),Un(n)},Jy=e=>{const r={...e},a=r.image.url;r.image.url=Qo(a,700,338),r.image.fallbackUrl=Qo(a,700,338,dd.fallback);const i=r.recipes?.map(l=>qc(l,420))||[];return r.recipes=i,Un(r)},n4e=e=>{const n={...e},o=n.recipes?.map(r=>qc(r,420))||[];return n.recipes=o,Un(n)},o4e=e=>{const n={...e},o=n.recipes?.map(r=>qc(r,420))||[];return n.recipes=o,Un(n)},r4e=e=>{const t={...e},n=t.collections?.map(o=>Jy(o))||[];return t.collections=n,Un(t)},a4e=e=>{const o={...e},r=o.image.url;return o.image.url=Qo(r,700,338),Un(o)},i4e=e=>{const t={...e},n=t.homePageComponents?.map(o=>a4e(o))||[];return t.homePageComponents=n,Un(t)},l4e=e=>{const t=r=>{const a=r.products.map(i=>b2(i));return{...r,products:a}},n=e.ingredientSearch.map(r=>t(r)),o={...e,ingredientSearch:n};return Un(o)},T3=e=>e.flatMap(n=>n.placement===t4e.WITHIN_GRID?n.items:[]).map(n=>{const o={...n};return o.fields=n.format===Zy.RECIPE_CARD?c4e(n.fields):d4e(n.fields),o}),c4e=(e,t=640)=>{const n={...e},o=n.image.url;return n.image.url=Qo(o,t,t),n.image.fallbackUrl=Qo(o,t,t,dd.fallback),Un(n)},d4e=e=>{const r={...e},a=r.image.url;r.image.url=Qo(a,700,338),r.image.fallbackUrl=Qo(a,700,338,dd.fallback);const i=r.recipeImages?.map(({url:l,altText:c})=>({url:Qo(l,240,240),fallbackUrl:Qo(l,240,240,dd.fallback),altText:c}));return r.recipeImages=i,Un(r)},u4e=e=>{const n={...e},o=n.image.url;return n.image.url=Qo(o,420,420),Un(n)},p4e=(e=ns.recipes.homePageComponents,t)=>{switch(t.type){case k_.types.GET_HOMEPAGE_RECIPE_COMPONENTS.PENDING:return{...e,isFetching:!0,fetchError:!1};case k_.types.GET_HOMEPAGE_RECIPE_COMPONENTS.ERROR:return{...e,isFetching:!1,fetchError:!0};case k_.types.GET_HOMEPAGE_RECIPE_COMPONENTS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:i4e(t.payload.responseData),lastUpdated:le()};default:return e}},jXt=({data:e})=>e.recipes.homePageComponents,_3=ee("GET_RECIPES_HOME"),m4e=()=>({type:"API",payload:{url:"/v1/recipes/home?imageFormat=avif",..._3,...yi}}),Mf={getRecipesHome:m4e,types:{GET_RECIPES_HOME:_3}},h4e={...Re,error:null,data:{image:void 0,homePageEntities:[]}},g4e=(e=h4e,t)=>{switch(t.type){case Mf.types.GET_RECIPES_HOME.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Mf.types.GET_RECIPES_HOME.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Mf.types.GET_RECIPES_HOME.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:s4e(t.payload.responseData),lastUpdated:le()};default:return e}},E4e=({data:e})=>e.recipes.homePage,f4e=({data:e})=>e.recipes.homePage.data?.image,Lg=({data:e})=>e.recipes.homePage.data?.homePageEntities||[],jf=ee("GET_RECIPE_SEARCH"),y4e=({searchTerm:e,limit:t,offset:n})=>({type:"API",payload:{url:`/v1/recipes/search?${new URLSearchParams({searchTerm:e,limit:t?.toString()??"50",offset:n?.toString()??"0",imageFormat:"avif"}).toString()}`,...jf,...yi}}),I4e=(e=ns.recipes.searchPage,t)=>{switch(t.type){case jf.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case jf.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case jf.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:o4e(t.payload.responseData),lastUpdated:le()};default:return e}},v3=({data:e})=>e.recipes.searchPage,Zw=({data:e})=>e.recipes.searchPage.data?.totalRecipes,Ya=()=>"/recipes",S4e=({basePath:e="",queryString:t}={})=>{const n=t?`?${t}`:"";return`${e}${Ya()}${n}`},Kc=({basePath:e="",queryString:t=""}={})=>{const n=t?`?${t}`:"";return`${e}${Ya()}/collections${n}`},C4e=(e,t,{basePath:n="",queryString:o}={})=>{const r=o?`?${o}`:"";return`${n}${Kc()}/${e}/${t}${r}`},A3=(e,t,{basePath:n="",queryString:o}={})=>{const r=o?`?${o}`:"";return`${n}${Ya()}/${e}/${t}${r}`},eI=({basePath:e="",queryString:t}={})=>{const n=t?`?${t}`:"";return`${e}${Ya()}/search-results${n}`},T4e=(e,t,{basePath:n="",queryString:o}={})=>{const r=o?`?${o}`:"";return`${n}${Ya()}/${e}/${t}/ingredients${r}`},b3=()=>`${Ya()}/saved-recipes`,km=ee("GET_RECIPE_DETAILS"),BO=ee("SAVE_RECIPE"),UO=ee("UNSAVE_RECIPE"),x3="SET_CURRENT_RECIPE",_4e=({recipeCollectionId:e,recipeId:t})=>{const n=new URLSearchParams({imageFormat:"avif",...e&&{collectionId:e}});return{type:"API",payload:{url:`/v1/recipes/${t}?${n.toString()}`,...km,...yi}}},v4e=e=>({type:x3,payload:{recipeId:e}}),A4e=e=>({type:"API",payload:{url:`/v1/recipes/${e}/save`,options:{method:"PUT"},...yi,...BO},recipeId:e}),b4e=e=>({type:"API",payload:{url:`/v1/recipes/${e}/save`,options:{method:"DELETE"},...yi,...UO},recipeId:e}),GO={getRecipeDetails:_4e,saveRecipe:A4e,unsaveRecipe:b4e,types:{GET_RECIPE_DETAILS:km,SAVE_RECIPE:BO,UNSAVE_RECIPE:UO}},x4e=(e={...Re,error:null},t)=>{switch(t.type){case km.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case km.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case km.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:{...e.data,[t.payload.responseData.recipeId]:qc(t.payload.responseData)},lastUpdated:le()};case BO.SUCCESS:return e.data?.[t.recipeId]?{...e,isFetching:!1,fetchError:!1,data:{...e.data,[t.recipeId]:{...e.data[t.recipeId],isSaved:!0}},lastUpdated:le()}:e;case UO.SUCCESS:return e.data?.[t.recipeId]?{...e,isFetching:!1,fetchError:!1,data:{...e.data,[t.recipeId]:{...e.data[t.recipeId],isSaved:!1}},lastUpdated:le()}:e;case x3:return{...e,currentRecipe:t.payload.recipeId};case mn:{const n=Or({path:A3(":recipeSlug",":recipeId")},t.payload.location.pathname||"");return n?{...e,currentRecipe:n.params.recipeId}:e}default:return e}},R3=({data:e})=>e.recipes.detailsPage,R4e=({data:e})=>e.recipes.detailsPage.error,_n=e=>{const t=R3(e);if(t.data&&t.currentRecipe&&t.currentRecipe in t.data)return t.data[t.currentRecipe]},D4e=e=>_n(e)?.slug,O4e=e=>_n(e)?.title,P4e=e=>_n(e)?.description,N4e=e=>_n(e)?.author,L4e=e=>_n(e)?.publishedDate,k4e=e=>_n(e)?.collectionId,M4e=e=>({collectionId:_n(e)?.collectionId,collectionTitle:_n(e)?.collectionTitle,collectionSlug:_n(e)?.collectionSlug}),j4e=e=>({recipeId:_n(e)?.recipeId,recipeTitle:_n(e)?.title,recipeSlug:_n(e)?.slug}),w4e=e=>_n(e)?.method,F4e=e=>_n(e)?.ingredients,B4e=e=>_n(e)?.servings,U4e=e=>_n(e)?.totalTimeMinutes,G4e=e=>_n(e)?.prepTimeMinutes,$4e=e=>_n(e)?.cookingTimeMinutes,wf=ee("GET_SHOP_FOR_INGREDIENTS"),D3="SET_INGREDIENT_PRODUCT_ENTITIES",H4e=({recipeCollectionId:e,recipeId:t})=>{const n=new URLSearchParams({imageFormat:"avif",...e&&{collectionId:e}});return{type:"API",payload:{url:`/v1/recipes/${t}/ingredients?${n.toString()}`,...wf,...yi}}},V4e=()=>({type:D3}),Y4e=(e={...Re},t)=>{switch(t.type){case wf.PENDING:return{...e,isFetching:!0,fetchError:!1,setProductEntities:!1,error:null};case wf.ERROR:return{...e,isFetching:!1,fetchError:!0,setProductEntities:!1,error:t.payload};case wf.SUCCESS:return{...e,isFetching:!1,fetchError:!1,setProductEntities:!1,data:l4e(t.payload.responseData),lastUpdated:le()};case D3:return{...e,setProductEntities:!0,isFetching:!1,fetchError:!1,error:null,lastUpdated:le()};default:return e}},W4e=({data:e})=>e.recipes.shopForIngredientsPage,q4e=({data:e})=>e.recipes.shopForIngredientsPage.error,K4e=({data:e})=>e.recipes.shopForIngredientsPage.data?.slug,z4e=({data:e})=>({recipeId:e.recipes.shopForIngredientsPage.data?.recipeId,recipeTitle:e.recipes.shopForIngredientsPage.data?.title,recipeSlug:e.recipes.shopForIngredientsPage.data?.slug}),Q4e=({data:e})=>({collectionId:e.recipes.shopForIngredientsPage.data?.collectionId,collectionTitle:e.recipes.shopForIngredientsPage.data?.collectionTitle,collectionSlug:e.recipes.shopForIngredientsPage.data?.collectionSlug}),$O=({data:e})=>e.recipes.shopForIngredientsPage.data?.ingredientSearch,X4e=({data:e})=>e.recipes.shopForIngredientsPage.setProductEntities,O3=ee("GET_RECIPE_COLLECTION_DETAILS"),Z4e=e=>({type:"API",payload:{url:`/v1/recipes/collections/${e}?imageFormat=avif`,...O3,...yi}}),Ff={getRecipeCollectionDetails:Z4e,types:{GET_RECIPE_COLLECTION_DETAILS:O3}},J4e=(e={...ns.recipes.collectionDetailsPage,error:null},t)=>{switch(t.type){case Ff.types.GET_RECIPE_COLLECTION_DETAILS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Ff.types.GET_RECIPE_COLLECTION_DETAILS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Ff.types.GET_RECIPE_COLLECTION_DETAILS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:Jy(t.payload.responseData),lastUpdated:le(),error:null};default:return e}},e3e=({data:e})=>e.recipes.collectionDetailsPage,t3e=({data:e})=>({collectionId:e.recipes.collectionDetailsPage.data?.collectionId,collectionTitle:e.recipes.collectionDetailsPage.data?.title,collectionSlug:e.recipes.collectionDetailsPage.data?.slug}),s3e=({data:e})=>e.recipes.collectionDetailsPage.error,n3e=({data:e})=>e.recipes.collectionDetailsPage.data?.slug,P3=({data:e})=>e.recipes.collectionDetailsPage.data?.title,o3e=({data:e})=>e.recipes.collectionDetailsPage.data?.description,r3e=({data:e})=>e.recipes.collectionDetailsPage.data?.image,a3e=({data:e})=>e.recipes.collectionDetailsPage.data?.recipes,N3="SET_RECIPES",i3e=e=>({type:N3,payload:e}),l3e={data:{}},c3e=(e=l3e,t)=>{switch(t.type){case N3:{const o=(e.data[t.payload.searchTerm]??[]).concat(t.payload.recipes);return{data:{[t.payload.searchTerm]:[...new Map(o.map(r=>[r.recipeId,r])).values()]},lastUpdated:le()}}default:return e}},L3=({data:e})=>e.recipes.recipeEntities.data,k3="SET_RECIPE_COLLECTIONS",HO=e=>({type:k3,payload:e});HO.match=e=>e.type===k3;const d3e=(e={},t)=>{if(HO.match(t)){const n=e?.collections||[];let o=[];if(t.payload.clear)o=t.payload.collections;else{const a=n.concat(t.payload.collections);o=[...new Map(a.map(i=>[i.collectionId,i])).values()]}return{collections:o,lastUpdated:le()}}return e},M3=({data:e})=>e.recipes.collectionEntities?.collections,Bf=ee("GET_RECIPE_COLLECTIONS"),u3e=({limit:e,offset:t})=>({type:"API",payload:{url:`/v1/recipes/collections?${new URLSearchParams({limit:e.toString(),offset:t.toString(),imageFormat:"avif"}).toString()}`,...Bf,...yi}}),p3e={...Re,error:null},m3e=(e=p3e,t)=>{switch(t.type){case Bf.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Bf.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Bf.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,data:r4e(t.payload.responseData),lastUpdated:le()};default:return e}},h3e=({data:e})=>e.recipes.collectionsPage,g3e=({data:e})=>e.recipes.collectionsPage.data?.totalCollections,j3=ee("GET_SAVED_RECIPES"),E3e="CLEAR_SAVED_RECIPES",f3e=e=>{const n=(e-1)*50,o=new URLSearchParams({limit:"50",offset:n.toString(),imageFormat:"avif"});return{type:"API",page:e,payload:{url:`/v1/recipes/saved-recipes?${o.toString()}`,...j3,...yi}}},y3e=()=>({type:"CLEAR_SAVED_RECIPES"}),Mc={getSavedRecipes:f3e,clear:y3e,types:{GET_SAVED_RECIPES:j3,CLEAR_SAVED_RECIPES:E3e}},I3e=(e=ns.recipes.savedRecipesPage,t)=>{switch(t.type){case Mc.types.GET_SAVED_RECIPES.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Mc.types.GET_SAVED_RECIPES.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Mc.types.GET_SAVED_RECIPES.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:{totalRecipes:t.payload.responseData.totalRecipes,[t.page]:n4e(t.payload.responseData)?.recipes||[],...e?.data},error:null};case Mc.types.CLEAR_SAVED_RECIPES:return ns.recipes.savedRecipesPage;default:return e}},S3e=({data:e})=>e.recipes.savedRecipesPage,C3e=({data:e})=>e.recipes.savedRecipesPage?.data?.totalRecipes||0,T3e=({data:e},t)=>{const n=e.recipes.savedRecipesPage.data;return n?[...Array(t).keys()].map(r=>n?.[r+1]||[]).flat():[]},Mm=ee("GET_SEARCH_PAGE_RECIPE_ADVERTS"),_3e=e=>({type:"API",searchTerm:e,payload:{url:"/v1/recipes/adverts?imageFormat=avif",options:{method:"PUT",body:{key:e,pageDto:Bl.SEARCH}},...Mm}}),v3e={fetchSearchPageRecipeAdverts:_3e,types:{GET_SEARCH_PAGE_RECIPE_ADVERTS:Mm}},A3e={...Re,data:void 0,error:null},b3e=(e=A3e,t)=>{switch(t.type){case Mm.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Mm.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Mm.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:{[t.searchTerm]:T3(t.payload.responseData)},lastUpdated:le()};default:return e}},x3e=e=>{const{searchTerm:t}=Sp(e);return e.data.recipes.searchPageRecipeAdverts.data?.[t]||[]},jm=ee("GET_CATEGORY_PAGE_RECIPE_ADVERTS"),R3e=e=>({type:"API",categoryId:e,payload:{url:"/v1/recipes/adverts?imageFormat=avif",options:{method:"PUT",body:{key:e,pageDto:Bl.CATEGORY}},skipLoginRedirect:!0,...jm}}),D3e={fetchCategoryPageRecipeAdverts:R3e,types:{GET_CATEGORY_PAGE_RECIPE_ADVERTS:jm}},O3e={...Re,data:void 0,error:null},P3e=(e=O3e,t)=>{switch(t.type){case jm.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case jm.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case jm.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:t.payload.responseData?T3(t.payload.responseData):[],lastUpdated:le()};default:return e}},N3e=e=>e.data.recipes.categoryPageRecipeAdverts.data||[],L3e=(e,t=0,n=0)=>e.replace("{width}",`${t}`).replace("{height}",`${n}`),k3e=(e,t=640)=>{const n={...e},o=n.image.url;return n.image.url=L3e(o,t,t),Un(n)},w3=(e,t=640)=>{const n={...e},o=n.results?.map(r=>k3e(r,t));return n.results=o,Un(n)},M3e=e=>{const t={...e};return Un(t)},j3e=(e,t=640)=>{const n={...e},o=n.messageHistory.map(r=>w3(r,t));return n.messageHistory=o,Un(n)},w3e=(e,t=640)=>{const n={...e},o=w3(n.responseMessage,t);return n.responseMessage=o,Un(n)},qE={isFetching:{CREATE_CHAT:!1,GET_CHAT_HISTORY:!1,SEND_MESSAGE:!1},isFlowoutDisabled:!1,data:{}},F3e=(e=qE,t)=>{switch(t.type){case Gs.CREATE_CHAT.PENDING:return{isFlowoutDisabled:!1,isFetching:{...qE.isFetching,CREATE_CHAT:!0},error:null,data:qE.data};case Gs.GET_CHAT_HISTORY.PENDING:return{...e,isFetching:{...e.isFetching,GET_CHAT_HISTORY:!0},error:null};case Gs.CREATE_CHAT.ERROR:{const n=Math.max(t.timestamp+2e3-le(),0);return{...e,isFetching:{...e.isFetching,CREATE_CHAT:!1},error:t.type,remainingLoadingTime:n}}case Gs.GET_CHAT_HISTORY.ERROR:return{...e,isFetching:{...e.isFetching,GET_CHAT_HISTORY:!1},error:t.type};case Gs.CREATE_CHAT.SUCCESS:{const{chatId:n,expiryTime:o,initialMessage:r}=M3e(t.payload.responseData),a=Math.max(t.timestamp+2e3-le(),0);return{...e,isFetching:{...e.isFetching,CREATE_CHAT:!1},error:null,remainingLoadingTime:a,data:{chatId:n,expiryTime:o,messageHistory:[r]}}}case Gs.DISABLE_FLOWOUT:return{...e,isFlowoutDisabled:!0,error:null};case Gs.GET_CHAT_HISTORY.SUCCESS:return e.isFetching.GET_CHAT_HISTORY?{...e,isFetching:{...e.isFetching,GET_CHAT_HISTORY:!1},error:null,data:j3e(t.payload.responseData)}:e;case Gs.SEND_MESSAGE.PENDING:{const{messageHistory:n=[]}=e.data,o=e.error==="SEND_MESSAGE_ERROR"&&n[n.length-1]?.messageId==="temp";return{...e,isFetching:{...e.isFetching,SEND_MESSAGE:!0},error:null,remainingLoadingTime:void 0,data:{...e.data,messageHistory:[...o?n.slice(0,-1):n,{message:t.message,role:qn.USER,messageId:"temp"}]}}}case Gs.SEND_MESSAGE.ERROR:{let n;t.payload instanceof RA&&t.payload.statusCode===500&&t.payload.hasCode()&&(n=t.payload.code);const o=n?.startsWith("LLM")?`SEND_MESSAGE_ERROR_${n==="LLM-001"?"RETRY":"FATAL"}`:"SEND_MESSAGE_ERROR";return{...e,isFetching:{...e.isFetching,SEND_MESSAGE:!1},error:o}}case Gs.SEND_MESSAGE.SUCCESS:{if(!e.isFetching.SEND_MESSAGE)return e;const{chatId:n,expiryTime:o,userMessageId:r,responseMessage:a}=w3e(t.payload.responseData),{messageHistory:i=[]}=e.data,l=Math.max(t.timestamp+2e3-le(),0);return{...e,isFetching:{...e.isFetching,SEND_MESSAGE:!1},error:null,remainingLoadingTime:l,data:{chatId:n,expiryTime:o,messageHistory:[...i.slice(0,-1),{...i[i.length-1],messageId:r},a]}}}case Gs.SET_CHAT:{const{chatId:n}=t.payload;return{...e,error:null,data:{...e.data,chatId:n}}}case Gs.CLEAR_CHAT:return qE;case Gs.SET_SHOW_REFRESH_DIALOG:return{...e,showRefreshDialog:t.payload.showRefreshDialog};default:return e}},F3=e=>e.data.recipes.chat.isFetching,kC=e=>e.data.recipes.chat.data.chatId,B3e=e=>e.data.recipes.chat.data.expiryTime,B3=e=>e.data.recipes.chat.data.messageHistory??[],U3e=e=>e.data.recipes.chat.isFlowoutDisabled,VO=e=>e.data.recipes.chat.error,G3e=({data:{recipes:e}})=>e.chat.remainingLoadingTime,U3=({data:{recipes:e}})=>!!e.chat.showRefreshDialog,G3=e=>B3(e).findLastIndex(n=>!!n.results),$3e=Ms({homePageComponents:p4e,homePage:g4e,searchPage:I4e,recipeEntities:c3e,collectionEntities:d3e,detailsPage:x4e,shopForIngredientsPage:Y4e,collectionDetailsPage:J4e,collectionsPage:m3e,savedRecipesPage:I3e,searchPageRecipeAdverts:b3e,categoryPageRecipeAdverts:P3e,chat:F3e}),kg={service:"mealplanning",pathPrefix:{client:"/api/meals",server:"/core-api"}},Uf=ee("GET_MEALS"),YO=(e="")=>{const t=new URLSearchParams;return e&&t.set("sort_by",e),{type:"API",payload:{url:`/v1/meals${t.size?`?${t.toString()}`:""}`,...Uf,...kg}}},H3e={RECIPE:"RECIPE"},V3e=e=>{const t=ql(e);return t<=-14?"mealplanning.meal-plan.previous-plan-header-title":t<=-7?"mealplanning.meal-plan.last-week-header-title":t<=0?"mealplanning.meal-plan.this-week-header-title":t<=7?"mealplanning.meal-plan.next-week-header-title":"mealplanning.meal-plan.future-plan-header-title"},Y3e=e=>e===0?"date.today":e===1?"date.tomorrow":null,W3e=e=>{const t=t0(e.start,e.end),n=(Array.isArray(t)?t:[]).map(o=>{const r=ql(o);return{relativeNameTranslationId:Y3e(r),dayNameString:Ks(Ma,o),dayStatus:r===0?"CURRENT":r<0?"PAST":"FUTURE",date:Ks(G$,o)}});return{...e,weekString:V3e(e.start),weekStart:yt(e.start,eA),weekEnd:yt(e.end,eA),weekIntervalString:Wh(e.start,e.end,H$),days:n}},q3e=e=>{const t=e.weeks.filter((n,o)=>o>2||n.days.length>0);return{...e,weeks:t.map(W3e)}},K3e=e=>{const t={...e};return t.meals=e.meals.map(n=>n.type===H3e.RECIPE?u4e(n):n),t},z3e=(e=Re,t)=>{switch(t.type){case Uf.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Uf.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Uf.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:K3e(t.payload.responseData)};default:return e}},wXt=({data:e})=>e.mealPlanning.meals.isFetching,FXt=({data:e})=>e.mealPlanning.meals.data?.meals,BXt=({data:e})=>e.mealPlanning.meals.data?.sortOptions,WO=({data:e})=>e.mealPlanning.meals.data?.sortedBy,UXt=({data:e})=>e.mealPlanning.meals.data?.totalMeals,GXt=({data:e})=>e.mealPlanning.meals.data?.totalRecipes,Gf=ee("GET_MEAL_PLAN"),$Xt=()=>({type:"API",payload:{url:"/v1/meals/plan",...Gf,...kg}}),Q3e={...Re,data:{weeks:[],meals:[]}},X3e=(e=Q3e,t)=>{switch(t.type){case Gf.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Gf.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Gf.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:q3e(t.payload.responseData)};default:return e}},HXt=({data:e})=>e.mealPlanning.mealPlan.data,Z3e=Ms({meals:z3e,mealPlan:X3e}),$3=ee("GET_REVIEWS"),qO=ee("UPDATE_REVIEW_HELPFULNESS"),J3e=(e,t={})=>{const n=Object.keys(t).length>0?`?${tt.stringify(t)}`:"";return{type:"API",payload:{service:KO,url:`/ecomreviews/v1/products/${e}/reviews${n}`,...$3}}},KO="ecomreviews",e5e=e=>({type:"API",payload:{service:KO,url:"/ecomreviews/v1/reviews/helpfulness",options:{method:"POST",body:{reviewId:e}},...qO}}),t5e=e=>({type:"API",payload:{service:KO,url:"/ecomreviews/v1/reviews/helpfulness",options:{method:"PUT",body:{reviewId:e}},...qO}}),KE={getReviewsData:J3e,postReviewHelpfulness:e5e,deleteReviewHelpfulness:t5e,types:{GET_REVIEWS:$3,UPDATE_REVIEW_HELPFULNESS:qO}},s5e=Re,n5e=(e=s5e,t)=>{switch(t.type){case KE.types.GET_REVIEWS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case KE.types.GET_REVIEWS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case KE.types.GET_REVIEWS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:t.payload.responseData,lastUpdated:le()};case KE.types.UPDATE_REVIEW_HELPFULNESS.SUCCESS:{if(!e.data)return e;const n=t.payload.responseData;return{...e,data:{...e.data,reviews:e.data.reviews.map(o=>o.id===n.id?{...o,...n}:o)}}}default:return e}},VXt=({data:e})=>e.bop.reviews,YXt=({data:e})=>e.bop.reviews.data?.ratingHistogram,WXt=({data:e})=>e.bop.reviews.data?.reviews,qXt=({data:e})=>e.bop.reviews.data?.metadata.sortOptions,KXt=({data:e})=>e.bop.reviews.data?.reviewCount,zXt=({data:e})=>e.bop.reviews.data?.metadata.nextPage,QXt=Hn("ratingSummary"),o5e=({data:e},t)=>e.products.productEntities[t]?.ratingSummary,$f=ee("GET_FOOTER_LINKS"),H3=()=>({type:"API",payload:{url:"/v3/content/footer-links",...$f}}),r5e=(e=ns.footer,t)=>{switch(t.type){case $f.PENDING:return{...e,isFetching:!0,fetchError:!1};case $f.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.error};case $f.SUCCESS:{const{responseData:n}=t.payload;return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),links:{sections:n.columns,contact:n.contactUs||n.contactLink,social:n.socialMedia,legalText:n.legalText}}}default:return e}},a5e=({data:{content:{footer:e}}})=>({lastUpdated:e.lastUpdated}),Ru={value:"",encodedName:void 0},Jw={WebAddressTarget:e=>({value:e.url}),StaticPageTarget:e=>({value:e.staticPage}),SearchTarget:e=>({value:e.searchTerm}),ShopInShopTarget:e=>({value:e.shop}),CategoryTarget:e=>({value:e.categoryId,encodedName:e.nameHierarchy.map(t=>Co(t).toLowerCase()).join("/")}),PromotionTarget:e=>({value:e.promotionId,encodedName:Co(e.description).toLowerCase()}),PromotionsLandingTarget:()=>({...Ru}),ProductTarget:e=>({value:e.retailerProductId,encodedName:Co(e.description).toLowerCase()}),FavoritesTarget:()=>({...Ru}),OrdersTarget:()=>({...Ru}),SlotBookingTarget:()=>({...Ru})},jo=({basePath:e="",queryString:t}={})=>{const n=t?`?${t}`:"";return`${e}/products${n}`},Zo=(e,{basePath:t="",queryString:n}={})=>{const o=n?`?${n}`:"";return e?`${t}/categories/${e}${o}`:`${t}/categories${o}`},Ui=(e,t,{basePath:n="",queryString:o}={})=>{const r=o?`?${o}`:"";return t?`${n}/categories/${t}/${e}${r}`:e?`${n}/categories/${e}${r}`:`${n}/categories${r}`},lc=(e,{basePath:t="",queryString:n}={})=>{const o=n?`?${n}`:"";return e?`${t}/promotions/${e}${o}`:`${t}/promotions${o}`},NA=(e,t,{basePath:n="",queryString:o}={})=>{const r=o?`?${o}`:"";return t?`${n}/promotions/${t}/${e}${r}`:e?`${n}/promotions/${e}${r}`:`${n}/promotions${r}`},Mg=({queryString:e}={})=>`/favorites${e?`?${e}`:""}`,li=(e=!1,{basePath:t="",queryString:n}={})=>{const o=n?`?${n}`:"";return e?`${t}/search${o}`:`${jo({basePath:t})}/search${o}`},MC=(e,t,{basePath:n="",queryString:o=""}={})=>{const r=o?`?${o}`:"";return t?`${n}/offers/${t}/${e}${r}`:`${n}/offers/${e}${r}`},vi=(e,t,{basePath:n="",queryString:o}={})=>{const r=o?`?${o}`:"";return t?`${jo({basePath:n})}/${t}/${e}${r}`:`${jo({basePath:n})}/${e}/details${r}`},Gp=(e,{isSEOReadableURLEnabled:t})=>{const n=Co(e);if(t)return n?.toLowerCase()},zO=e=>`/content/${e}`,i5e="/shop-in-shop/:pageId",xh=e=>i5e.replace(/:pageId/,e),l5e={SearchTarget:(e,t,n)=>li(t,{basePath:n,queryString:`q=${encodeURIComponent(e.value)}`}),PromotionTarget:(e,t,n)=>MC(e.value,t&&e.encodedName?e.encodedName:void 0,{basePath:n}),PromotionsLandingTarget:()=>lc(),ProductTarget:(e,t)=>vi(e.value,t&&e.encodedName?e.encodedName:void 0),CategoryTarget:(e,t,n)=>t?Ui(e.value,e.encodedName||""):jo({basePath:n,queryString:`sublocationId=${e.value}`}),StaticPageTarget:e=>zO(e.value),WebAddressTarget:e=>e.value,FavoritesTarget:()=>Mg(),OrdersTarget:()=>lo(),SlotBookingTarget:()=>mi(),ShopInShopTarget:e=>xh(e.value)},c5e=(e,t)=>t?`${e?.endsWith("/")?e.substring(0,e.length-1):e}${t}`:e,QO=(e,t,n,o,r)=>{const a=n?o?.toLowerCase():o;switch(e){case Dt.FOP:return li(n,{queryString:`q=${t}`});case Dt.KEYWORD:return li(n,{queryString:`q=${t}`});case Dt.PROMOTION:return MC(t,n?a:"");case Dt.PROMOTIONS_LANDING:return lc();case Dt.BOP:return vi(t,n?a:void 0);case Dt.CATEGORY:{const i=`sublocationId=${t}`;return n?Ui(t,a):jo({queryString:i})}case Dt.CMS_STATIC_PAGE:return zO(t);case Dt.SLOT_BOOKING:return mi();case Dt.FAVORITES:return Mg();case Dt.ORDERS:return lo();case Dt.SHOP_IN_SHOP:case Dt.SHOP_IN_SHOP_TEMPLATED:return xh(t);case Dt.WEB_ADDRESS:case Dt.ABSOLUTE_WEB_ADDRESS:case Dt.INTERNAL_PAGE:case Dt.INTERNAL_WEB_ADDRESS:return t;case Dt.RETAIL_BANNER:return c5e(t,r);case Dt.DEFAULT_TAB:return"/";default:return""}},d5e=(e,t)=>{switch(e){case Dt.FOP:case Dt.KEYWORD:return encodeURIComponent(t);default:return encodeURI(t)}},u5e=(e,t={isSEOReadableURLEnabled:!1},n)=>{if(!e)return"";const o=e.linkType,r=e.ids&&e.ids[0]||e.values&&e.values[0]||e.value&&e.value||"",{isSEOReadableURLEnabled:a=!1}=t,i=typeof e.encodedName=="string"?e.encodedName:"",l=a?i:"",c=d5e(o,r);return QO(o,c,a,l,n)},V3=e=>e===Dt.CATEGORY||e===Dt.PROMOTION,p5e=(e,t)=>e.__typename===t,m5e={WebAddressTarget:Dt.ABSOLUTE_WEB_ADDRESS,ProductTarget:Dt.BOP,CategoryTarget:Dt.CATEGORY,StaticPageTarget:Dt.CMS_STATIC_PAGE,FavoritesTarget:Dt.FAVORITES,SearchTarget:Dt.KEYWORD,OrdersTarget:Dt.ORDERS,ShopInShopTarget:Dt.SHOP_IN_SHOP_TEMPLATED,PromotionsLandingTarget:Dt.PROMOTIONS_LANDING,SlotBookingTarget:Dt.SLOT_BOOKING,PromotionTarget:Dt.PROMOTION},Y3=e=>{const t=e.__typename;if(!t||!(t in Jw))return;const n={typeName:t,openInNewTab:e.shouldBeOpenedInNewTab},o=Jw[t],r=p5e(e,t)?o(e):{...Ru};return{...n,...Ru,...r}},h5e=(e,t=!1)=>{const n=m5e[e.__typename],o=!!e.shouldBeOpenedInNewTab;if(!n)throw new Error(`Unknown linkType for __typename ${e.__typename}`);switch(e.__typename){case"WebAddressTarget":return{linkType:n,openInNewTab:o,values:[e.url],value:e.url};case"StaticPageTarget":return{linkType:n,openInNewTab:o,values:[e.staticPage],value:e.staticPage};case"SearchTarget":return{linkType:n,openInNewTab:o,values:[e.searchTerm]};case"ShopInShopTarget":return{linkType:n,openInNewTab:o,values:[e.shop]};case"CategoryTarget":{let r;return e.nameHierarchy&&Array.isArray(e.nameHierarchy)&&(r=e.nameHierarchy.map(a=>Co(a).toLowerCase()).join("/")),{linkType:n,openInNewTab:o,values:[t?e.retailerCategoryId:e.categoryId],...r?{encodedName:r}:{}}}case"PromotionTarget":return{linkType:n,openInNewTab:o,values:[t?e.retailerPromotionId:e.promotionId],encodedName:e.description?Co(e.description).toLowerCase():void 0};case"ProductTarget":return{linkType:n,openInNewTab:o,values:[e.retailerProductId],encodedName:e.description?Co(e.description).toLowerCase():void 0};case"FavoritesTarget":case"OrdersTarget":case"PromotionsLandingTarget":case"SlotBookingTarget":return{linkType:n,openInNewTab:o};default:throw new Error(`Unsupported target type: ${e.__typename}`)}},g5e=(e,{isSEOReadableURLEnabled:t=!1}={},n="")=>{if(!e)return"";const o=Y3(e);if(!o)return"";const r=l5e[o.typeName];return r?r(o,t,n):""},E5e=(e,t={isSEOReadableURLEnabled:!1},n)=>u5e(e,t,n),La={normalizeTarget:Y3,normalizeToLegacyTarget:h5e,calculateUrl:g5e,calculateLegacyTargetUrl:E5e},Hf=ee("FETCH_TOPTABS"),W3=(e="",t=!1)=>({type:"API",payload:{url:"/v1/content/top-tabs",...Hf},isSEOReadableURLEnabled:t,basePath:e}),f5e=e=>{const t=e.linkType;return[Dt.ABSOLUTE_WEB_ADDRESS,Dt.RETAIL_BANNER].includes(t)},y5e=(e,t,n)=>e.map(r=>({...r,targetURL:La.calculateLegacyTargetUrl(r.target,{isSEOReadableURLEnabled:t},n),isExternalLink:f5e(r.target),encodedTargetValue:r.default?void 0:encodeURI(r.target.value).toLowerCase()})),I5e=(e=ns.topTabs,t)=>{switch(t.type){case Hf.PENDING:return{...e,isFetching:!0,fetchError:!1};case Hf.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Hf.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:t.payload.responseData?y5e(t.payload.responseData,t.isSEOReadableURLEnabled,t.basePath):[]};default:return e}},Vf=ee("GET_CONTENT_BLOCKS"),S5e=e=>{const t=e?.target?.linkType;return t==="WEB_ADDRESS"||t==="ABSOLUTE_WEB_ADDRESS"},C5e=(e,t)=>e.map(n=>n?.target?{...n,targetUrl:La.calculateLegacyTargetUrl(n.target,{isSEOReadableURLEnabled:t}),isExternalLink:S5e(n)}:{...n}),T5e=(e=ns.contentBlocks,t)=>{switch(t.type){case Vf.PENDING:return{...e,isFetching:!0,fetchError:!1};case Vf.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.error};case Vf.SUCCESS:{const{responseData:n}=t.payload;return n.length>0?{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),blocks:C5e(n,t.isSEOReadableURLEnabled)}:e}default:return e}},q3=ee("GET_STATIC_CONTENT_V2"),K3=e=>({type:"API",pageId:e,payload:{url:`/v2/content/page/${e}`,...q3}}),M_={GET_STATIC_CONTENT_V2:q3},_5e={...Re,content:"",pageId:null},v5e=(e=_5e,t)=>{switch(t.type){case M_.GET_STATIC_CONTENT_V2.PENDING:return{...e,isFetching:!0,fetchError:!1};case M_.GET_STATIC_CONTENT_V2.ERROR:return{...e,isFetching:!1,fetchError:!0,pageId:t.pageId};case M_.GET_STATIC_CONTENT_V2.SUCCESS:return{...e,isFetching:!1,fetchError:!1,content:t.payload.responseData.html,componentItems:t.payload.responseData.componentItems,pageTitle:t.payload.responseData.name,pageId:t.pageId};default:return e}},A5e=Ms({staticContentPage:v5e,contentBlocks:T5e,footer:r5e,topTabs:I5e}),b5e={},j_={...Re,productIds:[]},x5e=(e=b5e,t)=>{switch(t.type){case"GET_LISTER_PAGE_PENDING":return{...e,[t.advertId]:{...j_,isFetching:!0}};case"GET_LISTER_PAGE_SUCCESS":return{...e,[t.advertId]:{...j_,productIds:t.payload.responseData.productIds}};case"GET_LISTER_PAGE_ERROR":return{...e,[t.advertId]:{...j_,fetchError:!0}};default:return e}},R5e=(e=ns.toggleablePromotions,t)=>{switch(t.type){case va.actionTypes.GET_AVAILABLE_PROMOTION_SELECTIONS.PENDING:case va.actionTypes.GET_PROMOTION_DESCRIPTIONS.PENDING:return{...e,isFetching:!0,fetchError:!1};case va.actionTypes.GET_AVAILABLE_PROMOTION_SELECTIONS.ERROR:case va.actionTypes.GET_PROMOTION_DESCRIPTIONS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case va.actionTypes.SET_TOGGLEABLE_PROMOTIONS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:t.payload.toggleablePromotions};default:return e}},z3=ee("GET_NEXT_AVAILABLE_SLOT"),D5e=e=>({type:"API",payload:{pathPrefix:{client:"/api/ecomslots",server:"/core-api"},service:"ecomslots",url:"/v1/slots/next-available-slot",options:{method:"POST",body:{deliveryDestinationId:e}},...z3}}),Yf={fetchNextAvailableSlot:D5e,types:{GET_NEXT_AVAILABLE_SLOT:z3}},O5e={isFetching:!1,fetchError:!1,didInvalidate:!1,lastUpdated:null,error:null,data:null},Q3=e=>{if(!e)return null;const t=e?.pricedSlot,n=t?.slotWindow,o=n?.startTime,r=n?.endTime,a=t?.timeZoneId,i=e?.deliveryAddress;return{startTime:kc(o,a),endTime:kc(r,a),timeZoneId:a,address:i,type:t?.type,deliveryMethod:i?.deliveryMethod,collectionTimeInMinutes:t?.onDemandProperties?.collectionTimeInMinutes,deliveryTimeInMinutes:t?.onDemandProperties?.deliveryTimeInMinutes}},P5e=(e=O5e,t)=>{switch(t.type){case Yf.types.GET_NEXT_AVAILABLE_SLOT.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Yf.types.GET_NEXT_AVAILABLE_SLOT.ERROR:{const n=t.payload;return{...e,isFetching:!1,fetchError:!0,error:n,lastUpdated:le(),data:null}}case Yf.types.GET_NEXT_AVAILABLE_SLOT.SUCCESS:{const n=t.payload.responseData,o=Q3(n);return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:o}}default:return e}},N5e=({data:e})=>e.delivery.nextAvailableSlot,eF={isFetching:!1,fetchError:!1,didInvalidate:!1,lastUpdated:null,error:null,data:null,debouncedSlotListingRequests:0,pendingSlotListingRequests:0,lastSlotListingRequestStartTime:null,successRequestParams:null,persistedPreviousAddress:void 0},X3=ee("GET_SLOTS"),Z3="SET_SLOTS",J3="SET_SLOTS_ERROR",e5="REQUEST_SLOTS_DEBOUNCED",t5="INVALIDATE_SLOTS",s5="CLEAR_SLOT_GRID_DATA",n5="PERSIST_PREVIOUS_SELECTED_ADDRESS",o5="CLEAR_PERSISTED_PREVIOUS_SELECTED_ADDRESS",L5e=({deliveryDestinationId:e,shippingGroupType:t,viewingLocation:n,pageViewId:o,sessionId:r,regionId:a,requestStartTime:i})=>({type:"API",payload:{url:"/v1/slots",service:"ecomslots",pathPrefix:{client:"/api/ecomslots",server:"/core-api"},options:{method:"POST",body:{...t?{shippingGroupType:t}:{},deliveryDestinationId:e,regionId:a,...r?{analyticsData:{sessionId:r,viewingLocation:n,platform:"WEB",...o?{pageViewId:o}:{}}}:{}}},...X3},requestStartTime:i}),k5e=({data:e,requestStartTime:t,successRequestParams:n})=>({type:Z3,payload:{data:e,requestStartTime:t,successRequestParams:n}}),M5e=e=>({type:J3,payload:e}),j5e=()=>({type:e5}),w5e=()=>({type:t5}),F5e=()=>({type:s5}),B5e=()=>({type:n5}),U5e=()=>({type:o5}),Yn={getSlots:L5e,setSlots:k5e,setSlotsError:M5e,requestSlotsDebounced:j5e,invalidateSlots:w5e,clearSlotGridData:F5e,persistPreviouslySelectedAddress:B5e,clearPersistedPreviouslySelectedAddress:U5e,types:{GET_SLOTS:X3,SET_SLOTS:Z3,SET_SLOTS_ERROR:J3,REQUEST_SLOTS_DEBOUNCED:e5,INVALIDATE_SLOTS:t5,CLEAR_SLOT_GRID_DATA:s5,PERSIST_PREVIOUS_SELECTED_ADDRESS:n5,CLEAR_PERSISTED_PREVIOUS_SELECTED_ADDRESS:o5}},G5e=(e=eF,t)=>{switch(t.type){case Yn.types.REQUEST_SLOTS_DEBOUNCED:return{...e,debouncedSlotListingRequests:e.debouncedSlotListingRequests+1};case Yn.types.GET_SLOTS.PENDING:return{...e,isFetching:!0,didInvalidate:!1,lastSlotListingRequestStartTime:t.requestStartTime,pendingSlotListingRequests:e.pendingSlotListingRequests+1,debouncedSlotListingRequests:0};case Yn.types.SET_SLOTS_ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload||null,pendingSlotListingRequests:Math.max(e.pendingSlotListingRequests-1,0),successRequestParams:null};case Yn.types.SET_SLOTS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:(!e.lastSlotListingRequestStartTime||Mt(t.payload?.requestStartTime).isSameOrAfter(Mt(e.lastSlotListingRequestStartTime)))&&t.payload?t.payload.data:e?.data,pendingSlotListingRequests:Math.max(e.pendingSlotListingRequests-1,0),successRequestParams:t.payload?.successRequestParams};case Yn.types.INVALIDATE_SLOTS:return{...e,didInvalidate:!0};case Yn.types.CLEAR_SLOT_GRID_DATA:return{...eF};case Yn.types.PERSIST_PREVIOUS_SELECTED_ADDRESS:return{...e,persistedPreviousAddress:!0};case Yn.types.CLEAR_PERSISTED_PREVIOUS_SELECTED_ADDRESS:return{...e,persistedPreviousAddress:!1};default:return e}},r5=ee("GET_DELIVERY_OPTIONS"),a5=ee("UPDATE_DELIVERY_OPTIONS"),i5="SET_DELIVERY_OPTIONS",$5e=(e,t,n)=>({type:"API",payload:{url:`/ecomfulfillments/v1/orders/${e}/delivery-details-draft/options?deliveryDestinationId=${t}&regionId=${n}`,options:{method:"GET"},service:"ecomfulfillments",...r5},lastRequested:le()}),H5e=({orderId:e,regionId:t,deliveryDestinationId:n,data:o})=>({type:"API",payload:{url:`/ecomfulfillments/v1/orders/${e}/delivery-details-draft?deliveryDestinationId=${n}&regionId=${t}`,options:{method:"PUT",body:o},service:"ecomfulfillments",...a5}}),V5e=e=>({type:i5,payload:e}),jc={getDeliveryOptions:$5e,updateDeliveryOptions:H5e,setDeliveryOptions:V5e,types:{GET_DELIVERY_OPTIONS:r5,UPDATE_DELIVERY_OPTIONS:a5,SET_DELIVERY_OPTIONS:i5}},Y5e={...Re,options:null,error:null,lastRequested:null},W5e=(e=Y5e,t)=>{switch(t.type){case jc.types.GET_DELIVERY_OPTIONS.PENDING:return{...e,lastRequested:t.lastRequested,isFetching:!0,fetchError:!1,error:null};case jc.types.GET_DELIVERY_OPTIONS.ERROR:return e.lastRequested!==t.lastRequested?e:{...e,isFetching:!1,fetchError:!0,error:t.payload};case jc.types.GET_DELIVERY_OPTIONS.SUCCESS:return e.lastRequested!==t.lastRequested?e:{...e,isFetching:!1,fetchError:!1,lastUpdated:t.lastRequested,options:t.payload.responseData};case jc.types.SET_DELIVERY_OPTIONS:return{...e,options:t.payload,lastUpdated:le()};default:return e}},l5=ee("GET_SLOT_DISPLAY_MODES"),q5e=e=>({type:"API",payload:{url:`/v1/slot-display-modes${e?`?regionId=${e}`:""}`,service:"checkoutgroups",pathPrefix:{client:"/api/checkout-groups",server:"/core-api"},...l5}}),Wf={getSlotDisplayModes:q5e,types:{GET_SLOT_DISPLAY_MODES:l5}},K5e=(e=qGe,t)=>{switch(t.type){case Wf.types.GET_SLOT_DISPLAY_MODES.PENDING:return{...e,isFetching:!0};case Wf.types.GET_SLOT_DISPLAY_MODES.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Wf.types.GET_SLOT_DISPLAY_MODES.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:{shippingGroups:t.payload.responseData}};default:return e}},z5e={smallOrderChargeThresholds:[],error:null,isFetching:!1},c5=ee("GET_SMALL_ORDER_CHARGE"),Q5e=({regionId:e,shippingGroupType:t,deliveryDestinationId:n})=>({type:"API",payload:{url:`/v1/charges/small-order-charge/thresholds?regionId=${e}&shippingGroupType=${encodeURI(t)}&deliveryDestinationId=${encodeURI(n)}`,service:"charges",pathPrefix:{client:"/api/charges",server:"/core-api"},...c5}}),qf={getSmallOrderCharge:Q5e,types:{GET_SMALL_ORDER_CHARGE:c5}},X5e=(e=z5e,t)=>{switch(t.type){case qf.types.GET_SMALL_ORDER_CHARGE.PENDING:return{...e,isFetching:!0};case qf.types.GET_SMALL_ORDER_CHARGE.ERROR:return{...e,isFetching:!1,error:t.payload};case qf.types.GET_SMALL_ORDER_CHARGE.SUCCESS:return{isFetching:!1,error:null,smallOrderChargeThresholds:t.payload.responseData};default:return e}},Z5e={charges:X5e,nextAvailableSlot:P5e,slotbooking:G5e,deliveryDetails:W5e,defaultShippingGroup:HGe,slotsConfiguration:K5e},J5e={slot:Q$e},e6e="SET_SELECTED_ADDRESS_ID",t6e={types:{SET_SELECTED_ADDRESS_ID:e6e}},s6e=(e=null,t)=>{switch(t.type){case t6e.types.SET_SELECTED_ADDRESS_ID:return t.selectedAddressId;case ea.types.SET_SELECTED_ADDRESS:return t.selectedAddress.addressId;default:return e}},d5=({control:e})=>e.delivery.selectedAddressId,u5="RESET_ACTIVE_CUSTOMER_COLLECTION_DELIVERY_DESTINATION",p5="TOGGLE_ACTIVE_CUSTOMER_COLLECTION_DELIVERY_DESTINATION",m5="SET_GEOCODE",h5="CLEAR_GEOCODE_ERROR",g5="SET_GEOCODE_SEARCH_QUERY",E5="UPDATE_NEARBY_COLLECTION_POINTS",f5="NEARBY_COLLECTION_POINTS_FETCHING",y5="NEARBY_COLLECTION_POINTS_FETCHING_ERROR",I5="CLEAR_SEARCH_RESULT",S5="SET_GEO_LOCATION_LOOKUP_STATUS",C5="CLEAR_SINGLE_COLLECTION_POINT_FILTER",T5="CLEAR_ALL_COLLECTION_POINT_FILTERS",_5="APPLY_COLLECTION_POINT_FILTERS",n6e=()=>({type:u5}),o6e=e=>({type:p5,payload:e}),r6e=e=>({type:g5,payload:{query:e}}),a6e=({geocode:e,error:t})=>({type:m5,payload:{geocode:e,error:t}}),i6e=()=>({type:h5}),l6e=()=>({type:I5}),c6e=({addresses:e,location:t,nonDefaultLocationExists:n,limit:o})=>({type:E5,payload:{addresses:e,location:t,nonDefaultLocationExists:n,limit:o}}),d6e=({complete:e})=>({type:S5,payload:e}),u6e=()=>({type:f5}),p6e=()=>({type:y5}),m6e=e=>({type:C5,payload:e}),h6e=()=>({type:T5}),g6e=e=>({type:_5,payload:e}),ms={toggleActiveCustomerCollection:o6e,resetActiveCustomerCollection:n6e,setGeocode:a6e,clearGeocodeError:i6e,setGeocodeSearchQuery:r6e,updateNearbyCollectionPoints:c6e,setNearbyCollectionPointsFetching:u6e,setNearbyCollectionPointsFetchingError:p6e,clearSearchResult:l6e,setGeolocationLookupStatus:d6e,clearSingleCollectionPointFilter:m6e,clearAllCollectionPointFilters:h6e,applyCollectionPointFilters:g6e,types:{TOGGLE_ACTIVE_CUSTOMER_COLLECTION_DELIVERY_DESTINATION:p5,RESET_ACTIVE_CUSTOMER_COLLECTION_DELIVERY_DESTINATION:u5,SET_GEOCODE:m5,CLEAR_GEOCODE_ERROR:h5,SET_GEOCODE_SEARCH_QUERY:g5,UPDATE_NEARBY_COLLECTION_POINTS:E5,NEARBY_COLLECTION_POINTS_FETCHING:f5,NEARBY_COLLECTION_POINTS_FETCHING_ERROR:y5,CLEAR_SEARCH_RESULT:I5,SET_GEO_LOCATION_LOOKUP_STATUS:S5,CLEAR_SINGLE_COLLECTION_POINT_FILTER:C5,CLEAR_ALL_COLLECTION_POINT_FILTERS:T5,APPLY_COLLECTION_POINT_FILTERS:_5}},Uu={SERVICED:"SERVICED",LOCKER:"LOCKER",MOBILE:"MOBILE"},Du={isFetching:!1,fetchError:!1,didInvalidate:!1,lastUpdated:null},E6e={id:"cncId",labelId:"delivery.collection.type.collectionPoint.text",selected:!1,sortOrder:0,supportedType:Uu.SERVICED},f6e={id:"lockerId",labelId:"delivery.collection.type.locker.text",selected:!1,sortOrder:1,supportedType:Uu.LOCKER,requiredFeatureFlag:"cptfl"},y6e={id:"mobileId",labelId:"delivery.collection.type.mobile.text",selected:!1,sortOrder:2,supportedType:Uu.MOBILE,requiredFeatureFlag:"cptfm"},XO={filters:[E6e,f6e,y6e],nearbyCollectionPointsStatus:{...Du},nearbyCollectionPointsOrderWithDistance:[],geocodeLookupComplete:!1,activeCustomerCollection:null},I6e=(e,t)=>e.filter(n=>!t.map(o=>o.id).includes(n.id)).concat(t),S6e=(e=XO,t)=>{switch(t.type){case ms.types.CLEAR_SINGLE_COLLECTION_POINT_FILTER:return{...e,filters:e.filters.filter(n=>n.id!==t.payload.id).concat({...t.payload,selected:!1})};case ms.types.CLEAR_ALL_COLLECTION_POINT_FILTERS:return{...e,filters:e.filters.map(n=>({...n,selected:!1}))};case ms.types.APPLY_COLLECTION_POINT_FILTERS:{const n=I6e(e.filters,t.payload);return{...e,filters:n,activeCustomerCollection:C6e(e.activeCustomerCollection,n)}}default:return e}},C6e=(e,t)=>e&&t.filter(n=>n.selected).map(n=>n.supportedType).includes(e.collectionPointType)?e:null,T6e=e=>e.data.delivery.clickAndCollect.collectionPoints.filters.filter(t=>!t.requiredFeatureFlag||D(t.requiredFeatureFlag)(e)).sort((t,n)=>t.sortOrder-n.sortOrder),_6e={error:null,lastUpdated:null,query:null,result:null},v6e=(e=_6e,t)=>{switch(t.type){case ms.types.SET_GEOCODE:return{...e,result:t.payload.geocode||null,error:t.payload.error||null};case ms.types.SET_GEOCODE_SEARCH_QUERY:return{...e,query:t.payload.query,lastUpdated:le()};case ms.types.CLEAR_GEOCODE_ERROR:return{...e,error:null};case ms.types.CLEAR_SEARCH_RESULT:return{query:null,result:null,error:null,lastUpdated:le()};default:return e}},LA=(e,t)=>{const o=QE(t.latitude-e.latitude),r=QE(t.longitude-e.longitude),a=QE(e.latitude),i=QE(t.latitude),l=Math.sin(zE(o))*Math.sin(zE(o))+Math.sin(zE(r))*Math.sin(zE(r))*Math.cos(a)*Math.cos(i);return 2*6371*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))},zE=e=>e/2,QE=e=>e*Math.PI/180,A6e=(e,t=10)=>e.length===0?e:(e.sort((n,o)=>n.distance-o.distance),e.slice(0,t)),b6e=(e,t)=>LA(e,t)*1e3,x6e=(e,t,n)=>A6e(e.map(o=>({deliveryDestinationId:o.deliveryDestinationId,distance:b6e(o.coordinates,t)})),n),R6e=(e=XO,t)=>{switch(t.type){case ms.types.NEARBY_COLLECTION_POINTS_FETCHING:return{...e,nearbyCollectionPointsStatus:{...e.nearbyCollectionPointsStatus,isFetching:!0}};case ms.types.NEARBY_COLLECTION_POINTS_FETCHING_ERROR:return{...e,nearbyCollectionPointsStatus:{...e.nearbyCollectionPointsStatus,isFetching:!1}};case ms.types.UPDATE_NEARBY_COLLECTION_POINTS:{const n=x6e(t.payload.addresses,t.payload.location,t.payload.limit);return{...e,nearbyCollectionPointsOrderWithDistance:n,nearbyCollectionPointsStatus:{...e.nearbyCollectionPointsStatus,isFetching:!1,lastUpdated:le()},nonDefaultLocationExists:t.payload.nonDefaultLocationExists}}case ms.types.SET_GEO_LOCATION_LOOKUP_STATUS:return{...e,geocodeLookupComplete:t.payload};default:return e}},D6e=({data:e})=>e.delivery.clickAndCollect.collectionPoints.geocodeLookupComplete,v5=({data:e})=>e.delivery.clickAndCollect.collectionPoints.nonDefaultLocationExists,O6e=(e=XO,t)=>{switch(t.type){case ms.types.RESET_ACTIVE_CUSTOMER_COLLECTION_DELIVERY_DESTINATION:return{...e,activeCustomerCollection:null};case ms.types.TOGGLE_ACTIVE_CUSTOMER_COLLECTION_DELIVERY_DESTINATION:return{...e,activeCustomerCollection:t.payload===e.activeCustomerCollection?void 0:t.payload};default:return e}},P6e=Ms({collectionPoints:AO(S6e,R6e,O6e),search:v6e}),N6e={homeDelivery:{...Du,data:{}},customerCollection:{...Du,data:{}},selectedDeliveryDestination:{...Du,data:void 0},supportedPropositions:{...Du,data:void 0}},L6e=e=>e?.reduce((t,n)=>(t[n.deliveryDestinationId]=n,t),{}),kA=e=>({...e,isFetching:!1,fetchError:!1,lastUpdated:le()}),XE=e=>({...e,isFetching:!0,fetchError:!1,didInvalidate:!1}),ZE=(e,t)=>({...e,isFetching:!1,fetchError:!0,error:t,lastUpdated:null,data:{}}),tF=(e,t)=>({...kA(e),data:L6e(t.payload?.responseData)}),{types:{GET_HOME_DELIVERY_DESTINATIONS:w_,GET_CUSTOMER_COLLECTION_DELIVERY_DESTINATIONS:F_,GET_SELECTED_DELIVERY_DESTINATION_DETAILS:B_,INVALIDATE_HOME_DELIVERY_DESTINATIONS:k6e,INVALIDATE_CUSTOMER_COLLECTION_DELIVERY_DESTINATIONS:M6e,GET_SUPPORTED_PROPOSITIONS:U_}}=sn,j6e=(e=N6e,t)=>{switch(t.type){case w_.PENDING:return{...e,homeDelivery:XE(e.homeDelivery)};case w_.SUCCESS:return{...e,homeDelivery:tF(e.homeDelivery,t)};case w_.ERROR:return{...e,homeDelivery:ZE(e.homeDelivery,t.payload)};case k6e:return{...e,homeDelivery:{...e.homeDelivery,didInvalidate:!0}};case F_.PENDING:return{...e,customerCollection:XE(e.customerCollection)};case F_.SUCCESS:return{...e,customerCollection:tF(e.customerCollection,t)};case F_.ERROR:return{...e,customerCollection:ZE(e.customerCollection,t.payload)};case M6e:return{...e,customerCollection:{...e.customerCollection,didInvalidate:!0}};case B_.PENDING:return{...e,selectedDeliveryDestination:XE(e.selectedDeliveryDestination)};case B_.SUCCESS:return{...e,selectedDeliveryDestination:{...kA(e.selectedDeliveryDestination),data:t.payload?.responseData}};case B_.ERROR:return{...e,selectedDeliveryDestination:ZE(e.selectedDeliveryDestination,t.payload)};case U_.PENDING:return{...e,supportedPropositions:XE(e.supportedPropositions)};case U_.SUCCESS:return{...e,supportedPropositions:{...kA(e.supportedPropositions),data:t.payload?.responseData}};case U_.ERROR:return{...e,supportedPropositions:ZE(e.supportedPropositions,t.payload)};default:return e}},A5=ee("GET_SUPPORTED_DELIVERY_METHODS"),w6e=()=>({type:"API",payload:{url:"/ecomdeliverydestinations/v1/supported-delivery-methods",options:{method:"GET"},service:"ecomdeliverydestinations",...A5}}),zc={getSupportedDeliveryMethods:w6e,types:{GET_SUPPORTED_DELIVERY_METHODS:A5}},F6e={...Du,data:[]},B6e=(e=F6e,t)=>{switch(t.type){case zc.types.GET_SUPPORTED_DELIVERY_METHODS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case zc.types.GET_SUPPORTED_DELIVERY_METHODS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case zc.types.GET_SUPPORTED_DELIVERY_METHODS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:t.payload.responseData};default:return e}},U6e=null,b5="PREPARE_TEMPORARY_DELIVERY_DESTINATION",G6e=e=>({type:b5,temporaryDeliveryDestination:e}),x5=ee("GET_DELIVERY_DESTINATION_DELIVERABILITY"),$6e=({latitude:e,longitude:t,postalCode:n})=>({type:"API",payload:{url:"/ecomdeliverydestinations/v2/deliverability",options:{method:"PUT",body:{latitude:e,longitude:t,postalCode:n}},service:"ecomdeliverydestinations",...x5}}),R5=ee("CREATE_TEMPORARY_DELIVERY_DESTINATION"),H6e=({visitorId:e,latitude:t,longitude:n,postalCode:o,formattedAddress:r})=>({type:"API",payload:{url:"/ecomdeliverydestinations/v2/temporary-delivery-destinations",options:{method:"POST",body:{visitorId:e,latitude:t,longitude:n,postalCode:o,formattedAddress:r}},service:"ecomdeliverydestinations",...R5}}),V6e=ee("GET_TEMPORARY_DELIVERY_DESTINATION"),Y6e=e=>({type:"API",payload:{url:`/ecomdeliverydestinations/v4/delivery-addresses/${e}`,options:{method:"GET"},service:"ecomdeliverydestinations",...V6e}}),ni={getDeliveryDestinationDeliverability:$6e,prepareTemporaryDeliveryDestination:G6e,createTemporaryDeliveryDestination:H6e,getTemporaryDeliveryDestination:Y6e,types:{PREPARE_TEMPORARY_DELIVERY_DESTINATION:b5,GET_DELIVERY_DESTINATION_DELIVERABILITY:x5,CREATE_TEMPORARY_DELIVERY_DESTINATION:R5}},W6e=(e=U6e,t)=>{switch(t.type){case ni.types.GET_DELIVERY_DESTINATION_DELIVERABILITY.DISPATCH:case ni.types.CREATE_TEMPORARY_DELIVERY_DESTINATION.SUCCESS:case Z.actionTypes.CLOSE_MODAL:return null;case ni.types.PREPARE_TEMPORARY_DELIVERY_DESTINATION:return t.temporaryDeliveryDestination;default:return e}},q6e={supportedDeliveryMethods:B6e,clickAndCollect:P6e,destinations:j6e},K6e={conciergeDelivery:q0e,selectedAddressId:s6e,selectedDeliveryDestinationId:mle,temporaryDeliveryDestination:W6e},z6e=Ms({...q6e,...Z5e}),Q6e=Ms({...K6e,...J5e}),Ou={xs:4,sm:8,md:16,lg:32,xl:64,xxl:128},cc=e=>{if(!e)return"";const t=e.top?Ou[e.top]:0,n=e.bottom?Ou[e.bottom]:0,o=e.left?Ou[e.left]:0,r=e.right?Ou[e.right]:0;return De`
        padding-block: ${H(t)} ${H(n)};
        padding-inline: ${H(o)} ${H(r)};
    `},D5=e=>e?De`
        border: ${()=>`${e.px}px ${e.style} var(--intent-${e.color}-${e.tone})`};
    `:"",O5=(e={width:0,height:0},t)=>De`
        max-inline-size: ${H(e.width)};
        max-block-size: ${H(e.height)};
        inline-size: ${t?H(e.width):"100%"};
        block-size: ${H(e.height)};
        display: unset;
        min-block-size: ${t?"unset":H(e.height)};
        min-inline-size: ${t?H(e.width):"unset"};
    `,X6e=(e={width:0,height:0},t={})=>{const n=P5(t);return e.width+n},P5=(e={})=>{const t=e.left?Ou[e.left]:0,n=e.right?Ou[e.right]:0;return t+n},Z6e=(e={width:0,height:0},t={},n={})=>{const o=P5(n),r=X6e(e,t);return o+r},N5=(e=0,t)=>De`
    font-size: var(--salt-text-${t}-font-size);
    min-block-size: calc(
        ${e} * var(--salt-text-${t}-line-height) *
            var(--salt-text-${t}-font-size)
    );
    display: ${e&&t?"unset":"none"};
`,tI=(e=0,t,n=0)=>De`
    font-size: var(--salt-text-${t}-font-size);
    min-block-size: calc(
        (
                ${e} * var(--salt-text-${t}-line-height) *
                    var(--salt-text-${t}-font-size)
            ) +
            (var(--salt-spacing-1) * ${Math.max(n-1,0)})
    );
`,sI=(e,t)=>typeof e>"u"||typeof t>"u"?0:e*t,Cl=e=>e==="sm"?"s":e==="md"?"m":e==="lg"?"l":e,sF=e=>{const t={...e};return["title","promotion","packSize","unitPrice","price","grossPrice","referencePrice","taxCodes"].forEach(o=>{t.portrait[o]?.fontSize&&(t.portrait[o].fontSize=Cl(t.portrait[o].fontSize)),t.landscape[o]?.fontSize&&(t.landscape[o].fontSize=Cl(t.landscape[o].fontSize))}),t.portrait.price?.strikethrough&&(t.portrait.price.strikethrough=Cl(t.portrait.price.strikethrough)),t.landscape.price?.strikethrough&&(t.landscape.price.strikethrough=Cl(t.landscape.price.strikethrough)),t.portrait?.catchWeightLabel&&(t.portrait.catchWeightLabel=Cl(t.portrait.catchWeightLabel)),t.landscape?.catchWeightLabel&&(t.landscape.catchWeightLabel=Cl(t.landscape.catchWeightLabel)),t.portrait?.countryOfOrigin&&(t.portrait.countryOfOrigin=Cl(t.portrait.countryOfOrigin)),t.landscape?.countryOfOrigin&&(t.landscape.countryOfOrigin=Cl(t.landscape.countryOfOrigin)),t},ls=e=>e==="xl"?"l":e,L5=ee("GET_FOP_CONFIG"),J6e="ssproductdisplayconfiguration",e8e="/v1/fop-configuration",t8e={service:J6e,url:e8e,pathPrefix:{client:"/api/visualconfiguration",server:"/core-api"},...L5},s8e=()=>({type:"API",payload:t8e}),wm={fetchFopConfigAction:s8e,types:{GET_FOP_CONFIG:L5}},n8e={portrait:{title:{numberOfLines:2,fontSize:"md"},image:{resolution:{width:175,height:175},link:!0,paddings:{bottom:"lg",left:"xs",right:"xs"}},topAttributes:{favorite:!0,featured:!0,list:!0,regulars:!0},bottomAttributes:{maxLifestyleIcons:4,ratingBadgeOrBoughtDate:!0},promotion:{icon:!0,expand:!0,compress:!1,numberOfLines:1,numberOfPromotions:2,fontSize:"md"},packSize:{fontSize:"md",position:"ownLine"},price:{strikethrough:"md",fontSize:"xl"},unitPrice:{fontSize:"md"},grossPrice:{fontSize:"md"},catchWeightLabel:"sm",orientation:"PORTRAIT",controlsContainer:{size:"md"},productCardContainer:{boxShadow:!1},divider:!1,footerContainer:{paddings:{top:"sm",bottom:"sm",left:"sm",right:"sm"},inBasketBackground:!0},headerContainer:{paddings:{top:"xs",left:"xs",right:"xs"}},blurrinessPercentage:1,countryOfOrigin:"m",referencePrice:{fontSize:"md"}},landscape:{title:{numberOfLines:2,fontSize:"md"},image:{resolution:{width:100,height:100},link:!0,paddings:{top:"sm",left:"md",right:"md"}},topAttributes:{favorite:!0,featured:!0,list:!0,regulars:!0},bottomAttributes:{maxLifestyleIcons:3,ratingBadgeOrBoughtDate:!0},promotion:{icon:!1,expand:!1,compress:!0,numberOfLines:1,numberOfPromotions:2,fontSize:"md"},packSize:{fontSize:"md",position:"ownLine"},price:{strikethrough:"md",fontSize:"xl"},unitPrice:{fontSize:"md"},grossPrice:{fontSize:"md"},catchWeightLabel:"md",orientation:"LANDSCAPE",controlsContainer:{size:"sm"},productCardContainer:{boxShadow:!1},divider:!1,footerContainer:{paddings:{top:"sm",bottom:"sm",left:"sm",right:"sm"},inBasketBackground:!0},headerContainer:{paddings:{top:"xs",left:"xs",right:"xs"}},blurrinessPercentage:1,countryOfOrigin:"m",referencePrice:{fontSize:"md"}}},o8e={...Re,data:null},r8e=(e=o8e,t)=>{switch(t.type){case wm.types.GET_FOP_CONFIG.PENDING:return{...e,isFetching:!0,fetchError:!1};case wm.types.GET_FOP_CONFIG.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload,data:sF(n8e)};case wm.types.GET_FOP_CONFIG.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:sF(t.payload.responseData),lastUpdated:le()};default:return e}},a8e=({data:e})=>e.visualConfig.fop.data,i8e="ssproductdisplayconfiguration",l8e="/v1/fop-list-configuration",k5=ee("GET_PRODUCT_LIST_CONFIG"),c8e={service:i8e,url:l8e,pathPrefix:{client:"/api/visualconfiguration",server:"/core-api"},...k5},d8e=()=>({type:"API",payload:c8e}),Fm={fetchProductListConfigAction:d8e,types:{GET_PRODUCT_LIST_CONFIG:k5}},u8e={...Re,data:null},p8e=(e=u8e,t)=>{switch(t.type){case Fm.types.GET_PRODUCT_LIST_CONFIG.PENDING:return{...e,isFetching:!0,fetchError:!1};case Fm.types.GET_PRODUCT_LIST_CONFIG.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Fm.types.GET_PRODUCT_LIST_CONFIG.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:t.payload.responseData,lastUpdated:le()};default:return e}},m8e=({data:e})=>e.visualConfig.productList.data,M5=ee("GET_ELIGIBILITY"),j5=ee("GET_DELIVERY_FREQUENCY"),w5=ee("GET_RO_SIGN_UP_SLOTS"),h8e=ee("CHECKOUT"),F5=ee("RESERVE_RO_SU_SLOT"),B5=ee("RELEASE_RO_SU_SLOT"),$p=e=>({type:"API",payload:{service:Wi,pathPrefix:{client:"/api/recurringshopping",server:""},...e}}),g8e=()=>$p({url:"/v1/web/eligibility",...M5}),E8e=()=>$p({url:"/v1/web/frequencies",...j5}),f8e=e=>$p({url:`/v1/web/slots-offering?deliveryDestinationId=${e}`,...w5}),y8e=e=>$p({url:"/v1/web/signup",options:{method:"POST",body:e},...h8e}),I8e=(e,t)=>$p({url:`/v1/web/slots/${t}/reservation`,options:{method:"PUT",body:{deliveryDestinationId:e}},...F5}),S8e=e=>$p({url:`/v1/web/slots/${e}`,options:{method:"DELETE"},...B5}),ao={getEligibility:g8e,getDeliveryFrequency:E8e,getSlots:f8e,checkout:y8e,reserveSlot:I8e,releaseSlot:S8e,actionTypes:{GET_ELIGIBILITY:M5,GET_DELIVERY_FREQUENCY:j5,GET_RO_SIGN_UP_SLOTS:w5,RESERVE_RO_SU_SLOT:F5,RELEASE_RO_SU_SLOT:B5}},C8e={...Re,data:{}},T8e=(e=C8e,t)=>{switch(t.type){case ao.actionTypes.GET_ELIGIBILITY.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case ao.actionTypes.GET_ELIGIBILITY.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case ao.actionTypes.GET_ELIGIBILITY.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),fetchSuccess:!0,data:t.payload.responseData};default:return e}},_8e={...Re,data:{}},v8e=(e=_8e,t)=>{switch(t.type){case ao.actionTypes.GET_DELIVERY_FREQUENCY.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case ao.actionTypes.GET_DELIVERY_FREQUENCY.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case ao.actionTypes.GET_DELIVERY_FREQUENCY.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),fetchSuccess:!0,data:t.payload.responseData};default:return e}},A8e={...Re,data:{}},b8e=(e=A8e,t)=>{switch(t.type){case ao.actionTypes.GET_RO_SIGN_UP_SLOTS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case ao.actionTypes.GET_RO_SIGN_UP_SLOTS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case ao.actionTypes.GET_RO_SIGN_UP_SLOTS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),fetchSuccess:!0,data:t.payload.responseData};default:return e}},U5="SET_RO_SIGN_UP_FORM_STATE",x8e=e=>({type:U5,payload:e}),Hp={setState:x8e,types:{SET_RO_SIGN_UP_FORM_STATE:U5}},it={LEARN_MORE:"LEARN_MORE",ADDRESS:"ADDRESS",ADDRESS_CLOSE:"ADDRESS_CLOSE",FREQUENCY:"FREQUENCY",FREQUENCY_CLOSE:"FREQUENCY_CLOSE",SLOT_BOOKING:"SLOT_BOOKING",SLOT_BOOKING_CLOSE:"SLOT_BOOKING_CLOSE",SUMMARY:"SUMMARY",SUMMARY_CLOSE:"SUMMARY_CLOSE",PAYMENT:"PAYMENT",PAYMENT_CLOSE:"PAYMENT_CLOSE",ORDER_CONFIRMATION:"ORDER_CONFIRMATION"},G5=5,dc="modal-header",$5={deliveryDestinationId:"",frequency:{value:"-1",unit:""},dayOfWeek:"",slotId:"",name:"",from:"",to:""},R8e={definition:{name:"",frequency:{name:void 0,unit:"",value:"-1"},deliveryWindow:{day:"",from:"",to:","}},order:{orderId:"",deliveryAddress:{nickname:"",addressId:""},deliveryWindow:{startDateTime:"",endDateTime:"",timezone:""},price:{final:{amount:"",currency:""}}}},D8e={MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,SUNDAY:7},MA=[it.ADDRESS,it.FREQUENCY,it.SLOT_BOOKING,it.SUMMARY,it.PAYMENT,it.ORDER_CONFIRMATION],O8e={dialogType:void 0,data:$5,orderComplete:R8e,paymentAuthUrl:void 0},P8e=(e=O8e,t)=>{switch(t.type){case Hp.types.SET_RO_SIGN_UP_FORM_STATE:return{...e,...t.payload};default:return e}},N8e=Ms({eligibility:T8e,frequency:v8e,slots:b8e,form:P8e}),H5=ee("GET_COMPOSABLE_NAVBAR"),L8e=()=>({type:"API",payload:{url:"/v1/composable-content/navbar",...H5}}),Bm={getComposableNavbar:L8e,actionTypes:{GET_COMPOSABLE_NAVBAR:H5}},k8e=e=>"link"in e?{type:e.link.linkType,metadata:{label:e.label,path:e.link.targets[0].value}}:{type:e.type},M8e=e=>{const t=e.includes?.Entry.reduce((o,r)=>({...o,[r.sys.id]:k8e(r.fields)}),{}),n=e.items[0].fields.items;return!t||!n?[]:n.filter(o=>t[o.sys.id]).map(o=>t[o.sys.id])},j8e={...Re},w8e=(e=j8e,t)=>{switch(t.type){case Bm.actionTypes.GET_COMPOSABLE_NAVBAR.PENDING:return{...e,isFetching:!0,fetchError:!1};case Bm.actionTypes.GET_COMPOSABLE_NAVBAR.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.error};case Bm.actionTypes.GET_COMPOSABLE_NAVBAR.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),items:M8e(t.payload.responseData)};default:return e}},V5=ee("GET_COUPONS_COUNT"),F8e=()=>({type:"API",payload:{url:"/v4/promotion/coupons/count",service:"web_product_page_ws",pathPrefix:{client:"/api/webproductpagews",server:"/core-api"},...V5}}),Um={getCouponsCount:F8e,actionTypes:{GET_COUPONS_COUNT:V5}},Y5=ee("GET_COUPONS_PAGE"),B8e=e=>({type:"API",payload:{url:"/v4/promotion/coupons",service:"web_product_page_ws",pathPrefix:{client:"/api/webproductpagews",server:"/core-api"},...Y5},isDynamicImagesEnabled:e}),Kf={getCouponsPage:B8e,actionTypes:{GET_COUPONS:Y5}},U8e={...Re,value:0},G8e=(e=U8e,t)=>{switch(t.type){case Um.actionTypes.GET_COUPONS_COUNT.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Um.actionTypes.GET_COUPONS_COUNT.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Um.actionTypes.GET_COUPONS_COUNT.SUCCESS:return{...e,isFetching:!1,fetchError:!1,value:t.payload.responseData.count};case Kf.actionTypes.GET_COUPONS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,value:t.payload.responseData.length};default:return e}},W5=({data:e})=>e.coupons.count.value,zf=ee("GET_COUPON_DETAILS"),Qf=ee("GET_COUPON_PROMOTION_IDS"),XXt=(e,t,n,o,r)=>{const a=r?`?sortOptionId=${r}`:"";return{type:"API",payload:{url:t?`/v4/promotion/retailer-id/${e}${a}`:`/v4/promotion/${e}${a}`,service:"web_product_page_ws",pathPrefix:{client:"/api/webproductpagews",server:"/core-api"},...zf},isDynamicImagesEnabled:n,imageFormats:o}},ZXt=e=>({type:"API",payload:{url:`/v1/seo/offer?id=${e}`,...Qf}}),$8e={...Re,data:{promotionPageType:"UNKNOWN",sortOptions:[],promoId:"",retailerPromotionId:"",description:"",promotionGroups:[{products:[],quantity:0}]}},H8e=(e=$8e,t)=>{switch(t.type){case zf.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case zf.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case zf.SUCCESS:{const{payload:n,isDynamicImagesEnabled:o,imageFormats:r}=t,a=n.responseData;return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:FO(a,o,r).result}}case Qf.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Qf.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Qf.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:{...e.data,promoId:t.payload.responseData.id,retailerPromotionId:t.payload.responseData.retailerId,description:t.payload.responseData.encodedName}};default:return e}},JXt=({data:e})=>e.coupons.couponDetailsPage.data,eZt=({data:e})=>e.coupons.couponDetailsPage.isFetching,G_={width:50,height:50},V8e=(e,t)=>e.map(n=>({...n,products:n.products.map(o=>{const{image:r}=o;if(!r)return o;const{availableFormats:a,availableResolutions:i,imageId:l,path:c}=r,d=A1(a,t),u=i.sort((g,f)=>g.width<f.width?-1:1),m=u.some(g=>g.width===G_.width&&g.height===G_.height)?G_:u[0];return{...o,image:{imageId:l,path:`${c}/${m?.width}x${m?.height}.${d}`}}})})),Y8e={...Re,data:[]},W8e=(e=Y8e,t)=>{switch(t.type){case Kf.actionTypes.GET_COUPONS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Kf.actionTypes.GET_COUPONS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Kf.actionTypes.GET_COUPONS.SUCCESS:{const{isDynamicImagesEnabled:n,payload:o}=t,r=o.responseData;return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:V8e(r,n)}}default:return e}},tZt=({data:e})=>e.coupons.couponsPage.data,sZt=({data:e})=>e.coupons.couponsPage.isFetching,nZt=({data:e})=>e.coupons.couponsPage.error,q8e=Ms({count:G8e,couponsPage:W8e,couponDetailsPage:H8e}),ZO=ee("GET_COMPONENTIZED_HOMEPAGE"),K8e=D("apo.pf.exp"),{GET_HOMEPAGE_CATALOGUE:z8e,FILTER_CATALOGUE:Q8e}=ft.types,X8e=({tag:e,limit:t,decoratedOnly:n,filters:o,sortOption:r,offset:a,pageToken:i,transformerConfig:l,headers:c={}})=>(d,u)=>{const m=u(),g=zb(m),f=qe(m,"display-home-sublocation"),y=tt.stringify({...f&&e.includes("lihp")&&{categoryId:f},...o&&{filters:tt.stringify(o,{arrayFormat:"separator",arrayFormatSeparator:","})},sortOptionId:r,pageToken:i,tag:e,offset:a,limit:t,decoratedOnly:n},{skipEmptyString:!0});return g&&(c.ContentExperienceUserId=g),d({type:"API",transformerConfig:l,payload:{url:`/v5/product-pages?${y}`,service:"web_product_page_ws",pathPrefix:{client:"/api/webproductpagews",server:"/core-api"},options:{headers:c,maxRetries:1},...z8e},...e.includes("lihp")&&{isProductFiltersEnabled:K8e(m)}})},q5=e=>({type:"API",payload:{service:"contentfulhelper",pathPrefix:{client:"/api/contentfulhelper",server:"/core-api"},...e}}),Z8e=()=>q5({url:"/v2/contentful/loggedinhomepage/platform/web",...ZO}),J8e=()=>q5({url:"/v2/contentful/loggedouthomepage/platform/web",...ZO}),eQe=e=>({type:Q8e,payload:e}),$_={getPPWSHomepagePage:X8e,fetchLoggedInComponentizedHomepage:Z8e,fetchLoggedOutComponentizedHomepage:J8e,filterCatalogue:eQe,actionTypes:{GET_COMPONENTIZED_HOMEPAGE:ZO}},tQe={...Re},sQe=(e=tQe,t)=>{switch(t.type){case $_.actionTypes.GET_COMPONENTIZED_HOMEPAGE.PENDING:return{...e,isFetching:!0,fetchError:!1};case $_.actionTypes.GET_COMPONENTIZED_HOMEPAGE.ERROR:return{...e,isFetching:!1,fetchError:!0};case $_.actionTypes.GET_COMPONENTIZED_HOMEPAGE.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:t.payload.responseData.items.map(n=>({...n,items:n.items})),lastUpdated:le()};default:return e}},oZt=e=>e.data.homepage,K5=ee("GET_HOMEPAGE_PROMOTION"),nQe=()=>({type:"API",payload:{service:"web_product_page_ws",url:"/v6/products/promotions?filters=boolean%3DfavoritesOnly&sort=favorite",...K5}}),H_={getHomepageFavOnOffer:nQe,actionTypes:{GET_HOMEPAGE_PROMOTION:K5}},oQe={...Re},rQe=(e=oQe,t)=>{switch(t.type){case H_.actionTypes.GET_HOMEPAGE_PROMOTION.PENDING:return{...e,isFetching:!0,fetchError:!1};case H_.actionTypes.GET_HOMEPAGE_PROMOTION.ERROR:return{...e,isFetching:!1,fetchError:!0};case H_.actionTypes.GET_HOMEPAGE_PROMOTION.SUCCESS:return{...e,isFetching:!1,fetchError:!1,promotion:t.payload.responseData};default:return e}},rZt=e=>e.data.experimentation?.promotion?.result?.productGroups,aZt=e=>e.data.experimentation?.isFetching??!1,jC={isFetching:!1,fetchError:!1,lastUpdated:null,data:void 0},Rh=(e,t,n)=>{switch(t.type){case Dr.types[n].PENDING:return{...e,isFetching:!0,fetchError:!1};case Dr.types[n].ERROR:return{...e,isFetching:!1,fetchError:!0,data:void 0};case Dr.types[n].SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:{...e?.data,...t?.payload?.responseData}};default:return e}},aQe=(e=jC,t)=>t.type==="GET_OVERRIDE_PAYMENT_METHOD_GROUPS_SUCCESS"?{...Rh(e,t,"GET_OVERRIDE_PAYMENT_METHOD_GROUPS"),data:{...e.data,overridePaymentMethodGroups:t?.payload?.responseData}}:Rh(e,t,"GET_OVERRIDE_PAYMENT_METHOD_GROUPS"),iQe=(e=jC,t)=>Rh(e,t,"GET_PAYMENT_CHECKOUT_SUMMARY"),lQe=(e=jC,t)=>Rh(e,t,"GET_ORDER_MULTI_PAYMENTS"),cQe=(e=jC,t)=>Rh(e,t,"GET_PAYMENT_CHECKOUT_SUMMARY_WITH_PAYMENT_METHOD_GROUPS"),z5=ee("GET_CHECKOUT_VALIDATION"),Q5="GET_CHECKOUT_VALIDATION_DIRECT_SUCCESS",dQe=()=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},options:{method:"PUT"},url:"/v1/carts/active/checkout-restrictions",...z5}}),uQe=(e,t)=>({type:Q5,payload:{products:e,cartSplitRequired:t}}),wc={getCheckoutValidation:dQe,setLimitedProducts:uQe,types:{GET_CHECKOUT_VALIDATION:z5,GET_CHECKOUT_VALIDATION_DIRECT_SUCCESS:Q5}},pQe="EXCEEDED_MAX_QUANTITY",mQe="LIMITED_AVAILABILITY",hQe="OUT_OF_STOCK",gQe="TIME_RESTRICTION",X5=328,EQe=184,fQe={isFetching:!1,fetchError:!1,lastUpdated:null,data:void 0},yQe=(e=fQe,t)=>{switch(t.type){case wc.types.GET_CHECKOUT_VALIDATION.PENDING:return{...e,isFetching:!0,fetchError:!1};case wc.types.GET_CHECKOUT_VALIDATION.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le()};case wc.types.GET_CHECKOUT_VALIDATION.ERROR:return{...e,isFetching:!1,fetchError:!0};case wc.types.GET_CHECKOUT_VALIDATION_DIRECT_SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:{...e.data,cartSplitRequired:t?.payload.cartSplitRequired,limitedProducts:t?.payload.products}};default:return e}},IQe=e=>e.data.checkoutValidation,Z5=V(IQe,({data:e})=>e),SQe=V(Z5,e=>e?.limitedProducts||[]),CQe=(e=!1,t)=>t.type==="UPDATE_AGE_CONFIRMATION_COOKIE"?t.value:e,J5=({session:e})=>e.ageConfirmed,e6=ee("GET_DEFAULT_BILLING_ADDRESS"),t6=ee("POST_BILLING_ADDRESS"),s6="SET_BILLING_ADDRESS",n6=ee("GET_BILLING_ADDRESS_VALIDATION"),TQe=()=>({type:"API",payload:{url:"/address/v1/billing-addresses/default",service:"webaddressws",...e6}}),_Qe=e=>({type:"API",payload:{url:"/address/v1/billing-addresses",options:{method:"POST",body:e},service:"webaddressws",...t6}}),vQe=e=>({type:s6,payload:e}),AQe=()=>({type:"API",payload:{url:"/v1/address/billing-address-validation",...n6}}),No={type:{GET_DEFAULT_BILLING_ADDRESS:e6,POST_BILLING_ADDRESS:t6,SET_BILLING_ADDRESS:s6,GET_BILLING_ADDRESS_VALIDATION:n6},getDefaultBillingAddress:TQe,postBillingAddress:_Qe,setBillingAddress:vQe,getBillingAddressValidationRules:AQe},bQe=(e={...Re,data:{}},t)=>{switch(t.type){case No.type.GET_DEFAULT_BILLING_ADDRESS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case No.type.GET_DEFAULT_BILLING_ADDRESS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case No.type.GET_DEFAULT_BILLING_ADDRESS.SUCCESS:{const{addressDetails:n,customerDetails:o}=t.payload.responseData;return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:{billingAddressId:t.payload.responseData?.billingAddressId,...n,...o}}}case No.type.POST_BILLING_ADDRESS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case No.type.POST_BILLING_ADDRESS.SUCCESS:{const{addressDetails:n,customerDetails:o}=t.payload.responseData;return{...e,data:{billingAddressId:t.payload.responseData?.billingAddressId,...n,...o},isFetching:!1,fetchError:!1,lastUpdated:le(),error:null}}case No.type.SET_BILLING_ADDRESS:return{...e,data:{...t.payload}};default:return e}},xQe=(e={...Re,data:{}},t)=>{switch(t.type){case No.type.GET_BILLING_ADDRESS_VALIDATION.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case No.type.GET_BILLING_ADDRESS_VALIDATION.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case No.type.GET_BILLING_ADDRESS_VALIDATION.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:t.payload.responseData};default:return e}},o6=ee("GET_TERMS_AND_CONDITIONS"),RQe=()=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},url:"/v1/carts/active/checkout-summary-terms",...o6}}),Gm={type:{GET_TERMS_AND_CONDITIONS:o6},getTermsAndConditions:RQe},DQe=(e={...Re,data:{termsAndConditions:[]}},t)=>{switch(t.type){case Gm.type.GET_TERMS_AND_CONDITIONS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Gm.type.GET_TERMS_AND_CONDITIONS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Gm.type.GET_TERMS_AND_CONDITIONS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:t.payload.responseData};default:return e}},r6=e=>e.data.checkoutTermsAndConditions.data.termsAndConditions,OQe=e=>e.data.checkoutTermsAndConditions.fetchError,a6=e=>e.data.checkoutTermsAndConditions.isFetching,i6=ee("FETCH_AVAILABLE_PAYMENT_CHECKS"),nF="paymentchecks",PQe=({basketTotal:e,orderId:t})=>({type:"API",payload:{service:nF,pathPrefix:{client:`/api/${nF}`,server:"/core-api"},url:"/v1/payment-checks/available",...i6,options:{method:"POST",body:{basketTotal:e,orderId:t}}}}),Xf={fetchAvailablePaymentChecks:PQe,actionTypes:{FETCH_AVAILABLE_PAYMENT_CHECKS:i6}},NQe={...Re,availablePaymentChecks:[],checksMissingRequiredTotal:[]},LQe=(e=NQe,t)=>{switch(t.type){case Xf.actionTypes.FETCH_AVAILABLE_PAYMENT_CHECKS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Xf.actionTypes.FETCH_AVAILABLE_PAYMENT_CHECKS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case Xf.actionTypes.FETCH_AVAILABLE_PAYMENT_CHECKS.SUCCESS:return{...e,...t.payload.responseData,isFetching:!1,fetchError:!1,error:null,lastUpdated:le()};default:return e}},kQe=({data:e})=>({...e.payments.paymentChecks}),l6="PSPS_FETCHED",MQe=(e=void 0,t)=>({type:l6,payload:{fetchedPsps:t,...e?{fetchedPaymentFlow:e}:{}}}),c6={pspsFetched:MQe,actionTypes:{PSPS_FETCHED:l6}},Pu={CARD:"CARD",PAYPAL:"PAYPAL"},nI={SAVED:"SAVED",NON_SAVED:"NON_SAVED"},jQe="all",wQe={psps:{all:[],[nI.SAVED]:[],[nI.NON_SAVED]:[]}},FQe=(e=wQe,t)=>{switch(t.type){case c6.actionTypes.PSPS_FETCHED:{const{fetchedPaymentFlow:n,fetchedPsps:o}=t.payload,r=n||jQe;return{psps:{...e.psps,[r]:o}}}default:return e}},BQe=({data:e})=>e.payments.pspConfig.psps.all,UQe=e=>({data:t})=>t.payments.pspConfig.psps[e].map(o=>Om.fromActiveName(o.type));V(BQe,e=>e.find(n=>n.type===L$e.DATACASH)?.amexSupported||!1);const oF="pspweb",d6=ee("GET_CHECKOUT_BASE_RECOVER_URL"),GQe=()=>({type:"API",payload:{service:oF,url:`/${oF}/v2/checkout/recover-urls`,...d6}}),Zf={getCheckoutBaseRecoverUrl:GQe,types:{GET_CHECKOUT_BASE_RECOVER_URL:d6}},$Qe=(e=Fz.threeDsRecoveryUrls,t)=>{switch(t.type){case Zf.types.GET_CHECKOUT_BASE_RECOVER_URL.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case Zf.types.GET_CHECKOUT_BASE_RECOVER_URL.ERROR:return{...e,isFetching:!1,fetchError:!0};case Zf.types.GET_CHECKOUT_BASE_RECOVER_URL.SUCCESS:return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:{pspweb:{url:t.payload.responseData.checkoutRecoverUrl}}};default:return e}},HQe=({data:e})=>e&&e.payments&&e.payments.threeDsRecoveryUrls&&e.payments.threeDsRecoveryUrls.isFetching,u6=({data:e})=>e&&e.payments&&e.payments.threeDsRecoveryUrls&&e.payments.threeDsRecoveryUrls.data,VQe=({data:e})=>e&&e.payments&&e.payments.threeDsRecoveryUrls&&e.payments.threeDsRecoveryUrls.lastUpdated,p6=ee("GET_FINANCING_PLANS"),rF="walletservice",YQe=({path:e,body:t})=>({type:"API",payload:{service:rF,url:`/${rF}/v2/financing-plans/calculate/${e}`,options:{method:"POST",body:t},...p6}}),V_={fetchFinancingPlans:YQe,types:{GET_FINANCING_PLANS:p6}},WQe=Re,qQe=(e=WQe,t)=>{switch(t.type){case V_.types.GET_FINANCING_PLANS.PENDING:return{...e,isFetching:!0,fetchError:!1,error:null};case V_.types.GET_FINANCING_PLANS.ERROR:return{...e,isFetching:!1,fetchError:!0,error:t.payload};case V_.types.GET_FINANCING_PLANS.SUCCESS:return{...e,isFetching:!1,fetchError:!1,data:t.payload.responseData,lastUpdated:le()};default:return e}},iZt=({data:e})=>e.payments.instalments.data,lZt=({data:e})=>e.payments.instalments.isFetching,m6=ee("GET_ACTIVE_PAYMENT_METHOD_GROUPS"),KQe=()=>{const e="walletservice";return{type:"API",payload:{service:e,url:`/${e}/v1/payment-method-groups`,...m6}}},Jf={fetchActivePaymentMethodGroups:KQe,types:{GET_ACTIVE_PAYMENT_METHOD_GROUPS:m6}},zQe={activePaymentMethodGroups:{isFetching:!1,fetchError:!1,lastUpdated:null,data:[]}},QQe=({data:e})=>e.payments.paymentMethodGroups.activePaymentMethodGroups.data,XQe=(e=zQe,t)=>{switch(t.type){case Jf.types.GET_ACTIVE_PAYMENT_METHOD_GROUPS.PENDING:return{...e,activePaymentMethodGroups:{...e.activePaymentMethodGroups,isFetching:!0,fetchError:!1}};case Jf.types.GET_ACTIVE_PAYMENT_METHOD_GROUPS.ERROR:return{...e,activePaymentMethodGroups:{...e.activePaymentMethodGroups,isFetching:!1,fetchError:!0}};case Jf.types.GET_ACTIVE_PAYMENT_METHOD_GROUPS.SUCCESS:return{...e,activePaymentMethodGroups:{isFetching:!1,fetchError:!1,data:t.payload.responseData,lastUpdated:le()}};default:return e}},h6=ee("GET_PAYMENT_METHOD_GROUPS_METADATA"),g6=ee("GET_PAYMENT_METHOD_PROMOTIONS"),ZQe=({groups:e,amount:t})=>({type:"API",payload:{pathPrefix:{client:"/api/walletservice",server:"/core-api"},options:{method:"POST",body:{groups:e,amount:t}},service:"walletservice",url:"/v2/payment-method-groups/metadata",...h6}}),JQe=()=>({type:"API",payload:{service:"web_basket_ws",pathPrefix:{client:"/api/cart",server:"/core-api"},options:{method:"GET"},url:"/v1/carts/active/checkout-summary/payment-groups-promotions",...g6}}),ey={fetchPaymentMethodGroupsMetadata:ZQe,types:{GET_PAYMENT_METHOD_GROUPS_METADATA:h6}},ty={fetchPaymentMethodGroupPromotions:JQe,types:{GET_PAYMENT_METHOD_PROMOTIONS:g6}},e9e={isFetching:!1,fetchError:!1,lastUpdated:null,promotionsFetching:!1,promotionsFetchError:!1},jg=({data:e})=>e.payments.paymentMethodGroupsMetadata.data,t9e=({data:e})=>e.payments.paymentMethodGroupsMetadata.isFetching,JO=V(jg,e=>e?.find(t=>t.name===ct.INSTALMENTS)),aF=(e,t)=>{if(!e?.length||!t?.length)return e||void 0;const n=new Map(e.map(o=>[o.paymentMethodGroupId,{...o}]));return t.forEach(o=>{const r=n.get(o.paymentMethodGroupId);r&&(r.promotion=!0,o.financingProviderId&&r.financingProviders?.length&&(r.financingProviders=r.financingProviders.map(a=>a.financingProviderId===o.financingProviderId?{...a,promotion:!0}:a)))}),Array.from(n.values())},s9e=(e=e9e,t)=>{switch(t.type){case ey.types.GET_PAYMENT_METHOD_GROUPS_METADATA.PENDING:return{...e,isFetching:!0,fetchError:!1};case ey.types.GET_PAYMENT_METHOD_GROUPS_METADATA.ERROR:return{...e,isFetching:!1,fetchError:!0};case ey.types.GET_PAYMENT_METHOD_GROUPS_METADATA.SUCCESS:{const n=t.payload.responseData,o=aF(n,e.promotions);return{...e,isFetching:!1,fetchError:!1,data:o,lastUpdated:le()}}case ty.types.GET_PAYMENT_METHOD_PROMOTIONS.PENDING:return{...e,promotionsFetching:!0,promotionsFetchError:!1};case ty.types.GET_PAYMENT_METHOD_PROMOTIONS.ERROR:return{...e,promotionsFetching:!1,promotionsFetchError:!0};case ty.types.GET_PAYMENT_METHOD_PROMOTIONS.SUCCESS:{const n=t.payload.responseData,o=aF(e.data,n);return{...e,promotionsFetching:!1,promotionsFetchError:!1,promotions:n,data:o}}default:return e}},n9e=Ms({paymentChecks:LQe,pspConfig:FQe,threeDsRecoveryUrls:$Qe,instalments:qQe,paymentMethodGroups:XQe,paymentMethodGroupsMetadata:s9e}),o9e={...Re,data:null,error:null},r9e=(e=o9e,t)=>{switch(t.type){case oA.types.GET_ACTIVE_SESSION.ERROR:return{...e,isFetching:!1,fetchError:!0,lastUpdated:le(),error:t.payload};case oA.types.GET_ACTIVE_SESSION.SUCCESS:return{...e,isFetching:!1,fetchError:!1,error:null,lastUpdated:le(),data:{type:t.payload.responseData?.type}};default:return e}},sy=ee("GET_POP_UP_BANNER"),a9e=()=>({type:"API",payload:{url:"/v1/pop-up?platform=WEB",service:"adverts",pathPrefix:{client:"/api/adverts",server:"/core-api"},...sy}}),i9e={...Re,data:null,vrTestingMeta:{disableAnimation:!1,disableDelay:!1}},l9e=(e=i9e,t)=>{switch(t.type){case sy.PENDING:return{...e,isFetching:!0,data:null};case sy.SUCCESS:return{...e,isFetching:!1,lastUpdated:le(),data:t.payload?.responseData||null};case sy.ERROR:return{...e,isFetching:!1,fetchError:!0,data:null};default:return e}},c9e={...Re,data:{optedIn:!1}},d9e=(e=c9e,t)=>{switch(t.type){case"GET_VOUCHERS_MARKETING_PREFERENCES_PENDING":return{...e,isFetching:!0,fetchError:!1};case"GET_VOUCHERS_MARKETING_PREFERENCES_SUCCESS":return{...e,isFetching:!1,fetchError:!1,lastUpdated:le(),data:{optedIn:t.payload.responseData.optedIn}};case"GET_VOUCHERS_MARKETING_PREFERENCES_ERROR":return{...e,isFetching:!1,fetchError:!0};default:return e}},u9e=({data:e})=>e.customer.vouchersMarketingPreferences.data.optedIn,p9e=({data:e})=>e.customer.vouchersMarketingPreferences.isFetching,m9e=(e,t)=>Ms({data:Ms({applicableLoyalty:wqe,adverts:D2e,basket:dYe,basketMerge:gYe,basketSpeculation:AYe,checkout:j2e,checkoutTermsAndConditions:DQe,checkoutValidation:yQe,draftBasket:sKe,instantShop:nqe,categories:YPe,checkoutWalk:jYe,content:A5e,customer:Ms({details:spe,accessibilitySettings:FBe,addresses:dge,addressDetails:uKe,addressValidation:iKe,billingAddress:bQe,billingAddressValidation:xQe,loyalty:Nqe,marketingPreferences:yKe,deliveryPreferences:_Ke,preferences:ETe,wallet:AO(kKe,MKe),regulars:Bze,segments:uSe,vouchersMarketingPreferences:d9e}),delivery:z6e,deliveryPass:NYe,favorite:eWe,locale:Fbe,orders:Ms({all:dWe,pending:cle,past:aWe,current:Ms({order:mqe,refunds:bqe}),orderEntities:Hhe,failedPayments:YYe,recurring:Ms({definitions:_We,editDefinition:NWe,placeholders:fWe,notifications:MWe})}),popupBanner:l9e,recurringOrdersSignUp:N8e,payments:n9e,visualConfig:Ms({fop:r8e,productList:p8e}),products:Ms({alternatives:dVe,catalogue:jde,basket:xYe,offers:qKe,productEntities:yhe,missedPromotions:PYe}),bop:Ms({details:Pve,reviews:n5e}),shopperOptimisations:Ms({recommendations:tze.recommendedProductsReducer}),retailer:Ms({addressFields:hKe,retailerConfig:Tce}),loyaltySettings:Pqe,search:JWe,shopInShop:zKe,recipes:$3e,mealPlanning:Z3e,listerPage:x5e,toggleablePromotions:R5e,coupons:q8e,composableNavbar:w8e,homepage:sQe,experimentation:rQe,orderPayment:Ms({paymentMethodGroups:aQe,orderPaymentCheckoutSummary:iQe,orderMultiPayments:lQe,orderPaymentCheckoutSummaryWithPaymentMethodGroups:cQe})}),session:Ms({csrf:WVe,features:Tae,metadata:Pae,additionalDetails:ipe,isSuperuser:(n=!1)=>n,isLoggedIn:(n=!1)=>n,ageConfirmed:CQe,linkTypeDetector:Aje,customerSession:r9e}),control:Ms({modal:sWe,notifications:B0e,addWalletItemModal:o2e,addPspwebWalletItemModal:i2e,payments:q2e,addAddressOrigin:oKe,delivery:Q6e}),router:Aae({initialLocation:e,basePath:t}),retailerSettings:(n={})=>n,cookieConsent:S$e}),h9e=window.__INITIAL_STATE__,g9e=window.location,E9e=(e=[],t=h9e,n=g9e)=>{const o=m9e(n,t?.session?.metadata?.basePath);return ire(o,t,Ct(lre(...e,xHe,dh,Gae,KHe,RVe,bHe,PHe,QVe,e2e,nVe,hVe,uVe,jVe,HVe,VVe,tTe,qNe),window.__WEB_THEMING_EXTENSION__?window.__WEB_THEMING_EXTENSION__():r=>r,window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():r=>r))},Y_=E9e(),E6=({updateCookieConsent:e})=>{const t=new zi,n=o=>{o.name===$s.OPTANON_CONSENT&&new URLSearchParams(o.value).get("groups")&&e()};return h.useEffect(()=>(t.addChangeListener(n),()=>{t.removeChangeListener(n)}),[]),null};E6.propTypes={updateCookieConsent:p.func};const f9e=e=>({updateCookieConsent:tK.updateCookieConsent(e)}),y9e=ke(null,f9e)(E6),I9e=e=>cre({sdkKey:e,logLevel:"warn"}),S9e=({children:e})=>{const t=Cs("optimizely-sdk-key"),n=E(zb),o=ie.useMemo(()=>t?I9e(t):void 0,[t]);return o?s.jsx(dre,{optimizely:o,user:{id:n??null},children:e}):s.jsx(ie.Fragment,{children:e})},C9e=({store:e,router:t,helmetContext:n={}})=>s.jsx(kb,{store:e,children:s.jsx(ure,{context:n,children:s.jsx(S9e,{children:s.jsxs(h.Fragment,{children:[s.jsx(y9e,{}),s.jsx(pre,{router:t})]})})})}),T9e=["md","lg"],_9e=()=>{const e=ll(),t=E(Qae),n=E(Xae),o=E(Wt),r=E(Ze),a=typeof e<"u"&&T9e.includes(e);return h.useEffect(()=>{const c=()=>{const{protocol:u,hostname:m,port:g=""}=window.location;return`${u}//${m}${g&&":"}${g}`},d=u=>{window&&u.origin===c()&&u.data?.type==="LOGIN_SUCCESS"&&window.location.reload()};return r||window.addEventListener("message",d),()=>{window.removeEventListener("message",d)}}),t&&!r&&(a||!a&&n)?s.jsx("iframe",{title:"sso-iframe","data-test":"sso-iframe",src:Fr({basePath:o,queryString:"silent=true"}),style:{display:"none"}}):null},v9e=()=>{const e=F(),t=Da.updateCustomerPreferenceSkipPaymentBufferModal;return h.useCallback(n=>{e(Da.setCustomerPreferenceSkipPaymentBufferModal(n)),e(t(n))},[e])},A9e=()=>{const e=F(),t=Da.updateCustomerPreferenceSkipEditOrderModal;return h.useCallback(n=>{e(Da.setCustomerPreferenceSkipEditOrderModal(n)),e(t(n))},[e])},b9e=e=>{const t=Da.getCustomerPreferenceSkipEditOrderModal;return e.dispatch(n=>n(t()))},x9e=e=>{const t=Da.getCustomerPreferenceSkipPaymentBufferModal;return e.dispatch(n=>n(t()))},R9e=e=>{const t=Da.getCustomerPreferenceBasketView;return e.dispatch(n=>n(t()))},f6=e=>({type:"UPDATE_AGE_CONFIRMATION_COOKIE",value:e}),D9e=ee("GET_CUSTOMER_SEGMENTS"),O9e="customersegments",P9e="/v1/customer-segments/short-code-lists",N9e={service:O9e,pathPrefix:{client:"/api/customer-segments",server:"/core-api"}},L9e=()=>({type:"API",payload:{url:P9e,...N9e,...D9e}}),k9e={getCustomerSegments:L9e},M9e=async e=>e.dispatch(t=>t(k9e.getCustomerSegments())),iF={Collection:"COLLECTION",HomeDelivery:"HOME_DELIVERY"},j9e={MaxProductsReached:"MAX_PRODUCTS_REACHED"},lF={ListNameInvalid:"LIST_NAME_INVALID",MaxListsReached:"MAX_LISTS_REACHED"},cZt={ListNameInvalid:"LIST_NAME_INVALID"},w9e={Standard:"STANDARD"},F9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetFooter"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"footer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"contactUs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"shouldBeOpenedInNewTab"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticPageTarget"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staticPage"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WebAddressTarget"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"columns"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"links"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"target"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"shouldBeOpenedInNewTab"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticPageTarget"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staticPage"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WebAddressTarget"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"socialMedia"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"serviceId"}},{kind:"Field",name:{kind:"Name",value:"profileUrl"}},{kind:"Field",name:{kind:"Name",value:"tooltip"}}]}},{kind:"Field",name:{kind:"Name",value:"legalText"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstItem"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"richText"}}]}},{kind:"Field",name:{kind:"Name",value:"secondItem"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"richText"}}]}}]}}]}}]}}]},B9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetMenuCampaigns"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"menuCampaigns"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"menuCampaignId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"iconUrl"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"menuCampaignItemId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"imageUrl"}},{kind:"Field",name:{kind:"Name",value:"altText"}},{kind:"Field",name:{kind:"Name",value:"target"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"shouldBeOpenedInNewTab"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WebAddressTarget"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticPageTarget"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staticPage"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchTarget"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchTerm"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ShopInShopTarget"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shop"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CategoryTarget"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"categoryId"}},{kind:"Field",name:{kind:"Name",value:"retailerCategoryId"}},{kind:"Field",name:{kind:"Name",value:"nameHierarchy"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PromotionTarget"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"promotionId"}},{kind:"Field",name:{kind:"Name",value:"retailerPromotionId"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ProductTarget"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"productId"}},{kind:"Field",name:{kind:"Name",value:"retailerProductId"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}}]}}]}}]}}]}}]},U9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetShoppingListsOnLoggedInHomePage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingLists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingListId"}}]}}]}}]},G9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetCompletedOrders"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"completedOrders"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"retentionPeriod"}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"endCursor"}},{kind:"Field",name:{kind:"Name",value:"hasNextPage"}}]}},{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orderId"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"region"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"retailerRegionId"}}]}},{kind:"Field",name:{kind:"Name",value:"prices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"total"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currency"}},{kind:"Field",name:{kind:"Name",value:"amount"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"recurringOrderDefinition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}},{kind:"Field",name:{kind:"Name",value:"slot"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InternalOrderSlot"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"start"}},{kind:"Field",name:{kind:"Name",value:"end"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"shippingGroupType"}},{kind:"Field",name:{kind:"Name",value:"carrier"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"carrierId"}}]}},{kind:"Field",name:{kind:"Name",value:"externalLocker"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"externalLockerId"}}]}},{kind:"Field",name:{kind:"Name",value:"deliveryDestination"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deliveryMethod"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"address"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"timeZone"}}]}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ImportedOrderSlot"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"start"}},{kind:"Field",name:{kind:"Name",value:"end"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"timeZone"}}]}}]}}]}}]}}]}}]}}]},$9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ShoppingListCreate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shoppingListCreateInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ShoppingListCreateInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingListCreate"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shoppingListCreateInput"},value:{kind:"Variable",name:{kind:"Name",value:"shoppingListCreateInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"shoppingListId"}}]}},{kind:"Field",name:{kind:"Name",value:"success"}},{kind:"Field",name:{kind:"Name",value:"failureReason"}}]}}]}}]},H9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ShoppingListDelete"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shoppingListDeleteInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ShoppingListDeleteInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingListDelete"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shoppingListDeleteInput"},value:{kind:"Variable",name:{kind:"Name",value:"shoppingListDeleteInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},V9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ShoppingListUpdateName"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shoppingListUpdateNameInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ShoppingListUpdateNameInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingListUpdateName"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shoppingListUpdateNameInput"},value:{kind:"Variable",name:{kind:"Name",value:"shoppingListUpdateNameInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"shoppingListId"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}},{kind:"Field",name:{kind:"Name",value:"success"}},{kind:"Field",name:{kind:"Name",value:"failureReason"}}]}}]}}]},Y9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ShoppingListAddProduct"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shoppingListAddProductInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ShoppingListAddProductInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingListAddProduct"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shoppingListAddProductInput"},value:{kind:"Variable",name:{kind:"Name",value:"shoppingListAddProductInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"success"}},{kind:"Field",name:{kind:"Name",value:"failureReason"}}]}}]}}]},W9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ShoppingListRemoveProduct"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shoppingListRemoveProductInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ShoppingListRemoveProductInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingListRemoveProduct"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shoppingListRemoveProductInput"},value:{kind:"Variable",name:{kind:"Name",value:"shoppingListRemoveProductInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},q9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetShoppingListsForListsModal"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingLists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingListId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"products"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"productId"}}]}}]}}]}}]},K9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CartAddShoppingList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"addShoppingListInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CartAddShoppingListInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cartAddShoppingList"},arguments:[{kind:"Argument",name:{kind:"Name",value:"addShoppingListInput"},value:{kind:"Variable",name:{kind:"Name",value:"addShoppingListInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"successfulUpdates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"product"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"productId"}}]}},{kind:"Field",name:{kind:"Name",value:"quantity"}}]}},{kind:"Field",name:{kind:"Name",value:"unsuccessfulUpdates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"product"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"productId"}}]}},{kind:"Field",name:{kind:"Name",value:"quantity"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}}]}}]}}]},z9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetShoppingList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shoppingListId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingList"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shoppingListId"},value:{kind:"Variable",name:{kind:"Name",value:"shoppingListId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingListId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"productCount"}},{kind:"Field",name:{kind:"Name",value:"offerCount"}},{kind:"Field",name:{kind:"Name",value:"lastModifiedDateTime"}},{kind:"Field",name:{kind:"Name",value:"prices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"basePrice"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"amount"}},{kind:"Field",name:{kind:"Name",value:"currency"}}]}},{kind:"Field",name:{kind:"Name",value:"discountedPrice"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"amount"}},{kind:"Field",name:{kind:"Name",value:"currency"}}]}},{kind:"Field",name:{kind:"Name",value:"savings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"amount"}},{kind:"Field",name:{kind:"Name",value:"currency"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"products"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"productId"}}]}}]}}]}}]},Q9e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetShoppingLists"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"width"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isAlcoholBlurringEnabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isAgeRestrictedVisibilityEnabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingLists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shoppingListId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"productCount"}},{kind:"Field",name:{kind:"Name",value:"offerCount"}},{kind:"Field",name:{kind:"Name",value:"prices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"discountedPrice"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"amount"}},{kind:"Field",name:{kind:"Name",value:"currency"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"products"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"productId"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"isAlcohol"},directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"isAlcoholBlurringEnabled"}}}]}]},{kind:"Field",name:{kind:"Name",value:"primaryImage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"width"},value:{kind:"Variable",name:{kind:"Name",value:"width"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}},{kind:"Field",name:{kind:"Name",value:"restrictions"},directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"isAgeRestrictedVisibilityEnabled"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"restrictedVisibility"}}]}}]}}]}}]}}]},X9e={"\n    query GetFooter {\n        footer {\n            contactUs {\n                __typename\n                shouldBeOpenedInNewTab\n                ... on StaticPageTarget {\n                    staticPage\n                }\n                ... on WebAddressTarget {\n                    url\n                }\n            }\n            columns {\n                title\n                links {\n                    text\n                    target {\n                        __typename\n                        shouldBeOpenedInNewTab\n                        ... on StaticPageTarget {\n                            staticPage\n                        }\n                        ... on WebAddressTarget {\n                            url\n                        }\n                    }\n                }\n            }\n            socialMedia {\n                serviceId\n                profileUrl\n                tooltip\n            }\n            legalText {\n                firstItem {\n                    id\n                    name\n                    richText\n                }\n                secondItem {\n                    id\n                    name\n                    richText\n                }\n            }\n        }\n    }\n":F9e,"\n    query GetMenuCampaigns {\n        menuCampaigns {\n            menuCampaignId\n            name\n            label\n            iconUrl\n            items {\n                menuCampaignItemId\n                name\n                label\n                imageUrl\n                altText\n                target {\n                    __typename\n                    shouldBeOpenedInNewTab\n                    ... on WebAddressTarget {\n                        url\n                    }\n                    ... on StaticPageTarget {\n                        staticPage\n                    }\n                    ... on SearchTarget {\n                        searchTerm\n                    }\n                    ... on ShopInShopTarget {\n                        shop\n                    }\n                    ... on CategoryTarget {\n                        categoryId\n                        retailerCategoryId\n                        nameHierarchy\n                    }\n                    ... on PromotionTarget {\n                        promotionId\n                        retailerPromotionId\n                        description\n                    }\n                    ... on ProductTarget {\n                        productId\n                        retailerProductId\n                        description\n                    }\n                }\n            }\n        }\n    }\n":B9e,"\n    query GetShoppingListsOnLoggedInHomePage {\n        shoppingLists {\n            shoppingListId\n        }\n    }\n":U9e,"\n    query GetCompletedOrders($first: Int!, $after: String) {\n        completedOrders(first: $first, after: $after) {\n            retentionPeriod\n            pageInfo {\n                endCursor\n                hasNextPage\n            }\n            edges {\n                node {\n                    orderId\n                    status\n                    region {\n                        retailerRegionId\n                    }\n                    prices {\n                        total {\n                            currency\n                            amount\n                        }\n                    }\n                    recurringOrderDefinition {\n                        name\n                    }\n                    slot {\n                        __typename\n                        ... on InternalOrderSlot {\n                            start\n                            end\n                            type\n                            shippingGroupType\n                            carrier {\n                                carrierId\n                            }\n                            externalLocker {\n                                externalLockerId\n                            }\n                            deliveryDestination {\n                                deliveryMethod\n                                name\n                                address {\n                                    timeZone\n                                }\n                            }\n                        }\n                        ... on ImportedOrderSlot {\n                            start\n                            end\n                            name\n                            timeZone\n                        }\n                    }\n                }\n            }\n        }\n    }\n":G9e,"\n    mutation ShoppingListCreate($shoppingListCreateInput: ShoppingListCreateInput!) {\n        shoppingListCreate(shoppingListCreateInput: $shoppingListCreateInput) {\n            shoppingList {\n                __typename\n                shoppingListId\n            }\n            success\n            failureReason\n        }\n    }\n":$9e,"\n    mutation ShoppingListDelete($shoppingListDeleteInput: ShoppingListDeleteInput!) {\n        shoppingListDelete(shoppingListDeleteInput: $shoppingListDeleteInput) {\n            success\n        }\n    }\n":H9e,"\n    mutation ShoppingListUpdateName($shoppingListUpdateNameInput: ShoppingListUpdateNameInput!) {\n        shoppingListUpdateName(shoppingListUpdateNameInput: $shoppingListUpdateNameInput) {\n            shoppingList {\n                __typename\n                shoppingListId\n                name\n            }\n            success\n            failureReason\n        }\n    }\n":V9e,"\n    mutation ShoppingListAddProduct($shoppingListAddProductInput: ShoppingListAddProductInput!) {\n        shoppingListAddProduct(shoppingListAddProductInput: $shoppingListAddProductInput) {\n            shoppingList {\n                __typename\n            }\n            success\n            failureReason\n        }\n    }\n":Y9e,"\n    mutation ShoppingListRemoveProduct(\n        $shoppingListRemoveProductInput: ShoppingListRemoveProductInput!\n    ) {\n        shoppingListRemoveProduct(shoppingListRemoveProductInput: $shoppingListRemoveProductInput) {\n            shoppingList {\n                __typename\n            }\n            success\n        }\n    }\n":W9e,"\n    query GetShoppingListsForListsModal {\n        shoppingLists {\n            shoppingListId\n            name\n            products {\n                productId\n            }\n        }\n    }\n":q9e,"\n    mutation CartAddShoppingList($addShoppingListInput: CartAddShoppingListInput!) {\n        cartAddShoppingList(addShoppingListInput: $addShoppingListInput) {\n            successfulUpdates {\n                product {\n                    productId\n                }\n                quantity\n            }\n            unsuccessfulUpdates {\n                product {\n                    productId\n                }\n                quantity\n                reason\n            }\n        }\n    }\n":K9e,"\n    query GetShoppingList($shoppingListId: ID!) {\n        shoppingList(shoppingListId: $shoppingListId) {\n            shoppingListId\n            name\n            productCount\n            offerCount\n            lastModifiedDateTime\n            prices {\n                basePrice {\n                    amount\n                    currency\n                }\n                discountedPrice {\n                    amount\n                    currency\n                }\n                savings {\n                    amount\n                    currency\n                }\n            }\n            products {\n                productId\n            }\n        }\n    }\n":z9e,"\n    query GetShoppingLists(\n        $width: Int!\n        $isAlcoholBlurringEnabled: Boolean!\n        $isAgeRestrictedVisibilityEnabled: Boolean!\n        $first: Int\n    ) {\n        shoppingLists {\n            shoppingListId\n            name\n            productCount\n            offerCount\n            prices {\n                discountedPrice {\n                    amount\n                    currency\n                }\n            }\n            products(first: $first) {\n                productId\n                description\n                isAlcohol @include(if: $isAlcoholBlurringEnabled)\n                primaryImage(width: $width) {\n                    url\n                }\n                restrictions @include(if: $isAgeRestrictedVisibilityEnabled) {\n                    restrictedVisibility\n                }\n            }\n        }\n    }\n":Q9e};function Fd(e){return X9e[e]??{}}const y6=Fd(`
    query GetMenuCampaigns {
        menuCampaigns {
            menuCampaignId
            name
            label
            iconUrl
            items {
                menuCampaignItemId
                name
                label
                imageUrl
                altText
                target {
                    __typename
                    shouldBeOpenedInNewTab
                    ... on WebAddressTarget {
                        url
                    }
                    ... on StaticPageTarget {
                        staticPage
                    }
                    ... on SearchTarget {
                        searchTerm
                    }
                    ... on ShopInShopTarget {
                        shop
                    }
                    ... on CategoryTarget {
                        categoryId
                        retailerCategoryId
                        nameHierarchy
                    }
                    ... on PromotionTarget {
                        promotionId
                        retailerPromotionId
                        description
                    }
                    ... on ProductTarget {
                        productId
                        retailerProductId
                        description
                    }
                }
            }
        }
    }
`),Z9e=()=>{const e=Ne(),t=F(),n=E(f0);RW({onVisibilityChange:o=>{o||n||t(a_(!0))}}),h.useEffect(()=>{if(!n&&document.visibilityState==="hidden"){t(a_(!0));return}n&&document.visibilityState==="visible"&&t(a_(!1))},[e.pathname])};function cF(e){return e==="ar-SA"?"ar-SA-u-nu-latn":e??"en-GB"}const J9e=({children:e})=>{const t=E(bR);return o0(t.active),s.jsxs(h.Fragment,{children:[s.jsx(_o,{htmlAttributes:{lang:cF(t.active),dir:t.direction??"ltr"}}),s.jsx(mre,{textComponent:"span",locale:cF(t.active),messages:t.strings,defaultLocale:"en-GB",children:e})]})},e7e=D("intlkey"),t7e=({children:e})=>{const t=E(e7e),n=M(),o=h.useRef([]),r=h.useRef(new Set);h.useEffect(()=>{const c=()=>{for(;o.current.length;){const d=o.current.pop();d&&Me.api.pushError(d.translationError,{context:{errorData:JSON.stringify(d?.errorData)}})}};return window.addEventListener("load",c),()=>{window.removeEventListener("load",c)}},[]);const a=(c,d)=>{typeof document<"u"&&c[d]===void 0&&i(d)},i=c=>{const{locale:d}=n,u=`${c}-${d}`;if(!r.current.has(u)){r.current.add(u);const m=new Error("Translation missing"),g={id:c,locale:d};document.readyState==="complete"?Me.api.pushError(m,{context:{errorData:JSON.stringify(g)}}):o.current.push({translationError:m,errorData:g})}},l=h.useMemo(()=>({...n,formatMessage:(c,d)=>{const u=typeof c=="string"?c:c.id;return t?u:(typeof u<"u"&&a(n.messages,u),n.formatMessage({id:u,defaultMessage:" "},d))}}),[n]);return s.jsx(hre.Provider,{value:l,children:e})},s7e=(e,t)=>{if(t&&Object.keys(t).length>0){const n=Object.keys(t).map(o=>`{${o}}`).join(",");return`${e} with placeholders ${n}`}return e},v=({id:e,values:t={}})=>{const n=ie.useMemo(()=>s7e(e,t),[e,t]);return s.jsx(_t,{id:e,defaultMessage:n,...Object.keys(t).length>0&&{values:t}})},Ul={AWCV:"AWCV",FJPY:"FJPY",CGVB:"CGVB",FKSN:"FKSN",LWCD:"LWCD",SNXC:"SNXC",YBKD:"YBKD",MJSA:"MJSA"},n7e=D("gtm.tgt"),o7e=D("gtm.r"),Bd=({children:e,targetName:t})=>{const n=E(o7e);if(!E(n7e))return e||null;const r=ie.Children.toArray(e);return r.length>0?(r[0]=ie.cloneElement(r[0],{"data-gtm-target":t}),n?s.jsx(Sh,{targetName:t,children:r}):r):n?s.jsx(Sh,{targetName:t,children:s.jsx("div",{"data-gtm-target":t})}):s.jsx("div",{"data-gtm-target":t})},r7e=({targetNameKey:e,children:t})=>!e||!Ul[e]?s.jsx(h.Fragment,{children:t}):s.jsx(Bd,{targetName:Ul[e],children:t}),a7e=T.div`
    position: relative;
    display: inline-block;
    inset-block-start: ${H(3)};
    margin-inline-end: var(--salt-spacing-1);
`,ln=({title:e,titleValues:t,titleAs:n="h2",titleIcon:o,description:r,primaryButton:a,secondaryButton:i,image:l,gtmTargetNameKey:c})=>{const d=!!a&&"to"in a&&!!a.to,u=!!a&&"onClick"in a&&!!a.onClick,g=a&&a.text?{asButton:u,asLink:d}:!1,f=i&&i.text?{asButton:!!i.onClick}:!1,y={image:!!l,title:!!e&&!!n||!!o,titleText:!!e,titleIcon:!!o,description:!!r,primaryButton:g,secondaryButton:f},I=a&&typeof y.primaryButton!="boolean"&&y.primaryButton.asButton,S=a&&typeof y.primaryButton!="boolean"&&y.primaryButton.asLink,C=i&&typeof y.secondaryButton!="boolean"&&y.secondaryButton.asButton,_=(y.title||y.description)&&(y.primaryButton||y.secondaryButton)?"salt-d--flex salt-m-t--8":"salt-d--flex";return s.jsxs(h.Fragment,{children:[y.image&&s.jsx(se,{justify:"center",className:"salt-m-b--4",children:s.jsx(me,{name:l,height:250,width:250})}),y.title&&s.jsxs("div",{className:y.description?"salt-m-b--4":void 0,children:[y.titleIcon&&s.jsx(a7e,{children:s.jsx(me,{name:o})}),s.jsx(ne,{className:"salt-d--inline",as:n,children:y.titleText&&s.jsx(v,{id:e??"",values:t})})]}),y.description&&s.jsx(P,{size:"l",children:s.jsx(r7e,{targetNameKey:c,children:s.jsx(v,{id:r??""})})}),y.primaryButton&&s.jsxs("div",{className:_,children:[u&&I&&s.jsx(b,{intent:"primary",fill:!0,loading:a.loading,onClick:a.onClick,...a.aria,children:s.jsx(b.Text,{children:s.jsx(v,{id:a.text})})}),S&&d&&a.to&&s.jsx(b,{asChild:!0,intent:"primary",fill:!0,...a.aria,children:s.jsx(Qe,{intent:"ghost",to:a.to,children:s.jsx(b.Text,{children:s.jsx(v,{id:a.text})})})})]}),y.secondaryButton&&s.jsx("div",{className:"salt-d--flex",children:C&&s.jsx(b,{className:y.primaryButton?"salt-m-t--1":void 0,intent:"secondary",fill:!0,loading:i.loading,onClick:i.onClick,...i.aria,children:s.jsx(b.Text,{children:s.jsx(v,{id:i.text})})})})]})},I6=h.createContext({});function eP(){return h.useContext(I6)}I6.Provider;const i7e=()=>window.location.reload(),ur=({errorMessageKey:e,showRefreshLink:t=!1,statusCode:n})=>{const o=eP();return o&&n&&(o.statusCode=n),s.jsx(Y,{fixed:!0,"data-test":"in-page-error",className:"salt-m-t--16",children:s.jsx(Y.Item,{colStart:{sm:3,md:4,lg:5},colSpan:{xs:12,sm:8,md:6,lg:4},children:s.jsx(ln,{titleIcon:"status_no",title:"error.in.page.title",titleAs:"h1",description:e??"error.in.page.default.message",primaryButton:t?{text:"error.in.page.refresh.link",onClick:i7e}:void 0})})})};class l7e extends h.Component{static getDerivedStateFromError(){return{hasError:!0}}constructor(t){super(t),this.state={hasError:!1}}componentDidUpdate(t){this.state.hasError&&this.props.location.pathname!==t.location.pathname&&this.setState({hasError:!1})}componentDidCatch(t){try{throw t}catch(n){this.props.actions.analyticsEvent({type:OS.ERROR,boundaryType:this.props.type,errorType:"ERROR_BOUNDARY"}),Me.api.pushError(n instanceof Error?n:new Error(`ErrorBoundary error: ${JSON.stringify(n)}`),{context:{requestId:this.props.requestId,message:`ErrorBoundary (${this.props.type}) component caught the following error: ${n instanceof Error?n.message:"unknown"}`}})}}render(){return this.state.hasError?s.jsx(ur,{}):this.props.children}}const c7e=e=>({requestId:tS(e)}),d7e=ot({analyticsEvent:U.analyticsEvent}),u7e=ke(c7e,d7e),tP=u7e(l7e),S6=h.createContext({fop:null,productList:null}),wC=()=>h.useContext(S6),p7e=({children:e})=>{const t=F(),n=E(a8e),o=E(m8e),r=i=>{if(i.data.type==="VISUAL_CONFIG"&&i.data.payload.type==="FOP"){const l=i.data.payload.data;t({type:wm.types.GET_FOP_CONFIG.SUCCESS,payload:{responseData:l}})}if(i.data.type==="VISUAL_CONFIG"&&i.data.payload.type==="PRODUCT_LIST"){const l=i.data.payload.data;t({type:Fm.types.GET_PRODUCT_LIST_CONFIG.SUCCESS,payload:{responseData:l}})}};h.useEffect(()=>(window.addEventListener("message",r),()=>window.removeEventListener("message",r)),[]);const a=h.useMemo(()=>({fop:n,productList:o}),[n,o]);return s.jsx(S6.Provider,{value:a,children:e})},fe=e=>{const t=E(zh);return e.map(n=>t.includes(n))},ts=()=>{const e=F();return n=>{e(U.analyticsEvent(n))}},C6=()=>{const e=Ne(),t=$e(wa),n=$e(Va);return{getAuthToken:async()=>{const a=await fetch("/chat/auth",Qu({clientRouteId:t,csrfToken:n,method:"GET"}));return a.ok?{token:(await a.json()).token}:(z.error("request.error.title"),{token:""})},getCustomDataToken:async()=>{const a={chatInitiationPage:e.pathname},i=await fetch("/chat/custom-data",Qu({clientRouteId:t,csrfToken:n,method:"POST",contentType:"application/json",body:JSON.stringify(a)}));return i.ok?{token:(await i.json()).token}:(z.error("request.error.title"),{token:""})}}},T6=h.createContext({ujet:void 0,unreadMessageCount:0}),m7e=({children:e})=>{const t=Cs("ujet-company-key"),n=Cs("ujet-language"),o=Cs("ujet-company-host"),r=ts(),{getAuthToken:a}=C6(),[i,l]=h.useState(0),[c,d]=h.useState();h.useEffect(()=>(u(),()=>{y()}),[]),h.useEffect(()=>{c?.visible&&i>0&&l(0)},[c?.visible]);const u=()=>{if(typeof window<"u"&&typeof window.UJET=="function"&&!c&&t){const I=new window.UJET({companyId:t,host:o,authenticate:a,lang:n});I?.on("chat.message",m),I?.on("chat.connected",g),I?.on("chat.disconnected",f),d(I)}},m=()=>{const I=localStorage.getItem("ujet:unread")??"0";l(Number(I))},g=()=>{r({type:Yu.CHAT_WITH_US_SESSION_STARTED})},f=()=>{r({type:Yu.CHAT_WITH_US_SESSION_ENDED})},y=()=>{c?.off("chat.message",m),c?.off("chat.connected",g),c?.off("chat.disconnected",f)};return s.jsx(T6.Provider,{value:{ujet:c,unreadMessageCount:i},children:e})},h7e=({children:e})=>{const[t]=fe(["ccai"]);return!t||typeof window>"u"?s.jsx(h.Fragment,{children:e}):s.jsx(m7e,{children:e})};function g7e({graphQLErrors:e}){return e.some(t=>t?.extensions?.code==="context-error")}function E7e(e){const t=`${window.location.pathname}${window.location.search||""}`,n=`destination=${encodeURIComponent(t)}`;return Fr({basePath:e,queryString:n})}function f7e(e){return gre({onError(t){g7e(t)&&(SO(),window.location.replace(E7e(e)))}})}function y7e({children:e}){const t=E(Wt),n=E(wa),o=E(Va),r=E(oS),a=ie.useMemo(()=>{const i=Ere({isClient:!0,initialState:window.__URQL_DATA__});return new fre({url:`${t??""}/graphql`,exchanges:[Ire,f7e(t),i,Sre],fetchOptions:()=>({credentials:"same-origin",headers:{"x-csrf-token":o,"ecom-request-source":"web","ecom-request-source-version":r,...n&&{"client-route-id":n}}})})},[t]);return s.jsx(yre,{value:a,children:e})}const I7e=({children:e})=>typeof window>"u"?s.jsx(h.Fragment,{children:e}):s.jsx(y7e,{children:e}),S7e=(e,t)=>{const o={...tt.parse(e.search),error:void 0},r=tt.stringify(o),a=r?`${e.pathname}?${r}`:e.pathname;t(a)},Al={authenticationError:"authenticationError",logoutError:"logoutError",customerDisabled:"customerDisabled",paypal:"paypal",changeCredentialsError:"changeCredentialsError"},C7e={[Al.customerDisabled]:"common.login.customerDisabled",[Al.authenticationError]:"toast.notification.generic.error",[Al.logoutError]:"toast.notification.generic.error",[Al.paypal]:"toast.notification.generic.error",[Al.changeCredentialsError]:"toast.notification.generic.error"};function T7e(e){return typeof e=="string"&&e in Al}const _7e=()=>{const e=F(),t=We(),n=Ne(),o=r=>{e(U.analyticsEvent({type:on.LOGIN_FAILURE_ANALYTICS,error:r}));const a={event:"event",eventAction:"LoginFailure",eventLabel:r,eventCategory:"Login"};J.sendEvent({GA:a,WA:null})};return h.useEffect(()=>{const a=new URLSearchParams(n.search).get("error"),i=a===Al.authenticationError||a===Al.customerDisabled;T7e(a)&&(i&&o(a),z.error(C7e[a]),S7e(n,t))},[]),null},v7e=()=>{const e=Ne(),t=Mb(),[n,o]=h.useState(e);return h.useEffect(()=>{e!==n&&t==="PUSH"&&(o(e),e.state?.persistScroll||window.scrollTo(0,0))},[e,t]),null},A7e=()=>{const e=E(ua),t=E(ar),n=E(Qh),o=E(eS),r=E(fd),a=()=>{const l={event:"logged_in_context",bannerName:r,regionName:o||"",retailerBannerId:n||"",retailerRegionId:t||"",userId:e||""};J.sendEvent({GA:l,WA:null})},i=()=>{const l={event:"logged_out_context",bannerName:r,regionName:o||"",retailerBannerId:n||"",retailerRegionId:t||""};J.sendEvent({GA:l,WA:null})};return()=>{e?a():i()}},b7e=({children:e})=>{const t=F(),n=Ne(),o=Mb(),{sendPageViewEvent:r}=QR(),a=A7e(),i=ie.useRef(!0);return ie.useMemo(()=>{typeof window>"u"||n.state?.silent||(t(_ae(n,o,i.current)),i.current=!1,a(),r({page:n.pathname}))},[n]),s.jsx(ie.Fragment,{children:e})};function x7e({children:e}){const[t,n]=h.useState(null),o=E(rz),r=Ne(),a=E(Yy);return h.useMemo(()=>{if(typeof window>"u")return!1;const l=!!window.gtmLoaded,c=a.some(f=>!!t?.match(f)),d=a.some(f=>!!r?.pathname?.match(f)),u=t!==null&&c&&!d,m=t!==null&&!c&&d,g=o&&l;return u&&!g||m||d&&g?!0:(n(r.pathname),!1)},[t,a,r,o])?(window.location.reload(),null):e}const R7e=D$`${sLe}`,D7e=({children:e})=>{const t=Ne();return s.jsx(x7e,{children:s.jsxs(b7e,{children:[typeof window<"u"?s.jsxs(h.Fragment,{children:[s.jsx(v7e,{}),s.jsx(_7e,{})]}):null,s.jsx(I7e,{children:s.jsx(h7e,{children:s.jsx(J9e,{children:s.jsx(XNe,{children:s.jsxs(h.Fragment,{children:[s.jsx(R7e,{}),s.jsx(t7e,{children:s.jsx(FW,{children:s.jsx(p7e,{children:s.jsx(tP,{location:t,type:"app",children:e})})})})]})})})})})]})})},O7e=D("loyalty"),P7e=D("pb.pl"),N7e=D("cf.mc.on"),L7e=D("seo.rdbl"),k7e=D("cfop"),M7e=D("alc.blur");typeof window=="object"&&document.querySelector("#app")&&G.ReactModal.setAppElement("#app");function _6(){const e=F(),t=E(Qh)??null;return Z9e(),h.useEffect(()=>{e(bae()),perfMetrics.onFirstInputDelay(n=>{e(U.analyticsEvent({type:AR.PERF_FIRST_INPUT_DELAY,delay:n}))})},[]),s.jsxs(D7e,{children:[s.jsx(_9e,{}),s.jsx(qMe,{"data-osp-retailer":t,children:s.jsx(jb,{})})]})}_6.fetchData=({context:e})=>{const{store:t,cookies:n}=e,o=t.dispatch,r=t.getState(),a=[o(Cr.getCategories({depth:1,isSEOReadableURLEnabled:L7e(r)}))];return Ze(r)&&M7e(r)&&o(f6(!!n.get($s.AGE_CONFIRMATION_COOKIE))),Ze(r)&&a.push(R9e(t)),k7e(r)&&(a.push(o(wm.fetchFopConfigAction())),a.push(o(Fm.fetchProductListConfigAction()))),Ze(r)&&a.push(b9e(t)),P7e(r)&&Ze(r)&&a.push(x9e(t)),O7e(r)&&a.push(o(Of.getLoyaltySettings())),N7e(r)&&a.push(e.urqlClient.query(y6,{})),Ze(r)&&a.push(M9e(t)),Ze(r)&&a.push(o(Gc.getAccessibilitySettings())),Promise.all(a)};const jA=({reload:e,to:t=""})=>(e?window.location.reload():window.location.replace(t),null),wA=(e,t)=>t&&!e.includes(t)?xje(e,t):e;function j7e({to:e,basePath:t}){const n=eP();return n&&typeof e=="string"&&(n.url=wA(e,t)),null}function w7e({to:e}){const t=We();return ie.useLayoutEffect(()=>{t(e,{replace:!0})},[]),null}const Qn=e=>{const t=E($S),n=E(Wt),{to:o=""}=e;if(typeof window>"u")return s.jsx(j7e,{to:o,basePath:n});const r=o;return t.type===Rr.ALL_ANCHORS?s.jsx(jA,{to:wA(r,n)}):t.type===Rr.MIXED&&!!t.anchorLinks?.find(i=>!!r.match(i))?s.jsx(jA,{to:wA(r,n)}):e.unstable__customRedirectImplementation?s.jsx(w7e,{to:o}):s.jsx(Cre,{to:o,replace:!0})};Qn.displayName="Redirect";function F7e(e,t){const n=`${e}${t}`;return Fr({queryString:`destination=${encodeURIComponent(n)}`})}const ws=(e,t,n)=>{const o=r=>{const a=Ne();return E(e)?s.jsx(t,{...r}):s.jsx(Qn,{to:F7e(n||a.pathname,a.search)})};return o.fetchData=r=>e(r.context.store.getState())&&t.fetchData?t.fetchData(r):null,o},B7e=e=>t=>t(Nf.validateAddress(e)).then(n=>n.payload.responseData.id),U7e={validateAddress:B7e},G7e=(e,t)=>n=>n(wn.getDeliverabilityByAddressDetails(e,t)).then(o=>o.payload.responseData),v6=e=>t=>t(wn.postCustomerAddresses(e)).then(n=>n.payload.responseData),$7e=e=>t=>t(wn.fetchAddressesBySearchTerm(e)).then(n=>n.payload.responseData),H7e=(e,t=!0)=>n=>n(wn.fetchDetailsForAddress(e)).then(o=>{const r=o.payload.responseData,{latitude:a,longitude:i,postcode:l}=r;return n(ni.getDeliveryDestinationDeliverability({latitude:a,longitude:i,postalCode:l})).then(c=>{const{deliverability:d}=c.payload.responseData,u=Y7e(d,t);return{...r,deliverable:u}})}),V7e=e=>t=>t(wn.fetchDetailsForAddress(e)).then(n=>n.payload.responseData),Y7e=(e,t)=>{switch(e){case"DELIVERABLE":return!0;case"DELIVERABLE_BY_OTHER_STORE":return t===!0;default:return!1}},Ju={getDeliverabilityByAddressDetails:G7e,postCustomerAddresses:v6,fetchDetailsForAddress:H7e};function W7e(e,t,n){const{type:o}=n;t(U.analyticsEvent({type:OS.ERROR,boundaryType:o,errorType:"ERROR_BOUNDARY"})),Me.api.pushError(e,{context:{message:`(${o}): ${e.message}`,...n}})}function q7e(e,t){if(!t.componentStack)return e;const n=new Error(e.message);return n.name=`React ErrorBoundary ${e.name}`,n.stack=t.componentStack,n}function os({fallback:e=s.jsx(ur,{}),type:t,additionalErrorAttributes:n,children:o}){const r=F(),a=E(tS);return s.jsx(Tre,{fallback:e,onError:(i,l)=>{W7e(q7e(i,l),r,{requestId:a,type:t,...n})},children:o})}const wg=e=>{const t=hge(e),n=gge(e);return D("addl.s")(e)?n:t},ud=e=>{const t=wg(e);return[so.MANUAL_FORM,so.MANUAL_FORM_POSTCODE].includes(t)},{analyticsEvent:K7e}=U;function Ls(){const e=F(),t=n=>e(K7e(n));return{addressImpression:n=>t({type:xe.ADDRESS_IMPRESSION,addressesImpression:n}),toastNotificationDisplayed:({message:n,messageId:o})=>t({type:xe.TOAST_NOTIFICATION_DISPLAYED,description:"A toast notification was displayed",pageEventAttributes:{message:n,messageId:o}}),addressPostCode:()=>t({type:xe.ADDRESS_POSTCODE}),findAddressButtonClicked:n=>{t({type:xe.FIND_ADDRESS_BUTTON_CLICKED,...n})},addressDropdownOpened:()=>t({type:xe.ADDRESS_DROPDOWN_OPENED}),dropdownAddressSelected:n=>t({type:xe.DROPDOWN_ADDRESS_SELECTED,...n}),addAddressButtonClicked:()=>t({type:xe.ADD_ADDRESS_BUTTON_CLICKED}),formAddAddressButtonClicked:n=>t({type:xe.FORM_ADD_ADDRESS_BUTTON_CLICKED,...n}),saveAddressButtonClicked:n=>t({type:xe.SAVE_ADDRESS_BUTTON_CLICKED,...n}),editAddressButtonClicked:n=>t({type:xe.EDIT_ADDRESS_BUTTON_CLICKED,addressId:n}),removeAddressButtonClicked(n,o){t({type:xe.REMOVE_ADDRESS_BUTTON_CLICKED,addressId:n,isLastAddress:o})},cancelButtonClicked(n){t({type:xe.CANCEL_BUTTON_CLICKED,status:n})},findAddressAgainButtonClicked:()=>t({type:xe.FIND_ADDRESS_AGAIN_BUTTON_CLICKED}),userDetailsFormModalDisplayed(){t({type:xe.USER_DETAILS_FORM_MODAL_DISPLAYED})},userDetailsFormModalClosed:n=>{t({type:xe.USER_DETAILS_FORM_MODAL_CLOSED,button:n})},saveDetailsButtonClickedEvent:n=>{t({type:xe.SAVE_DETAILS_BUTTON_CLICKED,...n})},addAddressSuccess:()=>{t({type:xe.ADD_ADDRESS_SUCCESS});const n={event:"add_address_success"};J.sendEvent({GA:n,WA:null})},addressLookupAbandoned:({lastSearchString:n,failedSearches:o})=>{t({type:xe.ADDRESS_LOOKUP_ABANDONED,lastSearchString:n,failedSearches:o});const r={event:"event",eventCategory:"Address Lookup",eventAction:"Abandoned",eventLabel:n,eventValue:"1"};J.sendEvent({GA:r,WA:null})},addressLookupAbandonedGA4:()=>{t({type:xe.ADDRESS_LOOKUP_ABANDONED_GA4});const n={event:"address_lookup_abandoned"};J.sendEvent({GA:n,WA:null})},addressLookupAddressNotFound:()=>{t({type:xe.ADDRESS_LOOKUP_ADDRESS_NOT_FOUND});const n={event:"address_lookup_address_not_found"};J.sendEvent({GA:n,WA:null})},addressLookupAddressSelected:()=>{t({type:xe.ADDRESS_LOOKUP_ADDRESS_SELECTED});const n={event:"address_lookup_address_selected"};J.sendEvent({GA:n,WA:null})},addressLookupSuccess:()=>{t({type:xe.ADDRESS_LOOKUP_SUCCESS});const n={event:"address_lookup_success"};J.sendEvent({GA:n,WA:null})},addressLookupUndeliverable:n=>{t({type:xe.ADDRESS_LOOKUP_UNDELIVERABLE,addressDescription:n});const o={event:"event",eventAction:"Undeliverable",eventCategory:"Address Lookup",eventLabel:n,eventValue:"1"};J.sendEvent({GA:o,WA:null})},addressLookupUndeliverableGA4:()=>{t({type:xe.ADDRESS_LOOKUP_UNDELIVERABLE_GA4});const n={event:"address_lookup_undeliverable"};J.sendEvent({GA:n,WA:null})},removeAddress:()=>{t({type:xe.REMOVE_ADDRESS});const n={event:"remove_address"};J.sendEvent({GA:n,WA:null})},updateAddress:()=>{t({type:xe.UPDATE_ADDRESS});const n={event:"update_address"};J.sendEvent({GA:n,WA:null})},addressLookupSelected:({lastSearchString:n,failedSearches:o})=>{t({type:xe.ADDRESS_LOOKUP_SELECTED,lastSearchString:n,failedSearches:o});const r={event:"event",eventCategory:"Address Lookup",eventAction:"AddressSelected",eventLabel:"",eventValue:"1"};J.sendEvent({GA:r,WA:null})},addAddressModalDisplayed:n=>t({type:xe.ADD_ADDRESS_MODAL_DISPLAYED,activeFlow:n}),addAddressModalClosed:(n,o,r)=>t({type:xe.ADD_ADDRESS_MODAL_CLOSED,buttonClicked:n,isMissingMandatoryField:o,...r}),selectAddressModalDisplayed:n=>t({type:xe.SELECT_ADDRESS_MODAL_DISPLAYED,matchesFound:n}),selectAddressModalClosed:(n,o,r,a)=>t({type:xe.SELECT_ADDRESS_MODAL_CLOSED,buttonClicked:n,addressTypeSelected:o,positionSelectedAddress:r,isInDeliverabilityArea:a}),confirmAddressModalDisplayed:()=>t({type:xe.CONFIRM_ADDRESS_MODAL_DISPLAYED}),confirmAddressModalClosed:(n,o,r)=>t({type:xe.CONFIRM_ADDRESS_MODAL_CLOSED,buttonClicked:n,distanceFromOriginal:o,isInDeliverabilityArea:r}),zoomButtonClickedEvent:n=>t({type:xe.ZOOM_BUTTON_CLICKED,zoomType:n}),locateMeButtonClickedEvent:()=>t({type:xe.LOCATE_ME_BUTTON_CLICKED}),saveAddressModalDisplayed:n=>t({type:xe.SAVE_ADDRESS_MODAL_DISPLAYED,isThereMissingInfo:n}),saveAddressModalClosed:(n,o,r)=>t({type:xe.SAVE_ADDRESS_MODAL_CLOSED,buttonClicked:n,isMissingMandatoryField:o,...r}),searchAddressPostcodeModalDisplayed:()=>t({type:xe.SEARCH_ADDRESS_POSTCODE_MODAL_DISPLAYED}),searchAddressPostcodeModalClosed:n=>t({type:xe.SEARCH_ADDRESS_POSTCODE_MODAL_CLOSED,status:n}),searchAddressPostcodeEndTyping:(n,o,r)=>t({type:xe.SEARCH_ADDRESS_POSTCODE_END_TYPING,results:n,searchBarFilled:o,errorState:r}),continueAddressAddButtonClicked:()=>t({type:xe.CONTINUE_ADDRESS_ADD_BUTTON_CLICKED}),enterAddressManuallyButtonClicked:()=>t({type:xe.ENTER_ADDRESS_MANUALLY_BUTTON_CLICKED}),searchAddressModalClosed:()=>t({type:xe.SEARCH_ADDRESS_MODAL_CLOSED}),searchAddressContinueClicked:(n,o,r)=>t({type:xe.SEARCH_ADDRESS_CONTINUE_CLICKED,results:n,searchBarFilled:o,errorState:r})}}function z7e(e){return Object.entries(e).map(([t,n])=>({fieldId:t,value:n}))}const Q7e=(e,t,n)=>{if(t)e.formAddAddressButtonClicked({isAddressGeocoded:!0,isAddressDeliverable:!0,missingMandatoryField:!1,missingMandatoryFieldName:[]}),n("CONFIRMATION_FORM");else{e.formAddAddressButtonClicked({isAddressGeocoded:!0,isAddressDeliverable:!1,missingMandatoryField:!1,missingMandatoryFieldName:[]});const o="settings.addresses.alert.nondeliverable";e.toastNotificationDisplayed({message:o,messageId:"non_delivery_address"}),z.error(o)}},X7e=(e,t)=>{const{validateAddress:n,sendAnalytics:o,setVisibleComponent:r,fetchDetailsForAddress:a}=t;n(z7e(e)).then(i=>{if(i)a(i).then(l=>Q7e(o,l.deliverable,r));else throw Error("not found")}).catch(()=>{const i="addresses.error-address.title.label";o.toastNotificationDisplayed({message:i,messageId:"address_error"}),z.error(i),o.formAddAddressButtonClicked({isAddressGeocoded:!1,missingMandatoryField:!1,missingMandatoryFieldName:[]})})},sP=({id:e,hasRequiredSymbol:t=!1,label:n="",helperText:o="",errorMessage:r="",children:a=s.jsx("span",{children:"missing input..."}),className:i="",isVisuallyConcealed:l=!1})=>{const{formatMessage:c}=M(),d=!!r;return s.jsxs(Oa,{className:i,"data-test":sP.dataTestId,children:[n&&s.jsxs(h.Fragment,{children:[s.jsx(bn,{hasError:d,htmlFor:e,visuallyConcealed:l,isRequired:t,children:n}),t?s.jsx(Ee,{children:c("validation.msg.required")}):null]}),o&&(l?s.jsx(Ee,{children:o}):s.jsx(P,{className:"salt-d--block salt-m-b--1",children:o})),a,d&&s.jsx(Ua,{role:"alert","data-test":"form-field-error-message",children:r})]})};sP.dataTestId="input-wrapper";function Z7e(e,t){const n=e.split(".");try{return n.reduce((o,r)=>o[r],t).message}catch{return""}}function nP(e,t){if(t.formState.errors){if(!e.includes("."))return t.formState.errors[e]?.message??""}else return"";return Z7e(e,t.formState.errors)}function A6({id:e,label:t,"data-test":n,hasRequiredSymbol:o=!1,errorMessage:r="",inputOptions:a={},className:i,defaultValue:l}){return s.jsx(ii,{id:e,input:a,label:t,hideLabel:!t,className:i,required:o,"data-test":n||`input-${e}`,meta:{error:r,touched:!!r,invalid:!!r},defaultValue:l})}function Jo({name:e,label:t,hasRequiredSymbol:n=!0,required:o,min:r,max:a,pattern:i,valueAsNumber:l,validate:c,deps:d,className:u,defaultValue:m,...g}){const f=$o();return s.jsx(A6,{id:String(g.id??e),"data-test":g["data-test"],label:t,errorMessage:nP(e,f),hasRequiredSymbol:n&&(o?.value??!1),inputOptions:{...f.register(e,{valueAsNumber:l,required:o,pattern:i,min:r,max:a,deps:d,validate:c}),...g},className:u,defaultValue:m})}function Fg({name:e,label:t,helperText:n,options:o,required:r,placeholder:a="",onBlur:i,onFocus:l,onChangeCallback:c=()=>{},validate:d,deps:u,ariaLabel:m,defaultValue:g=void 0,"data-test":f,resetOnInvalidState:y=!1,mode:I}){const[S,C]=h.useState(g),_=$o(),A=(O=S)=>o.find(N=>N.value===O),x=(O=g)=>{_.setValue(e,O),C(O)};h.useEffect(()=>(_.register(e,{validate:d,required:r,deps:u}),g!==void 0&&!y&&x(),g!==void 0&&y&&A(g)&&x(),g!==void 0&&y&&!A(g)&&x(void 0),!A()&&y&&x(),()=>_.unregister(e)),[e,g,o.map(O=>O.value).join("")]);const R=O=>{_.setValue(e,O.target.value),I!=="onSubmit"&&(_.trigger(),_.clearErrors(e)),C(O.target.value),c(O)};return s.jsx(Pd,{error:nP(e,_),label:t,id:e,"data-test":f??e,required:r?.value,"aria-label":m,placeholder:a,helperText:n,onChange:R,onBlur:i,onFocus:l,value:S,children:o.map(({value:O,label:N,dataTest:k})=>s.jsx("option",{value:O,"data-test":k,children:N},O))})}function J7e({onClick:e,label:t}){return s.jsx(b,{type:"submit",intent:"primary",fill:!0,onClick:e,className:"salt-m-y--4",children:s.jsx(v,{id:t})})}function eXe({dataTest:e,defaultValues:t,submitButton:n,fields:o,hooks:r=void 0}){const a=Gn({mode:"onBlur",defaultValues:t??{}});return s.jsx($n,{...a,children:s.jsxs("form",{"data-test":e,onSubmit:a.handleSubmit(i=>{const{fields:l,...c}=i;n.onSubmit(c)}),children:[o.map(({fieldId:i,title:l,required:c,...d})=>s.jsx(Jo,{name:i,label:l,required:c,hasRequiredSymbol:!!c,...d},i)),s.jsx(J7e,{onClick:()=>r?.beforeSubmit?.(a.getValues()),label:n.label})]})})}function tXe(e){return e.reduce((t,n)=>({...t,[n.fieldId]:n.value??""}),{})}function sXe(e,t){return b6(e).filter(oXe(nXe(t)))}function nXe(e){return e.filter(t=>t.isRequired).map(t=>t.fieldId)}function b6(e){return Object.keys(e).filter(t=>e[t]==="")}const oXe=e=>t=>e.includes(t);function dF(e,t){if(e.isRequired)return{value:!0,message:t("validation.msg.required")}}function uF(e){const t=e.validations||[];if(t.length>1)throw Error("We don't support more than one regex validation per field right now");if(t.length===1)return{value:new RegExp(t[0].regex),message:t[0].errorMessage}}const rXe=Object.freeze(["description","value","validations","isRequired"]);function aXe([e]){return!rXe.includes(e)}function iXe(e,t){const n=Object.entries(e).filter(aXe).reduce((o,[r,a])=>({...o,[r]:a}),{});return dF(e,t)&&(n.required=dF(e,t)),uF(e)&&(n.pattern=uF(e)),n}function lXe(e,t){return t.filter(n=>{if(!n.isRequired||!n.validations||n.validations.length===0)return!1;const o=new RegExp(n.validations[0].regex),r=e[n.fieldId];return r&&!o.test(r)}).map(n=>n.fieldId)}function Dl({formFields:e,dataTest:t,hooks:n=void 0,submitButton:o}){const r=M();return s.jsx(eXe,{dataTest:t,hooks:n,submitButton:o,defaultValues:tXe(e),fields:e.map(a=>iXe(a,r.formatMessage))})}Dl.getRequiredEmptyValuesKeys=sXe;Dl.getInvalidCharactersFields=lXe;Dl.getEmptyValuesKeys=b6;const cXe=()=>s.jsx("div",{"data-test":"add-address-spinner",children:s.jsx("div",{className:"salt-m-t--16",children:s.jsx(Rs,{size:"l"})})}),pF="logged.in.home.page.title",rs=({title:e=pF,meta:t="page.description",seoFriendlyMeta:n={metaDescriptionTagline:"",pageDescription:""},values:o={},skipFormatTitle:r=!1,tagline:a="page.tagline",pattern:i="page.title.pattern.with.separator"})=>{const l=M(),c=E(fd)||"",d=l.formatMessage("page.title.separator"),u=l.formatMessage(i,{name:c,tagline:l.formatMessage(a),separator:l.formatMessage("page.title.separator"),title:r&&e!==pF?e:l.formatMessage(e,o)}),m=n.pageDescription&&n.metaDescriptionTagline?`${n.pageDescription}${d}${c}${d}${l.formatMessage(n.metaDescriptionTagline)}`:l.formatMessage(t);return s.jsxs(_o,{children:[s.jsx("title",{children:u}),s.jsx("meta",{name:"description",content:m})]})},dXe=T(b)`
    position: absolute;
    inset-inline-start: var(--salt-spacing-2);

    @media (min-width: ${Ke.sm}em) {
        inset-inline-start: var(--salt-spacing-4);
    }
`;function FC({children:e,titleTextId:t,headingTextId:n,buttonTestId:o,onBack:r}){const a=typeof r=="function";return s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:t}),s.jsx(An,{children:s.jsxs(se,{direction:"row",align:"center",children:[a&&s.jsx(dXe,{size:"s",intent:"tertiary",fill:!1,onClick:r,"data-test":o,children:s.jsx(b.Icon,{name:"arrow_left"})}),s.jsx(ne,{as:"h1",className:a?"salt-p-l--2 sm:salt-p-l--0":"",children:s.jsx(v,{id:n})})]})}),s.jsx(h.Fragment,{children:e})]})}const uXe="address-form-back";function x6({onBack:e,children:t}){const n=E(Ue(lr)),o=E(Ue(hg));return s.jsx(FC,{titleTextId:"addresses.add-address.title",headingTextId:"addresses.add-address.heading",buttonTestId:uXe,onBack:e,children:n||o?s.jsx(h.Fragment,{children:t}):s.jsx(Y,{className:"salt-m-y--16 salt-m-x--16",children:s.jsx(Y.Item,{colStart:{xs:2,sm:3,md:4,lg:5},colSpan:{xs:10,sm:8,md:6,lg:4},children:t})})})}const pXe="add-address-form";function oP({formFields:e,onSubmit:t,onBack:n}){const o=[so.MANUAL_FORM,so.UK_POSTCODE,so.MANUAL_FORM_MAP,so.INTERNATIONAL,so.MANUAL_FORM_POSTCODE],r=Ls(),a=E(wg),i=E(D("mfm")),l=E(ud);h.useEffect(()=>{(l?i:o.includes(a))&&r.addAddressModalDisplayed(a)},[]);const c=g=>{if(e==="NOT-READY")return;const f=Dl.getInvalidCharactersFields(g,e),y=Dl.getRequiredEmptyValuesKeys(g,e),I=Dl.getEmptyValuesKeys(g),S={isAddressGeocoded:!1,missingMandatoryField:y.length>0,missingMandatoryFieldName:y,invalidCharacters:f.length>0};if(a===so.MANUAL_FORM_MAP){const C={};I.forEach(_=>{C[_]=!0}),r.addAddressModalClosed(lr,S.missingMandatoryField,C)}else(S.missingMandatoryField||S.invalidCharacters)&&r.formAddAddressButtonClicked(S)},d=()=>Array.isArray(e)&&e.length,u=()=>e.map(g=>({...g,disabled:g.isOn===!1})),m=()=>{if(e==="NOT-READY")return s.jsx(cXe,{});if(d())return s.jsx(Dl,{dataTest:pXe,submitButton:{label:"addresses.add-address-button",onSubmit:t},formFields:u(),hooks:{beforeSubmit:c}});throw Me.api.pushError(new Error("formFields from Backend is malformed"),{context:{formFields:JSON.stringify(e)}}),Error("Wrong or missing fields")};return s.jsx(x6,{onBack:n,children:m()})}const mXe=(e,t)=>e.find(n=>n.fieldId===t);function hXe(e,t){return t&&Object.entries(t).forEach(([n,o])=>{const r=mXe(e,n);r&&(r.value=o)}),e}function gXe(e){const[t,n]=h.useState(!0),o=E(EKe);return h.useEffect(()=>{n(!1)},[]),o||t&&!e}function rP(e,t){const[n,o]=h.useState(),r=E(Yt),a=E(gKe),i=gXe(r),l=F(),c=u=>l(Wc.fetchNewAddressFields(u,t));return h.useEffect(()=>{r||c(e)},[e]),[i?"NOT-READY":hXe(a,n),o]}const EXe=()=>E(Mr),BC=()=>E(Qs),aP=()=>E(Zt),R6=e=>!e.isFetching&&(!e.lastUpdated||e.didInvalidate)&&!e.fetchError,fXe=()=>{const e=P6(),t=E(Zl),n=E(Jl),o=F();return e||t?()=>{R6(n)&&o(sn.getCustomerCollectionDeliveryDestinations())}:()=>{}},D6=()=>{const e=O6(),t=E(Ei),n=F();return e?()=>{R6(t)&&n(sn.getHomeDeliveryDestinations())}:()=>{}},O6=()=>E(ux),P6=()=>E(i1),uc=()=>{const e=BC(),{deliveryDestinationId:t}=aP();return e.data?.deliveryDestinationId===t?e:{...e,data:void 0}},Bg=(e=!0,t=!1)=>{const n=F(),o=We(),r=E(rr),a=E(up),{pathname:i}=E(bS),l=E(Wt),c=pn({basePath:l});return({addressId:d,deliveryDestinationId:u,regionId:m})=>AK({addressId:d,deliveryDestinationId:u,regionId:m,customerId:r,visitorId:a},e,i,c,n,o,t)},yXe=()=>{const e=E(Op);return EXe()?e:!0},iP=()=>{const e=uc();return t=>t.deliveryDestinationId===e.data?.deliveryDestinationId},N6=e=>async t=>{try{const{payload:{responseData:n}}=await t(sn.getHomeDeliveryDestinations()),o=n.find(r=>r.addressId===e);return o?{addressId:e,...o}:null}catch(n){throw z.error("request.error.title"),n}},IXe=e=>t=>t(CK(e)).then(n=>n.payload.responseData),lP={getHomeDeliveryDestinationIdByAddressId:N6,updateDeliveryDestination:AK};function Ug(){const e=F(),t=E(sg),n=E(rKe),o=Bg(!1);return async r=>{try{const a=await e(lP.getHomeDeliveryDestinationIdByAddressId(r));return a&&t&&n&&await o({addressId:a.addressId,deliveryDestinationId:a.deliveryDestinationId,regionId:a.resolvedRegionId}),a||{addressId:r}}catch{return{addressId:r}}}}const lt=()=>{const e=eP();return e&&(e.statusCode=404),s.jsx(Y,{fixed:!0,className:"salt-m-y--16",children:s.jsx(Y.Item,{colStart:{sm:3,md:4,lg:5},colSpan:{xs:12,sm:8,md:6,lg:4},children:s.jsx(ln,{titleIcon:"info_default",title:"not.found.page.title",titleAs:"h1",description:"not.found.page.subtitle",primaryButton:{text:"not.found.page.go.back.button.text",to:"/"}})})})},SXe={submitLabelId:p.string.isRequired,onSubmit:p.func.isRequired,onEdit:p.func,onCancel:p.func,defaultValues:p.shape({nickname:p.string,notes:p.string}),showAddressLine2:p.bool,showDeliveryInstructions:p.bool,addressLine2Label:p.string,isAddressLine2Required:p.bool},CXe={defaultValues:{nickname:"",notes:""},onEdit:void 0,onCancel:void 0,showAddressLine2:!1,showDeliveryInstructions:!0,addressLine2Label:"address.form.field.apartmentNumber",isAddressLine2Required:!1},W_=T(Bo)`
    inline-size: 50%;
`;function UC({submitLabelId:e,onSubmit:t,onEdit:n,onCancel:o,defaultValues:r,showAddressLine2:a,showDeliveryInstructions:i,addressLine2Label:l,isAddressLine2Required:c=!1}){const[d,u]=h.useState(!1),m=Ls(),g=M(),f=E(wg)==="MANUAL_FORM_MAP",y=E(dp),I=E(x=>qe(x,"validation-address-client-name-max-chars")),S=Gn({mode:"onBlur",defaultValues:r}),C=new RegExp(y),_=async()=>{await(async()=>{await S.trigger()})();const R=S.getValues("nickname"),O=S.getValues("notes"),N=Dl.getEmptyValuesKeys(S.getValues());if(f){const k={};N.forEach(j=>{k[j]=!0}),m.saveAddressModalClosed("saveAddress",!R,k)}else m.saveAddressButtonClicked({missingMandatoryField:!R,addressNameFilled:!!R,isDeliveryInstructionsFilled:!!O,invalidFields:!S.formState.isValid})},A=x=>{d||(u(!0),t(x,()=>u(!1)))};return s.jsx($n,{...S,children:s.jsxs("form",{"data-test":"confirm-address-form",onSubmit:S.handleSubmit(A),children:[s.jsxs("div",{className:"salt-m-y--8",children:[a&&s.jsx(Jo,{name:"addressLine2",label:g.formatMessage(l),placeholder:g.formatMessage(l),required:{value:c,message:g.formatMessage("validation.msg.required")},maxLength:I,pattern:{value:C,message:g.formatMessage("validation.form.restricted.chars")}}),s.jsx(Jo,{name:"nickname",label:g.formatMessage("settings.address.book.add.modal.nickname.label"),placeholder:g.formatMessage("settings.address.book.add.modal.nickname.placeholder"),required:{value:!0,message:g.formatMessage("validation.msg.required")},maxLength:I,pattern:{value:C,message:g.formatMessage("validation.form.restricted.chars")}}),i&&s.jsx(Jo,{name:"notes",label:g.formatMessage("settings.address.book.add.modal.notes.label"),placeholder:g.formatMessage("settings.address.book.add.modal.notes.placeholder"),maxLength:I,pattern:{value:C,message:g.formatMessage("validation.form.restricted.chars")}})]}),s.jsxs(se,{justify:"space-between",align:"center",wrap:"nowrap",gap:["sm"],children:[n&&s.jsx(W_,{children:s.jsx(b,{fill:!0,onClick:n,intent:"secondary","data-test":"address-edit-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"addresses.confirm-created-address-map.edit"})})})}),o&&s.jsx(W_,{children:s.jsx(b,{fill:!0,onClick:o,intent:"secondary","data-test":"address-cancel-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"addresses.confirm-address.cancel"})})})}),s.jsx(W_,{children:s.jsx(b,{type:"submit",fill:!0,onClick:_,intent:"primary","data-test":"address-submit-button",disabled:d,children:s.jsx(b.Text,{children:s.jsx(v,{id:e})})})})]})]})})}UC.propTypes=SXe;UC.defaultProps=CXe;const TXe=p.shape({formattedAddress:p.string,addressId:p.string,nickname:p.string,notes:p.string}),_Xe={addressDetails:TXe},vXe="addresses.confirm-address.heading";L6.propTypes={children:p.element.isRequired};function L6({children:e}){const t=E(Ue(lr));return s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"addresses.confirm-address.title"}),s.jsx(An,{children:s.jsx(ne,{as:"h1","data-test":vXe,children:s.jsx(v,{id:"addresses.confirm-address.heading"})})}),t&&s.jsx(h.Fragment,{children:e}),!t&&s.jsx(Y,{className:"salt-m-y--16",children:s.jsx(Y.Item,{colStart:{xs:2,sm:3,md:4,lg:5},colSpan:{xs:10,sm:8,md:6,lg:4},children:e})})]})}function AXe({onClick:e}){const t=F();return s.jsx(b,{"data-test":"address-edit-button",intent:"secondary",fill:!0,onClick:()=>{t(U.analyticsEvent({type:xe.EDIT_ADDRESS_BUTTON_CLICKED})),e()},children:s.jsx(b.Text,{children:s.jsx(v,{id:"addresses.confirm-address.edit"})})})}function k6({texts:{formattedAddress:e,additionalInformation:t}}){return s.jsxs("div",{className:"salt-m-y--4",children:[s.jsx(P,{bold:!0,children:s.jsx(v,{id:"addresses.confirm-address.selection.label"})}),s.jsx("div",{className:"salt-m-x--1 salt-m-y--1"}),s.jsx(P,{children:e}),t?s.jsxs(h.Fragment,{children:[s.jsx("div",{className:"salt-m-x--1 salt-m-y--1"}),s.jsx(P,{children:t})]}):null]})}const{addressDetails:bXe}=_Xe;function GC({submitLabelId:e,onSubmit:t,addressDetails:n,editButtonHandler:o}){const r=F(),a=We(),i=Ls(),l=E(Ue(lr)),c=E(n3),d=!E(D("daddi")),{formattedAddress:u,nickname:m,notes:g,additionalInformation:f}=n,y=()=>{i.cancelButtonClicked("cancel button"),l?r(Z.closeModal()):a(c)};return u?n?s.jsx(L6,{children:s.jsxs(h.Fragment,{children:[s.jsx(k6,{texts:{formattedAddress:u,additionalInformation:f}}),o&&s.jsx(AXe,{onClick:o}),s.jsx(UC,{onCancel:y,onSubmit:t,defaultValues:{nickname:m,notes:g},submitLabelId:e,showDeliveryInstructions:d})]})}):s.jsx(lt,{}):s.jsx(Rs,{})}GC.propTypes={onSubmit:p.func.isRequired,submitLabelId:p.string,addressDetails:bXe.isRequired,editButtonHandler:p.func};GC.defaultProps={submitLabelId:"addresses.confirm-address.heading.add",editButtonHandler:void 0};const M6=ee("ADD_CUSTOMER_ADDRESS"),j6=ee("ADD_CUSTOMER_ADDRESS_WITH_POSTCODE_UPDATE"),w6=ee("ADD_VALIDATED_CUSTOMER_ADDRESS"),F6=({id:e,details:t,nickname:n,notes:o,formattedAddress:r},a=M6)=>({type:"API",payload:{url:"/v4/accounts/current/addresses",service:"web_customer_ws",pathPrefix:{client:"/api/customer",server:"/core-api"},options:{method:"POST",body:{id:e,additionalInformation:t||"",nickname:n,notes:o,primary:!0,formattedAddress:r}},...a}}),xXe=({id:e,details:t,nickname:n,notes:o,postcode:r,formattedAddress:a})=>({type:"API",payload:{url:"/v4/accounts/current/addresses",service:"web_customer_ws",pathPrefix:{client:"/api/customer",server:"/core-api"},options:{method:"POST",body:{id:e,additionalInformation:t,nickname:n,notes:o,primary:!0,postcode:r,formattedAddress:a}},...j6}}),RXe=({id:e,nickname:t,notes:n,additionalInformation:o,formattedAddress:r})=>F6({id:e,nickname:t,notes:n,details:o,formattedAddress:r},w6),cP={types:{ADD_CUSTOMER_ADDRESS:M6,ADD_CUSTOMER_ADDRESS_WITH_POSTCODE_UPDATE:j6,ADD_VALIDATED_CUSTOMER_ADDRESS:w6},addAddress:F6,addAddressWithPostcodeUpdate:xXe,addValidatedAddress:RXe},DXe=e=>t=>t(cP.addAddress(e)).then(n=>n.payload.responseData.addressId).catch(n=>{throw z.error("request.error.title"),new Error(n)}),OXe=e=>t=>t(cP.addAddressWithPostcodeUpdate(e)).then(n=>n.payload.responseData.addressId).catch(n=>{throw z.error("request.error.title"),new Error(n)}),PXe=({id:e,nickname:t,notes:n,additionalInformation:o,formattedAddress:r})=>a=>a(cP.addValidatedAddress({id:e,nickname:t,notes:n,additionalInformation:o,formattedAddress:r})).then(i=>i.payload.responseData.addressId).catch(i=>{throw z.error("request.error.title"),new Error(i)}),oI={addCustomerAddress:DXe,addCustomerAddressWithPostcodeUpdate:OXe,addValidatedAddress:PXe},B6=({onEdit:e,onConfirm:t})=>{const n=Ls(),o=F(),r=We(),a=E(lKe),i=Ug(),l=E(D("mfm")),c=E(n3),d=u=>{o(oI.addValidatedAddress({id:a.id,nickname:u.nickname,notes:u.notes,additionalInformation:a.additionalInformation,formattedAddress:a.formattedAddress})).then(m=>i(m)).then(()=>{l||r(c)}),n.addAddressSuccess(),t&&t()};return s.jsx(GC,{editButtonHandler:e,addressDetails:a,onSubmit:d})};B6.defaultProps={onConfirm:()=>{}};const NXe="addresses-postcode-input",LXe="addresses-find-button",U6=({onChange:e,onSubmit:t,isButtonFullWidth:n=!1,postCodeRegExp:o=/^[A-Za-z0-9 ]*$/g,initialValues:r={postcode:""},sendAnalytics:a})=>{const i=Gn({defaultValues:r,mode:"all"}),l=M(),c=h.useMemo(()=>({value:!0,message:l.formatMessage("settings.address.postcode.required.error.a11y")}),[l]),d=h.useMemo(()=>{const y=l.formatMessage("settings.address.book.add.modal.postcode.error");return{value:o,message:y}},[l,o]),u=l.formatMessage("settings.address.book.add.modal.postcode.label"),m=l.formatMessage("settings.address.book.add.modal.postcode.placeholder"),g=l.formatMessage("settings.address.book.add.modal.postcode.placeholder.aria.label"),f=y=>{let I=!1;return i.handleSubmit(S=>{I=!0,t(S)})(y).then(()=>{if(!I){const S={postCodeUndeliverable:!1,postCodeNotFound:!1,postCodeInvalidCharacters:!0};a.findAddressButtonClicked(S)}})};return s.jsx($n,{...i,children:s.jsxs("form",{onChange:e,onSubmit:f,children:[s.jsx(Jo,{name:"postcode",label:u,"data-test":NXe,"data-pii":"true",hasRequiredSymbol:!1,placeholder:m,"aria-label":g,required:c,pattern:d,maxLength:10}),s.jsx(Oa,{children:s.jsx(b,{fill:n,intent:"primary",type:"submit","data-test":LXe,children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.add.modal.find.button"})})})})]})})},dP=(e,t)=>(n=" ")=>n.match(e)?void 0:t,$C=e=>t=>t.replace(/\s/g,"").length>0?void 0:e,uP=()=>{const e=M(),t=E(dp),n=E(r=>qe(r,"validation-address-client-name-max-chars")),o=h.useMemo(()=>({label:e.formatMessage("settings.address.book.add.modal.nickname.label"),placeholder:e.formatMessage("settings.address.book.add.modal.nickname.placeholder"),requiredMessage:e.formatMessage("settings.address.addressName.required.error.a11y"),restrictedCharsMessage:e.formatMessage("validation.form.restricted.chars")}),[]);return s.jsx(Jo,{name:"nickname",label:o.label,"data-test":"addresses-nickname-input","data-pii":"true","aria-live":"polite",placeholder:o.placeholder,"aria-label":o.label,required:{value:!0,message:o.requiredMessage},hasRequiredSymbol:!0,validate:{notWhiteSpace:$C(o.requiredMessage),validateAgainstMask:dP(t,o.restrictedCharsMessage)},maxLength:n})},HC=({name:e="notes",label:t="settings.address.book.add.modal.notes.label",ariaLabel:n,formattedPlaceholder:o,required:r=!1,requiredMessage:a,maxLength:i})=>{const{formatMessage:l}=M(),c=E(dp),d=E(g=>qe(g,"validation-address-client-instructions-max-chars")),u=i||d,m={notesLabel:l(t),ariaLabel:n||l(t),notesPlaceholder:o!==void 0?o:l("settings.address.book.add.modal.notes.placeholder"),restrictedCharsMessage:l("validation.form.restricted.chars"),required:a?l(a):""};return s.jsx(Jo,{name:e,label:m.notesLabel,"data-test":"addresses-notes-input","data-pii":"true",hasRequiredSymbol:r,placeholder:m.notesPlaceholder,"aria-label":m.ariaLabel,required:{value:r,message:m.required},validate:{...r?{notWhiteSpace:$C(m.required)}:{},validateAgainstMask:dP(c,m.restrictedCharsMessage)},maxLength:u})},kXe=e=>e?.map(({formattedAddress:t,id:n})=>({value:n,label:t}))??[],MXe=({addresses:e,handleSubmit:t,sendAnalytics:n})=>{const o=M(),r=$o(),a=!E(D("daddi")),i=r.getValues()?.id,l=h.useMemo(()=>kXe(e),[e]),c=h.useMemo(()=>({placeholder:o.formatMessage("settings.address.book.add.modal.select.address.placeholder"),label:o.formatMessage("settings.address.book.add.modal.select.address.label"),required:o.formatMessage("settings.address.full.required.error.a11y")}),[]);if(!e?.length)return null;const d=()=>{n.addressDropdownOpened()},u=()=>{n.dropdownAddressSelected({}),n.addressLookupAddressSelected()};return s.jsxs("form",{onSubmit:r.handleSubmit(t),children:[s.jsx(Fg,{name:"id",placeholder:c.placeholder,label:c.label,required:{value:!0,message:c.required},onFocus:d,onChangeCallback:u,options:l,"data-test":"addresses-list-select"}),i&&s.jsxs(h.Fragment,{children:[s.jsx(uP,{}),a&&s.jsx(HC,{})]}),s.jsx("input",{type:"submit",hidden:!0})]})},G6=ee("VALIDATE_ADDRESS"),$6=ee("ADDRESS_LOOKUP"),H6=ee("ADDRESS_LOOKUP_BY_POSTCODE"),V6=ee("ADDRESS_LOOKUP_BY_SEARCH_TERM"),Y6=ee("ADDRESS_LOOKUP_BY_COORDINATES"),jXe=e=>({type:"API",payload:{url:"/v1/addresses/areas",service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},options:{headers:{"content-type":"application/x-www-form-urlencoded"},method:"PUT",body:tt.stringify({query:e})},...G6}}),wXe=(e,t,n)=>({type:"API",payload:{url:`/v3/address-lookup?countryCode=${t}&limit=${n}`,service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},options:{method:"POST",body:e},...$6}}),FXe=(e,t)=>({type:"API",payload:{url:`/v3/address-lookup/by-postcode?countryCode=${t}`,service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},options:{method:"POST",body:{postcode:e}},...H6}}),BXe=(e,t,n,o)=>{const r=new URLSearchParams;return t&&r.append("countryCode",t),n&&r.append("pageToken",n),o&&r.append("maxPageSize",o.toString()),{type:"API",payload:{url:`/v3/address-lookup/by-search-term${r.toString()?`?${r.toString()}`:""}`,service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},options:{method:"POST",body:{query:e}},...V6}}},UXe=(e,t,n)=>({type:"API",payload:{url:`/v3/address-lookup/by-coordinates?countryCode=${t}`,service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},options:{method:"POST",headers:{visitorid:n,"visitor-id":n},body:e},...Y6}}),Gg={types:{FETCH_LOOKUP_AREAS:G6,ADDRESS_LOOKUP:$6,ADDRESS_LOOKUP_BY_POSTCODE:H6,ADDRESS_LOOKUP_BY_SEARCH_TERM:V6,ADDRESS_LOOKUP_BY_COORDINATES:Y6},fetchLookupAreas:jXe,addressLookup:wXe,addressLookupByPostcode:FXe,addressLookupBySearchTerm:BXe,addressLookupByCoordinates:UXe},GXe=e=>t=>t(Gg.fetchLookupAreas(e)).then(n=>n.payload.responseData),$Xe=(e,t,n)=>o=>o(Gg.addressLookup(e,t,n)).then(r=>r.payload.responseData),HXe=(e,t)=>n=>n(Gg.addressLookupByPostcode(e,t)).then(o=>o.payload.responseData),VXe=(e,t,n,o)=>r=>r(Gg.addressLookupBySearchTerm(e,t,n,o)).then(a=>a.payload.responseData),YXe=(e,t,n)=>o=>o(Gg.addressLookupByCoordinates(e,t,n)).then(r=>r.payload.responseData),pP={addressLookup:$Xe,addressLookupByPostcode:HXe,addressLookupBySearchTerm:VXe};function WXe({setAreaLookupId:e,setVisibleComponent:t}){const n=Ls(),o=F(),r=E(qb);h.useEffect(()=>{n.addressPostCode()},[]);const a=({postcode:i})=>{const l={postCodeUndeliverable:!1,postCodeNotFound:!1,postCodeInvalidCharacters:!1};GXe(i)(o).then(c=>{if(c.length===0){n.addressLookupAddressNotFound();const u="settings.addresses.alert.no.areas.found";return n.toastNotificationDisplayed({message:u,messageId:"address_error"}),z.error(u)}n.findAddressButtonClicked(l);const d=c[0].id;return e(d),t("FORM")}).catch(c=>{const d=c.statusCode===404?"settings.addresses.alert.no.areas.found":"toast.notification.generic.error";l.postCodeUndeliverable=c.statusCode===400,l.postCodeNotFound=c.statusCode===404,c.statusCode===404&&n.addressLookupAddressNotFound(),n.findAddressButtonClicked(l),n.toastNotificationDisplayed({message:d,messageId:"address_error"}),z.error(d)})};return s.jsx(x6,{children:s.jsx(U6,{onSubmit:a,postCodeRegExp:new RegExp(r),isButtonFullWidth:!0,sendAnalytics:n})})}const W6=({actions:e,onSubmit:t,onConfirm:n})=>{const o=E(wg)===so.MANUAL_FORM_POSTCODE,r=Ls(),[a,i]=h.useState(""),[l,c]=rP(a),{validateAddress:d,fetchDetailsForAddress:u}=e,[m,g]=h.useState(o?"LOOKUP":"FORM"),f=y=>{t(y,{validateAddress:d,sendAnalytics:r,setVisibleComponent:g,fetchDetailsForAddress:u}),c(y)};switch(m){case"LOOKUP":return s.jsx(WXe,{setVisibleComponent:g,setAreaLookupId:i});case"CONFIRMATION_FORM":return s.jsx(B6,{onEdit:()=>g("FORM"),onConfirm:n});case"FORM":default:return s.jsx(oP,{formFields:l,onSubmit:f})}};W6.defaultProps={onSubmit:X7e,onConfirm:()=>{}};const q6=e=>s.jsx(os,{type:"AddAddress::route",children:s.jsx(W6,{...e})});q6.fetchData=({context:{store:e}})=>e.dispatch(Wc.fetchNewAddressFields());const qXe=ot({analyticsEvent:U.analyticsEvent,validateAddress:U7e.validateAddress,fetchDetailsForAddress:Ju.fetchDetailsForAddress}),K6=ke(null,qXe)(q6),z6={routes:{createEditUrl:e=>s_e.replace(`:${Ry}`,e)},params:{route:{CUSTOMER_ADDRESS_ID:Ry}}},{analyticsEvent:KXe}=U;function zXe(){return{customerAddressId:co()[Ry]}}const QXe=(e,{dispatch:t})=>t(KXe({type:xe.ADDRESS_IMPRESSION,addressesImpression:e}));function XXe(e){const t=F(),n=E(ud);h.useEffect(()=>{n&&e.length&&QXe(e,{dispatch:t})},[JSON.stringify(e)])}const ZXe=({actions:e,isServerRendered:t,addressDetails:n})=>{const{customerAddressId:o}=zXe(),r=We();return h.useEffect(()=>{if(!t){const{fetchCustomerAddressDetails:a}=e;a(o)}},[]),s.jsx(GC,{submitLabelId:"addresses.confirm-address.heading.update",addressDetails:n,onSubmit:({nickname:a,notes:i})=>{e.updateCustomerAddress({id:o,nickname:a,notes:i}).catch(()=>{const l={event:"event",eventCategory:"Settings",eventAction:"UPDATE_CUSTOMER_ADDRESS_SUCCESS",eventLabel:"Not Set"};J.sendEvent({GA:l,WA:null}),z.error("request.error.title")}).then(()=>{const l={event:"event",eventCategory:"Settings",eventAction:"UPDATE_CUSTOMER_ADDRESS_ERROR",eventLabel:"Not Set"};J.sendEvent({GA:l,WA:null}),r(Na())})}})},Q6=e=>s.jsx(os,{type:"EditAddress::route",children:s.jsx(ZXe,{...e})});Q6.fetchData=({context:{store:e},params:t})=>{const{CUSTOMER_ADDRESS_ID:n}=z6.params.route;e.dispatch(Lm.fetchCustomerAddressDetails(t[n]))};const JXe=e=>({isServerRendered:Yt(e),addressDetails:pKe(e)}),eZe=ot({fetchCustomerAddressDetails:Lm.fetchCustomerAddressDetails,updateCustomerAddress:Sy.updateCustomerAddress}),tZe=ke(JXe,eZe)(Q6),sZe=(e,t)=>t.map(({condition:n,failComponent:o})=>({meetsCondition:n(e),failComponent:o})),mF=(e,t)=>sZe(e,t).filter(n=>!n.meetsCondition),Gl=(e,t)=>{function n(o){const r=E(i=>mF(i,e)),a=r.length?r[0]?.failComponent:t;return a?s.jsx(a,{...o}):null}return n.fetchData=o=>{const r=mF(o.context.store.getState(),e),a=r.length?r[0]?.failComponent:t;return a?.fetchData?a.fetchData(o):null},n},nZe=(e,{isUserLoggedIn:t=Ze}={})=>[{path:"/addresses/add-address",Component:ws(t,e.Main),children:[{index:!0,Component:Gl([{condition:n=>ud(n),failComponent:lt}],K6)}]},{path:"/addresses/confirm-address/:customerAddressId",Component:ws(t,e.Main),children:[{index:!0,Component:Gl([{condition:n=>ud(n),failComponent:lt}],tZe)}]}],oZe=()=>{const e=E(Wt)||"",t=Ne();return s.jsx(jA,{to:`${e}${t.pathname}${t.search??""}`})},hF=()=>s.jsx(os,{type:"ExternalRedirectToCurrentPath::route",children:s.jsx(oZe,{})}),rZe=()=>[{path:"/login",Component:hF},{path:"/register",Component:hF}],aZe=()=>{const e=E(s1);return s.jsx(Qn,{to:gn(e)})},iZe=h.forwardRef((e,t)=>{const{isSSRNavigation:n}=e;if(n){const{children:c,href:d,isSSRNavigation:u,...m}=e;return s.jsx(zv.Link,{ref:t,asChild:!0,children:d?s.jsx(rt,{href:d,...m,children:c}):s.jsx("a",{...m,children:c})})}const{children:o,to:r,href:a,isSSRNavigation:i,...l}=e;return s.jsx(zv.Link,{ref:t,asChild:!0,children:r?s.jsx(Qe,{to:r,...l,children:o}):s.jsx("a",{...l,children:o})})}),lZe=({intent:e})=>{const{formatMessage:t}=M(),n=e||"error",o={warning:t("accessibility.warning.message"),info:t("accessibility.info.message"),error:t("accessibility.error.message"),action:t("accessibility.action.message"),success:t("accessibility.success.message")};return s.jsx(Ee,{children:o[n]})},cZe=h.forwardRef((e,t)=>s.jsx(zv,{...e,text:s.jsxs(ie.Fragment,{children:[s.jsx(lZe,{intent:e.intent}),e.text]}),ref:t})),Ce={...cZe,Link:iZe},dZe=D("fppco"),uZe=e=>{const t=e>1?"logged.in.home.page.payment.failed.multiple.text":"logged.in.home.page.payment.failed.text";return s.jsx(v,{id:t})},pZe=(e,t)=>{const n={event:"event",eventCategory:"Payment",eventAction:"failedPaymentWarningAlertLinkClicked",eventLabel:t};J.sendEvent({GA:n,WA:null}),e.analyticsEvent({type:xt.FAILED_PAYMENT_WARNING_ALERT_LINK_CLICKED,pathname:t})},mZe=(e,t,n)=>{if(!n?.orderId)return null;const{orderId:o}=n,r=sc({orderId:o}),a=s.jsx(v,{id:"payment.failed.page.link.text"});return s.jsx(Ce.Link,{to:r,"data-test":"failed-payment-alert-link",onClick:()=>pZe(e,t),children:a})};class hZe extends h.PureComponent{static defaultProps={isFailedPaymentPreventCheckoutFeatureEnabled:!1,oldestOrderWithFailedPayment:void 0};componentDidMount(){if(this.props.isFailedPaymentPreventCheckoutFeatureEnabled&&this.props.numFailedPaymentOrders>0){this.props.actions.analyticsEvent({type:xt.FAILED_PAYMENT_WARNING_ALERT,pathname:this.props.pagePath});const t={event:"event",eventCategory:"Payment",eventAction:"failedPaymentWarningAlert",eventLabel:this.props.pagePath};J.sendEvent({GA:t,WA:null})}}render(){const{actions:t,isFailedPaymentPreventCheckoutFeatureEnabled:n,numFailedPaymentOrders:o,oldestOrderWithFailedPayment:r,pagePath:a}=this.props;if(!n||!o)return null;const i=mZe(t,a,r),l=uZe(o);return s.jsx(Ce,{text:l,link:i,"data-test":"failed-payment-alert",className:"salt-m-b--4"})}}const gZe=e=>({isFailedPaymentPreventCheckoutFeatureEnabled:dZe(e),numFailedPaymentOrders:vC(e),oldestOrderWithFailedPayment:AC(e),pagePath:_p(e)}),EZe=ot({analyticsEvent:U.analyticsEvent}),fZe=ke(gZe,EZe)(hZe),yZe={hasRedirect:!1},gF="failed-paymnet-modal-header",VC=({hasRedirect:e})=>{const t=We(),n=E(D(gO)),o=E(qYe),r=E(Ue("failedPayment")),a=E(_p),i=F(),l=()=>i(Z.closeModal()),c=()=>{i(U.analyticsEvent({type:xt.FAILED_PAYMENT_WARNING_MODAL,payload:{pathname:a}}))},d=()=>{i(U.analyticsEvent({type:xt.BACK_TO_SHOP,description:"User clicked back to shop button in failed payment modal",pageEventAttributes:{componentLocation:"Body",componentType:"Modal",linkType:"Button",userInteraction:"BUTTON_CLICKED"}})),t(pn()),l()},u=()=>{i(U.analyticsEvent({type:xt.FAILED_PAYMENT_WARNING_MODAL_UPDATE_PAYMENT_DETAILS_BUTTON_CLICKED})),t(sc({orderId:o})),l()};return s.jsxs(G,{isOpen:r,onAfterOpen:c,aria:{labelledby:gF},children:[s.jsx(G.Header,{align:n?"left":"center",children:s.jsx(ne,{as:"h2",id:gF,children:s.jsx(v,{id:"payment.failed.modal.title"})})}),s.jsx(G.Body,{children:s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(se,{justify:"center",children:s.jsx("div",{className:"salt-m-b--4",children:s.jsx(me,{error:!0,name:"status_no",height:82,width:82})})})}),s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Ce,{showIcon:!1,className:"salt-m-b--4",text:s.jsxs(ie.Fragment,{children:[s.jsx(v,{id:"payment.failed.declined.text",values:{orderId:123}})," ",s.jsx(v,{id:"payment.failed.modal.update.text"})]})})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx("div",{className:"salt-m-t--2",children:e?s.jsx(b,{"data-test":"back-to-shop-button",fill:!0,intent:"secondary",onClick:d,children:s.jsx(v,{id:"payment.failed.modal.back.button.text"})}):s.jsx(b,{"data-test":"close-button",fill:!0,intent:"secondary",onClick:l,children:s.jsx(v,{id:"payment.failed.modal.close.button.text"})})})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{className:"salt-m-t--2","data-test":"update-payment-details-button",fill:!0,intent:"primary",onClick:u,children:s.jsx(v,{id:"payment.failed.modal.update.button.text"})})})]})})]})};VC.defaultProps=yZe;const IZe=D("m.la.h"),$g=()=>E(e=>IZe(e)),Hg=e=>E(Ue(e)),pl=()=>{const e=F();return h.useCallback(()=>e(Z.closeModal()),[e])},eo=()=>{const e=F();return h.useCallback(t=>e(U.analyticsEvent(t)),[e])},Vp=e=>E(t=>e(t)),mP=()=>{const e=ze(),t=F(),n=E(Dn(["sumsub","bt.spl"])),o=E(D("mins"));return h.useCallback(({basketSummary:r,type:a})=>{const i=r.totals?.display?.itemPriceAfterPromos,l=r?.checkout?.minimumCheckoutThreshold,c=r.totals?.remainingAmountToMinimumCheckoutThreshold,d=!r?.checkout?.basketAboveThreshold;if(!l||!d||!i)return;const u=e(l);let m="";if(t(U.analyticsEvent({type:Te.MINIMUM_BASKET_VALUE_NOT_REACHED_NOTIFICATION_DISPLAYED,minimumBasketValueAmount:l.amount,basketValueAmount:i.amount,basketValueCurrency:i.currency})),c&&(m=e(c)),o&&c){z[a]({key:"basket.below.minimum.threshold.error.toast",substitutions:{minimumThreshold:u,missingAmount:m}});return}if(n&&c){z[a]({key:"basket.below.threshold.with.remaining.value.error",substitutions:{threshold:u,remaining:m}});return}z[a]({key:"basket.below.threshold.error",substitutions:{threshold:u}})},[t,e,o,n])},X6=()=>{const e=E(D("alc.blur")),t=E(Ahe),n=E(J5);return e&&t&&!n},SZe=()=>E(gi),CZe=()=>E(D("et.hcb")),q_="deliveryPriceModificationLevelsNotification",TZe=(e,t)=>{if(!e||!t)return!1;let n=null;try{const o=localStorage?.getItem(q_);o&&(n=JSON.parse(o)?.[t]??null)}catch{localStorage?.removeItem(q_)}return n===e?!0:(localStorage?.setItem(q_,JSON.stringify({[t]:e})),!1)},_Ze=e=>{if(typeof e!="object"||e===null)return!1;const t=e;return typeof t.type=="string"&&["success","error","warning","info"].includes(t.type)&&typeof t.message=="string"},ps=({breakpoint:e})=>{const{currentBreakpoint:t}=h.useContext(Pn);return Ih({currentBreakpoint:t,breakpoint:e})},vZe=e=>{const t=F(),n=eo(),o=E(Ze);return h.useCallback(()=>{const r=e!==Fs.GRID?Fs.GRID:Fs.DETAIL;o&&t(Da.updateCustomerPreferenceBasketView(r)),t(Da.setCustomerPreferenceBasketView(r)),n({type:Te.TROLLEY_VIEW_CHANGE_VIEW_TYPE_BUTTON_CLICKED,description:"Trolley page view type change",pageEventAttributes:{componentLocation:"Body",componentType:"FOP",linkType:"Button",userInteraction:"BUTTON_CLICKED"}})},[n,t,o,e])},FA=()=>{const{formatMessage:e}=M(),t=E(AS),n=vZe(t),[o]=fe(["thcu"]),r=ps({breakpoint:"lg-up"}),a=o&&r,{iconName:i,dataTest:l,messageId:c}=t!==Fs.GRID?{iconName:pA[Fs.GRID],dataTest:"toggle-grid-button",messageId:mA[Fs.GRID]}:{iconName:pA[Fs.DETAIL],dataTest:"toggle-details-button",messageId:mA[Fs.DETAIL]};return s.jsxs(b,{onClick:n,intent:o?"tertiary":"secondary","data-test":l,"aria-label":e(c),children:[s.jsx(b.Icon,{name:i}),!a&&s.jsx(b.Text,{children:s.jsx(v,{id:c})})]})};function YC(e){return(e.data.products.basket.data?.productGroups||[]).find(o=>o?.type==="regular")?.products||[]}const Z6=(e,t)=>e.map(n=>({product:t[n.productId],quantity:n.quantity})).filter(n=>!!n.product).map(({product:n,quantity:o})=>{const r=n?.offers?.map(a=>a.description).join(",");return{...n,quantity:o,promotionNames:r,cmsProductAttributes:[]}}),AZe=(e,t)=>e.filter(n=>t.includes(n.productId)),J6=e=>{const t=E(Jn),n=E(Ts),o=E(YC),r=e?AZe(t,o):t;return h.useMemo(()=>Z6(r,n),[r,n])},bZe=()=>{const e=F(),t=J6(),n=E(qs);return h.useCallback(async()=>{const o=await e(ca.emptyBasket());if(!o)return;const r=IC({products:t,basket:o,page:"BASKET",addedByFunction:"EMPTY_CART",productListName:"basket: other"});J.sendEvent({GA:r,WA:null}),SC({products:t,basket:o,page:"BASKET",addedByFunction:"EMPTY_CART",productListName:"basket: other",featuredProductCampaigns:n}).forEach(l=>{J.sendEvent({GA:l,WA:null})}),e(U.analyticsEvent({type:Te.REMOVE_BASKET_ITEM,basket:o,page:"BASKET",addedByFunction:"EMPTY_CART",product:t,productListName:"basket: other"}));const{pricingNotifications:i}=o;i&&e(jd(i))},[e,t])},xZe=()=>{const e=bZe(),t=pl(),n=F();return h.useCallback(()=>{e(),n(U.analyticsEvent({type:Te.EMPTY_BUTTON_CLICKED})),n(U.analyticsEvent({type:Te.EMPTY_BASKET}));const o={event:"event",eventCategory:"Basket",eventAction:"EMPTY_BASKET",eventLabel:"Not Set"};J.sendEvent({GA:o,WA:null}),t()},[t,n,e])},RZe=()=>{const e=M();return h.useMemo(()=>({heading:e.formatMessage("basket.header.empty.modal.heading"),empty:e.formatMessage("basket.header.empty.modal.empty"),cancel:e.formatMessage("basket.header.empty.modal.cancel")}),[e])},EF="empty-basket-modal-header",DZe="emptyBasket",OZe=()=>{const e=pl(),t=Hg(DZe),n=$g(),o=RZe(),r=xZe();return s.jsxs(G,{isOpen:t,onRequestClose:e,aria:{labelledby:EF},children:[s.jsx(G.Header,{align:n?"left":"center",children:s.jsx(ne,{as:"h1",id:EF,children:o.heading})}),s.jsx(G.Body,{children:s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{fill:!0,intent:"secondary",onClick:e,children:s.jsx(b.Text,{children:o.cancel})})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{fill:!0,intent:"primary","data-synthetics":"basket-confirm-empty",onClick:r,children:s.jsx(b.Text,{children:o.empty})})})]})})]})};class PZe{callbacks;channel;constructor(){this.channel=new MessageChannel,this.channel.port1.onmessage=this.flushCallbacks,this.callbacks=[]}flushCallbacks=()=>{const t=this.callbacks;this.callbacks=[];const n=typeof window>"u"?void 0:window?.performance?.now();for(let o=0;o<t.length;o+=1)t[o](n)};handlePostMessage=()=>this.channel.port2.postMessage(void 0);runAfterFramePaint=t=>{this.callbacks.push(t)===1&&requestAnimationFrame(this.handlePostMessage)}}let K_;const ks=({name:e,attributes:t,event:n,variant:o})=>{const r=n&&n.timeStamp;return(a,i)=>{if(typeof window>"u"||!window.performance)return!1;K_||(K_=new PZe);const l=i(),c=On(l),d=Kl(l),u=D("faro")(l),m=y0(l);return K_.runAfterFramePaint(g=>{if(f0(i()))return;const f=r||g||window.performance.now(),y={type:TR.PERFORMANCE,description:`Performance mark for ${e}`,pageViewId:c,sessionId:d,pageEventAttributes:{name:e,timestamp:f,...t}};if(u&&ZTe(e)){const I=sS(l),S=rr(l)!==void 0;f2({name:e,timestamp:f,isFullPageLoad:I,isUserLoggedIn:S,reportingLevel:m,variant:o})}a(U.analyticsEvent(y))})}},NZe=e=>{const t=F(),n=E(pa),o=E(Jn),r=a=>{const i=o.find(l=>l.productId===a.productId);return t(U.analyticsEvent({type:fs.REMOVE_ALL_REGULARS_FROM_BASKET,productId:a.productId,updateQuantity:-a.quantity,basketTotalAmount:n?.amount,basketTotalCurrency:n?.currency,retailerProductId:i?.retailerProductId,priceAmount:i?.price?.current.amount,priceCurrency:i?.price?.current.currency}))};return e.length?()=>e.forEach(a=>r(a)):void 0};function WC(){const e=F();return{addToRegularsModalDisplayed:({productId:c,retailerProductId:d})=>e(qOe({productId:c,retailerProductId:d})),removeAllRegularsModalDisplayed:()=>e(KOe()),removeAllRegularsFromBasketModalDisplayed:()=>e(zOe()),productAddedToRegulars:({productId:c,retailerProductId:d,frequency:u,quantity:m})=>e(QOe({productId:c,retailerProductId:d,frequency:u,quantity:m})),productRemovedFromRegulars:({productId:c,retailerProductId:d,removeAll:u=!1})=>e(XOe({productId:c,retailerProductId:d,removeAll:u})),toastNotificationDisplayed:c=>e(ZOe(c)),productUpdated:({productId:c,retailerProductId:d,parameter:u,previousValue:m,currentValue:g})=>e($j(u==="FREQUENCY"?{productId:c,retailerProductId:d,parameter:u,previousValue:m,currentValue:g}:{productId:c,retailerProductId:d,parameter:u,previousValue:m,currentValue:g}))}}const hP=()=>{const e=F();return{regularsGaEvent:o=>{const r={event:o.event,frequency:o.frequency,id:o.retailerProductId,index:o.productIndex,list:o.list,name:o.productName,quantity:o.quantity};J.sendEvent({GA:r,WA:null});const a=U.analyticsEvent({type:fs.REGULARS_GA_EVENT,...o});return e(a)},removeAllRegularsGaEvent:o=>{const r={event:"remove_all_regulars",count:o.count};J.sendEvent({GA:r,WA:null});const a=U.analyticsEvent({type:fs.REMOVE_ALL_REGULARS_GA_EVENT,...o});return e(a)}}},qC=e=>{const t=F();return h.useCallback(()=>t(Z.openModal(e)),[t,e])},LZe=()=>{const e=F();return h.useCallback(t=>e(ca.instantShopRemoveFromBasket(t)),[e])},kZe=({location:e,setInstantShopProductsRemoved:t})=>{const n=LZe(),o=e.state?.addedProducts||[];return h.useCallback(()=>{const r=o.reduce((a,i)=>({items:[...a.items,{productId:i.productId,quantity:i.quantity}],decoratedItems:[...a.decoratedItems,{product:i,page:"basket"}]}),{items:[],decoratedItems:[]});n(r).then(()=>t(!0)).catch(()=>{})},[n,o,t])},MZe=()=>{const e=F();return h.useCallback(()=>e(ks({name:UTe})),[e])},jZe=(e,t)=>!!t.find(n=>n===e),wZe=({productIdsToSort:e,idsToCompare:t})=>{const[n,o]=e.reduce((r,a)=>(r[jZe(a,t)?0:1].push(a),r),[[],[]]);return n.concat(o)},FZe=e=>e.map(({productId:t,quantity:{quantityInBasket:n}})=>({productId:t,quantity:n})),BZe=(e,t)=>e.filter(n=>!!t.find(o=>o===n.productId)),UZe=()=>{const e=E(YC),t=E(Id);return BZe(FZe(t),e)},GZe=()=>{const e=F(),t=UZe(),n=NZe(t),o=J6(!0),r=E(qs);if(t?.length)return async()=>{const a=await e(ca.removeBasketItems(t));if(!a)return;n?.(),e(jd(a?.pricingNotifications,!0));const i=IC({products:o,basket:a.basket,page:"BASKET",addedByFunction:"REMOVE_REGULARS",productListName:"basket: other"});J.sendEvent({GA:i,WA:null}),SC({products:o,basket:a.basket,page:"BASKET",addedByFunction:"REMOVE_REGULARS",productListName:"basket: other",featuredProductCampaigns:r}).forEach(c=>{J.sendEvent({GA:c,WA:null})}),e(U.analyticsEvent({type:Te.REMOVE_BASKET_ITEM,basket:a.basket,page:"BASKET",addedByFunction:"REMOVE_REGULARS",product:o,productListName:"basket: other"}))}},$Ze=()=>{const e=E(Dn(["bt.view.dd","bt.spl"])),t=ps({breakpoint:"lg-up"}),n=E(AS);return e&&!t?n:n===Fs.GRID?Fs.GRID:Fs.DETAIL},fF="basket.header.empty.trolley",e8=()=>{const{formatMessage:e}=M(),t=qC("emptyBasket"),[n]=fe(["thcu"]),o=ps({breakpoint:"lg-up"}),r=n&&o;return s.jsxs(h.Fragment,{children:[s.jsxs(b,{"data-synthetics":"empty-basket-form",onClick:t,intent:n?"tertiary":"secondary","aria-label":e(fF),children:[s.jsx(b.Icon,{name:n?"delete":"trolley_empty"}),!r&&s.jsx(b.Text,{children:s.jsx(v,{id:fF})})]}),s.jsx(OZe,{})]})},yF=()=>s.jsx(ne,{as:"h1","data-test":"basket-page-header",children:s.jsx(v,{id:"basket.header.heading"})}),HZe=()=>{const[e]=fe(["thcu"]),t=ps({breakpoint:"lg-up"}),n=E(gi);return e&&t&&n?s.jsxs(se,{justify:"space-between",align:"center",wrap:"nowrap",children:[s.jsx(yF,{}),s.jsxs(se,{justify:"center",align:"center",wrap:"nowrap",className:"salt-gap--4",children:[s.jsx(e8,{}),s.jsx(FA,{})]})]}):s.jsx(yF,{})},Ud="reg",t8="removeAllRegulars",BA=99,s8=[{value:"WEEKLY",translationId:"regular.addToRegularsForm.option.weekly"},{value:"FORTNIGHTLY",translationId:"regular.addToRegularsForm.option.fortnightly"},{value:"MONTHLY",translationId:"regular.addToRegularsForm.option.monthly"},{value:"TWO_MONTHLY",translationId:"regular.addToRegularsForm.option.bimonthly"}],KC=()=>!!E(D(Ud)),IF=D("r.ppws"),SF=D("seo.rdbl"),CF=D("di"),n8=({category:e})=>(t,n)=>{const o=n(),r=IF(o)?wze:jze,a={imageFormats:io(o)??[],isSEOReadableURLEnabled:SF(o),isDynamicImagesEnabled:CF(o)};return t(r({transformerConfig:a,category:e})).then(i=>{if(!i)return;let{payload:{responseData:l}}=i;IF(o)&&(l=ch(l,io(o)??[],SF(o),CF(o)));const{entities:c,result:{productGroups:d,missedPromotions:u}}=l;for(const m in c.product)c.product[m]===void 0&&delete c.product[m];return t(Ft.setProducts(c)),u?.length&&t(Ao.addMissedPromotions(u)),{products:ng()(l),productGroups:d}})},VZe=({category:e})=>async t=>{const[n,o]=await Promise.allSettled([t(I3()),t(n8({category:e}))]);return n.status==="rejected"&&Me.api.pushError(new Error(`Failed to fetch regulars ${n.reason}`)),o.status==="rejected"&&Me.api.pushError(new Error(`Failed to fetch catalogue ${o.reason}`)),o.status==="fulfilled"?t(Nze(o.value.productGroups)):null},YZe={fetchRegularsCatalogueAndUpdateProducts:VZe,getRegularsCataloguePageCall:n8},o8=()=>{const{search:e}=Ne(),t=F(),n=WC(),o=hP(),r=M(),a=tt.parse(e)?.sublocationId;return async({productId:i,productName:l,onAfterRemoveSuccess:c,retailerProductId:d,frequency:u,quantity:m,productIndex:g,section:f,subPage:y,page:I})=>{const S=typeof a=="string"?a:void 0;try{await t(kze(i)),I==="regulars"?await t(YZe.getRegularsCataloguePageCall({category:S})):(t(ft.removeProductFromRegularsProductGroup(i)),t(Ft.updateProducts({product:[{productId:i,regular:void 0}]}))),z.success("regular.removeRegular.success",{ariaLabel:r.formatMessage("regular.removeRegular.success.accessibility.label",{productName:l})}),n.toastNotificationDisplayed("regularRemoved"),n.productRemovedFromRegulars({productId:i,retailerProductId:d}),o.regularsGaEvent({event:"remove_from_regulars",retailerProductId:d,productName:l,quantity:m,frequency:u,productIndex:g,list:Ws(I,y,f)??""}),c?.()}catch(C){z.error("regular.removeRegular.error"),Me.api.pushError(C instanceof Error?C:new Error(`useRemoveRegular error: ${JSON.stringify(C)}`))}}},WZe=({onAfterRemoveSuccess:e}={})=>{const t=F(),n=o8();return async({regular:o,productId:r,retailerProductId:a,productName:i,page:l="",section:c="",productIndex:d,beforeOpeningAddToRegularsModal:u})=>{o?await n({productId:r,productName:i,retailerProductId:a,quantity:o.quantity,frequency:o.frequency,productIndex:d??0,page:l,section:c,onAfterRemoveSuccess:e}):(t(Z.closeModal()),u?.(),t(LC({productId:r,page:l,section:c,productIndex:d})))}},qZe=()=>{const e=F(),[t]=fe([Ud]),o=E(Ze)&&t;h.useEffect(()=>{o&&e(I3())},[])},r8=()=>{const e=F(),t=E(qs);return{viewCartGa4Event:o=>{const{payload:r,cartType:a,meta:i}=o,l=r.map(c=>(H1e({...c,currencyCode:c.currencyCode,cartType:a,meta:i,featuredProductCampaigns:t}).forEach(u=>{J.sendEvent({GA:u,WA:null})}),e(U.analyticsEvent({type:Te.VIEW_CART,...c,cartType:a,meta:i}))));return Promise.all(l)}}},KZe=(e,t,n)=>{const o=e?.totals?.display?.itemPriceAfterPromos||null,r=e?.orderId||null,a=e?.activeCheckoutGroupId||null;return{currencyCode:o?.currency||null,total:o?.amount||null,orderId:r,groupId:a,products:Z6(e.items,t),page:n}},zZe=()=>{const t=E(Ze)?"logged-in-homepage":"logged-out-homepage",{pathname:n}=Ne(),[,o]=n.split("/");return h.useMemo(()=>o||t,[t,o])},a8=()=>{const e=h.useRef(!1),t=zZe(),n=h.useCallback(()=>{e.current=!0},[]),o=E(u=>Zt(u)),r=E(Ts),i=!!o?.checkoutGroups?.length?o?.checkoutGroups||[]:[o],l=i?.map(u=>KZe(u,r,t))||[],c=i?.every(u=>u?.items?.every(m=>!!r?.[m?.productId])??!1)??!1,d=!!l?.length&&c&&!e.current;return{data:l,canSendEvent:d,setIsEventSent:n}},QZe=({data:e})=>e.adverts.cartPage||{},XZe=V(QZe,e=>{const{placement:t,settings:n,isFetching:o}=e;return[(t.belowGrid||[]).filter(({format:a})=>a==="HORIZONTAL"),n,o]}),i8=({data:e})=>e.adverts.orderConfirmationPage??{},l8=V(i8,e=>{const{isFetching:t,settings:n,placement:o}=e;return[(o?.belowGrid||[]).filter(({format:a})=>a==="HORIZONTAL"),n,t]}),ZZe=e=>{const{lastUpdated:t}=i8(e);return!t},JZe=e=>{const[t]=l8(e);return!!t.length},gP=(e,t)=>{const n=h.useRef(null),o=r=>{const{target:a}=r;n.current&&!n.current.contains(a)&&e()};return h.useEffect(()=>(document.addEventListener("click",o,{capture:!0}),()=>{document.removeEventListener("click",o,{capture:!0})}),t),n},eJe=1500,tJe=D("sm.bnnr"),zC=()=>E(Iae),c8=()=>{const e=navigator.userAgent;return/iPhone|iPad|iPod/.test(e)?"ios":/Android/.test(e)?"android":"other"},sJe=()=>{const{hideTTL:e}=zC(),[t,n]=h.useState(!0);return h.useEffect(()=>{if(typeof window>"u")return;const r=Number(window?.localStorage?.getItem("sb:hiddenUntil"))||0;n(Mt.now()<r)},[]),{isDismissed:t,dismiss:()=>{const r=e?Number(e):1/0,a=Mt.now()+r;n(!0),window?.localStorage?.setItem("sb:hiddenUntil",String(a))}}},nJe=(e,t)=>{const[n,o]=h.useState(!1);h.useEffect(()=>{typeof window>"u"||o(window?.localStorage?.getItem("sb:installed")==="true")},[]);const r=h.useCallback(()=>{if(!t||e==="other")return;const a=document.createElement("iframe");return a.hidden=!0,a.src=`${t}://`,document.body.appendChild(a),a},[t,e]);return h.useEffect(()=>{if(e==="other"||n||!t||typeof window>"u")return;let a=!1;const i=()=>{document.hidden&&(a=!0)};document.addEventListener("visibilitychange",i,{once:!0});const l=r(),c=setTimeout(()=>{document.removeEventListener("visibilitychange",i),l?.remove(),a&&(o(!0),window?.localStorage?.setItem("sb:installed","true"))},eJe);return()=>{clearTimeout(c),document.removeEventListener("visibilitychange",i),l?.remove()}},[e,t,n,r]),n},oJe=()=>{const{androidAppFallbackUrl:e,androidCustomScheme:t,androidPackageName:n,iosAppStoreUrl:o}=zC();return{androidIntentUrl:t&&n&&e?`intent://open/#Intent;scheme=${t};package=${n};S.browser_fallback_url=${encodeURIComponent(e)};end`:void 0,iosAppStoreUrl:o}},rJe=(e,t)=>!t||t.length===0?!0:new RegExp(t).test(e),aJe=()=>{const{appTitle:e,iosIconUrl:t,androidIconUrl:n,visiblePages:o}=zC(),{isDismissed:r,dismiss:a}=sJe(),{pathname:i}=Ne(),l=E(tJe),c=rJe(i,o),d=c8(),u=d==="ios",m=!/CriOS|FxiOS|EdgiOS|OPiOS|OPT\//i.test(navigator.userAgent)&&u,g=u?t:n,f=h.useMemo(()=>[e,g].every(Boolean),[e,g]);return{dismiss:a,isSmartBannerVisible:c&&l&&!m&&d!=="other"&&!r&&f}},iJe=e=>{const n=document.getElementById("main-header")?.getBoundingClientRect().bottom||0,o=e?.getBoundingClientRect().top||0;n>o&&window.scrollTo({top:n})},lJe=["LARGE","MEDIUM","SMALL"],cJe={LARGE:[480,960],MEDIUM:[480,960],SMALL:[960,480]},dZt={XLARGE:[7680,900],LARGE:[2973,900],MEDIUM:[2301,900],SMALL:[1725,600]},uZt={XLARGE:[7680,270],LARGE:[2973,270],MEDIUM:[2301,270],SMALL:[1725,270]},pZt={LARGE:[2880,480],MEDIUM:[1920,480],SMALL:[960,480]},d8={LARGE:[2880,360],MEDIUM:[2880,480],SMALL:[1920,480]},dJe={LARGE:[2880,360],MEDIUM:[2880,480],SMALL:[1920,480]},uJe={LARGE:[960,480],MEDIUM:[960,480],SMALL:[1920,480]},TF="fm",pJe="w",mJe="avif",hJe="webp",gJe={[Ke.xs]:"SMALL",[Ke.sm]:"MEDIUM",[Ke.md]:"MEDIUM",[Ke.lg]:"LARGE"},EP=()=>{const e=ll(),[t,n]=h.useState();return h.useEffect(()=>{if(e){const o=gJe[Ke[e]];n(o)}else n(void 0)},[e]),[t,e]},EJe=e=>{try{return e==="undefined"?void 0:JSON.parse(e??"")}catch{return}},fJe=(e,t,n)=>{const o=()=>!(typeof window>"u"||n()===void 0),r=()=>{if(!o())return t;try{const u=n().getItem(e);return u?EJe(u):t}catch{return t}},[a,i]=h.useState(r()),[l,c]=h.useState(r()),d=u=>{o()&&(n().setItem(e,JSON.stringify(u)),i(u))};return h.useEffect(()=>{i(r()),c(r())},[]),[l,a,d]},yJe=(e,t)=>fJe(e,t,()=>window.sessionStorage),IJe=(e,t,n,o)=>{const r=`hrz.${e}.${t||"~"}.${n}.last-viewed`,[a,i,l]=yJe(r,o);return{initialAdvertId:a,updateLastViewedAdvertId:l}},SJe=()=>{const e=h.useRef(0);return h.useEffect(()=>{const t=document.getElementById("main-header"),n=new ResizeObserver(([o])=>{const{height:r}=o.contentRect;e.current!==r&&(e.current=r)});return t&&n.observe(t),()=>{n.disconnect()}},[]),e},CJe=e=>_re(vre(e),"a-zA-Z0-9-"),mZt=e=>e.replace(/[^\w. ]/gi,t=>`&#${t.charCodeAt(0)};`),TJe=e=>{const[t]=e.split("://"),n=/^(http|https)/.test(t)?e:`https://${e}`,o=new URL(n);return`${o.origin}${o.pathname}${o.search}`},_Je="/product-range",_F=2048,vF=(e,t)=>{const n=[],o=e.trim();return o&&n.push(tt.stringify({advertId:o},{encode:!0})),t?.length&&n.push(tt.stringify({ids:t},{arrayFormat:"comma"})),`${_Je}${n.length?`?${n.join("&")}`:""}`},vJe=(e,t)=>{const n=vF(e,t),o=`${window.location.origin}${n}`;if(o.length>_F){const a=new URL(o.substring(0,_F)).searchParams.get("ids")?.split(",")||[],i=a.length-1,l=a[i],c=t?.[i];return l!==c&&a.pop(),[vF(e,a),!0,o.length]}return[n,!1,o.length]},rI=(e,[t,n])=>e.find(({width:o,height:r})=>o===t&&r===n),u8=({target:e})=>e.openInNewTab?"_blank":void 0,AJe=(e=[])=>e.filter(t=>t?.format==="HORIZONTAL"),fP=()=>typeof navigator<"u"?(navigator.userAgent.match(/version\/([\d.]+).*safari/i)?.[1]??"-1").startsWith("16."):!1,p8=e=>{if(!e)return"";if(fP())return`url("${e.url}")`;const[t]=m8(e,!0),n=t?.split(",")||[],o=r=>{const[a,i]=r.split(" ");return`url("${a}") type("image/avif") ${i}`};return`image-set(${n.map(o).join(",")}, url("${e.url}"))`},m8=(e,t=!1)=>{const{url:n,width:o}=e;return[mJe,hJe].map(r=>[`${n}?${TF}=${r}&${pJe}=${o/2} ${t?"1x":`${o/2}w`}`,`${n}?${TF}=${r} ${t?"2x":`${o}w`}`].join(","))},Vg=e=>V(({data:t})=>t.adverts[e].placement.withinGrid.find(n=>n.format==="DOUBLE_TILE"),({data:t})=>[t.adverts[e].lastUpdated,t.adverts[e].isFetching],(t,[n,o])=>[!!n&&!o&&!!t,t?.aligned==="RIGHT"]),bJe=e=>e.linkType==="ABSOLUTE_WEB_ADDRESS",xJe=e=>e.linkType==="BOP",RJe=e=>e.linkType==="LISTER_PAGE",AF=({id:e,target:t})=>{if(bJe(t))return[TJe(t.values[0])];if(xJe(t))return[vi(t.values[0])];if(RJe(t)){const[n,o,r]=vJe(e,t.values);return[n,{isCropped:o,fullUrlLength:r}]}return[""]},DJe=e=>{const t=h.useRef(0);return h.useEffect(()=>{const n=document.getElementById("summary-box");let o=null;return(()=>{e&&n?(o=new ResizeObserver(([a])=>{if(!a)return;const[i]=a.borderBoxSize;i&&t.current!==i.blockSize&&(t.current=i.blockSize)}),o.observe(n)):t.current=0})(),()=>{o&&n&&o.disconnect()}},[e]),t},QC=({image:e,contentSource:t,pixelDensity:n,children:o,sizes:r})=>{if(fP()||!(t==="CONTENTFUL"))return o;const[l,c]=m8(e,n);return s.jsxs("picture",{"data-test":"advert-picture",children:[s.jsx("source",{"data-test":"advert-picture-source",type:"image/avif",srcSet:l,sizes:r}),ie.cloneElement(o,{srcSet:c})]})},OJe=T.section`
    display: flex;
    flex-direction: column;
    gap: var(--salt-spacing-4);
`,Gu=e=>{const[t,n]=e;return e&&t&&n?`aspect-ratio: ${t} / ${n};`:""},PJe=T.div`
    border-radius: var(--salt-radius-default);
    background-color: var(--intent-secondary-100);

    ${e=>Gu(e.dimensionsMap.SMALL)}

    ${oe.smUp`
        ${e=>Gu(e.dimensionsMap.MEDIUM)}
    `}

    ${oe.lgUp`
        ${e=>Gu(e.dimensionsMap.LARGE)}
    `}
`,NJe=(e,t,n)=>{const[o,r]=t[n];return e.filter(i=>i.images.some(l=>l.width===o&&l.height===r)).length},LJe=T.div`
    inline-size: 100%;

    ${e=>`
        display: ${e.size==="SMALL"?"block":"none"};
    `}

    ${oe.mdUp`${e=>`
        display: ${e.size==="MEDIUM"?"block":"none"};
    `}`}

    ${oe.lgUp`${e=>`
        display: ${e.size==="LARGE"?"block":"none"};
    `}`}
`,kJe=({advertDimensionsMap:e,adverts:t,sizes:n})=>s.jsxs(OJe,{children:[s.jsx(PJe,{dimensionsMap:e,"data-test":"horizontal-advert-skeleton"}),n.map(o=>{const r=NJe(t,e,o);return r>1?s.jsx(LJe,{size:o,children:s.jsx(xW,{isPaused:!1,currentIndex:0,numberOfItems:r,handlePrevButtonPress:()=>{},handleNextButtonPress:()=>{},handlePauseButtonPress:()=>{}})},o):null})]}),MJe=T.img`
    border-radius: var(--salt-radius-default);
    inline-size: 100%;
    block-size: auto;
    ${({advertDimensionsMap:e})=>Gu(e.SMALL)}

    ${oe.smUp`
        ${({advertDimensionsMap:e})=>Gu(e.MEDIUM)}
    `}

    ${oe.lgUp`
        ${({advertDimensionsMap:e})=>Gu(e.LARGE)}
    `}
`,z_=(e,t,n,o)=>{const[r,a]=t;return o.includes(n)&&jJe(e,r,a)?"display: block;":"display: none;"},jJe=(e,t,n)=>e.some(o=>o.images.some(r=>r.width===t&&r.height===n)),wJe=T.div`
    inline-size: 100%;

    ${({adverts:e,advertDimensionsMap:t,advertSizes:n})=>z_(e,t.SMALL,"SMALL",n)}

    ${oe.mdUp`
        ${({adverts:e,advertDimensionsMap:t,advertSizes:n})=>z_(e,t.MEDIUM,"MEDIUM",n)}
    `}

    ${oe.lgUp`
        ${({adverts:e,advertDimensionsMap:t,advertSizes:n})=>z_(e,t.LARGE,"LARGE",n)}
    `}
`,FJe=["CATEGORY","PROMOTION","PROMOTIONS_LANDING"],yP=h.forwardRef(({isExternalLink:e,linkType:t,...n},o)=>{const r=e||FJe.includes(t)?rt:Qe;return s.jsx(r,{ref:o,...n})}),BJe=T(yP)`
    line-height: 0;
    outline-offset: -1px;
    flex-basis: 100%;
    flex-shrink: 0;
    display: block;
`,h8=h.createContext(null),UJe=({children:e})=>{const[t,n]=h.useState([]),o=h.useMemo(()=>({displayedAdverts:t,setDisplayedAdverts:n}),[t,n]);return s.jsx(h8.Provider,{value:o,children:e})},g8=e=>(t,n)=>({type:"API",payload:{url:n?"/v1/events":"/v4/content/events",service:n?"cxhub":"webuniversalapi",...n?{pathPrefix:{client:"/api/cxhub",server:"/core-api"}}:{},skipLoginRedirect:!0,options:{method:"POST",body:{eventType:e,externalAdvertIds:[t]}},...ee(e)}}),GJe=g8("ADVERT_CLICK"),$Je=g8("ADVERT_IMPRESSION"),HJe={STATIC_ADVERT:{click:"ADVERTISING_BANNER_CLICKED",impression:"ADVERTISING_BANNER_IMPRESSION"},RESPONSIVE_ADVERT:{click:"RESPONSIVE_ADVERTISING_BANNER_CLICKED",impression:"RESPONSIVE_ADVERTISING_BANNER_IMPRESSION"}},VJe=e=>({id:e.id,name:e.name,altText:e.altText,placement:e.placement,location:e.page,advertisingBannerType:e.placement,contentSource:e.contentSource,targetUrl:e.targetUrl,linkType:e.linkType,segments:e.segments,sequence:e.sequence,format:e.format,imageUrl:e.imageUrl,size:e.size}),JE=(e,t,n,o)=>{const r=F(),a=HJe[t][e];return h.useCallback(({id:i,name:l,altText:c,contentSource:d,targetUrl:u,linkType:m,segments:g,sequence:f,format:y,imageUrl:I,size:S})=>{const C=VJe({id:i,name:l,altText:c,page:n,placement:o,contentSource:d,targetUrl:u,linkType:m,segments:g,sequence:f,format:y,imageUrl:I,size:S});if(r(U.analyticsEvent({type:a,...C})),a==="ADVERTISING_BANNER_CLICKED"||a==="RESPONSIVE_ADVERTISING_BANNER_CLICKED"){const _=Rpe(C);J.sendEvent({GA:_,WA:null});const A=Ope(C,a);J.sendEvent({GA:A,WA:null})}if(a==="ADVERTISING_BANNER_IMPRESSION"||a==="RESPONSIVE_ADVERTISING_BANNER_IMPRESSION"){const _=Dpe(C);J.sendEvent({GA:_,WA:null});const A=Ppe(C,a);J.sendEvent({GA:A,WA:null})}},[n,o])},XC=(e,t)=>{const n=F(),[o]=fe(["cxe.by"]),r=JE("impression","STATIC_ADVERT",e,t),a=JE("click","STATIC_ADVERT",e,t),i=JE("impression","RESPONSIVE_ADVERT",e,t),l=JE("click","RESPONSIVE_ADVERT",e,t),c=h.useCallback(u=>{u&&n($Je(u,o))},[n,o]),d=h.useCallback(u=>{u&&n(GJe(u,o))},[n,o]);return{reportStaticAdvertImpression:r,reportStaticAdvertClick:a,reportResponsiveAdvertImpression:i,reportResponsiveAdvertClick:l,reportContentExperienceAdvertImpression:c,reportContentExperienceAdvertClick:d}},YJe=({externalAdvertId:e,targetUrlLength:t,productsNumber:n})=>U.analyticsEvent({type:xR.LISTER_PAGE_URL_LENGTH_LIMIT_BREAK,externalAdvertId:e,targetUrlLength:t,productsNumber:n}),WJe=(e,t)=>{const{reportStaticAdvertClick:n,reportStaticAdvertImpression:o,reportContentExperienceAdvertClick:r,reportContentExperienceAdvertImpression:a}=XC(e,t),i=F(),l=h.useCallback((u,m,g)=>{o({id:u.id,name:u.name,location:e,format:u.format,contentSource:u.contentSource,linkType:u.target.linkType,segments:u.segments,placement:t,targetUrl:m,imageUrl:g}),u.contentSource==="CITRUS_AD"&&a(u.id)},[e,t,o,a]),c=h.useCallback((u,m,g)=>{n({id:u.id,name:u.name,location:e,format:u.format,contentSource:u.contentSource,linkType:u.target.linkType,segments:u.segments,placement:t,targetUrl:m,imageUrl:g}),u.contentSource==="CITRUS_AD"&&r(u.id)},[e,t,n,r]),d=h.useCallback((u,m,g)=>{i(YJe({externalAdvertId:u,targetUrlLength:m,productsNumber:g}))},[i]);return{reportImpression:l,reportClick:c,reportUrlCharLimitBreak:d}},qJe=["basket","product-details","promotions","promotion-details","favorites","search","categories","logged-in-homepage","logged-out-homepage","slot-booking","edit-order","order-confirmation"],KJe=5e3,zJe=2500,QJe=h.createContext({loopIntervalMs:KJe,playDelayMs:zJe}),ef=(e,t)=>`${e}:${t}`,IP=({adverts:e,page:t,pageKey:n,placement:o,advertDimensionsMap:r,randomInitialIndex:a,"data-test":i="horizontal-advert",className:l,sizes:c,lazyLoad:d=!0,fetchPriority:u})=>{const m=h.useRef(null),g=h.useRef(null),f=SJe(),y=ps({breakpoint:"lg-up"}),I=DJe(y),[S]=EP(),[C]=fe(["seo.rdbl"]),[_,A]=h.useState(""),[x,R]=h.useState(),O=h.useContext(QJe),N=h.useContext(h8),[k,j]=h.useState([]),{initialAdvertId:w,updateLastViewedAdvertId:L}=IJe(t,n,o,""),{formatMessage:B}=M(),W=ge=>S?rI(ge,r[S]):null,{reportClick:$,reportImpression:K,reportUrlCharLimitBreak:Q}=WJe(t,o),X=ge=>e.find(Oe=>Oe.id===ge),re=ge=>{if(ge.contentSource==="CITRUS_AD"){const[Oe]=AF(ge);return Oe}return La.calculateLegacyTargetUrl(ge.target,{isSEOReadableURLEnabled:C})},ue=eC(g,{freezeOnceVisible:!1,threshold:.5,rootMargin:`-${f.current}px 0px -${I.current}px 0px`}),te=ge=>(N?.displayedAdverts??k).includes(ge),ce=ge=>{(N?.setDisplayedAdverts??j)(Xe=>[...Xe,ge])};h.useEffect(()=>{ye!==void 0&&je()},[S]),h.useEffect(()=>{if(!_||te(_)||!ue?.isIntersecting)return;const ge=X(_),Oe=S&&c.includes(S);if(ge&&Oe){if(K(ge,re(ge),W(ge.images)?.url),ge.contentSource==="CITRUS_AD"&&ge.target.values?.length){const[Xe,Se]=AF(ge);Se?.isCropped&&Q(ge.id,Se.fullUrlLength,ge.target.values.length)}ce(_)}},[_,ue?.isIntersecting]);const de=h.useMemo(()=>lJe.reduce((ge,Oe)=>{const[Xe,Se]=r[Oe]||[],dt=({width:et,height:we})=>et===Xe&&we===Se;return{...ge,[ef(Xe,Se)]:e.filter(({images:et})=>et.find(dt)).map(({id:et})=>et)}},{}),[e]),ye=h.useMemo(()=>{if(!S)return;const[ge,Oe]=r[S]||[],Xe=de[ef(ge,Oe)],Se=Xe.findIndex(dt=>dt===w);return Se>-1?Se:a?Math.floor(Math.random()*Xe.length):0},[w,S,de,a]),Ae=h.useCallback((ge,Oe)=>()=>{$(ge,Oe,W(ge.images)?.url)},[S,t,$]),Je=ge=>iJe(ge.target),Ie=h.useCallback(ge=>{if(!S)return;const[Oe,Xe]=r[S],Se=de[ef(Oe,Xe)][ge];A(Se),L(Se)},[S,de]),je=()=>{if(!S)return;const[ge,Oe]=r[S];A(Xe=>{const Se=de[ef(ge,Oe)].findIndex(dt=>dt===Xe);return R(Math.max(Se,0)),Xe})},Le=()=>{if(d)return fP()?"eager":"lazy"},Be=(ge,Oe,Xe)=>{const{images:Se,isExternalLink:dt,position:et=0,contentSource:we}=ge;if(!S)return null;const Ut=rI(Se,r[S]),ys=Ut?.altText||Se[0]?.altText||"",Xs=re(ge),Ur=`horizontal-advert-item-${et}`,as=B("scroller.accessibility.banner",{i:Oe+1,total:Xe,altText:ys});return Ut&&s.jsx(BJe,{linkType:ge?.target?.linkType,"aria-label":as,"data-test":Ur,isExternalLink:dt,href:Xs,title:ys,target:u8(ge),onClick:Ae(ge,Xs),onFocus:Je,children:s.jsx(QC,{image:Ut,contentSource:we,sizes:"calc(100vw - 1em)",children:s.jsx(MJe,{src:Ut.url,alt:Ut?.altText??"",loading:Le(),advertDimensionsMap:r,fetchPriority:u})})},et)},be=h.useMemo(()=>{const ge=e.filter(Xe=>W(Xe.images)),Oe=ge.length;return ge.map((Xe,Se)=>Be(Xe,Se,Oe))},[e,S]);if(!qJe.includes(t)||e.length===0)return null;const he=ye!==void 0&&be.length>0;return s.jsx(wJe,{advertSizes:c,"data-test":i,className:l,adverts:e,advertDimensionsMap:r,children:he?s.jsx(Swe,{loopIntervalMs:O.loopIntervalMs,playDelayMs:O.playDelayMs,isVisible:!!ue?.isIntersecting,ref:m,fwBodyRef:g,startFromIndex:ye,activeItemIndex:x,onCurrentIndexChange:Ie,children:be}):s.jsx(kJe,{advertDimensionsMap:r,adverts:e,sizes:c})})},E8=e=>{switch(e){case"edit-order":case"basket":return XZe;case"order-confirmation":return l8;default:return()=>[[],{randomizeInitialHorizontalAdvert:!1},!1]}},f8=({page:e,pageKey:t,className:n})=>{const[o,r,a]=E(E8(e));return a||o.length===0?null:s.jsx(IP,{adverts:o,advertDimensionsMap:dJe,page:e,pageKey:t,placement:"BELOW_GRID",randomInitialIndex:r.randomizeInitialHorizontalAdvert,className:n,sizes:["LARGE","MEDIUM","SMALL"]})},XJe=D("fppco"),y8=(e,t,n,o)=>{if(XJe(n)){const r=rr(n);t(Vc.getFailedOrderPayments(r))}return t(U.analyticsEvent({type:xt.FAILED_PAYMENT_SUCCESS,orderId:e})),o(CR(e))},ZJe=({paymentSession:e,orderId:t,payerForRecurringOrder:n,paymentMethod:o,navigate:r})=>(a,i)=>{const l=i();return a(Vc.updateFailedOrderPayment({paymentSession:e,orderId:t,payerForRecurringOrder:n,paymentMethod:o})).then(c=>{const{url:d}=c.payload.responseData;return d?e.initiatePaymentAuthentication({authenticationUrl:d}):y8(t,a,l,r)})},JJe=(e,t,n)=>(o,r)=>{const a=r();return o(Vc.validateUpdatePayment(e)).then(i=>{sessionStorage.setItem("paymentUpdate",JSON.stringify(i?.payload?.responseData)),y8(t,o,a,n)}).catch(()=>Promise.all([Promise.resolve(z.error("payment.failed.error.general")),n(sc({orderId:t}))]))},eet=()=>(e,t)=>{const n=rr(t());return e(Vc.getFailedOrderPayments(n))},SP={fetchFailedOrderPayments:eet},tet=ee("GET_CART_ADVERTS"),I8=()=>({type:"API",payload:{url:"/v1/content?page=CART",...tet}}),set=e=>typeof e!="string"&&!!e.amount&&!!e.currency,Tl=(e,t)=>set(e)?t(e):e,S8=(e,t)=>{if(!e)return;const{halfPrice:n,free:o}=e;if(n&&o){const r={freeDeliveryThreshold:Tl(o.minSpend,t),halfPriceDeliveryThreshold:Tl(n.minSpend,t)};return o.reached?{id:"delivery.price.modification.levels.half.and.free.free.reached",substitutions:r,type:"success"}:n.reached?o.leftToSpend?{id:"delivery.price.modification.levels.half.and.free.free.almost.reached",substitutions:{...r,freeDeliveryRemainingAmount:Tl(o.leftToSpend,t)},type:"warning"}:{id:"delivery.price.modification.levels.half.and.free.half.reached",substitutions:r,type:"success"}:n.leftToSpend?{id:"delivery.price.modification.levels.half.and.free.half.almost.reached",substitutions:{...r,halfPriceDeliveryRemainingAmount:Tl(n.leftToSpend,t)},type:"warning"}:{id:"delivery.price.modification.levels.half.and.free.none.reached",substitutions:r,type:"info"}}if(n){const r={halfPriceDeliveryThreshold:Tl(n.minSpend,t)};return n.reached?{id:"delivery.price.modification.levels.half.only.reached",substitutions:r,type:"success"}:n.leftToSpend?{id:"delivery.price.modification.levels.half.only.almost.reached",substitutions:{...r,halfPriceDeliveryRemainingAmount:Tl(n.leftToSpend,t)},type:"warning"}:{id:"delivery.price.modification.levels.half.only.not.reached",substitutions:r,type:"info"}}if(o){const r={freeDeliveryThreshold:Tl(o.minSpend,t)};return o.reached?{id:"delivery.price.modification.levels.free.only.reached",substitutions:r,type:"success"}:o.leftToSpend?{id:"delivery.price.modification.levels.free.only.almost.reached",substitutions:{...r,freeDeliveryRemainingAmount:Tl(o.leftToSpend,t)},type:"warning"}:{id:"delivery.price.modification.levels.free.only.not.reached",substitutions:r,type:"info"}}},net=()=>{const e=Ne(),t=tt.parse(e.search);return{shouldShowGenericErrorWhenCheckoutGroupRemoved:t.showError==="true",isBelowMinSpendErrorInUrl:t.error==="below-minimum-spend",errorShippingGroupType:t.errorShippingGroupType||""}},C8=()=>{const e=F();return()=>e(nc())},oet=()=>{const e=F();return h.useCallback(()=>e(SP.fetchFailedOrderPayments),[e])},ret=()=>{const e=F();return h.useCallback(()=>e(I8()),[e])},aet=(e,t)=>{const o={...tt.parse(e.search),error:void 0,errorShippingGroupType:void 0,showError:void 0},r=tt.stringify(o),a=r?`${e.pathname}?${r}`:e.pathname;t(a)},iet=(e,t=!1,n=!1)=>{const o=Ne(),r=We(),a=mP(),i=E(d=>Zt(d)),l=E(d=>Iie(d,e)),c=l||i;return h.useCallback(()=>{t&&!l&&n?z.error("toast.notification.generic.error"):a({basketSummary:c,type:t?"warning":"error"}),aet(o,r)},[t,l,n,o,r,a,c])},cet=()=>{const e=M(),t=E(At),n=eo();return h.useCallback((o,r)=>{if(!r)return;const a=r?.id,i=r?.substitutions;if(TZe(a,t))return;const l=o?.id;l&&z.close(l);const c=i?{key:a,substitutions:i}:a;z[r?.type||"info"](c,{id:a}),n({type:_e.TOAST_NOTIFICATION_DISPLAYED,description:"User informed about delivery charge by spend thresholds",pageEventAttributes:{message:e.formatMessage(a,i),messageId:a}})},[e,t,n])},det=()=>{const e=ze(),[t,n]=h.useState(void 0),o=E(Sd),[r]=o,a=!r?.checkout?.basketAboveThreshold,i=Vp(mp),l=S8(r?.deliveryPriceModificationLevels,e),c=cet();return h.useEffect(()=>{const d=!!l&&l?.id!==t?.id;!a&&!i&&d&&(c(t,l),n(l))},[t,l,a,i,c])},T8=T.span`
    margin-block: 0;
    margin-inline: var(--salt-spacing-1) 0;
    padding: var(--salt-spacing-1);
    border: 0;
    background: transparent;
    display: flex;
    font-family: var(--font-family);
`,_8=T.button`
    display: flex;
    flex-wrap: nowrap;
    align-items: center;
    justify-content: space-between;
    cursor: pointer;
    inline-size: 100%;
    font-family: var(--font-family);
    background: var(--intent-contrast);
    border-radius: var(--salt-radius-default);
    padding: var(--salt-spacing-2);

    &:hover {
        background-color: var(--intent-secondary-900);
        border-color: var(--intent-secondary-900);
        color: var(--intent-secondary-900-contrast);
    }
`,uet=T.img`
    inline-size: 30px;
    block-size: 30px;
    margin-block: auto;
    margin-inline: 0;
`,hZt=T.div`
    display: flex;
    flex-wrap: wrap;
    gap: var(--salt-spacing-2);
    overflow: hidden;
    block-size: ${H(50)};
`,gZt=T.img`
    inline-size: ${H(50)};
    block-size: ${H(50)};
    visibility: ${({visible:e=!0})=>e?"visible":"hidden"};
`,EZt="alc.blur",pet="age.vis",fZt={CANCEL:"CANCEL",DELETE:"DELETE LIST"},yZt={CANCEL:"CANCEL",SAVE:"SAVE"},IZt={Edit:"Edit",Delete:"Delete",Close:"Close"},SZt={CREATE:"shoppingListCreate",UPDATE_NAME:"shoppingListUpdateName",DELETE:"shoppingListDelete"},met={LIST_ADDED:"shopping.lists.modal.accessibility.notification.product.list.added",LIST_REMOVED:"shopping.lists.modal.accessibility.notification.product.list.removed",FAVORITE_ADDED:"shopping.lists.modal.accessibility.notification.product.fav.added",FAVORITE_REMOVED:"shopping.lists.modal.accessibility.notification.product.fav.removed"},het=T.div`
    inline-size: 30px;
    block-size: 30px;
    margin-block: auto;
    margin-inline: 0;
    flex-shrink: 0;
    background-color: var(--intent-secondary);
    border-radius: var(--salt-radius-default);
`,v8=({productName:e,imageUrl:t,restrictedVisibility:n})=>{const[o]=fe([pet]),r=o&&n;return s.jsx(ve,{condensed:!0,"data-test":"shopping-list-modal-product-details",className:"salt-m-b--4",children:s.jsxs(se,{wrap:"nowrap",children:[r?s.jsx(het,{}):s.jsx(uet,{src:t,alt:e}),s.jsx(P,{className:"salt-m-y--1 salt-m-l--2",size:"l",children:e})]})})},CP=({productId:e,onClick:t})=>s.jsx(b,{size:"m",intent:"tertiary",fill:!1,onClick:()=>t(e),"data-test":CP.dataTestId,"aria-label":M().formatMessage("regular.addToRegulars.back.arrow.ariaLabel"),children:s.jsx(b.Icon,{name:"arrow_left"})});CP.dataTestId="add-to-regulars-back-arrow-button";const get=({product:e,onBackArrowClick:t})=>s.jsx(G.Header,{align:"left",className:t?"salt-p-l--2 salt-p-r--4 salt-p-y--2":"salt-p-x--4 salt-p-y--2",children:s.jsxs(se,{align:"center",children:[t?s.jsx(CP,{productId:e.productId,onClick:t}):null,s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"regular.addToRegulars.modal.header"})})]})}),Eet={PROMISE_ON_ADDING_ITEM:"regular.addToRegulars.body.promise.on.adding.item",PROMISE_ON_CHECKOUT:"regular.addToRegulars.body.promise.on.checkout"},fet=()=>{const e=E(uae);if(!e)return null;const t=Eet[e];return t?s.jsx(Ce,{intent:"info",text:s.jsx(v,{id:t}),showIcon:!1}):null},yet=T(ii)`
    inline-size: ${({inlineSize:e})=>typeof e=="string"?e:H(e)};
    text-align: ${({textAlign:e})=>FS(e)};
`;function A8({name:e,textAlign:t="start",maxWidth:n="100%",allowZeroQuantity:o=!1,size:r,hasError:a,ariaLabel:i,isDisabled:l,initialQuantity:c,onQuantityChange:d,id:u,label:m}){const[g,f]=h.useState(c),y=h.useRef(null),I=R=>{switch(o){case!0:if(R<0)return 0;break;case!1:if(R<1)return 1;break;default:return R}return R},S=R=>R>BA?BA:R,C=R=>{let O=R;O=I(O),O=S(O),f(O)},_=R=>{const{key:O}=R;O==="Enter"&&y.current?.blur()},A=R=>{const{value:O}=R.target;if(O===""){f("");return}Number.isInteger(Number(O))?C(Number(O)):f(g)},x=()=>{g===""?f(c):d(Number(g))};return s.jsx(yet,{label:m??"",hideLabel:!m,last:!m,ref:y,id:u,name:e,"data-test":"fop-quantity-input",type:"text",size:r,hasError:a,inlineSize:n,textAlign:t,disabled:l,"aria-label":i,value:g,input:{onBlur:x,onChange:A,onKeyDown:_},meta:{invalid:!1,touched:!1}})}const b8=T.div`
    position: relative;

    ${oe.smUp`
        position: static;
    `};
`,Iet=T.div`
    padding-block: 0 var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-2);

    ${oe.smUp`
        padding-block: 0 var(--salt-spacing-2);
        padding-inline: var(--salt-spacing-1);
    `};

    ${oe.lgUp`
        padding-inline: var(--salt-spacing-2);
        padding-block: 0;
    `};
`;b8.displayName="DropdownGroup";const $m=b8;$m.Bar=Iet;$m.Bar.displayName="DropdownGroupBar";const Cet=T.button`
    display: flex;
    flex-wrap: nowrap;
    align-items: center;
    justify-content: start;
    cursor: pointer;
    inline-size: ${({fill:e})=>e?"100%":"fit-content"};
    font-family: var(--font-family);
    background: var(--intent-contrast);
    border: none;
    border-radius: var(--salt-radius-0);
    padding: var(--salt-spacing-1);

    &:hover {
        background: none;

        > .dropdown-item-button {
            font-weight: 600;
        }
    }
`,Tet=h.forwardRef(({children:e,fill:t=!0,...n},o)=>s.jsx(Cet,{ref:o,type:"button",fill:t,...n,children:s.jsx(P,{className:"dropdown-item-button",children:e})})),_et=T.button`
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: start;
    gap: var(--salt-spacing-2);
    cursor: pointer;
    font-family: var(--font-family);
    font-weight: 600;
    padding-block: 0;
    padding-inline: var(--salt-spacing-2);
    min-block-size: ${({size:e})=>H(e==="s"?28:40)};
    min-inline-size: ${({size:e})=>H(e==="s"?28:40)};
    inline-size: ${({fill:e})=>e?"100%":"fit-content"};
    block-size: 100%;
    vertical-align: middle;
    background-color: var(--intent-contrast);
    color: var(--intent-content);
    border: ${({bordered:e})=>e?"var(--salt-border-1) solid":"none"};
    border-radius: var(--salt-radius-default);
    border-color: var(--intent-secondary-800);

    &:hover {
        background-color: var(--intent-secondary-900);
        border-color: var(--intent-secondary-900);
        color: var(--intent-secondary-900-contrast);
    }

    &:disabled {
        background-color: var(--intent-contrast);
        border-color: var(--intent-secondary-200);
        color: var(--intent-secondary-200);
        cursor: default;
        pointer-events: none;
    }
`,vet=T.span`
    margin: 0;
    padding: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-align: start;
`,Aet=T(me)`
    margin-inline-start: auto;
`,bF="close_default",xF="arrow_down",bet=h.forwardRef(({isOpen:e,iconName:t,text:n,fill:o=!1,size:r="m",type:a="button",bordered:i=!1,...l},c)=>{const d=r==="s"?16:18;return s.jsxs(_et,{fill:o,size:r,type:a,bordered:i,...l,ref:c,children:[t&&s.jsx(me,{name:t,height:d,width:d,"data-test":`icon__${t}`}),n&&s.jsx(vet,{children:n}),s.jsx(Aet,{name:e?bF:xF,height:d,width:d,"data-test":e?`icon__${bF}`:`icon__${xF}`})]})}),Ot={Body:pq,Container:uq,Content:mq,Footer:tUe,ItemButton:Tet,TriggerDefaultButton:bet,TriggerSaltButton:hq},xet=T(Ot.Container)`
    inline-size: 100%;
    min-inline-size: 0;
    position: relative;
`,TP=({initialFrequency:e,onSelect:t,isDisabled:n,ariaLabel:o,size:r,dropDownButtonId:a,options:i=s8})=>{const{formatMessage:l}=M(),[c,d]=h.useState(!1),[u,m]=h.useState(e),g=()=>d(!1),f=()=>d(!c),y=gP(g,[c]),I=C=>l(i.find(_=>_.value===C)?.translationId||""),S=C=>{g(),C!==u&&(m(C),t(C))};return s.jsxs(xet,{ref:y,children:[s.jsx(Ot.TriggerDefaultButton,{size:r==="sm"?"s":"m",fill:!0,text:I(u),disabled:n,"data-synthetics":"header-frequency-select","data-test":"header-frequency-dropdown",onClick:f,isOpen:c,id:a,"aria-controls":"select-frequency-menu","aria-expanded":c,"aria-label":o,"aria-haspopup":"true",bordered:!0}),s.jsx(Ot.Body,{isOpen:c,children:s.jsx(Ot.Content,{children:s.jsx(Ve,{"data-test":"select-frequency-menu",inline:!1,children:i.map(({translationId:C,value:_})=>s.jsx(Ve.Item,{"data-test":"select-frequency-item",children:s.jsx(Ot.ItemButton,{"data-test":`frequency-item-button-${_}`,onClick:()=>S(_),children:l(C)})},_))})})})]})};TP.dataTestId="fop-frequency-select";const RF="md",Ret=1,Det="WEEKLY",_P=({productName:e,onSubmitValues:t})=>{const{formatMessage:n}=M(),[o,r]=h.useState(Ret),[a,i]=h.useState(Det),l=h.useMemo(()=>({frequency:{ariaLabel:n("regular.frequency.ariaLabel",{productName:e}),label:n("regular.addToRegularsForm.addToTrolley")},quantity:{label:n("regular.addToRegularsForm.quantity"),ariaLabel:n("regular.quantity.ariaLabel",{productName:e})},submitButton:{ariaLabel:n("regular.addToRegulars.accessibility.button",{productName:e})}}),[]),c=m=>r(m),d=m=>i(m),u=m=>{m.preventDefault(),t({quantity:o,frequency:a})};return s.jsxs("form",{"data-test":_P.dataTestId,onSubmit:u,children:[s.jsx(sP,{className:"salt-m-y--4",id:"select-frequency-menu-button",label:l.frequency.label,children:s.jsx(TP,{dropDownButtonId:"select-frequency-menu-button",initialFrequency:a,size:RF,ariaLabel:l.frequency.ariaLabel,onSelect:d,isDisabled:!1})}),s.jsx(A8,{label:l.quantity.label,name:"quantity",id:"add-to-regulars-form-quantity-input",size:RF,ariaLabel:l.quantity.ariaLabel,initialQuantity:o,onQuantityChange:c,isDisabled:!1}),s.jsx(fet,{}),s.jsx(b,{className:"salt-m-t--4",type:"submit",intent:"primary",fill:!0,"aria-label":l.submitButton.ariaLabel,children:s.jsx(b.Text,{children:s.jsx(v,{id:"regular.addToRegularsForm.submit"})})})]})};_P.dataTestId="add-to-regulars-form";const vP=({onBackArrowClick:e,onModalRequestClose:t,onSuccess:n})=>{const o=M(),r=F(),a=E(Uze),{productId:i,productIndex:l=0,page:c="",section:d=""}=a||{productId:""},u=E(A=>sl(A,i)),[m]=fe([Ud]),g=WC(),f=hP();h.useEffect(()=>{u&&g.addToRegularsModalDisplayed({productId:i,retailerProductId:u.retailerProductId})},[u]);const y=()=>{r(LC({productId:""})),t?.()},I=async({quantity:A,frequency:x})=>{try{await r(Lze({productId:i,frequency:x,quantity:A})),r(Ft.updateProducts({product:[{productId:i,regular:{frequency:x,quantity:A}}]})),z.success({key:"regular.addToRegularsModal.success",substitutions:{productName:u.name}},{ariaLabel:o.formatMessage("regular.addToRegularsModal.success.ariaLabel",{productName:u.name})}),n&&n({productId:i,productIndex:l,page:c,section:d}),g.toastNotificationDisplayed("regularAdded"),g.productAddedToRegulars({productId:i,retailerProductId:u.retailerProductId,frequency:x,quantity:A}),c&&l>=0&&f.regularsGaEvent({retailerProductId:u.retailerProductId,productName:u.name,quantity:A,frequency:x,productIndex:l,list:Ws(c,null,d)??"",event:"add_to_regulars"})}catch{z.error("regular.addToRegularsModal.error")}},S=h.useCallback(I,[i]),C=A=>{y(),S(A)},_=()=>{e?.({productId:i,productIndex:l,page:c,section:d})};return m?s.jsx(G,{isOpen:!!u,onRequestClose:y,aria:{labelledby:"add-to-regulars-modal"},"data-test":vP.dataTestId,children:u?s.jsxs(h.Fragment,{children:[s.jsx(get,{product:u,onBackArrowClick:e?_:void 0}),s.jsxs(G.Body,{className:"salt-p-x--4 salt-p-b--4 salt-p-t--4",children:[s.jsx("div",{className:"salt-m-b--4",children:s.jsx(v8,{productName:u.name,imageUrl:u.image.src,restrictedVisibility:u.restrictedVisibility})}),s.jsx(_P,{onSubmitValues:C,productName:u.name})]})]}):null}):null};vP.dataTestId="add-to-regulars-modal";const Oet=T(se)`
    flex-grow: 1;
`,AP=({translations:e,isOpen:t,onConfirm:n,onCancel:o})=>s.jsxs(G,{isOpen:t,onRequestClose:o,aria:{labelledby:"remove-all-regulars-modal"},"data-test":AP.dataTestId,children:[s.jsx(G.Header,{align:"left",className:"salt-p-x--4",children:s.jsx(ne,{as:"h2",children:s.jsx(v,{id:e.header})})}),e.body&&s.jsx(G.Body,{className:"salt-p-x--4",children:s.jsx(v,{id:e.body})}),s.jsx(G.Footer,{align:"center",className:"salt-p-x--4",children:s.jsxs(Oet,{justify:"center",wrap:"nowrap",children:[s.jsx(b,{intent:"secondary",fill:!0,className:"salt-m-r--2",onClick:o,children:s.jsx(b.Text,{children:s.jsx(v,{id:e.cancel})})}),s.jsx(b,{intent:"primary",fill:!0,onClick:n,children:s.jsx(v,{id:e.confirm})})]})})]});AP.dataTestId="remove-all-regulars-modal";const Pet=({onConfirm:e})=>{const t=F(),n=E(Ue(t8)),{removeAllRegularsFromBasketModalDisplayed:o,toastNotificationDisplayed:r}=WC();h.useEffect(()=>{n&&o()},[n]);const a=()=>{t(Z.closeModal())},i=()=>{z.success("regular.basketRemoveAllModal.success"),r("allRegularsRemovedFromTrolley"),a()},l=()=>{z.error("regular.basketRemoveAllModal.error")},c=async()=>{try{await e(),i()}catch{l()}};return s.jsx(AP,{translations:{header:"regular.basketRemoveAllModal.header",cancel:"regular.basketRemoveAllModal.cancel",confirm:"regular.basketRemoveAllModal.okay"},isOpen:n,onConfirm:c,onCancel:a})};function Net({onConfirm:e}){const t=F(),n=KC(),o=()=>{t(Z.openModal(t8))};return n&&e?s.jsxs(h.Fragment,{children:[s.jsxs(b,{onClick:o,intent:"secondary","data-test":"basket-remove-regulars",children:[s.jsx(b.Icon,{name:"regulars"}),s.jsx(b.Text,{children:s.jsx(v,{id:"regular.basketButton.removeAll"})})]}),s.jsx(Pet,{onConfirm:e})]}):null}const Let=()=>{const e=F(),t=eo(),n=Vp(Ze);return h.useCallback(o=>{n&&e(Da.updateCustomerPreferenceBasketView(o)),e(Da.setCustomerPreferenceBasketView(o)),t({type:Te.TROLLEY_VIEW_CHANGE_VIEW_TYPE_BUTTON_CLICKED,description:"Trolley page view type change",pageEventAttributes:{componentLocation:"Body",componentType:"FOP",linkType:"Button",userInteraction:"BUTTON_CLICKED"}})},[t,e,n])},ket=e=>h.useMemo(()=>[Fs.DETAIL,Fs.GRID,Fs.LIST].map(t=>({id:t,messageKey:mA[t],selected:t===e})),[e]),{RadioIconOff:Met,RadioIconOn:jet,RadioText:wet}=ha,x8=({checked:e,bold:t,label:n,dataTestId:o,itemProps:r})=>s.jsx(Ve.Item,{...r,children:s.jsx(ve,{condensed:!0,children:s.jsxs(bn,{children:[e?s.jsx(jet,{name:"radio_on"}):s.jsx(Met,{name:"radio_off"}),s.jsx(wet,{asChild:!0,bold:t,"data-test":o,children:s.jsx("span",{children:n})})]})})});x8.displayName="BasketViewListItem";const Fet=({options:e,selectedId:t,basketViewHandler:n,onOpen:o=()=>{},isButtonFullWidth:r=!1})=>{const a=M(),[i]=fe(["thcu"]),l=e.find(k=>k.id===t),c=a.formatMessage(l.messageKey),d=`${c}. ${a.formatMessage("basket.view.accessibility.button.closed")}`,u=`${c}. ${a.formatMessage("basket.view.accessibility.button.open")}`,m=k=>k?a.formatMessage(k.messageKey):"",{isOpen:g,getToggleButtonProps:f,getMenuProps:y,getLabelProps:I,getItemProps:S,toggleMenu:C,selectedItem:_,highlightedIndex:A}=Iu({items:e,itemToString:m,selectedItem:l,onSelectedItemChange:k=>n(k.selectedItem),labelId:"basket-view-label",menuId:"basket-view-menu"}),x=f({"aria-pressed":g,"aria-label":g?u:d,role:void 0,"aria-labelledby":void 0,"aria-activedescendant":void 0}),R=I({htmlFor:void 0}),{ref:O,...N}=y();return s.jsxs(Ot.Container,{children:[s.jsx(Ot.TriggerSaltButton,{intent:i?"tertiary":"secondary",isOpen:g,text:c,iconName:pA[t],fill:r,ref:x.ref,...x,...R,onClick:()=>{g||o(),C()},"data-test":"basket-view-button"}),s.jsx(Ot.Body,{isOpen:g,"data-test":"basket-view-menu",children:s.jsx(Ot.Content,{children:s.jsx(Ve,{inline:!1,...N,innerRef:O,children:e.map((k,j)=>{const w=_?.id===k.id,L=S({index:j,item:k,"aria-selected":w});return s.jsx(x8,{label:m(k),checked:w,bold:A===j,dataTestId:`basket-view-option-${k.id}`,itemProps:L},k.id)})})})})]})},R8=()=>{const e=E(AS),t=ket(e),n=Let(),o=F(),r=i=>{n(i.id)},a=()=>{o(U.analyticsEvent({type:Te.OPEN_MENU_CLICKED,menuId:"BASKET-VIEW"}))};return s.jsx("div",{"data-test":"basket-view-dropdown",children:s.jsx(Fet,{options:t,basketViewHandler:r,selectedId:e,onOpen:a,isButtonFullWidth:!0})})};R8.displayName="BasketViewDropdown";const Bet=D("bt.view.dd"),Uet=D("bt.spl"),Get=()=>{const e=E(Bet),t=E(Uet);return!e&&!t?s.jsx(FA,{}):s.jsxs(h.Fragment,{children:[s.jsx(cs,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(R8,{})}),!t&&s.jsx(Kt,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(FA,{})})]})},DF="remove-instant-shop-items-modal-header",$et="removeInstantShopItems",Het=()=>{const e=M();return h.useMemo(()=>({heading:e.formatMessage("instant.shop.remove.modal.heading"),remove:e.formatMessage("instant.shop.remove.modal.remove"),cancel:e.formatMessage("instant.shop.remove.modal.cancel")}),[e])},Vet=()=>{const e=pl(),t=eo();return h.useCallback(()=>{t({type:Te.INSTANT_SHOP_REMOVE_FROM_BASKET_MODAL,description:"The remove instant shop from basket modal is displayed",pageEventAttributes:{userAction:"Close"}}),e()},[t,e])},Yet=e=>{const t=pl(),n=eo();return h.useCallback(()=>{e(),n({type:Te.INSTANT_SHOP_REMOVE_FROM_BASKET_MODAL,description:"The remove instant shop from basket modal is displayed",pageEventAttributes:{userAction:"Products removed"}}),t()},[e,n,t])},Wet=({removeInstantShopItemsAction:e})=>{const t=Hg($et),n=$g(),o=Het(),r=Vet(),a=Yet(e);return s.jsxs(G,{isOpen:t,onRequestClose:r,aria:{labelledby:DF},children:[s.jsx(G.Header,{align:n?"left":"center",children:s.jsx(ne,{as:"h2",id:DF,children:o.heading})}),s.jsx(G.Body,{children:s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{fill:!0,intent:"secondary",onClick:r,children:s.jsx(b.Text,{children:o.cancel})})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{fill:!0,intent:"primary","data-test":"instant-shop-confirm-remove",onClick:a,children:s.jsx(b.Text,{children:o.remove})})})]})})]})},qet=()=>{const e=Ne(),[t,n]=h.useState(!1),o=qC("removeInstantShopItems"),r=kZe({location:e,setInstantShopProductsRemoved:n});return e?.state?.addedProducts?.length>0&&!t?s.jsxs(h.Fragment,{children:[s.jsxs(b,{onClick:o,intent:"secondary","data-test":"instant-shop-remove-button",children:[s.jsx(b.Icon,{name:"smart_cart_remove"}),s.jsx(b.Text,{children:s.jsx(v,{id:"instant.shop.remove"})})]}),s.jsx(Wet,{removeInstantShopItemsAction:r})]}):null},Ket=()=>{const e=F(),t=E(pa);return({products:n})=>{n.forEach(o=>e(U.analyticsEvent({type:Te.REMOVE_ALL_OUT_OF_STOCK_ITEMS_FROM_BASKET,addedByFunction:"REMOVE_ALL_OUT_OF_STOCK_ITEMS_FROM_BASKET",basketTotalAmount:t?.amount,basketTotalCurrency:t?.currency,priceAmount:o?.price?.current.amount,priceCurrency:o?.price?.current.currency,productId:o.productId,retailerProductId:o?.retailerProductId,totalQuantity:0,updateQuantity:-o.quantity.quantityInBasket})))}},zet=e=>{const t=F(),n=Ket(),o=pl();return async()=>{if(o(),!e.length)return;const r=await t(ca.removeBasketItems(e.map(({productId:a,quantity:{quantityInBasket:i}})=>({productId:a,quantity:i}))));n({products:e}),t(jd(r?.pricingNotifications,!0))}},bP="basketRemoveUnassignedItemsModal",OF="basket-remove-unavailable-items-modal-header",D8=({products:e})=>{const t=zet(e),n=pl(),o=Hg(bP),r=$g(),a=M(),i=a.formatMessage("basket.remove.unavailable.items.modal.header"),l=a.formatMessage("basket.header.empty.modal.cancel");return s.jsxs(G,{isOpen:o,onRequestClose:n,aria:{labelledby:OF},children:[s.jsx(G.Header,{align:r?"left":"center",children:s.jsx(ne,{as:"h1",id:OF,children:i})}),s.jsx(G.Body,{children:s.jsxs(Y,{children:[s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{"data-test":"basket-remove-unavailable-items-cancel-button","data-synthetics":"basket-remove-unavailable-items-cancel-button",fill:!0,intent:"secondary",onClick:n,children:s.jsx(b.Text,{children:l})})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{"data-test":"basket-remove-unavailable-items-button","data-synthetics":"basket-remove-unavailable-items-button",onClick:t,intent:"primary",fill:!0,children:s.jsx(b.Text,{children:s.jsx(v,{id:"basket.remove.unavailable.items.button.text"})})})})]})})]})},Qet=()=>{const e=qC(bP),t=E(The);return t.length?s.jsxs(h.Fragment,{children:[s.jsx(b,{"data-test":"basket-remove-unavailable-items-open-modal-button","data-synthetics":"basket-remove-unavailable-items-open-modal-button",onClick:e,intent:"secondary",fill:!0,children:s.jsx(b.Text,{children:s.jsx(v,{id:"basket.remove.unavailable.items.button.text"})})}),s.jsx(D8,{products:t})]}):null},Xet=T(se)`
    gap: var(--salt-spacing-4) var(--salt-spacing-4);
    flex-wrap: wrap;

    button {
        inline-size: 100%;
        flex: 1 0 34%;
        ${oe.lgUp`
            width: auto;
            flex: 0 1 auto;
        `};
    }
`,UA=({className:e,dataTestId:t,isOrder:n=!1})=>{const[o,r]=fe(["bt.spl","thcu"]),a=GZe();return s.jsxs(Xet,{className:e,"data-test":t,children:[s.jsx(Get,{}),s.jsx(e8,{}),!n&&!r&&s.jsxs(h.Fragment,{children:[s.jsx(qet,{}),s.jsx(Net,{onConfirm:a}),!o&&s.jsx(Qet,{})]})]})},Zet=()=>{const[e,t]=fe(["bt.spl","thcu"]),n=ps({breakpoint:"lg-up"});return!e||t&&n?null:s.jsx(Kt,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(UA,{className:"salt-m-t--4",dataTestId:"bottom-basket-fop-buttons"})})},aI=({className:e})=>{const n=M().formatMessage("basket.summary.footer");return n.trim().length===0?null:s.jsx(Ce,{intent:"info",className:e,"data-test":"summary-footer-alert",size:"s",text:n})},Jet=()=>{const[e,t]=fe(["bt.spl","thcu"]),n=E(Mr),o=ps({breakpoint:"lg-up"});return t&&o?null:s.jsxs(h.Fragment,{children:[!t&&!n&&s.jsx(Kt,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(aI,{className:"salt-m-b--4"})}),e?s.jsx(cs,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(UA,{className:"salt-m-b--4",dataTestId:"top-basket-fop-buttons"})}):s.jsx(UA,{className:"salt-m-b--4",dataTestId:"top-basket-fop-buttons"})]})},ett=(e,t)=>async n=>{if(!e?.length)return;let o=null;try{o=await n(Ht.getBasket())}catch{o=null}if(!o)return;n(U.analyticsEvent({type:Te.ADD_TO_CART_GA4,basket:o,page:"SMART_SHOP",addedByFunction:"SMART_SHOP_ADD",product:e,productListName:"smart-shop: other"})),yC({products:e,basket:o,page:"SMART_SHOP",addedByFunction:"SMART_SHOP_ADD",productListName:"smart-shop: other",featuredProductCampaigns:t}).forEach(a=>{J.sendEvent({GA:a,WA:null})}),Object.values(e).forEach(a=>{const i=fC({products:[a],basket:o,page:"INSTANT_SHOP",addedByFunction:"INSTANT_SHOP_ADD",productListName:"smart-shop: other"});return J.sendEvent({GA:i,WA:null}),n(U.analyticsEvent({type:Te.ADD_BASKET_ITEM,basket:o,page:"INSTANT_SHOP",addedByFunction:"INSTANT_SHOP_ADD",product:[a],productListName:"smart-shop: other"}))})},ttt=()=>e=>e(Qy.getInstantShopAvailability()),stt=e=>async t=>{try{const o=(await t(Qy.addInstantShopProductsToBasket()))?.payload?.responseData;if(!o?.addedProducts?.length)return Me.api.pushError(new Error("Instant Shop: No products added to basket"),{context:{responseData:JSON.stringify(o)}}),null;const a=(await t(Ci({products:o?.addedProducts?.map(l=>({id:l?.productId})),ignoreProductCache:!0})))?.payload?.product;if(!a)return null;const i=o?.addedProducts?.map(l=>({...a?.[l?.productId],quantity:l?.quantity}));return await t(ett(i,e)),i}catch{return null}},xP={fetchInstantShopAvailability:ttt,addInstantShopProductsToBasket:stt},PF={[Uc.INSTANT_SHOP_MODAL_DISPLAYED]:"The instant shop modal is displayed to the user",[Uc.INSTANT_SHOP_ADD_TO_CART_CLICKED]:"User clicked on add to cart button for instant shop"},tf={iconSize:40,size:100,strokeWidth:4},ntt=T.div`
    inline-size: 100%;
    block-size: 100%;
    background-color: ${({success:e})=>e?"var(--intent-action-50)":"var(--intent-contrast)"};
    transition: background-color 300ms linear;
`,ott=T.div`
    position: relative;
    inline-size: ${({width:e})=>H(e)};
    block-size: ${({height:e})=>H(e)};
    margin-block: var(--salt-spacing-16);
    margin-inline: auto;
    opacity: ${({ringVisible:e})=>e?1:0};
    transition: opacity 300ms linear;
`,rtt=T.svg`
    position: absolute;
    inset-block-start: 0;
    inset-inline-end: 0;
    inline-size: ${({width:e})=>H(e)};
    block-size: ${({height:e})=>H(e)};
    fill: transparent;
    transform: rotate(-90deg);

    & circle {
        stroke-width: ${({strokeWidth:e})=>H(e)};
        stroke-dashoffset: 0;
        transition: stroke-dashoffset 2.3s linear;
        stroke-dasharray: ${({radius:e})=>Math.PI*(e??0)*2};
    }

    & .path {
        stroke: var(--intent-secondary);
    }

    & .progress {
        stroke: var(--intent-action);
        stroke-dashoffset: ${({progressVisible:e,radius:t})=>e?0:Math.PI*(t??0)*2};
    }
`,att=T.svg`
    position: absolute;
    inset-block-start: ${({width:e})=>H(-(e??0)/4)};
    inset-inline-start: ${({width:e})=>H(-(e??0)/4)};
    inline-size: ${({width:e})=>H(e)};
    block-size: ${({width:e})=>H(e)};
    fill: transparent;
    opacity: ${({pulseVisible:e})=>e?0:.5};
    transition: opacity 300ms linear;

    circle {
        stroke: var(--intent-action);
        stroke-width: ${({pulseVisible:e,strokeWidth:t})=>H(e?(t??0)*12:1)};
        transition: stroke-width 300ms linear;
    }
`,NF=T.div`
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    inset: 0;
`,itt=T(me)`
    vertical-align: top;
    opacity: ${({iconVisible:e})=>e?1:0};
    transition: opacity 300ms linear;
`,ltt=T(P)`
    inline-size: ${({width:e})=>H((e??0)*.8)};
    opacity: ${({textVisible:e})=>e?1:0};
    transition: opacity 300ms linear;
`,LF={progressVisible:300,iconHidden:600,textVisible:900,pulseVisible:2500,success:2600};class ctt extends h.Component{static defaultProps=tf;constructor(t){super(t),this.state={visible:!1,progressVisible:!1,iconHidden:!1,textVisible:!1,pulseVisible:!1,success:!1},this.updateTimingState=this.updateTimingState.bind(this)}componentDidMount(){this.updateTimingState(0)}updateTimingState(t){Object.keys(LF).forEach(n=>{t*100===LF[n]&&!this.state[n]&&this.setState(o=>({...o,[n]:!0}))}),t*100<3e3&&setTimeout(()=>{this.updateTimingState(t+1)},100),t===0&&this.setState(n=>({...n,visible:!0}))}render(){const{icon:t,iconSize:n=tf.iconSize,message:o,size:r=tf.size,strokeWidth:a=tf.strokeWidth,ariaLiveMessage:i}=this.props,l=100,c=l/2,d=a*(l/r),u=c-d/2;return s.jsx(ntt,{success:this.state.success,children:s.jsxs(ott,{ringVisible:this.state.visible,width:r,height:r,children:[s.jsx(att,{width:r*2,height:r*2,viewBox:`0 0 ${l} ${l}`,radius:u,strokeWidth:d,pulseVisible:this.state.pulseVisible,"data-test":"progress-animation-pulse",children:s.jsx("circle",{r:u/2,cx:c,cy:c,"data-test":"progress-animation-pulse-circle"})}),s.jsxs(rtt,{width:r,height:r,viewBox:`0 0 ${l} ${l}`,radius:u,strokeWidth:d,progressVisible:this.state.progressVisible,"data-test":"progress-animation-ring",children:[s.jsx("circle",{className:"path",r:u,cx:c,cy:c,"data-test":"progress-animation-ring-circle"}),s.jsx("circle",{className:"progress",r:u,cx:c,cy:c,"data-test":"progress-animation-ring-circle"})]}),s.jsx(NF,{children:s.jsx(itt,{iconVisible:!this.state.iconHidden,name:t,width:n,height:n,"data-test":"progress-animation-icon"})}),s.jsx(NF,{children:s.jsx(ltt,{textVisible:this.state.textVisible,size:"l",bold:!0,"data-test":"progress-animation-text",role:"alert","aria-live":"polite","aria-label":i?`${o} ${i}`:void 0,children:o})})]})})}}const dtt=()=>{const{formatMessage:e}=M();return s.jsx(ctt,{icon:"smart_cart",iconSize:80,message:e("instant.shop.modal.progress.message"),size:216,strokeWidth:8,ariaLiveMessage:e("instant.shop.modal.progress.accessibility.message")})},utt=D("m.la.h"),O8="instant-shop-action-modal-header",ptt=({onClick:e})=>{const{formatMessage:t}=M(),n=E(utt),o={title:t("instant.shop.modal.title"),addToCart:t("instant.shop.modal.add.to.cart"),description:t("instant.shop.modal.description"),boxMessage:t("instant.shop.modal.box.message")},r=T(P)`
        text-align: ${({textAlign:a})=>FS(a)};
    `;return s.jsxs(G.Body,{children:[s.jsx(r,{textAlign:n?"left":"center",className:"salt-m-y--4",children:s.jsx(ne,{as:"h2",id:O8,"data-test":"instant-shop-title",className:"salt-m-b--8",children:o.title})}),s.jsx(r,{size:"l",textAlign:n?"left":"center","data-test":"instant-shop-description",className:"salt-m-r--2",children:o.description}),s.jsx(ve,{condensed:!0,className:"salt-m-t--4 salt-p-x--0",children:s.jsxs(se,{align:"center",wrap:"nowrap",className:"salt-p-y--2 salt-p-x--4",children:[s.jsx(oc,{className:"salt-m-r--4",children:s.jsx(me,{name:"orders_placed",width:24,height:24})}),s.jsx(P,{size:"l","data-test":"instant-shop-box-message",children:o.boxMessage})]})}),s.jsx(b,{intent:"action",fill:!0,onClick:e,"data-test":"instant-shop-add-to-basket",className:"salt-m-t--8",children:o.addToCart})]},"body")},mtt=({showOnlyProgressIndicator:e=!1})=>{const t=F(),n=We(),o=E(RC),r=E(Ue("instantShop")),[a,i]=h.useState(!1),l=E(qs);if(!o||!r)return null;const c=u=>(u&&t(U.analyticsEvent({type:Uc.INSTANT_SHOP_MODAL_DISPLAYED,description:PF.INSTANT_SHOP_MODAL_DISPLAYED,pageEventAttributes:{userAction:"Close"}})),i(!1),t(Z.closeModal())),d=async()=>{i(!0),e||t(U.analyticsEvent({type:Uc.INSTANT_SHOP_MODAL_DISPLAYED,description:PF.INSTANT_SHOP_MODAL_DISPLAYED,pageEventAttributes:{userAction:"Add to cart"}}));const[u]=await Promise.all([t(xP.addInstantShopProductsToBasket(l)),new Promise(m=>{setTimeout(m,3e3)})]);u?.length||z.warning("instant.shop.no.products.added"),c(),n(jt(),{...u?.length&&{state:{addedProducts:u}}})};return s.jsx(G,{isOpen:r,onRequestClose:a?void 0:c,alternativeBackground:!a,onAfterOpen:e?d:void 0,aria:a?void 0:{labelledby:O8},children:a?s.jsx(dtt,{}):s.jsx(ptt,{onClick:d})})},ZC=()=>E(e=>RC(e)),htt=()=>{const e=F();return h.useCallback(()=>e(Z.openModal("instantShop")),[e])},gtt=()=>{const e=We();return h.useCallback(()=>e(Zo()),[e])},Ett=()=>{const e=eo(),t=htt();return h.useCallback(()=>{e({type:Te.INSTANT_SHOP_TROLLEY_CARD_CLICKED}),t()},[e,t])},ftt=()=>{const e=eo(),t=gtt();return h.useCallback(()=>{e({type:Te.START_SHOPPING});const n={event:"event",eventCategory:"Basket",eventAction:"START_SHOPPING",eventLabel:"Not Set"};J.sendEvent({GA:n,WA:null}),t()},[e,t])},ytt=()=>{const e=ZC(),t=eo();h.useEffect(()=>{e&&t({type:Te.EMPTY_TROLLEY_CARD_IMPRESSION,emptyTrolleyCardImpressions:[{CARD_POSITION:0,CARD_TYPE:"instantShopCard"}]})},[t,e])},kF=({flush:e=!1})=>{ytt();const t=ZC(),n=Ett(),o=ftt(),r=ps({breakpoint:"md-up"});return s.jsx("div",{className:"salt-m-t--8 lg:salt-m-t--16",children:s.jsx(Y,{flush:e,fixed:!r,children:s.jsxs(Y.Item,{colStart:{xs:1,sm:1,md:4,lg:5},colSpan:{xs:12,sm:12,md:6,lg:4},children:[s.jsx(ln,{titleIcon:"trolley",title:"basket.empty.message",titleAs:"h2",primaryButton:t?void 0:{text:"basket.empty.button",onClick:o}}),t&&s.jsxs(ve,{condensed:!0,className:"salt-m-t--16",children:[s.jsx(ln,{titleIcon:"smart_cart",title:"instant.shop.empty.trolley.header",titleAs:"h3",description:"instant.shop.empty.trolley.body",primaryButton:{text:"instant.shop.empty.trolley.button",onClick:n}}),s.jsx(mtt,{})]})]})})})},P8="multipleDeliveries",MF="multiple-deliveries-modal-header",jF="smallOrderChargeModal",wF="small-order-charge-modal-header",N8=()=>{const{formatMessage:e}=M(),t=F(),n=ze(),o=E(D("m.la.h")),r=E(m=>qe(m,"small-order-charge-learn-more-faq-url")),a=E(Ue(jF)),i=E(Vo(jF)),[l,...c]=i?.smallOrderChargeThresholds||[];h.useEffect(()=>{a&&t(U.analyticsEvent({type:Te.SMALL_ORDER_CHARGE_MODAL_DISPLAYED,orderId:i?.orderId}))},[a]);const d=()=>{t(U.analyticsEvent({type:Te.SMALL_ORDER_CHARGE_MODAL_CLOSE_BUTTON_CLICKED,orderId:i?.orderId})),t(Z.closeModal())},u=()=>{t(U.analyticsEvent({type:Te.SMALL_ORDER_CHARGE_MODAL_LEARN_MORE_BUTTON_CLICKED,orderId:i?.orderId})),t(Z.closeModal())};return s.jsx(G,{isOpen:a,onRequestClose:d,aria:{labelledby:wF},children:s.jsxs(h.Fragment,{children:[s.jsx(G.Header,{align:o?"left":"center",children:s.jsx(ne,{as:"h1",id:wF,children:e("basket.page.small.order.charge.dialog.header")})}),s.jsxs(G.Body,{children:[l&&s.jsx(P,{className:"salt-m-b--4 salt-d--inline-block","data-test":"small-order-charge",children:e("basket.page.small.order.charge.dialog.info",{threshold:n(l.maximumThresholdExclusive),amount:n(l.smallOrderCharge)})}),c.map(m=>s.jsx(P,{className:"salt-m-b--4 salt-d--inline-block",children:e("basket.page.small.order.charge.dialog.info.threshold",{minimumThreshold:n(m.minimumThreshold),maximumThreshold:n(m.maximumThresholdExclusive),amount:n(m.smallOrderCharge)})},m.smallOrderCharge.amount)),s.jsx(P,{className:"salt-d--inline-block",children:e("basket.page.small.order.charge.dialog.description")})]}),!!r&&s.jsx(G.Footer,{align:o?"left":"center",children:s.jsx(b,{asChild:!0,intent:"secondary",fill:!0,onClick:u,"data-test":"learn-more",children:s.jsx(rt,{intent:"ghost",href:r,target:"_blank",children:s.jsx(b.Text,{children:e("basket.page.small.order.charge.dialog.learn.more")})})})})]})})},RP=e=>{const{formatMessage:t}=M(),n=ze();if(!e?.length)return null;const o=e[e.length-1];if(!o)return null;const r=n(o.smallOrderCharge),a=n(o.maximumThresholdExclusive),i=t("basket.page.checkout.group.small.order.charge",{threshold:a,amount:r}),l=t("basket.page.checkout.group.small.order.charge.multiple.thresholds",{threshold:a});return e.length===1?i:l},L8=({orderId:e,thresholds:t,page:n})=>{const o=F(),r=RP(t);return h.useCallback(()=>{o(Z.openModal("smallOrderChargeModal",{smallOrderChargeThresholds:t,orderId:e})),o(U.analyticsEvent({type:Te.SMALL_ORDER_CHARGE_COMPONENT_CLICKED,orderId:e,chargeInfo:r,pageType:n}))},[o,e,t,r,n])},Itt=({orderId:e})=>{const t=F();return h.useCallback(()=>{t(U.analyticsEvent({type:Te.SMALL_ORDER_CHARGE_SLOT_BOOKED_LEARN_MORE_BUTTON_CLICKED,orderId:e}))},[t,e])},Stt=T.button`
    vertical-align: middle;
`,k8=({thresholds:e=[],orderId:t,page:n})=>{const{formatMessage:o}=M(),r=L8({orderId:t,thresholds:e,page:n});return s.jsxs(h.Fragment,{children:[s.jsx(Stt,{"data-test":"small-order-charge-info-button","aria-label":o("basket.page.checkout.group.small.order.charge.button.accessibility.label"),type:"button",onClick:r,children:s.jsx(me,{verticalAlign:"middle",width:18,height:18,name:"info_default"})}),s.jsx(N8,{})]})},Ctt=T.div`
    -webkit-line-clamp: 2;
    -webkit-box-orient: block-axis;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
`,pd=({isWithIcon:e=!0,isWithButton:t=!1,isWithLink:n=!1,thresholds:o,orderId:r,page:a,className:i})=>{const{formatMessage:l}=M(),c=RP(o),d=E(Dn(["socca","socsb"])),u=E(f=>qe(f,"small-order-charge-learn-more-faq-url")),m=L8({orderId:r,thresholds:o,page:a}),g=Itt({orderId:r});return!d||!c?null:e?s.jsxs(se,{justify:"space-between",gap:["sm"],className:i,wrap:"nowrap","data-test":"small-order-charge-info",children:[s.jsx(Ctt,{children:s.jsx(P,{"data-test":"small-order-charge-summary-info-label",children:c})}),s.jsx(k8,{orderId:r,thresholds:o,page:a})]}):s.jsxs(se,{justify:n?"space-between":"flex-start",gap:["sm"],className:i,children:[s.jsx(se,{align:"center",children:s.jsx(P,{size:"m","data-test":"small-order-charge-banner",children:c})}),t&&s.jsx(b,{"aria-label":l("basket.page.checkout.group.small.order.charge.button.accessibility.label"),"data-test":"small-order-charge-learn-more-button",intent:"tertiary",onClick:m,fill:!1,size:"s",children:s.jsx(b.Text,{children:l("slots.grid.green-van.footer.button")})}),n&&!!u&&s.jsx(se,{align:"flex-start",children:s.jsx(b,{asChild:!0,intent:"tertiary",onClick:g,"data-test":"small-order-charge-learn-more-link",children:s.jsx(rt,{intent:"ghost",href:u,target:"_blank",children:s.jsx(b.Text,{children:l("basket.page.small.order.charge.dialog.learn.more")})})})}),s.jsx(N8,{})]})},M8=(e,t)=>{const n=eo();return h.useCallback(o=>{const r=e?Wn.SUMMARY_COMPONENT_COLLAPSED:Wn.SUMMARY_COMPONENT_EXPANDED;n({type:r,description:e?"User collapsed the summary component":"User expanded the summary component"}),o.preventDefault(),t(!e)},[e,t,n])},JC=e=>{const t=E(D("socca")),n=E(Dn(["sumsub","bt.spl"]));if(!e)return{shouldDisplaySmallOrderCharge:!1,smallOrderChargeThresholds:[]};const o=e.smallOrderChargeThresholds||[],r=Number(e.smallOrder?.amount),a=t&&n&&o.length>0&&!!r;return{smallOrderChargeThresholds:o,shouldDisplaySmallOrderCharge:a}},Yg=({value:e,withTaxNote:t,withSeparator:n=!0,className:o,label:r})=>{const a=ze();return e?s.jsxs(ie.Fragment,{children:[n&&s.jsx(Zn,{}),s.jsxs(pe.Group,{className:o||"salt-p-t--2 salt-m-b--2","data-test":"summary-subtotal",children:[s.jsx(pe.Title,{"data-test":"summary-subtotal-title",children:s.jsxs(P,{bold:!0,className:"salt-d--inline-block",children:[s.jsx(v,{id:r||"summary.subtotal"}),t&&s.jsxs(h.Fragment,{children:[" ",s.jsx(P,{size:"s",className:"salt-d--inline-block","data-test":"summary-subtotal-note",children:s.jsx(v,{id:"order.details.tax.exclusive.price"})})]})]})}),s.jsx(pe.Description,{"data-test":"summary-subtotal-description",nowrap:!0,children:a(e)})]})]}):null},Yp=({unitsName:e="loyalty.units.name",discount:t,allowZero:n,getQuantity:o,loyalty:r})=>{const a=M(),i=ze(),l=E(o??(()=>null)),c=r??l,d=E(Dn(["loyalty","loy.waon"])),u=E(LO),m=d?u:null;if(!c||c.units===void 0)return n?"0":null;if(m==="CURRENCY"||t){const y=t?fi(c.money.amount):c.money.amount,I=i({amount:y,currency:c.money.currency}),S=m==="UNITS"&&e?` ${a.formatMessage(e)}`:"";return`${I}${S}`}const g=e?` ${a.formatMessage(e)}`:"";return`${a.formatNumber(c.units)}${g}`},$u=({unitsName:e,discount:t,allowZero:n,getQuantity:o})=>{const r=Yp({unitsName:e,discount:t,allowZero:n,getQuantity:o});return r?s.jsx(h.Fragment,{children:r}):null},Ttt=({getQuantity:e})=>{const t=M(),n=E(e),o=E(D("loyalty")),r=E(LO),a=o?r:null;if(!n?.units)return null;const i={loyaltyName:t.formatMessage("summary.loyalty.units.name")};return s.jsxs(pe.Group,{"data-test":"summary-loyalty-spent-item",children:[s.jsx(pe.Title,{children:`${i.loyaltyName}${a==="CURRENCY"?"":` (${n.units})`} `}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx(P,{intent:"promotion",bold:!0,children:s.jsx($u,{getQuantity:e,discount:!0})})})]})},_tt={showLoyalty:p.bool,isLoyaltyRedeemEnabled:p.bool.isRequired,getLoyaltySpent:p.func.isRequired},vtt={showLoyalty:!0},eT=e=>{const{isLoyaltyRedeemEnabled:t,showLoyalty:n,getLoyaltySpent:o}=e;return t&&n?s.jsx(Ttt,{"data-test":"summary-loyalty-spent-item",getQuantity:o}):null};eT.propTypes=_tt;eT.defaultProps=vtt;const Att=e=>{const{withTaxNote:t,getLoyaltySpent:n,finalPrice:o}=e;return s.jsxs(pe,{"data-test":"summary-waon-points",children:[s.jsx(Yg,{value:o,withTaxNote:t}),s.jsx(eT,{isLoyaltyRedeemEnabled:!0,getLoyaltySpent:n})]})},btt=({savings:e})=>{const t=ze(),n=F(),o=E(At);return h.useEffect(()=>{e&&Number(e?.amount)&&o?n(U.analyticsEvent({type:Wn.SAVINGS_WITH_PAYMENT_METHOD,attributes:{SAVINGS_WITH_PAYMENT_METHOD_AMOUNT:e.amount,SAVINGS_WITH_PAYMENT_METHOD_CURRENCY:e.currency,SAVINGS_WITH_PAYMENT_METHOD_ORDER_ID:o}})):o||Me.api.pushError(new Error("SAVINGS_WITH_PAYMENT_METHOD_ORDER_ID ERROR "),{context:{orderId:JSON.stringify(o)}})},[e,n,o]),!e||!Number(e?.amount)?null:s.jsxs(pe.Group,{"data-test":"summary-savings-with-payment-method",children:[s.jsx(pe.Title,{children:s.jsx(v,{id:"payment.promotion.savings.summary.line"})}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx(P,{intent:"promotion",bold:!0,"data-test":"summary-savings-with-payment-method-amount",children:t({...e,amount:fi(e.amount)})})})]})},xtt={loading:p.bool,children:p.node},Rtt={loading:!1,children:null},DP=({loading:e,children:t})=>s.jsx("div",{children:e?s.jsx(b,{className:"salt-m-y--4",intent:"action",fill:!0,loading:e}):t});DP.propTypes=xtt;DP.defaultProps=Rtt;const Dtt=({isDeliveryPromotion:e})=>{const t=F(),n=h.useCallback(()=>{t(U.analyticsEvent({type:Wn.DELIVERY_PASS_COMPONENT_CLICKED}))},[t]);return h.useEffect(()=>{t(U.analyticsEvent({type:Wn.DELIVERY_PASS_LINK_SHOW_IN_COMPONENT,value:!e}))},[]),{onClickDeliveryPassLink:n}};function FF({isDeliveryPromotion:e}){const{onClickDeliveryPassLink:t}=Dtt({isDeliveryPromotion:e});return s.jsx(Ce,{intent:"warning",className:"salt-m-b--2","data-test":"delivery-pass-link",showIcon:!1,text:s.jsx(v,{id:"summary.delivery.pass.link.text"}),link:s.jsx(Ce.Link,{to:Uo(),onClick:t,children:s.jsx(v,{id:"summary.delivery.pass.link.text.href"})})})}function Ott({wrapper:e,isDeliveryPromotion:t}){return E(D("dp.link"))?e?s.jsx(e,{children:s.jsx(FF,{isDeliveryPromotion:t})}):s.jsx(FF,{isDeliveryPromotion:t}):null}const Ptt={PAYMENT_PROMOTION:"PAYMENT_PROMOTION"},Ntt=T(pe.Title)`
    display: none;
`,Ltt=T(pe.Description)`
    padding: 0;
    inline-size: 100%;
    font-weight: normal;
    text-align: start;
`,ktt=({delivery:e=null,withTaxNote:t=!1,signDisplay:n="auto"})=>{const o=ze();return!e||!Number(e?.amount)?null:s.jsxs(pe.Group,{"data-test":"summary-delivery",children:[s.jsxs(pe.Title,{"data-test":"summary-delivery-title",children:[s.jsx(v,{id:"summary.delivery"}),t&&s.jsxs(h.Fragment,{children:[" ",s.jsx(P,{size:"s",className:"salt-d--inline-block","data-test":"summary-delivery-note",children:s.jsx(v,{id:"order.details.tax.exclusive.price"})})]})]}),s.jsx(pe.Description,{nowrap:!0,"data-test":"summary-cost-delivery-charge",children:o(e,{signDisplay:n})})]})},Mtt=({deliveryPromotions:e=[],hideDeliveryPassInfo:t=!1,isDeliveryPromotion:n=!1,signDisplay:o="auto"})=>{const r=ze(),a=e?.filter(i=>i&&!!Number(i.promoSaving?.amount)&&i.promoType!==Ptt.PAYMENT_PROMOTION);return!a?.length&&!t?s.jsx(Ott,{isDeliveryPromotion:n,wrapper:({children:i})=>s.jsxs(pe.Group,{children:[s.jsx(Ntt,{}),s.jsx(Ltt,{children:i})]})}):a?.map(i=>s.jsxs(pe.Group,{"data-test":"summary-delivery-pass-item",children:[s.jsx(pe.Title,{"data-test":"summary-delivery-pass-description",children:i.promoDescription}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx(P,{intent:"promotion",bold:!0,"data-test":"summary-delivery-pass-amount",children:r({...i.promoSaving,amount:fi(i.promoSaving.amount)},{signDisplay:o})})})]},i.promoId))},jtt=D("m.la.h"),wtt={isOpen:p.bool.isRequired,actions:p.shape({closeModal:p.func.isRequired}).isRequired,modalLeftAlignEnabled:p.bool},Ftt={modalLeftAlignEnabled:!1},OP=({isOpen:e,actions:{closeModal:t},modalLeftAlignEnabled:n})=>{const o="bag-charge-modal-header";return s.jsx(G,{isOpen:e,onRequestClose:t,aria:{labelledby:o},children:s.jsxs(h.Fragment,{children:[s.jsx(G.Header,{align:n?"left":"center",children:s.jsx(ne,{as:"h2",id:o,children:s.jsx(v,{id:"summary.bag.charge.alt"})})}),s.jsx(G.Body,{children:s.jsx("div",{className:"salt-m-t--2 salt-m-b--4",children:s.jsx(v,{id:"summary.bag.charge.alt.info"})})})]})})};OP.propTypes=wtt;OP.defaultProps=Ftt;const Btt=e=>({isOpen:Ue("bagChargeInfo")(e),modalLeftAlignEnabled:jtt(e)}),Utt=ot({closeModal:Z.closeModal}),Gtt=Ct(ke(Btt,Utt))(OP),$tt=T.button`
    vertical-align: middle;
`,Htt=({withTaxNote:e=!1,signDisplay:t="auto",carrierBag:n=null})=>{const o=F(),r=M(),[a,i]=fe(["ebc","ebcm"]),l=ze(),c=h.useMemo(()=>a?"summary.bag.charge.alt":"summary.bag.charge",[a]),d=()=>{o(Z.openModal("bagChargeInfo"))};return!Number(n?.amount)||!n?null:s.jsxs(pe.Group,{"data-test":"summary-bag-charge-item",children:[s.jsx(Gtt,{}),s.jsx(pe.Title,{"data-test":"summary-bag-title",children:s.jsxs("div",{children:[s.jsx(v,{id:c,"data-test":"summary-bag-label"}),e&&s.jsxs(h.Fragment,{children:[" ",s.jsx(P,{size:"s",className:"salt-d--inline-block","data-test":"summary-bag-charge-note",children:s.jsx(v,{id:"order.details.tax.exclusive.price"})})]}),i&&s.jsxs(h.Fragment,{children:[" ",s.jsx($tt,{"aria-label":r.formatMessage("summary.bag.charge.alt.info"),type:"button","data-test":"summary-bag-icon",onClick:d,children:s.jsx(me,{verticalAlign:"middle",width:18,height:18,name:"info_default"})})]})]})}),s.jsx(pe.Description,{nowrap:!0,"data-test":"summary-bag-charge-amount",children:l(n,{signDisplay:t})})]})},Ye=p.shape({currency:p.string.isRequired,amount:p.string.isRequired}),Vtt=p.shape({quantity:p.number,price:Ye}),Ytt={bags:Vtt,signDisplay:p.string},Wtt={bags:null,signDisplay:"auto"},PP=e=>{const t=ze(),{bags:n,signDisplay:o}=e;if(!n)return null;const r=fi(n.price.amount),a=n.price?n.price.currency:"";return s.jsxs(pe.Group,{"data-test":"summary-bags-buybacks-item",children:[s.jsx(pe.Title,{"data-test":"summary-bags-buybacks-title",children:s.jsx(v,{id:"checkout.summary.place.order.summary.buybacks.bags.label"})}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx(P,{intent:"promotion",bold:!0,"data-test":"summary-bags-buybacks-amount",children:t({amount:r,currency:a},{signDisplay:o})})})]})};PP.propTypes=Ytt;PP.defaultProps=Wtt;const qtt={itemsRetailPrice:Ye,quantity:p.number.isRequired,withTaxNote:p.bool},Ktt={itemsRetailPrice:null,withTaxNote:!1},NP=e=>{const t=ze(),{itemsRetailPrice:n,quantity:o,withTaxNote:r}=e;return s.jsxs(pe.Group,{"data-test":"summary-items",children:[s.jsxs(pe.Title,{"data-test":"summary-items-title",children:[s.jsx("span",{translate:"no",children:o})," ",s.jsx(v,{id:"summary.items"}),r&&s.jsxs(h.Fragment,{children:[" ",s.jsx(P,{size:"s",className:"salt-d--inline-block","data-test":"summary-items-note",children:s.jsx(v,{id:"order.details.tax.exclusive.price"})})]})]}),s.jsx(pe.Description,{nowrap:!0,"data-test":"summary-items-description",children:n?.amount&&n?.currency?t(n):"?"})]})};NP.propTypes=qtt;NP.defaultProps=Ktt;const ztt={savings:Ye},Qtt={savings:null},LP=({savings:e})=>{const t=ze();return Number(e?.amount)?s.jsxs(pe.Group,{"data-test":"summary-savings",children:[s.jsx(pe.Title,{children:s.jsx(v,{id:"summary.savings"})}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx(P,{intent:"promotion",bold:!0,"data-test":"summary-savings-amount",children:t({...e,amount:fi(e.amount)})})})]}):null};LP.propTypes=ztt;LP.defaultProps=Qtt;const sf="summary-total",Xtt={loading:p.bool,totalPrice:Ye,withTaxNote:p.bool,title:p.string,note:p.string},Ztt={loading:!1,totalPrice:null,withTaxNote:!1,title:null,note:null},kP=e=>{const t=ze(),{loading:n,totalPrice:o,withTaxNote:r,title:a}=e;if(n)return s.jsx(Pe.Typography,{variant:"textS"});const i=r?s.jsx(v,{id:"order.details.tax.inclusive.price"}):e.note;return s.jsxs(ne,{as:"span",className:"salt-d--inline-block","data-test":`${sf}`,children:[s.jsx("span",{"data-test":`${sf}-label`,children:a||s.jsx(v,{id:"summary.total"})})," ",s.jsx("span",{"data-test":`${sf}-amount`,children:o?.amount?t(o):"?"}),i&&s.jsxs(h.Fragment,{children:[" ",s.jsx(P,{size:"s",className:"salt-d--inline-block","data-test":`${sf}-note`,children:i})]})]})};kP.propTypes=Xtt;kP.defaultProps=Ztt;const nf="summary-total",Jtt={loading:p.bool,totalPrice:Ye,withTaxNote:p.bool,title:p.string,note:p.string},est={loading:!1,totalPrice:null,withTaxNote:!1,title:null,note:null},tst=T(pe)`
    overflow: hidden;
`,sst=T(pe.Title)`
    padding-block-end: 0;
`,nst=T(pe.Description)`
    padding-block-end: 0;
`,MP=e=>{const t=ze(),{loading:n,totalPrice:o,withTaxNote:r,title:a}=e;if(n)return s.jsx(Pe.Typography,{variant:"textS"});const i=r?s.jsx(v,{id:"order.details.tax.inclusive.price"}):e.note;return s.jsx(tst,{"data-test":nf,children:s.jsxs(pe.Group,{children:[s.jsx(sst,{children:s.jsx(ne,{as:"span",className:"salt-d--inline-block",children:s.jsxs("strong",{children:[s.jsx("span",{"data-test":`${nf}-label`,children:a||s.jsx(v,{id:"summary.total"})}),i&&s.jsxs(h.Fragment,{children:[" ",s.jsx(P,{size:"s",className:"salt-d--inline-block","data-test":`${nf}-note`,children:i})]})]})})}),s.jsx(nst,{nowrap:!0,children:s.jsx(ne,{as:"span",size:"s",className:"salt-d--inline-block","data-test":`${nf}-amount`,children:o?.amount?t(o):"?"})})]})})};MP.propTypes=Jtt;MP.defaultProps=est;const ost=({amount:e,currency:t})=>{const n=ze();return Number(e)?s.jsxs(pe.Group,{"data-test":"summary-total-charged",children:[s.jsx(pe.Title,{className:"salt-p-t--2 salt-p-b--0",children:s.jsx(v,{id:"summary.difference.already.charged"})}),s.jsx(pe.Description,{className:"salt-p-t--2 salt-p-b--0",nowrap:!0,"data-test":"summary-total-charged-amount",children:n({amount:e,currency:t})})]}):null},rst=({amount:e,currency:t,inline:n})=>{const o=ze();return Number(e)>=0?n?s.jsxs("span",{className:"salt-p-t--2 salt-d--block",children:[s.jsx(v,{id:"summary.difference.to.charge"})," ",s.jsx(P,{bold:!0,"data-test":"summary-total-difference-to-charge-amount",children:o({amount:e,currency:t})})]}):s.jsxs(pe.Group,{"data-test":"summary-total-difference-to-charge",children:[s.jsx(pe.Title,{className:"salt-p-t--2 salt-p-b--0",children:s.jsx(v,{id:"summary.difference.to.charge"})}),s.jsx(pe.Description,{className:"salt-p-t--2 salt-p-b--0",nowrap:!0,"data-test":"summary-total-difference-to-charge-amount",children:o({amount:e,currency:t})})]}):null},ast=({amount:e,currency:t,inline:n})=>{const o=ze();return Number(e)?n?s.jsxs("span",{className:"salt-p-t--2 salt-d--block",children:[s.jsx(v,{id:"summary.difference.to.refund"})," ",s.jsx(P,{bold:!0,"data-test":"summary-total-difference-to-refund-amount",children:o({amount:e,currency:t})})]}):s.jsxs(pe.Group,{"data-test":"summary-total-difference-to-refund",children:[s.jsx(pe.Title,{className:"salt-p-t--2 salt-p-b--0",children:s.jsx(v,{id:"summary.difference.to.refund"})}),s.jsx(pe.Description,{className:"salt-p-t--2 salt-p-b--0",nowrap:!0,"data-test":"summary-total-difference-to-refund-amount",children:o({amount:e,currency:t})})]}):null},jP=({amount:e,currency:t})=>{const n=ze();return Number(e)?s.jsxs(pe.Group,{"data-test":"summary-total-charged",children:[s.jsx(pe.Title,{className:"salt-p-t--2 salt-p-b--0",children:s.jsx(v,{id:"summary.difference.loyalty.already.charged"})}),s.jsx(pe.Description,{className:"salt-p-t--2 salt-p-b--0",nowrap:!0,children:s.jsx(P,{intent:"promotion",bold:!0,"data-test":"summary-total-loyalty-charged-amount",children:n({amount:fi(e),currency:t})})})]}):null},ist=({amount:e,currency:t,inline:n})=>{const o=ze();return Number(e)?n?s.jsxs("span",{className:"salt-p-t--2 salt-d--block",children:[s.jsx(v,{id:"summary.difference.loyalty.to.refund"})," ",s.jsx(P,{bold:!0,"data-test":"summary-total-loyalty-difference-to-refund-amount",children:o({amount:e,currency:t})})]}):s.jsxs(pe.Group,{"data-test":"summary-total-loyalty-difference-to-refund",children:[s.jsx(pe.Title,{className:"salt-p-t--2 salt-p-b--0",children:s.jsx(v,{id:"summary.difference.loyalty.to.refund"})}),s.jsx(pe.Description,{className:"salt-p-t--2 salt-p-b--0",nowrap:!0,"data-test":"summary-total-loyalty-difference-to-refund-amount",children:o({amount:e,currency:t})})]}):null},lst=e=>{const t=M(),{paymentMethodV2:n,emailAddress:o,expiryMonth:r,expiryYear:a,cardType:i,lastFourDigits:l}=e;if(n){if(n===at.PAYPAL&&o)return t.formatMessage("order.online.receipt.payment.accessibility.paypal",{emailAddress:o});if(i&&l&&r&&a)return t.formatMessage("order.online.receipt.payment.accessibility.card",{cardType:i,last4Digits:l,cardExpiryDate:`${r}/${a}`})}},cst=T.span`
    display: block;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
`,dst=({paymentMethod:e,shouldShowOnlinePayment:t})=>{switch(e){case at.CARDS:case at.BLIK:case at.BANK_TRANSFER:case at.GOOGLE_PAY:case at.VISA_MOBILE:case at.CARD_INSTALMENTS:return s.jsx(v,{id:"checkout.complete.payment.method.onlinePayment.title","data-test":"payment-details-online-payment"});case at.APPLE_PAY:return t?s.jsx(v,{id:"checkout.complete.payment.method.onlinePayment.title","data-test":"payment-details-online-payment"}):s.jsx(v,{id:"checkout.complete.payment.method.applepay.title","data-test":"payment-details-applepay"});case at.PAYPAL:return s.jsx(v,{id:"checkout.complete.basket.summary.payment.method.pay.pal","data-test":"payment-details-paypal"});case at.INVOICE:return s.jsx(v,{id:"checkout.complete.basket.summary.payment.method.invoice","data-test":"payment-details-invoice"});case at.CASH_ON_DELIVERY:return s.jsx(v,{id:"checkout.complete.payment.method.payAtDelivery.title","data-test":"payment-details-cash-on-delivery"});case at.L_PAY:return s.jsx(v,{id:"checkout.complete.payment.method.lPay.title","data-test":"payment-details-l-pay"});case at.NAVERPAY:return s.jsx(v,{id:"checkout.complete.payment.method.naverpay.title","data-test":"payment-details-naverpay"});case at.KAKAOPAY:return s.jsx(v,{id:"checkout.complete.payment.method.kakaopay.title","data-test":"payment-details-kakaopay"});default:return null}},ust=({paymentInfo:{paymentMethodV2:e,nonSavedFundingInstrument:t,lastFourDigits:n,expiryMonth:o,expiryYear:r,emailAddress:a},shouldShowOnlinePayment:i})=>t?s.jsx(v,{id:"checkout.complete.basket.summary.payment.method.unsaved"}):n||o&&r?_Ve({lastFourDigits:n,expiryMonth:o,expiryYear:r}):a||(dst({paymentMethod:e,shouldShowOnlinePayment:i})??e),Dh=({paymentInfo:e})=>{const t=Cs("psps-show-online-payment")==="true",n=ust({paymentInfo:e,shouldShowOnlinePayment:t}),o=lst(e),r=!!o;return s.jsxs(h.Fragment,{children:[o&&s.jsx(Ee,{"data-test":"payment-method-text-aria",children:o}),s.jsx(cst,{"data-test":"payment-method-text",...r&&{"aria-hidden":r},children:n})]})},pst=e=>{const{paymentInfo:t}=e;return t?s.jsxs(pe.Group,{children:[s.jsx(pe.Title,{children:s.jsx(v,{id:"checkout.complete.basket.summary.payment.method"})}),s.jsx(pe.Description,{"data-pii":"true","data-test":"payment-details-value",style:{minWidth:"0px"},children:s.jsx(Dh,{paymentInfo:t})})]}):null},mst={paidByCheck:Ye,remainingBalance:Ye,paidByCard:Ye,paidByInvoice:Ye,signDisplay:p.string},hst={paidByCheck:null,remainingBalance:null,paidByCard:null,paidByInvoice:null,signDisplay:"auto"},wP=e=>{const t=ze(),{paidByCard:n,paidByCheck:o,paidByInvoice:r,remainingBalance:a,signDisplay:i}=e,l=d=>d&&d.currency&&d.amount;if(!l(o))return null;const c=(d,u,m)=>l(m)&&s.jsxs(pe.Group,{"data-test":`summary-payment-checks-group-${u}`,children:[s.jsx(pe.Title,{children:s.jsx(v,{id:d})}),s.jsx(pe.Description,{nowrap:!0,"data-test":`payment-checks-split-${u}`,children:t(m,{signDisplay:i})})]},u)||null;return s.jsxs(h.Fragment,{children:[c("summary.payment.split.bonus.check","paid-by-check",o),c("summary.payment.split.rest","remaining-balance",a),c("summary.payment.split.card","card",n),c("summary.payment.split.invoice","invoice",r)]})};wP.propTypes=mst;wP.defaultProps=hst;const gst=e=>{const t=ze(),{title:n,description:o,price:r,isOffer:a}=e;return r?s.jsxs(pe.Group,{"data-test":`summary-payment-split-group-${o}`,children:[s.jsx(pe.Title,{children:s.jsx(v,{id:n})}),s.jsx(pe.Description,{nowrap:!0,"data-test":`payment-split-${o}`,children:a?s.jsx(P,{intent:"promotion",bold:!0,children:t({...r,amount:fi(r.amount)})}):t(r)})]},o):null},Est=e=>{const{subtotalPrice:t,paidByLoyalty:n}=e;return!n||!Number(n.amount)?null:s.jsxs(pe,{"data-test":"summary-payment-split",children:[s.jsx(Yg,{value:t}),s.jsx(gst,{title:"summary.loyalty.units.name",description:"paid-by-loyalty",price:n,isOffer:!0})]})},fst=({displayName:e,taxRate:t,price:n})=>s.jsxs(pe.Group,{children:[s.jsxs(pe.Title,{children:[e," ",s.jsx(O$,{maximumFractionDigits:3,value:Number(t),style:"percent"})]}),s.jsx(pe.Description,{nowrap:!0,children:n})]},e),yst=({finalPrice:e,components:t,withTaxNote:n}={finalPrice:null,components:[],withTaxNote:!1})=>{const o=ze();return t?.length?s.jsxs(h.Fragment,{children:[s.jsx(Zn,{className:"salt-m-b--2"}),s.jsxs(pe,{"data-test":"summary-taxes",children:[s.jsxs(pe.Group,{className:"salt-m-b--2",children:[s.jsx(pe.Title,{children:s.jsxs(P,{bold:!0,className:"salt-d--inline-block","data-test":"summary-subtotal",children:[s.jsx(v,{id:"summary.subtotal"}),n&&s.jsxs(h.Fragment,{children:[" ",s.jsx(P,{size:"s",className:"salt-d--inline-block","data-test":"summary-subtotal-note",children:s.jsx(v,{id:"order.details.tax.exclusive.price"})})]})]})}),s.jsx(pe.Description,{nowrap:!0,"data-test":"summary-subtotal-amount",children:e&&o(e)})]}),t.map(r=>fst({...r,price:o(r.taxAmount)}))]})]}):null};p.bool;const Ist={rebookable:p.bool};p.string;const Sst={rebookable:!1},FP=({rebookable:e})=>e?s.jsx(P,{size:"s",className:"salt-m-t--2",children:s.jsx(v,{id:"order.details.rebook.info"})}):null;FP.propTypes=Ist;FP.defaultProps=Sst;const Cst=({promotion:e})=>{const t=ze(),{saving:n,description:o,promoId:r}=e;return s.jsxs(pe.Group,{"data-test":"summary-order-level-promotion-item",children:[s.jsx(pe.Title,{"data-test":"summary-order-level-promo-title",children:o}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx(P,{intent:"promotion",bold:!0,"data-test":"summary-order-level-promo-amount",children:t({...n,amount:fi(n?.amount)})})})]},r)},Tst=({orderLevelPromotions:e})=>{const t=e?.filter(n=>n?.type==="PROMOTION")||[];return t?.length?s.jsx(h.Fragment,{children:t.map(n=>s.jsx(Cst,{promotion:n},n?.promoId))}):null},_st={preparationCost:Ye,withTaxNote:p.bool,signDisplay:p.string},vst={preparationCost:null,withTaxNote:!1,signDisplay:"auto"},BP=e=>{const t=ze(),{preparationCost:n,withTaxNote:o,signDisplay:r}=e;return Number(n?.amount)?s.jsxs(pe.Group,{"data-test":"summary-preparation-cost",children:[s.jsxs(pe.Title,{"data-test":"summary-preparation-cost-title",children:[s.jsx(v,{id:"summary.preparation"}),o&&s.jsxs(h.Fragment,{children:[" ",s.jsx(P,{size:"s",className:"salt-d--inline-block","data-test":"summary-preparation-note",children:s.jsx(v,{id:"order.details.tax.exclusive.price"})})]})]}),s.jsx(pe.Description,{nowrap:!0,"data-test":"summary-preparation-cost-amount",children:t(n,{signDisplay:r})})]}):null};BP.propTypes=_st;BP.defaultProps=vst;const Ast={invoice:Ye,withTaxNote:p.bool,signDisplay:p.string},bst={invoice:null,withTaxNote:!1,signDisplay:"auto"},UP=e=>{const t=ze(),{invoice:n,withTaxNote:o,signDisplay:r}=e;return Number(n?.amount)?s.jsxs(pe.Group,{"data-test":"summary-invoice",children:[s.jsxs(pe.Title,{"data-test":"summary-invoice-title",children:[s.jsx(v,{id:"summary.invoice"}),o&&s.jsxs(h.Fragment,{children:[" ",s.jsx(P,{size:"s",className:"salt-d--inline-block","data-test":"summary-invoice-note",children:s.jsx(v,{id:"order.details.tax.exclusive.price"})})]})]}),s.jsx(pe.Description,{nowrap:!0,"data-test":"summary-invoice-amount",children:t(n,{signDisplay:r})})]}):null};UP.propTypes=Ast;UP.defaultProps=bst;const xst={depositsPrice:Ye,withTaxNote:p.bool,signDisplay:p.string},Rst={depositsPrice:null,withTaxNote:!1,signDisplay:"auto"},GP=e=>{const t=ze(),{depositsPrice:n,withTaxNote:o,signDisplay:r}=e;return Number(n?.amount)?s.jsxs(pe.Group,{"data-test":"summary-deposit-charge-item",children:[s.jsxs(pe.Title,{"data-test":"summary-deposit-title",children:[s.jsx(v,{id:"summary.deposit.charge"}),o&&s.jsxs(h.Fragment,{children:[" ",s.jsx(P,{size:"s",className:"salt-d--inline-block","data-test":"summary-deposit-charge-note",children:s.jsx(v,{id:"order.details.tax.exclusive.price"})})]})]}),s.jsx(pe.Description,{nowrap:!0,"data-test":"summary-deposit-charge-amount",children:t(n,{signDisplay:r})})]}):null};GP.propTypes=xst;GP.defaultProps=Rst;const Dst=({appliedVouchers:e=[],vouchersSavingsPrice:t})=>{const n=ze(),o=e.length;return!o||!t||!Number(t.amount)?null:s.jsxs(pe.Group,{"data-test":"summary-applied-voucher",children:[s.jsx(pe.Title,{children:s.jsx(v,{id:"summary.voucher.updated.format",values:{count:o}})}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx(P,{intent:"promotion",bold:!0,"data-test":"summary-voucher-amount",children:n({amount:fi(t.amount),currency:t.currency})})})]},"total-vouchers")},Ost={environmentalHandlingPrice:Ye,withTaxNote:p.bool,signDisplay:p.string},Pst={environmentalHandlingPrice:null,withTaxNote:!1,signDisplay:"auto"},$P=e=>{const t=ze(),{environmentalHandlingPrice:n,withTaxNote:o,signDisplay:r}=e;return Number(n?.amount)?s.jsxs(pe.Group,{"data-test":"summary-environmental-handling-charge",children:[s.jsxs(pe.Title,{"data-test":"summary-environmental-handling-charge-title",children:[s.jsx(v,{id:"summary.environmental-handling-charge"}),o&&s.jsxs(h.Fragment,{children:[" ",s.jsx(P,{size:"s",className:"salt-d--inline-block","data-test":"summary-environmental-handling-charge-note",children:s.jsx(v,{id:"order.details.tax.exclusive.price"})})]})]}),s.jsx(pe.Description,{nowrap:!0,"data-test":"summary-environmental-handling-charge-amount",children:t(n,{signDisplay:r})})]}):null};$P.propTypes=Ost;$P.defaultProps=Pst;const Nst=({className:e})=>s.jsx(Zn,{className:`salt-m-b--2 ${e??""}`}),Lst=e=>{const{smallOrderPrice:t,withTaxNote:n=!1,signDisplay:o="auto",thresholds:r=[],withIcon:a,orderId:i,page:l}=e,{formatMessage:c}=M(),d=ze();if(!t||!Number(t.amount))return null;const u=c("summary.charges.small.order.charge"),m=d(t,{signDisplay:o});return s.jsxs(pe.Group,{"data-test":"summary-small-order-charge",children:[s.jsxs(pe.Title,{"data-test":"summary-small-order-charge-title",children:[u,n&&s.jsxs(h.Fragment,{children:[" ",s.jsx(P,{size:"s",className:"salt-d--inline-block","data-test":"summary-small-order-charge-note",children:c("order.details.tax.exclusive.price")})]})," ",a&&s.jsx(k8,{orderId:i,thresholds:r,page:l})]}),s.jsx(pe.Description,{nowrap:!0,"data-test":"summary-small-order-charge-amount",children:m})]})},ae={BagCharge:Htt,Buttons:DP,BuyBacks:PP,Delivery:ktt,DeliveryPromotions:Mtt,Deposit:GP,EnvironmentalHandlingCharge:$P,Items:NP,Loyalty:eT,PaymentChecks:wP,PaymentMethod:pst,PaymentLoyalty:Est,PreparationCost:BP,Invoice:UP,Promotions:Tst,RebookableDisclaimer:FP,Savings:LP,Taxes:yst,TotalInline:kP,TotalSpaceBetween:MP,TotalCharged:ost,TotalDifferenceToCharge:rst,TotalDifferenceToRefund:ast,TotalLoyaltyCharged:jP,TotalLoyaltyDifferenceToRefund:ist,Vouchers:Dst,Subtotal:Yg,Separator:Nst,SmallOrderCharge:Lst,WaonPoints:Att,SavingsWithPaymentMethod:btt},kst=({isExpanded:e,loading:t,taxNoteEnabled:n,totalPrice:o,priceNote:r,totalPriceTitle:a,summaryTitle:i,renderEditOrderDifference:l})=>{const c=h.useMemo(()=>e?s.jsx(ne,{as:"span",children:i}):s.jsx(ae.TotalInline,{loading:t,totalPrice:o,withTaxNote:n,title:a,note:r}),[i,e,t]);return s.jsxs(gs.ControlSection,{children:[s.jsxs("span",{className:"flex flex-column inline-block",children:[c,l&&!e&&l(e)]}),s.jsx(gs.ToggleSwitch,{})]})},Mst=({loading:e,taxNoteEnabled:t,totalPrice:n,priceNote:o,totalPriceTitle:r,isExpanded:a,renderEditOrderDifference:i,children:l})=>s.jsxs(gs.Content,{children:[s.jsx(ie.Fragment,{children:l}),s.jsx(ae.TotalSpaceBetween,{loading:e,totalPrice:n,withTaxNote:t,title:r,note:o}),i&&a&&i(a)]}),jst=({breakpoint:e})=>s.jsxs(cs,{breakpoint:e,children:[s.jsx(Ns,{children:s.jsx(Ns.Skeleton,{})}),s.jsx(ae.Buttons,{loading:!0})]}),wst=({renderButtonsSection:e,loading:t})=>s.jsx(ae.Buttons,{loading:t,children:e()}),Fst=D("tx.nts"),HP=({loading:e,summaryTitle:t,priceNote:n,totalPriceTitle:o,totalPrice:r,basketSummary:a,breakpoint:i,loadedViewPortSize:l,reverseToggleBreakpoint:c,name:d,ariaCollapsedLabel:u,ariaExpandedLabel:m,ariaHeader:g,sticky:f=!0,renderButtonsSection:y,renderItemsSection:I,renderItemsBySellerSection:S,renderEditOrderDifference:C,children:_})=>{const[A]=fe(["ord.def.col"]),[x,R]=h.useState(!0),O=E(Fst),N=ze(),k=ps({breakpoint:i});h.useEffect(()=>{k&&A&&R(!1)},[A,k]);const j=M8(x,R),w=E(L=>qe(L,"seller-sales-enabled")==="true");return!a||!l?s.jsx(jst,{breakpoint:i,loadedViewPortSize:l,basketSummary:a}):s.jsxs(gs,{name:d,expanded:x,onToggle:j,breakpoint:i,sticky:f,aria:{expandedLabel:g?`${g}${m}`:m,collapsedLabel:g?`${g}${u}`:u,totalPrice:r&&N(r)},reverseToggleBreakpoint:c,children:[s.jsx(kst,{isExpanded:x,loading:e,taxNoteEnabled:O,totalPrice:r,summaryTitle:t,priceNote:n,totalPriceTitle:o,renderEditOrderDifference:C}),s.jsx(Mst,{loading:e,taxNoteEnabled:O,totalPrice:r,basketSummary:a,priceNote:n,totalPriceTitle:o,isExpanded:x,renderEditOrderDifference:C,children:w?S():I()}),_,s.jsx(wst,{renderButtonsSection:y,loading:e})]})},j8=()=>{const e=F();return()=>{ZVe(),e(f6(JVe()))}},Bst=()=>{const e=E(Ze),t=Ne();return{setAgeConfirmation:j8(),redirectPath:(()=>{if(e)return null;const r=t.search.startsWith("?"),a=`destination=${encodeURIComponent(`${t.pathname}${t.search}${r?"&":"?"}${$s.AGE_CONFIRMATION_COOKIE}=true`)}`;return Fr({queryString:a})})()}},Ust=({onAfterConfirm:e})=>{const{formatMessage:t}=M(),n=F(),o=()=>n(Z.closeModal()),r=j8(),a=E(D("m.la.h")),i=E(Ue("ageConfirmation")),l=()=>{r(),o(),e()},c={header:t("alcohol.age.confirmation.trolley.modal.header"),body:t("alcohol.age.confirmation.trolley.modal.body"),cancel:t("alcohol.age.confirmation.trolley.modal.cancel"),confirm:t("alcohol.age.confirmation.button.label")};return s.jsx(G,{isOpen:i,onRequestClose:o,children:s.jsxs(G.ModalForm,{children:[s.jsx(G.Header,{align:a?"left":"center",children:s.jsx(ne,{as:"h1",children:c.header})}),s.jsx(G.Body,{children:c.body}),s.jsxs(G.Footer,{align:a?"left":"center",className:"salt-gap-x--2",children:[s.jsx(b,{intent:"secondary",onClick:o,fill:!0,children:s.jsx(b.Text,{children:c.cancel})}),s.jsx(b,{intent:"primary",onClick:l,fill:!0,children:s.jsx(b.Text,{children:c.confirm})})]})]})})},w8=({state:e,searchParams:t=new URLSearchParams,shippingGroupType:n="",inCheckoutWalk:o=!1,isContinue:r=!1})=>{const a=pg(e),i=pS(e),l=a1(e);return sr({inCheckoutWalk:o||a,directDeliveryMethod:i?l:void 0,shippingGroupType:n,searchParams:t,isContinue:r})},VP=({searchParams:e=new URLSearchParams,shippingGroupType:t="",inCheckoutWalk:n=!1,isContinue:o=!1}={})=>{const r=lp();return w8({state:r.getState(),shippingGroupType:t,searchParams:e,inCheckoutWalk:n,isContinue:o})},Gst=T(Qe)`
    text-decoration: none;
`,$st=({className:e})=>{const{formatMessage:t}=M(),n=F(),o=VP({isContinue:!0}),r=E(At);h.useEffect(()=>{n(U.analyticsEvent({type:Te.BOOK_SLOT_BUTTON_VIEWED}));const i={event:"view_cart_book_slot"};J.sendEvent({GA:i,WA:null})},[]);const a=()=>{n(U.analyticsEvent({type:Te.BOOK_SLOT_BUTTON_CLICKED,orderId:r}));const i={event:"cart_book_slot",order_id:r||""};J.sendEvent({GA:i,WA:null})};return s.jsx(b,{asChild:!0,className:e,onClick:a,intent:"primary","data-test":"basket-summary-book-slot",fill:!0,children:s.jsx(Gst,{to:o,children:s.jsx(b.Text,{children:t("basket.summary.book-slot")})})})},YP=()=>e=>e(br.getCheckoutWalk()).then(t=>{const{responseData:{entities:n,result:o}={}}=t.payload,{missedPromotions:r}=o||{},a={product:{}},i=o?.pages?.find(l=>l.productGroups[0]?.engine==="FREE_GIFTS");return i&&i.productGroups[0]?.freeGifts?.promotions.forEach(l=>{l.products?.forEach(c=>{a.product={...a.product,[c.productId]:c}})}),n&&e(Ft.setProducts(n)),r?.length&&e(Ao.addMissedPromotions(r)),Object.keys(a.product).length&&e(Ft.setProducts(a)),o||null}),F8=ee("T_AND_C_ACKNOWLEDGE"),Hst="RECURRING_SHOPPING_DEFINITION_FORM_RESET",B8="EDIT_RECURRING_ORDER_OPTION",Vst=()=>({type:"API",payload:{url:"/v4/checkout/terms-and-conditions/acknowledge",service:"web_order_ws",pathPrefix:{client:"/api/order",server:"/core-api"},options:{method:"POST"},...F8}}),Yst=e=>({type:B8,payload:{editOption:e}}),GA={acknowledgeTermsAndConditions:Vst,setEditRecurringOrderOption:Yst,types:{T_AND_C_ACKNOWLEDGE:F8,RECURRING_SHOPPING_DEFINITION_FORM_RESET:Hst,EDIT_RECURRING_ORDER_OPTION:B8}},Wst=(e,t)=>e.map(n=>({...t.find(r=>n.retailerProductId===r.retailerProductId),variant:n.variant,quantity:`${n.quantity}`})),qst=(e,t)=>async(n,o)=>{try{const r=await n(ta.getDecoratedOrder(e)),a=Ho(o());let i;t&&(i=await Yo.fetchAnalyticsMetadataByCheckoutId(t,a));const{payload:{responseData:l}}=r,{order:c,product:d}=l.entities,{orderTotals:u,deliveryType:m,deliveryMethod:g,paymentInfo:f,appliedVouchers:y,charges:I,dates:{deliveryStartDate:S},recurringShoppingDefinition:C,loyalty:_}=c[e];return{analyticsPayload:{orderId:e,product:[...Object.values(d)],orderTotals:u,deliveryType:m,deliveryMethod:g,paymentInfo:f,appliedVouchers:y,charges:I,deliveryStartDate:S,page:"checkout",recurringShoppingDefinition:C,loyalty:_,groupId:null,meta:i},isOrderFetched:!0}}catch{return{isOrderFetched:!1}}},U8=(e,t)=>async n=>{if(!e)return{isOrderFetched:!1};const{orderId:o,checkoutId:r}=t,a=await n(qst(o,r));if(a.isOrderFetched){const{checkout:{price:i,products:l,loyalty:c,type:d,tax:u}}=t;return{analyticsPayload:{...a.analyticsPayload,currencyCode:i.currency,product:Wst(l,a.analyticsPayload.product),loyaltyDelta:c,editedOrder:d==="ORDER_EDIT",tax:u.amount,revenue:i.amount},isOrderFetched:!0}}return{isOrderFetched:!1}},Tn={BOOK_SLOT:"BOOK_SLOT",CHECKOUT_WALK:"CHECKOUT_WALK",EDIT_ORDER:"EDIT_ORDER",BASKET_SPLIT_TRIGGERED:"BASKET_SPLIT_TRIGGERED"},Kst=p.oneOf(Object.values(Tn)),G8=V(Qs,e=>e.fetchError?!1:!!e.data),$8=V(xs,Qs,(e,t)=>t.data?.deliveryMethod===e),H8=(e,t,n)=>{const{query:o}=e.router.location;return o?o[t]===n:!1},V8=e=>H8(e,"in-checkout-walk","true"),Y8=e=>H8(e,"continue","true"),tT=e=>Cd(e)?Tn.EDIT_ORDER:V8(e)?Tn.CHECKOUT_WALK:Tn.BOOK_SLOT,WP=e=>e.router.location?.query?.[vGe],zst=V(WP,e=>e?.match(/\d{4}-\d{2}-\d{2}/)?bGe:AGe),Qst=e=>{const t=tT(e),n=Op(e),o=D("oosa")(e),r=D("sl.cut")(e),a=D("bt.spl")(e),i=t===Tn.CHECKOUT_WALK,l=t===Tn.EDIT_ORDER;return a&&!(o&&r)&&!i&&!l&&n},Wp=V(G8,$8,D("bt.spl"),Op,Cd,Qs,(e,t,n,o,r,a)=>e&&!t&&n&&!o&&!(a.isFetching&&r)),Gd=V(xs,Jl,Ei,(e,t,n)=>e===Et.clickAndCollect.method?t:n),$d=V(Gd,e=>Object.values(e.data).filter(el)),Xst=V(ma,xs,Dp,(e,t,n)=>`${e}:${t}:${n}`),W8=V(ma,Qs,(e,t)=>e&&e===t.data?.deliveryDestinationId&&!t.data?.addressId),q8=V(Gd,W8,(e,t)=>!e.isFetching&&t),K8=V($d,e=>e.length>0),z8=V(Gd,K8,(e,t)=>!!e.lastUpdated&&!t),Q8=V(Gd,z8,(e,t)=>!e.isFetching&&t),qP=V(Qs,Fa,xs,(e,t,n)=>el(e.data)&&t&&e.data?.deliveryDestinationId===t&&e.data?.deliveryMethod===n),Zst=V(ma,Gd,xs,Jl,Ei,(e,t,n,o,r)=>{const a=!Object.values(o.data).length&&!Object.values(r.data).length;return!e||a||!!t.data[e]?!0:!(n==="CUSTOMER_COLLECTION"?r.data:o.data)[e]}),Jst=({wasEdited:e,order:t})=>({event:"event",ecommType:"enhanced",eventCategory:"E-commerce",eventLabel:e?"edited-confirmed-order":"new-confirmed-order",eventAction:"OrderConfirmed",ecommerce:{currencyCode:t.orderTotals?.totalPrice?.currency,purchase:{actionField:{id:t.orderId,editedOrder:e,coupon:t.appliedVouchers.map(n=>n.id).join(", "),shipping:Number(t.charges.delivery.amount)},products:t.products?.length?[t.products[0]]:[]}}}),ent=({order:e,productEntities:t,groupId:n,featuredProductCampaigns:o,hasDeliveryPass:r,meta:a})=>{const{items:i}=e,l=15,c=Math.ceil(i.length/l),d=[];for(let m=0;m<c;m+=1)d.push(i.slice(m*l,(m+1)*l).map(g=>({...g,productEntity:t[g.product]})));const u=m=>m===0;return d.map((m,g)=>eV({data:e,productChunk:m,isFirstChunk:u(g),mapEventItem:JH,index:g,groupId:n,hasDeliveryPass:r,meta:a,featuredProductCampaigns:o}))},tnt=({featuredProductCampaigns:e,payload:t})=>{const{product:n,meta:o}=t,r=15,a=Math.ceil(n.length/r),i=[];for(let c=0;c<a;c+=1)i.push(n.slice(c*r,(c+1)*r));const l=c=>c===0;return i.map((c,d)=>PH(t,c,l(d),OH,d,o,e))},snt=({featuredProductCampaigns:e,payload:t})=>{const{product:n}=t;if(!n.length)return[_y({payload:t,productChunk:[],isFirstChunk:!0,mapProductToItem:Ty,index:0,featuredProductCampaigns:e})];const o=15,r=Math.ceil(n.length/o),a=[];for(let l=0;l<r;l+=1)a.push(n.slice(l*o,(l+1)*o));const i=l=>l===0;return a.map((l,c)=>_y({payload:t,productChunk:l,isFirstChunk:i(c),mapProductToItem:Ty,index:c,featuredProductCampaigns:e}))},BF=({payload:e,productChunk:t,index:n,markLast:o})=>{const{orderId:r,editedOrder:a,revenue:i,tax:l,orderTotals:c,deliveryType:d,paymentInfo:u,appliedVouchers:m,charges:g,loyalty:f,deliveryStartDate:y}=e;let I,S,C;const _=g.delivery.amount,A=m.map(R=>R.id).join(", "),x=c.totalPrice.currency;return n===0?(I=i,S=l,C=f&&f.spent.money.amount):(I="0",S="0",C=f&&"0"),{ecommType:"enhanced",event:"event",eventCategory:"E-commerce",eventLabel:"edited-order",eventAction:"OrderPurchased",ecommerce:{currencyCode:x,purchase:{actionField:{id:r,revenue:Number(I),tax:S,coupon:A,shipping:Number(_)},products:t.map(R=>Ys({...R,quantity:`${R.quantity}`},void 0,void 0))}},..._H(d,C,y,u)}},nnt=({payload:e,shouldMarkLastEvent:t})=>{const{product:n}=e,o=25;if(!n.length)return[BF({payload:e,productChunk:[],index:0,markLast:!0})];const r=Math.ceil(n.length/o),a=[];for(let i=0;i<r;i+=1)a.push(n.slice(i*o,(i+1)*o));return a.map((i,l)=>BF({payload:e,productChunk:i,index:l,markLast:l+1===r&&t}))},ont=ee("CHECKOUT_COMPLETE"),rnt=e=>({type:"API",payload:{service:"pspweb",url:"/v1/checkout/complete",pathPrefix:{client:"/api/pspweb",server:"/core-api"},options:{method:"POST",body:{paramToken:e.parameterToken,payload:{pspName:e.pspName,applePayTokenData:e.applePayTokenData}}},...ont}}),ant={makeCheckoutCompleteRequest:rnt},int=14,lnt=({parameterToken:e,pspSession:{amount:{value:t,currency:n},countryCode:o,supportedNetworks:r,applePayData:{paymentSession:a,capabilities:i},pspName:l},handleSuccess:c,intl:d})=>async u=>{if(!window.ApplePaySession)throw new Error("Apple Pay is not loaded");const m={countryCode:o,currencyCode:n,supportedNetworks:r,merchantCapabilities:i,total:{label:d.formatMessage("payment.applepay.retailer.display.name"),amount:t}},g=new window.ApplePaySession(int,m);g.onvalidatemerchant=()=>g.completeMerchantValidation(JSON.parse(a));const f=window.ApplePaySession.STATUS_SUCCESS,y=window.ApplePaySession.STATUS_FAILURE;g.onpaymentauthorized=async I=>{try{const{payment:S}=I,C=JSON.stringify(S.token.paymentData),_=await u(ant.makeCheckoutCompleteRequest({applePayTokenData:C,pspName:l,parameterToken:e}));g.completePayment({status:f}),await c({resultToken:_?.responseData?.resultToken})}catch(S){throw Me.api.pushError(new Error(`Apple Pay payment checkout complete failed: ${S instanceof Error?S.message:"Unknown error"}`)),g.completePayment({status:y}),S}},g.begin()},X8=D("cow"),cnt=D("cs.tca"),dnt=D("cs.tcd"),unt=D("gtm.opfc"),pnt=D("cs.gosd"),mnt=D("mins"),UF=e=>e&&e.slot,GF=e=>e?.checkout?.basketAboveThreshold??!1,$F=e=>e?.checkout?.canCheckout??!1,hnt="order.cow.time.restriction.on.demand.slots.validation.error",Z8="order.cow.checkout.restriction.validation.error",J8="order.cow.slot.not.deliverable.validation.error",eQ=[hnt,Z8],gnt=e=>({redirectTo:e}),HF=({basket:e=null,state:t})=>{if(!UF(e)&&!GF(e)&&!$F(e))return{canCheckout:!1,redirect:pn({queryString:void 0})};if(!UF(e))return{canCheckout:!1,redirect:w8({state:t,inCheckoutWalk:!0,shippingGroupType:e?.checkout?.shippingGroupType})};const n=Y8(t);return!GF(e)&&!n?{canCheckout:!1,redirect:S0({shippingGroupType:e?.checkout?.shippingGroupType})}:$F(e)?{canCheckout:!0}:{canCheckout:!1,redirect:jt()}},tQ=e=>e(YP()),KP=e=>(t,n)=>e?Promise.resolve(HF({basket:e,state:n()})):t(Ht.getBasket()).then(o=>HF({basket:o,state:n()})),Wg=e=>(t,n)=>t(KP(e)).then(o=>X8(n())&&o.canCheckout?tQ(t).then(()=>o,()=>o):o),Ent=e=>(t,n)=>{const o=Wt(n()),r=e.pathname.startsWith(Zh({basePath:o})),a=e.pathname.startsWith(Zb({basePath:o})),i=l=>!l.canCheckout&&!r&&!a?gnt(l.redirect):null;return t(KP()).then(l=>X8(n())&&l.canCheckout&&!r?tQ(t).then(()=>l,()=>l):l).then(i)},fnt=(e,t)=>{e(U.analyticsEvent({type:_e.RECURRING_ORDER_CREATED,recurringShoppingDefinition:t.recurringShoppingDefinition}))},ynt=(e,t,n,o)=>{nnt({payload:t,shouldMarkLastEvent:n}).forEach(i=>{J.sendEvent({GA:i,WA:null})}),snt({payload:t,featuredProductCampaigns:o}).forEach(i=>{J.sendEvent({GA:i,WA:null})}),e(U.analyticsEvent({type:_e.ORDER_PURCHASED,...t}))},Int=(e,t,n)=>{tnt({payload:t,featuredProductCampaigns:n}).forEach(r=>{J.sendEvent({GA:r,WA:null})}),e(U.analyticsEvent({type:_e.SELECT_PLACE_ORDER,...t}))},Snt=(e,t)=>e(Zh({orderId:`${t.payload.responseData.orderId}`})),VF=(e,t,n,o,r={})=>(a,i)=>a(Dr.orderPaymentCheckout(t)).then(async l=>{const{payload:{responseData:c}}=l,d=!unt(i()),u=pnt(i()),m=c.type==="checkout-result-response",{analyticsPayload:g,isOrderFetched:f}=await a(U8(m,c));try{const S=i().data.basket||{},C=i().data.products||{},_=qs(i());let A;if(!m&&"checkoutId"in c){const x=Ho(i());A=await Yo.fetchAnalyticsMetadataByCheckoutId(c.checkoutId,x)}Int(a,f?{...g}:{orderId:S.orderId,editedOrder:S.basketStatus==="ORDER_EDIT",revenue:S.totals?.totalPrice?.amount||"",tax:S.totals?.taxesTotals?.taxes?.totalAmount?.amount||"",orderTotals:S.totals,deliveryType:S.checkout?.delivery?.deliveryType,paymentInfo:{},appliedVouchers:S.vouchers.map(x=>({id:x.voucherId,saving:x.savings})),charges:{delivery:S.delivery},loyalty:{...S.loyalty,spent:{money:{amount:S.loyalty?.unitsSpent}}},deliveryStartDate:S.checkout?.delivery?.startTime,product:S.items.map(x=>{const R=C.productEntities[x.productId];return{...R,quantity:x.quantity.quantityInBasket,sellerId:R?.seller?.id}}),page:"checkout",currencyCode:S.totals?.totalPrice?.currency,meta:A},_)}catch{Me.api.pushError(new Error("Failed to send SELECT_PLACE_ORDER event"))}if(f){if(d){const S=qs(i()),C=D("co.last")(i());ynt(a,g,C,S)}else if(!d)try{const S=JSON.stringify(g);localStorage.setItem(uh,S),u&&Me.api.pushLog([`ORDER_PURCHASE event sent saved to localstorage. OrderId: ${g?.orderId}.`],{level:Za.DEBUG})}catch{Me.api.pushError(new Error("Could not stringify data for ORDER_PURCHASE event and set it to localstorage: "),{context:{analyticsPayload:JSON.stringify(g)}})}return g?.recurringShoppingDefinition&&fnt(a,g),a(Ht.getBasket()).catch(()=>{}).then(()=>Snt(e,l))}if(u&&Me.api.pushLog(["started payment authentication process (ORDER_PURCHASE event debug)"],{level:Za.DEBUG}),c.type==="payment-session-response")return a(lnt({...c,handleSuccess:n,intl:o}));const{paymentSession:y}=t,{url:I}=l.payload.responseData;return y.initiatePaymentAuthentication({authenticationUrl:I})}).catch(l=>{let c={error:!0};const d=[U.analyticsEvent({type:_e.PLACE_ORDER,status:"FAILURE",error:`FAILED_AFTER_CLICK - ${l.message}`})],u=["order.cow.payment.failure.invoice.not.registered","order.cow.payment.failure.invoice.insufficient.funds"];if(!!l?.statusCode&&l.statusCode>=400&&l.statusCode<=499){const f=l.message&&mS(l.message)?l.message:"exception.checkout.notAllowed";if(u.includes(f))c={...c,errorMessageKey:f,showErrorAsAlert:!0};else if(eQ.includes(f)||f===J8)c={...c,errorMessageKey:f,showErrorAsAlert:!1};else{if(mnt(i())&&f==="basket.below.threshold.error"){const{paymentSession:y}=t;y.cancelPayment(),e(S0({shippingGroupType:i().data.basket.checkout.shippingGroupType,showErrorIfShippingGroupDoesntExist:!0}))}z.error({key:f,substitutions:{...r}})}}else z.error("toast.notification.generic.error");const{paymentSession:g}=t;return g.cancelPayment(),d.forEach(f=>a(f)),c}),Cnt=(e,t,n,o,r={})=>(a,i)=>cnt(i())||dnt(i())?a(GA.acknowledgeTermsAndConditions()).then(()=>a(VF(e,t,n,o,r))).catch(()=>{Me.api.pushError(new Error("Terms and Conditions: T_AND_C_ACKNOWLEDGE call failed")),z.error("toast.notification.generic.error")}):a(VF(e,t,n,o,r)),sQ=ee("EXTEND_SLOT"),Tnt=e=>({type:"API",payload:{pathPrefix:{client:"/api/ecomslots",server:"/core-api"},service:"ecomslots",url:"/v1/slots/extend",options:{method:"POST",body:{regionId:e}},...sQ}}),_nt={extendSlot:Tnt,types:{EXTEND_SLOT:sQ}},vnt=()=>async(e,t)=>{const n=t(),o=hn(n);await e(_nt.extendSlot(o))},nQ={extendSlot:vnt},Ant=e=>{let t=5;const n=o=>{e()||t===0?o():(t-=1,setTimeout(()=>n(o),300))};return new Promise(n)},oQ=e=>{const t=We(),n=ul(),o=E(D("csf")),[r,a]=h.useState(!1),i=E(At),l=F(),c=bnt(),d=xnt(),u=Rnt(),m=Dnt(),g=mP(),f=E(tx),y=E(Ho);return{onConfirmCheckout:h.useCallback(async S=>{let C=e;l(U.analyticsEvent({type:Te.CHECKOUT_ORDER_BUTTON_CLICKED,orderId:i,minSpendReached:C?.checkout?.basketAboveThreshold||!1}));const _={event:"cart_checkout",order_id:i};if(J.sendEvent({GA:_,WA:null}),!C){const A=await m();if(A===null){a(!1);return}if(A?.length>1){a(!1),t(jt());return}const[x]=A;C=x}if(!C){a(!1);return}if(C?.checkout?.minimumCheckoutThreshold&&!C?.checkout?.basketAboveThreshold){g({basketSummary:C,type:"warning"});return}if(!c()){l(ks({name:GTe,event:S})),a(!0),o&&await Ant(()=>!Zz(f));try{if(!await u({shippingGroupType:C?.checkout?.shippingGroupType})){a(!1);return}const{canCheckout:x,redirect:R}=await d(C);if(x){C?.slot&&l(nQ.extendSlot()),l(U.analyticsEvent({type:Kn.CHECKOUT_WALK})),t(kr());return}if(R?.includes(mi())){const O=await Yo.fetchAnalyticsMetadataByActiveCart(y);l(U.analyticsEvent({type:_e.BEGIN_CHECKOUT,meta:O})),n(O)}a(!1),t(R)}catch{a(!1)}}},[e,l,i,c,o,m,t,g,f,u,d]),isCheckoutLoading:r}},bnt=()=>{const e=F(),t=E(AC);return h.useCallback(()=>t?.orderId?(e(Z.openModal("failedPayment")),!0):!1,[e,t])},xnt=()=>{const e=F();return h.useCallback(async t=>{const{canCheckout:n,redirect:o}=await e(Wg(t));return{canCheckout:n,redirect:o}},[e])},Rnt=()=>{const e=F(),t=E(Ze);return h.useCallback(async({shippingGroupType:o})=>{if(o&&t)try{await e(Df.basketCheckoutStart(o))}catch{return z.error("toast.notification.generic.error"),Promise.resolve(!1)}return Promise.resolve(!0)},[e,t])},Dnt=()=>{const e=F(),{pathname:t}=Ne();return h.useCallback(async()=>{if(t===jt())return[];try{return(await e(Ht.getBasket({cartType:Wr.CART_VIEW,productGroupingType:rA.NULL})))?.checkoutGroups?.filter(P0)||[]}catch{return z.error("toast.notification.generic.error"),null}},[e,t])},Ont=()=>{const e=F(),t=E(Zt);h.useEffect(()=>{!t.lastUpdated&&!t.isFetching&&e(Ht.getBasket())},[t.lastUpdated,t.isFetching,e])},Pnt=e=>{const t=E(D("bsbm")),n=E(D("bt.spl")),o=E(nx),r=E(Cn);return t&&!n&&(e?!e?.slot&&!e?.checkout?.basketAboveThreshold:!r&&!o)},ep=({name:e,basketSummary:t,className:n})=>{const o=t?.checkout?.shippingGroupType,{isCheckoutLoading:r,onConfirmCheckout:a}=oQ(t),i=X6(),l=Pnt(t),c=F(),d=()=>c(Z.openModal("ageConfirmation")),u=E(nx),m=oo(u);return Ont(),h.useEffect(()=>{m!==void 0&&m!==u&&c(U.analyticsEvent({type:Te.CHECKOUT_ORDER_BUTTON_VIEWED,minSpendReached:u}))},[c,u,m]),h.useEffect(()=>{if(!l){c(U.analyticsEvent({type:Te.CHECKOUT_ORDER_BUTTON_VIEWED,minSpendReached:t?.checkout?.basketAboveThreshold??!1}));const g={event:"view_cart_checkout"};J.sendEvent({GA:g,WA:null})}},[l]),l?s.jsx($st,{className:n}):s.jsxs(h.Fragment,{children:[s.jsx(b,{intent:"action",fill:!0,onClick:i?d:a,"data-synthetics":"start-checkout-button","data-test":`basket-checkout-button${o?`-${ri(o)}`:""}`,loading:r,className:n,children:s.jsx(b.Text,{children:e||s.jsx(v,{id:"basket.summary.checkout"})})}),i&&s.jsx(Ust,{onAfterConfirm:a})]})},rQ=e=>{const t=E(D("loy.waon")),n=E(Dn(["sumsub","bt.spl"])),{formatMessage:o}=M(),r=o("summary.title"),a=o(n?"summary.subtotal":"summary.total"),i=o(n?"summary.subtotal.price.note":"summary.total.note"),l=o("summary.component.accessibility.toggle.switch.on.label"),c=o("summary.component.accessibility.toggle.switch.off.label"),d=t?e?.totals?.paymentSplit?.remainingPayment:e?.totals?.display?.finalPrice;return{totalPrice:n?e?.totals?.display?.itemPriceAfterPromos:d,totalPriceTitle:a,summaryTitle:r,priceNote:i,ariaExpandedLabel:l,ariaCollapsedLabel:c}},aQ=Dn(["sumsub","bt.spl"]),sT=D("tx.nts"),zP=D("loy.waon"),nT=D("prp"),oT=D("sib"),iQ=D("pay.check.use"),Nnt=D("cs.ps"),lQ=vo(["loyalty","loyred"]),Lnt=D("loyear.csm"),cQ=D("oed"),QP=({basketSummary:e,taxNoteEnabled:t,getLoyaltySpent:n,page:o})=>{const r=E(Nnt)?"always":"auto",a=E(lQ),l=!E(c=>qe(c,"seller-sales-enabled")==="true")||!!e?.delivery||!!e?.deliveryPromotions?.length;return s.jsxs(ie.Fragment,{children:[s.jsx(ae.Promotions,{orderLevelPromotions:e.orderLevelPromotions}),s.jsx(ae.Vouchers,{appliedVouchers:e.vouchers,vouchersSavingsPrice:e.totals?.vouchersSavingsPrice}),s.jsx(ae.Delivery,{delivery:e.delivery,withTaxNote:t,signDisplay:r}),l&&s.jsx(ae.DeliveryPromotions,{deliveryPromotions:e?.deliveryPromotions,hideDeliveryPassInfo:!0}),s.jsx(ae.BagCharge,{carrierBag:e.carrierBag,withTaxNote:t,signDisplay:r}),s.jsx(ae.PreparationCost,{preparationCost:e.preparation,withTaxNote:t,signDisplay:r}),s.jsx(ae.Loyalty,{isLoyaltyRedeemEnabled:a,getLoyaltySpent:n}),s.jsx(ae.Deposit,{depositsPrice:e.totals?.depositsPrice,withTaxNote:t,signDisplay:r}),s.jsx(ae.EnvironmentalHandlingCharge,{environmentalHandlingPrice:e.totals?.environmentalHandlingPrice,withTaxNote:t,signDisplay:r}),s.jsx(ae.Invoice,{invoice:e.invoice,withTaxNote:t,signDisplay:r}),s.jsx(ae.SmallOrderCharge,{smallOrderPrice:e.smallOrder,orderId:e.orderId,thresholds:e.smallOrderChargeThresholds,withTaxNote:t,signDisplay:r,page:o,withIcon:!0})]})},XP=({basketSummary:e,taxNoteEnabled:t})=>e.totals?.taxesTotals?s.jsx(ae.Taxes,{"data-test":"summary-taxes",finalPrice:e.totals?.finalPrice,components:e.totals?.taxesTotals?.taxes?.components,withTaxNote:t}):null,knt=T(Ce)`
    text-align: start;
`,YF=({className:e})=>{const{formatMessage:t}=M(),n=E(r=>qe(r,"reference-price-savings-info-banner-url")),o=n!=="";return s.jsx(knt,{intent:"info","data-test":"savings-info",className:e,showIcon:!1,text:t("summary.savings.pricing.info"),link:o?s.jsx(Ce.Link,{isSSRNavigation:!0,target:"_blank",href:n,children:t("summary.savings.learn.more")}):void 0})},Ai=({className:e,isSummarySection:t})=>t?s.jsx(pe.Group,{children:s.jsx(pe.Title,{className:"salt-p-r--0 salt-p-b--0",children:s.jsx(YF,{className:e})})}):s.jsx(YF,{className:e}),dQ=({basketSummary:e,page:t})=>{const n=E(aQ),o=E(sT),r=E(zP),a=E(nT),i=E(oT),l=n?e?.totals?.display?.itemPriceAfterPromos:e?.totals?.display?.finalPrice,c=e?.totals?.paymentSplit?.paidByLoyalty,d=tg(e?.items),u=!!Number(e?.totals?.savingsPrice?.amount);return e?s.jsxs(ie.Fragment,{children:[s.jsxs(pe,{children:[s.jsx(ae.Items,{itemsRetailPrice:e?.totals?.itemsRetailPrice,quantity:d,withTaxNote:o}),s.jsx(ae.Savings,{savings:e?.totals?.savingsPrice}),i&&a&&u&&s.jsx(Ai,{isSummarySection:!0,className:"salt-m-b--2"}),s.jsx(ae.SavingsWithPaymentMethod,{savings:e?.totals?.paymentMethodSavingsPrice}),!n&&s.jsx(QP,{basketSummary:e,taxNoteEnabled:o,getLoyaltySpent:Xi,page:t})]}),s.jsx(XP,{basketSummary:e,taxNoteEnabled:o}),r&&s.jsx(ae.PaymentLoyalty,{subtotalPrice:l,paidByLoyalty:c}),s.jsx(ae.Separator,{})]}):null},Mnt=(e,t)=>e?.find(n=>n.groupName===t),rT=(e,t,n)=>{const o=Mnt(e,t)?.items||[],r=n.filter(a=>o.includes(a.productId));return tg(r)},bi=({className:e,groupName:t})=>{const{formatMessage:n}=M();return s.jsx(P,{"data-test":`seller-name-${ri(t)}`,className:e,bold:!0,children:n("order.seller.group.label",{sellerName:t})})},uQ=({basketSummary:e})=>{const t=E(nT),n=E(oT),o=E(sT);if(!e)return null;const{itemGroups:r=[],totalsGroups:a=[],items:i}=e;return s.jsx("div",{"data-test":"summary-items-by-seller-list",children:a.map(({groupName:l,totals:c})=>{const d=rT(r,l,i),u=!!Number(c?.savingsPrice?.amount);return d?s.jsxs(h.Fragment,{children:[s.jsx(bi,{groupName:l,className:"salt-d--block salt-m-y--2"}),s.jsxs(pe,{"data-test":`summary-items-${ri(l)}`,children:[s.jsx(ae.Items,{itemsRetailPrice:c.itemsRetailPrice,quantity:d,withTaxNote:o}),s.jsx(ae.Savings,{savings:c.savingsPrice}),n&&t&&u&&s.jsx(Ai,{isSummarySection:!0,className:"salt-m-b--2"}),s.jsx(ae.SavingsWithPaymentMethod,{savings:c.paymentMethodSavingsPrice}),a.length>1&&s.jsx(Yg,{value:c.display?.itemPriceAfterPromos,withSeparator:!1,className:"salt-m-t--1 salt-m-b--1"})]}),s.jsx(ae.Separator,{})]},l):null})})},tp=({basketSummary:e,dataTest:t="minimum-order",className:n=""})=>{const{formatMessage:o}=M(),r=ze(),{minimumCheckoutThreshold:a,basketAboveThreshold:i}=e.checkout,l=E(D("mins")),c=E(D("bt.spl"));if(i||!l||!c)return null;const d=r(a);return s.jsx(P,{className:`salt-d--inline-block salt-m-t--2 ${n}`,"data-test":t,children:o("basket.page.checkout.group.minimum.order.text",{amount:d})})},Hd=({getQuantity:e,loyalty:t,allowZero:n=!1})=>{const o=Yp({getQuantity:e,loyalty:t,allowZero:n,unitsName:null});return s.jsxs(ie.Fragment,{children:[s.jsx(me,{name:"loyalty",height:16,width:16,lineHeight:"normal",verticalAlign:"middle","data-test":"loyalty-earnings-card-content-icon",className:"salt-m-r--2"}),s.jsx(v,{id:"checkout.complete.loyalty.earned",values:{loyaltyEarned:o}})]})},Oh=({loyalty:e,className:t=""})=>{const n=E(D("loyalty")),o=E(D("loyear"));return n&&o&&e&&e.units>0?s.jsx("div",{className:`salt-m-t--2 ${t}`,"data-test":"loyalty-earnings-summary",children:s.jsx(Hd,{loyalty:e})}):null},pQ=e=>{const{basketSummary:t,withTaxNote:n=!1,summarySubtotalEnabled:o=!1}=e,r=E(D("oed")),a=E(vo(["loyalty","loyred"])),i=E(D("loy.waon")),l=E(D("prp")),c=E(D("sib")),d=tg(t.items),u=o?t?.totals?.display?.itemPriceAfterPromos:t?.totals?.display?.finalPrice,m=t?.totals?.paymentSplit?.paidByLoyalty,g=!!Number(t?.totals?.savingsPrice?.amount);return s.jsxs(h.Fragment,{children:[s.jsxs(pe,{children:[s.jsx(ae.Items,{itemsRetailPrice:t?.totals?.itemsRetailPrice,quantity:d,withTaxNote:n}),s.jsx(ae.Savings,{savings:t?.totals?.savingsPrice}),c&&l&&g&&s.jsx(Ai,{isSummarySection:!0,className:"salt-m-b--2"}),!o&&s.jsxs(h.Fragment,{children:[s.jsx(ae.SavingsWithPaymentMethod,{savings:t?.totals?.paymentMethodSavingsPrice}),s.jsx(ae.Promotions,{orderLevelPromotions:t.orderLevelPromotions}),s.jsx(ae.Vouchers,{appliedVouchers:t.vouchers,vouchersSavingsPrice:t?.totals?.vouchersSavingsPrice}),s.jsx(ae.Delivery,{delivery:t.delivery,withTaxNote:n}),s.jsx(ae.DeliveryPromotions,{deliveryPromotions:t.deliveryPromotions,hideDeliveryPassInfo:!0}),s.jsx(ae.BagCharge,{carrierBag:t.carrierBag,withTaxNote:n}),s.jsx(ae.PreparationCost,{preparationCost:t.preparation,withTaxNote:n}),s.jsx(ae.Loyalty,{isLoyaltyRedeemEnabled:a,getLoyaltySpent:Xi}),s.jsx(ae.Deposit,{depositsPrice:t?.totals?.depositsPrice,withTaxNote:n}),s.jsx(ae.EnvironmentalHandlingCharge,{environmentalHandlingPrice:t?.totals?.environmentalHandlingPrice,withTaxNote:n}),s.jsx(ae.Invoice,{invoice:t.invoice,withTaxNote:n}),s.jsx(ae.SmallOrderCharge,{smallOrderPrice:t.smallOrder,orderId:t.orderId,thresholds:t.smallOrderChargeThresholds,withTaxNote:n,page:"basket",withIcon:!0})]})]}),t?.totals?.taxesTotals&&s.jsx(ae.Taxes,{"data-test":"summary-taxes",finalPrice:t?.totals?.finalPrice,components:t?.totals?.taxesTotals?.taxes?.components,withTaxNote:n}),i&&!r&&s.jsx(ae.PaymentLoyalty,{subtotalPrice:u,paidByLoyalty:m})]})},ZP=({page:e,product:t,productId:n})=>E(r=>e==="regulars"?n?Ihe(r,n):t:n?sl(r,n):t),Ps={Portrait:"portrait",Landscape:"landscape",Default:"default"},JP=h.createContext(null),qt=()=>{const e=h.useContext(JP);if(e)return e;throw new Error("Fop components must be used within FopDataProvider boundary")},jnt=({page:e,product:t,overrideConfig:n={},children:o,displayLandscapeLayout:r,inViewRef:a,sendFopImpression:i,...l})=>{const[c,d]=h.useState(!1),u=h.useCallback(()=>{d(!0)},[]),{ref:m,inView:g}=wb({triggerOnce:!0,threshold:.5}),f=h.useCallback(x=>{m(x),a&&a(x)},[a]),{currentBreakpoint:y}=h.useContext(Pn),I=typeof r<"u"?r:y==="xs",{fop:S}=wC(),C=h.useMemo(()=>r===!0?Ps.Landscape:r===!1?Ps.Portrait:Ps.Default,[r]),_=h.useMemo(()=>Fb({},S,n),[S,n]),A=h.useMemo(()=>({page:e,config:_,product:t,displayLandscapeLayout:I,ref:f,hasBeenViewed:g,layoutType:C,sendFopImpression:i&&!c,updateHasSentImpression:u,...l}),[e,_,t,I,l,c,i]);return s.jsx(JP.Provider,{value:A,children:o})},aT=zS("configurable-fop:data-provider",s.jsx(Pe,{height:"100%",width:"100%"}))(jnt),wnt=({page:e,product:t,overrideConfig:n={},children:o,displayLandscapeLayout:r,sendFopImpression:a,...i})=>{const l=h.useRef(null),[c,d]=h.useState(!1),u=h.useCallback(()=>{d(!0)},[]),{currentBreakpoint:m}=h.useContext(Pn),g=typeof r<"u"?r:m==="xs",{fop:f}=wC(),y=h.useMemo(()=>r===!0?Ps.Landscape:r===!1?Ps.Portrait:Ps.Default,[r]),I=h.useMemo(()=>Fb({},f,n),[f,n]),S=h.useMemo(()=>({page:e,config:I,product:t,displayLandscapeLayout:g,ref:l,hasBeenViewed:!1,layoutType:y,sendFopImpression:a&&!c,updateHasSentImpression:u,...i}),[e,I,t,g,i,c,a]);return s.jsx(JP.Provider,{value:S,children:o})},Fnt=zS("configurable-fop:old-data-provider",s.jsx(Pe,{height:"100%",width:"100%"}))(wnt),Bnt=T.div.attrs({inert:""})`
    filter: blur(5px);
    pointer-events: none;
    user-select: none;
`,WF=T.div`
    position: relative;

    .blur > * {
        filter: blur(5px);
        pointer-events: none;
        user-select: none;
    }
`,qF=T.div`
    display: flex;
    position: absolute;
    z-index: 3;
    inline-size: 100%;
    block-size: 100%;
`,pc=({children:e,isActive:t,overlay:n,verificationRequired:o})=>{const r=E(J5),[a,i]=fe(["alc.blur","age.vis"]),d=a&&t&&!r||i&&o;if(typeof e=="function"){if(!d)return s.jsx(h.Fragment,{children:e({})});const u={blurClassName:"blur",aria:{"aria-hidden":!0,inert:""}};return s.jsxs(WF,{children:[n&&s.jsx(qF,{children:n}),e(u)]})}return d?s.jsxs(WF,{children:[n&&s.jsx(qF,{children:n}),s.jsx(Bnt,{"aria-hidden":!0,children:e})]}):s.jsx(h.Fragment,{children:e})},mQ=({data:e},t)=>e.products.missedPromotions.find(n=>n.promoId===t),hQ=(e,t,n)=>V(mQ,o=>o?.counters.find(r=>r.productIds.includes(n)))(e,t),Unt=(e,t,n)=>V(hQ,o=>o?.productIds||[])(e,t,n),Gnt=(e,t,n)=>V(hQ,o=>o?.requiredProductQuantity||0)(e,t,n),$nt=(e,t)=>V(zl,n=>n.reduce((o,{quantity:r,productId:a})=>t.includes(a)?o+r.quantityInBasket:o,0))(e),Hnt=(e,t)=>V(hO,n=>n.reduce((o,{quantity:r,productId:a})=>t.includes(a)?o+r.quantityInBasket:o,0))(e),Vnt=(e,t)=>t.reduce((n,o)=>{const a=sl(e,o)?.missingAmount||0;return n+a},0),eN=(e,t,n,o)=>V(mQ,r=>{if(!r)return;const a=r.countBy==="ALL_PRODUCTS"?Unt(e,t,n):[n],i=$nt(e,a),l=Hnt(e,a),c=Vnt(e,a),d=i-c+l;return{basketQuantity:o==="slotbooking"?d:i,requiredQuantity:Gnt(e,t,n)}})(e,t);function Ynt(){const{product:{productId:e,offer:t}}=qt(),n=E(D("fop.mp")),o=E(m=>t?eN(m,t.id,e):void 0,Lu),r=o?.basketQuantity,a=o?.requiredQuantity;if(!n||!r||!a)return null;const i=r%a||a,l=a-i,c=t?.description,d=l===0?"PromotionComplete":"PromotionIncomplete";return{id:t?.id,missedPromotionProductsRequired:a,missedPromotionProductsInBasket:i,missedPromotionText:c,missedPromotionMessageType:d}}const Wnt=e=>({type:zt.GA_IMPRESSION,payload:{...e}}),qnt=e=>({type:zt.GA_BATCH_IMPRESSION,payload:{...e}}),Knt=e=>({type:zt.GA_PRODUCT_CLICK,payload:{...e}}),znt=e=>({type:zt.GA4_PRODUCT_CLICK,payload:{...e}}),sp={makeImpression:Wnt,makeBatchImpression:qnt,productClickGAEvent:Knt,productClickGa4Event:znt},Qnt=e=>({type:zt.FOP_CLICKED,payload:{...e}}),Xnt={fopClickEvent:Qnt},Znt=(e,t)=>{switch(t){case"WEIGHT":return e("fop.price.per.100gram",{price:""});case"CAPACITY":return e("fop.price.per.100ml",{price:""});case"LENGTH":return e("fop.price.per.meter",{price:""});case"EACH":return e("fop.price.per.each",{price:""});case"DOSE":return e("fop.price.per.dose",{price:""});default:return""}},Jnt=(e,t,n)=>{if(e.type===Lt.CLUSTER)return"";if(e.type===Lt.GROUP&&t==="regulars")return n("fop.group.title.suggested");const o=hS.includes(e.type)?"other":e.type;if(e.unitOfMeasureGroup!==void 0){const r=Znt(n,e.unitOfMeasureGroup);return`${n(`fop.group.title.${o}`)} - ${r}`}return n(`fop.group.title.${o}`)},gQ=(e,t,n)=>{const o=e.clusterBreadcrumbs?.at(-1);return o?o.name:(e.type===Lt.GROUP&&t==="regulars"&&n("fop.group.title.suggested"),n(`fop.group.title.${e.type}`))},KF=(e,t,n,o)=>{let r=t.type;const a=gQ(t,n,o),i=t.clusterBreadcrumbs?.at(-1);return i?r=i.id:hS.includes(t.type)&&(r="other"),{categoryId:r,clusterName:a,level:t.clusterBreadcrumbs?t.clusterBreadcrumbs.length:0,productClusterSequence:t.products&&t.products.indexOf(e.productId)}},eot=(e,t)=>{const n=t?[t,...e]:[...e];return n.length>0?n.map(r=>r.name).join(" > "):null},tN=()=>{const e=F(),t=E(_d),n=E(On),o=E(At),r=E(K1),a=ts(),i=Ynt(),{formatMessage:l}=M(),[c]=fe(["cxe.by"]),{product:d,hasBeenViewed:u,group:m,page:g,subPage:f,fopPositionOnPage:y,sendFopImpression:I,rootBreadcrumb:S,pageEventId:C,customAnalyticsData:_,updateHasSentImpression:A}=qt(),x=eot(t,S);return{sendFopProductLinkEvent:()=>{const{name:k,retailerProductId:j,price:w}=d,{current:{amount:L,currency:B}}=w||{current:{amount:"",currency:""}},W=Ws(g,f,m.section),$=Bn(d,m.featuredProductCampaigns);e(sp.productClickGAEvent({productName:k,productId:j,productPrice:L,productPosition:y,currencyCode:B,productListName:W}));const K={eventLabel:j,ecommType:"enhanced",eventCategory:"E-commerce",eventAction:"product_click",event:"productClick",ecommerce:{currencyCode:B,click:{actionField:{list:W},products:[{name:k,id:j,price:L,position:y}]}}};J.sendEvent({GA:K,WA:null}),e(sp.productClickGa4Event({product:d,position:y,page:g,productListName:W}));const Q={event:"select_item",ecommerce:{currency:B,items:[ag({product:d,position:y,productListName:W,page:g,featuredProductCampaign:$})]}};J.sendEvent({GA:Q,WA:null})},sendFopImpressionEvent:()=>{if(u&&I){const k=Bn(d,m.featuredProductCampaigns);a({type:zt.QUEUE_PRODUCT_IMPRESSION,group:m,page:g,productListName:Ws(g,f,m.section),pageEventId:C||vt(),sequence:y,position:y,product:d,rankingScore:g==="search"?r[d.productId]:null,cluster:KF(d,m,g,l),groupType:m.type,orderId:o,pageViewId:n,missedPromotion:i,category:x,customAnalyticsData:_}),J.queueProductImpressionEvent({GA:{group:m,page:g,productListName:Ws(g,f,m.section),pageEventId:C||vt(),sequence:y,position:y,product:d,rankingScore:g==="search"?r[d.productId]:null,cluster:KF(d,m,g,l),groupType:m.type,orderId:o,pageViewId:n,missedPromotion:i,category:x,customAnalyticsData:_,isPersonalised:m&&m.type===Lt.PERSONALIZED,featuredProductCampaign:k},WA:null}),A()}},onFopContainerClick:()=>{const k=d.featuredProductCampaign?.externalAdvertId,j={productId:d.productId,sequence:y,...k?{advertId:k}:{}};e(Xnt.fopClickEvent({description:"User clicked on a FOP",pageEventAttributes:j})),Iy(g,d,m.type)&&e(eH([d],c))}}},iT=(e="")=>`${e}/coupons`,EQ=(e,t,{basePath:n="",queryString:o=""}={})=>{const r=o?`?${o}`:"";return`${iT(n)}/${t}/${e}${r}`},tot=(e,t)=>{const[n,o]=h.useState("");return h.useEffect(()=>{t&&o(t)},[e,t]),{ariaLiveText:n}},Ph=({message:e,productQuantity:t})=>{const n=tot(t,e);return s.jsx(Ee,{"aria-live":"polite","aria-relevant":"text","aria-atomic":"true",role:"status",children:t>0?n.ariaLiveText:""})},sot=({missedPromotionQuantities:e,offer:t,productId:n})=>{const{formatMessage:o}=M(),a=E(y=>uS(y,n))?.quantity?.quantityInBasket;if(!e||!a)return s.jsx(Ph,{message:"Not in use.",productQuantity:0});const{basketQuantity:i,requiredQuantity:l}=e,c=i%l||l,u=l-c===0&&i>0,m=t.description,f=u?a>0?o("fop.added.missed.promotion.complete.text.alternative",{quantity:a,offerMessage:m}):o("fop.not.added.missed.promotion.complete.text.alternative",{offerMessage:m}):a>0?o("fop.added.missed.promotion.not.complete.text.alternative",{quantity:a,offerMessage:m,basketQuantity:i,requiredQuantity:l}):o("fop.not.added.missed.promotion.not.complete.text.alternative",{offerMessage:m,basketQuantity:i,requiredQuantity:l});return s.jsx(Ph,{message:f,productQuantity:a})},zF={DELIVERY:"home_delivery",LOYALTY:"loyalty",OFFER:"promotion",COUPON:"coupons",APPLIED_PROMO:"status_yes",FREE_GIFT:"free_gift",PAYMENT_PROMOTION:"payment_card"},lT=e=>zF[e]||zF.OFFER,fQ=e=>{const t=E(D("fop.cpn")),o=E(Zt)?.limitedPromotionIds,r=E(l=>l.data.basket.items.some(c=>c.productId===e.productId)),a=l=>{const c=l.type==="COUPON",d=!!(c&&e.basketLines?.some(g=>g.appliedPromoIds.includes(l.id))&&r),u=d||!o?.includes(l.id);return{shouldShowPromotion:t&&c?u:!0,shouldShowCoupon:u,isCouponApplied:d,isCoupon:c,isFopCouponsEnabled:t}};return{validatePromotion:a,shouldShowUnavailablePromotion:l=>{if(!l.limitReached||l.type==="FREE_GIFT")return!0;const m=a(l);return m.isCoupon?r?!!m.isCouponApplied:typeof o>"u"?!1:!o.includes(l.id):!1}}},yQ=T(Qe)`
    font-size: inherit;
    color: ${({presentationMode:e,isCoupon:t})=>t?"var(--coupon-style, var(--typography-promotion))":e==="MUTE_STYLE"?"var(--intent-content)":"var(--typography-promotion)"};
    text-decoration: none;

    &:hover {
        text-decoration: underline;
    }
`,IQ=T(P)`
    font-weight: ${({presentationMode:e})=>e==="MUTE_STYLE"?"bold":"normal"};
    color: ${({presentationMode:e,isCoupon:t})=>t?"var(--coupon-style, var(--typography-promotion))":e==="MUTE_STYLE"?"var(--intent-content)":"var(--typography-promotion)"};
    text-decoration: none;
`,Nh=T(P)`
    color: ${({isOffer:e,presentationMode:t})=>t==="MUTE_STYLE"||!e?"var(--intent-content)":"var(--typography-promotion)"};

    ${({isSingleLine:e})=>e&&De`
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: block-axis;
        `}
`,$A=e=>`calc(
            var(--salt-text-${e}-line-height) * var(--salt-text-${e}-font-size)
        )`,SQ=T(me)`
    ${({isCoupon:e,isCouponApplied:t})=>{let n="";return e&&(t?n="var(--intent-success-900)":n="var(--coupon-style, var(--typography-promotion))"),`
            fill: ${n};
        `}}
`,not=({offer:e,isOfferLink:t,url:n,sendAnalytics:o})=>{const{product:r,config:a,displayLandscapeLayout:i}=qt(),{isInCurrentCatalog:l}=r,{formatMessage:c}=M(),{validatePromotion:d}=fQ(r),{isCouponApplied:u,isCoupon:m,isFopCouponsEnabled:g}=d(e),f=lT(u?"APPLIED_PROMO":e.type),y=(A,x)=>{const R=s.jsxs(IQ,{"data-test":"fop-offer-text",presentationMode:e.presentationMode,size:A,intent:e.presentationMode==="MUTE_STYLE"?void 0:"promotion","aria-hidden":!0,isCoupon:g&&m,children:[x&&s.jsx(SQ,{name:f,height:$A(A),width:$A(A),verticalAlign:"bottom","data-test":"fop-offer-icon",success:u,className:"salt-m-r--1",isCoupon:g&&m,isCouponApplied:u}),e.description]});return l&&t?s.jsxs(yQ,{to:n,presentationMode:e.presentationMode,onClick:()=>o(),isCoupon:g&&m,children:[R,s.jsx(Ee,{children:c("fop.standard.promotion.accessibility.text",{offerMessage:e.description})})]}):R},{landscape:{promotion:I},portrait:{promotion:S}}=a,C=!i&&ls(S?.fontSize),_=i&&ls(I?.fontSize);return _?y(_,I?.icon||u):C?y(C,S?.icon||u):null},oot=T(Qe).withConfig({shouldForwardProp:e=>!["numberOfLines","fontSize","presentationMode"].includes(String(e))})`
    display: flex;
    align-items: center;
    block-size: ${({numberOfLines:e,fontSize:t})=>`calc(${e} * var(--salt-text-${t}-line-height) * var(--salt-text-${t}-font-size))`};
    color: ${({presentationMode:e})=>e==="MUTE_STYLE"?"var(--intent-content)":"var(--typography-promotion, var(--intent-promotion))"};
    text-decoration: none;

    &:hover {
        text-decoration: underline;
    }
`,rot=T(P).withConfig({shouldForwardProp:e=>!["numberOfLines","presentationMode"].includes(String(e))})`
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: ${({numberOfLines:e})=>e};
    -webkit-box-orient: block-axis;
    overflow: hidden;
    color: ${({presentationMode:e})=>e==="MUTE_STYLE"?"var(--intent-content)":"var(--typography-promotion, var(--intent-promotion))"};
`,Q_=30,{getPercentageFromFractionString:aot}=ga,iot=Yl`
  from {transform: translateY(100%); opacity: 0;}
  to {transform: translateY(0); opacity: 1}`,lot=Yl`
  from {transform: translateY(0); opacity: 1}
  to {transform: translateY(100%); opacity: 0;}`,cot=T.div`
    border-radius: var(--salt-radius-default);
    background-color: var(--intent-contrast-500);
    inline-size: fit-content;
    block-size: 100%;
    align-items: center;
    overflow: hidden;
    padding: var(--salt-spacing-1);
    gap: var(--salt-spacing-1);
    animation-name: ${({isDisplayed:e})=>e?iot:lot};
    animation-duration: 0.3s;
`,dot=T(cot)`
    ${({fullWidth:e})=>e&&"width: 100%;"}
`,uot=({productId:e,offer:t,isDisplayed:n,onAnimationEnd:o,url:r,sendAnalytics:a,missedPromotionQuantities:i,fullWidth:l=!0})=>{const{formatMessage:c}=M(),d=F(),u=E(At),{config:m,displayLandscapeLayout:g}=qt();h.useEffect(()=>{t&&O()},[i.basketQuantity]);const{basketQuantity:f,requiredQuantity:y}=i,I=f%y||y,S=y-I,C=S===0&&f>0,_=t.description,A=C?"":`${I}/${y}`,R=C?f>0?c("fop.added.missed.promotion.complete.text.alternative",{quantity:f,offerMessage:_}):c("fop.not.added.missed.promotion.complete.text.alternative",{offerMessage:_}):f>0?c("fop.added.missed.promotion.not.complete.text.alternative",{quantity:f,offerMessage:_,basketQuantity:f,requiredQuantity:y}):c("fop.not.added.missed.promotion.not.complete.text.alternative",{offerMessage:_,basketQuantity:f,requiredQuantity:y}),O=()=>{const B={id:t.id,requiredProductQuantity:y,addedProductQuantity:I,toAddProductQuantity:S,missedPromotionText:t.description,missedPromomotionTextAlternative:R,missedPromotionTextType:S===0?"PromotionComplete":"PromotionIncomplete"};d(U.analyticsEvent({type:zt.MESSAGE_ALERT_DISPLAYED,orderId:u,missedPromotion:B,productId:e,missedPromotionType:t.type}))},N=(B=2,W="m")=>s.jsxs(dot,{fullWidth:l,maxHeight:B,className:"salt-d--flex",isDisplayed:n,onAnimationEnd:o,"data-retailer-anchor":"fop-missed-promotion",children:[C?s.jsx(me,{name:"status_yes",height:Q_,width:Q_,fill:"var(--intent-success-900)"}):s.jsx(oc,{colorName:"action",progressValue:aot(A),autoProgress:!1,size:Q_,children:s.jsx(P,{size:"s",bold:!0,children:A})}),s.jsx(oot,{onClick:a,fontSize:W,"aria-label":R,href:r,numberOfLines:B,presentationMode:t.presentationMode,children:s.jsx(rot,{size:W,numberOfLines:B,presentationMode:t.presentationMode,children:_})})]}),{portrait:{promotion:k},landscape:{promotion:j}}=m,w=g?j?.numberOfLines:k?.numberOfLines,L=ls(g?j?.fontSize:k?.fontSize);return w&&L?N(w,L):null},sN=({list:e,fullWidth:t=!0,passedOffer:n})=>{const o=F(),{config:r,product:{offer:a,productId:i,retailerProductId:l,name:c},noOfferLink:d,displayLandscapeLayout:u,fopPositionOnPage:m,page:g,subPage:f,group:{section:y},type:I}=qt(),S=n||a,C=E(K=>S&&eN(K,S.id,i,I)),_=E(D("seo.rdbl")),A=E(D("seo.ra")),x=!!(C&&S?.requiredProductQuantity&&C.basketQuantity>0),[R,O]=h.useState(x);if(h.useEffect(()=>{x&&O(!0)},[x]),!S)return null;const N=()=>{x||O(!1)},k=()=>{o(U.analyticsEvent({type:zt.PROMO_LINK_CLICKED,promotionId:S.id,productId:i})),o(U.analyticsEvent({type:zt.GA_FOP_PROMO_LINK_CLICKED,itemId:l,itemName:c,index:m,promotionId:S.retailerPromotionId,promotionName:S.description,list:e||Ws(g,f,y)}));const K={event:"select_item_promotion",id:l,name:c,index:m,promotion_id:S.retailerPromotionId,promotion_name:S.description,list:e||Ws(g,f,y)};J.sendEvent({GA:K,WA:null})},j=Co(S.description),w=_?j.toLowerCase():void 0,L=A?S.retailerPromotionId:S.id,B=S.type==="COUPON"?EQ(L,j):MC(L,w),W=!d,$=()=>{if(R&&C){const K=s.jsx(uot,{productId:i,offer:S,missedPromotionQuantities:C,isDisplayed:x,onAnimationEnd:N,url:B,sendAnalytics:k,fullWidth:t}),Q=u&&r.landscape.promotion?.numberOfLines&&r.landscape.promotion?.numberOfLines>=2,X=!u&&r.portrait.promotion?.numberOfLines&&r.portrait.promotion?.numberOfLines>=2;if(Q||X)return K}return s.jsx(not,{offer:S,isOfferLink:W,url:B,sendAnalytics:k})};return s.jsxs(h.Fragment,{children:[s.jsx(sot,{missedPromotionQuantities:C,offer:S,productId:i}),$()]})},pot=({paymentPromos:e})=>{const{product:t,config:n,displayLandscapeLayout:o}=qt(),[r]=fe(["seo.rdbl"]),{formatMessage:a}=M();if(e.length===1)return s.jsx(sN,{passedOffer:e.at(0)});const{retailerProductId:i,name:l}=t,c=vi(i,Gp(l,{isSEOReadableURLEnabled:r})),d=lT("PAYMENT_PROMOTION"),u={paymentPromoGroup:a("fop.payment.promotion.group")},m=(S,C)=>{const _=$A(S);return s.jsx(yQ,{to:c,presentationMode:"DEFAULT",children:s.jsxs(IQ,{"data-test":"fop-offer-text",presentationMode:"DEFAULT",size:S,intent:"promotion",children:[C&&s.jsx(SQ,{name:d,height:_,width:_,verticalAlign:"bottom","data-test":"fop-offer-icon",className:"salt-m-r--1"}),u.paymentPromoGroup]})})},{landscape:{promotion:g},portrait:{promotion:f}}=n,y=!o&&ls(f?.fontSize),I=o&&ls(g?.fontSize);return I?m(I,g?.icon):y?m(y,f?.icon):null},mot=e=>e.reduce((t,n)=>(n.type==="PAYMENT_PROMOTION"?t.paymentPromos.push(n):t.promotions.push(n),t),{paymentPromos:[],promotions:[]}),hot=()=>{const{product:e,config:t,displayLandscapeLayout:n}=qt(),o=e.offers||[],{validatePromotion:r,shouldShowUnavailablePromotion:a}=fQ(e),i=n&&t.landscape.promotion?.numberOfPromotions,l=!n&&t.portrait.promotion?.numberOfPromotions,c=i||l||0,{paymentPromos:d,promotions:u}=mot(o),m=d.length&&c>0?c-1:c;return s.jsxs(h.Fragment,{children:[d.length?s.jsx("div",{className:"promotion",children:s.jsx(pot,{paymentPromos:d})}):null,u.filter(g=>r(g).shouldShowPromotion&&a(g)).slice(0,m).map(g=>s.jsx("div",{className:"promotion",children:s.jsx(sN,{passedOffer:g},g.id)},g.id))]})},got=e=>Array(e).fill(1).map((t,n)=>t+n),Eot=5,CZt=60,TZt=1500,_Zt=40,vZt="addReview",AZt={RATING:"rating",NICKNAME:"nickname",HEADLINE:"headline",COMMENTS:"comments",IMAGES:"images"},bZt=5,xZt=.5,fot=({size:e,name:t,isError:n=!1})=>s.jsx(me,{name:t,height:e,width:e,primary:!n,error:n}),yot=({size:e,fillDecimal:t})=>s.jsxs(Iot,{"data-test":"partial-rating",children:[s.jsx(Sot,{fillDecimal:t,children:s.jsx(me,{name:"reviews",height:e,width:e,primary:!0})}),s.jsx(me,{name:"reviews_outline",height:e,width:e,primary:!0})]}),Iot=T.span`
    position: relative;
    display: inline-flex;
`,Sot=T.span`
    position: absolute;
    overflow: hidden;
    inline-size: ${e=>Math.round(e.fillDecimal*100)}%;
`,CQ=({size:e=16,rating:t=0})=>{const o=got(5).map(r=>{const a=r-t;return r>t&&a>0&&a<1?s.jsx(yot,{size:e,fillDecimal:t%1},r):s.jsx(fot,{name:`reviews${r<=t?"":"_outline"}`,size:e},r)});return s.jsx(se,{"data-test":"display-only-rating",wrap:"nowrap",children:o})},Cot=T.div`
    align-items: center;
    border-radius: var(--salt-radius-default);
    display: inline-flex;
    justify-content: center;
    min-block-size: ${H(20)};
    padding-block: calc(var(--salt-spacing-05) - ${H(1)});
    padding-inline: calc(var(--salt-spacing-1) - ${H(1)});
    background-color: var(--intent-contrast);
    color: var(--salt-badge-secondary-light-color);
    font-size: var(--salt-text-s-font-size);
    line-height: var(--salt-text-s-line-height);
`,TQ=({productId:e})=>{const t=E(r=>o5e(r,e)),{formatMessage:n}=M();if(!t)return null;const o=n("reviews.chip.rating.accessibility",{rating:t.overallRating,totalRating:Eot,count:t.count});return s.jsxs(h.Fragment,{children:[s.jsxs(Cot,{"data-test":"rating-badge","aria-hidden":"true",children:[s.jsx(CQ,{rating:Number(t.overallRating)}),"(",t.count>999?"999+":t.count,")"]}),s.jsx(Ee,{children:o})]})},X_=()=>{const{product:e}=qt(),t=e?.icons?.legal?.[0];return t?s.jsx("img",{src:t.src,alt:t.description,height:20,loading:"lazy"}):null},Qc=T(Pe)`
    animation: none;
`,bl=T(Pe.Typography)`
    animation: none;
`,_Q=T(Pe.Button)`
    animation: none;
`,$l=1.4285714286,vQ=De`
    overflow: hidden;
    min-block-size: calc(1em * ${$l});
`,AQ=De`
    ${vQ};
    &:empty {
        display: none;
        block-size: 0;
    }
`,bQ=De`
    ${vQ};
    &:empty {
        display: block;
        block-size: calc(1em * ${$l});
    }
`,Tot=De`
    ${AQ};

    ${oe.smUp`
         ${bQ};
    `}
`,xQ=De`
    --product-card-box-shadow: none;
    --product-card-background-color: var(--intent-contrast);

    background-color: var(--product-card-background-color);
    border-radius: var(--salt-radius-default);
    text-decoration: none;
    position: relative;
    min-inline-size: 0;
`,RQ=De`
    ${xQ};
    display: grid;
    grid-area: product-card;
    grid-template-areas: 'header footer';
    grid-template-columns:
        minmax(${({config:e})=>H(e.landscape.image?.resolution?.width)}, auto)
        1fr;

    ${({config:e})=>cc(e.landscape.productCardContainer?.paddings)}
    ${({config:e})=>D5(e.landscape.productCardContainer?.border)}
    ${({config:e})=>e.landscape.productCardContainer?.boxShadow?`
        border: none;
        box-shadow: var(--product-card-box-shadow);
    `:"box-shadow: none;"};
`,nN=De`
    ${xQ};
    display: flex;
    flex-direction: column;
    flex-grow: 1;

    ${({config:e})=>cc(e.portrait.productCardContainer?.paddings)}
    ${({config:e})=>D5(e.portrait.productCardContainer?.border)}
    ${({config:e})=>e.portrait.productCardContainer?.boxShadow?`
        border: none;
        box-shadow: var(--product-card-box-shadow);
    `:"box-shadow: none;"};
`,_ot=De`
    ${RQ};

    ${oe.smUp`
         ${nN};
    `}
`,DQ=De`
    position: relative;

    ${({config:e})=>cc(e.landscape.headerContainer?.paddings)};

    ${({config:e})=>`
         max-width: ${H(Z6e(e.landscape.image?.resolution,e.landscape.image?.paddings,e.landscape.headerContainer?.paddings))};
   `}
`,OQ=De`
    position: relative;
    ${({config:e})=>cc(e.portrait.headerContainer?.paddings)};
    max-inline-size: 100%;
`,vot=De`
    ${DQ};

    ${oe.smUp`
         ${OQ};
    `}
`,Aot=De`
    z-index: 1;
    position: absolute;
    display: flex;
    flex-direction: column;
    inline-size: 100%;
    gap: var(--salt-spacing-05);

    &:empty {
        display: none;
    }
`,PQ=De`
    display: flex;
    justify-content: center;
    align-items: flex-start;
    position: relative;
`,oN=De`
    ${PQ};
    ${({config:e})=>cc(e.landscape.image?.paddings)};

    > * {
        display: none;
        border-radius: var(--salt-radius-default);
        ${({config:e})=>O5(e.landscape.image?.resolution,!0)};
    }
`,NQ=De`
    ${PQ};
    ${({config:e})=>cc(e.portrait.image?.paddings)};

    > * {
        border-radius: var(--salt-radius-default);
        ${({config:e})=>O5(e.portrait.image?.resolution,!1)};
    }
`,bot=De`
    ${oN};

    ${oe.smUp`
         ${NQ};
    `}
`,LQ=De`
    inset-block-end: var(--salt-spacing-2);
    position: absolute;
    inline-size: calc(100% - var(--salt-spacing-2));
`,kQ=De`
    ${LQ};
`,MQ=De`
    ${LQ};

    inset-block-end: ${H(-10)};
`,xot=De`
    ${kQ};

    ${oe.smUp`
         ${MQ};
    `}
`,jQ=De`
    display: flex;
    flex-direction: column;
    flex-grow: 1;
    gap: var(--salt-spacing-1);
    justify-content: space-between;
    min-inline-size: 0;
    grid-area: footer;
    padding: var(--salt-spacing-2);
    position: relative;
`,wQ=De`
    ${jQ};

    border-inline-start: ${({config:e})=>e.landscape.divider&&"var(--salt-border-1) solid rgba(0, 0, 0, 0.1)"};
    border-end-start-radius: unset;
    border-end-end-radius: inherit;
    border-start-end-radius: inherit;
    background-color: ${({config:e,inCart:t})=>t&&e.landscape.footerContainer?.inBasketBackground?"var(--intent-action-50)":"unset"};

    ${({config:e})=>cc(e.landscape.footerContainer?.paddings)};
`,FQ=De`
    ${jQ};

    background-color: ${({config:e,inCart:t})=>t&&e.portrait.footerContainer?.inBasketBackground?"var(--intent-action-50)":"unset"};
    padding-block-start: ${H(12)};
    border-block-start: ${({config:e})=>e.portrait.divider&&"var(--salt-border-1) solid rgba(0, 0, 0, 0.1)"};
    border-inline-start: unset;
    border-start-end-radius: unset;
    border-end-start-radius: inherit;

    ${({config:e})=>cc(e.portrait.footerContainer?.paddings)};
`,Rot=De`
    ${wQ};

    ${oe.smUp`
         ${FQ};
    `}
`,BQ=De`
    overflow: hidden;
    display: none;
    inline-size: 100%;

    &:focus-within {
        outline: auto -webkit-focus-ring-color;
    }

    a {
        outline: none;
    }
`,UQ=De`
    ${BQ};

    line-height: ${({config:e})=>e.landscape.title&&`var(--salt-text-${ls(e.landscape.title.fontSize)}-line-height)`};
    ${({config:e})=>N5(e.landscape.title?.numberOfLines,ls(e.landscape.title?.fontSize))};

    > * {
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-box-orient: block-axis;

        ${({config:e})=>` -webkit-line-clamp: ${e.landscape.title?.numberOfLines};`};
    }
`,rN=De`
    ${BQ};

    line-height: ${({config:e})=>e.portrait.title&&`var(--salt-text-${ls(e.portrait.title.fontSize)}-line-height)`};
    ${({config:e})=>N5(e.portrait.title?.numberOfLines,ls(e.portrait.title?.fontSize))};

    > * {
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-box-orient: block-axis;

        ${({config:e})=>` -webkit-line-clamp: ${e.portrait.title?.numberOfLines};`};
    }
`,Dot=De`
    ${UQ};

    ${oe.smUp`
         ${rN};
    `}
`,GQ=De`
    overflow: hidden;
    display: flex;
    inline-size: 100%;
    gap: var(--salt-spacing-1);
    flex-direction: column;
`,$Q=De`
    ${GQ};

    &:empty {
        ${({config:e})=>!e.landscape.promotion&&De`
                display: none;
                block-size: 0;
            `}
    }

    line-height: ${({config:e})=>e.landscape.promotion&&`var(--salt-text-${ls(e.landscape.promotion?.fontSize)}-line-height)`};
    ${({config:e})=>tI(e.landscape.promotion?.compress?1:sI(e.landscape.promotion?.numberOfLines,e.landscape.promotion?.numberOfPromotions),ls(e.landscape.promotion?.fontSize),e.landscape.promotion?.numberOfPromotions)};

    .promotion {
        ${({config:e})=>tI(e.landscape.promotion?.compress?1:e.landscape.promotion?.numberOfLines,ls(e.landscape.promotion?.fontSize))};
        > * {
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-box-orient: block-axis;
            overflow: hidden;

            ${({config:e})=>` -webkit-line-clamp: ${e.landscape.promotion?.numberOfLines};`};
        }

        &:only-child > * {
            ${({config:e})=>e.landscape.promotion?.expand?` -webkit-line-clamp: ${sI(e.landscape.promotion?.numberOfLines,e.landscape.promotion?.numberOfPromotions)};`:` -webkit-line-clamp: ${e.landscape.promotion?.numberOfLines}`};
        }

        &:focus-within {
            outline: auto -webkit-focus-ring-color;
        }

        a {
            outline: none;
        }
    }
`,aN=De`
    ${GQ};

    &:empty {
        ${({config:e})=>!e.portrait.promotion&&De`
                display: none;
                block-size: 0;
            `}
    }

    line-height: ${({config:e})=>e.portrait.promotion&&`var(--salt-text-${ls(e.landscape.promotion?.fontSize)}-line-height)`};
    ${({config:e})=>tI(e.portrait.promotion?.compress?1:sI(e.portrait.promotion?.numberOfLines,e.portrait.promotion?.numberOfPromotions),ls(e.portrait.promotion?.fontSize))};

    .promotion {
        ${({config:e})=>tI(e.portrait.promotion?.compress?0:e.portrait.promotion?.numberOfLines,ls(e.portrait.promotion?.fontSize))};
        > * {
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-box-orient: block-axis;
            overflow: hidden;

            ${({config:e})=>` -webkit-line-clamp: ${e.portrait.promotion?.numberOfLines};`};
        }

        &:only-child > * {
            ${({config:e})=>e.portrait.promotion?.expand?`-webkit-line-clamp: ${sI(e.portrait.promotion?.numberOfLines,e.portrait.promotion?.numberOfPromotions)};`:`-webkit-line-clamp: ${e.portrait.promotion?.numberOfLines}`};
        }
    }
`,Oot=De`
    ${$Q};

    ${oe.smUp`
         ${aN};
    `}
`,HQ=De`
    overflow: hidden;
    display: flex;
    gap: var(--salt-spacing-1);
    inline-size: 100%;
    flex: 1 1 fit-content;
`,VQ=De`
    ${HQ};

    align-items: baseline;

    ${({isStacked:e})=>De`
        ${e&&oe.smUp`
                    align-items: stretch;
                `}
    `}
`,YQ=De`
    ${HQ};
`,Pot=De`
    ${VQ};

    ${oe.smUp`
         ${YQ};
    `}
`,Not=De`
    grid-area: controls;
    display: flex;
    gap: var(--salt-spacing-2);
    max-inline-size: 100%;
    flex: 0 1 0%;
    justify-content: flex-end;

    > * {
        flex: 1;
    }

    button {
        outline-offset: var(--salt-spacing-1);
    }
`,WQ=T.div`
    block-size: 100%;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    gap: var(--salt-spacing-2);
    position: relative;

    .outer-header-container {
        ${({layoutType:e})=>e===Ps.Portrait?bQ:e===Ps.Landscape?AQ:Tot}
    }

    .product-card-container {
        ${({layoutType:e})=>e===Ps.Portrait?nN:e===Ps.Landscape?RQ:_ot}
    }

    .header-container {
        ${({layoutType:e})=>e===Ps.Portrait?OQ:e===Ps.Landscape?DQ:vot}
    }

    .top-icons-container {
        ${Aot};
    }

    .image-container {
        ${({layoutType:e})=>e===Ps.Portrait?NQ:e===Ps.Landscape?oN:bot}
    }

    .image-link-concealed {
        position: absolute;
        inset: 0;

        ${({layoutType:e})=>e===Ps.Portrait?"margin: 0 auto;":e===Ps.Landscape?"margin: auto;":"margin: 0 auto;"}
    }

    .attributes-container {
        ${({layoutType:e})=>e===Ps.Portrait?MQ:e===Ps.Landscape?kQ:xot}
    }

    .footer-container {
        ${({layoutType:e})=>e===Ps.Portrait?FQ:e===Ps.Landscape?wQ:Rot}
    }

    .title-container {
        ${({layoutType:e})=>e===Ps.Portrait?rN:e===Ps.Landscape?UQ:Dot}
    }

    .promotion-container {
        ${({layoutType:e})=>e===Ps.Portrait?aN:e===Ps.Landscape?$Q:Oot}
    }

    .price-pack-size-container {
        ${({layoutType:e})=>e===Ps.Portrait?YQ:e===Ps.Landscape?VQ:Pot}
    }

    .controls-container {
        ${Not};
    }

    .position-static {
        position: static;
    }

    .position-relative {
        position: relative;
    }

    .position-absolute {
        position: absolute;
    }

    ${({customStyling:e})=>e};
`,HA=T.div`
    block-size: ${({fontSize:e="m"})=>`calc(
        1 * var(--salt-text-${e}-line-height) *
        var(--salt-text-${e}-font-size)
    )`};
    inline-size: 100%;
    font-size: ${({fontSize:e})=>e&&` var(--salt-text-${e}-font-size)`};
`,Z_=T.div`
    block-size: ${({height:e})=>H(e)};
    inline-size: 100%;
`,Lot=T(bl)`
    block-size: ${({fontSize:e})=>e==="xl"?"var(--salt-display-font-size)":`var(--salt-text-${e}-font-size)`};
`,kot=T(Qc)`
    block-size: calc(var(--salt-text-${({fontSize:e})=>e}-font-size) * ${$l});
`,QF=({deposit:e})=>{const{formatMessage:t}=M(),n=ze(),o={accessibility:t("deposit.description"),text:t("deposit.badge",{price:n(e)})};return s.jsx(Fn,{intent:"secondary",singleLine:!0,text:o.text,accessibilityText:o.accessibility,"data-test":"product-card-deposit-badge"})},XF=({shelfLife:e})=>{const{formatMessage:t}=M(),{quantity:n,unit:o}=e,r={accessibility:n===1?t(`guaranteed.product.life.description.${o.toLowerCase()}.one`):t(`guaranteed.product.life.description.${o.toLowerCase()}.other`,{quantity:n}),text:t(`guaranteed.product.life.badge.${o.toLowerCase()}`,{quantity:n})};return s.jsx(Fn,{intent:"secondary",singleLine:!0,text:r.text,accessibilityText:r.accessibility,"data-test":"product-card-shelf-life-badge"})},Mot=()=>{const{formatMessage:e}=M(),t=e("fop.out.of.stock.button");return s.jsx(Fn,{intent:"tertiary-contrast",text:t,"data-test":"product-card-out-of-stock-badge"})},jot=({date:e})=>{const{formatMessage:t}=M(),n=E(r=>da(r)),o=t("fop.last.bought.date",{date:yt(e,n)});return s.jsx(Fn,{intent:"tertiary-contrast",text:o,accessibilityText:o,"data-test":"product-card-last-bought-badge"})},wot=({attribute:e})=>s.jsxs(h.Fragment,{children:[s.jsx(me,{name:e.icon,height:20,width:20,"data-test":`product-card-lifestyle-${e.icon}`,title:e.label,"aria-hidden":"true"}),s.jsx(Ee,{children:e.label})]}),Fot=T(se)`
    z-index: 1;
    min-block-size: ${H(20)};
    overflow: hidden;
    ${({hideEmpty:e})=>e&&`&:empty {
            display: none;
        }`}
`,ZF=T.div`
    display: grid;
    grid-template-rows: repeat(2, 1fr);
    overflow: hidden;

    /* row is made of height + line height and we need to subtract half the gap between two rows so only one overlaps */
    margin-block-start: calc(-1 * 1em * ${$l} - (var(--salt-spacing-1) / 2));
    ${({displayLandscapeLayout:e})=>!e&&De`
            ${oe.smUp`
                  margin-top: unset
    `}
        `}
    gap: var(--salt-spacing-1);
    z-index: 1;
    inline-size: fit-content;
    max-inline-size: 100%;
`,mu=({children:e,hideEmpty:t})=>s.jsx(Fot,{hideEmpty:t,gap:["xs"],wrap:"nowrap",align:"center",children:e}),Bot=()=>{const{product:{productId:e,attributes:t,favorite:n,guaranteedProductLife:o,depositPrice:r,available:a,ratingSummary:i,icons:l},config:c,displayLandscapeLayout:d}=qt(),u=E(R=>D("rvws")(R));if(!a)return s.jsxs(ZF,{displayLandscapeLayout:d,children:[s.jsx(mu,{hideEmpty:!1}),s.jsx(mu,{children:s.jsx(Mot,{})})]});const g=(()=>{const R=d&&c?.landscape?.bottomAttributes?.ratingBadgeOrBoughtDate;if(!d&&c?.portrait?.bottomAttributes?.ratingBadgeOrBoughtDate||R){if(n&&n.lastBought)return s.jsx(jot,{date:n.lastBought});if(u&&i)return s.jsx(TQ,{productId:e})}return null})(),f=d?c?.landscape?.bottomAttributes?.maxLifestyleIcons:c?.portrait?.bottomAttributes?.maxLifestyleIcons,y=typeof f<"u"&&t?t.slice(0,f):[],I=!!y.length||!!r||!!o||!!l.legal.length,S=y.map((R,O)=>s.jsx(wot,{attribute:R},`${R.label}-${O+1}`)),C=r?s.jsxs(h.Fragment,{children:[s.jsx(X_,{}),s.jsx(QF,{deposit:r})]}):s.jsxs(h.Fragment,{children:[s.jsx(X_,{}),o&&s.jsx(XF,{shelfLife:o}),S]}),_=s.jsxs(h.Fragment,{children:[s.jsx(X_,{}),r&&s.jsx(QF,{deposit:r}),o&&s.jsx(XF,{shelfLife:o}),S]}),A=d?C:_;return c?.landscape.divider||c?.portrait.divider?s.jsxs(se,{gap:["xs"],direction:"column",additionalCss:"overflow: hidden;",children:[s.jsx(mu,{hideEmpty:!0,children:I&&g?A:null}),s.jsx(mu,{hideEmpty:!0,children:g||A})]}):s.jsxs(ZF,{displayLandscapeLayout:d,children:[s.jsx(mu,{children:A}),s.jsx(mu,{children:g})]})},iN=T(P)`
    color: ${({isOffer:e,strikethrough:t})=>e&&!t?"var(--typography-promotion, var(--intent-promotion))":"currentColor"};
    ${({strikethrough:e,isGross:t,fontSize:n})=>e||t?`
        font-size: var(--salt-text-${n||"s"}-font-size);
        font-weight: 400;
    `:`
        font-size: var(--salt-text-${n||"xl"}-font-size);
        font-weight: 700;
    `};
    ${({strikethrough:e})=>e&&"text-decoration: line-through;"};
    ${({whiteSpace:e})=>e&&`white-space: ${e};`};
    line-height: 1;
    white-space: nowrap;
`,Uot=T(ne)`
    line-height: 1;
`,qQ=({isOffer:e=!1,children:t})=>{const{formatMessage:n}=M(),o=Cs("catch-weight-subtext-position"),{product:{size:{catchWeight:r}={catchWeight:void 0}},config:a,displayLandscapeLayout:i}=qt(),l=g=>{if(r){const f=n("fop.catchweight.unit");return o==="pre"?s.jsxs(h.Fragment,{children:[s.jsx(Nh,{"data-test":"fop-catchWeight",isOffer:e,size:g,isSingleLine:!0,children:f}),t]}):s.jsxs(h.Fragment,{children:[t,s.jsx(Nh,{"data-test":"fop-catchWeight",isOffer:e,size:g,isSingleLine:!0,children:f})]})}return t},{portrait:{catchWeightLabel:c},landscape:{catchWeightLabel:d}}=a,u=!i&&ls(c),m=i&&ls(d);return u?l(u):m?l(m):t},Got=({showCatchWeight:e})=>{const{formatMessage:t}=M(),n=ze(),o=E(D("ngp")),{product:{price:r,offer:a},config:i,displayLandscapeLayout:l}=qt();if(!r)return null;const c={currentPrice:n(r.current),currentPriceAccessibility:t("fop.current.price.description")},d=a?.presentationMode!=="MUTE_STYLE"&&!!r.original,u=s.jsx(Ee,{children:c.currentPriceAccessibility}),m=C=>C==="xl"?s.jsx(Uot,{size:"s",intent:d?"promotion":void 0,"data-test":"fop-price",forwardedAs:"span",children:c.currentPrice}):s.jsx(iN,{isOffer:d,"data-test":"fop-price",...C&&{fontSize:C},children:c.currentPrice}),g=C=>!e||o?s.jsxs(h.Fragment,{children:[u,m(C)]}):s.jsxs(h.Fragment,{children:[u,s.jsx(qQ,{isOffer:d,children:m(C)})]}),{portrait:{price:f},landscape:{price:y}}=i,I=!l&&f?.fontSize,S=l&&y?.fontSize;return I?g(I):S?g(S):null},$ot=()=>{const{formatMessage:e}=M(),t=ze(),n=E(D("hop")),{product:{price:o},config:r,displayLandscapeLayout:a}=qt();if(n&&!!o?.reference||!o)return null;const l={originalPrice:o.original&&t(o.original),originalPriceAccessibility:e("fop.original.price.description")},c=!!o.original,d=y=>l.originalPrice?s.jsxs(h.Fragment,{children:[s.jsx(Ee,{children:l.originalPriceAccessibility}),s.jsx(iN,{"data-test":"fop-original-price",isOffer:c,strikethrough:!0,...y&&{fontSize:y},children:l.originalPrice})]}):null,{portrait:{price:u},landscape:{price:m}}=r,g=!a&&ls(u?.strikethrough),f=a&&ls(m?.strikethrough);return g?d(g):f?d(f):null},Hot=()=>{const{formatMessage:e}=M(),t=ze(),{product:{price:n},config:o,displayLandscapeLayout:r}=qt();if(!n||!n.gross)return null;const a={grossPrice:n.gross&&t(n.gross),taxInclusiveMessage:n.gross&&e("fop.tax.inclusive",{grossPrice:t(n.gross)})},i=!!n?.original,l=g=>s.jsx(iN,{"data-test":"fop-gross-price",isOffer:i,isGross:!0,...g&&{fontSize:g},whiteSpace:"nowrap",children:a.taxInclusiveMessage}),{portrait:{grossPrice:c},landscape:{grossPrice:d}}=o,u=!r&&ls(c?.fontSize),m=r&&ls(d?.fontSize);return u?l(u):m?l(m):null},lN=({collapseLine:e})=>{const{product:{taxCodesDisplayNames:t},config:n,displayLandscapeLayout:o}=qt(),{formatMessage:r}=M(),a=n?.landscape.taxCodes,i=n?.portrait.taxCodes,l=o?a:i;if(!l)return null;const c=ls(l.fontSize);if(!t?.length||!c)return e?null:s.jsx(HA,{fontSize:c});const d=t.map(u=>r("product.tax.codes.display.label",{code:u})).join(" ");return s.jsxs(h.Fragment,{children:[s.jsx(P,{size:c,"aria-hidden":!0,children:d}),s.jsx(Ee,{children:r("product.tax.codes.accessibility.text",{codes:t.join(", "),count:t.length})})]})},cN=({showCatchWeight:e=!0,direction:t})=>{const n=E(D("ngp")),{product:{price:o}}=qt();return o?s.jsxs(se,{gap:["xs"],align:"baseline",wrap:"nowrap","data-test":"fop-price-wrapper",direction:t,children:[s.jsx(Got,{showCatchWeight:e}),n?s.jsx(Hot,{}):s.jsx($ot,{}),t==="column"&&s.jsx(lN,{collapseLine:!0})]}):null},Vot=e=>e==="NEW_ARRIVAL"?"fop.reference.price.new.arrivals":e==="FRESH"?"fop.reference.price.fresh":"fop.reference.price.default",Yot=T(P)`
    overflow: hidden;
    font-size: var(--salt-text-${({fontSize:e})=>e}-font-size);
    block-size: ${({fontSize:e})=>`calc(
        1 * var(--salt-text-${e}-line-height) *
        var(--salt-text-${e}-font-size)
    )`};
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: block-axis;
`,dN=()=>{const{formatMessage:e}=M(),t=ze(),{product:{price:n},config:o,displayLandscapeLayout:r}=qt(),a=()=>{if(!n||!n.reference)return null;const{currency:m,amount:g,type:f}=n.reference;return e(Vot(f),{price:t({currency:m,amount:g})})},i=(m="s")=>s.jsx(Yot,{"data-test":"fop-reference-price",fontSize:m,children:a()}),{portrait:{referencePrice:l},landscape:{referencePrice:c}}=o,d=!r&&ls(l?.fontSize),u=r&&ls(c?.fontSize);return d?i(d):u?i(u):null},Wot=T(Nh)`
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
`,JF=()=>{const{formatMessage:e}=M(),t=ze(),n=xq(),{product:{price:o,offer:{presentationMode:r}={presentationMode:void 0}},config:a,displayLandscapeLayout:i}=qt();if(!o)return null;const l=g=>{const f={pricePerUnit:""};if(o.unit){const y=t(o.unit.current);o.unit.pricePerSuffix?f.pricePerUnit=n(y,o.unit.pricePerSuffix):o.unit.label&&(f.pricePerUnit=e(`${o.unit.label}`,{price:y}))}return f.pricePerUnit?s.jsxs(Wot,{isOffer:!!o.original,presentationMode:r,"data-test":"fop-price-per-unit",...g&&{size:g},children:["(",f.pricePerUnit,")"]}):null},{portrait:{unitPrice:c},landscape:{unitPrice:d}}=a,u=!i&&ls(c?.fontSize),m=i&&ls(d?.fontSize);return u?l(u):m?l(m):null},qot=T(P)`
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
`,eB=()=>{const{formatMessage:e}=M(),{product:{size:t},config:n,displayLandscapeLayout:o}=qt(),r=t&&`${t.value}${bq(e,t.uom)}`,a=(u="m")=>s.jsx(qot,{size:u,children:r}),{portrait:{packSize:i},landscape:{packSize:l}}=n,c=!o&&ls(i?.fontSize),d=o&&ls(l?.fontSize);return c?a(c):d?a(d):null},Kot=T.div`
    display: inline-grid;
    gap: var(--salt-spacing-1);
    grid-template-columns: ${({hasCatchWeight:e})=>e?"auto auto 1fr":"auto 1fr"};
    overflow: hidden;
    align-items: baseline;
`,VA=()=>{const{product:{size:e},displayLandscapeLayout:t}=qt();if(t)return s.jsxs(se,{wrap:"nowrap",gap:["xs"],additionalCss:"max-inline-size: 100%;",justify:"flex-start","data-test":"fop-size",align:"baseline",children:[s.jsx(eB,{}),s.jsx(JF,{})]});const n=()=>s.jsx(qQ,{children:s.jsx(eB,{})});return s.jsxs(Kot,{"data-test":"fop-size",hasCatchWeight:!!e?.catchWeight,children:[e&&n(),s.jsx(JF,{})]})},qg=({children:e,tabIndex:t=0,isHyperlink:n=!0,className:o,ariaLabel:r,ariaHidden:a=!1})=>{const i=F(),{sendFopProductLinkEvent:l}=tN(),[c]=fe(["seo.rdbl"]),{product:d,page:u,subPage:m,fopPositionOnPage:g,group:{section:f,featuredProductCampaigns:y}}=qt(),{productId:I,name:S,retailerProductId:C,isInCurrentCatalog:_}=d,A=Bn(d,y),x=vi(C,Gp(S,{isSEOReadableURLEnabled:c})),R=Ws(u,m,f),O=()=>{l(),i(Ja.setActiveBop(I))};return _&&n?s.jsx(Qe,{standalone:!0,to:x,state:{productListName:R,position:g,...A?{campaignName:A.campaignName,campaignId:A.campaignId}:{}},tabIndex:t,className:o,onClick:O,"data-synthetics":"bop-link","data-test":"fop-product-link","aria-hidden":a,"aria-label":r??void 0,children:e}):s.jsx(h.Fragment,{children:e})},KQ=()=>{const{product:{name:e,isInCurrentCatalog:t},config:n,displayLandscapeLayout:o}=qt(),r=d=>s.jsx(qg,{children:s.jsx(P,{size:d,onClick:()=>!t&&z.info("fop.not.in.current.catalog"),"data-test":"fop-title",asChild:!0,children:s.jsx("h3",{children:e})})}),{landscape:{title:a},portrait:{title:i}}=n,l=!o&&ls(i?.fontSize),c=o&&ls(a?.fontSize);return l?r(l):c?r(c):null},Vd=Are.LazyLoadImage,iI={BLURRED_FOP:"BLURRED_FOP",BLURRED_IMAGE:"BLURRED_IMAGE"},zot=T.div`
    position: relative;
    overflow: hidden;
    block-size: 100%;
`,Qot=T.div`
    display: flex;
    position: absolute;
    background-color: var(--intent-secondary);
    border-radius: var(--salt-radius-default);
    inline-size: 100%;
    block-size: 100%;
    align-items: center;
    justify-content: center;
`,lI=(e,t)=>{switch(t){case iI.BLURRED_IMAGE:return s.jsx(Xot,{children:e});case iI.BLURRED_FOP:return s.jsx(pc,{isActive:!0,children:e});default:return e}},Xot=({children:e})=>s.jsxs(zot,{"data-test":"fop-image-overlay",children:[s.jsx(Qot,{children:s.jsx(me,{name:"age_restriction_19",height:40,width:40})}),e]}),tB=T(Vd)`
    block-size: 100%;
    inline-size: 100%;
`,zQ=()=>{const e=E(i=>D("di")(i)),{product:{image:t,restrictedVisibility:n},config:o}=qt();if(!t)return null;if(!e)return lI(s.jsx(tB,{"data-test":"lazy-load-image",threshold:300,alt:t.description,src:t.src,placeholder:s.jsx(Qc,{height:"100%"})}),n);const{portrait:{image:r},landscape:{image:a}}=o;return r?.resolution?.width||a?.resolution?.width?lI(s.jsx(tB,{"data-test":"lazy-load-image",threshold:300,alt:t.description,src:t.src,srcSet:t.fopSrcset,sizes:`(max-width: ${Ke.sm}em) ${a?.resolution?.width}px, ${r?.resolution?.width}px`,placeholder:s.jsx(Qc,{height:"100%"})}),n):null},sB={text:"fop.featured.label",description:"fop.featured.label.description"},Zot={text:"fop.featured.programmatic.label",description:"fop.featured.programmatic.label.description"},Jot=(e,t)=>{if(!t)return sB;switch(e){case"CITRUS_AD":return Zot;case"CONTENTFUL":case"OSP_CMS":default:return sB}},ert=({contentSource:e="CONTENTFUL"})=>{const{formatMessage:t}=M(),[n]=fe(["fp.dl"]),{text:o,description:r}=Jot(e,n);return s.jsx(Fn,{intent:"primary",text:t(o),accessibilityText:t(r),"data-test":"fop-featured"})},trt=({size:e=24})=>{const{formatMessage:t}=M(),n={text:t("fop.favorite.icon.description")};return s.jsxs(h.Fragment,{children:[s.jsx(me,{primary:!0,name:"favourites","data-test":"fop-fav-icon",width:e,height:e}),s.jsx(Ee,{children:n.text})]})},srt=({size:e=24})=>{const{formatMessage:t}=M(),n={text:t("fop.shopping.lists.in.product.list")};return s.jsxs(h.Fragment,{children:[s.jsx(me,{primary:!0,width:e,height:e,name:"list","data-test":"in-product-list"}),s.jsx(Ee,{children:n.text})]})},nrt=({size:e=24})=>{const{formatMessage:t}=M(),n={text:t("fop.regular.icon.description")};return s.jsxs(h.Fragment,{children:[s.jsx(me,{primary:!0,name:"regulars","data-test":"fop-reg-icon",width:e,height:e}),s.jsx(Ee,{children:n.text})]})},ort=T(se)`
    gap: var(--salt-spacing-1);
    min-block-size: calc(1em * ${$l});
    max-block-size: calc(1em * ${$l});
    overflow: hidden;
    ${({hideEmpty:e})=>e&&`&:empty {
            display: none;
    }`}
`,rrt=T.button`
    gap: var(--salt-spacing-1);
    padding-block: var(--salt-spacing-05);
    padding-inline: var(--salt-spacing-1);
    border-radius: var(--salt-radius-default);
    background-color: white;

    &:empty {
        display: none;
    }

    display: flex;
`,art=({hideEmpty:e=!0})=>{const{product:t,group:{type:n,section:o,featuredProductCampaigns:r},page:a,fopPositionOnPage:i,config:l,displayLandscapeLayout:c}=qt(),{name:d,regular:u,isInProductList:m,favorite:g,productId:f,retailerProductId:y}=t,I=F(),S=ts(),{formatMessage:C}=M(),_=n===Lt.FEATURED,A=n===Lt.FEATURED_CROSS_SELL,x=n===Lt.SHOPPABLE_BANNER,R=_||A||x,O=Bn(t,r),N=()=>{S({type:zt.ELLIPSIS_CLICKED,productId:f,retailerProductId:y}),I(Z.openModal("shoppingLists",{productId:f,section:o,productIndex:i,page:a}))},{portrait:{topAttributes:k},landscape:{topAttributes:j}}=l,w=c?j?.featured:k?.featured,L=c?j?.favorite:k?.favorite,B=c?j?.list:k?.list,W=c?j?.regulars:k?.regulars,$=g&&L,K=m&&B,Q=u&&W,X=$||K||Q;return s.jsxs(ort,{hideEmpty:e,children:[R&&w&&s.jsx(ert,{contentSource:O?.source}),X&&s.jsxs(rrt,{type:"button",onClick:N,children:[$&&s.jsx(trt,{size:16}),K&&s.jsx(srt,{size:16}),Q&&s.jsx(nrt,{size:16}),s.jsx(Ee,{children:C("fop.attributes.button.accessibility.text",{productName:d})})]})]})},irt=T(Fn)`
    > * {
        font-size: ${({size:e})=>e&&` var(--salt-text-${e}-font-size)`};
        line-height: ${({size:e})=>e&&` var(--salt-text-${e}-line-height)`};
    }

    inline-size: 100%;
    max-inline-size: fit-content;
`,lrt=T(ne)`
    inline-size: 100%;
    max-inline-size: fit-content;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    padding-inline: var(--salt-spacing-1);
    padding-block: var(--salt-spacing-05);
    background-color: var(--intent-contrast);
    border-radius: var(--salt-radius-default);
`,crt=()=>{const{formatMessage:e}=M(),{product:{countryOfOrigin:t},config:n,displayLandscapeLayout:o}=qt(),r=E(m=>D("fr.law")(m)),a={countryOfOriginA11yPrefix:e("fop.country.of.origin.a11y.prefix")};if(!t)return null;const i=m=>m==="xl"?s.jsxs(lrt,{size:"s",forwardedAs:"span","data-test":"fop-country-of-origin",children:[s.jsx(Ee,{children:a.countryOfOriginA11yPrefix}),t]}):s.jsx(irt,{size:m,intent:"tertiary-contrast",singleLine:!0,text:t,accessibilityText:`${a.countryOfOriginA11yPrefix} `,"data-test":"fop-country-of-origin"}),l=r?n.portrait?.price?.fontSize:n.portrait?.countryOfOrigin,c=r?n.landscape?.price?.fontSize:n.landscape?.countryOfOrigin,d=!o&&l,u=o&&c;return d?i(d):u?i(u):null},drt=T(P)`
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
`,urt=T(Qe)`
    overflow: hidden;
    display: inline-grid;
`,nB=({breadcrumbsText:e,breadcrumbsClickAction:t})=>{const n=s.jsx(drt,{"data-test":"breadcrumb-text",className:"salt-d--block",children:e.name});return e.link?s.jsx(urt,{to:e.link,onClick:t,standalone:!0,children:n}):n},prt=(e,t,n)=>{h.useEffect(()=>{const o=r=>{t&&e&&e.current&&!e.current.contains(r.target)&&n()};return document.addEventListener("mousedown",o),document.addEventListener("touchend",o),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("touchend",o)}},[e])},mrt=T.button.withConfig({shouldForwardProp:(e,t)=>!["width","height"].includes(e)&&t(e)})`
    margin: 0;
    padding: 0;
    border: 0;
    background: transparent;
    cursor: pointer;
    display: inline-block;
`,hrt=({isBreadcrumbDropdownOpen:e,toggleBreadCrumbMenu:t,fopBreadcrumbsId:n,fopBreadcrumbsMenuId:o})=>{const{formatMessage:r}=M(),a=r("fop.group.menu.accessibility.label");return s.jsxs(mrt,{"aria-controls":o,"aria-expanded":e,"aria-haspopup":"true",type:"button","data-toggle":"true",height:20,id:n,width:20,onClick:t,"data-test":"fop-breadcrumbs-button",children:[s.jsx(me,{height:20,width:20,name:"more","aria-hidden":"true"}),s.jsx(Ee,{children:a})]})},grt=T.div`
    block-size: 20px;
`,Ert=T(Ot.Body)`
    inset-block-start: calc(${H(20)} + var(--salt-spacing-2));
`,frt=({productId:e,breadcrumbsItems:t,breadcrumbsClickAction:n})=>{const o=F(),[r,a]=h.useState(!1),i=h.useRef(null),l=()=>{a(!1)},c=g=>{g.key==="Escape"&&l()},d=()=>a(!r);h.useEffect(()=>{r&&o(U.analyticsEvent({type:zt.CLUSTER_EXPANDED,attributes:t.reduce((g,f,y)=>Object.assign(g,{[`categoryIdLevel${y+1}`]:f.id}),{})}))},[r]),prt(i,r,l);const u=`fop-breadcrumbs-${e}`,m=`fop-breadcrumbs-menu-${e}`;return s.jsxs(grt,{onKeyDown:c,ref:i,"aria-labelledby":u,"data-test":"dropdown",children:[s.jsx(hrt,{isBreadcrumbDropdownOpen:r,toggleBreadCrumbMenu:d,fopBreadcrumbsId:u,fopBreadcrumbsMenuId:m}),s.jsx(Ert,{isOpen:r,fill:!0,textWrap:!0,children:s.jsx(Ot.Content,{children:s.jsx(Ve,{id:m,"aria-labelledby":u,inline:!1,role:"menu",children:t.map((g,f)=>s.jsx(Ve.Item,{role:"menuitem",children:s.jsx(P,{asChild:!0,children:s.jsx(Qe,{to:g.link,onClick:()=>{l(),n(f,g.id)},standalone:!0,children:g.name})})},g.id))})})})]})},yrt=()=>{const{formatMessage:e}=M(),t=F(),{product:{productId:n},group:o,page:r}=qt(),[a,i]=fe(["seo.rdbl","seo.ra"]);if(!o)return null;const l=o.clusterBreadcrumbs?.length>0||!!(o.products.length>0&&typeof o.type=="string"&&o.type.length),c=o.products[0]===n;if(!l||!c)return null;const d=(I,S,C)=>{const _={level:I};if(S){_.categoryId=S,t(U.analyticsEvent({type:tn.SELECT_CATEGORY_GA4_EVENT,location:"breadcrumb",categoryName:C,retailerCategoryId:S}));const A={event:"select_category",id:S,location:"dropdown",name:C||""};J.sendEvent({GA:A,WA:null})}t(U.analyticsEvent({type:zt.BREADCRUMBS_LIST_CLICKED,description:"User clicked breadcrumbs list item",pageEventAttributes:_}))},u=({id:I,name:S,fullURLPath:C,retailerCategoryId:_})=>({id:I,name:S,link:m(i?_:I,C)}),m=(I,S)=>{const C=`source=breadcrumbs&sublocationId=${I}`;if(a){const _=S?.toLowerCase();return Ui(I,_,{queryString:"source=breadcrumbs"})}return jo({queryString:C})},g=(o.clusterBreadcrumbs??[]).map(u);if(g.length===0){const I={name:Jnt(o,r,e),link:o.type===Lt.FAVORITE?Mg({queryString:"source=breadcrumbs"}):null};return s.jsx(nB,{breadcrumbsText:I,breadcrumbsClickAction:()=>d(0)})}const f=g.length-1,y=g[f];return s.jsxs(se,{"data-test":"breadcrumb-header",wrap:"nowrap",children:[s.jsx(frt,{productId:n,breadcrumbsItems:g,breadcrumbsClickAction:d}),s.jsx(me,{height:18,width:18,name:"arrow_right"}),s.jsx(nB,{breadcrumbsText:y,breadcrumbsClickAction:()=>d(f,y.id,y.name)})]})},Irt=()=>{const{formatMessage:e}=M(),{product:{missingAmount:t,timeRestriction:n,timeRestricted:o,addedAmount:r,requestedAmount:a,reason:i,deliveryTimeRestrictionMessage:l},type:c}=qt();if(!(c==="slotbooking"||c==="order")||!i)return null;const m={OUT_OF_STOCK:{message:e("product.availability.out.of.stock",{itemQty:t}),type:"error"},EXCEEDED_MAX_QUANTITY:{message:e("fop.order.missing.label",{quantity:t}),type:"error"},TIME_RESTRICTION:(n||o)&&{message:l??e("fop.time.restriction",{to:n?.deliverableTo,from:n?.deliverableFrom}),type:"error"},LIMITED_AVAILABILITY:{message:e("product.availability.limited",{addedAmount:r,requestedAmount:a}),type:"error"}}[i];return m?s.jsx(Ce,{intent:m.type,text:m.message,size:"s","data-test":"fop-status"}):null},oB=T(b)`
    ${({minWidth:e})=>e?`min-width: ${H(e)}`:""};
`,Yd=({buttonWidth:e,className:t,alertClassName:n,shouldRenderButton:o=!0})=>{const{setAgeConfirmation:r,redirectPath:a}=Bst(),{formatMessage:i}=M(),l={button:i("alcohol.age.confirmation.button.label"),alert:i("alcohol.age.confirmation.fop.description"),alertAccessibility:i("alcohol.age.confirmation.modal.accessibility.description"),buttonAccessibility:i("alcohol.age.confirmation.modal.accessibility.button.label")},c=()=>a?s.jsx(oB,{asChild:!0,intent:"secondary",fill:!e,minWidth:e,children:s.jsxs(rt,{href:a,intent:"ghost",children:[s.jsx(Ee,{children:l.buttonAccessibility}),s.jsx(b.Text,{"aria-hidden":!0,children:l.button})]})}):s.jsxs(oB,{onClick:r,intent:"secondary",fill:!e,minWidth:e,children:[s.jsx(Ee,{children:l.buttonAccessibility}),s.jsx(b.Text,{"aria-hidden":!0,children:l.button})]});return s.jsxs(se,{direction:"column",justify:"space-between",gap:["sm"],gapSmUp:["md"],className:t,additionalCss:"flex: 1",children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h3",{children:l.alertAccessibility})}),s.jsx(Ce,{size:"s",intent:"info",className:n,text:l.alert,"aria-hidden":!0}),o&&s.jsx(se,{direction:"row",justify:e?"flex-end":"center",children:c()})]})},np={OWN_LINE:"ownLine"},rB=T.img`
    block-size: 100%;
    inline-size: 100%;
    background-color: ${({isLoading:e})=>e&&"var(--intent-secondary)"};
`,Srt=()=>{const e=E(c=>D("di")(c)),[t,n]=h.useState(!0),o=()=>{n(!1)},{product:{image:r},config:a}=qt();if(!r)return null;if(!e)return s.jsx(rB,{"data-test":"lazy-load-image",alt:r.description,src:r.src,onLoad:o,isLoading:t});const{portrait:{image:i},landscape:{image:l}}=a;return i?.resolution?.width||l?.resolution?.width?s.jsx(rB,{"data-test":"lazy-load-image",alt:r.description,src:r.src,srcSet:r.fopSrcset,sizes:`(max-width: ${Ke.sm}em) ${l?.resolution?.width}px, ${i?.resolution?.width}px`,onLoad:o,isLoading:t}):null},Crt=D("pbpm"),Trt=e=>async t=>{try{await t(Yr.getDraftBasket(e))}catch{z.error("request.error.title")}},_rt=e=>e.reduce((t,n)=>{const o=n?.product?.productId,r=t[o]??0,a=n?.product?.quantity??1;return{...t,[o]:r+a}},{}),QQ=({updateDraftBasketAction:e,errorMessage:t})=>{let n=[];const o=l=>{n.push(l)},r=()=>{n=[]},i=Jr(async(l,c)=>{if(!n?.length||!n[0]?.draftBasketId)return;const d=n?.slice(),u=d[0]?.draftBasketId,m=_rt(d);r();const g=Object.keys(m).map(f=>({productId:f,quantity:m[f]}));try{const f=await l(e({items:g,draftBasketId:u})),y=c();if(Crt(y)){const{payload:{responseData:{pricingNotifications:I}}}=f;l(kd(I))}}catch{z.error(t)}},250);return l=>(c,d)=>{const u=l?.draftBasketId,m=l?.product,g=m?.productId,f=m?.quantity;u&&g&&f&&(o(l),i(c,d))}},vrt=()=>QQ({updateDraftBasketAction:Yr.addItemsToDraftBasket,errorMessage:"basket.add.item.error"}),Art=()=>QQ({updateDraftBasketAction:Yr.removeItemsFromDraftBasket,errorMessage:"basket.remove.item.error"}),brt=(e,t,n)=>(o,r,a)=>i=>l=>{if(l===i)return;const c=l-i,d={position:r,section:a.section,product:{...o,quantity:Math.abs(c)},draftBasketId:n};c>0?e(d):t(d)},Lh={getDraftBasket:Trt,createBatchAddToDraftBasket:vrt,createBatchRemoveFromDraftBasket:Art,updateDraftBasketQuantityFactory:brt},cI=(e,t)=>({...e,cmsProductAttributes:t&&t.type==="featured"?["featured"]:[]}),xrt=(e,t,n,o)=>(r,a,i)=>l=>c=>{if(c===l)return;const d=c-l,u=n!=="basket";d>0?e({page:n,position:a,section:i.section,addedByFunction:"FOP",...u&&{productListName:Ws(n,o,i.section)},product:{...cI(r,i),quantity:d}}):t({page:n,position:a,section:i.section,addedByFunction:"FOP",product:{...cI(r,i),quantity:Math.abs(d)}})},cT=(e,{page:t,subPage:n,position:o,type:r,group:a})=>{const i=Ne(),l=E(_=>sl(_,e)),d=E(t4(i))?.productGroups[0]?.freeGifts?.promotions?.find(_=>_.products?.some(A=>A.productId===e))?.promotionId,u=E(zD),m=F(),g=Lh.createBatchAddToDraftBasket(),f=ca.createBatchAddToBasket(),y=ca.createBatchRemoveFromBasket(),I=Lh.createBatchRemoveFromDraftBasket(),S=h.useCallback(_=>{const A=t!=="basket",x={page:t,position:o,section:a.section,isFreeGift:!!a.gifts,promotionId:d,addedByFunction:"FOP",...A&&{productListName:Ws(t,n,a.section)},product:{...cI(l,a),quantity:_}};return m(r==="slotbooking"?g({...x,draftBasketId:u}):f(x))},[f,g,d,m,u,a,t,o,l,n,r]),C=h.useCallback(_=>{const A={page:t,position:o,section:a.section,isFreeGift:!!a.gifts,addedByFunction:"FOP",promotionId:d,product:{...cI(l,a),quantity:Math.abs(_)}};return m(r==="slotbooking"?I({...A,draftBasketId:u}):y(A))},[y,I,d,m,u,a,t,o,l,r]);return{addToBasket:S,removeFromBasket:C}},XQ=()=>{const{product:{productId:e,maxQuantityReached:t,available:n,timeRestriction:o,timeRestricted:r,alternatives:a,retailerProductId:i},position:l,type:c}=qt(),d=ts(),u=E(x=>D("oosa")(x)),m=E(x=>D(Ud)(x)),g=E(x=>c==="slotbooking"&&u?cz(x,e):uS(x,e),(x,R)=>x?.quantity.quantityInBasket===R?.quantity.quantityInBasket&&x?.quantity.maxQuantityReached===R?.quantity.maxQuantityReached);g&&g.quantity.maxQuantityReached===void 0&&Fb(g,{quantity:{maxQuantityReached:t}});const f=g?.quantity.quantityInBasket,y=!g&&t,I=n,S=!I,C=!!r&&!!o,_=!!a?.length&&S;return{quantityInBasket:f,isMaxQuantityReachedButNotInBasket:y,isProductAvailable:I,isOutOfStock:S,isTimeRestrictedItem:C,productHasAlternatives:_,isRegularsOrderEnabled:m,productInBasket:g,showSubstitutesClickedEvent:(x=vt())=>{d({type:zt.SHOW_SUBSTITUTES,productId:e,retailerProductId:i,totalCount:_?a.length:0,hideSubstitutes:!1,productSequence:l,pageEventId:x})}}},Xn=T(b)`
    min-block-size: ${({size:e})=>e==="s"&&H(30)};
    min-inline-size: ${({size:e})=>e==="s"&&H(30)};
`,Rrt=({size:e,productName:t,productId:n,productIndex:o,section:r,page:a})=>{const{formatMessage:i}=M(),l=F(),c=()=>{l(LC({productId:n,productIndex:o,section:r,page:a}))};return s.jsx(Xn,{fill:!0,onClick:c,intent:"primary",size:e==="sm"?"s":"m",type:"button","data-test":"fop-regulars-button","aria-label":i("regular.addToRegulars.accessibility.button",{productName:t}),children:s.jsx(Xn.Text,{children:i("regular.addToRegularsForm.submit")})})},Drt=({regularsUpdated:e,productName:t})=>{const{formatMessage:n}=M(),{parameter:o,newFrequency:r,newQuantity:a}=e,i=()=>{if(o==="FREQUENCY_CHANGED"){let l=s8.find(c=>c.value===r)?.translationId??"";return l=n(l),n("regular.frequency.update.success",{productName:t,frequency:l,quantity:a})}return n("regular.quantity.update.success",{productName:t,quantity:a})};return s.jsx(Ee,{"aria-live":"polite",children:i()})},Ort=T.div`
    display: flex;
    gap: var(--salt-spacing-2);
    max-inline-size: 100%;
`;function ZQ({productId:e,retailerProductId:t,initialFrequency:n,initialQuantity:o,size:r="md",page:a,productIndex:i,section:l,subPage:c,productName:d}){const u=M(),m=F(),g=E(R=>Gze(R,e)),[f,y]=h.useState(null),I=WC(),S=hP(),C=o8();h.useEffect(()=>{y(null)},[]);const _=async(R,O)=>{g||(R.quantity===0?await C({productId:R.productId,productName:d,retailerProductId:t,quantity:o,frequency:R.frequency,page:a,section:l,subPage:c,productIndex:i}):m(Mze(R)).then(()=>{m(Ft.updateProducts({product:[{productId:e,regular:R}]})),I.productUpdated(O),S.regularsGaEvent({event:"update_regulars",retailerProductId:t,productName:d,quantity:R.quantity,frequency:R.frequency,productIndex:i,list:Ws(a,c,l)??""})}).catch(N=>{Me.api.pushError(N instanceof Error?N:new Error(`handleUpdateRegular error: ${JSON.stringify(N)}`))}))},A=async R=>{await _({productId:e,quantity:R,frequency:n},{retailerProductId:t,productId:e,parameter:"QUANTITY",previousValue:o,currentValue:R}),y({parameter:"QUANTITY_CHANGED",newQuantity:R,newFrequency:n}),R>=BA&&(z.info("regular.maxQuantity.success"),await I.toastNotificationDisplayed("regularQuantityError"))},x=async R=>{await _({productId:e,quantity:o,frequency:R},{retailerProductId:t,productId:e,parameter:"FREQUENCY",previousValue:n,currentValue:R}),y({parameter:"FREQUENCY_CHANGED",newFrequency:R,newQuantity:o})};return s.jsxs(Ort,{"data-test":"fop-regulars-form",children:[f&&s.jsx(Drt,{regularsUpdated:f,productName:d}),s.jsx(A8,{allowZeroQuantity:!0,maxWidth:40,textAlign:"center",onQuantityChange:A,ariaLabel:u.formatMessage("regular.quantity.ariaLabel",{productName:d}),initialQuantity:o,isDisabled:g,size:r}),s.jsx(TP,{onSelect:x,initialFrequency:n,isDisabled:g,ariaLabel:u.formatMessage("regular.frequency.ariaLabel",{productName:d}),size:r})]})}const Prt=V(e=>e.data.products.productEntities,e=>{const t={};return Object.keys(e).forEach(n=>{const o=e[n];t[o.productId]=o.quantityRestrictionGroup}),t}),Nrt=e=>e.data.basket.items.map(t=>({productId:t.productId,quantity:t.quantity.quantityInBasket})),Lrt=V([Nrt,Prt],(e,t)=>{const n={};return e.forEach(o=>{const r=t[o.productId];if(!r)return;const i=(n[r.quantityRestrictionGroupId]??0)+r.contribution*o.quantity;n[r.quantityRestrictionGroupId]=i}),n}),krt=(e,t)=>{if(!e.quantityRestrictionGroup)return!1;const n=t[e.quantityRestrictionGroup.quantityRestrictionGroupId];return n?n+e.quantityRestrictionGroup.contribution>100:e.quantityRestrictionGroup.contribution>100},JQ=e=>V([Lrt,t=>sl(t,e)],(t,n)=>n?krt(n,t):!1),dT=(e,t)=>e.data.products.productEntities[t].name,{Container:Mrt,Operator:jrt}=Si,wrt=({size:e,icon:t,iconOnly:n})=>{const o=F(),{product:{productId:r},fopPositionOnPage:a,page:i,subPage:l,type:c,group:d}=qt(),{formatMessage:u}=M(),m={page:i,position:a,subPage:l,type:c,group:d},{addToBasket:g}=cT(r,m),f=E(I=>dT(I,r)),y=E(At);return s.jsx(Mrt,{size:e,"data-synthetics":`product-id:${r}`,"data-test":`add-free-gift-product-id:${r}`,children:s.jsxs(jrt,{type:"button",fullWidth:!n,appearance:"action",size:e,onClick:()=>(o(br.toggleFreeGiftSelected(r,d.promotionId,!0)),o(U.analyticsEvent({type:Kn.ADD_FREE_GIFT_CLICKED,description:"Select gift button clicked",pageEventAttributes:{orderId:y,productId:r}})),g(1)),"data-synthetics":"add-free-gift-button","data-test":"add-free-gift-button","aria-label":u("free.gift.select.button.label.alternative",{productName:f}),children:[t&&s.jsx(me,{name:t.name,height:18}),!n&&u("free.gift.select.button.label")]})})},ny=T(b)`
    inline-size: 100%;
    min-block-size: auto;
`,{Container:Frt}=Si,Brt=({size:e})=>{const t=F(),{product:{productId:n},fopPositionOnPage:o,page:r,subPage:a,type:i,group:l}=qt(),{formatMessage:c}=M(),d={page:r,position:o,subPage:a,type:i,group:l},{removeFromBasket:u}=cT(n,d),m=E(y=>dT(y,n)),g=E(At),f={removeFromBasket:c("free.gift.unselect.button.label"),removeFromBasketAlternative:c("free.gift.unselect.button.label.alternative",{productName:m})};return s.jsx(Frt,{size:e,"data-synthetics":`product-id:${n}`,"data-test":`remove-free-gift-product-id:${n}`,children:s.jsx(ny,{intent:"secondary",onClick:()=>(t(br.toggleFreeGiftSelected(n,l.promotionId,!1)),t(U.analyticsEvent({type:Kn.REMOVE_FREE_GIFT_CLICKED,description:"Remove gift button clicked",pageEventAttributes:{orderId:g,productId:n}})),u(1)),"data-synthetics":"remove-free-gift-button","data-test":"remove-free-gift-button","aria-label":f.removeFromBasketAlternative,children:f.removeFromBasket})})},Urt=({productInBasket:e})=>{const{formatMessage:t}=M(),n=e?.quantity?.quantityInBasket||0,o=t("counter.quantity.description.alternative",{quantity:n});return s.jsx(Ph,{message:o,productQuantity:n})},{Container:Grt}=Si,$rt=({size:e,isSinglePromotionLimitReached:t,isAllPromotionsLimitReached:n})=>{const{formatMessage:o}=M(),r={limitReached:o("free.gift.limit.reached.button.label")};return s.jsx(Grt,{size:e,"data-test":"free-gift-limit-reached",children:s.jsxs(ny,{intent:"secondary","data-test":"fop-controls-limit-reached-button","aria-label":r.limitReached,onClick:()=>{t&&z.info("free.gift.limit.reached.error.message"),n&&z.info("free.gift.total.limit.reached.error.message")},children:[s.jsx(ny.Icon,{name:"info_default"}),s.jsx(ny.Text,{children:r.limitReached})]})})},{Container:Hrt}=Si,Vrt=({size:e,timeRestriction:t})=>{const{formatMessage:n}=M(),{product:{name:o,deliveryTimeRestrictionMessage:r}}=qt(),a={timeRestricted:n("fop.time.restricted"),timeRestrictedAccessibilityText:n("fop.time.restriction.accessibility.text",{productName:o,to:t?.deliverableTo||"",from:t?.deliverableFrom||""})},i=()=>{if(r){z.warning({formattedMessage:r});return}t&&z.warning({key:"fop.time.restriction.toast",substitutions:{to:t.deliverableTo,from:t.deliverableFrom}})};return s.jsx(Hrt,{size:e,children:s.jsxs(Xn,{intent:"secondary",size:e==="sm"?"s":"m",fill:!0,onClick:()=>i(),"data-test":"fop-controls-time-restricted-button","aria-label":a.timeRestrictedAccessibilityText,children:[s.jsx(Xn.Icon,{name:"slot"}),s.jsx(Xn.Text,{children:a.timeRestricted})]})})},{Container:Yrt}=Si,Wrt=({size:e,sendAnalytics:t,icon:n})=>{const{formatMessage:o}=M(),{product:{name:r}}=qt(),a={outOfStockMessage:o("fop.no.alternatives.text"),outOfStockAccessibilityMessage:o("fop.no.alternatives.accessibility.text",{productName:r})},i=()=>{z.warning("fop.no.alternatives.text.toast"),t()};return s.jsx(Yrt,{size:e,children:s.jsxs(Xn,{intent:"tertiary",size:e==="sm"?"s":"m",fill:!0,onClick:i,"data-test":"fop-controls-no-alternatives-button","aria-label":a.outOfStockAccessibilityMessage,children:[n?.name&&s.jsx(Xn.Icon,{name:n.name}),s.jsx(Xn.Text,{children:a.outOfStockMessage})]})})},{Container:qrt}=Si,Krt=({size:e,sendAnalytics:t,productId:n,type:o,icon:r,messageKey:a="fop.show.alternatives.text"})=>{const{formatMessage:i}=M(),l=F(),c=E(y=>sl(y,n));if(!c)return null;const{alternatives:d,retailerProductId:u,name:m}=c,g={showAlternativesMessage:i(a,{numberOfAlternatives:d?.length}),showAlternativesAccessibilityMessage:i("fop.show.alternatives.accessibility.text",{productName:m})},f=()=>{const y=vt();l(Z.openModal(Zu,{productId:n,retailerProductId:u,productName:m,type:o,pageEventId:y})),t(y)};return s.jsx(qrt,{size:e,"data-synthetics":`product-id:${n}`,children:s.jsxs(Xn,{intent:"secondary",size:e==="sm"?"s":"m",fill:!0,onClick:f,"data-test":"fop-controls-show-alternatives-button","aria-label":g.showAlternativesAccessibilityMessage,children:[r?.name&&s.jsx(Xn.Icon,{name:r.name}),s.jsx(Xn.Text,{children:g.showAlternativesMessage})]})})},{Container:zrt}=Si,Qrt=({size:e})=>{const{formatMessage:t}=M(),{product:{name:n}}=qt(),o={maxQuantityA11y:t("fop.max.quantity.accessibility.text",{productName:n}),maxQuantityLabel:t("fop.max.quantity.label")};return s.jsx(zrt,{size:e,children:s.jsxs(Xn,{intent:"secondary",size:e==="sm"?"s":"m",fill:!0,onClick:()=>z.error("fop.max.quantity.toast.generic"),"data-test":"fop-controls-max-quantity-button","aria-label":o.maxQuantityA11y,children:[s.jsx(Xn.Icon,{name:"info_default"}),s.jsx(Xn.Text,{children:o.maxQuantityLabel})]})})};function YA(e){e==="FREE_GIFT"&&z.info("free.gift.free.of.charge.notification")}const{Container:Xrt,CountInput:Zrt,CountInputContainer:Jrt,OperatorLeft:eat,OperatorRight:J_}=Si,tat=({size:e,productInBasket:t})=>{const{fopPositionOnPage:n,page:o,subPage:r,type:a,group:i,product:{restrictedVisibility:l,offer:c}}=qt(),d=h.useRef(null),{formatMessage:u}=M(),[m,g]=h.useState(!1),{productId:f,quantity:{quantityInBasket:y,maxQuantityReached:I}}=t,{addToBasket:S,removeFromBasket:C}=cT(f,{page:o,subPage:r,position:n,type:a,group:i}),{isOutOfStock:_}=XQ(),A=E(te=>dT(te,f)),x=E(JQ(f)),R=E(i0),O=0,N=1,k=y>=R||I,j={increaseQuantityTextAlternative:u("counter.increase.quantity.button.alternative.with.product",{productName:A}),decreaseQuantityTextAlternative:u("counter.decrease.quantity.button.alternative.with.product",{productName:A}),editQuantityTextAlternative:u("counter.edit.quantity.input.alternative.with.product",{productName:A}),maxQuantityA11y:u("fop.max.quantity"),ageRestricted:u("age.restricted.button")};h.useEffect(()=>{d.current&&(d.current.value=y.toString())},[y]);const w=te=>{if(d.current&&(Number.isNaN(te)||te===y)){d.current.value=y.toString();return}const ce=te-y;if(ce){if(te<y){C(ce);return}YA(c?.type),S(ce)}},L=()=>{d.current&&d.current.select()},B=te=>{te.key==="Enter"&&d.current!==null&&d.current.blur(),te.key==="Tab"&&W(te)},W=te=>{const ce=te.target;if(d.current&&ce.valueAsNumber>R){z.error("fop.max.quantity.toast.generic"),d.current.value=R.toString(),w(R);return}if(d.current&&ce.valueAsNumber<O){d.current.value=O.toString(),w(O);return}w(ce.valueAsNumber)},$=()=>{document.activeElement===d.current&&g(!0)},K=te=>{if(m){g(!1);return}YA(c?.type),S(te)},Q=te=>{if(m){g(!1);return}C(te)},X=()=>s.jsx(eat,{type:"button",appearance:"action",size:e,onClick:()=>Q(N),onMouseDown:$,"data-test":"counter:decrement","aria-label":j.decreaseQuantityTextAlternative,children:s.jsx(me,{name:"minus",height:18})}),re=()=>{if(l===iI.BLURRED_IMAGE)return s.jsx(qg,{ariaLabel:j.ageRestricted,children:s.jsx(J_,{type:"button",appearance:"action","data-test":"counter:max-quantity",size:e,"data-synthetics":"add-button","aria-hidden":!0,children:s.jsx(me,{name:"info_default",height:18})})});if(x||k||_){const te=_?"fop.oos.toast":"fop.max.quantity.toast.generic";return s.jsx(J_,{type:"button",appearance:"action",onClick:()=>z.error(te),"data-test":"counter:max-quantity",size:e,"data-synthetics":"add-button","aria-label":j.maxQuantityA11y,children:s.jsx(me,{name:"info_default",height:18})})}return s.jsx(J_,{appearance:"action",onClick:()=>K(N),onMouseDown:$,size:e,"data-test":"counter:increment","data-synthetics":"add-button","aria-label":j.increaseQuantityTextAlternative,children:s.jsx(me,{name:"plus",height:18})})},ue=()=>s.jsx(Jrt,{children:s.jsx(Zrt,{defaultValue:y,type:"number",min:O,max:R,onBlur:W,onKeyDown:B,onClick:L,ref:d,"aria-label":j.editQuantityTextAlternative,"data-test":"quantity-in-basket","data-synthetics":"quantity-in-basket"})});return s.jsxs(Xrt,{size:e,"data-synthetics":`product-id:${f}`,children:[X(),ue(),re()]})},{Container:sat,Operator:nat}=Si,oat=({size:e,icon:t})=>{const{product:{productId:n,offer:o},fopPositionOnPage:r,page:a,subPage:i,type:l,group:c}=qt(),{formatMessage:d}=M(),u={page:a,position:r,subPage:i,type:l,group:c},{addToBasket:m}=cT(n,u),g=E(f=>dT(f,n));return s.jsx(sat,{size:e,"data-synthetics":`product-id:${n}`,children:s.jsxs(nat,{type:"button",fullWidth:!0,appearance:"action",size:e,onClick:()=>(YA(o?.type),m(1)),"data-synthetics":"add-button","data-test":"counter-button","aria-label":d("fop.add.button.alternative",{productName:g}),children:[t&&s.jsx(me,{name:t.name,height:18}),d("fop.add.button")]})})},rat=({size:e})=>{const{formatMessage:t}=M(),n={ageRestricted:t("age.restricted.button")};return s.jsx(qg,{ariaLabel:n.ageRestricted,children:s.jsxs(Xn,{intent:"secondary",size:e==="sm"?"s":"m",fill:!0,"data-test":"fop-controls-age-restricted-button","aria-hidden":!0,tabIndex:-1,children:[s.jsx(Xn.Icon,{name:"info_default"}),s.jsx(Xn.Text,{children:n.ageRestricted})]})})},e9=({size:e="md"})=>{const{product:{productId:t,retailerProductId:n,timeRestriction:o,restrictedVisibility:r,regular:a,name:i,deliveryTimeRestrictionMessage:l},fopPositionOnPage:c,page:d,type:u,group:m,subPage:g}=qt(),{quantityInBasket:f,isMaxQuantityReachedButNotInBasket:y,isProductAvailable:I,isOutOfStock:S,isTimeRestrictedItem:C,productHasAlternatives:_,isRegularsOrderEnabled:A,productInBasket:x,showSubstitutesClickedEvent:R}=XQ(),O=E(j=>j.data.basket.items.some(w=>w.productId===t)),N=E(JQ(t));if(r===iI.BLURRED_IMAGE&&!x)return s.jsx(rat,{size:e});if(I&&(C||l))return s.jsx(Vrt,{timeRestriction:o,size:e});if(A&&d==="regulars"){if(u==="regular"&&a){const{frequency:j,quantity:w}=a;return s.jsx(ZQ,{productId:t,retailerProductId:n,productName:i,initialFrequency:j,initialQuantity:w,size:e,section:m.section,page:d,subPage:g,productIndex:c})}return s.jsx(Rrt,{size:e,productId:t,productName:i,page:d,section:m.section,productIndex:c})}if(S&&!x)return _?s.jsx(Krt,{productId:t,type:u,size:e,sendAnalytics:R}):s.jsx(Wrt,{sendAnalytics:R,size:e});const k=()=>{if(I&&y&&!_||N&&!O)return s.jsx(Qrt,{size:e});if(m.gifts){const L=(m.gifts.isSinglePromotionLimitReached||m.gifts.isAllPromotionsLimitReached)&&!m.gifts.selectedGifts?.[t];return m.gifts.selectedGifts?.[t]?s.jsx(Brt,{size:e}):L?s.jsx($rt,{size:e,isSinglePromotionLimitReached:m.gifts?.isSinglePromotionLimitReached,isAllPromotionsLimitReached:m.gifts?.isAllPromotionsLimitReached}):s.jsx(wrt,{size:e})}return I&&!f?s.jsx(oat,{size:e}):s.jsx(tat,{productInBasket:x,size:e})};return s.jsxs(h.Fragment,{children:[s.jsx(Urt,{productInBasket:x}),k()]})},WA=()=>{const{sendFopImpressionEvent:e,onFopContainerClick:t}=tN(),[n]=fe(["fop.n.img"]),{product:{productId:o,alcohol:r,name:a},customStyling:i,displayLandscapeLayout:l,withoutHeader:c,config:d,layoutType:u,ref:m,hasBeenViewed:g}=qt();h.useEffect(()=>{e()},[g]);const f=E($=>lx($,o))>0,{portrait:{image:y,controlsContainer:I,packSize:S,price:C},landscape:{image:_,controlsContainer:A,packSize:x,price:R}}=d,O=l?_?.link:y?.link,N=S?.position===np.OWN_LINE,k=x?.position===np.OWN_LINE,j=l?k:N,w=l?A?.position==="priceLine":I?.position==="priceLine",L=l?R?.direction:C?.direction,B=l?d?.landscape?.controlsContainer?.size:d?.portrait?.controlsContainer?.size,W=k&&L!=="column";return s.jsxs(WQ,{ref:m,layoutType:u,displayLandscapeLayout:l,"data-test":`fop-wrapper:${o}`,"data-retailer-anchor":"fop","data-layout":u,customStyling:i,config:d,inCart:f,isStacked:j,onClick:t,children:[!c&&s.jsxs("div",{className:"outer-header-container",children:[s.jsx(Irt,{}),s.jsx(yrt,{})]}),s.jsx(pc,{isActive:r,overlay:s.jsx(Yd,{className:"salt-p--2"}),children:({blurClassName:$,aria:K})=>s.jsxs("div",{className:`product-card-container ${$||""}`,...K??{},children:[s.jsxs("div",{className:"header-container",children:[s.jsx("div",{className:"position-relative",children:s.jsxs("div",{className:"top-icons-container",children:[s.jsx(art,{}),s.jsx(crt,{})]})}),s.jsxs("div",{className:"image-container",children:[O&&s.jsx(qg,{tabIndex:-1,className:"image-link-concealed",ariaHidden:!0,children:s.jsx(Ee,{children:a})}),n?s.jsx(Srt,{}):s.jsx(zQ,{})]}),s.jsx("div",{className:"attributes-container",children:s.jsx(Bot,{})})]}),s.jsxs("div",{"data-test":"fop-body",className:"footer-container",children:[s.jsxs(se,{direction:"column",gap:["xs"],children:[s.jsx("div",{className:"title-container",children:s.jsx(KQ,{})}),s.jsx("div",{className:"promotion-container","data-retailer-anchor":"fop-promotions",children:s.jsx(hot,{})}),j&&s.jsx(VA,{}),s.jsx(dN,{})]}),s.jsxs(se,{direction:w?"row":"column",align:w?"flex-end":"inherit",justify:"flex-end",gap:["xs",null],children:[s.jsxs("div",{className:"price-pack-size-container",children:[s.jsx(cN,{direction:L}),!j&&s.jsx(VA,{})]}),W&&s.jsx(lN,{}),s.jsxs("div",{className:"controls-container",children:[s.jsx(e9,{size:B})," "]})]})]})]})})]})},aat={s:"textS",m:"textM",l:"textL",xl:"displayS"},aB=()=>{const{displayLandscapeLayout:e,config:t,customStyling:n,withoutHeader:o,layoutType:r,ref:a}=qt(),{portrait:{controlsContainer:i,packSize:l,price:c,referencePrice:d},landscape:{controlsContainer:u,packSize:m,price:g,referencePrice:f}}=t,y=l?.position===np.OWN_LINE,I=m?.position===np.OWN_LINE,S=e?I:y,C=e?u?.size:i?.size,_=e?u?.position==="priceLine":i?.position==="priceLine",A=e?g?.fontSize:c?.fontSize,x=ls(e?m?.fontSize:l?.fontSize),R=ls(e?f?.fontSize:d?.fontSize),O=k=>k?aat[k]:"textS",N=()=>C==="sm"?"s":"m";return s.jsxs(WQ,{ref:a,customStyling:n,"data-test":"fop-skeleton",layoutType:r,config:t,inCart:!1,"data-retailer-anchor":"fop-skeleton",displayLandscapeLayout:e,children:[!o&&!e&&s.jsx(Z_,{height:20}),s.jsxs("div",{className:"product-card-container",children:[s.jsxs("div",{className:"header-container",children:[s.jsx("div",{className:"image-container",children:s.jsx(Qc,{})}),s.jsx("div",{className:e?"position-absolute":"position-relative",children:s.jsxs("div",{className:"attributes-container",children:[s.jsx(Z_,{height:20,className:"salt-m-b--1"}),s.jsx(Z_,{height:20,className:"salt-m-t--1"})]})})]}),s.jsxs("div",{"data-test":"fop-body",className:"footer-container",children:[s.jsx("div",{className:"title-container",children:s.jsx(Qc,{height:"100%"})}),s.jsx("div",{className:"promotion-container",children:s.jsx(Qc,{height:"100%"})}),S&&s.jsx(HA,{fontSize:x,children:s.jsx(bl,{variant:O(x)})}),R&&s.jsx(HA,{fontSize:R,children:s.jsx(bl,{variant:O(R)})}),s.jsxs(se,{direction:_?"row":"column",align:_?"flex-end":"inherit",gap:["xs",null],children:[s.jsxs("div",{className:"price-pack-size-container",children:[s.jsx(Lot,{fill:50,fontSize:A||"s"}),!S&&s.jsx(kot,{fontSize:x||"s"})]}),s.jsx("div",{className:"controls-container",children:s.jsx(_Q,{fill:!0,size:N()})})]})]})]})]})},ka=h.memo(({loading:e,buildFopContextIfEmpty:t=!0,...n})=>{const{page:o,productId:r,product:a}=n,i=E(D("new.prl")),l=E(Yt),c=ZP({page:o,productId:r,product:a});return l&&!c&&!i&&!t?null:i?s.jsxs(aT,{...n,product:c,children:[e&&s.jsx(aB,{}),!e&&c&&s.jsx(WA,{})]}):s.jsxs(Fnt,{...n,product:c,children:[e&&s.jsx(aB,{}),!e&&c&&s.jsx(WA,{})]})}),t9={fopTilesInRow:{xs:4,sm:6,md:8,lg:8}},ev=h.createContext(t9),s9={defaultValue:t9,Context:ev,Provider:ev.Provider,Consumer:ev.Consumer},{TileQuantityBadge:iat,TileMedia:lat,ImageTopBar:cat,Tile:dat,Fop:uat}=pW,pat=T(uat)`
    padding: 0;
    min-inline-size: 140px;
`,mat=T.div`
    aspect-ratio: 1 / 1;
`,hat=({missedPromotion:e})=>{const{formatMessage:t}=M(),{product:n,group:{featuredProductCampaigns:o}}=qt(),{productId:r,offer:a,alcohol:i,image:l,name:c,restrictedVisibility:d}=n,u=E(f=>uS(f,r)),m=Bn(n,o),g=()=>{if(!a||!a.description)return null;const f=a.type&&lT(a.type);return s.jsx(nt.OfferText,{"data-test":"fop-offer-icon",children:s.jsx(me,{className:"salt-m--1",name:f})})};return s.jsxs(h.Fragment,{children:[a?.requiredProductQuantity&&s.jsx(Ph,{productQuantity:u?.quantity?.quantityInBasket??0,message:e?.missedPromotionTextAlternative}),s.jsx(dat,{children:s.jsxs(pc,{isActive:i,children:[u.quantity.quantityInBasket>1&&s.jsx(iat,{intent:"action",count:u?.quantity.quantityInBasket??0}),s.jsxs(lat,{children:[s.jsxs(cat,{children:[g(),!!m&&!1]}),lI(s.jsx(mat,{children:s.jsx(nt.Image,{title:l.description||c,alt:l.description||c,src:l.src})}),d)]}),c&&s.jsx(Ee,{asChild:!0,children:s.jsx("h3",{children:c})})]})})]})},gat=e=>{const{page:t,position:n,fopPositionOnPage:o,group:r,noOfferLink:a,type:i,subPage:l,productId:c,missedPromotion:d}=e,u=ZP({page:t,productId:c}),{fop:m}=wC();return u?s.jsxs(aT,{product:u,position:n,page:t,noOfferLink:a,type:i,group:r,subPage:l,fopPositionOnPage:o,displayLandscapeLayout:!1,withoutHeader:!0,overrideConfig:{portrait:{divider:!1,bottomAttributes:{ratingBadgeOrBoughtDate:!1,maxLifestyleIcons:0},topAttributes:{favorite:!1,featured:!1,list:!1,regulars:!1},image:m?.landscape.image,footerContainer:{...m?.portrait.footerContainer,inBasketBackground:!1},...!u.offer&&{promotion:null},...!u.price?.reference&&{referencePrice:null}}},children:[s.jsx(hat,{missedPromotion:d}),s.jsx(pat,{"data-test":`styled-fop-wrapper:${c}`,children:s.jsx(WA,{})})]}):null},{TileSkeleton:Eat,Fop:fat,Wrapper:iB}=pW,n9=h.forwardRef((e,t)=>{const n=h.useRef(),{loading:o,productId:r,missedPromotion:a,page:i,position:l,fopPositionOnPage:c,group:d,noOfferLink:u,type:m,subPage:g}=e;h.useImperativeHandle(t,()=>n.current,[]);const f=()=>{const _=n.current,A=_&&_.parentElement;if(A&&_&&_.getRootNode&&!A.hasAttribute("style")){const R=_.getRootNode().querySelector(`${US}`)?.getAttribute("height");A.setAttribute("style",`--bar-bottom-height: ${R||0}px`)}},y=_=>{const A=n.current,x=A&&A.querySelector(`${fat}`);x&&(_.type==="focus"&&requestAnimationFrame(()=>{const R=A.offsetHeight,O=x.offsetHeight;f(),A.style.bottom=`calc(
                    var(--bar-bottom-height, 0px) + ${O-R}px
                )`,requestAnimationFrame(()=>x.scrollIntoView({behavior:"smooth",block:"center"}))}),_.type==="blur"&&A.removeAttribute("style"),I(_))},I=_=>{const A=n.current;if(A)try{A.querySelector(":focus-within")}catch{_.type==="focus"&&A.classList.add("focusWithin"),_.type==="blur"&&requestAnimationFrame(()=>{A.querySelectorAll(":focus").length===0&&A.classList.remove("focusWithin")})}};if(o)return s.jsx(iB,{ref:n,"data-test":"tile-skeleton",children:s.jsx(Eat,{})});const{fopTilesInRow:S}=s9.defaultValue,C={page:i,position:l,fopPositionOnPage:c,group:d,noOfferLink:u,type:m,subPage:g,productId:r,missedPromotion:a};return s.jsx(iB,{"data-test":`tile-fop-wrapper:${r}`,"data-retailer-anchor":"tile-fop",ref:n,onFocus:y,onBlur:y,fopTilesInRow:S,role:"group",children:!o&&s.jsx(gat,{...C})})});class yat{constructor(t,n=null){this.onVisibilityChange=t,this.scrollableContainerElementRef=n,this.registerRef=this.registerRef.bind(this),this.callback=this.callback.bind(this),this.idleCallbackId=null,this.visibleRefs=new Set,this.observer=null,this.pendingRefs=[]}registerRef(t,n){this.observer?this.observeRef(t,n):this.pendingRefs.push({id:t,ref:n})}observeRef(t,n){return n.dataset.visibilityId=t,this.observer.observe(n),()=>{this.observer.unobserve(n)}}callback(t){t.forEach(o=>{const r=o.target;o.isIntersecting&&o.intersectionRatio>=.15?this.visibleRefs.add(r):!o.isIntersecting&&o.intersectionRatio===0&&this.visibleRefs.delete(r)});const n=[];this.visibleRefs.forEach(o=>{n.push({id:o.dataset.visibilityId})}),this.idleCallbackId&&(window.cancelIdleCallback(this.idleCallbackId),this.idleCallbackId=null),window.requestIdleCallback?this.idleCallbackId=window.requestIdleCallback(()=>{this.onVisibilityChange(n),this.idleCallbackId=null},{timeout:200}):this.onVisibilityChange(n)}start(){this.observer=new window.IntersectionObserver(this.callback,{root:this.scrollableContainerElementRef?this.scrollableContainerElementRef.current:null,rootMargin:"100%",threshold:[0,.15]}),this.pendingRefs.forEach(({id:t,ref:n})=>this.observeRef(t,n))}stop(){this.observer.disconnect()}check(){}}const Iat=({onFopVisibilityChange:e=()=>{},onInitialFopLoad:t=()=>{},scrollableContainerElementRef:n,children:o})=>{const[r,a]=h.useState(null),i=h.useRef(new yat(l=>{a(l);try{e(l)}catch{}},n));return h.useEffect(()=>{const l=i.current;return l.start(),()=>{l.stop()}},[]),h.useEffect(()=>{i.current.check(),r===null&&t()},[r,t]),o({registerRef:i.current.registerRef,visibleFops:r})},Sat={attributes:p.arrayOf(p.shape()),image:p.shape({description:p.string,src:p.string}),images:p.arrayOf(p.shape({description:p.string,src:p.string})),timeRestriction:p.shape({deliverableFrom:p.string,deliverableTo:p.string}),offer:p.shape({id:p.string,description:p.string,version:p.string}),productId:p.string,retailerProductId:p.string,name:p.string,brand:p.string,available:p.bool,isInCurrentCatalog:p.bool,quantityInBasket:p.number,maxQuantityReached:p.bool,expectedLife:p.number,minimumLife:p.number,ageRestriction:p.number,restrictedVisibility:p.string,timeRestricted:p.bool,promotions:p.array,favorite:p.shape({lastBought:p.string}),size:p.shape({value:p.oneOfType([p.string,p.number]),catchWeight:p.bool}),price:p.shape({unit:p.shape({current:Ye,label:p.string}),original:Ye,current:Ye,gross:Ye}),hideOnViewports:p.arrayOf(p.string),cmsProductAttributes:p.arrayOf(p.string),additionalProductCharge:p.shape({amount:p.string,currency:p.string}),hfssDisplayRestrictionGroup:p.string,quantityRestrictionGroup:p.shape({quantityRestrictionGroupId:p.string,contribution:p.number})},ml=p.shape(Sat),qA=e=>{e.style.overflow="hidden"},Cat={isOverlayVisible:!1,setIsOverlayVisible:()=>{}},uN=h.createContext(Cat),Tat=({children:e})=>{const[t,n]=h.useState(!1);return s.jsx(uN.Provider,{value:{isOverlayVisible:t,setIsOverlayVisible:n},children:e})},o9=()=>h.useContext(uN),r9=()=>typeof window<"u"&&parseInt(window.getComputedStyle(document.body).fontSize)||14,lB=e=>{const t=r9();return`${(typeof e=="number"?e:parseFloat(e.replace("rem","")))*t}`},uT=e=>{const t=r9(),n=typeof e=="number"?e:parseInt(e.replace("px",""));return 1/t*n+"rem"},_at=parseFloat(uT(52)),vat=parseFloat(uT(Ny)),KA=e=>{if(typeof document>"u")return;const t=document.documentElement.querySelector("header"),n=t?t.offsetHeight:0,o=e?0:parseFloat(lB(_at)),r=parseFloat(lB(vat)),a=window.scrollY;let i;const l=o+r;a<l?i=n+(l-a):i=n,i=Math.max(i,n),document.documentElement.style.setProperty("--salt-popover-y-offset",uT(i))},a9=e=>{typeof document>"u"||document.documentElement.style.setProperty("--salt-popover-z-index",e?"var(--z-index-nav-menu)":"var(--z-index-dropdown))")},i9=({data:e})=>e.content.contentBlocks,pN=V(i9,({blocks:e})=>e),mN=V(i9,({blocks:e,...t})=>t),hN=e=>V(pN,t=>t.find(n=>n.type===e)||{}),Kg=e=>V(pN,t=>{const{id:n,name:o,content:r}=t.find(a=>a.type===e)||{};return!n||!o||!r}),Aat=e=>V(pN,t=>{const{content:n}=t.find(o=>o.type===e)||{};return!(n?.images.length&&n?.images.find(o=>o.imageAlignment==="CENTER"))}),l9=e=>{document.documentElement?.style.setProperty("--_popover-scroll-offset",uT(e?0:window.scrollY))},of=e=>e instanceof HTMLElement,bat=({onOpen:e,onClose:t,...n})=>{const o=h.useRef({}),r=E(g=>g.control.modal),a=E(Kg("HEADER")),i=Object.values(r).some(g=>g.isOpen),{isOverlayVisible:l}=o9(),c=g=>{o.current[g.id]=window.getComputedStyle(g).overflow},d=g=>{g.style.overflow=o.current[g.id]??""},u=()=>{const g=document.querySelector("#modal-body"),f=document.querySelector("#nav-pane-0");l&&of(f)&&(c(f),qA(f)),i&&of(g)&&(c(g),qA(g)),i||KA(a),a9(i||l),l9(i),e?.()},m=()=>{const g=document.querySelector("#modal-body"),f=document.querySelector("#nav-pane-0");of(f)&&d(f),of(g)&&d(g),t?.()};return s.jsx(_u.DropdownSelect,{portalContainerSelector:"#modal",onOpen:u,onClose:m,...n})},xat=e=>{const{formatMessage:t}=M(),{a11y:n,...o}=e,a={labels:{...{labels:{"progressive-disclosure-unselected":t("salt.radio-group.progressive-disclosure.unselected.a11y.label"),"progressive-disclosure-selected":t("salt.radio-group.progressive-disclosure.selected.a11y.label")}}.labels,...n?.labels}};return s.jsx(_u.RadioGroup,{...o,a11y:a})},mt={..._u,Checkbox:_u.Checkbox,CheckboxList:_u.CheckboxList,DropdownSelect:bat,RadioGroup:xat,TextField:_u.TextField},gN=()=>{const e=F();return{sendAddToWishListEvent:a=>{const i=U.analyticsEvent({type:xl.GA_ADD_TO_WISHLIST,...a});e(i);const l={event:"add_to_wishlist",type:a.eventType,ecommerce:a.ecommerce};J.sendEvent({GA:l,WA:null})},sendRemoveFromWishListEvent:a=>{const i=U.analyticsEvent({type:xl.GA_REMOVE_FROM_WISHLIST,...a});e(i);const l={event:"remove_from_wishlist",type:a.eventType,id:a.id,index:a.index,list:a.list,name:a.name,quantity:a.quantity};J.sendEvent({GA:l,WA:null})},sendCreateListEvent:()=>{const a=U.analyticsEvent({type:xl.GA_CREATE_LIST,event:"create_list"});e(a);const i={event:"create_list"};J.sendEvent({GA:i,WA:null})},sendDeleteListEvent:()=>{const a=U.analyticsEvent({type:xl.GA_DELETE_LIST,event:"delete_list"});e(a);const i={event:"delete_list"};J.sendEvent({GA:i,WA:null})}}},Rat=({className:e,defaultValue:t})=>{const n=M(),[o,r]=h.useState(""),a=Cs("productlist-chars-allowed-v2")||".*",i=({target:c})=>{if(c.value==="")return;const d=$C(n.formatMessage("shopping.list.create.invalid.name"))(c.value);d?c.setCustomValidity(d):c.setCustomValidity("")},l=c=>{c.preventDefault();const d=c.target;if(d instanceof HTMLInputElement)if(d.validity.valueMissing){const u=n.formatMessage("validation.msg.required");r(u)}else if(d.validity.patternMismatch){const u=n.formatMessage("shopping.list.create.invalid.name");r(u)}else d.validity.customError&&r(d.validationMessage)};return s.jsx(mt.TextField,{required:!0,"data-pii":"true",maxLength:200,errorMessage:o,className:e,name:"shopping-list",onChange:i,pattern:a,onInvalid:l,"data-test":"list-name-input",defaultValue:t,onReset:()=>r(""),additionalText:n.formatMessage("shopping.list.char.validation.message"),placeholder:n.formatMessage("shopping.lists.form.create.list.name.placeholder"),clearButton:{ariaLabel:n.formatMessage("salt.form.text-field.clear-button.a11y.label")},label:{text:n.formatMessage("shopping.lists.form.create.list.name.placeholder"),isVisuallyConcealed:!1}})},Dat=Fd(`
    mutation ShoppingListCreate($shoppingListCreateInput: ShoppingListCreateInput!) {
        shoppingListCreate(shoppingListCreateInput: $shoppingListCreateInput) {
            shoppingList {
                __typename
                shoppingListId
            }
            success
            failureReason
        }
    }
`),Oat=({condensed:e,onSubmit:t})=>{const{formatMessage:n}=M(),o=h.useRef(null),[{fetching:r},a]=Qv(Dat),i=ts(),l=gN(),c=async d=>{d.preventDefault();const m=new FormData(d.currentTarget).get("shopping-list"),{data:g,error:f}=await a({shoppingListCreateInput:{name:String(m),productIds:[]}});if(g?.shoppingListCreate?.success&&g?.shoppingListCreate?.shoppingList){const{shoppingListId:y}=g.shoppingListCreate.shoppingList;i({type:yn.LIST_CREATED,listId:y}),l.sendCreateListEvent()}if(!g?.shoppingListCreate?.success&&g?.shoppingListCreate?.failureReason){const{failureReason:y}=g.shoppingListCreate;let I="request.error.title";if(y===lF.ListNameInvalid){const S=o.current?.elements.namedItem("shopping-list");if(S instanceof HTMLInputElement){S.setCustomValidity(n("shopping.list.create.invalid.name")),S.reportValidity();return}}y===lF.MaxListsReached&&(I="shopping.list.max.lists.reached"),z.error(I)}f&&!g?.shoppingListCreate&&z.error("request.error.title"),t?.(),o.current?.reset()};return s.jsxs(mt,{ref:o,id:"list-form",onSubmit:c,children:[s.jsx(Rat,{className:"salt-m-b--2"}),s.jsx(b,{className:e?"":"salt-m-t--8",fill:!0,type:"submit",intent:"primary",loading:r,"data-test":"create-shopping-list-button",children:s.jsx(b.Text,{children:n("shopping.lists.form.create.submit.button")})})]})},Pat=()=>{const[e,t]=h.useState(!1),n=()=>{t(o=>!o)};return e?s.jsxs("div",{className:"salt-m-y--4",children:[s.jsx(P,{className:"salt-d--block salt-m-b--2",bold:!0,children:s.jsx(v,{id:"shopping.lists.action.modal.create.title"})}),s.jsx(Oat,{condensed:!0,onSubmit:n})]}):s.jsxs(_8,{className:"salt-m-b--2",onClick:n,"data-test":"shopping-list-modal-create-list",children:[s.jsx(P,{size:"l",children:s.jsx(v,{id:"shopping.lists.modal.create.list.toggle.button"})}),s.jsx(T8,{children:s.jsx(me,{height:20,width:20,name:"plus"})})]})},Nat=({messageType:e,productName:t})=>{const{formatMessage:n}=M(),o=met[e];return s.jsx(Ee,{"data-test":"shopping.lists.modal.sr.alert",children:n(o,{productName:t})})},c9=ee("ADD_FAVORITE"),d9=ee("REMOVE_FAVORITE"),Lat=e=>t=>t({type:"API",payload:{service:"customerfavorites",pathPrefix:{client:"/api/customer-favorites",server:"/core-api"},url:`/v1/customers/favorites/${e}`,options:{method:"PUT"},...c9}}),kat=e=>t=>t({type:"API",payload:{service:"customerfavorites",pathPrefix:{client:"/api/customer-favorites",server:"/core-api"},url:`/v1/customers/favorites/${e}`,options:{method:"DELETE"},...d9}}),u9={addFavorite:Lat,removeFavorite:kat,types:{ADD_FAVORITE:c9,REMOVE_FAVORITE:d9}},Mat=({productId:e,retailerProductId:t})=>async n=>{try{await n(u9.addFavorite(e)),n(Ft.updateProducts({product:[{productId:e,favorite:{}}]}));const o={event:"event",eventAction:"ManualAddToFavorites",eventCategory:"FAVORITES",eventLabel:t};J.sendEvent({GA:o,WA:null})}catch{z.error("favorite.add.item.error")}},jat=({productId:e,retailerProductId:t})=>async n=>{try{await n(u9.removeFavorite(e)),n(Ft.updateProducts({product:[{productId:e,favorite:void 0}]}));const o={event:"event",eventAction:"ManualRemoveFromFavorites",eventCategory:"FAVORITES",eventLabel:t};J.sendEvent({GA:o,WA:null})}catch{z.error("favorite.remove.item.error")}},cB={addToFavorites:Mat,removeFromFavorites:jat},wat=T(P)`
    color: var(--intent-primary);
`,EN=({onClick:e,itemName:t,highlight:n,newlyAdded:o,type:r,productName:a})=>{const{formatMessage:i}=M(),l=()=>{switch(r){case"list":return n?i("shopping.lists.modal.product.list.remove",{productName:a}):i("shopping.lists.modal.product.list.add",{productName:a});case"reg":return n?i("shopping.lists.modal.product.reg.remove",{productName:a}):i("shopping.lists.modal.product.reg.add",{productName:a});default:return n?i("shopping.lists.modal.product.fav.remove",{productName:a}):i("shopping.lists.modal.product.fav.add",{productName:a})}},c=()=>{switch(r){case"list":return n?"list":"list_outline";case"reg":return n?"regulars":"regulars_outline";default:return n?"favourites":"favourites_add"}};return s.jsxs(_8,{onClick:e,"data-test":"fop-modal-add-remove-item-to-list",children:[s.jsx(P,{size:"l","data-pii":"true","data-test":"list-modal-list-item-title",children:t}),s.jsxs(se,{as:"span",wrap:"nowrap",children:[n&&o&&s.jsx(wat,{className:"salt-p-t--1 salt-p-l--1","data-test":"list-modal-newly-added",children:i("shopping.lists.modal.added")}),s.jsx(T8,{children:s.jsx(me,{primary:n,name:c(),"aria-label":l()})})]})]})},Fat=({isFavorite:e,productName:t,productId:n,retailerProductId:o,page:r,section:a,productIndex:i,onAddSuccess:l,onRemoveSuccess:c,seller:d})=>{const{formatMessage:u}=M(),m=F(),[g,f]=h.useState(!1),{sendAddToWishListEvent:y,sendRemoveFromWishListEvent:I}=gN(),S=async()=>{await m(cB.addToFavorites({productId:n,retailerProductId:o})),f(!0),l?.(),y({eventType:"favorites",ecommerce:{items:[{item_id:o,item_name:t,index:i,quantity:1,item_list_name:Ws(r,null,a)??"",seller_id:d?.id||null}]}})},C=async()=>{await m(cB.removeFromFavorites({productId:n,retailerProductId:o})),f(!1),c?.(),I({eventType:"favorites",id:o,name:t,index:i,quantity:1,list:Ws(r,null,a)??""})},_=async()=>{e?C():S()};return s.jsx(Ve.Item,{children:s.jsx(EN,{itemName:u("shopping.lists.modal.fav.name"),type:"fav",onClick:_,newlyAdded:g,highlight:e,productName:t})})},Bat=({productName:e,productId:t,regular:n,retailerProductId:o,page:r,productIndex:a,section:i,beforeOpeningAddToRegularsModal:l})=>{const{formatMessage:c}=M(),[d]=fe([Ud]),u=WZe(),m=()=>{u({productId:t,retailerProductId:o,productName:e,regular:n,page:r,section:i,productIndex:a,beforeOpeningAddToRegularsModal:l})};return d?s.jsx(Ve.Item,{children:s.jsx(EN,{itemName:c("shopping.lists.modal.reg.name"),type:"reg",onClick:m,newlyAdded:!1,highlight:!!n,productName:e})}):null},Uat=Fd(`
    mutation ShoppingListAddProduct($shoppingListAddProductInput: ShoppingListAddProductInput!) {
        shoppingListAddProduct(shoppingListAddProductInput: $shoppingListAddProductInput) {
            shoppingList {
                __typename
            }
            success
            failureReason
        }
    }
`),Gat=Fd(`
    mutation ShoppingListRemoveProduct(
        $shoppingListRemoveProductInput: ShoppingListRemoveProductInput!
    ) {
        shoppingListRemoveProduct(shoppingListRemoveProductInput: $shoppingListRemoveProductInput) {
            shoppingList {
                __typename
            }
            success
        }
    }
`),$at=({modalProductId:e,productName:t,shoppingList:n,retailerProductId:o,seller:r,page:a,productIndex:i,section:l,onAddSuccess:c,onRemoveSuccess:d})=>{const u=F(),[{fetching:m},g]=Qv(Uat),[{fetching:f},y]=Qv(Gat),I=!!n.products.find(B=>B.productId===e),S=Cs("productlist-max-list-item-count"),[C,_]=h.useState({newlyAdded:!1,highlight:I}),A=ts(),{sendAddToWishListEvent:x,sendRemoveFromWishListEvent:R}=gN(),{shoppingListId:O,name:N}=n,k=async()=>{await u(Ci({products:[{id:e}],ignoreProductCache:!0,updateProducts:!0}))},j=async()=>{_({newlyAdded:!0,highlight:!0});const{data:B,error:W}=await g({shoppingListAddProductInput:{shoppingListId:O,productId:e}});if(B?.shoppingListAddProduct?.success&&(c?.(),await k(),A({type:yn.PRODUCT_ADDED_TO_LIST,listId:O,productId:e,retailerProductId:o}),x({eventType:"shopping_list",ecommerce:{items:[{item_id:o,item_name:t,index:i,quantity:1,item_list_name:Ws(a,null,l)??"",seller_id:r?.id||null}]}})),!B?.shoppingListAddProduct?.success&&B?.shoppingListAddProduct?.failureReason){_({newlyAdded:!1,highlight:!1});const{failureReason:$}=B.shoppingListAddProduct,K=$===j9e.MaxProductsReached?{key:"shopping.list.max.products.in.list",substitutions:{maxProducts:S}}:"request.error.title";z.error(K)}W&&!B?.shoppingListAddProduct&&(_({newlyAdded:!1,highlight:!1}),z.error("request.error.title"))},w=async()=>{_({newlyAdded:!1,highlight:!1});const{data:B}=await y({shoppingListRemoveProductInput:{shoppingListId:O,productId:e}});B?.shoppingListRemoveProduct?.success?(d?.(),await k(),A({type:yn.PRODUCT_REMOVED_FROM_LIST,listId:O,productId:e,retailerProductId:o}),R({eventType:"shopping_list",id:o,name:t,index:i,quantity:1,list:Ws(a,null,l)??""})):(_({newlyAdded:!1,highlight:!0}),z.error("request.error.title"))},L=async()=>{m||f||(I?await w():await j())};return s.jsx(Ve.Item,{children:s.jsx(EN,{type:"list",itemName:N,newlyAdded:C.newlyAdded,highlight:C.highlight,productName:t,onClick:L})})},Hat=Fd(`
    query GetShoppingListsForListsModal {
        shoppingLists {
            shoppingListId
            name
            products {
                productId
            }
        }
    }
`),Vat={additionalTypenames:["ShoppingList"]},Yat=({modalProductId:e,productName:t,retailerProductId:n,seller:o,page:r,section:a,productIndex:i,onAddSuccess:l,onRemoveSuccess:c})=>{const[{data:d,fetching:u,error:m}]=GI({query:Hat,context:Vat});return u?s.jsxs(h.Fragment,{children:[s.jsx(Pe,{className:"salt-m-b--2",height:"50px"}),s.jsx(Pe,{className:"salt-m-b--2",height:"50px"}),s.jsx(Pe,{className:"salt-m-b--2",height:"50px"})]}):!d?.shoppingLists.length||m?null:s.jsx(h.Fragment,{children:d.shoppingLists.map(g=>s.jsx($at,{shoppingList:g,productName:t,modalProductId:e,retailerProductId:n,seller:o,page:r,productIndex:i,section:a,onAddSuccess:l,onRemoveSuccess:c},g.shoppingListId))})},Wat=({product:e,page:t,section:n,productIndex:o,handleShowBackArrow:r})=>{const[a,i]=h.useState(null),{productId:l,name:c,retailerProductId:d,regular:u,favorite:m,image:g,seller:f,restrictedVisibility:y}=e;return s.jsxs(h.Fragment,{children:[s.jsx("div",{"data-test":"screen-reader-alert","aria-live":"polite",children:a&&s.jsx(Nat,{messageType:a,productName:c})}),s.jsx(v8,{productName:c,imageUrl:g.src,restrictedVisibility:y}),s.jsx(Pat,{}),s.jsxs(Ve,{inline:!1,children:[s.jsx(Fat,{isFavorite:!!m,productId:l,productName:c,retailerProductId:d,page:t,productIndex:o,section:n,seller:f,onAddSuccess:()=>i("FAVORITE_ADDED"),onRemoveSuccess:()=>i("FAVORITE_REMOVED")}),s.jsx(Bat,{regular:u,productId:l,productName:c,retailerProductId:d,page:t,productIndex:o,section:n,beforeOpeningAddToRegularsModal:r}),s.jsx(Yat,{modalProductId:l,productName:c,retailerProductId:d,page:t,productIndex:o,section:n,seller:f,onAddSuccess:()=>i("LIST_ADDED"),onRemoveSuccess:()=>i("LIST_REMOVED")})]})]})},dB="shopping-lists-modal-header",qat=({isOpen:e,productId:t,page:n,section:o,productIndex:r,handleShowBackArrow:a})=>{const i=F(),l=E(y=>sl(y,t)),c=E(y=>Hze(y,l?.productId||"")),[d]=fe(["m.la.h"]),u=ts(),m=!!l,g=()=>{i(Z.closeModal())};h.useEffect(()=>{e&&m&&u({type:yn.ADD_TO_FEATURE_MODAL_DISPLAYED,productId:l.productId,retailerProductId:l.retailerProductId})},[e,m]);const f=()=>m?s.jsx(Wat,{product:{...l,...c&&{regular:c}},page:n,section:o,productIndex:r,handleShowBackArrow:a}):null;return s.jsxs(G,{isOpen:e,onRequestClose:g,aria:{labelledby:dB},children:[s.jsx(G.Header,{align:d?"left":"center",className:"salt-p-x--4",children:s.jsx(ne,{as:"h2",id:dB,children:s.jsx(v,{id:"shopping.lists.modal.heading"})})}),s.jsx(G.Body,{className:"salt-p-x--4 salt-p-t--0",children:f()})]})},uB="shoppingLists",fN=()=>{const e=F(),t=E(Ue(uB)),n=E(Vo(uB)),[o,r]=h.useState(!1),a=()=>r(!0),i=l=>{r(!1),e(LC({productId:""})),e(Z.openModal("shoppingLists",l))};return s.jsxs(h.Fragment,{children:[s.jsx(qat,{isOpen:t,productId:n?.productId,page:n?.page,section:n?.section,productIndex:n?.productIndex,handleShowBackArrow:a}),s.jsx(vP,{onModalRequestClose:()=>r(!1),onBackArrowClick:o?i:void 0,onSuccess:o?i:void 0})]})},p9=()=>De`
    font-family: var(--alt-product-price-font-family, var(--font-family));
    font-weight: var(--alt-product-price-font-weight, 600);
`,Kat=T(nt.Price)`
    ${p9}
`,zat=T(nt.StrikethroughPrice)`
    ${p9}
`,m9=T.div`
    padding: var(--salt-spacing-2);
    ${nN};
    position: relative;
    overflow: hidden;
    inline-size: 100%;

    .inner-container {
        display: flex;
        gap: var(--salt-spacing-1);
    }

    .image-container {
        ${oN}
    }

    .body-container {
        inline-size: 100%;
        display: grid;
        gap: var(--salt-spacing-1);
        grid-area: footer;
        grid-template-areas: 'header-container footer-container';
        grid-template-columns: 1fr ${R$(170)};
        position: relative;
    }

    .header-container {
        flex: 1;
        border-radius: var(--salt-radius-0);
        display: flex;
        flex-direction: column;
        gap: var(--salt-spacing-1);
        grid-area: header-container;
        justify-content: space-between;
    }

    .footer-container {
        border-radius: var(--salt-radius-0);
        display: flex;
        flex-direction: column;
        -webkit-box-pack: end;
        justify-content: end;
        gap: var(--salt-spacing-1);
        grid-area: footer-container;
        position: relative;
    }

    .price-container {
        overflow: hidden;
        align-self: start;
        display: flex;
        align-items: flex-end;
        gap: var(--salt-spacing-1);

        > * {
            flex-direction: column-reverse;
            gap: 0;
        }
    }

    .title-container {
        ${rN};
    }

    .promotion-container {
        ${aN};
    }
`,Qat=()=>{const{sendFopImpressionEvent:e,onFopContainerClick:t}=tN(),{config:n,product:{productId:o,alcohol:r},hasBeenViewed:a,displayLandscapeLayout:i}=qt(),l=n?.landscape.image?.link;h.useEffect(()=>{e()},[a]);const c=i?n?.landscape?.controlsContainer?.size:n?.portrait?.controlsContainer?.size;return s.jsx(m9,{config:n,layoutType:Ps.Portrait,"data-test":"configurable-list-item-layout",onClick:t,displayLandscapeLayout:!1,children:s.jsx(pc,{isActive:r,overlay:s.jsx(Yd,{buttonWidth:170}),children:s.jsxs("div",{className:"inner-container","data-test":`fop-wrapper:${o}`,"data-retailer-anchor":"fop-item",children:[s.jsx(qg,{isHyperlink:l,children:s.jsx("div",{className:"image-container",children:s.jsx(zQ,{})})}),s.jsxs("div",{className:"body-container",children:[s.jsxs("div",{className:"header-container",children:[s.jsx("div",{className:"title-container",children:s.jsx(KQ,{})}),s.jsx("div",{className:"promotion-container","data-retailer-anchor":"fop-promotions",children:s.jsx(sN,{fullWidth:!1})}),s.jsx(VA,{}),s.jsx(dN,{})]}),s.jsxs("div",{className:"footer-container",children:[s.jsxs("div",{className:"price-container",children:[s.jsx(cN,{showCatchWeight:!1}),s.jsx(lN,{})]}),s.jsx(e9,{size:c})]})]})]})})})},Xat=()=>{const{config:e}=qt();return s.jsx(m9,{config:e,layoutType:Ps.Portrait,"data-test":"configurable-list-item-skeleton",displayLandscapeLayout:!1,children:s.jsxs("div",{className:"inner-container",children:[s.jsx("div",{className:"image-container",children:s.jsx(bl,{})}),s.jsxs("div",{className:"body-container",children:[s.jsxs("div",{className:"header-container",children:[s.jsx("div",{className:"title-container",children:s.jsx(bl,{variant:"textS",fill:50})}),s.jsx("div",{className:"promotion-container",children:s.jsx(bl,{variant:"textS",fill:25})}),s.jsx(bl,{variant:"textS",fill:25}),s.jsx(bl,{variant:"textS",fill:25})]}),s.jsxs("div",{className:"footer-container",children:[s.jsx("div",{className:"price-container",children:s.jsx(Qc,{height:"15px",width:"100px"})}),s.jsx(_Q,{fill:!0})]})]})]})})},Zat={portrait:{title:{numberOfLines:1}},landscape:{image:{resolution:{height:94,width:94}}}},h9=e=>{const{productId:t,loading:n,page:o,product:r}=e,a=ZP({page:o,productId:t,product:r});return E(Yt)&&!a||!n&&!a?null:s.jsx(aT,{product:a,...e,overrideConfig:Zat,children:n?s.jsx(Xat,{}):s.jsx(Qat,{})})},pB={position:"ownLine",style:"default"},g9={landscape:{promotion:null,referencePrice:null,footerContainer:{inBasketBackground:!1},controlsContainer:pB},portrait:{promotion:null,referencePrice:null,footerContainer:{inBasketBackground:!1},controlsContainer:pB}},dI={SINGLE_LINE:"SINGLE_LINE",MULTI_LINE:"MULTI_LINE"},Ol={IMAGE:"IMAGE",TEXT:"TEXT",RATING:"RATING"},E9=p.arrayOf(p.shape({type:p.oneOf(Object.values(dI)),attributes:p.arrayOf(p.oneOfType([p.shape({type:p.oneOf([Ol.TEXT]),text:p.string.isRequired,accessibility:p.string.isRequired,chipType:p.oneOf(["primary","utility","offer","action"]).isRequired}),p.shape({type:p.oneOf([Ol.IMAGE]),icon:p.string.isRequired,label:p.string.isRequired}),p.shape({type:p.oneOf([Ol.RATING])})]))})),Jat={attributeGroups:E9,productId:p.string},eit={attributeGroups:[],productId:""},zA=e=>e==="primary"||e==="promotion"?"secondary":e==="secondary"?"tertiary-contrast":"action",yN=({attributeGroups:e,productId:t})=>{if(!e||e.length===0||!t)return null;const n=a=>{switch(a.type){case Ol.IMAGE:return a.icon?s.jsx(nt.ProductAttribute,{title:a.label,name:a.icon},a.label):null;case Ol.TEXT:return a.text?s.jsx(Fn,{intent:zA(a.chipType),title:a.accessibility,text:a.text,singleLine:!0},`${a.text}-${t}`):null;default:return null}},o=a=>{switch(a.type){case Ol.TEXT:return a.text?s.jsx(Fn,{intent:zA(a.chipType),title:a.accessibility,text:a.text},`${a.text}-${t}`):null;case Ol.RATING:return s.jsx(TQ,{productId:t},`${a.text}-${t}`);default:return null}},r=(a,i)=>{switch(a.type){case dI.MULTI_LINE:return s.jsx(nt.ProductAttributes,{multiLine:!0,children:a.attributes.map(o)},`attribute-group-${i}`);case dI.SINGLE_LINE:default:return s.jsx(nt.ProductAttributes,{children:a.attributes.map(n)},`attribute-group-${i}`)}};return e.map(r)};yN.propTypes=Jat;yN.defaultProps=eit;const tit=T(Ce)`
    block-size: 100%;
`,IN=p.shape({alert:p.bool,type:p.string,message:p.string}),f9=({status:e})=>s.jsx(nt.Status,{children:s.jsx(tit,{intent:e.type,size:"s","data-test":"fop-status","aria-live":"polite",text:e.message})}),y9=({status:e})=>s.jsx(nt.Status,{children:s.jsxs(P,{size:"lg",className:"salt-d--block salt-m-t--1","data-test":"fop-status",children:[e.message,"123 321 123"]})}),I9={status:IN.isRequired};f9.propTypes=I9;y9.propTypes=I9;const SN=({status:e})=>e?e.alert?s.jsx(f9,{status:e}):s.jsx(y9,{status:e}):s.jsx(nt.Status,{});SN.propTypes={status:IN};SN.defaultProps={status:void 0};const S9=p.shape({requiredProductQuantity:p.number.isRequired,addedProductQuantity:p.number.isRequired,toAddProductQuantity:p.number.isRequired,missedPromotionTextAlternative:p.string.isRequired,onMissedPromotionTextChange:p.func}),{getPercentageFromFractionString:sit}=ga,oy=30,nit=44,oit=T.div`
    display: flex;
    block-size: ${H(nit)};
`,rit=T.div`
    color: var(--intent-content);
    align-self: center;
    block-size: ${H(oy)};
`,C9=({fopMissedPromotion:e,children:t})=>{const{requiredProductQuantity:n,addedProductQuantity:o,toAddProductQuantity:r,onMissedPromotionTextChange:a}=e;h.useEffect(()=>a(),[o]);const i=r===0,l=i?"":`${o}/${n}`;return s.jsxs(oit,{"data-test":"missed-promotion",children:[s.jsx(rit,{children:i?s.jsx(me,{name:"status_yes",height:oy,width:oy,success:!0}):s.jsx(oc,{colorName:"action",progressValue:sit(l),autoProgress:!1,size:oy,children:s.jsx(P,{size:"s",bold:!0,children:l})})}),s.jsx("div",{className:"salt-m-l--1",children:t})]})};C9.propTypes={fopMissedPromotion:S9.isRequired,children:p.node.isRequired};const ait={actions:p.shape({breadcrumbsDropdownOnOpen:p.func,breadcrumbsClickAction:p.func}),breadcrumbsVisible:p.bool.isRequired,breadcrumbsItems:p.arrayOf(p.shape({id:p.string.isRequired,name:p.string.isRequired,link:p.string.isRequired})),breadcrumbsChild:p.shape({id:p.string.isRequired,name:p.string.isRequired,link:p.string.isRequired}),breadcrumbsText:p.shape({message:p.string.isRequired,link:p.string}),breadcrumbsMenuAccessibilityLabel:p.string,firstInGroup:p.bool,linkElement:p.oneOfType([p.string,p.func,p.elementType]),productId:p.string},iit={actions:{},breadcrumbsItems:[],breadcrumbsChild:null,breadcrumbsText:null,breadcrumbsMenuAccessibilityLabel:null,firstInGroup:!1,productId:void 0,linkElement:void 0};class pT extends h.Component{constructor(t){super(t),this.state={isBreadcrumbDropdownOpen:!1},this.breadcrumbsDropdownElement=ie.createRef(),this.closeBreadCrumbMenu=this.closeBreadCrumbMenu.bind(this),this.handleClickOutsideBreadCrumbMenu=this.handleClickOutsideBreadCrumbMenu.bind(this),this.toggleBreadCrumbMenu=this.toggleBreadCrumbMenu.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}componentDidMount(){document.addEventListener("mousedown",this.handleClickOutsideBreadCrumbMenu)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutsideBreadCrumbMenu)}handleClickOutsideBreadCrumbMenu(t){const n=this.breadcrumbsDropdownElement;this.state.isBreadcrumbDropdownOpen&&n&&n.current&&!n.current.contains(t.target)&&this.closeBreadCrumbMenu()}handleKeyDown(t){t.key==="Escape"&&this.closeBreadCrumbMenu()}closeBreadCrumbMenu(){this.setState({isBreadcrumbDropdownOpen:!1})}toggleBreadCrumbMenu(){this.setState(t=>({isBreadcrumbDropdownOpen:!t.isBreadcrumbDropdownOpen}),()=>{this.state.isBreadcrumbDropdownOpen&&this.props.actions.breadcrumbsDropdownOnOpen&&this.props.actions.breadcrumbsDropdownOnOpen()})}render(){const{breadcrumbsVisible:t,breadcrumbsItems:n,breadcrumbsChild:o,breadcrumbsText:r,breadcrumbsMenuAccessibilityLabel:a,firstInGroup:i,linkElement:l,actions:c,productId:d}=this.props;if(!t)return null;if(!i)return s.jsx(nt.BreadcrumbHeader,{});const u=l?Qe:rt;if(r)return s.jsx(nt.BreadcrumbHeader,{children:s.jsx(nt.BreadcrumbText,{display:"inline-block",children:r.link?s.jsx(u,{standalone:!0,onClick:()=>{c.breadcrumbsClickAction(0)},to:l&&r.link,href:!l&&r.link,title:r.message,children:r.message}):r.message})});if(!o||!o.name||!n||n.length===0)return s.jsx(nt.BreadcrumbHeader,{});const m=`fop-breadcrumbs-${d}`,g=`fop-breadcrumbs-menu-${d}`;return s.jsxs(nt.BreadcrumbHeader,{onKeyDown:this.handleKeyDown,children:[s.jsxs(nt.BreadcrumbDropdown,{className:"salt-d--inline-block",ref:this.breadcrumbsDropdownElement,children:[s.jsxs(nt.BreadcrumbDropdownButton,{"aria-controls":g,"aria-expanded":this.state.isBreadcrumbDropdownOpen?!0:null,"aria-haspopup":"true",type:"button","data-toggle":"true",height:20,id:m,open:this.state.isBreadcrumbDropdownOpen,width:20,onClick:this.toggleBreadCrumbMenu,"data-test":"fop-breadcrumbs-button",children:[s.jsx(me,{height:20,width:20,name:"more","aria-hidden":"true"}),s.jsx(Ee,{children:a})]}),s.jsx(Ot.Body,{isOpen:this.state.isBreadcrumbDropdownOpen,fullWidth:!0,textWrap:!0,children:s.jsx(Ot.Content,{children:s.jsx(Ve,{id:g,"aria-labelledby":m,children:n.map((f,y)=>s.jsx(Ve.Item,{children:s.jsx(P,{children:s.jsx(u,{title:f.name,to:l&&f.link,href:!l&&f.link,onClick:()=>{this.closeBreadCrumbMenu(),c.breadcrumbsClickAction(y,f.id)},children:f.name})})},f.id))})})})]}),s.jsx(me,{height:18,width:18,name:"arrow_right"}),s.jsx(nt.BreadcrumbText,{size:"md",display:"inline-block",breadcrumbChild:!0,children:s.jsx(u,{to:l&&o.link,href:!l&&o.link,onClick:()=>{const f=n.length-1;c.breadcrumbsClickAction(f,n[f].id)},title:o.name,children:o.name})})]})}}pT.propTypes=ait;pT.defaultProps=iit;const{PlaceholderImage:lit}=oMe,cit={src:p.string,alt:p.string.isRequired,title:p.string.isRequired},dit={src:void 0},mT=e=>{const{src:t,alt:n,title:o,...r}=e;return s.jsx(Vd,{threshold:300,alt:n,src:t,title:o,placeholder:s.jsxs("div",{children:[s.jsx(Ee,{children:n}),s.jsx(lit,{className:"salt-d--inline-block",width:"100%",height:"100%"})]}),...r})};mT.propTypes=cit;mT.defaultProps=dit;mT.displayName="BaseImage";Vd.displayName="LazyLoadImage";const T9={attributes:E9,countryOfOrigin:p.shape({a11yPrefix:p.string.isRequired,country:p.string.isRequired,title:p.string.isRequired}),topAttributes:p.arrayOf(p.shape({type:p.string,value:p.oneOf([p.string,p.shape({text:p.string,accessibility:p.string})])})),name:p.string,bopLink:p.string,image:p.shape({src:p.string,description:p.string,alt:p.string,fopSrcset:p.string}),offer:p.shape({icon:p.string,message:p.string,url:p.string,presentationMode:p.string,requiredProductQuantity:p.number}),price:p.shape({original:p.string,current:p.string,type:p.string,gross:p.string}),size:p.shape({value:p.oneOfType([p.string,p.number]),pricePer:p.string,subtext:p.string}),status:IN,quantityInOrder:p.shape({quantity:p.number,message:p.string}),loading:p.bool,controls:p.shape({type:p.string,counter:p.shape({updateBasketQuantity:p.func,plusDisabled:p.bool,minusDisabled:p.bool,value:p.number,addText:p.string,addTextAlternative:p.string,increaseQuantityTextAlternative:p.string,decreaseQuantityTextAlternative:p.string,editQuantityTextAlternative:p.string,quantityDescriptionTextAlternative:p.string,getQuantityDescriptionTextAlternative:p.func,action:p.func,max:p.oneOfType([p.number,p.string]),addInfo:p.bool,addIcon:p.string}),navigation:p.shape({action:p.func,text:p.string,url:p.string}),custom:p.element,action:p.shape({onClick:p.func,text:p.string,appearance:p.oneOf(["primary","secondary","action"])})}),active:p.bool,overlay:p.bool,productId:p.string,linkElement:p.oneOfType([p.string,p.func,p.elementType]),className:p.string,linkAction:p.func,inCurrentCatalog:p.bool,noOfferLink:p.bool,isInProductList:p.bool,isFavorite:p.bool,breadcrumbsVisible:p.bool,breadcrumbsItems:p.arrayOf(p.shape({id:p.string.isRequired,name:p.string.isRequired,link:p.string.isRequired})),breadcrumbsChild:p.shape({id:p.string.isRequired,name:p.string.isRequired,link:p.string.isRequired}),breadcrumbsText:p.shape({message:p.string.isRequired,link:p.string}),shoppingListsMessages:p.shape({moreOptionsTitle:p.string.isRequired,moreOptionsAccessibilityLabel:p.string.isRequired,inProductListTitle:p.string.isRequired}),breadcrumbsMenuAccessibilityLabel:p.string,firstInGroup:p.bool,actions:p.shape({promotionClickedEvent:p.func,navigateToPromotionClickedEvent:p.func,breadcrumbsDropdownOnOpen:p.func,breadcrumbsClickAction:p.func,moreOptionsClick:p.func}),catchWeightSubtextPosition:p.string,missedPromotion:S9,hideMoreOptions:p.bool,frenchLawEnabled:p.bool,configurableFopEnabled:p.bool,isFixedHeightTitleWithEllipsisFFEnabled:p.bool,onClick:p.func,onContextMenu:p.func,displayLandscapeLayout:p.bool,position:p.number,fopPositionOnPage:p.number,type:p.string,page:p.string,subPage:p.string,group:p.shape({}),grossPriceEnabled:p.bool,fopView:p.string,withoutHeader:p.bool},_9={active:!1,countryOfOrigin:void 0,name:void 0,bopLink:void 0,image:void 0,inCurrentCatalog:!1,noOfferLink:!1,attributes:void 0,offer:void 0,price:void 0,size:void 0,status:void 0,quantityInOrder:void 0,overlay:void 0,productId:void 0,loading:!1,linkAction:void 0,className:void 0,breadcrumbsVisible:!1,breadcrumbsItems:[],breadcrumbsChild:null,breadcrumbsText:null,breadcrumbsMenuAccessibilityLabel:null,firstInGroup:!1,actions:{moreOptionsClick:void 0},topAttributes:void 0,isInProductList:!1,isFavorite:!1,shoppingListsMessages:void 0,catchWeightSubtextPosition:"post",linkElement:void 0,missedPromotion:void 0,hideMoreOptions:!1,isFixedHeightTitleWithEllipsisFFEnabled:!1,frenchLawEnabled:!1,onClick:void 0,onContextMenu:void 0,position:null,fopPositionOnPage:null,subPage:null,controls:null,configurableFopEnabled:!1,type:null,page:null,group:{},grossPriceEnabled:!1,fopView:"detail",withoutHeader:!1},uit="custom",uI=44,Fc=T(nt.FixedHeightWrapper)`
    ${({withoutHeader:e})=>e&&De`
            block-size: ${H(191)};
            ${oe.smUp`
                height: ${({fitContent:t})=>t?"auto":H(404)};
            `};
        `}
    block-size: ${({fitContent:e})=>e&&"auto"}
`;Fc.displayName="FixedHeightWrapper";const v9=T(nt.FixedHeightSkeleton)`
    ${({withoutHeader:e})=>e&&De`
            && {
                inset-block-start: 0;
            }
        `}
`;v9.displayName="FixedHeightSkeleton";nt.Image=T(mT)`
    block-size: 100%;
    inline-size: 100%;
    border-radius: var(--salt-radius-default);
`;const A9=T(nt.Size)`
    display: flex;
`;A9.displayName="Size";const pit=T(nt.SizeText)`
    line-height: ${H(18)};
`,mit=T(Nh)`
    line-height: ${H(18)};
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
`,hit=T(nt.FixedHeightTitle)`
    min-block-size: calc(2em * ${$l});
    block-size: calc(2em * ${$l});
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: initial;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: block-axis;
`,Rc=T(Xn)`
    ${nt.NavigationButton}
`;Rc.displayName="NavigationButton";const git=T.div`
    margin-block-start: -${H(1)};
`,Eit=T(nt.OfferContainer)`
    block-size: ${H(uI)};
    margin-block-end: 0;
`,fit=T.div`
    position: relative;
    overflow: hidden;
    block-size: ${H(uI)};
`,yit=T.div`
    position: absolute;
    border-radius: var(--salt-radius-default);
    background: var(--intent-contrast);
    inset-block-end: ${({concealed:e})=>e?H(-uI):0};
    display: flex;
    block-size: ${H(uI)};
    inline-size: 100%;
    padding-block: 0;
    padding-inline: ${H(4)};
    overflow: hidden;
    transition-duration: 0.3s;
    transition-property: inset-block-end;
    transition-timing-function: ease-in-out;
`;let Wd=class extends h.Component{constructor(t){super(t),this.fopWrapperRef=ie.createRef(),this.onOfferClick=this.onOfferClick.bind(this)}shouldComponentUpdate(t){const n=this.props.controls.type!==t.controls.type,o=(this.props.controls.counter||{}).value!==(t.controls.counter||{}).value||(this.props.controls.counter||{}).plusDisabled!==(t.controls.counter||{}).plusDisabled,r=(this.props.controls.navigation||{}).text!==(t.controls.navigation||{}).text,a=(this.props.status||{}).type!==(t.status||{}).type||(this.props.status||{}).message!==(t.status||{}).message,i=this.props.isInProductList!==t.isInProductList,l=this.props.isFavorite!==t.isFavorite,c=JSON.stringify(this.props.topAttributes)!==JSON.stringify(t.topAttributes),d=!$i(this.props.missedPromotion,t.missedPromotion),u=!$i(this.props.fopView,t.fopView);return n||o||r||a||i||l||c||d||u}buildOfferMessage(){const{offer:t}=this.props;return s.jsx(nt.OfferText,{display:"inline","data-test":"fop-offer-text",presentationMode:t.presentationMode,children:s.jsx(P,{children:t.message})})}getOverrideConfig(){const{page:t}=this.props;return t==="regulars"?g9:{}}onOfferClick(){this.props.actions?.navigateToPromotionClickedEvent(),this.props.actions?.promotionClickedEvent()}buildOfferLink({ariaHidden:t}={}){const{offer:n,linkElement:o,inCurrentCatalog:r,noOfferLink:a}=this.props,i=this.buildOfferMessage(),l=s.jsx(nt.OfferText,{className:"salt-m-r--1 salt-d--inline-block","data-test":"fop-offer-icon",presentationMode:n.presentationMode,children:s.jsx(me,{name:n.icon,verticalAlign:"middle"})});return r&&!a?s.jsxs(nt.OfferLink,{"data-test":"fop-offer-link",href:n.url,as:o,to:n.url,onClick:this.onOfferClick,"aria-hidden":!!t,tabIndex:t&&-1,"aria-label":n.message,children:[l,i]}):s.jsxs(h.Fragment,{children:[l,i]})}buildMissedPromotionLink(){const{offer:t,linkElement:n,missedPromotion:o}=this.props,r=this.buildOfferMessage();return s.jsx(git,{children:s.jsx(nt.OfferLink,{"data-test":"fop-offer-link","aria-label":o?.missedPromotionTextAlternative,href:t.url,as:n,to:t.url,onClick:this.onOfferClick,children:s.jsx(C9,{fopMissedPromotion:o,children:r})})})}buildControls(){const{controls:t,productId:n,name:o}=this.props;if(t.type==="counter")return s.jsxs(h.Fragment,{children:[s.jsx(Ee,{"aria-live":"polite","aria-relevant":"text",children:t.counter.quantityDescriptionTextAlternative}),s.jsx(VW,{min:0,max:t.counter.max?Number(t.counter.max):t.counter.max,count:t.counter.value||0,onQuantityUpdate:t.counter.updateBasketQuantity,plusDisabled:t.counter.plusDisabled,addText:t.counter.addText,addTextAlternative:t.counter.addTextAlternative,increaseQuantityTextAlternative:t.counter.increaseQuantityTextAlternative,decreaseQuantityTextAlternative:t.counter.decreaseQuantityTextAlternative,editQuantityTextAlternative:t.counter.editQuantityTextAlternative,quantityDescriptionTextAlternative:t.counter.quantityDescriptionTextAlternative,action:t.counter.action,addInfo:t.counter.addInfo,addIcon:t.counter.addIcon,"data-synthetics":`product-id:${n}`,"data-test":"fop-counter"})]});if(t.type==="action"){const r={intent:"action",fill:!0,onClick:t.action.onClick,"data-test":"fop-action",name:o};return t.action.appearance&&(r.intent=t.action.appearance),s.jsxs(Rc,{...r,children:[s.jsx(Rc.Text,{children:t.action.text}),s.jsx(Ee,{children:r.name})]})}if(t.type==="navigation"){const r={intent:"action",fill:!0,action:!0,"data-test":"fop-navigation",onClick:t?.navigation?.action};return t?.navigation?.url?s.jsx(Rc,{...r,asChild:!0,children:s.jsx(Qe,{intent:"ghost",to:t.navigation.url,children:s.jsx(Rc.Text,{children:t.navigation.text})})}):s.jsx(Rc,{...r,children:s.jsx(Rc.Text,{children:t.navigation.text})})}return t.type===uit?t.custom:null}renderControls(){const{quantityInOrder:t}=this.props;return t&&t.quantity>0?s.jsxs(se,{wrap:"nowrap",className:"salt-m-b--1",children:[s.jsxs(nt.OrderQuantity,{title:t.message,children:[s.jsx(Ee,{children:t.message}),s.jsx("span",{"aria-hidden":"true","data-test":"quantity-in-order","data-synthetics":"quantity-in-order",children:t.quantity})]}),s.jsx(Bo,{children:this.buildControls()})]}):this.buildControls()}renderBreadcrumbs(){const{breadcrumbsVisible:t,breadcrumbsItems:n,breadcrumbsChild:o,breadcrumbsText:r,breadcrumbsMenuAccessibilityLabel:a,firstInGroup:i,linkElement:l,actions:c,productId:d}=this.props;return s.jsx(pT,{breadcrumbsChild:o,breadcrumbsItems:n,breadcrumbsText:r,breadcrumbsMenuAccessibilityLabel:a,breadcrumbsVisible:t,firstInGroup:i,linkElement:l,actions:c,productId:d})}renderMoreOptionsIcon(){const{actions:t,hideMoreOptions:n,shoppingListsMessages:o}=this.props;return n?null:s.jsx(nt.ActionsWrapper,{children:s.jsxs(b,{size:"s",intent:"tertiary",onClick:t.moreOptionsClick,"data-test":"fop-more-options","aria-label":o.moreOptionsAccessibilityLabel,children:[s.jsx(b.Icon,{name:"more"}),s.jsx(Ee,{children:o.moreOptionsTitle})]})})}renderHeader(){const{attributes:t,countryOfOrigin:n,name:o,bopLink:r,image:a,linkElement:i,linkAction:l,topAttributes:c,isInProductList:d,productId:u,shoppingListsMessages:m,frenchLawEnabled:g,displayLandscapeLayout:f}=this.props,I=((C=[])=>{const _=["outOfStock","featured","favorite","list","regular"];return[...C,{type:"list",value:null}].sort((A,x)=>_.indexOf(A.type)>_.indexOf(x.type)?1:-1).map(A=>A.type==="outOfStock"&&s.jsx(nt.OutOfStockBadge,{intent:zA(A.chipType),"data-test":"out-of-stock",title:A.text,text:A.text,singleLine:!0},`out-of-stock-${A.text}`)||A.type==="featured"&&s.jsx(Fn,{intent:"primary","date-test":"fop-featured",title:A.accessibility,text:A.text,singleLine:!0},`fop-featured-${A.text}`)||A.type==="favorite"&&s.jsx(nt.FopTopBarIcon,{name:"favourites","data-test":"fop-fav-icon",title:A.text,width:24},`fop-fav-icon-${A.text}`)||A.type==="list"&&d&&s.jsx(me,{primary:!0,width:24,name:"list","data-test":"in-product-list",title:m.inProductListTitle},"in-product-list")||A.type==="regular"&&s.jsx(nt.FopTopBarIcon,{name:"regulars","data-test":"fop-reg-icon",title:A.text,width:24},`fop-reg-icon-${A.text}`)).filter(A=>!!A)})(c),S=!!I.length;return s.jsx(nt.Header,{children:s.jsxs(nt.Media,{displayLandscapeLayout:f,children:[s.jsx(nt.ImageTopBar,{children:s.jsxs(se,{direction:"column",basis:"100%",children:[s.jsx(nt.ImageTopBarTopRow,{displayLandscapeLayout:f,children:S&&I}),n?.country&&s.jsx(nt.ImageTopBarBottomRow,{children:s.jsx(nt.ImageTopBarBottomRowInner,{hasTopBarAttributes:S,children:s.jsx(nt.CountryOfOrigin,{"data-test":"fop-country-of-origin",title:n.title,intent:"tertiary-contrast",size:g?"xl":"m",text:s.jsxs(h.Fragment,{children:[s.jsx(Ee,{children:n.a11yPrefix}),n.country]}),singleLine:!0},"fop-country-of-origin")})})]})}),!!t&&s.jsx(nt.ImageBottomBar,{displayLandscapeLayout:f,hasMultipleAttributeGroups:t.length>1,children:s.jsx(yN,{attributeGroups:t,productId:u})}),s.jsx(nt.ImageWrapper,{as:i,to:r,displayLandscapeLayout:f,"data-synthetics":"bop-link",onClick:l,children:s.jsx(nt.Image,{title:a.description||o,alt:a.alt,src:a.src})})]})})}renderBody(){const{name:t,bopLink:n,offer:o,price:r,size:a,linkElement:i,linkAction:l,catchWeightSubtextPosition:c,displayLandscapeLayout:d,missedPromotion:u,grossPriceEnabled:m,isFixedHeightTitleWithEllipsisFFEnabled:g}=this.props,f=!m&&a&&a.subtext,y=s.jsx(v,{id:"fop.tax.inclusive",values:{grossPrice:r.gross}}),I=g?hit:nt.FixedHeightTitle;return s.jsxs(nt.BodyContainer,{displayLandscapeLayout:d,children:[s.jsxs(nt.Body,{"data-test":"fop-body",displayLandscapeLayout:d,children:[t&&s.jsx(P,{asChild:!0,children:s.jsx("h3",{children:s.jsx(I,{as:i,"data-test":"fop-product-link",to:n,tabIndex:"-1",onClick:l,children:t})})}),s.jsx("div",{"data-test":"fop-offer",children:s.jsx(Eit,{children:o&&o.message&&s.jsxs(fit,{children:[this.buildOfferLink({ariaHidden:u}),s.jsx(yit,{concealed:!u,children:u&&this.buildMissedPromotionLink()})]})})}),s.jsx("div",{"data-test":"fop-size",children:s.jsx(A9,{children:a&&s.jsxs(h.Fragment,{children:[a.value&&s.jsxs(pit,{size:"md",display:"inline-block",children:[f&&c==="pre"&&s.jsx(nt.CatchWeightText,{pre:!0,children:a.subtext}),a.value,f&&c!=="pre"&&s.jsx(nt.CatchWeightText,{post:!0,children:a.subtext})]}),a.pricePer&&s.jsxs(mit,{size:"m",presentationMode:o&&o.presentationMode,display:"inline",isOffer:r.type==="offer",children:["(",a.pricePer,")"]})]})})}),s.jsxs(nt.PriceWrapper,{"data-test":"fop-price-wrapper",children:[s.jsxs(Kat,{type:r.type,"data-test":"fop-price",children:[f&&c==="pre"&&s.jsx(P,{asChild:!0,children:s.jsx(nt.CatchWeightText,{pre:!0,children:a.subtext})}),r.current,f&&c!=="pre"&&s.jsx(P,{asChild:!0,children:s.jsx(nt.CatchWeightText,{post:!0,children:a.subtext})})]}),m&&r.type==="offer"&&r.gross&&s.jsx(Nh,{presentationMode:o.presentationMode,isOffer:!0,display:"inline",children:y}),m&&r.type!=="offer"&&r.gross&&s.jsx(P,{children:y}),!m&&r.original&&s.jsx(zat,{children:r.original})]})]}),s.jsx(nt.Footer,{children:s.jsx("div",{className:"salt-m-b--1",children:this.renderControls()})})]})}render(){const{loading:t,active:n,overlay:o,productId:r,className:a,breadcrumbsVisible:i,firstInGroup:l,status:c,controls:d,onClick:u,onContextMenu:m,offer:g,noOfferLink:f,configurableFopEnabled:y,missedPromotion:I,subPage:S,page:C,type:_,group:A,alcohol:x,position:R,displayLandscapeLayout:O,fopView:N,withoutHeader:k,fopPositionOnPage:j}=this.props;return N==="list"?s.jsx(Fc,{fitContent:!0,onContextMenu:m,breadcrumbsHeader:i,firstInGroup:l,ref:this.fopWrapperRef,className:a,status:c,displayLandscapeLayout:!0,withoutHeader:k,children:s.jsx(h9,{loading:t,productId:r,group:A,position:R,page:C,type:_,subPage:S,noOfferLink:f,displayLandscapeLayout:O,withoutHeader:k,overrideConfig:this.getOverrideConfig(),fopPositionOnPage:j,buildFopContextIfEmpty:!1})}):t&&!(y&&C!=="order-details")?s.jsx(Fc,{active:n,ref:this.fopWrapperRef,className:a,breadcrumbsHeader:!0,firstInGroup:l,displayLandscapeLayout:O,withoutHeader:k,"data-test":"fetching-skeleton",children:s.jsx(v9,{displayLandscapeLayout:O,firstInGroup:l,withoutHeader:k})}):y&&C!=="order-details"?s.jsx(Fc,{fitContent:!0,onContextMenu:m,breadcrumbsHeader:i,firstInGroup:l,ref:this.fopWrapperRef,className:a,status:!!c,displayLandscapeLayout:O,withoutHeader:k,"data-retailer-anchor":"deprecated-fop-wrapper",children:s.jsx(ka,{loading:t,productId:r,group:A,position:R,page:C,type:_,subPage:S,noOfferLink:f,displayLandscapeLayout:O,withoutHeader:k,overrideConfig:this.getOverrideConfig(),fopPositionOnPage:j,buildFopContextIfEmpty:!1})}):s.jsxs(h.Fragment,{children:[s.jsxs(Fc,{onClick:u,onContextMenu:m,breadcrumbsHeader:i,firstInGroup:l,ref:this.fopWrapperRef,"data-test":`fop-wrapper:${r}`,"data-retailer-anchor":"fop-deprecated",className:a,status:!!c,displayLandscapeLayout:O,withoutHeader:k,children:[this.renderBreadcrumbs(),c&&s.jsx("div",{className:"salt-m-b--1",children:s.jsx(SN,{status:c})}),s.jsx(ve,{className:"salt-p--0",children:s.jsx(pc,{isActive:x,overlay:s.jsx(Yd,{className:"salt-p--2"}),children:s.jsxs(nt.BoxCard,{active:n,displayLandscapeLayout:O,children:[o&&C!=="regulars"&&s.jsx(nt.Overlay,{}),this.renderMoreOptionsIcon(),this.renderHeader(),this.renderBody()]})})})]}),g?.requiredProductQuantity&&s.jsx(Ph,{productQuantity:d.counter.value,message:I?.missedPromotionTextAlternative})]})}};Wd.propTypes=T9;Wd.defaultProps=_9;Wd.ATTRIBUTE_TYPE=Ol;Wd.ATTRIBUTE_GROUP_TYPE=dI;no.displayName="FopLayout";class qp extends h.Component{constructor(t){super(t),this.fopWrapperRef=ie.createRef()}shouldComponentUpdate(t){return(this.props.controls.counter||{}).value!==(t.controls.counter||{}).value||(this.props.controls.counter||{}).plusDisabled!==(t.controls.counter||{}).plusDisabled}render(){return s.jsx(n9,{...this.props,ref:this.fopWrapperRef})}}qp.propTypes=T9;qp.defaultProps=_9;qp.contextType=s9.Context;qp.displayName="Tile";const Iit=(e={},t)=>{const{hideOnViewports:n}=e;return!t||!n||!n.length||!n.includes(t)},rf=(e,t)=>`
        display: ${Iit(e,t)?"flex":"none"};
    `,Sit=De`
    ${e=>rf(e,"xs")};

    ${oe.smUp`
        ${e=>rf(e,"sm")};
    `}
    ${oe.mdUp`
        ${e=>rf(e,"md")};
    `}
    ${oe.lgUp`
        ${e=>rf(e,"lg")};
    `};
`,b9=(e,t=Number.MAX_VALUE)=>e<=t,Cit=(e,t,n)=>e.type!=="featured"||b9(t,e.viewportConfig[n]),af=(e,t)=>b9(e,t)?"flex":"none",Tit=De`
    display: ${e=>af(e.position,e.viewportConfig.xs)};
    ${oe.smUp`
        display: ${e=>af(e.position,e.viewportConfig.sm)};
    `}
    ${oe.mdUp`
        display: ${e=>af(e.position,e.viewportConfig.md)};
    `}
    ${oe.lgUp`
        display: ${e=>af(e.position,e.viewportConfig.lg)};
    `}
`,Ro=T(Wd)`
    ${e=>e.viewportConfig?e.isFeatured?Tit:"display: flex":e.hideOnViewports?Sit:""}
`;Ro.ATTRIBUTE_TYPE=Wd.ATTRIBUTE_TYPE;Ro.ATTRIBUTE_GROUP_TYPE=Wd.ATTRIBUTE_GROUP_TYPE;Ro.displayName="ViewportsEnabledFop";const gm=e=>(t,n)=>t.product&&t[n]===void 0?new Error(`Prop ${n} required when a product is present`):p.checkPropTypes({propName:e},t,"prop","Fop"),x9={product:ml,quantityInBasket:gm(p.number),maxQuantityReached:gm(p.bool),featured:gm(p.bool),updateBasketQuantity:gm(p.func),messages:gm(p.shape({catchWeight:p.string,countryOfOriginTitle:p.func,countryOfOriginA11yPrefix:p.string,pricePerUnit:p.string,outOfStock:p.string,notInCatalog:p.string,addToTrolley:p.string,addToTrolleyAlternative:p.func,increaseQuantityInTrolleyAlternative:p.string.isRequired,decreaseQuantityInTrolleyAlternative:p.string.isRequired,editQuantityTextAlternative:p.string.isRequired,getQuantityDescriptionTextAlternative:p.func.isRequired,maxQuantity:p.string,addedToBasket:p.string,lastBought:p.string,favoriteIconDescription:p.string,featuredLabel:p.string,featuredLabelDescription:p.string,timeRestriction:p.func,guaranteedProductLifeBadge:p.func,guaranteedProductLifeDescription:p.func,deposit:p.func,depositDescription:p.string,quantity:p.string,quantityLabel:p.func,missing:p.string,missingLabel:p.func,unavailableLabel:p.func,substitute:p.string,substituteLabel:p.func,accepted:p.string,acceptedLabel:p.func,rejected:p.string,rejectedLabel:p.func,returned:p.string,returnedLabel:p.func,seeAlternatives:p.func,noAlternatives:p.string,taxInclusive:p.func})),linkElement:p.oneOfType([p.string,p.func,p.elementType]),innerRef:p.func,hideOnViewports:p.arrayOf(p.string),isOrder:p.bool,showStatus:p.bool,noOfferLink:p.bool,linkAction:p.func,clusterBreadcrumbs:p.arrayOf(p.shape({id:p.string.isRequired,name:p.string.isRequired,link:p.string.isRequired})),isSEOReadableURLEnabled:p.bool,isRegionAgnosticEnabled:p.bool,fopPositionOnPage:p.number,catchWeightSubtextPosition:p.string,actions:p.shape({moreOptionsClick:p.func,promotionClickedEvent:p.func,breadcrumbsDropdownOnOpen:p.func,breadcrumbsClickAction:p.func,timeRestrictionNotification:p.func,maxQuantityReachedNotification:p.func,openOutOfStockAlternativesModal:p.func,noAlternativesHandler:p.func,showSubstitutesClickedEvent:p.func,navigateToPromotionClickedEvent:p.func}),missedPromotion:p.shape({requiredProductQuantity:p.number.isRequired,addedProductQuantity:p.number.isRequired,toAddProductQuantity:p.number.isRequired,missedPromotionText:p.string.isRequired,missedPromotionTextAlternative:p.string.isRequired,onMissedPromotionTextChange:p.func}),hideMoreOptions:p.bool,displayLandscapeLayout:p.bool,onClick:p.func,onContextMenu:p.func,fopControls:p.element,reviewsEnabled:p.bool,configurableFopEnabled:p.bool,isFixedHeightTitleWithEllipsisFFEnabled:p.bool,page:p.string,subPage:p.string,grossPriceEnabled:p.bool,alcoholBlurEnabled:p.bool,hideOriginalPriceEnabled:p.bool,referencePriceEnabled:p.bool},R9={product:null,featured:!1,innerRef:null,hideOnViewports:[],isOrder:!1,showStatus:!1,noOfferLink:!1,linkAction:void 0,clusterBreadcrumbs:[],box:!1,catchWeightSubtextPosition:"post",linkElement:void 0,actions:{},isSEOReadableURLEnabled:!1,alcoholBlurEnabled:!1,isFixedHeightTitleWithEllipsisFFEnabled:!1,hideMoreOptions:!1,onClick:()=>{},onContextMenu:()=>{},fopControls:void 0,subPage:null,fopPositionOnPage:0};class D9{constructor({product:t,fopView:n,updateBasketQuantity:o,featured:r,group:a={},firstInGroup:i,position:l=0,maxQuantityReached:c,maxQuantityPerProduct:d,quantityInBasket:u,linkElement:m,messages:g,hideOnViewports:f,isOrder:y,showStatus:I,linkAction:S,clusterBreadcrumbs:C,activeFopNoBackgroundEnabled:_,dynamicImagesEnabled:A,productImages:x,box:R,actions:O,catchWeightSubtextPosition:N,noOfferLink:k,isSEOReadableURLEnabled:j,isRegionAgnosticEnabled:w,missedPromotion:L,svgDefsEnabled:B,frenchLawEnabled:W,hideMoreOptions:$,displayLandscapeLayout:K,fopControls:Q,onClick:X,onContextMenu:re,type:ue,reviewsEnabled:te,configurableFopEnabled:ce,page:de,subPage:ye,grossPriceEnabled:Ae,hideOriginalPriceEnabled:Je,referencePriceEnabled:Ie,withoutHeader:je,isFixedHeightTitleWithEllipsisFFEnabled:Le,fopPositionOnPage:Be,alcoholBlurEnabled:be}){if(this.product=t,this.featured=r,this.quantityInBasket=u,this.messages=g,this.isOrder=y,this.showStatus=I,this.linkAction=S,this.fopControls=Q,this.props={product:t,controls:{counter:{updateBasketQuantity:t?o(u||0):null,max:d}},active:!!u&&!_,viewportConfig:a.viewportConfig,position:l,hideOnViewports:f,isFeatured:r,dynamicImagesEnabled:A,productImages:x,box:R,catchWeightSubtextPosition:N,noOfferLink:k,missedPromotion:L,svgDefsEnabled:B,frenchLawEnabled:W,alcohol:t?.alcohol,alcoholBlurEnabled:be,configurableFopEnabled:ce,isFixedHeightTitleWithEllipsisFFEnabled:Le,hideMoreOptions:$,displayLandscapeLayout:K,onClick:X,onContextMenu:re,type:ue,page:de,subPage:ye,group:a,grossPriceEnabled:Ae,hideOriginalPriceEnabled:Je,referencePriceEnabled:Ie,fopView:n,withoutHeader:je,fopPositionOnPage:Be},this.props.firstInGroup=i,this.isSEOReadableURLEnabled=j,this.isRegionAgnosticEnabled=w,!t){this.props.loading=!0;return}this.product.isInCurrentCatalog=t.isInCurrentCatalog!==!1,this.props.inCurrentCatalog=this.product.isInCurrentCatalog,this.unavailableButInBasket=!this.isProductAvailable()&&u>0,this.cannotAddMore=c,this.maxQuantityPerProduct=d,this.props.linkElement=this.product.isInCurrentCatalog?m:null,this.actions=O,this.reviewsEnabled=te,this.setProductProps(),this.setMessageProps(),this.setActionProps(O),this.props.breadcrumbsVisible=C.length>0||!!(a.products.length>0&&typeof a.type=="string"&&a.type.length),this.props.breadcrumbsVisible&&i&&(C.length>0?(this.props.breadcrumbsItems=C,this.props.breadcrumbsChild=C.length>0?C[C.length-1]:null,this.props.breadcrumbsMenuAccessibilityLabel=g.productGroupMenuAccessibilityLabel,this.props.actions.breadcrumbsDropdownOnOpen=O.breadcrumbsDropdownOnOpen(C),this.props.actions.breadcrumbsClickAction=(he,ge)=>O.breadcrumbsClickAction(he,ge)):(this.props.breadcrumbsText={message:g.productGroupTitle(a.type),link:a.type===Lt.FAVORITE?"/favorites?source=breadcrumbs":null},this.props.actions.breadcrumbsClickAction=he=>O.breadcrumbsClickAction(he)))}isFavorite(){return!!this.product.favorite}isRegular(){return!!this.product.regular}isProductAvailable(){const{product:t}=this;return t.available&&t.isInCurrentCatalog}setMessageProps(){const{messages:t,product:n,quantityInBasket:o,showStatus:r,unavailableButInBasket:a}=this;if(t&&((this.featured||n.cmsProductAttributes&&n.cmsProductAttributes.indexOf("featured")!==-1)&&t.featuredLabelDescription&&(this.props.topAttributes=this.props.topAttributes||[],this.props.topAttributes.unshift({type:"featured",chipType:"primary",text:t.featuredLabel,accessibility:t.featuredLabelDescription})),!a&&!this.isProductAvailable()&&t.outOfStock&&(this.props.topAttributes=this.props.topAttributes||[],this.props.topAttributes.unshift({type:"outOfStock",chipType:"secondary",text:t.outOfStock})),this.isFavorite()&&t.favoriteIconDescription&&(this.props.topAttributes=this.props.topAttributes||[],this.props.topAttributes.unshift({type:"favorite",text:t.favoriteIconDescription})),this.isRegular()&&t.regularIconDescription&&(this.props.topAttributes=this.props.topAttributes||[],this.props.topAttributes.unshift({type:"regular",text:t.regularIconDescription})),this.props.shoppingListsMessages={moreOptionsTitle:t.moreOptionsTitle,moreOptionsAccessibilityLabel:t.moreOptionsAccessibilityLabel,inProductListTitle:t.inProductListTitle},r)){if(n.reason){if(n.reason===hQe&&(this.props.status={message:t.unavailableLabel(n.missingAmount),type:"error",alert:!0}),n.reason===pQe&&(this.props.status={message:t.missingLabel(n.missingAmount),type:"error",alert:!0}),n.reason===gQe){let i="";if(n.deliveryTimeRestrictionMessage&&(i=n.deliveryTimeRestrictionMessage),n.timeRestriction){const{deliverableTo:l,deliverableFrom:c}=n.timeRestriction;i=t.timeRestriction(l,c)}this.props.status={message:i,type:"error",alert:!0}}if(n.reason===mQe){const{addedAmount:i,requestedAmount:l}=n;this.props.status={message:t.limitedAvailability(i,l),type:"error",alert:!0}}}n.quantityInOrder&&!o&&(this.props.quantityInOrder={quantity:n.quantityInOrder,message:t.quantityLabel(n.quantityInOrder)}),n.missing?this.props.status=t.missing&&{message:t.missingLabel(n.quantityInOrder),type:"error",alert:!0}:n.accepted?this.props.status=t.accepted&&{message:t.acceptedLabel(n.quantityInOrder),type:"success",alert:!0}:n.rejected?this.props.status=t.rejected&&{message:t.rejectedLabel(n.quantityInOrder),type:"error",alert:!0}:n.substitute?this.props.status=t.substitute&&{message:t.substituteLabel(n.quantityInOrder),type:"success",alert:!0}:n.returned&&(this.props.status=t.returned&&{message:t.returnedLabel(n.quantityInOrder),type:"success",alert:!0})}}setProductProps(){const{product:t,messages:n,linkAction:o,isOrder:r,unavailableButInBasket:a,isSEOReadableURLEnabled:i,isRegionAgnosticEnabled:l}=this;if(this.props.productId=t.productId,this.props.isInCurrentCatalog=this.product.isInCurrentCatalog,this.props.name=t.name,this.props.bopLink=vi(t.retailerProductId,Gp(t.name,{isSEOReadableURLEnabled:i})),this.props.linkAction=o,this.props.overlay=a?!1:!this.isProductAvailable(),this.props.image={description:t.image?.description??t.name,src:t.image.src,fopSrcset:t.image.fopSrcset},t.countryOfOrigin&&(this.props.countryOfOrigin={a11yPrefix:n.countryOfOriginA11yPrefix,title:n.countryOfOriginTitle(t.countryOfOrigin),country:t.countryOfOrigin}),t.offer){const d=l?t.offer.retailerPromotionId:t.offer.id,u=Co(t.offer.description);this.props.offer={message:t.offer.description,url:t.offer.type==="COUPON"?EQ(d,u):MC(d,i?u.toLowerCase():void 0),icon:t.offer.type&&lT(t.offer.type),...t.offer.presentationMode&&{presentationMode:t.offer.presentationMode},requiredProductQuantity:t.offer.requiredProductQuantity}}this.props.price={original:t.price?.original?.amount,current:t.price?.current?.amount,type:t.offer&&t.price?.original?"offer":"standard",gross:t.price?.gross?.amount,reference:t.price?.reference?.amount},this.props.size={value:t.size&&`${t.size.value}${t.size.uom||""}`,pricePer:t.price?.unit?.current?.amount&&n?.pricePerUnit,subtext:t.size?.catchWeight&&n?.catchWeight},this.props.controls={...this.props.controls,...this.getControlProps(this.props.controls.counter)};const c=(d,u)=>(this.props.attributes=this.props.attributes||[],this.props.attributes[d]=this.props.attributes[d]||{type:u,attributes:[]},this.props.attributes[d].attributes);if(t.depositPrice&&n.deposit&&n.depositDescription&&c(0,Ro.ATTRIBUTE_GROUP_TYPE.SINGLE_LINE).push({type:Ro.ATTRIBUTE_TYPE.TEXT,chipType:"promotion",text:n.deposit(t.depositPrice.amount,t.depositPrice.currency),accessibility:n.depositDescription}),t.guaranteedProductLife&&t.guaranteedProductLife.quantity>0&&t.guaranteedProductLife.unit&&n.guaranteedProductLifeBadge&&n.guaranteedProductLifeDescription&&c(0,Ro.ATTRIBUTE_GROUP_TYPE.SINGLE_LINE).push({type:Ro.ATTRIBUTE_TYPE.TEXT,chipType:"primary",text:n.guaranteedProductLifeBadge(t.guaranteedProductLife.quantity,t.guaranteedProductLife.unit),accessibility:n.guaranteedProductLifeDescription(t.guaranteedProductLife.quantity,t.guaranteedProductLife.unit)}),t.attributes){const d=c(0,Ro.ATTRIBUTE_GROUP_TYPE.SINGLE_LINE);t.attributes.forEach(u=>d.push({type:Ro.ATTRIBUTE_TYPE.IMAGE,...u}))}this.props.isInProductList=t.isInProductList,this.props.isFavorite=this.isFavorite(),this.props.reviewsEnabled=this.reviewsEnabled,this.isFavorite()&&!r&&n.lastBought&&t.favorite.lastBought?c(1,Ro.ATTRIBUTE_GROUP_TYPE.MULTI_LINE).push({type:Ro.ATTRIBUTE_TYPE.TEXT,position:"bottom",chipType:"secondary",text:`${n.lastBought(t.favorite.lastBought)}`,accessibility:`${n.lastBought(t.favorite.lastBought)}`}):this.reviewsEnabled&&c(1,Ro.ATTRIBUTE_GROUP_TYPE.MULTI_LINE).push({type:Ro.ATTRIBUTE_TYPE.RATING}),this.props.image.alt=String(this.props.image.description||this.props.name).concat(" ",(Array.isArray(this.props.attributes)&&this.props.attributes[0]&&this.props.attributes[0].attributes||[]).map(d=>d.accessibility||d.label).filter(Boolean).join(", ")||"").trim()}getControlProps(t){const{product:n,messages:o,cannotAddMore:r,maxQuantityPerProduct:a,actions:i,unavailableButInBasket:l,fopControls:c,quantityInBasket:d,props:{type:u}}=this,m={...t,minusDisabled:!1,value:d,addText:n.isInCurrentCatalog?o.addToTrolley:o.notInCatalog,plusDisabled:r||!this.isProductAvailable(),addTextAlternative:o.addToTrolleyAlternative(n.name),increaseQuantityTextAlternative:o.increaseQuantityInTrolleyAlternative(n.name),decreaseQuantityTextAlternative:o.decreaseQuantityInTrolleyAlternative(n.name),editQuantityTextAlternative:o.editQuantityTextAlternative(n.name),quantityDescriptionTextAlternative:o.getQuantityDescriptionTextAlternative(d)};l&&(m.max=d);const g=A=>this.actions.showSubstitutesClickedEvent({productId:this.props.productId,retailerProductId:this.product.retailerProductId,totalCount:this.product.alternatives?.length||0,productSequence:this.props.position,hideSubstitutes:!1,pageEventId:A}),f={maxQuantity:"maxQuantity",timeRestriction:"timeRestriction",outOfStock:"outOfStock"},y=function(){if(!r)return null;if(u!=="slotbooking"){if(d>=a)return f.maxQuantity;if(n.timeRestriction)return f.timeRestriction}return!n.available||u==="slotbooking"&&n.timeRestriction?f.outOfStock:f.maxQuantity}(),I=n.alternatives&&n.alternatives.length>0,S=!d||u==="slotbooking";if(c)return{type:"custom",custom:c};const C=n.timeRestriction?.deliverableTo,_=n.timeRestriction?.deliverableFrom;switch(y){case f.maxQuantity:return{type:"counter",counter:{...m,action:()=>{i.maxQuantityReachedNotification()},addInfo:!0,addIcon:"info_default",addText:o.maxQuantityLabel,addTextAlternative:o.maxQuantity,increaseQuantityTextAlternative:o.maxQuantity}};case f.timeRestriction:return{type:"counter",counter:{...m,action:()=>{i.timeRestrictionNotification(C,_)},addInfo:!0,addIcon:"slot",addText:o.timeRestricted,addTextAlternative:o.timeRestriction(C,_),increaseQuantityTextAlternative:o.timeRestriction(C,_)}};case f.outOfStock:return I&&S?{type:"action",action:{text:o.seeAlternatives(n.alternatives),onClick:()=>{const A=vt();this.actions.openOutOfStockAlternativesModal({productId:this.props.productId,retailerProductId:n.retailerProductId,productName:this.props.name,type:this.props.type,pageEventId:A}),g(A)}}}:S?{type:"action",action:{appearance:"secondary",text:o.noAlternatives,onClick:()=>{this.actions.noAlternativesHandler(),g()}}}:{type:"counter",counter:{...m,action:()=>i.cannotAddBecauseOutOfStockNotification(),addInfo:!0,addIcon:d?"info_default":null,addText:o.outOfStock}};default:return{type:"counter",counter:{...m}}}}setActionProps(t={}){if(this.props.actions={},this.props.offer){const{promotionClickedEvent:n,navigateToPromotionClickedEvent:o}=t,r=this.props.fopPositionOnPage;this.props.actions={promotionClickedEvent:n({productId:this.props.productId,promotionId:this.isRegionAgnosticEnabled?this.product.offer.retailerPromotionId:this.product.offer.id}),navigateToPromotionClickedEvent:o({itemId:this.product.retailerProductId,itemName:this.props.name,index:r,promotionId:this.isRegionAgnosticEnabled?this.product.offer.retailerPromotionId:this.product.offer.id,promotionName:this.product.offer.description,list:Ws(this.props.page,this.props.subPage,this.props.section)})}}this.props.actions.moreOptionsClick=t.moreOptionsClick}}const Kp=e=>{const t=new D9(e);return s.jsx(Ro,{...t.props,ref:e.innerRef})},zp=e=>{const t=new D9(e);return s.jsx(qp,{...t.props,ref:e.innerRef})};Kp.propTypes=x9;Kp.defaultProps=R9;zp.propTypes=x9;zp.defaultProps=R9;const O9=(e,t)=>{const[n=!1]=fe(["seo.rdbl"]);return La.calculateLegacyTargetUrl(e,{isSEOReadableURLEnabled:n},t)},CN=(e=()=>{})=>{const t=h.useRef(!1),n=h.useRef(null);return h.useCallback(r=>{if(!window.IntersectionObserver||!r||n.current)return;const a=([l])=>{l.isIntersecting&&!t.current&&(e(),t.current=!0,n.current.unobserve(l.target))},i={threshold:.2,root:null,rootMargin:"0%"};n.current=new IntersectionObserver(a,i),n.current.observe(r)},[e])},TN=e=>!["isFirstInProductsListing"].includes(String(e)),_it=T.img`
    block-size: auto;
    max-block-size: 100%;
    max-inline-size: 100%;
    inline-size: auto;
    object-fit: contain;
`,vit="calc(var(--salt-spacing-1) * 7)",P9=T.div.withConfig({shouldForwardProp:TN})`
    border-radius: var(--salt-radius-default);
    inline-size: 100%;
    padding: 0;
    position: relative;
    background: transparent;
    border: none;
    overflow: hidden;
    z-index: 1;
    block-size: auto;
    ${oe.smUp`height: ${({height:e})=>e};`}

    ${({isFirstInProductsListing:e})=>e&&De`
            ${oe.smUp`
                margin-top: ${vit};
            `}
        `}
`,Ait=T(P9).withConfig({shouldForwardProp:TN})`
    place-self: end center;
    margin-block-end: 0;
    overflow: hidden;
    block-size: auto;
    ${oe.smUp`height: ${({height:e})=>e};`}
`,bit=T(nt.BoxCard).withConfig({shouldForwardProp:TN})`
    background: transparent;
    overflow: hidden;
    z-index: 1;

    ${oe.xs`
        height: auto !important;
    `}
`,mB=T(nt.FixedHeightWrapper)`
    margin-block-start: auto;
    block-size: fit-content;
    ${oe.smUp`height: ${({containerCustomHeight:e})=>e};`}
`,xit=e=>e.find(t=>!!t?.offsetParent),Rit=e=>e.find(t=>!!t?.offsetParent&&t.querySelector("img")),N9=e=>{const n=Array.from(document.querySelectorAll(".product-card-container")).filter(a=>{const i=a.closest('[data-test^="fop-wrapper:"]');return!!i&&i.getAttribute("data-layout")!=="landscape"});if(!n.length)return"";const o=e(n);if(!o)return"";const r=o.getBoundingClientRect();return r?.height?`${H(r.height)}`:""},Dit=()=>N9(Rit),Oit=()=>N9(xit),Pit=({onCheckedProductHeight:e,setHasProductRendered:t})=>{const n=Dit(),o=Oit();e(n||o||"auto"),n&&t()},Nit=({isConfigurableFopEnabled:e,isNewProductsListingEnabled:t})=>e&&t&&"CONFIGURABLE_IN_NEW_LISTING"||e&&"CONFIGURABLE"||"REGULAR",Lit=e=>["CONFIGURABLE"].includes(e)?"fit-content":void 0,kit=e=>["CONFIGURABLE","CONFIGURABLE_IN_NEW_LISTING"].includes(e),Mit=e=>{switch(e){case"CONFIGURABLE":return"product-card-advert-configurable";case"CONFIGURABLE_IN_NEW_LISTING":return"product-card-advert-new-listing";default:return""}},jit=({variant:e,position:t,children:n,productHeight:o})=>{const a={breadcrumbsHeader:!0,firstInGroup:!1,displayLandscapeLayout:!1,containerCustomHeight:Lit(e)},i=`product-card-advert-${t}`,l=t===1;switch(e){case"CONFIGURABLE_IN_NEW_LISTING":return s.jsx(Ait,{"data-test":i,height:o,isFirstInProductsListing:l,children:n});case"CONFIGURABLE":return s.jsx(mB,{...a,children:s.jsx(P9,{"data-test":i,height:o,isFirstInProductsListing:l,children:n})});default:return s.jsxs(mB,{...a,children:[s.jsx(pT,{breadcrumbsVisible:!0}),s.jsx(bit,{"data-test":i,children:n})]})}},L9=({disableBlurring:e=!1,...t})=>{const n=e?k9:wit;return s.jsx(n,{imageHasBorderRadius:e,...t})},k9=T(yP)`
    display: flex;
    align-items: center;
    flex-direction: column;
    justify-content: center;
    block-size: 100%;
    inline-size: 100%;

    picture {
        max-block-size: 100%;
        max-inline-size: 100%;
        inline-size: auto;
        ${oe.xs`
            max-height: fit-content;
            width: 100%;
        `}
        ${oe.xsUp`
            display: flex;
            height: 100%;
            width: 100%;
        `}
    }

    img {
        display: block;
        block-size: auto;
        max-block-size: 100%;
        max-inline-size: 100%;
        inline-size: auto;
        object-fit: contain;
        margin: auto;
        ${({imageHasBorderRadius:e})=>`border-radius: ${e?"var(--salt-radius-default)":"unset"};`};
        ${oe.xs`
            max-height: fit-content;
            width: 100%;
        `}
    }
`,wit=T(k9)`
    ${oe.smUp`
        position: relative;
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center center;
        overflow: hidden;
        z-index: 1;

        ${({$imageSet:e})=>`background-image: ${e};`};

        &:before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: -1;
            backdrop-filter: blur(50px);
        }
    `}
`,M9=({advert:e,page:t,sequence:n})=>{const[o,r,a]=fe(["cfop","new.prl","bl.d"]),[i]=EP(),l=Nit({isConfigurableFopEnabled:o,isNewProductsListingEnabled:r}),[c,d]=h.useState(""),u=!kit(l),m=h.useRef(u),g=()=>{m.current=!0},f=i==="SMALL";h.useEffect(()=>{m.current=!1},[i]),h.useEffect(()=>{m.current||f||Pit({onCheckedProductHeight:d,setHasProductRendered:g})});let y;i&&(y=rI(e.images,cJe[i]));const I=O9(e.target),S=u8(e),{reportStaticAdvertImpression:C,reportStaticAdvertClick:_}=XC(t,e.placement),x=CN(()=>{e&&y?.url&&C({id:e.id,name:e.name,altText:y.altText,contentSource:e.contentSource,targetUrl:I,linkType:e.target.linkType,segments:e.segments,sequence:n,format:e.format,imageUrl:y.url,size:1})}),R=()=>{e&&y?.url&&_({id:e.id,name:e.name,altText:y.altText,contentSource:e.contentSource,targetUrl:I,linkType:e.target.linkType,segments:e.segments,sequence:n,format:e.format,imageUrl:y.url,size:1})},O=y?p8(y):"none",N=Mit(l);return y?s.jsx(jit,{variant:l,position:e.position,productHeight:c,children:s.jsx(L9,{linkType:e?.target?.linkType,href:I,target:S,isExternalLink:e.isExternalLink,title:y.altText,onClick:R,"data-test":N,$imageSet:O,disableBlurring:a,children:s.jsx(QC,{image:y,contentSource:e.contentSource,pixelDensity:!0,children:s.jsx(_it,{ref:x,src:y.url,alt:y.altText??"",loading:"lazy"})})})}):null};function hB({showMissedPromotions:e,missedPromotionsEnabled:t,missedPromotionQuantities:n,quantity:o,product:r,orderId:a,messages:{missedPromotionCompleteTextAlternative:i,missedPromotionNotCompleteTextAlternative:l},actions:{analyticsEvent:c}}){if(!r)return null;const d=n?.basketQuantity,u=n?.requiredQuantity;if(!(e||t)||!d||!u)return null;const g=d%u||u,f=u-g,y=r.offer.description,I=f===0?i(o,y):l(o,y,g,u),S={id:r.offer.id,requiredProductQuantity:u,addedProductQuantity:g,toAddProductQuantity:f,missedPromotionText:y,missedPromotionTextAlternative:I,missedPromotionTextType:f===0?"PromotionComplete":"PromotionIncomplete"};return{...S,onMissedPromotionTextChange:()=>{c({type:zt.MESSAGE_ALERT_DISPLAYED,missedPromotion:S,orderId:a,productId:r.productId,missedPromotionType:r.offer.type})}}}const gB=.5,Fit=D("di"),Bit=D("afnbg"),Uit=D("seo.rdbl"),Git=D("seo.ra"),$it=D("fop.mp"),Hit=D("fr.law"),Vit=D("rvws"),Yit=D("cfop"),Wit=D("ngp"),qit=D("hop"),Kit=D("prp"),zit=D("fop.ellip"),Qit=D("alc.blur"),hu=e=>(t,n)=>t.product&&t[n]===void 0?new Error(`Prop ${n} required when a product is present`):p.checkPropTypes({propName:e},t,"props","ParentFop"),Xit={orderId:p.string,draftBasketId:p.string,actions:p.shape({setActiveBop:p.func.isRequired,analyticsEvent:p.func.isRequired,openShoppingListsModal:p.func.isRequired,openOutOfStockAlternativesModal:p.func.isRequired}).isRequired,productId:p.string,product:ml,fopView:p.string,position:p.number,fopPositionOnPage:p.number,group:p.shape({type:p.string,clusterBreadcrumbs:p.arrayOf(p.shape({id:p.string.isRequired,name:p.string.isRequired,retailerCategoryId:p.string}))}),firstInGroup:p.bool,sendFopProductLinkEvent:p.func.isRequired,currentBreakpoint:p.string,registerRef:p.func,hideOnViewports:p.arrayOf(p.string),pageViewId:p.string,activeFopNoBackgroundEnabled:p.bool.isRequired,dynamicImagesEnabled:p.bool.isRequired,isSEOReadableURLEnabled:p.bool,missedPromotionsEnabled:p.bool,isFixedHeightTitleWithEllipsisFFEnabled:p.bool,missedPromotionQuantities:p.shape({basketQuantity:p.number,requiredQuantity:p.number}),frenchLawEnabled:p.bool.isRequired,alcoholBlurEnabled:p.bool.isRequired,maxQuantityPerProduct:p.number,noOfferLink:p.bool,userLoggedIn:p.bool.isRequired,catchWeightSubtextPosition:p.string,quantity:hu(p.number),updateBasketQuantity:hu(p.func),messages:hu(p.shape({catchWeight:p.string,countryOfOriginTitle:p.func,countryOfOriginA11yPrefix:p.string,pricePerUnit:p.string,outOfStock:p.string,addToTrolley:p.string,maxQuantity:p.string,addedToBasket:p.string,lastBought:p.string,timeRestricted:p.string,timeRestriction:p.func,increaseQuantityInTrolleyAlternative:p.string.isRequired,decreaseQuantityInTrolleyAlternative:p.string.isRequired,editQuantityTextAlternative:p.string.isRequired,getQuantityDescriptionTextAlternative:p.func.isRequired,addToTrolleyAlternative:p.func.isRequired,quantity:p.string,quantityLabel:p.func,missing:p.string,missingLabel:p.func,unavailableLabel:p.func,substitute:p.string,substituteLabel:p.func,accepted:p.string,acceptedLabel:p.func,rejected:p.string,rejectedLabel:p.func,returned:p.string,returnedLabel:p.func,taxInclusive:p.func})),linkElement:hu(p.func),onImpression:hu(p.func),onClick:p.func,onContextMenu:p.func,type:hu(p.string),svgDefsEnabled:p.bool,hideMoreOptions:p.bool,displayLandscapeLayout:p.bool.isRequired,fopControls:p.element,showMissedPromotions:p.bool,reviewsEnabled:p.bool,configurableFopEnabled:p.bool,page:p.string.isRequired,subPage:p.string,grossPriceEnabled:p.bool,withoutHeader:p.bool,isRegionAgnosticEnabled:p.bool,hideOriginalPriceEnabled:p.bool,referencePriceEnabled:p.bool},Zit={orderId:void 0,draftBasketId:void 0,productId:null,product:void 0,position:0,fopPositionOnPage:0,group:void 0,firstInGroup:!1,registerRef:()=>{},onClick:()=>{},onContextMenu:()=>{},currentBreakpoint:null,hideOnViewports:[],fopView:"detail",missedPromotionsEnabled:!1,missedPromotionQuantities:void 0,maxQuantityPerProduct:void 0,noOfferLink:!1,catchWeightSubtextPosition:"post",isSEOReadableURLEnabled:!1,isFixedHeightTitleWithEllipsisFFEnabled:!1,svgDefsEnabled:!1,hideMoreOptions:!1,fopControls:void 0,showMissedPromotions:!1,reviewsEnabled:!1,configurableFopEnabled:!1,subPage:null,pageViewId:null,withoutHeader:!1};class _N extends h.Component{constructor(t){super(t),this.impressionSent=!1,this.updateRef=this.updateRef.bind(this),this.sendImpression=this.sendImpression.bind(this),this.attemptImpression=this.attemptImpression.bind(this),this.generateClusterBreadcrumb=this.generateClusterBreadcrumb.bind(this),this.generateClusterBreadcrumbLink=this.generateClusterBreadcrumbLink.bind(this),this.isInView=0,this.fopRef=null}componentDidMount(){this.updateIntersectionObserver()}componentDidUpdate(t){this.props.currentBreakpoint!==t.currentBreakpoint&&this.updateIntersectionObserver(),this.props.product!==t.product&&!this.impressionSent&&this.attemptImpression()}componentWillUnmount(){this.updateRef(null),this.deleteIntersectionObserver()}deleteIntersectionObserver(){if(this.intersectionObserver){try{this.intersectionObserver.unobserve(this.fopRef.current)}catch{}delete this.intersectionObserver}}updateIntersectionObserver(){const{currentBreakpoint:t}=this.props;if(this.impressionSent)return;const n=["xs","sm","md"].includes(t)?ra.v2.sm:ra.v2.lgUp;if(this.deleteIntersectionObserver(),typeof window<"u"&&"IntersectionObserver"in window&&(this.intersectionObserver=new window.IntersectionObserver(o=>{this.isInView=o[0].intersectionRatio,this.attemptImpression()},{rootMargin:`-${n}px 0px 0px 0px`,threshold:gB}),this.fopRef))try{this.intersectionObserver.observe(this.fopRef.current)}catch{}}updateRef(t){if(this.unregisterRef&&(this.unregisterRef(),this.unregisterRef=null),t&&t.fopWrapperRef){if(this.fopRef&&this.intersectionObserver)try{this.intersectionObserver.unobserve(this.fopRef.current)}catch{}if(this.fopRef=t.fopWrapperRef,this.intersectionObserver)try{this.intersectionObserver.observe(this.fopRef.current)}catch{}const{productId:n,registerRef:o}=this.props;this.fopRef&&o&&(this.unregisterRef=o(n,this.fopRef.current))}}shouldSendImpression(){const{onImpression:t,product:n}=this.props;return!this.impressionSent&&this.isInView>=gB&&n&&t}attemptImpression(){this.shouldSendImpression()&&this.sendImpression()}sendImpression(){const{onImpression:t}=this.props;this.shouldSendImpression()&&(this.impressionSent=!0,this.deleteIntersectionObserver(),setTimeout(t,10,hB(this.props)))}generateClusterBreadcrumbLink({id:t,fullURLPath:n,retailerCategoryId:o}){const{isSEOReadableURLEnabled:r,isRegionAgnosticEnabled:a}=this.props,i=`source=breadcrumbs&sublocationId=${t}`;if(r){const l=n?.toLowerCase();return Ui(a?o:t,l,{queryString:"source=breadcrumbs"})}return jo({queryString:i})}generateClusterBreadcrumb({id:t,name:n,fullURLPath:o="",retailerCategoryId:r}){return{id:t,name:n,link:this.generateClusterBreadcrumbLink({id:t,fullURLPath:o,retailerCategoryId:r})}}render(){const{type:t,fopView:n,product:o,quantity:r,updateBasketQuantity:a,onClick:i,onContextMenu:l,messages:c,linkElement:d,hideOnViewports:u,position:m,group:g,sendFopProductLinkEvent:f,firstInGroup:y,activeFopNoBackgroundEnabled:I,actions:{setActiveBop:S,analyticsEvent:C,openShoppingListsModal:_,openOutOfStockAlternativesModal:A},dynamicImagesEnabled:x,noOfferLink:R,catchWeightSubtextPosition:O,maxQuantityPerProduct:N,isSEOReadableURLEnabled:k,isRegionAgnosticEnabled:j,svgDefsEnabled:w,isFixedHeightTitleWithEllipsisFFEnabled:L,frenchLawEnabled:B,alcoholBlurEnabled:W,configurableFopEnabled:$,hideMoreOptions:K,fopControls:Q,displayLandscapeLayout:X,reviewsEnabled:re,page:ue,subPage:te,grossPriceEnabled:ce,withoutHeader:de,fopPositionOnPage:ye,hideOriginalPriceEnabled:Ae,referencePriceEnabled:Je}=this.props,Ie=()=>{o&&(o.isInCurrentCatalog===!1?z.info("fop.not.in.current.catalog"):o.productId&&(f(),S(o.productId)))},je={type:t,product:o,quantityInBasket:r,maxQuantityReached:o?o.maxQuantityReached:void 0,maxQuantityPerProduct:N,updateBasketQuantity:a,onClick:i,onContextMenu:l,messages:c,linkElement:d,position:m,group:g,firstInGroup:y,clusterBreadcrumbs:g&&Array.isArray(g.clusterBreadcrumbs)?g.clusterBreadcrumbs.map(this.generateClusterBreadcrumb):[],featured:g&&g.type===Lt.FEATURED,hideOnViewports:o?o.hideOnViewports:u,isOrder:t==="order",showStatus:t==="order"||t==="slotbooking",activeFopNoBackgroundEnabled:I,dynamicImagesEnabled:x,isSEOReadableURLEnabled:k,isRegionAgnosticEnabled:j,displayLandscapeLayout:X,actions:{moreOptionsClick:()=>{const{productId:Be,retailerProductId:be}=this.props.product;C({type:zt.ELLIPSIS_CLICKED,productId:Be,retailerProductId:be}),_({productId:Be,page:ue,productIndex:ye,section:g.type})},promotionClickedEvent:({promotionId:Be,productId:be})=>()=>C({type:zt.PROMO_LINK_CLICKED,promotionId:Be,productId:be}),navigateToPromotionClickedEvent:({itemId:Be,itemName:be,index:he,promotionId:ge,promotionName:Oe,list:Xe})=>()=>{const Se={event:"select_item_promotion",id:Be,name:be,index:he,promotion_id:ge,promotion_name:Oe,list:Xe};return J.sendEvent({GA:Se,WA:null}),C({type:zt.GA_FOP_PROMO_LINK_CLICKED,itemId:Be,itemName:be,index:he,promotionId:ge,promotionName:Oe,list:Xe})},showSubstitutesClickedEvent:({productId:Be,retailerProductId:be,productSequence:he,totalCount:ge,hideSubstitutes:Oe,pageEventId:Xe})=>{C({type:zt.SHOW_SUBSTITUTES,pageEventId:Xe,productId:Be,retailerProductId:be,productSequence:he,totalCount:ge,hideSubstitutes:Oe})},breadcrumbsDropdownOnOpen:Be=>()=>C({type:zt.CLUSTER_EXPANDED,attributes:Be.reduce((be,he,ge)=>(be[`categoryIdLevel${ge+1}`]=he.id,be),{})}),breadcrumbsClickAction:(Be,be)=>{let he={level:Be};be&&(he={...he,categoryId:be}),C({type:zt.BREADCRUMBS_LIST_CLICKED,description:"User clicked breadcrumbs list item",pageEventAttributes:he})},timeRestrictionNotification:(Be,be)=>{const he=o.deliveryTimeRestrictionMessage?{formattedMessage:o.deliveryTimeRestrictionMessage}:{key:"fop.time.restriction.toast",substitutions:{to:Be,from:be}};z.warning(he)},maxQuantityReachedNotification:()=>{z.error("fop.max.quantity.toast.generic")},noAlternativesHandler:()=>{z.warning("fop.no.alternatives.text.toast")},cannotAddBecauseOutOfStockNotification:()=>{z.error("fop.oos.toast")}},catchWeightSubtextPosition:O,missedPromotion:hB(this.props),svgDefsEnabled:w,frenchLawEnabled:B,hideMoreOptions:K,fopControls:Q,reviewsEnabled:re,configurableFopEnabled:$,isFixedHeightTitleWithEllipsisFFEnabled:L,page:ue,subPage:te,grossPriceEnabled:ce,fopView:n,withoutHeader:de,fopPositionOnPage:ye,alcoholBlurEnabled:W,hideOriginalPriceEnabled:Ae,referencePriceEnabled:Je};je.actions={...je.actions,openOutOfStockAlternativesModal:A};const Le={linkAction:Ie,linkElement:o&&o.isInCurrentCatalog===!1?void 0:d,innerRef:this.updateRef,noOfferLink:R};return n==="grid"?s.jsx(zp,{...je,...Le}):s.jsx(Kp,{...je,...Le})}}_N.propTypes=Xit;_N.defaultProps=Zit;const Jit=()=>(e,{product:t,draftBasketId:n})=>{let o,r;return t&&(n?o=aVe(e,t.productId,n):o=lx(e,t.productId),t.offer?.requiredProductQuantity&&(r=eN(e,t.offer.id,t.productId))),{quantity:o,pageViewId:On(e),activeFopNoBackgroundEnabled:Bit(e),dynamicImagesEnabled:Fit(e),isSEOReadableURLEnabled:Uit(e),isRegionAgnosticEnabled:Git(e),isFixedHeightTitleWithEllipsisFFEnabled:zit(e),missedPromotionsEnabled:$it(e),userLoggedIn:Ze(e),catchWeightSubtextPosition:qe(e,"catch-weight-subtext-position"),maxQuantityPerProduct:i0(e),frenchLawEnabled:Hit(e),reviewsEnabled:Vit(e),configurableFopEnabled:Yit(e),grossPriceEnabled:Wit(e),alcoholBlurEnabled:Qit(e),hideOriginalPriceEnabled:qit(e),referencePriceEnabled:Kit(e),...r&&{missedPromotionQuantities:r}}},elt=ot({setActiveBop:Ja.setActiveBop,analyticsEvent:U.analyticsEvent,openShoppingListsModal:({productId:e,page:t,section:n,productIndex:o})=>Z.openModal("shoppingLists",{productId:e,page:t,section:n,productIndex:o}),openOutOfStockAlternativesModal:({productId:e,productName:t,retailerProductId:n,type:o,pageEventId:r})=>Z.openModal(Zu,{productId:e,productName:t,retailerProductId:n,type:o,pageEventId:r})}),tlt=ke(Jit,elt)(_N),slt=e=>{const t=new URLSearchParams(e.search),n=t.get("boolean");t.set("boolean",`${n?`${n},`:""}favoritesOnly`);const o=t?.get("q");return{url:`${e.pathname}?${t?.toString()}`,searchTerm:o}},j9=({favouritesAmount:e,isNewProductList:t})=>{const{currentBreakpoint:n}=h.useContext(Pn),o=Ne(),{formatMessage:r}=M(),{url:a,searchTerm:i}=slt(o),{correctedSearchTerm:l}=E(Sp),c=ts();h.useEffect(()=>{n&&c({type:gt.SHOW_ALL_FAVORITES_FILTER_BUTTON_IMPRESSION})},[n]);const d=m=>s.jsx(b,{asChild:!0,intent:"secondary",fill:!0,onClick:()=>c({type:gt.SHOW_ALL_FAVORITES_FILTER_BUTTON_CLICKED}),children:s.jsxs(Qe,{intent:"ghost",href:a,children:[s.jsx(b.Icon,{name:"favourites"}),s.jsx(b.Text,{children:r(m)})]})});if(!n)return null;const u=()=>n==="xs"?d("fop.favorite.only.button.text"):s.jsx(se,{additionalCss:"flex: 1; margin-top: 28px",children:s.jsx(ve,{asChild:!0,children:s.jsx(Qe,{intent:"ghost",href:a,className:"salt-d--flex",onClick:()=>c({type:gt.SHOW_ALL_FAVORITES_FILTER_BUTTON_CLICKED}),children:s.jsxs(se,{gap:["sm"],direction:"column",justify:"center",children:[s.jsx(me,{name:"favourites",primary:!0}),s.jsx(P,{bold:!0,size:"l",children:r("favorite.tile.title",{favouritesAmount:e})}),s.jsx(P,{children:r("favorite.tile.description",{searchTerm:l||i})})]})})})});return t?u():s.jsx(Fc,{fitContent:!0,children:u()})},nlt=(e,t)=>{const n=[];for(let o=0;o<t.length;o+=1){const r=t.find(a=>a.position===e+o);if(r)n.push(r);else break}return n},olt=(e,t)=>!!e.length&&e.at(-1).position===t-1,rlt=(e,t)=>{const n=[],o=[];return[...e].sort((r,a)=>r.position-a.position).forEach(r=>{const{position:a}=r;if(a===t||olt(n,a)){n.push(r);return}a>t&&o.push(r)}),[n,o]},alt=({position:e,productCardAdverts:t,isInLastPosition:n})=>n?rlt(t,e):[nlt(e,t),[]],ilt=({data:e})=>e.adverts.categoryPage.fetchError,llt=({data:e})=>e.adverts.categoryPage.isFetching,clt=e=>({data:t})=>t.adverts.categoryPage.placement[e]??[],dlt=e=>V(clt(e),glt,llt,(t,n,o)=>[t,n,o]),ult=({data:e})=>e.adverts.categoryPage.placement.withinGrid.find(t=>t.format==="DOUBLE_TILE"||t.format==="MEDIUM_RECTANGLE"||!t.format),plt=()=>Vg("categoryPage"),mlt=({data:e})=>e.adverts.categoryPage.placement.withinGrid.filter(n=>n.format==="PRODUCT_CARD")||[],hlt=({data:e})=>e.adverts.categoryPage.placement.withinGrid.filter(n=>n.format==="SHOPPABLE")||[],glt=({data:e})=>e.adverts.categoryPage.settings,Elt=({data:e})=>e.adverts.searchPage.isFetching,flt=e=>({data:t})=>t.adverts.searchPage.placement[e]??[],ylt=e=>V(flt(e),_lt,Elt,(t,n,o)=>[t,n,o]),Ilt=({data:e})=>e.adverts.searchPage.placement.withinGrid.find(t=>t.format==="DOUBLE_TILE"||t.format==="MEDIUM_RECTANGLE"||!t.format),Slt=()=>Vg("searchPage"),Clt=({data:e})=>e.adverts.searchPage.placement.withinGrid.filter(n=>n.format==="PRODUCT_CARD"),Tlt=({data:e})=>e.adverts.searchPage.placement.withinGrid.filter(n=>n.format==="SHOPPABLE")||[],_lt=({data:e})=>e.adverts.searchPage.settings,vlt=({data:e})=>e.adverts.favoritesPage.isFetching,Alt=({data:e})=>e.adverts.favoritesPage.placement.withinGrid.find(t=>t.format==="DOUBLE_TILE"||t.format==="MEDIUM_RECTANGLE"||!t.format),blt=()=>Vg("favoritesPage"),xlt=e=>({data:t})=>t.adverts.favoritesPage.placement[e]??[],Rlt=e=>V(xlt(e),Dlt,vlt,(t,n,o)=>[t,n,o]),Dlt=({data:e})=>e.adverts.favoritesPage.settings,Olt=({data:e})=>e.adverts.promotionsPage.isFetching,Plt=({data:e})=>e.adverts.promotionsPage.placement.withinGrid.find(({format:t})=>t==="DOUBLE_TILE"||t==="MEDIUM_RECTANGLE"||!t),Nlt=()=>Vg("promotionsPage"),Llt=e=>({data:t})=>t.adverts.promotionsPage.placement[e]??[],klt=e=>V(Llt(e),Mlt,Olt,(t,n,o)=>[t,n,o]),Mlt=({data:e})=>e.adverts.promotionsPage.settings,DZt=({data:e})=>e.adverts.homepage,OZt=({data:e})=>e.adverts.homepage.isFetching,PZt=e=>({data:t})=>{const[n]=t.adverts.homepage.placement[e];return n||null},jlt=e=>({data:t})=>t.adverts.homepage.placement[e]||[],wlt=({data:e})=>e.adverts.homepage.settings,NZt=V(jlt("aboveGrid"),wlt,(e,t)=>[e.filter(({format:n})=>n==="HORIZONTAL"),t]),Flt=({data:e})=>e.adverts.homepage.placement.withinGrid.find(t=>t.format==="DOUBLE_TILE"||t.format==="MEDIUM_RECTANGLE"||!t.format),EB=()=>Vg("homepage"),LZt=({data:e})=>e.adverts.homepage.placement.withinGrid.filter(n=>n.format==="PRODUCT_CARD")||[],w9={categories:plt,search:Slt,favorites:blt,promotions:Nlt,"logged-in-homepage":EB,"logged-out-homepage":EB},F9=()=>()=>[!1,!1],Blt=(e=0,t=!1)=>{const o=e<3?e:3;return{entry:{type:"DOUBLE_TILE_ADVERT",aligned:t?"RIGHT":"LEFT",indexOnSmallScreen:o,rowIndex:1},columnsOccupancy:2}},Ult=(e=[],t=0,n=!1)=>{const o=t===1,r=Blt(e.length,n);let a=n?t-r.columnsOccupancy:0;n&&o&&(a=r.entry.indexOnSmallScreen);const i=e.slice();return i.splice(a,0,r.entry),i},Xt=(e,t,n)=>{function o(r){const i=E(e)?t:n;return i?s.jsx(i,{...r}):null}return o.fetchData=r=>{let a=e(r.context.store.getState())?t:n;return a?.WrappedComponent&&(a=a.WrappedComponent),a?.fetchData?a.fetchData(r):Promise.resolve()},o},Glt=T.picture`
    display: flex;
    block-size: 100%;
    min-block-size: 0;
`,qd=({image:e,...t})=>s.jsxs(Glt,{children:[s.jsx("source",{srcSet:e.url,type:"image/avif"}),s.jsx("img",{src:e.fallbackUrl||e.url,alt:e.altText,...t})]}),$lt={image:p.shape({url:p.string,altText:p.string})},Hlt={image:null},Vlt=T(qd)`
    display: block;
    object-fit: cover;
    inline-size: 100%;
    block-size: ${H(200)};
    border-radius: var(--salt-radius-default);
`,vN=({image:e})=>e?s.jsx(Vlt,{"data-test":"recipes-home-banner-image",image:e}):null;vN.propTypes=$lt;vN.defaultProps=Hlt;const Ylt=e=>{const{bold:t,size:n,standalone:o,intent:r,...a}=e;return s.jsx(rt,{intent:"ghost",...a})},Wlt=e=>{const{bold:t,size:n,standalone:o,intent:r,...a}=e;return s.jsx(Qe,{intent:"ghost",...a})},qlt=h.forwardRef,Klt=qlt((e,t)=>{const{as:n,isSSRNavigation:o,...r}=e;if(n)return s.jsx(yf,{as:n,...r,ref:t});if(o){const{to:a,...i}=r;return s.jsx(yf,{as:Ylt,...i,ref:t})}return s.jsx(yf,{as:Wlt,...e,ref:t})}),zlt=h.forwardRef((e,t)=>{const{formatMessage:n}=M(),o=n("loading.spinner.label");return s.jsx(yf.Skeleton,{a11yLabel:o,...e,ref:t})}),xn={...Klt,Skeleton:zlt},AN="mp",B9=()=>e=>e(Mf.getRecipesHome()).catch(()=>{}),Qlt=(e,t=[])=>n=>n(i3e({searchTerm:e,recipes:t})),Hm=({searchTerm:e,limit:t,offset:n})=>o=>o(y4e({searchTerm:e,limit:t,offset:n})).then(r=>{const{responseData:a}=r.payload;return a?.recipes?.length>0&&o(Qlt(e,r.payload.responseData.recipes)),a}).catch(()=>{}),Qp=()=>{const e=F(),t=$e(On);return[o=>{const{RECIPE_ID:r,RECIPE_NAME:a,SEQUENCE:i,LIST:l,TOTAL_TIME:c,RECIPE_COLLECTION_ID:d,SERVES:u,GROUP_TYPE:m,GROUP_SEQUENCE:g,isAdvert:f}=o;if(f){const I={event:"view_recipe_card",id:r,name:a,index:i,list:l,total_time:c,...u&&{servings:u}};J.sendEvent({GA:I,WA:null})}else{const I={event:"view_recipe_list",id:r,name:a,index:i,list:l,total_time:c,...d&&{collection_id:d},...u&&{servings:u},...m&&{group_type:m},...(g||g===0)&&{group_sequence:g}};J.sendEvent({GA:I,WA:null})}const y=U.analyticsEvent({type:f?Xx:dg,recipeImpression:o,pageViewId:t});e(y)}]},bN=()=>{const e=F(),t=$e(On);return[o=>{const r=U.analyticsEvent({type:o.isAdvert?Jx:ug,collectionImpression:o,pageViewId:t});e(r);const{RECIPE_COLLECTION_ID:a,RECIPE_COLLECTION_NAME:i,RECIPE_COUNT:l,SEQUENCE:c,LIST:d,GROUP_TYPE:u,GROUP_SEQUENCE:m}=o;if(o.isAdvert){const g={event:"view_recipe_collection_card",id:a,name:i,list:d,index:c};J.sendEvent({GA:g,WA:null})}else{const g={event:"view_recipe_collection_list",id:a,name:i,recipe_count:l,list:d,index:c,...u&&{group_type:u},...(m||m===0)&&{group_sequence:m}};J.sendEvent({GA:g,WA:null})}}]},Xlt={"search-bar":"_search-bar_zq4x8_1","search-bar__text-field":"_search-bar__text-field_zq4x8_7","search-bar__button":"_search-bar__button_zq4x8_11"},tv=Wl.bind(Xlt),U9=h.forwardRef(({name:e,onSearch:t,intent:n="primary",searchButtonVisuallyConcealedText:o,...r},a)=>{const i=l=>{l.preventDefault();const d=new FormData(l.currentTarget).get(e)?.toString()??"";t?.(d)};return s.jsxs(mt,{role:"search",ref:a,className:tv("search-bar"),onSubmit:i,children:[s.jsx(mt.TextField,{name:e,className:tv("search-bar__text-field"),...r}),s.jsxs(b,{className:tv("search-bar__button"),intent:n,type:"submit",children:[s.jsx(b.Icon,{name:"search"}),s.jsx(Ee,{children:o})]})]})}),xN=({name:e,onFocus:t,onSearch:n,placeholder:o,defaultValue:r,searchButtonText:a,...i})=>{const l=M(),c={text:o??"",isVisuallyConcealed:!0},d=l.formatMessage("salt.form.text-field.clear-button.a11y.label");return s.jsx(U9,{name:e,label:c,onFocus:t,intent:"secondary",onSearch:n,placeholder:o,defaultValue:r,clearButton:{ariaLabel:d},searchButtonVisuallyConcealedText:a,...i})},qi=(e,t,{basePath:n="",queryString:o=""}={})=>C4e(e.toLowerCase(),t,{basePath:n,queryString:o}),Hl=(e,t,{basePath:n="",queryString:o=""}={})=>A3(e.toLowerCase(),t,{basePath:n,queryString:o}),pI=(e,t,{basePath:n="",queryString:o=""}={})=>T4e(e.toLowerCase(),t,{basePath:n,queryString:o}),RN=T.div`
    max-inline-size: 24em;
`,DN=T.div`
    border-radius: var(--salt-radius-default);
    transition: box-shadow 0.2s;
    background-color: var(--intent-contrast);

    &:hover {
        box-shadow: var(--salt-elevation-shadow-1);
    }

    overflow: hidden;
    border: none;
    padding: 0;
`,Zlt=T.div`
    position: relative;
`,Jlt=T(Qe)`
    inline-size: 100%;
    text-decoration: none;

    &:hover {
        text-decoration: none;
    }

    &:active {
        text-decoration: none;
    }
`,ect=T.div`
    inline-size: 100%;
    block-size: 100%;
    background-color: var(--intent-secondary-200);
`,tct=T.div`
    inline-size: 100%;
    block-size: ${H(160)};

    ${({$responsiveHeight:e})=>e?De`
                  ${oe.smUp`
                    height: ${H(200)};
                  `};
              `:""}
`,sct=T(qd)`
    display: block;
    object-fit: cover;
    object-position: 50% 50%;
    inline-size: 100%;
    block-size: 100%;
`,nct=T.div`
    block-size: ${H(40)};
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
    word-break: break-word;
    @supports (-webkit-line-clamp: 2) {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: initial;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: block-axis;
    }
`,oct={servings:{number:void 0},collectionId:void 0,collectionTitle:void 0,collectionSlug:void 0,searchTerm:void 0,fromCollectionsPage:!1,fromSavedRecipes:!1,groupName:void 0,groupType:void 0,groupSequence:void 0,onQueueRecipeImpression:()=>null,responsiveImageHeight:!0},hl=({recipeId:e,title:t,slug:n,image:o,totalTimeMinutes:r,servings:a,collectionId:i,collectionTitle:l,collectionSlug:c,searchTerm:d,fromCollectionsPage:u,fromSavedRecipes:m,groupName:g,groupType:f,groupSequence:y,sequence:I,list:S,onQueueRecipeImpression:C,responsiveImageHeight:_,skipLinkId:A})=>{const x=M(),R=Xg(),O=ts(),N=vt(),k=()=>{O({type:Qx,pageEventId:N,RECIPE_ID:e,RECIPE_NAME:t,TOTAL_TIME:r,INDEX:I,LIST:`${S}: ${g||"other"}`,...i&&{RECIPE_COLLECTION_ID:i},...a?.number&&{SERVINGS:a?.number},...g&&{GROUP_NAME:g},...f&&{GROUP_TYPE:f},...(y||y===0)&&{GROUP_SEQUENCE:y}});const $={event:"select_recipe",id:e,name:t,collection_id:i,servings:a?.number,total_time:r,index:I,list:`${S}: ${g||"other"}`};J.sendEvent({GA:$,WA:null})},w=Qg(([$],K)=>{$?.isIntersecting&&(C({RECIPE_ID:e,...i&&{RECIPE_COLLECTION_ID:i},RECIPE_NAME:t,...l&&{RECIPE_COLLECTION_NAME:l},SEQUENCE:I,TOTAL_TIME:r,LIST:`${S}: ${g||"other"}`,...a?.number&&{SERVES:a.number},...g&&{GROUP_NAME:g},...f&&{GROUP_TYPE:f},...(y||y===0)&&{GROUP_SEQUENCE:y}}),K.unobserve($.target))},{root:null,rootMargin:"-80px 0px 0px 0px",threshold:.5}),L={...d?{searchTerm:d}:{},...i?{collectionId:i}:{},...u?{fromCollectionsPage:u.toString()}:{},...m?{fromSavedRecipes:m.toString()}:{}},B=new URLSearchParams(L),W=ps({breakpoint:"sm-up"});return s.jsx(Zlt,{ref:w,children:s.jsx(Jlt,{state:{recipeCardClickedInMobile:W,title:t,image:o,totalTimeMinutes:r,servings:a,collectionTitle:l,collectionSlug:c,sourceEventId:N},to:{pathname:Hl(n,e),search:B.toString()},onClick:k,"data-test":"recipe-card",id:A,children:s.jsxs(DN,{children:[s.jsx(tct,{$responsiveHeight:_,children:o?s.jsx(sct,{image:o,"aria-hidden":"true"}):s.jsx(ect,{})}),s.jsxs("div",{className:"salt-p--2",children:[s.jsx(nct,{children:s.jsx(P,{asChild:!0,bold:!0,size:"l",children:s.jsx("h3",{role:f===mh.RECIPE_ASSISTANT?"presentation":void 0,children:t})})}),s.jsxs(se,{justify:"space-between",align:"center",className:"salt-m-t--2",children:[s.jsxs(se,{align:"center","data-test":"recipe-card-total-time-minutes",children:[s.jsx(me,{name:"total_time",height:18,width:18,"aria-hidden":"true"}),s.jsxs(Ee,{children:[x.formatMessage("recipe.details.totalTime"),": "]}),s.jsx(P,{className:"salt-m-l--1",children:R(r)})]}),a?.number&&s.jsxs(se,{align:"center","data-test":"recipe-card-servings",children:[s.jsx(me,{name:"servings",height:18,width:18,"aria-hidden":"true"}),s.jsxs(Ee,{children:[x.formatMessage("recipe.details.servings"),": "]}),s.jsx(P,{className:"salt-m-l--1",children:a.number})]})]})]})]})})})};hl.displayName="RecipeCard";hl.defaultProps=oct;const rct=e=>"to"in e&&!!e.to,act=e=>!!e.onClick&&!("to"in e)&&!("href"in e),ict=e=>act(e)?s.jsx(Xv.HeaderButton,{...e}):s.jsx(Xv.HeaderButton,{asChild:!0,children:rct(e)?s.jsx(Qe,{intent:"ghost",...e}):s.jsx(rt,{intent:"ghost",...e})}),oi={...Xv,HeaderButton:ict},lct=T.div`
    inline-size: 160px;
`,cct=({entityId:e,onQueueRecipeImpression:t,groupSequence:n})=>{const o=M(),a=$e(Lg).find(({id:l})=>l===e)?.recipes;if(!a?.length)return null;const i=o.formatMessage("recipe.savedRecipes.title");return s.jsx(oi,{title:s.jsx(oi.Title,{children:i}),headerButton:s.jsx(oi.HeaderButton,{to:b3(),"aria-label":o.formatMessage("recipe.seeAllSavedRecipes"),children:o.formatMessage("scroller.seeAll.button")}),"data-test":"saved-recipes",a11y:{labels:{"next-button":o.formatMessage("scroller.accessibility.viewNextIn",{title:i}),"previous-button":o.formatMessage("scroller.accessibility.viewPreviousIn",{title:i})}},children:a.map((l,c)=>s.jsx(lct,{children:s.jsx(hl,{sequence:c,responsiveImageHeight:!1,list:Oo.RecipeHome,groupName:"Saved",groupSequence:n,groupType:mh.SAVED_RECIPES,onQueueRecipeImpression:t,...l},l.recipeId)}))})},dct=T.div`
    display: grid;
`,hT=()=>s.jsx(dct,{children:s.jsx(WR,{isLoading:!0,showContentPlaceholder:!0,formatting:"small",variant:"fullImage"})});hT.displayName="CollectionLoadingCard";const uct=3,G9=()=>s.jsxs("div",{"data-test":"recipes-collection-group-skeleton",children:[s.jsx(Pe,{height:"34px",width:"40%",className:"salt-m-b--4"}),s.jsx(Pe,{height:"23px",width:"100%",className:"salt-m-b--4"}),s.jsx(He.MediaCardCollection,{"data-test":"media-card-collection-skeleton",formatting:"small",gridVariant:"auto-fill",children:[...Array(uct).keys()].map(e=>s.jsx(hT,{},`recipe-collection-skeleton-${e}`))})]}),pct=({isFetching:e,entityId:t,onQueueRecipeImpression:n,groupSequence:o})=>e?s.jsx(G9,{}):s.jsx(cct,{entityId:t,groupSequence:o,onQueueRecipeImpression:n},t),mct={image:void 0,collectionPath:void 0,groupName:void 0,groupType:void 0,groupSequence:void 0,list:void 0,isLoading:!1},hct=T.div`
    display: grid;
`,gct=T(WR)`
    ${({fullWidth:e})=>e?"max-width: none;":""};
`,zg=({collectionId:e,image:t,title:n,collectionPath:o,numberOfRecipes:r,groupName:a,groupType:i,groupSequence:l,sequence:c,list:d,onQueueCollectionImpression:u,fullWidth:m=!1,navigationCardRef:g})=>{const f=F(),{formatMessage:y}=M(),I=()=>{const _=U.analyticsEvent({type:TS,RECIPE_COLLECTION_ID:e,RECIPE_COLLECTION_NAME:n,RECIPE_COUNT:r,INDEX:c,LIST:`${d}: ${a||"other"}`,...a&&{GROUP_NAME:a},...i&&{GROUP_TYPE:i},...(l||l===0)&&{GROUP_SEQUENCE:l}});f(_);const A={event:"select_recipe_collection",id:e,name:n,recipe_count:r,list:`${d}: ${a||"other"}`,index:c};J.sendEvent({GA:A,WA:null})},C=Qg(([_],A)=>{_?.isIntersecting&&(u({RECIPE_COLLECTION_ID:e,RECIPE_COLLECTION_NAME:n,RECIPE_COUNT:r,SEQUENCE:c,LIST:`${d}: ${a||"other"}`,...a&&{GROUP_NAME:a},...i&&{GROUP_TYPE:i},...(l||l===0)&&{GROUP_SEQUENCE:l}}),A.unobserve(_.target))},{root:null,rootMargin:"-80px 0px 0px 0px",threshold:.5});return s.jsx(hct,{ref:C,"data-test":`collection-card-${e}`,children:s.jsx(gct,{ref:g,formatting:"small",variant:"fullImage",title:n,fallbackSrc:t?.fallbackUrl??t?.url,typeSrcSet:t&&{"image/avif":t.url},alt:t?.altText,to:o,content:y("recipe.count",{numberOfRecipes:r}),onClick:I,truncateTitle:!0,fullWidth:m})})};zg.displayName="CollectionCard";zg.defaultProps=mct;const ON=T(ne).attrs(()=>({forwardedAs:"h2",as:""}))`
    word-break: break-word;
`,Ect={entityId:p.string.isRequired,groupSequence:p.number,onQueueCollectionImpression:p.func,onQueueRecipeImpression:p.func},fct={groupSequence:0,onQueueCollectionImpression:()=>null,onQueueRecipeImpression:()=>null},yct={xs:6,md:4,lg:6},PN=({entityId:e,groupSequence:t,onQueueCollectionImpression:n,onQueueRecipeImpression:o})=>{const r=E(f=>f.router.location.search),i=E(f=>Lg(f))?.find(f=>f.id===e);if(!i)return null;const{title:l,description:c,collections:d,recipes:u}=i;if(!d||d.length===0||!u||u.length===0)return null;const m=d[0],g=`${qi(m.slug,m.collectionId)}${r}`;return s.jsxs("div",{"data-test":"recipes-expanded-collection",children:[s.jsx(ON,{size:"s","data-test":"recipes-expanded-collection-title",className:"salt-m-b--2",children:l}),s.jsx(P,{asChild:!0,size:"l","data-test":"recipes-expanded-collection-description",className:"salt-m-b--4",children:s.jsx("div",{children:c})}),s.jsxs(Y,{flush:!0,children:[s.jsx(Ee,{children:s.jsx(v,{id:"recipes.recipeList.ariaLabel"})}),s.jsx(Y.Item,{colSpan:{xs:12,lg:6},children:s.jsx(Y,{asChild:!0,flush:!0,children:s.jsx("ul",{children:u.map((f,y)=>s.jsx(Y.Item,{asChild:!0,colSpan:yct,children:s.jsx("li",{children:s.jsx(hl,{groupName:l,groupType:"EXPANDED_COLLECTION",groupSequence:t,sequence:y,list:Oo.RecipeHome,onQueueRecipeImpression:o,collectionId:m.collectionId,collectionTitle:m.title,collectionSlug:m.slug,...f})})},f.recipeId))})})}),s.jsx(Y.Item,{colSpan:{xs:12,lg:6},children:s.jsx(zg,{collectionId:m.collectionId,image:m.image,title:m.title,collectionPath:g,numberOfRecipes:m.numberOfRecipes,groupName:l,groupType:"EXPANDED_COLLECTION",groupSequence:t,list:Oo.RecipeHome,sequence:0,onQueueCollectionImpression:n,fullWidth:!0},m.collectionId)})]})]})};PN.propTypes=Ect;PN.defaultProps=fct;const Ict={entityId:p.string.isRequired,groupSequence:p.number,onQueueCollectionImpression:p.func},Sct={groupSequence:0,onQueueCollectionImpression:()=>null},NN=({entityId:e,groupSequence:t,onQueueCollectionImpression:n})=>{const o=E(d=>d.router.location.search),a=E(d=>Lg(d))?.find(d=>d.id===e);if(!a)return null;const{title:i,description:l,collections:c}=a;return!c||c.length===0?null:s.jsxs("div",{"data-test":"recipe-collection-group",children:[s.jsx(ON,{size:"s","data-test":"recipe-collection-group-title",className:"salt-m-b--2",children:i}),s.jsx(P,{asChild:!0,size:"l","data-test":"recipe-collection-group-description",className:"salt-m-b--4",children:s.jsx("div",{children:l})}),c&&c.length>0&&s.jsxs(h.Fragment,{children:[s.jsx(Ee,{children:s.jsx(v,{id:"recipes.recipeCollectionList.ariaLabel"})}),s.jsx(Y,{asChild:!0,flush:!0,children:s.jsx("ul",{"data-test":"media-card-collection",children:c.map((d,u)=>{const m=`${qi(d.slug,d.collectionId)}${o}`;return s.jsx(Y.Item,{asChild:!0,colSpan:{xs:12,md:6,lg:4},children:s.jsx("li",{children:s.jsx(zg,{collectionId:d.collectionId,"data-test":"collection-media-navigation-card",image:d.image,title:d.title,collectionPath:m,numberOfRecipes:d.numberOfRecipes,groupName:i,groupType:"COLLECTION_GROUP",groupSequence:t,sequence:u,list:Oo.RecipeHome,onQueueCollectionImpression:n},d.collectionId)})})})})})]})]})};NN.propTypes=Ict;NN.defaultProps=Sct;const Cct={entityId:p.string.isRequired,groupSequence:p.number,onQueueRecipeImpression:p.func},Tct={groupSequence:0,onQueueRecipeImpression:()=>null},_ct={xs:6,md:4,lg:3},LN=({entityId:e,groupSequence:t,onQueueRecipeImpression:n})=>{const r=E(c=>Lg(c))?.find(c=>c.id===e),{title:a,description:i,recipes:l}=r;return s.jsxs("div",{"data-test":"recipes-home-page-recipe-group",children:[s.jsx(ON,{size:"s",className:"salt-m-b--2",children:a}),i&&s.jsx(P,{asChild:!0,size:"l",className:"salt-m-b--4",children:s.jsx("div",{children:i})}),s.jsx(Ee,{children:s.jsx(v,{id:"recipes.recipeList.ariaLabel"})}),s.jsx(Y,{asChild:!0,flush:!0,children:s.jsx("ul",{children:l?.map((c,d)=>s.jsx(Y.Item,{asChild:!0,colSpan:_ct,children:s.jsx("li",{children:s.jsx(hl,{groupName:a,groupType:"RECIPE_GROUP",groupSequence:t,sequence:d,list:Oo.RecipeHome,onQueueRecipeImpression:n,...c})})},c.recipeId))})})]})};LN.propTypes=Cct;LN.defaultProps=Tct;const vct={recipesHomeDetailsData:p.shape({seo:p.shape({metaTitle:p.string,metaDescription:p.string})}).isRequired},$9=({recipesHomeDetailsData:e})=>{const{seo:t}=e;return s.jsxs(_o,{children:[t?.metaTitle&&s.jsx("title",{children:t.metaTitle}),t?.metaDescription&&s.jsx("meta",{name:"description",content:t.metaDescription})]})};$9.propTypes=vct;const Act=T.div`
    inline-size: 100%;
`,bct=T.div`
    inline-size: 100%;
    block-size: ${H(160)};
    ${oe.smUp`
        height: ${H(200)};
    `};
`,md=()=>s.jsx(Act,{"data-test":"recipe-card-skeleton",children:s.jsxs(DN,{children:[s.jsx(bct,{children:s.jsx(Pe,{"data-test":"recipe-card-skeleton-image",height:"100%",width:"100%"})}),s.jsxs("div",{className:"salt-p--2",children:[s.jsx(Pe,{"data-test":"recipe-card-skeleton-title-1",height:"23px"}),s.jsx(Pe,{"data-test":"recipe-card-skeleton-title-2",height:"23px",width:"140px",className:"salt-m-t--1"}),s.jsxs(se,{className:"salt-m-t--1",children:[s.jsx(Pe,{height:"20px",width:"20px",className:"salt-m-r--1"}),s.jsx(Pe,{"data-test":"recipe-card-skeleton-content",height:"20px",width:"80px"})]})]})]})});md.displayName="RecipeLoadingCard";const xct={xs:6,md:4,lg:3},Rct=()=>s.jsxs("div",{"data-test":"recipes-home-recipe-group-skeleton",children:[s.jsx(Pe,{"data-test":"recipes-home-recipe-group-title-placeholder",height:"34px",width:"40%",className:"salt-m-b--4"}),s.jsx(Pe,{"data-test":"recipes-home-recipe-group-description-placeholder",height:"23px",width:"100%",className:"salt-m-b--4"}),s.jsx(Y,{children:[...Array(4).keys()].map(e=>s.jsx(Y.Item,{colSpan:xct,children:s.jsx(md,{})},e))})]}),Dct=4,Oct={xs:6,md:4,lg:6},Pct=()=>s.jsxs("div",{"data-test":"recipes-expanded-collection-skeleton",children:[s.jsx(Pe,{height:"34px",width:"40%",className:"salt-m-b--4"}),s.jsx(Pe,{height:"23px",width:"100%",className:"salt-m-b--4"}),s.jsxs(Y,{children:[s.jsx(Y.Item,{colSpan:{xs:12,lg:6},children:s.jsx(Y,{fluid:!0,children:[...Array(Dct).keys()].map(e=>s.jsx(Y.Item,{role:"listitem",...Oct,children:s.jsx(md,{})},e))})}),s.jsx(Y.Item,{colSpan:{xs:12,lg:6},children:s.jsx(hT,{})})]})]}),Nct=({searchText:e})=>s.jsxs(ie.Fragment,{children:[s.jsx(Pe,{height:"50px",width:"40%",className:"salt-m-t--4"}),s.jsx(Pe,{height:"144px"}),s.jsx(xN,{name:"recipeSearch",placeholder:e,searchButtonText:e,"data-test":"recipes-home-recipe-search-skeleton"}),s.jsx(Rct,{}),s.jsx(G9,{}),s.jsx(Pct,{})]}),kN=()=>"/meal-plan",Lct=()=>"/meals",kct=T(ve)`
    align-items: center;
`,Mct=({onClick:e})=>{const{formatMessage:t}=M();return s.jsxs(kct,{className:"salt-d--flex",children:[s.jsx(P,{children:t("mealplanning.entry-point.recipes.title")}),s.jsx(b,{onClick:e,intent:"secondary",size:"s",className:"salt-m-l--auto",asChild:!0,children:s.jsx(Qe,{to:kN(),intent:"ghost",children:t("mealplanning.entry-point.recipes.button")})})]})},jct=()=>{const{formatMessage:e}=M(),t=ho(),n=We(),o=ts(),r=d7(),a=$e(Yt),i=$e(E4e),l=$e(f4e),c=$e(D(AN)),d=$e(Lg),[u]=Qp(),[m]=bN(),g=e("recipe.search"),f=e("recipe.browseCollection.label"),y=e("recipe.browseCollection.description"),I=A=>{A?.trim()&&(n(eI({queryString:us.stringify({searchTerm:A})})),t(Hm({searchTerm:A})).then(x=>{r(A,x?.totalRecipes)}))},S=()=>{const A=U.analyticsEvent({type:mV});t(A)},C=()=>{const A=U.analyticsEvent({type:bV});t(A)},_=()=>{o({type:eR})};return h.useEffect(()=>{!a&&!i.isFetching&&t(B9())},[]),i.fetchError&&i?.error?.statusCode===404?s.jsx(lt,{}):i.fetchError?s.jsx(ur,{showRefreshLink:!0}):i.isFetching&&!i.data.homePageEntities.length?s.jsx("div",{className:"salt-m-x--4 salt-p-t--4",children:s.jsx(Y,{fixed:!0,flush:!0,children:s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(se,{direction:"column",wrap:"nowrap",gap:["lg"],children:s.jsx(Nct,{searchText:g})})})})}):s.jsxs("div",{className:"salt-m-x--4 salt-p-t--4","data-test":"recipes-home-page",children:[i.data&&s.jsx($9,{recipesHomeDetailsData:i.data}),s.jsxs(Y,{fixed:!0,flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(ne,{as:"h1",children:s.jsx(v,{id:"recipes.breadcrumb.recipesHomePage"})})}),l?.url&&s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(vN,{image:l})}),c&&s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Mct,{onClick:C})}),s.jsx(Y.Item,{id:"recipeSearch",colSpan:{xs:12},children:s.jsx(xN,{name:"recipeSearch",onSearch:I,placeholder:g,onFocus:_,searchButtonText:g})}),d?.length>0&&s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(se,{direction:"column",wrap:"nowrap",gap:["lg"],children:d.map(({id:A,type:x},R)=>{switch(x){case"RECIPE_GROUP":return s.jsx(LN,{entityId:A,groupSequence:R,onQueueRecipeImpression:u},A);case"COLLECTION_GROUP":return s.jsx(NN,{entityId:A,groupSequence:R,onQueueCollectionImpression:m},A);case"EXPANDED_COLLECTION":return s.jsx(PN,{entityId:A,groupSequence:R,onQueueRecipeImpression:u,onQueueCollectionImpression:m},A);case"SAVED_RECIPES":return s.jsx(pct,{isFetching:i.isFetching,entityId:A,groupSequence:R,onQueueRecipeImpression:u},A);default:return null}})})}),s.jsx(Y.Item,{colSpan:{xs:12,lg:6},className:"salt-p-t--8",children:s.jsx(xn,{"data-test":"browse-collections-card",title:{text:f,as:"h3"},description:y,icon:"view_list",onClick:S,to:Kc()})})]})]})},H9=()=>s.jsx(os,{type:"Recipes-RecipesHome::route",children:s.jsx(jct,{})});H9.fetchData=async({context:{store:e}})=>(await e.dispatch(B9()),Promise.resolve());const V9=({recipeCollectionId:e,recipeId:t})=>async(n,o)=>{try{const r=o(),a=Yt(r),i=await n(GO.getRecipeDetails({recipeCollectionId:e,recipeId:t}));return a&&n(v4e(t)),i}catch{}},wct=({recipeId:e})=>async t=>{try{await t(GO.saveRecipe(e)),z.success("recipe.details.saveRecipe.toast.saved"),t(Mc.clear())}catch{z.error("toast.notification.generic.error")}},Fct=({recipeId:e})=>async t=>{try{await t(GO.unsaveRecipe(e)),z.info("recipe.details.saveRecipe.toast.unsaved"),t(Mc.clear())}catch{z.error("toast.notification.generic.error")}},Bct=T.div`
    overflow: hidden;
    display: ${({$expanded:e})=>e?"block":"-webkit-box"};
    -webkit-line-clamp: ${({$visibleLines:e})=>e};
    -webkit-box-orient: block-axis;

    ${oe.mdUp`
        -webkit-line-clamp: ${({$visibleLinesMdUp:e})=>e};
    `}
`,Y9=({heading:e,visibleLines:t=2,visibleLinesMdUp:n=7,children:o})=>{const{formatMessage:r}=M(),a=h.useRef(null),[i,l]=h.useState(!1),[c,d]=h.useState(!1);return h.useLayoutEffect(()=>{if(!a.current)return;const{clientHeight:u,scrollHeight:m}=a.current;d(u<m)},[]),s.jsxs(st,{expanded:i,onToggle:()=>l(u=>!u),aria:{expandedLabel:r("recipe.description.expand"),collapsedLabel:r("recipe.description.hide")},children:[s.jsxs(st.ControlSection,{children:[e,c&&s.jsx(st.ToggleSwitch,{})]}),s.jsx(Bct,{className:"salt-m-t--2",ref:a,$expanded:i,$visibleLines:t,$visibleLinesMdUp:n,"data-test":"expandable-text-wrapper",children:o})]})},Uct=e=>s.jsx("span",{...e}),W9=({title:e,className:t})=>s.jsx(ne,{as:Uct,"data-test":"recipe-intro-title",className:t,children:e}),Gct=()=>{const e=M(),t=$e(O4e),n=$e(P4e),o=$e(N4e),r=$e(L4e);return s.jsxs(ie.Fragment,{children:[s.jsx(Ee,{asChild:!0,children:s.jsx(ne,{as:"h2",children:t})}),s.jsxs(Y9,{heading:t?s.jsx(W9,{title:t}):null,visibleLines:4,visibleLinesMdUp:6,children:[o&&s.jsx(P,{asChild:!0,"data-test":"recipe-intro-author",className:"salt-m-b--1",children:s.jsx("div",{children:e.formatMessage("recipe.details.author.prefix",{authorName:o.name})})}),r&&s.jsx(P,{asChild:!0,className:"salt-m-b--2",children:s.jsx("div",{children:e.formatMessage("recipe.details.published.prefix",{publishedDate:e.formatDate(r,{year:"numeric",month:"long",day:"2-digit"})})})}),s.jsx(P,{"data-test":"recipe-intro-desc",children:n})]})]})},$ct=T(qd)`
    display: block;
    object-fit: cover;
    border-radius: var(--salt-radius-default);
    block-size: 100%;
    inline-size: 100%;
`,Hct=T.div`
    block-size: 100%;
    background-color: var(--intent-secondary-200);
`,fB=({image:e})=>e?s.jsx($ct,{"data-test":"recipe-image",image:e}):s.jsx(Hct,{}),q9=T.div`
    flex-basis: calc(50% - var(--salt-spacing-1));
`,gT=({iconName:e,metric:t,description:n,"data-test":o})=>s.jsx(q9,{children:s.jsx(ve,{asChild:!0,"data-test":o,"aria-labelledby":o,children:s.jsx("section",{children:s.jsxs(se,{align:"baseline",children:[s.jsx("div",{className:"salt-m-r--2","aria-hidden":"true",children:s.jsx(me,{verticalAlign:"sub",name:e})}),s.jsxs(se,{direction:"column",children:[s.jsx(ne,{as:"span",children:t}),s.jsx(P,{id:o,children:n})]})]})})})}),Vct=()=>{const e=M(),t=Xg(),n=$e($4e);return typeof n!="number"?null:s.jsx(gT,{"data-test":"recipe-metrics-cookingtime",iconName:"optional_time",metric:t(n),description:e.formatMessage("recipe.details.cookingTime")})},Yct=()=>{const e=M(),t=Xg(),n=$e(G4e);return typeof n!="number"?null:s.jsx(gT,{"data-test":"recipe-metrics-preptime",iconName:"optional_time",metric:t(n),description:e.formatMessage("recipe.details.prepTime")})},K9=({servings:e})=>{const t=M(),n=typeof e?.number!="number",o=typeof e?.caloriesPer!="number";return n?null:s.jsx(gT,{"data-test":"recipe-metrics-servings",iconName:"servings",metric:o?t.formatNumber(e?.number):t.formatMessage("recipe.details.serves",{servings:e.number}),description:o?t.formatMessage("recipe.details.servings"):t.formatMessage("recipe.details.caloriesPerServing",{calories:e.caloriesPer})})},z9=({totalTimeMinutes:e})=>{const t=M(),n=Xg();return s.jsx(gT,{"data-test":"recipe-metrics-totaltime",iconName:"total_time",metric:n(e),description:t.formatMessage("recipe.details.totalTime")})},Wct=()=>{const e=M(),t=$e(U4e),n=$e(B4e);return s.jsxs("div",{className:"salt-m-t--2 sm:salt-m-t--4",children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:e.formatMessage("recipe.details.metrics.header")})}),s.jsxs(se,{gap:["sm","sm"],gapSmUp:["md","sm"],children:[typeof t<"u"&&s.jsx(z9,{totalTimeMinutes:t}),typeof n<"u"&&s.jsx(K9,{servings:n}),s.jsx(Yct,{}),s.jsx(Vct,{})]})]})},qct=({searchTerm:e,fromCollectionsPage:t,fromSavedRecipes:n,recipeName:o})=>{const r=M(),a=F(),{recipeSlug:i,recipeId:l}=co(),c=$e(k4e),d=()=>{const m=U.analyticsEvent({type:zx,RECIPE_ID:l,RECIPE_NAME:o});a(m);const g={event:"recipe_shop_for_ingredients_click",id:l,name:o||""};J.sendEvent({GA:g,WA:null})},u=new URLSearchParams({...e?{searchTerm:e}:{},...c?{collectionId:c}:{},...t?{fromCollectionsPage:t.toString()}:{},...n?{fromSavedRecipes:n.toString()}:{}});return s.jsx(b,{intent:"primary",fill:!0,asChild:!0,"data-test":"recipe-ingredients-button",onClick:d,children:s.jsx(Qe,{intent:"ghost",to:pI(i,l,{queryString:u.toString()}),rel:"nofollow",children:s.jsx(b.Text,{children:r.formatMessage("recipe.details.shopForIngredients.link")})})})},Kct=T(ne).attrs(()=>({forwardedAs:"h2",as:""}))`
    display: inline-block;
`,zct=({method:e})=>e?.length?s.jsx(ie.Fragment,{children:e.map(({methodGroupName:t,methodGroupSteps:n},o)=>s.jsxs("div",{className:e.length-1===o?void 0:"salt-m-b--8",children:[s.jsx(ne,{as:"h3",className:"salt-m-b--4",children:t}),s.jsx(Q9,{steps:n,isWithinMethodGroup:!0})]},t))}):null,Q9=({steps:e,isWithinMethodGroup:t})=>e?.length?s.jsx(Ve,{as:"ol",inline:!1,children:e?.map(({text:n},o)=>{const r=s.jsx(v,{id:"recipe.details.methodStep",values:{stepNumber:o+1}});return s.jsx(Ve.Item,{children:s.jsxs("div",{className:e.length-1===o?void 0:"salt-m-b--4",children:[s.jsx(P,{asChild:!0,bold:!0,size:"m",className:"salt-m-b--1",children:t?s.jsx("h4",{children:r}):s.jsx("h3",{children:r})}),s.jsx(P,{"data-test":"recipe-method-step",children:n})]},n)},`method-step-${n}`)})}):null,Qct=()=>{const e=$e(w4e),t=h.useMemo(()=>e?.flatMap(({methodGroupSteps:o})=>o)?.length||0,[e]),n=h.useMemo(()=>e?.length?e.length>1?s.jsx(zct,{method:e}):s.jsx(Q9,{steps:e[0].methodGroupSteps}):null,[e]);return s.jsxs(ve,{children:[s.jsxs("div",{className:"salt-m-b--4",children:[s.jsx(Kct,{size:"m",className:"salt-m-r--2",children:s.jsx(v,{id:"recipe.details.method.heading"})}),t>0&&s.jsx(P,{"aria-hidden":e?.length===1,size:"l",children:s.jsx(v,{id:"recipe.details.method.totalSteps",values:{numberOfSteps:t}})})]}),n]})},Xct=T(ne).attrs(()=>({forwardedAs:"h2",as:""}))`
    display: inline-block;
`,Zct=()=>{const e=$e(F4e),t=h.useMemo(()=>{if(!e)return null;const n=e.map(({displayString:o})=>s.jsx(Ve.Item,{children:o},o));return s.jsx(Ve,{inline:!1,children:n})},[e]);return e?s.jsxs(ve,{"data-test":"recipe-ingredients",children:[s.jsxs("div",{className:"salt-m-b--4",children:[s.jsx(Xct,{size:"s",className:"salt-m-r--2",children:s.jsx(v,{id:"recipe.details.ingredients.heading"})}),e?.length>0&&s.jsx(P,{"aria-hidden":"true",size:"l",children:s.jsx(v,{id:"recipe.details.ingredients.totalIngredients",values:{numberOfIngredients:e.length}})})]}),t]}):null},X9=e=>e.map(t=>({"@type":"HowToStep",text:t.text})),Jct=e=>e.map(t=>({"@type":"HowToSection",name:t.methodGroupName,itemListElement:X9(t.methodGroupSteps)})),yB=({recipeData:e})=>{const{recipeId:t,slug:n,method:o,seo:r,canonicalUrl:a,localisedSeo:i}=e,l=$e(Vs),c=$e(S=>qe(S,"default-locale")),d=$e(Wt)||"",m=`https://${$e(nS)}${d}`,g=h.useMemo(()=>{const S=o?.length||0;return S?S>1?Jct(o):X9(o[0].methodGroupSteps):null},[o]),f=h.useMemo(()=>{const{author:S,cookingTimeMinutes:C,description:_,image:A,ingredients:x,prepTimeMinutes:R,publishedDate:O,servings:N,structuredDataCategory:k,structuredDataKeywords:j,title:w,totalTimeMinutes:L}=e,B={"@context":"https://schema.org/","@type":"Recipe",name:w,description:_,image:[A.fallbackUrl||A.url],author:{"@type":S.type,name:S.name},datePublished:O,totalTime:`PT${L}M`,recipeIngredient:x?.map(({displayString:W})=>W),recipeInstructions:g};return R&&(B.prepTime=`PT${R}M`),C&&(B.cookTime=`PT${C}M`),j&&(B.keywords=j.join(", ")),k&&(B.recipeCategory=k),N?.number&&(B.recipeYield=N.number),N?.caloriesPer&&N?.number&&(B.nutrition={"@type":"NutritionInformation",calories:N.caloriesPer}),JSON.stringify(B)},[e]),y=h.useMemo(()=>{const S=i?.slug;return!S||typeof S!="object"?null:Object.keys(S).filter(C=>C!==l).map(C=>{const _=S[C],x=(i?.canonicalUrl||{})[C];return s.jsx("link",{rel:"alternate",hrefLang:C,href:Am(Hl(_,t,{basePath:m,queryString:""}),C,x)},C)})},[t,i]),I=Am(Hl(n,t,{basePath:m,queryString:""}),l!==c?l:null,a);return s.jsxs(_o,{children:[s.jsx("meta",{property:"og:title",content:e.title}),s.jsx("meta",{property:"og:image",content:e.image.url}),s.jsx("meta",{property:"og:description",content:e.description}),s.jsx("meta",{property:"og:url",content:I}),r?.noIndex&&s.jsx("meta",{name:"robots",content:"noindex"}),r?.metaTitle&&s.jsx("title",{children:r.metaTitle}),r?.metaDescription&&s.jsx("meta",{name:"description",content:r.metaDescription}),r?.metaKeywords?.length>0&&s.jsx("meta",{name:"keywords",content:r.metaKeywords.join(",")}),s.jsx("link",{rel:"canonical",href:I}),y,s.jsx("script",{"data-test":"recipe-structured-data",type:"application/ld+json",children:f})]})},IB=()=>{const e=M().formatMessage("recipe.details.footer"),t=!!e&&e.trim();return t?s.jsx(ve,{"data-test":"recipe-footer-box",className:"salt-m-t--2 sm:salt-m-t--4",children:t}):null},edt=()=>s.jsx(Pe,{"data-test":"recipe-details-image-skeleton",height:"100%"}),tdt=({title:e})=>s.jsxs(ve,{"data-test":"recipe-details-intro-skeleton",children:[e?s.jsx(W9,{className:"salt-m-b--2 salt-d--inline-block",title:e}):s.jsx(Pe,{height:"24px",className:"salt-m-b--2"}),s.jsx(pe.Skeleton,{})]}),sdt=()=>s.jsxs(ve,{"data-test":"recipe-details-ingredients-skeleton",children:[s.jsx(Ns.Skeleton,{}),s.jsx("div",{className:"salt-m-t--2",children:s.jsx(pe.Skeleton,{})})]}),ndt=()=>s.jsxs(ve,{"data-test":"recipe-details-method-skeleton",children:[s.jsx(Ns.Skeleton,{}),s.jsx("div",{className:"salt-m-t--2",children:s.jsx(pe.Skeleton,{})}),s.jsx("div",{className:"salt-m-t--2",children:s.jsx(pe.Skeleton,{})}),s.jsxs("div",{className:"salt-m-t--4",children:[s.jsx(Ns.Skeleton,{}),s.jsx("div",{className:"salt-m-t--2",children:s.jsx(pe.Skeleton,{})})]})]}),lf=()=>s.jsx(q9,{children:s.jsxs(ve,{children:[s.jsx(Pe,{height:"20px",width:"60%"}),s.jsx(Pe,{width:"40%",className:"salt-m-t--2"})]})}),odt=({totalTimeMinutes:e,servings:t})=>s.jsx("div",{className:"salt-m-t--2 sm:salt-m-t--4","data-test":"recipe-details-metrics-skeleton",children:s.jsxs(se,{gap:["sm","sm"],gapSmUp:["md","sm"],children:[e?s.jsx(z9,{totalTimeMinutes:e}):s.jsx(lf,{}),t?s.jsx(K9,{servings:t}):s.jsx(lf,{}),s.jsx(lf,{}),s.jsx(lf,{})]})}),rdt=101,Vl=({isRecipeSearch:e,searchTerm:t,fromCollectionsPage:n,collectionInfo:{collectionId:o,collectionTitle:r,collectionSlug:a}={},recipeInfo:{recipeId:i,recipeTitle:l,recipeSlug:c}={},isShopForIngredients:d,isSavedRecipes:u,fromSavedRecipes:m,advertPage:g,categoryPagePath:f,searchPagePath:y})=>{const I=M(),S=put(),C=new URLSearchParams({...t?{searchTerm:t}:{},...o?{collectionId:o}:{},...n?{fromCollectionsPage:n.toString()}:{}}),_=()=>{const A=[];return(!t||e)&&!g&&A.push({name:I.formatMessage("recipes.breadcrumb.recipesHomePage"),url:Ya()}),g===Bl.CATEGORY&&A.push({name:I.formatMessage("recipes.breadcrumb.backToCategoryPage"),url:f}),g===Bl.SEARCH&&A.push({name:I.formatMessage("recipes.breadcrumb.backToProductSearchResultsPage"),url:y}),e&&A.push({name:I.formatMessage("recipes.breadcrumb.searchPage"),url:eI({queryString:t?`searchTerm=${t}`:""})}),!t&&n&&A.push({name:I.formatMessage("recipes.breadcrumb.recipesCollectionsPage"),url:Kc()}),t&&!n&&!e&&A.push({name:I.formatMessage("recipes.breadcrumb.backToSearchResultsPage"),url:eI({queryString:t?`searchTerm=${t}`:""})}),o&&a&&r&&A.push({name:r,url:qi(a,o,{queryString:n?I1:void 0})}),(u||m)&&A.push({name:I.formatMessage("recipes.breadcrumb.savedRecipesPage"),url:b3()}),i&&c&&l&&A.push({name:l,to:{pathname:Hl(c,i),search:C.toString()},navigationState:{title:l,collectionTitle:r,collectionSlug:a}}),d&&i&&c&&A.push({name:I.formatMessage("recipe.ingredients.breadcrumb"),url:pI(c,i,{queryString:C.toString()})}),A.map((x,R)=>{const O=typeof x.name=="string"&&x.name.length>=rdt&&S;return A.length-1===R&&O?{...x,name:I.formatMessage("recipe.ingredients.recipeDetails")}:x})};return s.jsx("div",{className:"salt-p-b--2 sm:salt-p-b--0",children:s.jsx(VR,{"data-test":"recipe-breadcrumb",trail:_(),linkElement:Qe})})},adt=()=>{const e=ho(),t=We(),n=Ne(),{formatMessage:o}=M(),{recipeId:r}=co(),a=$e(_n),i=$e(Ze);if(!a)return null;const l=()=>{if(i){const c=U.analyticsEvent({type:a.isSaved?aR:rR,RECIPE_ID:r,RECIPE_NAME:a.title});if(a.isSaved){const d={event:"remove_saved_recipe",id:r,name:a.title};J.sendEvent({GA:d,WA:null})}else{const d={event:"save_recipe",id:r,name:a.title};J.sendEvent({GA:d,WA:null})}e(a.isSaved?Fct({recipeId:r}):wct({recipeId:r})),e(c)}else{const c=`destination=${encodeURIComponent(`${n.pathname}${n.search}`)}`;t(Fr({queryString:c}))}};return s.jsxs(b,{intent:"secondary",fill:!0,onClick:l,"aria-label":a.isSaved?o("recipe.details.saveRecipe.accessibility.saved"):void 0,children:[s.jsx(b.Icon,{name:a.isSaved?"save_on":"save_off"}),s.jsx(b.Text,{children:o(`recipe.details.saveRecipe.${a.isSaved?"saved":"unsaved"}`)})]})},SB=T(Y.Item)`
    aspect-ratio: 1/1;
`,idt=()=>{const e=Ne(),t=us.parse(e.search),n=Vu(t.collectionId),o=Vu(t.searchTerm),r=!!t.fromCollectionsPage,a=!!t.fromSavedRecipes,{recipeId:i,recipeSlug:l}=co(),c=ho(),d=$e(Yt),u=$e(R3),m=$e(_n),g=$e(j4e),f=$e(M4e),y=uut();return h.useEffect(()=>{!d&&(!m||m.collectionId!==n)&&!u.isFetching?c(V9({recipeCollectionId:n,recipeId:i})).then(I=>{I?.payload?.responseData&&y(I.payload.responseData,n)}):d&&m&&y(m,n)},[m?.recipeId]),u.fetchError&&u.error?.statusCode===404?s.jsx(lt,{}):u.fetchError?s.jsx(ur,{showRefreshLink:!0}):u.isFetching?s.jsxs("div",{className:"salt-m-x--4 salt-p-t--4","data-test":"recipe-details-page-skeleton",children:[m&&s.jsx(yB,{recipeData:m}),s.jsxs(Y,{fixed:!0,flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Vl,{searchTerm:o,fromCollectionsPage:!!r,collectionInfo:{collectionId:n,collectionTitle:e.state?.collectionTitle,collectionSlug:e.state?.collectionSlug},recipeInfo:{recipeId:i,recipeSlug:l,recipeTitle:e.state?.title},fromSavedRecipes:!!a,advertPage:e.state?.advertPage,categoryPagePath:e.state?.categoryPagePath,searchPagePath:e.state?.searchPagePath})}),s.jsx(SB,{colSpan:{xs:12,md:6},children:e.state?.image?s.jsx(fB,{image:e.state?.image}):s.jsx(edt,{})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsxs(h.Fragment,{children:[s.jsxs(se,{gap:["sm"],children:[s.jsx(tdt,{title:e.state?.title}),s.jsx(Pe,{height:"35px","data-test":"recipe-details-ingredients-button-skeleton"}),s.jsx(Pe,{height:"35px","data-test":"recipe-details-save-button-skeleton"})]}),s.jsx(odt,{totalTimeMinutes:e.state?.totalTimeMinutes,servings:e.state?.servings})]})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(sdt,{})}),s.jsxs(Y.Item,{colSpan:{xs:12,md:6},children:[s.jsx(ndt,{}),s.jsx(IB,{})]})]})]}):s.jsxs("div",{className:"salt-m-x--4 salt-p-t--4","data-test":"recipe-details-page",children:[m&&s.jsx(yB,{recipeData:m}),s.jsxs(Y,{fixed:!0,flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Vl,{searchTerm:o,fromCollectionsPage:!!r,collectionInfo:f,recipeInfo:g,fromSavedRecipes:!!a,advertPage:e.state?.advertPage,categoryPagePath:e.state?.categoryPagePath,searchPagePath:e.state?.searchPagePath})}),s.jsx(SB,{colSpan:{xs:12,md:6},children:s.jsx(fB,{image:m?.image})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsxs(h.Fragment,{children:[s.jsxs(se,{gap:["sm"],children:[s.jsx(Gct,{}),s.jsx(qct,{searchTerm:o,fromCollectionsPage:r,fromSavedRecipes:a,recipeName:g.recipeTitle}),s.jsx(se,{gap:["sm"],basis:"100%",wrapMdUp:"nowrap",children:s.jsx(adt,{})})]}),s.jsx(Wct,{})]})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(Zct,{})}),s.jsxs(Y.Item,{colSpan:{xs:12,md:6},children:[s.jsx(Qct,{}),s.jsx(IB,{})]})]})]})},Z9=()=>s.jsx(os,{type:"Recipes-RecipeDetails::route",children:s.jsx(idt,{})});Z9.fetchData=async({context:{store:e,url:t},params:n})=>{const{recipeId:o}=n,r=t.searchParams.get("collectionId")??"",a=t.pathname,i=t.search.replace("?",""),l=gx(a,i);await e.dispatch(V9({recipeCollectionId:Vu(r),recipeId:o}));const c=e.getState(),d=R4e(c),u=D4e(c);if(!d&&u){const m=Wt(c),g=Hl(u,o,{queryString:i,basePath:m});if(l.toLowerCase()!==g.toLowerCase()){const f=Hl(u,o,{basePath:m,queryString:i});return Promise.resolve({redirectTo:f,statusCode:ai.MOVED_PERMANENTLY})}}return Promise.resolve()};const ldt=()=>{const e=M(),t=F(),{recipeId:n}=co(),o=E(On),r=()=>{const l=U.analyticsEvent({type:iR,RECIPE_ID:n});t(l);const c={event:"select_navigation",name:"View all recipes",location:"shop-for-ingredients"};J.sendEvent({GA:c,WA:null})},i=Qg(([l],c)=>{if(l?.isIntersecting){const d=U.analyticsEvent({type:lR,buttonImpression:{RECIPE_ID:n},pageViewId:o});t(d),c.unobserve(l.target)}});return s.jsx(b,{className:"salt-m-t--2","data-test":"browse-all-recipes-button",intent:"secondary",asChild:!0,onClick:r,fill:!0,ref:l=>{i.current=l},children:s.jsx(Qe,{intent:"ghost",to:S4e(),children:e.formatMessage("recipe.shopForIngredients.homePage.link")})})},J9=({recipeCollectionId:e,recipeId:t})=>(n,o)=>n(H4e({recipeCollectionId:e,recipeId:t})).then(()=>{const a=$O(o())?.flatMap(i=>i.products);a?.length&&n(Ft.setProducts({product:a.reduce((i,l)=>({...i,[l.productId]:l}),{})}))}).then(()=>{n(V4e())}).catch(()=>{}),cdt=T.div`
    /* Cap height of box to height of viewport to support overflow-y on list */
    display: grid;
    grid-template-rows: auto 1fr auto;
    max-block-size: ${`calc(100vb - ${H(ra.v2.sm)} + var(--salt-spacing-4) * 5)`};
    ${oe.lgUp`
        max-height: ${`calc(100vh - ${H(ra.v2.lgUp)} + var(--salt-spacing-4) * 5
        )`};
    `};
`,ddt=T(Ve)`
    overflow-y: auto;
`,udt=()=>{const e=$e($O);if(!e)return null;const t=e.map(({ingredient:n})=>{const{displayString:o}=n,r=`#${Co(`accordion-heading-${o}`)}`;return s.jsx(Ve.Item,{className:"salt-m--0",children:s.jsx(rt,{tabIndex:-1,href:r,standalone:!0,className:"salt-p-y--4",children:s.jsx(P,{size:"l",children:o})})},o)});return s.jsx(ve,{"aria-hidden":"true","data-test":"ingredients-index",children:s.jsxs(cdt,{children:[s.jsx(ne,{as:"h2",className:"salt-p-b--4",children:s.jsx(v,{id:"recipe.ingredients.sidebar.title"})}),s.jsx(ddt,{className:"salt-p-l--2",children:t})]})})},pdt=()=>s.jsxs(ve,{"data-test":"shop-for-ingredients-ingredient-index-skeleton",children:[s.jsx(Ns.Skeleton,{}),s.jsx("div",{className:"salt-m-t--2",children:s.jsx(pe.Skeleton,{})})]}),mdt=De`
    inline-size: ${({displayLandscapeLayout:e})=>H(e?X5:EQe)};
`,MN=({products:e,titleElement:t,a11yTitleText:n,loading:o,overrideConfig:r,featuredProducts:a,page:i="product-details",type:l="cluster",displayLandscapeLayout:c=!0})=>{const d=F(),{formatMessage:u}=M(),m=E(Ts);h.useEffect(()=>{o||d(Ci({products:e.map(({productId:I})=>({id:I})),featuredProductsData:a}))},[o]);const g=e.every(I=>Object.prototype.hasOwnProperty.call(m,I.productId)),f=typeof t=="string"?s.jsx(oi.Title,{children:t}):t,y={labels:{"next-button":u("scroller.accessibility.viewNextIn",{a11yTitleText:n}),"previous-button":u("scroller.accessibility.viewPreviousIn",{a11yTitleText:n})}};return s.jsx(oi,{flush:!0,title:f,"data-test":"fop-carousel",navigationButtonPosition:"side",a11y:y,children:e.map(({productId:I,group:S,customAnalyticsData:C},_)=>s.jsx("div",{"data-test":"carousel-fop-wrapper",children:s.jsx(ka,{productId:I,group:S,position:_,page:i,subPage:null,noOfferLink:!1,type:l,withoutHeader:!0,customStyling:mdt,displayLandscapeLayout:c,fopPositionOnPage:_,sendFopImpression:!0,loading:o||!g,overrideConfig:r,customAnalyticsData:C})},I))})},hdt=T(ne).attrs({size:"s",forwardedAs:"span"})`
    text-align: start;
    margin-block: var(--salt-spacing-4);
    margin-inline: 0;

    /* scroll position is behind page header by default */
    ${oe.lgUp`
        scroll-margin-block-start: calc(${ra.v2.lgUp}px + var(--salt-spacing-4));
    `}
    scroll-margin-block-start: calc(${ra.v2.sm}px + var(--salt-spacing-4));
`,gdt=T(is.Title)`
    block-size: auto;
`,Edt=T(is.Content)`
    padding-block-start: 0;
`,fdt=T.div`
    max-inline-size: 24em;
`,ydt=({displayString:e})=>s.jsxs(se,{justify:"center",children:[s.jsx(ne,{as:"h2",className:"salt-vc",children:s.jsx(v,{id:"recipe.shopForIngredients.ingredientHeader",values:{searchTerm:e}})}),s.jsx(fdt,{className:"salt-m-y--16",children:s.jsx(ln,{title:"recipe.ingredients.not.found.title",description:"recipe.ingredients.not.found.text",titleAs:"h3",titleIcon:"search"})})]}),Idt=({ingredient:e,products:t})=>{const{formatMessage:n}=M(),[o,r]=h.useState(!0),{displayString:a}=e,i={products:t.map(d=>d.productId),clusterBreadcrumbs:[],groupTitle:e.searchTerm,section:Lt.OTHER,name:e.searchTerm,type:Lt.SHOP_FOR_INGREDIENTS},l=Co(a),c=t.map(d=>({productId:d.productId,group:i}));return s.jsxs(h.Fragment,{children:[s.jsx(gdt,{id:`accordion-title-${l}`,"aria-controls":`accordion-content-${l}`,active:o,onClick:()=>r(!o),children:s.jsx(hdt,{className:"salt-m-y--4",id:`accordion-heading-${l}`,children:s.jsx(v,{id:"recipe.shopForIngredients.ingredientHeader",values:{searchTerm:a}})})}),s.jsx(Edt,{id:`accordion-content-${l}`,"aria-labelledby":`accordion-title-${l}`,active:o,children:c.length>0?s.jsx(MN,{type:"catalogue",page:"recipe-shop-for-ingredients",titleElement:s.jsx(oi.Title,{className:"salt-vc",children:s.jsx(v,{id:"recipe.shopForIngredients.ingredientHeader",values:{searchTerm:a}})}),a11yTitleText:n("recipe.shopForIngredients.ingredientHeader",{searchTerm:a}),products:c,loading:!1}):s.jsx(ydt,{displayString:a})})]})},Sdt=()=>{const e=$e($O);if(!e)return null;const t=e.map(n=>h.createElement(Idt,{...n,key:n.ingredient.displayString}));return s.jsx(is,{"data-test":"ingredients-accordion",children:t})},sv=()=>s.jsx(Pe,{height:"50px"}),Cdt=Array.from({length:8}).map((e,t)=>({productId:`product${t}`,group:{type:Lt.SHOP_FOR_INGREDIENTS,section:Lt.OTHER,products:[],name:"soi",clusterBreadcrumbs:[]}})),nv=()=>s.jsx("div",{className:"salt-m-b--4",children:s.jsx(MN,{loading:!0,titleElement:"",a11yTitleText:"",products:Cdt})}),Tdt=()=>s.jsxs("div",{"data-test":"shop-for-ingredients-ingredient-accordion-skeleton",children:[s.jsx(sv,{}),s.jsx(nv,{}),s.jsx(sv,{}),s.jsx(nv,{}),s.jsx(sv,{}),s.jsx(nv,{})]}),_dt=({shopForIngredientsData:e})=>{const{seo:t}=e;return s.jsxs(_o,{children:[s.jsx("meta",{name:"robots",content:"noindex"}),t?.metaTitle&&s.jsx("title",{children:t.metaTitle}),t?.metaDescription&&s.jsx("meta",{name:"description",content:t.metaDescription})]})},vdt=T.div`
    position: sticky;
    inset-block-start: calc(${ra.v2.sm}px + var(--salt-spacing-4));
    ${oe.lgUp`
        top: calc(${ra.v2.lgUp}px + var(--salt-spacing-4));
    `}
`,Adt=()=>{const e=Ne(),{collectionId:t,searchTerm:n,fromCollectionsPage:o,fromSavedRecipes:r}=us.parse(e.search),{recipeId:a}=co(),i=F(),l=$e(Yt),c=$e(W4e),d=$e(X4e),u=$e(z4e),m=$e(Q4e);return h.useEffect(()=>{if(!c.data)return;const g=c.data.ingredientSearch.map(C=>C.ingredient.searchTerm),{title:f,collectionTitle:y}=c.data,I=U.analyticsEvent({type:As.PAGE_ATTRIBUTES_MULTIPLE,attributes:{RECIPE_ID:a,RECIPE_NAME:f,RECIPE_CLUSTER_LIST:g,...t?{RECIPE_COLLECTION_ID:t}:{},...y?{RECIPE_COLLECTION_NAME:y}:{}}});i(I),c.data.ingredientSearch.reduce((C,_)=>(_.products.length||C.push(_.ingredient),C),[]).forEach(C=>{const _=U.analyticsEvent({type:tR,RECIPE_ID:a,RECIPE_NAME:f,SEARCH_TERM:C.searchTerm,INGREDIENT_NAME:C.displayString});if(i(_),a){const A={event:"recipe_ingredients_no_result",id:a,name:f,search_term:C.searchTerm,ingredient_name:C.displayString};J.sendEvent({GA:A,WA:null})}})},[c.data]),h.useEffect(()=>{!l&&!c.isFetching&&a&&i(J9({recipeCollectionId:Vu(t),recipeId:a}))},[]),c.fetchError&&c.error?.statusCode===404?s.jsx(lt,{}):c.fetchError?s.jsx(ur,{showRefreshLink:!0}):c.isFetching?s.jsxs("div",{"data-test":"shop-for-ingredients-page",children:[s.jsx(Pe,{height:"15px","data-test":"shop-for-ingredients-breadcrumbs-skeleton"}),s.jsxs(Y,{children:[s.jsx(Y.Item,{colSpan:{xs:12,md:8},children:s.jsx(Tdt,{})}),s.jsxs(Y.Item,{colSpan:{xs:12,md:4},children:[s.jsx(pdt,{}),s.jsx(Pe,{height:"35px","data-test":"shop-for-ingredients-browse-all-recipes-skeleton"})]})]})]}):s.jsxs("div",{"data-test":"shop-for-ingredients-page",children:[c.data&&s.jsx(_dt,{shopForIngredientsData:c.data}),s.jsxs(Y,{children:[s.jsxs(Y.Item,{colSpan:{xs:12,md:8},children:[s.jsx("div",{className:"salt-p-t--4 salt-p-b--2",children:s.jsx(Vl,{searchTerm:Array.isArray(n)?n[0]:n,fromCollectionsPage:!!o,collectionInfo:m,recipeInfo:u,isShopForIngredients:!0,fromSavedRecipes:!!r})}),d&&s.jsx(Sdt,{})]}),s.jsx(Y.Item,{colSpan:{xs:12,md:4},children:s.jsxs(vdt,{className:"salt-m-y--4 md:salt-m-r--2",children:[s.jsx(cs,{breakpoint:"md-up",children:s.jsx(udt,{})}),s.jsx(ldt,{})]})})]})]})},e7=()=>s.jsx(os,{type:"Recipes-ShopForIngredients::route",children:s.jsx(Adt,{})});e7.fetchData=async({context:{store:e,url:t},params:n})=>{const{recipeId:o}=n,r=t.searchParams.get("collectionId")??"",a=t.pathname,i=t.search.replace("?",""),l=gx(a,i);await e.dispatch(J9({recipeCollectionId:Vu(r),recipeId:o}));const c=e.getState(),d=q4e(c),u=K4e(c);if(!d&&u){const m=Wt(c),g=pI(u,o,{queryString:i,basePath:m});if(l.toLowerCase()!==g.toLowerCase()){const f=pI(u,o,{basePath:m,queryString:i});return Promise.resolve({redirectTo:f,statusCode:ai.MOVED_PERMANENTLY})}}return Promise.resolve()};const t7=({collectionId:e})=>t=>t(Ff.getRecipeCollectionDetails(e)).catch(()=>{}),bdt=T(qd)`
    display: block;
    object-fit: cover;
    inline-size: 100%;
    block-size: ${H(143)};
    ${oe.smUp`
        height: ${H(200)};
    `};
    ${oe.lgUp`
        height: ${H(298)};
    `};
    border-radius: var(--salt-radius-default);
`,xdt=T.div`
    block-size: ${H(143)};
    ${oe.smUp`
        height: ${H(200)};
    `};
    ${oe.lgUp`
        height: ${H(298)};
    `};
    background-color: var(--intent-secondary-200);
`,Rdt=()=>{const e=E(t=>r3e(t));return e?s.jsx(bdt,{"data-test":"recipe-collection-details-image",image:e}):s.jsx(xdt,{})},Ddt=()=>{const e=$e(P3),t=$e(o3e);return s.jsxs(ie.Fragment,{children:[s.jsx(Ee,{asChild:!0,children:s.jsx(ne,{as:"h2",children:e})}),s.jsx(Y9,{heading:s.jsx(ne,{"data-test":"recipe-collection-details-intro-title",as:"span",children:e}),children:s.jsx(P,{size:"m","data-test":"recipe-collection-details-intro-desc",children:t})})]})},Odt={xs:6,md:4,lg:3},Pdt=()=>s.jsx(se,{justify:"center",children:s.jsx(RN,{className:"salt-m-y--8",children:s.jsx(ln,{title:"recipe.collectionDetails.recipes.not.found.title",description:"recipe.collectionDetails.recipes.not.found.text",titleAs:"h3",titleIcon:"search",primaryButton:{text:"recipe.collectionDetails.recipes.not.found.button.label",to:Ya()}})})}),Ndt=({fromCollectionsPage:e})=>{const{collectionId:t,collectionSlug:n}=co(),o=E(i=>P3(i)),r=E(i=>a3e(i)),[a]=Qp();return!r||r.length===0?s.jsx(Pdt,{}):r.length>0?s.jsxs(h.Fragment,{children:[s.jsx(Ee,{children:s.jsx(v,{id:"recipes.recipeList.ariaLabel"})}),s.jsx(Y,{asChild:!0,flush:!0,children:s.jsx("ul",{children:r.map((i,l)=>s.jsx(Y.Item,{asChild:!0,colSpan:Odt,children:s.jsx("li",{children:s.jsx(hl,{collectionId:t,collectionTitle:o,collectionSlug:n,fromCollectionsPage:e,sequence:l,list:Oo.RecipeCollectionDetails,onQueueRecipeImpression:a,...i})})},i.recipeId))})})]}):null},Ldt=({recipeCollectionDetailsData:e})=>{const{collectionId:t,slug:n,canonicalUrl:o,seo:r,localisedSeo:a}=e,i=E(f=>Vs(f)),l=E(f=>qe(f,"default-locale")),c=E(Wt)||"",u=`https://${E(nS)}${c}`,m=h.useMemo(()=>{const{recipes:f}=e,y={"@context":"https://schema.org/","@type":"ItemList",itemListElement:[]};return f&&(y.itemListElement=f.map((I,S)=>({"@type":"ListItem",position:S+1,url:Am(Hl(I.slug,I.recipeId,{basePath:u,queryString:""}),i!==l?i:null,I.canonicalUrl)}))),JSON.stringify(y)},[e]),g=h.useMemo(()=>{const f=a?.slug;return!f||typeof f!="object"?null:Object.keys(f).filter(y=>y!==i).map(y=>{const I=f[y],C=(a?.canonicalUrl||{})[y];return s.jsx("link",{rel:"alternate",hrefLang:y,href:Am(qi(I,t,{basePath:u,queryString:""}),y,C)},y)})},[t,a]);return s.jsxs(_o,{children:[r?.noIndex&&s.jsx("meta",{name:"robots",content:"noindex"}),r?.metaTitle&&s.jsx("title",{children:r.metaTitle}),r?.metaDescription&&s.jsx("meta",{name:"description",content:r.metaDescription}),r?.metaKeywords&&r.metaKeywords.length>0&&s.jsx("meta",{name:"keywords",content:r.metaKeywords.join(",")}),s.jsx("link",{rel:"canonical",href:Am(qi(n,t,{basePath:u,queryString:""}),i!==l?i:null,o)}),g,s.jsx("script",{"data-test":"recipe-collection-details-structured-data",type:"application/ld+json",children:m})]})},kdt=T.div`
    inline-size: 100%;
    block-size: ${H(143)};
    ${oe.smUp`
        height: ${H(200)};
    `};
    ${oe.lgUp`
        height: ${H(298)};
    `};
`,Mdt=()=>s.jsx(kdt,{children:s.jsx(Pe,{"data-test":"recipe-collection-details-image-skeleton",height:"100%"})}),jdt=()=>s.jsx(ve,{"data-test":"recipe-collection-details-intro-skeleton",children:s.jsx(Ns.Skeleton,{})}),wdt={xs:6,md:4,lg:3},Fdt=T(Y)`
    grid-auto-flow: dense;
`,Bdt=()=>s.jsx("div",{className:"salt-m-x--4","data-test":"recipe-collection-details-page",children:s.jsxs(Fdt,{fixed:!0,flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12,md:6},className:"salt-p-t--4",children:s.jsx(Pe,{height:"15px","data-test":"recipe-collection-details-breadcrumbs-skeleton"})}),s.jsx(Y.Item,{colSpan:{xs:12,lg:7},colStart:{lg:6},children:s.jsx(Mdt,{})}),s.jsx(Y.Item,{colSpan:{xs:12,lg:5},colStart:{lg:1},children:s.jsx(jdt,{})}),s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Y,{flush:!0,children:[...Array(12).keys()].map(e=>s.jsx(Y.Item,{colSpan:wdt,children:s.jsx(md,{})},`recipe-card-skeleton-${e}`))})})]})}),Udt=T(Y)`
    grid-auto-flow: dense;
`,Gdt=()=>{const e=Ne(),t=us.parse(e.search),{fromCollectionsPage:n}=t,{collectionId:o}=co(),r=F(),a=E(c=>Yt(c)),i=E(c=>e3e(c)),l=E(c=>t3e(c));return h.useEffect(()=>{!a&&!i.isFetching&&o&&r(t7({collectionId:o}))},[]),h.useEffect(()=>{if(!i.data)return;const c=U.analyticsEvent({type:oR,RECIPE_COLLECTION_ID:o,RECIPE_COLLECTION_NAME:i.data.title,RECIPE_COUNT:i.data.recipes.length});if(r(c),o){const d={event:"view_recipe_collection",id:o,name:i.data.title,recipe_count:i.data.recipes.length};J.sendEvent({GA:d,WA:null})}},[i.data]),i.fetchError&&i.error?.statusCode===404?s.jsx(lt,{}):i.fetchError?s.jsx(ur,{showRefreshLink:!0}):i.isFetching?s.jsx(Bdt,{}):s.jsxs("div",{className:"salt-m-x--4","data-test":"recipe-collection-details-page",children:[i.data&&s.jsx(Ldt,{recipeCollectionDetailsData:i.data}),s.jsxs(Udt,{fixed:!0,flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12,md:12},className:"salt-p-t--4",children:s.jsx(Vl,{fromCollectionsPage:!!n,collectionInfo:l,advertPage:e.state?.advertPage,categoryPagePath:e.state?.categoryPagePath,searchPagePath:e.state?.searchPagePath})}),s.jsx(Y.Item,{colSpan:{xs:12,lg:7},colStart:{lg:6},children:s.jsx(Rdt,{})}),s.jsx(Y.Item,{colSpan:{xs:12,lg:5},colStart:{lg:1},children:s.jsx(Ddt,{})}),s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Ndt,{fromCollectionsPage:!!n})})]})]})},s7=()=>s.jsx(os,{type:"Recipes-RecipeCollectionDetails::route",children:s.jsx(Gdt,{})});s7.fetchData=async({context:{store:e,url:t},params:n})=>{const{collectionId:o}=n,r=t.pathname,a=t.search.replace("?",""),i=gx(r,a);await e.dispatch(t7({collectionId:o}));const l=e.getState();if(!s3e(l)){const d=Wt(l),u=n3e(l);if(u){const m=qi(u,o,{queryString:a,basePath:d});if(i.toLowerCase()!==m.toLowerCase()){const g=qi(u,o,{basePath:d,queryString:a});return Promise.resolve({redirectTo:g,statusCode:ai.MOVED_PERMANENTLY})}}}return Promise.resolve()};const $dt=()=>s.jsx(_o,{children:s.jsx("meta",{name:"robots",content:"noindex"})}),ov={xs:6,md:4,lg:3},Hdt=({searchTerm:e})=>{const t=ts(),n=We(),o=()=>{t({type:pV}),n(Kc())};return s.jsx(se,{justify:"center",children:s.jsx(RN,{className:"salt-m-y--8",children:s.jsx(ln,{title:"recipe.searchPage.notFound",titleValues:{searchTerm:e},description:"recipe.searchPage.retryText",titleAs:"h3",titleIcon:"search",primaryButton:{text:"recipe.linkToBrowse",onClick:o}})})})},Vdt=({searchTerm:e})=>{const t=$e(v3),[n]=Qp(),r=$e(L3)?.[e]||[];return t.isFetching&&r?.length===0?s.jsx(Y,{flush:!0,children:[...Array(12).keys()].map(a=>s.jsx(Y.Item,{colSpan:ov,children:s.jsx(md,{})},`recipe-card-skeleton-${a}`))}):!r||r.length===0?s.jsx(Hdt,{searchTerm:e}):r.length>0?s.jsxs(h.Fragment,{children:[s.jsx(Ee,{children:s.jsx(v,{id:"recipes.recipeList.ariaLabel"})}),s.jsx(Y,{asChild:!0,flush:!0,children:s.jsxs("ul",{children:[r.map((a,i)=>s.jsx(Y.Item,{asChild:!0,colSpan:ov,children:s.jsx("li",{children:s.jsx(hl,{searchTerm:e,sequence:i,list:Oo.RecipeSearch,onQueueRecipeImpression:n,...a})})},a.recipeId)),t.isFetching&&[...Array(5).keys()].map(a=>s.jsx(Y.Item,{colSpan:ov,children:s.jsx(md,{})},`recipe-card-skeleton-${a}`))]})})]}):null},ry=50,n7=0,Ydt=()=>{const e=Ne(),{formatMessage:t}=M(),n=We(),o=d7(),r=us.parse(e.search),a=Vu(r.searchTerm),i=ts(),l=ho(),c=$e(v3),d=$e(Zw),u=$e(Zw),m=$e(L3),g=$e(Yt),f=a&&m?.[a]?.length||0,y=t("recipe.search");h.useEffect(()=>{a&&!g&&!c.isFetching&&l(Hm({searchTerm:a,limit:ry,offset:0})).then(A=>{o(a,A?.totalRecipes??0)})},[a]);const I=h.useCallback(()=>{!a||c.isFetching||!f||!u||f>=u||l(Hm({searchTerm:a,limit:ry,offset:f}))},[m,a]),S=dut(I,{root:null,rootMargin:"131px",threshold:0}),C=A=>{A?.trim()&&a!==A&&(n(eI({queryString:us.stringify({...r,searchTerm:A})})),l(Hm({searchTerm:A,limit:ry,offset:n7})).then(x=>{o(A,x?.totalRecipes??0)}))},_=()=>{i({type:eR})};return s.jsxs("div",{className:"salt-m-x--4 salt-p-t--4","data-test":"recipe-search-page",children:[s.jsx($dt,{}),s.jsxs(Y,{fixed:!0,flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Vl,{isRecipeSearch:!0,searchTerm:a})}),a&&s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(ne,{as:"h2",children:c.isFetching?s.jsx(v,{id:"recipe.search.loading",values:{searchTerm:a}}):s.jsx(v,{id:"recipe.searchPage.resultsText",values:{resultCount:d,searchTerm:a}})})}),s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(xN,{name:"recipeSearch",onSearch:C,placeholder:y,defaultValue:a,onFocus:_,searchButtonText:y})}),s.jsx(Y.Item,{colSpan:{xs:12},children:a&&s.jsx(Vdt,{searchTerm:a})})]}),s.jsx("div",{ref:S})]})},o7=()=>s.jsx(os,{type:"Recipes-RecipeSearch::route",children:s.jsx(Ydt,{})});o7.fetchData=async({context:{store:e,url:t}})=>{const n=t.searchParams.get("searchTerm");return typeof n=="string"&&await e.dispatch(Hm({searchTerm:n,limit:ry,offset:n7})),Promise.resolve()};const Wdt=(e=[],t)=>n=>n(HO({collections:e,clear:t})),r7=({limit:e,offset:t})=>n=>n(u3e({limit:e,offset:t})).then(o=>{o.payload.responseData&&o.payload.responseData.collections.length>0&&n(Wdt(o.payload.responseData.collections,t===0))}).catch(()=>{}),qdt=({onQueueCollectionImpression:e,indexOfFirstNewResult:t})=>{const n=$e(M3),o=r=>{r?.focus()};return n&&n.length>0?s.jsxs(h.Fragment,{children:[s.jsx(Ee,{children:s.jsx(v,{id:"recipes.recipeCollectionList.ariaLabel"})}),s.jsx(Y,{asChild:!0,flush:!0,children:s.jsx("ul",{"data-test":"media-card-collection",children:n.map((r,a)=>{const i=`${qi(r.slug,r.collectionId,{queryString:I1})}`;return s.jsx(Y.Item,{asChild:!0,colSpan:{xs:12,md:6,lg:4},children:s.jsx("li",{children:s.jsx(zg,{navigationCardRef:a===t?o:void 0,collectionId:r.collectionId,"data-test":"collection-media-navigation-card",image:r.image,title:r.title,collectionPath:i,numberOfRecipes:r.numberOfRecipes,list:Oo.RecipeCollections,sequence:a,onQueueCollectionImpression:e},r.collectionId)})})})})})]}):null},Kdt=({recipeCollectionsData:e,totalCollections:t,page:n,limit:o})=>{const r=$e(nS),a=()=>n<=Math.ceil(t/o)&&n>1,i=()=>n<t/o&&n>0;return s.jsxs(_o,{children:[e?.seo?.metaTitle&&s.jsx("title",{children:e.seo.metaTitle}),e?.seo?.metaDescription&&s.jsx("meta",{name:"description",content:e.seo.metaDescription}),s.jsx("link",{rel:"canonical",href:Kc({basePath:r,...n>1&&{queryString:us.stringify({page:n})}})}),a()&&s.jsx("link",{rel:"prev",href:Kc({queryString:us.stringify({page:n-1})})}),i()&&s.jsx("link",{rel:"next",href:Kc({queryString:us.stringify({page:n+1})})})]})},CB=()=>s.jsx("div",{"data-test":"recipe-collections-list-skeleton",children:s.jsx(He.MediaCardCollection,{"data-test":"media-card-collection-skeleton",formatting:"small",gridVariant:"auto-fill",children:[...Array(12).keys()].map(e=>s.jsx(hT,{},`recipe-collection-skeleton-${e}`))})}),Dc=50,zdt=0,Qdt=()=>{const e=Ne(),t=F(),n=ts(),o=us.parse(e.search),r=h.useRef(o.page&&!Array.isArray(o.page)?parseInt(o.page,10):1),a=$e(Yt),i=$e(h3e),l=$e(g3e),c=$e(M3),[d,u]=h.useState(r.current),m=(c||[]).length,[g]=bN();h.useEffect(()=>{if(!a&&!i.isFetching){const I=m?(d-1)*Dc:zdt;t(r7({limit:Dc,offset:I}))}},[d]);const f=()=>{u(d+1),n({type:hV})};if(i.fetchError&&i?.error?.statusCode===404)return s.jsx(lt,{});if(i.fetchError)return s.jsx(ur,{showRefreshLink:!0});if(i.isFetching)return s.jsx("div",{className:"salt-m-x--4 salt-p-t--4",children:s.jsxs(Y,{fixed:!0,flush:!0,"data-test":"recipe-collections-page",children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Vl,{fromCollectionsPage:!0})}),s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(CB,{})})]})});const y=l&&l>m&&d<=l/Dc;return s.jsxs("div",{className:"salt-m-x--4 salt-p-t--4","data-test":"recipe-collections-page",children:[i.data&&l&&s.jsx(Kdt,{totalCollections:l,recipeCollectionsData:i.data,limit:Dc,page:d}),s.jsxs(Y,{fixed:!0,flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Vl,{fromCollectionsPage:!0})}),s.jsx(Y.Item,{colSpan:{xs:12},children:i.isFetching?s.jsx(CB,{}):s.jsx(qdt,{onQueueCollectionImpression:g,indexOfFirstNewResult:d!==r.current?(d-r.current)*Dc:void 0})}),y&&s.jsx(Y.Item,{colSpan:{xs:12,lg:4},className:"salt-p-t--4",children:s.jsx(b,{intent:"secondary",asChild:!0,onClick:f,children:s.jsx(Qe,{intent:"ghost",to:{search:`?${us.stringify({...o,page:d+1})}`},state:{persistScroll:!0},children:s.jsx(b.Text,{children:s.jsx(v,{id:"recipe.recipesCollectionsPage.loadMoreButton"})})})})})]})]})},a7=()=>s.jsx(os,{type:"Recipes-RecipeCollections::route",children:s.jsx(Qdt,{})});a7.fetchData=async({context:{store:e,url:t}})=>{const n=t.searchParams.get("page"),r=((n&&typeof n=="string"?parseInt(n,10):1)-1)*Dc;return await e.dispatch(r7({limit:Dc,offset:r})),Promise.resolve()};const Xdt=e=>t=>t(Mc.getSavedRecipes(e)).catch(()=>{}),i7={getSavedRecipes:Xdt},Zdt={xs:6,md:4,lg:3},Jdt=()=>{const e=We(),t=()=>{e(Ya())};return s.jsx(se,{justify:"center",children:s.jsx(RN,{className:"salt-m-y--8",children:s.jsx(ln,{title:"recipe.savedRecipesPage.noRecipes",description:"recipe.savedRecipesPage.noRecipesDescription",titleAs:"h3",titleIcon:"save_on",primaryButton:{text:"recipe.linkToBrowseRecipes",onClick:t}})})})},eut=({recipes:e})=>{const[t]=Qp();return!e||e.length===0?s.jsx(Jdt,{}):s.jsxs(h.Fragment,{children:[s.jsx(Ee,{children:s.jsx(v,{id:"recipes.recipeList.ariaLabel"})}),s.jsx(Y,{asChild:!0,flush:!0,children:s.jsx("ul",{children:e.map((n,o)=>s.jsx(Y.Item,{asChild:!0,colSpan:Zdt,children:s.jsx("li",{children:s.jsx(hl,{fromSavedRecipes:!0,sequence:o,list:`${mh.SAVED_RECIPES}`,onQueueRecipeImpression:t,...n})})},n.recipeId))})})]})},tut=50,sut=()=>{const[e,t]=h.useState(1),n=ts(),o=E(u=>Yt(u)),r=E(u=>S3e(u)),a=E(u=>T3e(u,e)),i=E(u=>C3e(u)),l=F();if(h.useEffect(()=>{!o&&!r.isFetching&&l(i7.getSavedRecipes(e))},[e]),r.fetchError&&r?.error?.statusCode===404)return s.jsx(lt,{});if(r.fetchError)return s.jsx(ur,{showRefreshLink:!0});if(r.isFetching){const u={xs:6,md:4,lg:3};return s.jsx("div",{className:"salt-m-x--4 salt-p-t--4",children:s.jsx(Y,{fixed:!0,flush:!0,children:[...Array(24).keys()].map(m=>s.jsx(Y.Item,{colSpan:u,children:s.jsx(md,{})},m))})})}const c=()=>{t(e+1),n({type:IV})},d=i>a.length&&e<=i/tut;return s.jsx("div",{className:"salt-m-x--4 salt-p-t--4","data-test":"saved-recipes-page",children:s.jsxs(Y,{fixed:!0,flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Vl,{isSavedRecipes:!0})}),s.jsx(Ee,{asChild:!0,children:s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"recipes.recipeList.ariaLabel"})})}),s.jsx(Y.Item,{colSpan:{xs:12},children:a&&s.jsx(eut,{recipes:a})}),d&&s.jsx(Y.Item,{colSpan:{xs:12,md:4},children:s.jsx(b,{intent:"secondary",type:"button",onClick:c,children:s.jsx(b.Text,{children:s.jsx(v,{id:"recipe.loadMoreButton"})})})})]})})},l7=()=>s.jsx(os,{type:"Recipes-SavedRecipes::route",children:s.jsx(sut,{})});l7.fetchData=async({context:{store:e}})=>(await e.dispatch(i7.getSavedRecipes(1)),Promise.resolve());const Tc=D("rec"),nut="/recipes",out="/recipes/search-results",c7="/recipes/:recipeSlug/:recipeId",rut="/recipes/:recipeSlug/:recipeId/ingredients",aut="/recipes/collections",iut="/recipes/collections/:collectionSlug/:collectionId",lut="/recipes/saved-recipes",cut=e=>[{path:iut,Component:e.Main,key:"main",children:[{index:!0,Component:Xt(Tc,s7,lt)}]},{path:rut,Component:e.Main,key:"main",children:[{index:!0,Component:Xt(Tc,e7,lt)}]},{path:aut,Component:e.Main,key:"main",children:[{index:!0,Component:Xt(Tc,a7,lt)}]},{path:c7,Component:e.Main,key:"main",children:[{index:!0,Component:Xt(Tc,Z9,lt)}]},{path:out,Component:e.Main,key:"main",children:[{index:!0,Component:Xt(Tc,o7,lt)}]},{path:lut,Component:e.Main,key:"main",children:[{index:!0,Component:Xt(Tc,l7,lt)}]},{path:nut,Component:e.Main,key:"main",children:[{index:!0,Component:Xt(Tc,H9,lt)}]}],Qg=(e,t={})=>{const n=h.useRef(null);return h.useEffect(()=>{const o=new IntersectionObserver(e,t);return n.current&&o.observe(n.current),()=>{n.current&&o.unobserve(n.current)}},[n]),n},dut=(e,t={},n=[])=>{const o=h.useRef(null),r=a=>{a[0].isIntersecting&&e()};return h.useEffect(()=>{const a=new IntersectionObserver(r,t);return o.current&&a.observe(o.current),()=>{o.current&&a.unobserve(o.current)}},[o,e,...n]),o},d7=()=>{const e=ts();return(n,o=0)=>{if(e({type:sR,RECIPE_SEARCH_SOURCE:"RECIPE_TEXT_SEARCH",RECIPE_SEARCH_TERM:n,RECIPE_SEARCH_RESULTS_COUNT:o}),o){const r={event:"recipe_search",search_term:n};J.sendEvent({GA:r,WA:null})}else{const r={event:"recipe_search_no_results",search_term:n};J.sendEvent({GA:r,WA:null})}}},uut=()=>{const e=ts();return(n,o)=>{const{recipeId:r,title:a,collectionTitle:i,totalTimeMinutes:l,prepTimeMinutes:c,cookingTimeMinutes:d,servings:u,ingredients:m,method:g}=n;e({type:nR,RECIPE_ID:r,RECIPE_NAME:a,...o&&{RECIPE_COLLECTION_ID:o},...i&&{RECIPE_COLLECTION_NAME:i},...u?.number&&{SERVINGS:u?.number},...c&&{PREP_TIME:c},...d&&{COOK_TIME:d},TOTAL_TIME:l,...u?.caloriesPer&&{METRICS:u?.caloriesPer},INGREDIENT_COUNT:m?.length,STEP_COUNT:g.reduce((y,I)=>y+I.methodGroupSteps.length,0)});const f={event:"view_recipe",id:r,name:a,total_time:l,ingredient_count:m?.length,step_count:g.reduce((y,I)=>y+I.methodGroupSteps.length,0),...o&&{collection_id:o},...u?.number&&{servings:u?.number},...c&&{prep_time:c},...d&&{cooking_time:d},...u?.caloriesPer&&{metrics:u?.caloriesPer}};J.sendEvent({GA:f,WA:null})}},Xg=()=>{const e=M();return t=>{const n=Math.floor(t/60),o=t%60,r=e.formatNumber(o,{style:"unit",unit:"minute"});if(n===0)return r;const a=e.formatNumber(n,{style:"unit",unit:"hour"});return o===0?a:`${a} ${r}`}},u7=()=>{const{pathname:e}=Ne();return e.includes(Ya())},put=()=>{const{pathname:e}=Ne();return!!Or({path:c7},e)},mut=T(nt.FixedHeightWrapper)`
    display: flex;

    ${oe.smUp`
        height: auto;
    `}

    ${({isNewProductList:e})=>e&&`
        min-width: initial;
        padding: 0;
        margin: 0;
    `}
`,hut=T(Qe)`
    max-block-size: 100%;
    flex: 1;

    ${oe.smUp`
        margin-top: 2rem;
    `}

    &, &:hover, &:active {
        text-decoration: none;
    }
`,gut=T(DN)`
    display: flex;
    flex-direction: column;
    block-size: 100%;
`,Eut=T.div`
    flex: 1;
    inline-size: 100%;
    block-size: 100%;
    background-color: var(--intent-secondary-200);
`,fut=T(qd)`
    object-fit: cover;
    object-position: 50% 50%;
    inline-size: 100%;
`,yut=T.div`
    word-break: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: initial;
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: block-axis;

    ${oe.smUp`
        -webkit-line-clamp: 2;
    `}
`,p7=({recipeId:e,title:t,slug:n,image:o,totalTimeMinutes:r,servings:a,sequence:i,productListName:l,advertPage:c,categoryPagePath:d,searchPagePath:u,isNewProductList:m})=>{const{formatMessage:g}=M(),[f]=Qp(),y=Xg(),I=ts(),S=vt(),_=Qg(([x],R)=>{x?.isIntersecting&&(f({RECIPE_ID:e,RECIPE_NAME:t,SEQUENCE:i,TOTAL_TIME:r,LIST:l,...a?.number&&{SERVES:a.number},isAdvert:!0}),R.unobserve(x.target))},{root:null,rootMargin:"-80px 0px 0px 0px",threshold:.5}),A=()=>{I({type:"RECIPE_ADVERT_CLICKED",pageEventId:S,RECIPE_ID:e,RECIPE_NAME:t,SEQUENCE:i,TOTAL_TIME:r,LIST:l,...a?.number&&{SERVES:a.number}});const x={event:"select_recipe_card",id:e,name:t,total_time:r,index:i,list:l,...a&&{servings:a.number}};J.sendEvent({GA:x,WA:null})};return s.jsx(mut,{ref:_,isNewProductList:m,children:s.jsxs(hut,{state:{image:o,totalTimeMinutes:r,servings:a,advertPage:c,categoryPagePath:d,searchPagePath:u},to:Hl(n,e),onClick:A,children:[s.jsx(Ee,{children:g("recipes.recipeAdvert.accessibilityText")}),s.jsxs(gut,{children:[o?s.jsx(fut,{image:o}):s.jsx(Eut,{}),s.jsxs("div",{className:"salt-p--2",children:[s.jsx(yut,{children:s.jsx(P,{asChild:!0,bold:!0,size:"l",children:s.jsx("h3",{children:t})})}),s.jsxs(se,{justify:"space-between",align:"center",className:"salt-m-t--2",children:[s.jsxs(se,{align:"center",children:[s.jsx(me,{name:"total_time",height:18,width:18,"aria-hidden":"true"}),s.jsxs(Ee,{children:[g("recipe.details.totalTime"),": "]}),s.jsx(P,{className:"salt-m-l--1",children:y(r)})]}),a?.number&&s.jsxs(se,{align:"center","data-test":"recipe-card-servings",children:[s.jsx(me,{name:"servings",height:18,width:18,"aria-hidden":"true"}),s.jsxs(Ee,{children:[g("recipe.details.servings"),": "]}),s.jsx(P,{className:"salt-m-l--1",children:a.number})]})]})]})]})]})})},{Body:Iut,ImageWrapper:Sut,StyledImage:Cut,TitleWrapper:Tut,Chevron:_ut,Title:vut}=gg.MediaNavigation,Aut=T(Qe)`
    flex: 1;
    flex-direction: column;
    max-block-size: 100%;

    ${oe.smUp`
        margin-top: 2rem;
    `}

    &, &:hover, &:active {
        text-decoration: none;
    }
`,but=T(Iut)`
    ${oe.smUp`
        height: auto;
    `}
`,xut=T(nt.FixedHeightWrapper)`
    display: flex;

    ${oe.smUp`
        height: auto;
    `}

    ${({isNewProductList:e})=>e&&`
        min-width: 0;
        padding: 0;
        margin: 0;
    `}
`,Rut=T(Y)`
    flex: 1;
`,QA=T(qd)`
    block-size: 100%;
    inline-size: 100%;
    aspect-ratio: 1;
    object-fit: cover;
    object-position: 50% 50%;
    background-color: var(--intent-secondary);
    border-radius: var(--salt-radius-default);
`,Dut=T(QA)`
    block-size: 0;
    min-block-size: 100%;
`,Out=T(Tut)`
    align-items: center;
`,Put=T(vut)`
    text-overflow: ellipsis;
    display: block;
    overflow: hidden;
    white-space: nowrap;
`,Nut=({image:e,recipeImages:t})=>s.jsxs(Rut,{flush:!0,className:"salt-gap--2",children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Dut,{alt:"",image:e})}),Array.from({length:4}).map((n,o)=>s.jsx(Y.Item,{colSpan:{xs:6},className:"salt-d--flex",children:t?.[o]?s.jsx(QA,{image:t[o],alt:""}):s.jsx(QA,{as:"div"})}))]}),m7=({title:e,slug:t,collectionId:n,image:o,recipeImages:r,advertPage:a,sequence:i,productListName:l,categoryPagePath:c,searchPagePath:d,numberOfRecipes:u,isNewProductList:m})=>{const[g]=bN(),f=ts(),{formatMessage:y}=M(),S=Qg(([_],A)=>{_?.isIntersecting&&(g({RECIPE_COLLECTION_ID:n,RECIPE_COLLECTION_NAME:e,RECIPE_COUNT:u,SEQUENCE:i,LIST:l,isAdvert:!0}),A.unobserve(_.target))},{root:null,rootMargin:"-80px 0px 0px 0px",threshold:.5}),C=()=>{const _=vt();f({type:Zx,pageEventId:_,RECIPE_COLLECTION_ID:n,RECIPE_COLLECTION_NAME:e,SEQUENCE:i,LIST:l});const A={event:"select_recipe_collection_card",id:n,name:e,index:i,list:l};J.sendEvent({GA:A,WA:null})};return s.jsx(xut,{ref:S,isNewProductList:m,children:s.jsxs(Aut,{className:"salt-d--flex salt-gap--2",state:{advertPage:a,categoryPagePath:c,searchPagePath:d},to:qi(t,n),onClick:C,children:[s.jsx(Ee,{children:y("recipes.recipeCollectionAdvert.accessibilityText")}),s.jsx(cs,{breakpoint:"sm-up",remainInDom:!1,children:s.jsx(Nut,{image:o,recipeImages:r})}),s.jsxs(but,{children:[s.jsx(Kt,{breakpoint:"sm-up",remainInDom:!1,children:s.jsx(Sut,{children:s.jsx(Cut,{alt:"",image:o,as:qd})})}),s.jsxs(Out,{className:"salt-d--flex",children:[s.jsx(Put,{children:e}),s.jsx(_ut,{height:"24",name:"arrow_right"})]})]})]})})},Lut=D("sa.fav"),kut=D("fbf"),Mut={actions:p.shape({analyticsEvent:p.func.isRequired,productClickEvent:p.func.isRequired,productClickGa4Event:p.func.isRequired,contentExperienceFeatureProductClickEvent:p.func.isRequired}).isRequired,type:p.oneOf(["catalogue","basket","order","slotbooking"]).isRequired,fopView:p.string,intl:p.any.isRequired,calendarDateFormat:p.string.isRequired,updateBasketQuantity:p.func.isRequired,productGroups:p.arrayOf(p.shape({products:p.arrayOf(p.string.isRequired)})),visibleProductsByProductId:p.objectOf(ml).isRequired,registerFopRef:p.func,page:p.string.isRequired,subPage:p.string,currentBreakpoint:p.string,rankingScoreByProductId:p.objectOf(p.string),breadcrumbValue:p.string,noOfferLink:p.bool,orderId:p.string,draftBasketId:p.string,hideMoreOptions:p.bool,fopControlsFactory:p.func,showMissedPromotions:p.bool,isNextPageFetching:p.bool,displayLandscapeLayout:p.bool.isRequired,pageEventId:p.string,defaultMaxNumFavoritesProductsDisplayed:p.string.isRequired,pageViewId:p.string.isRequired,withoutHeader:p.bool,isShowFavouritesTile:p.bool.isRequired,isFilterByFavourites:p.bool.isRequired,location:p.shape({query:{favoritesOnly:p.string}}).isRequired,withinGridProductCards:p.arrayOf(p.shape({position:p.number})),lastFetchedCatalogueLocation:p.string.isRequired},jut={productGroups:void 0,rankingScoreByProductId:{},fopView:"detail",breadcrumbValue:null,subPage:null,noOfferLink:!1,orderId:void 0,draftBasketId:void 0,registerFopRef:()=>{},hideMoreOptions:!1,fopControlsFactory:void 0,showMissedPromotions:!1,isNextPageFetching:!1,pageEventId:void 0,currentBreakpoint:void 0,withoutHeader:!1,withinGridProductCards:[]},wut=(e,t,n,o,r)=>{if(!e)return;const a=JSON.parse(JSON.stringify(e));return a.favorite&&a.favorite.lastBought&&(a.favorite.lastBought=yt(e.favorite.lastBought,o)),a.price?.current&&(a.price.current.amount=r(a.price.current)),a.price?.original&&(a.price.original.amount=r(a.price.original)),a?.price?.unit?.current&&(a.price.unit.current.amount=r(a.price.unit.current)),e?.price?.unit?.original&&(a.price.unit.original.amount=r(a.price.unit.original)),a.price?.gross&&(a.price.gross.amount=r(a.price.gross)),a.size?.uom&&(a.size.uom=bq(n.formatMessage,a.size.uom)),Object.assign(a,t)},Fut=(e,t,n,o)=>{if(!e)return{};const r={catchWeight:t.formatMessage("fop.catchweight.unit"),taxInclusive:a=>t.formatMessage("fop.tax.inclusive",{grossPrice:a}),countryOfOriginTitle:a=>t.formatMessage("fop.country.of.origin.description",{country:a}),countryOfOriginA11yPrefix:t.formatMessage("fop.country.of.origin.a11y.prefix"),outOfStock:t.formatMessage("fop.out.of.stock.button"),notInCatalog:t.formatMessage("fop.not.in.current.catalog.button"),seeAlternatives:a=>t.formatMessage("fop.show.alternatives.text",{numberOfAlternatives:a&&a.length}),noAlternatives:t.formatMessage("fop.no.alternatives.text"),addToTrolley:t.formatMessage("fop.add.button"),addToTrolleyAlternative:a=>t.formatMessage("fop.add.button.alternative",{productName:a}),increaseQuantityInTrolleyAlternative:a=>t.formatMessage("counter.increase.quantity.button.alternative.with.product",{productName:a}),decreaseQuantityInTrolleyAlternative:a=>t.formatMessage("counter.decrease.quantity.button.alternative.with.product",{productName:a}),editQuantityTextAlternative:a=>t.formatMessage("counter.edit.quantity.input.alternative.with.product",{productName:a}),getQuantityDescriptionTextAlternative:a=>t.formatMessage("counter.quantity.description.alternative",{quantity:a}),maxQuantity:t.formatMessage("fop.max.quantity"),maxQuantityLabel:t.formatMessage("fop.max.quantity.label"),addedToBasket:t.formatMessage("fop.added"),lastBought:a=>t.formatMessage("fop.last.bought.date",{date:a}),favoriteIconDescription:t.formatMessage("fop.favorite.icon.description"),regularIconDescription:t.formatMessage("fop.regular.icon.description"),featuredLabel:t.formatMessage("fop.featured.label"),featuredLabelDescription:t.formatMessage("fop.featured.label.description"),timeRestricted:t.formatMessage("fop.time.restricted"),timeRestriction:(a,i)=>t.formatMessage("fop.time.restriction",{to:a,from:i}),limitedAvailability:(a,i)=>t.formatMessage("product.availability.limited",{addedAmount:a,requestedAmount:i}),quantity:t.formatMessage("fop.ordered.quantity"),quantityLabel:a=>t.formatMessage("fop.order.quantity.label",{quantity:a}),missing:t.formatMessage("fop.order.missing"),missingLabel:a=>t.formatMessage("fop.order.missing.label",{quantity:a}),unavailableLabel:a=>t.formatMessage("product.availability.out.of.stock",{itemQty:a}),substitute:t.formatMessage("fop.order.substitute"),substituteLabel:a=>t.formatMessage("fop.order.substitute.label",{quantity:a}),accepted:t.formatMessage("fop.order.accepted"),acceptedLabel:a=>t.formatMessage("fop.order.accepted.label",{quantity:a}),rejected:t.formatMessage("fop.order.rejected"),rejectedLabel:a=>t.formatMessage("fop.order.rejected.label",{quantity:a}),returned:t.formatMessage("fop.order.returned"),returnedLabel:a=>t.formatMessage("fop.order.returned.label",{quantity:a}),deposit:(a,i)=>t.formatMessage("deposit.badge",{price:n({amount:a,currency:i})}),depositDescription:t.formatMessage("deposit.description"),guaranteedProductLifeBadge:(a,i)=>t.formatMessage(`guaranteed.product.life.badge.${i.toLowerCase()}`,{quantity:a}),guaranteedProductLifeDescription:(a,i)=>a===1?t.formatMessage(`guaranteed.product.life.description.${i.toLowerCase()}.one`):t.formatMessage(`guaranteed.product.life.description.${i.toLowerCase()}.other`,{quantity:a}),productGroupTitle:a=>{if(a===Lt.CLUSTER)return"";const i=hS.includes(a)?"other":a;return t.formatMessage(`fop.group.title.${i}`)},productGroupMenuAccessibilityLabel:t.formatMessage("fop.group.menu.accessibility.label"),moreOptionsTitle:t.formatMessage("fop.shopping.lists.more.options"),moreOptionsAccessibilityLabel:t.formatMessage("fop.shopping.lists.more.options.accessibility.label"),inProductListTitle:t.formatMessage("fop.shopping.lists.in.product.list"),missedPromotionCompleteTextAlternative:(a,i)=>a>0?t.formatMessage("fop.added.missed.promotion.complete.text.alternative",{quantity:a,offerMessage:i}):t.formatMessage("fop.not.added.missed.promotion.complete.text.alternative",{offerMessage:i}),missedPromotionNotCompleteTextAlternative:(a,i,l,c)=>a>0?t.formatMessage("fop.added.missed.promotion.not.complete.text.alternative",{quantity:a,offerMessage:i,basketQuantity:l,requiredQuantity:c}):t.formatMessage("fop.not.added.missed.promotion.not.complete.text.alternative",{offerMessage:i,basketQuantity:l,requiredQuantity:c})};return e.price&&e.price.unit&&(e.price.unit.pricePerSuffix?r.pricePerUnit=o(e.price.unit.current.amount,e.price.unit.pricePerSuffix):e.price.unit.label&&(r.pricePerUnit=t.formatMessage(`${e.price.unit.label}`,{price:e.price.unit.current.amount}))),r};function But(e){let t=0,n=0;return{next(o,r){t+=1;const a=Cit(o,t,r);return a&&(n+=1),[e?n+1:n,a]},nextAdvert(o){n+=o},getCurrentPosition(){return n},getPositionIncludingInitialAdvert(){return e?n+1:n}}}const TB=(e,t,n,o)=>{if(!t.type)return null;let r=t.type;const a=gQ(t,n,o);if(t.clusterBreadcrumbs&&t.clusterBreadcrumbs.length>0){const i=t.clusterBreadcrumbs[t.clusterBreadcrumbs.length-1];i&&(r=i.id)}else hS.includes(t.type)&&(r="other");return{categoryId:r,clusterName:a,level:t.clusterBreadcrumbs?t.clusterBreadcrumbs.length:0,clusterSequence:t.groupIndex,productClusterSequence:t.products&&t.products.indexOf(e.productId)}},jN=({actions:{analyticsEvent:e,contentExperienceFeatureProductClickEvent:t,productClickEvent:n,productClickGa4Event:o},breadcrumbValue:r,calendarDateFormat:a,currentBreakpoint:i,intl:l,page:c,subPage:d,productGroups:u=[],draftBasketId:m,rankingScoreByProductId:g,registerFopRef:f,fopView:y,type:I,updateBasketQuantity:S,visibleProductsByProductId:C,noOfferLink:_,orderId:A,hideMoreOptions:x,fopControlsFactory:R,showMissedPromotions:O,isNextPageFetching:N,displayLandscapeLayout:k,pageEventId:j,pageViewId:w,withoutHeader:L,withinGridProductCards:B,location:W,defaultMaxNumFavoritesProductsDisplayed:$,isShowFavouritesTile:K,isFilterByFavourites:Q,lastFetchedCatalogueLocation:X})=>{const re=E(qs),ue=ze(),te=xq(),ce=w9[c],[de]=E((ce??F9)()),[ye]=fe(["cxe.by"]),Ae=new But(de),Je=y==="grid"?zp:Kp,Ie=c==="search"&&!W.query?.favoritesOnly&&K&&Q,je=()=>[...Array(10).keys()].map(Le=>s.jsx(Je,{"data-test":"fetch-next-page-skeleton",withoutHeader:L,fopView:y},`sk-${Le}`));return s.jsxs(h.Fragment,{children:[u.map((Le,Be)=>{const be=Le.type==="favorite"&&Le.products.length===Number($),he=Le.products.map((ge,Oe)=>{const Xe=Ae.getCurrentPosition(),Se=Ae.getPositionIncludingInitialAdvert(),dt=Be+1,et=Oe+1,we=dt===u.length,Ut=et===Le.products.length,ys=we&&Ut,[Xs,Ur]=alt({position:Xe+1,productCardAdverts:B,isInLastPosition:ys});Xs?.length&&Ae.nextAdvert(Xs.length);const[as,Gr]=Ae.next(Le,i),es=C[ge],nu=Le.products[0]===ge,pr=as-1,$r=Ws(c,d,Le.section),fc=Di=>{const Il=Bn(es,re);Gr&&(e({type:zt.QUEUE_PRODUCT_IMPRESSION,category:r,group:Le,page:c,productListName:$r,pageEventId:j,sequence:pr,position:pr,product:es,rankingScore:c==="search"?g[ge]:null,cluster:TB(es,Le,c,l.formatMessage),groupType:Le.type,orderId:A,missedPromotion:Di,pageViewId:w}),J.queueProductImpressionEvent({GA:{category:r,group:Le,page:c,productListName:$r,pageEventId:j,sequence:pr,position:pr,product:es,rankingScore:c==="search"?g[ge]:null,cluster:TB(es,Le,c,l.formatMessage),groupType:Le.type,orderId:A,missedPromotion:Di,pageViewId:w,isPersonalised:Le&&Le.type===Lt.PERSONALIZED,featuredProductCampaign:Il},WA:null}))},yc=wut(es,{},l,a,ue),ou=Fut(yc,l,ue,te),Ic=()=>t([es],ye),Nn=()=>{Iy(c,es,Le.type)&&Ic()},Hr=()=>{const Di=Bn(es,re);n({productName:es.name,productId:es.retailerProductId,productPrice:kl(es),productListName:$r,productPosition:as,currencyCode:es.price&&es.price.current.currency});const Il={eventLabel:es.retailerProductId,ecommType:"enhanced",eventCategory:"E-commerce",eventAction:"product_click",event:"productClick",ecommerce:{currencyCode:es.price&&es.price.current.currency,click:{actionField:{list:$r},products:[{name:es.name,id:es.retailerProductId,price:kl(es),position:as}]}}};J.sendEvent({GA:Il,WA:null}),o({product:es,position:as,productListName:$r,page:c});const Cc={event:"select_item",ecommerce:{currency:es.price&&es.price.current.currency,items:[ag({product:es,position:as,productListName:$r,page:c,featuredProductCampaign:Di})]}};J.sendEvent({GA:Cc,WA:null})},Ia=()=>{Iy(c,es)&&Ic()},to=(Di,Il)=>{const Cc={...c==="search"&&{advertPage:Bl.SEARCH,searchPagePath:X},...c==="categories"&&{advertPage:Bl.CATEGORY,categoryPagePath:X}};return Di?.map((mr,s_)=>{const ru=Il+s_;switch(mr.format){case Zy.RECIPE_CARD:return s.jsx(p7,{...Cc,...mr.fields,sequence:ru,productListName:$r?.split(":")[0]},`${mr.fields.recipeId}${mr.position}`);case Zy.COLLECTION_CARD:return s.jsx(m7,{...Cc,...mr.fields,sequence:ru,productListName:$r?.split(":")[0]},`${mr.fields.collectionId}${mr.position}`);default:return s.jsx(M9,{advert:mr,page:c,sequence:ru},`${mr.id}${mr.position}`)}})},Eo=to(Xs,Se),Sc=to(Ur,Se+1);return s.jsxs(h.Fragment,{children:[Eo,s.jsx(tlt,{productId:ge,draftBasketId:m,type:I,fopView:y,currentBreakpoint:i,onClick:Nn,sendFopProductLinkEvent:Hr,onContextMenu:Ia,onImpression:fc,updateBasketQuantity:S(es,as,Le),product:yc,position:Oe+1,group:Le,firstInGroup:nu,fopIsVisible:Gr,messages:ou,linkElement:Qe,registerRef:f,noOfferLink:_,orderId:A,hideMoreOptions:x,displayLandscapeLayout:k,fopControls:R?R({...es,productIndex:pr,page:c,subPage:d,section:Le.section,productId:ge,isDisabled:!yc?.available}):void 0,showMissedPromotions:O,page:c,subPage:d,withoutHeader:L,fopPositionOnPage:pr},`${ge}${Le.name}`),Sc]})});return Ie&&be&&he.push(s.jsx(j9,{favouritesAmount:Le.products.length},"favorite-tiles")),he}),N&&je()]})};jN.propTypes=Mut;jN.defaultProps=jut;const Uut=e=>({calendarDateFormat:da(e),location:e.router.location,defaultMaxNumFavoritesProductsDisplayed:qe(e,"default-max-num-products-displayed-in-favorites-cluster"),isShowFavouritesTile:Lut(e),isFilterByFavourites:kut(e),lastFetchedCatalogueLocation:Ox(e)}),Gut=ot({analyticsEvent:U.analyticsEvent,productClickEvent:sp.productClickGAEvent,productClickGa4Event:sp.productClickGa4Event,contentExperienceFeatureProductClickEvent:eH});function $ut(e){return ie.forwardRef((t,n)=>s.jsx(Pn.Consumer,{children:({currentBreakpoint:o})=>s.jsx(e,{...t,ref:n,currentBreakpoint:o})}))}const Hut=Ct($ut,Bt,ke(Uut,Gut))(jN),Vut=D("cfop"),Yut={type:p.oneOf(["catalogue","basket","order","slotbooking"]).isRequired,fopView:p.string,page:p.string.isRequired,productGroups:p.arrayOf(p.shape({name:p.string,type:p.string,section:p.string,groupTitle:p.string,products:p.arrayOf(p.string.isRequired),clusterBreadcrumbs:p.arrayOf(p.shape({id:p.string.isRequired,name:p.string.isRequired})),campaignId:p.string,campaignName:p.string,additionalProductAttributes:p.arrayOf(p.shape({campaignId:p.string.isRequired,campaignName:p.string.isRequired}))})),productsByProductId:p.objectOf(ml).isRequired,actions:p.shape({batchAddToBasket:p.func,batchAddItemsToDraftBasket:p.func,batchRemoveFromBasket:p.func,batchRemoveItemsFromDraftBasket:p.func,fetchFopData:p.func}).isRequired,hideTopBorder:p.bool,noOfferLink:p.bool,renderInitial:p.func,onInitialFopLoad:p.func,isFetching:p.bool.isRequired,isNextPageFetching:p.bool,rankingScoreByProductId:p.objectOf(p.string),breadcrumbValue:p.string,breadCrumbs:p.arrayOf(p.shape({id:p.string,name:p.string})).isRequired,"data-test":p.string,orderId:p.string,infiniteScrollScrollableContainerElementRef:p.oneOfType([p.object,p.shape({current:p.elementType})]),infiniteScrollScrollableElementRef:p.oneOfType([p.object,p.shape({current:p.elementType})]),hideMoreOptions:p.bool,displayLandscapeLayout:p.bool,draftBasketId:p.string,onFopVisibilityChange:p.func,fopControlsFactory:p.func,withoutShoppingListsModal:p.bool,showMissedPromotions:p.bool,pageEventId:p.string,pageViewId:p.string.isRequired,skeletonSize:p.number,withoutHeader:p.bool,withinGridProductCards:p.arrayOf(p.shape({position:p.number})),configurableFopEnabled:p.bool},Wut={renderInitial:()=>null,onInitialFopLoad:()=>null,productGroups:void 0,hideTopBorder:!1,noOfferLink:!1,rankingScoreByProductId:{},fopView:"detail",breadcrumbValue:null,"data-test":void 0,orderId:void 0,infiniteScrollScrollableContainerElementRef:void 0,infiniteScrollScrollableElementRef:void 0,hideMoreOptions:!1,draftBasketId:void 0,onFopVisibilityChange:void 0,fopControlsFactory:void 0,showMissedPromotions:!1,isNextPageFetching:!1,withoutShoppingListsModal:!1,pageEventId:void 0,skeletonSize:25,withoutHeader:!1,configurableFopEnabled:!1,withinGridProductCards:[]};function qut(e,t){if(!e)return t;const n={};return e.forEach(({id:o})=>{t[o]&&(n[o]=t[o])}),n}function Kut(e,t){const n=[];for(let o=0;o<e.length;o+=t){const r=e.slice(o,o+t);n.push(r)}return n}const wN=({productGroups:e,productsByProductId:t,actions:n,page:o,type:r,fopView:a,hideTopBorder:i,noOfferLink:l,renderInitial:c,isFetching:d,isNextPageFetching:u,onInitialFopLoad:m,rankingScoreByProductId:g,breadcrumbValue:f,breadCrumbs:y,"data-test":I,orderId:S,infiniteScrollScrollableContainerElementRef:C,infiniteScrollScrollableElementRef:_,hideMoreOptions:A,displayLandscapeLayout:x,draftBasketId:R,onFopVisibilityChange:O,fopControlsFactory:N,showMissedPromotions:k,withoutShoppingListsModal:j,pageEventId:w,configurableFopEnabled:L,pageViewId:B,skeletonSize:W,withoutHeader:$,withinGridProductCards:K})=>{const Q=h.useRef(new Set),X=()=>{if(r==="catalogue"&&o==="categories"){const de=y&&y.length>0?[...y].pop().name:"";return de?ri(de.trim()):null}return null},re=r==="slotbooking"?Lh.updateDraftBasketQuantityFactory(n.batchAddItemsToDraftBasket,n.batchRemoveItemsFromDraftBasket,R):xrt(n.batchAddToBasket,n.batchRemoveFromBasket,o,X()),ue=de=>{if(L)return s.jsx(Fc,{fitContent:!0,displayLandscapeLayout:x,withoutHeader:$,"data-test":"fetching-configurable-skeleton",children:s.jsx(ka,{loading:!0,page:o,type:r,noOfferLink:l,displayLandscapeLayout:x,withoutHeader:$,fopPositionOnPage:de})},`sk-${de}`);const ye=a==="grid"?zp:Kp;return s.jsx(ye,{"data-test":"fetching-skeleton",withoutHeader:$,fopView:a},`sk-${de}`)},te=()=>[...Array(W).keys()].map(ue),ce=async de=>{const ye=de.filter(Ie=>Q.current.has(Ie.id)?!1:(Q.current.add(Ie.id),!0));if(ye.length===0)return;const Ae=Kut(ye,30),Je=Ae.map(Ie=>n.fetchFopData({products:Ie}));try{(await Promise.allSettled(Je)).forEach((je,Le)=>{je.status==="rejected"&&Ae[Le].forEach(Be=>Q.current.delete(Be.id))})}catch{}};return s.jsxs(no.Container,{ref:_,hideTopBorder:i,"data-synthetics":"product-list","data-test":I,alignItems:L,children:[d?te():s.jsxs(h.Fragment,{children:[c(),s.jsx(Iat,{scrollableContainerElementRef:C,scrollableElementRef:_,onInitialFopLoad:m,onFopVisibilityChange:de=>O?O(de):ce(de),children:({registerRef:de,visibleFops:ye})=>s.jsx(Hut,{updateBasketQuantity:re,draftBasketId:R,type:r,fopView:a,page:o,subPage:X(),pageEventId:w,registerFopRef:de,productGroups:e,visibleProductsByProductId:qut(ye,t),rankingScoreByProductId:g,breadcrumbValue:f,noOfferLink:l,orderId:S,hideMoreOptions:A,displayLandscapeLayout:x,fopControlsFactory:N,showMissedPromotions:k,isNextPageFetching:u,pageViewId:B,withoutHeader:$,withinGridProductCards:K})})]}),s.jsx(no.Placeholder,{}),s.jsx(no.Placeholder,{}),s.jsx(no.Placeholder,{}),s.jsx(no.Placeholder,{}),s.jsx(no.Placeholder,{}),s.jsx(no.Placeholder,{}),s.jsx(no.Placeholder,{}),j?null:s.jsx(fN,{})]})};wN.propTypes=Yut;wN.defaultProps=Wut;const zut=e=>({orderId:At(e),configurableFopEnabled:Vut(e),pageViewId:On(e),breadCrumbs:_d(e)}),Qut=ot({batchAddToBasket:ca.createBatchAddToBasket(),batchRemoveFromBasket:ca.createBatchRemoveFromBasket(),batchAddItemsToDraftBasket:Lh.createBatchAddToDraftBasket(),batchRemoveItemsFromDraftBasket:Lh.createBatchRemoveFromDraftBasket(),fetchFopData:Ci}),Xp=ke(zut,Qut)(wN),rv=(e,t,n)=>t?wZe({productIdsToSort:e,idsToCompare:n}):e,Xut=T.div`
    border: 0;
    display: flex;
    flex-wrap: wrap;
    margin-inline: calc(-1 * var(--salt-spacing-2));
`,Zut=T.div`
    display: grid;
    position: relative;
    gap: var(--salt-spacing-2);

    ${oe.smUp`
        grid-template-columns: 1fr 1fr;
        column-gap: var(--salt-spacing-4);
    `}

    ${oe.lgUp`
        grid-template-columns: repeat(auto-fill, minmax(${H(184)}, 1fr));
        column-gap: var(--salt-spacing-4);
    `}
`,Jut=T.div`
    inline-size: 100%;
    margin-block-end: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-2);
`,FN=({basketProducts:e,itemGroups:t})=>{const n="basket",o=E(YC),r=E(Vx),a=E(Che),i=$Ze(),[l,c,d]=fe(["bt.spl","ofc","thcu"]),u=ps({breakpoint:"lg-up"}),m=KC(),g=E(ir),f=rv(e,m,o),y=MZe(),I=E(Ng),S=C8(),C=fg(),_=E(Ts),{currentBreakpoint:A}=h.useContext(Pn),x=A!=="lg",R=E(Q=>qe(Q,"seller-sales-enabled")==="true");h.useEffect(()=>{if(c){const Q=[];!r&&a&&(C.forEach(X=>{_[X.productId]||Q.push(X.productId)}),Q.length&&S())}},[]),h.useEffect(()=>{m&&!c&&S()},[I?.length]),h.useEffect(()=>{y()},[]);const O=R?t:[{items:f}],N=Q=>R?rv(Q,m,o):f,k=l&&u&&!d?Fs.DETAIL:i,j=Q=>({type:Lt.UNKNOWN,section:Lt.UNKNOWN,name:"",products:Q,clusterBreadcrumbs:[]}),w=(Q,X,re)=>s.jsx(n9,{position:X+1,fopPositionOnPage:X,noOfferLink:!1,loading:r,page:n,type:"basket",productId:Q,group:j(N(re)),subPage:null,missedPromotion:{missedPromotionTextAlternative:""}},Q),L=(Q,X,re)=>s.jsx(Jut,{children:s.jsx(h9,{position:X+1,fopPositionOnPage:X,noOfferLink:!1,loading:r,page:n,type:"basket",productId:Q,group:j(N(re)),subPage:null},Q)}),B=(Q,X,re)=>s.jsx(ka,{withoutHeader:!0,position:X+1,fopPositionOnPage:X,noOfferLink:!1,loading:r,page:n,type:"basket",productId:Q,group:j(N(re)),subPage:null,displayLandscapeLayout:x},Q),W={[Fs.GRID]:w,[Fs.LIST]:L,[Fs.DETAIL]:B},$=Q=>W[Q],K=i===Fs.DETAIL||l&&x&&!d?Zut:Xut;return s.jsx(h.Fragment,{children:O?.map(({groupName:Q,items:X},re)=>s.jsxs(h.Fragment,{children:[R&&Q&&s.jsx(bi,{className:"salt-d--block salt-m-t--4 salt-m-b--2",groupName:Q}),c&&s.jsx(K,{"data-synthetics":"product-list",children:X.map((ue,te)=>$(k)(ue,te,X))}),!c&&s.jsx(Xp,{onInitialFopLoad:y,productGroups:[{products:R?rv(X,m,o):f}],productsByProductId:g,page:n,type:"basket",isFetching:r,fopView:k,withoutHeader:!0})]},`${Q}${re}`))})},_B=42,vB=42,BN=60,ept=8,tpt=25,spt=(e=[])=>e.reduce((t,{quantity:{quantityInBasket:n}})=>t+n,0),h7=e=>{const t=M(),n=spt(e);return n===1?t.formatMessage("checkout.summary.basket.overview.header.items.singular",{productsQuantity:n}):t.formatMessage("checkout.summary.basket.overview.header.items",{productsQuantity:n})},g7=({name:e,basketItems:t})=>{const n=h7(t);return`${e} ${n}`},npt=(e,t)=>{const[n,o]=h.useState(0),r=a=>o(()=>a?.offsetWidth??0);return h.useEffect(()=>{const a=e.current;return r(a),window.addEventListener("resize",()=>r(a)),()=>window.removeEventListener("resize",()=>r(a))},[e,t]),n},E7=({items:e})=>{const t=F(),n=E(Ts),[o,r]=h.useState([]),a=ZR(o,250),[i,l]=h.useState(!1);h.useEffect(()=>{const c=e.map(({productId:d})=>d).filter(d=>!n[d]).filter(d=>!o.includes(d));c.length&&r([...o,...c])},[e]),h.useEffect(()=>{(async()=>{if(i||!a.length)return;l(!0);const d=a.slice(0,tpt);await t(Ci({products:d.map(m=>({id:m}))})),l(!1);const u=o.filter(m=>!d.includes(m));r(u)})()},[a])},opt=(e,t)=>e?t.slice(t.length-e).reduce((n,{quantity:{quantityInBasket:o}})=>n+o,0):0,rpt=(e,t)=>t?e.slice(0,e.length-t):e,apt=(e,t)=>{const n=t-Math.floor(e/(BN+ept))+1;return e?n<0?0:n:t-1},ipt=T.div`
    position: absolute;
    inset-inline-end: calc(var(--salt-spacing-2) * -1);
    inset-block-start: calc(var(--salt-spacing-2) * -1);
`,lpt=({quantityInBasket:e})=>e<2?null:s.jsx(ipt,{"aria-hidden":"true",children:s.jsx(al,{intent:"action",count:e})}),AB=T.div.withConfig({shouldForwardProp:e=>!["fullWidth"].includes(e)})`
    position: relative;
    inline-size: ${({fullWidth:e})=>e?"100%":`${BN}px`};
`,f7=De`
    inline-size: ${`${BN}px`};
    display: flex;
    justify-content: center;
    align-items: center;
`,cpt=T.div`
    ${f7}
`,dpt=T.button`
    border-radius: var(--salt-radius-default);
    ${f7}
`,y7=({fullWidth:e,children:t,showBadge:n=!1,blurOverlay:o,basketItem:r})=>{const a=M(),l=E(Ts)[r?.productId];if(!l)return s.jsx(AB,{fullWidth:e,children:s.jsx(ve,{asChild:!0,condensed:!0,children:s.jsx(se,{align:"center",wrap:"nowrap",children:s.jsx(Pe,{width:`${_B}px`,height:`${vB}px`})})})});const{alcohol:c,image:d,name:u}=l,{quantity:{quantityInBasket:m}}=r,g=a.formatMessage("basket.overview.header.list.accessibility.item.title",{productName:u,productQuantity:m});return s.jsx(AB,{fullWidth:e,children:s.jsxs(ve,{condensed:!0,children:[s.jsx(pc,{isActive:c,overlay:o,children:s.jsxs(se,{align:"center",wrap:"nowrap",children:[s.jsx(Vd,{alt:t?"":g,src:d?.src,width:_B,height:vB}),t]})}),n&&s.jsx(lpt,{quantityInBasket:m})]})})},upt=({quantityOfHiddenItems:e,setExpanded:t})=>{const n=M();return e?t?s.jsxs(dpt,{onClick:()=>t(o=>!o),children:[s.jsxs(P,{"aria-hidden":!0,children:["+",e]}),s.jsx(Ee,{asChild:!0,children:s.jsx("h3",{children:n.formatMessage("basket.overview.header.list.accessibility.hidden.products.counter.expandable",{quantityOfHiddenItems:e})})})]}):s.jsx(ve,{asChild:!0,condensed:!0,children:s.jsxs(cpt,{children:[s.jsxs(P,{size:"l",bold:!0,"aria-hidden":!0,children:["+",e]}),s.jsx(Ee,{asChild:!0,children:s.jsx("h3",{children:n.formatMessage("basket.overview.header.list.accessibility.hidden.products.counter",{quantityOfHiddenItems:e})})})]})}):null},ET=({visible:e,setExpanded:t,basketItems:n=[]})=>{const o=h.useRef(null),r=npt(o,e),a=apt(r,n.length),i=rpt(n,a),l=opt(a,n);return E7({items:i}),s.jsxs(se,{ref:o,className:"salt-m-t--4",gap:["sm"],children:[i.map(c=>s.jsx(y7,{basketItem:c,showBadge:!0},c.productId)),s.jsx(upt,{quantityOfHiddenItems:l,setExpanded:t})]})},Zg=({name:e,as:t,basketItems:n})=>{const o=g7({basketItems:n,name:e}),r=t||"h2";return s.jsx(Ee,{asChild:!0,children:s.jsx(r,{children:o})})},Zp=({name:e,basketItems:t,as:n,showQuantity:o=!0})=>{const r=h7(t);return s.jsxs(h.Fragment,{children:[s.jsxs(se,{as:"span",align:"baseline","data-test":"basket-overview-header",className:"salt-gap-x--2",children:[s.jsx(ne,{as:"span",children:e}),o&&s.jsx(P,{children:r})]}),!!n&&s.jsx(Zg,{basketItems:t,name:e,as:n})]})},I7=ee("GET_CARRIER_DETAILS"),ppt=e=>({type:"API",payload:{url:`/v1/carriers/${e}`,service:"ecomslots",pathPrefix:{client:"/api/ecomslots",server:"/core-api"},options:{method:"GET"},...I7}}),mpt={getCarrierDetails:ppt,types:{GET_CARRIER_DETAILS:I7}},bB={carrierDetails:null,isReady:!0},Jg=({carrierId:e,shippingGroupType:t})=>{const n=F(),o=E(nC),r=E(Tg(t)),a=e&&r,i=o.find(d=>d.carrierId===e),[l,c]=h.useState({carrierDetails:null,isReady:!1});return h.useEffect(()=>{a&&!i&&n(mpt.getCarrierDetails(e)).then(d=>{c({carrierDetails:d?.payload.responseData||null,isReady:!0})}).catch(()=>{c(bB)})},[e,t]),a?i?{carrierDetails:i,isReady:!0}:l:bB},S7=e=>!!e&&e.slotType==="ON_DEMAND"&&e.deliveryMethod==="HOME_DELIVERY",hpt=({startDate:e,endDate:t})=>{const n=M(),o=ps({breakpoint:"md-up"});if(sd(t))return n.formatMessage("delivery.relative.date.today");if(lh(t))return n.formatMessage("delivery.relative.date.tomorrow");if(fy(e,t)===0)return yt(t,Xo);const a=yt(e,Zv),i=yt(t,Zv),l=a===i?yt(e,VI):yt(e,Xo),c=yt(t,Xo);return n.formatMessage(o?"order.card.courier.title.short":"order.card.courier.title",{startDay:l,endDay:c})},gpt=({startDate:e,endDate:t})=>{const n=hpt({startDate:e,endDate:t});return s.jsx(ie.Fragment,{children:n})},eE=({dates:e,carrierType:t,slotTimesDisplayMode:n=Oq,showAsCardTitle:o=!1,ignorePrefix:r=!1})=>{const a=M(),i=E(Jt),l=E(Vt),c=t===yD,d=s.jsx(go,{dateIsoFrom:e.deliveryStartDate,dateIsoTo:e.deliveryEndDate,timeZoneId:e.timeZoneId,dateFormat:i,timeFormat:l});if(c)return s.jsx(h.Fragment,{children:!o&&!r?s.jsx(v,{id:"delivery.view.delivery.details.title",values:{content:d}}):d});const u=uGe(n,e,a);return s.jsx(h.Fragment,{children:o?s.jsx(gpt,{startDate:e.deliveryStartDate||"",endDate:e.deliveryEndDate||""}):s.jsx(h.Fragment,{children:r?u:s.jsx(v,{id:"delivery.view.delivery.details.title",values:{content:u}})})})},Ept=({slot:e})=>{const t=E(Jt),n=E(Vt);return s.jsx(P,{children:s.jsx(go,{dateIsoFrom:e.start,dateIsoTo:e.end,timeZoneId:e.timeZoneId,dateFormat:t,timeFormat:n})})},fpt=({slot:e})=>{const{deliveryTimeInMinutes:t,collectionTimeInMinutes:n}=e,o=Md(),r=o(t),a=o(n);return s.jsx(P,{children:s.jsx(v,{id:"basket.checkout.group.delivery.slot.express.collection.info",values:{readyTimeSpan:r,maxTimeSpan:a}})})},ypt=({slot:e})=>{const{formatNumber:t}=M(),{deliveryTimeInMinutes:n}=e,o=r=>t(r||0,{style:"unit",unit:"minute",unitDisplay:"short"});return s.jsx(P,{children:s.jsx(v,{id:"trolley.screen.group.checkout.slot.fast.delivery.info",values:{duration:o(n||0)}})})},Ipt=({slot:e,carrierDetails:t})=>{const n=s.jsx(eE,{dates:{deliveryStartDate:e?.start,deliveryEndDate:e?.end,deliveryTimeInMinutes:e?.deliveryTimeInMinutes,collectionTimeInMinutes:e?.collectionTimeInMinutes,timeZoneId:e?.timeZoneId},carrierType:t?.slotBookingComponent,slotTimesDisplayMode:t?.slotTimesDisplayMode,ignorePrefix:!0});return s.jsxs(P,{children:[" ",n," "]})},Spt=({slot:e,isCourierSlot:t,carrierDetails:n})=>{const o=S7(e);return t?s.jsx(Ipt,{slot:e,carrierDetails:n}):e.slotType==="ON_DEMAND"&&e.deliveryMethod==="CUSTOMER_COLLECTION"?s.jsx(fpt,{slot:e}):o?s.jsx(ypt,{slot:e}):s.jsx(Ept,{slot:e})},C7=({slot:e,slotBooked:t,className:n,shippingGroupType:o})=>{const{isReady:r,carrierDetails:a}=Jg({carrierId:e?.carrierId,shippingGroupType:o}),i=!r||!!a,l=S7(e);if(!e)return null;const c=t?s.jsx(v,{id:"basket.checkout.group.delivery.slot.booked"}):s.jsx(v,{id:"basket.checkout.group.delivery.slot.first.available"});return s.jsxs("div",{"data-test":"basket-delivery-info",className:n,children:[!(i||l)&&s.jsxs(h.Fragment,{children:[s.jsx(P,{"data-test":`basket-delivery-info-slot-${t?"booked":"available"}`,children:c})," "]}),s.jsx(Spt,{slot:e,isCourierSlot:i,carrierDetails:a})]})},UN=e=>{const t=E(Sd),n=t.length;return{order:t.findIndex(r=>r?.checkout?.shippingGroupType===e)+1,count:n}},Cpt=e=>{const t=M(),{order:n,count:o}=UN(e);return o>1?t.formatMessage("basket.checkout.group.checkout.button",{order:n,count:o}):t.formatMessage("basket.summary.checkout")},Tpt=(e,t)=>{const n=M(),{order:o,count:r}=UN(e);return n.formatMessage("basket.checkout.group.overview.header.main",{name:t,order:o,count:r})},T7=({basketSummary:e,withTaxNote:t=!0})=>{const{itemGroups:n=[],totalsGroups:o=[],items:r}=e,a=E(D("prp")),i=E(D("sib"));return s.jsx("div",{"data-test":"summary-items-by-seller-list",children:o.map(({groupName:l,totals:c},d)=>{const u=rT(n,l,r),m=!!Number(c?.savingsPrice?.amount);return u?s.jsxs(h.Fragment,{children:[d>0&&s.jsx(ae.Separator,{className:"salt-m-b--2"}),s.jsx(bi,{groupName:l,className:"salt-d--block salt-m-b--2"}),s.jsxs(pe,{"data-test":`summary-items-${ri(l)}`,children:[s.jsx(ae.Items,{itemsRetailPrice:c.itemsRetailPrice,quantity:u,withTaxNote:t}),s.jsx(ae.Savings,{savings:c.savingsPrice}),i&&a&&m&&s.jsx(Ai,{isSummarySection:!0,className:"salt-m-b--2"}),s.jsx(ae.SavingsWithPaymentMethod,{savings:c.paymentMethodSavingsPrice}),o.length>1&&s.jsx(Yg,{value:c.display?.itemPriceAfterPromos,withSeparator:!1,className:"salt-m-t--1 salt-m-b--1"})]})]},l):null})})},_pt=D("tx.nts"),vpt=Dn(["sumsub","bt.spl"]),Apt=({basketSummary:e,checkoutButtonName:t})=>{const{itemGroups:n}=e,o=e?.checkout?.shippingGroupType,r=e?.checkout?.shippingGroupTypeDisplayName,a=M(),[i]=fe(["thcu"]),[l,c]=h.useState(!1),d=ts(),u=E(j=>qe(j,"seller-sales-enabled")==="true"),{smallOrderChargeThresholds:m,shouldDisplaySmallOrderCharge:g}=JC(e),y=E(_he(o)).map(j=>j.productId),I=E(_pt),S=E(vpt),C=a.formatMessage(S?"summary.subtotal":"summary.total"),_=a.formatMessage("summary.total.note"),A=a.formatMessage("summary.subtotal.price.note"),x=S?e?.totals?.display?.itemPriceAfterPromos:e?.totals?.display?.finalPrice,R=Tpt(o,r),O=E(Hx(o)),N=g7({name:R,basketItems:O}),k=h.useMemo(()=>({expanded:l,onToggle:()=>{d({type:l?Fe.ITEM_WINDOW_REDUCED:Fe.ITEM_WINDOW_EXPANDED}),c(!l)},aria:{expandedLabel:N,collapsedLabel:N}}),[l,N,d]);return s.jsxs(HS.Provider,{value:k,children:[s.jsx(Zg,{basketItems:O,name:R}),s.jsxs(ve,{children:[s.jsxs(st.ControlSection,{children:[s.jsx(Zp,{basketItems:O,name:R,showQuantity:!i}),s.jsx(st.ToggleSwitch,{"data-test":"collapsible-box-toggle-switch"})]}),s.jsxs(st.ContentCollapsed,{maxHeight:"100px",children:[s.jsx(ET,{basketItems:O,visible:!l,setExpanded:c}),s.jsx(Kt,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(ae.Separator,{className:"salt-m-t--4"})})]}),!i&&s.jsx(st.ContentExpanded,{children:s.jsx(C7,{slotBooked:!!e.slot,slot:e.slot||e.nextAvailableSlot,shippingGroupType:o,className:"salt-m-t--4"})}),s.jsx(Kt,{breakpoint:"lg-up",remainInDom:!1,children:s.jsxs(st.ContentCollapsed,{children:[s.jsx(ae.TotalSpaceBetween,{loading:!e,totalPrice:x,withTaxNote:I,title:C,note:S?A:_}),s.jsx(Oh,{loyalty:e?.loyalty?.earnings}),s.jsx(tp,{basketSummary:e,dataTest:"minimum-order-summary"}),g&&s.jsx(pd,{thresholds:m,orderId:e?.orderId,page:"basket",className:"salt-m-t--2"}),s.jsx(ae.Buttons,{loading:!e,children:s.jsx(ep,{name:t,basketSummary:e,className:"salt-m-t--4"})})]})})]}),s.jsxs(st.ContentExpanded,{maxHeight:"100%",overflow:"visible",children:[s.jsx("div",{className:"salt-m-t--2 lg:salt-m-t--4",children:s.jsx(FN,{basketProducts:y,itemGroups:n})}),s.jsx(Kt,{breakpoint:"lg-up",remainInDom:!1,children:s.jsxs(ve,{className:"salt-m-t--2",children:[u?s.jsx(T7,{basketSummary:e,withTaxNote:I}):s.jsx(pQ,{basketSummary:e,withTaxNote:I,summarySubtotalEnabled:S}),s.jsx(ae.Separator,{}),s.jsx(ae.TotalSpaceBetween,{loading:!e,totalPrice:x,withTaxNote:I,title:C,note:S?A:_}),s.jsx(Oh,{loyalty:e?.loyalty?.earnings}),s.jsx(tp,{basketSummary:e,dataTest:"minimum-order-summary"}),g&&s.jsx(pd,{thresholds:m,orderId:e?.orderId,page:"basket",className:"salt-m-t--2"}),s.jsx(ae.Buttons,{loading:!e,children:s.jsx(ep,{name:t,basketSummary:e,className:"salt-m-t--4"})})]})})]})]})},bpt=D("tx.nts"),xpt=Dn(["sumsub","bt.spl"]),Rpt=D("loy.waon"),_7=e=>{const{basketSummary:t,loading:n,loadedViewPortSize:o,sticky:r=!0,checkoutButtonName:a,name:i,ariaHeader:l,showMinimumSpend:c=!1}=e,[d,u]=h.useState(!0),m=ps({breakpoint:"lg-up"});h.useEffect(()=>{u(!m)},[]);const g=M8(d,u),{formatMessage:f}=M(),y=ze(),I=E(bpt),S=E(xpt),C=E(Rpt),_=E(D("oed")),{smallOrderChargeThresholds:A,shouldDisplaySmallOrderCharge:x}=JC(t),R=E(B=>qe(B,"seller-sales-enabled")==="true"),O=f("summary.title"),N=f(S?"summary.subtotal":"summary.total"),k=f("summary.total.note"),j=f("summary.subtotal.price.note");if(!t||!o)return s.jsxs(cs,{breakpoint:"lg-up",children:[s.jsx(Ns,{children:s.jsx(Ns.Skeleton,{})}),s.jsx(ae.Buttons,{loading:!0})]});const w=C&&!_?t?.totals?.paymentSplit?.remainingPayment:t?.totals?.display?.finalPrice,L=S?t?.totals?.display?.itemPriceAfterPromos:w;return s.jsxs(gs,{name:i,expanded:d,onToggle:g,breakpoint:"lg-up",sticky:r,aria:{contentLabel:l?`${l}${O}`:O,totalPrice:L&&y(L)},children:[s.jsxs(gs.ControlSection,{children:[d?s.jsx(ne,{as:"span",children:O}):s.jsx(ae.TotalInline,{loading:!t,totalPrice:L,withTaxNote:I,title:N,note:S?j:k}),s.jsx(gs.ToggleSwitch,{})]}),s.jsxs(gs.Content,{children:[R?s.jsx("div",{className:"salt-m-t--2",children:s.jsx(T7,{basketSummary:t,withTaxNote:I})}):s.jsx(pQ,{basketSummary:t,withTaxNote:I,summarySubtotalEnabled:S}),s.jsx(ae.Separator,{}),s.jsx(ae.TotalSpaceBetween,{loading:!t,totalPrice:L,withTaxNote:I,title:N,note:S?j:k})]}),s.jsx(Oh,{loyalty:t?.loyalty?.earnings}),c&&s.jsx(tp,{basketSummary:t,dataTest:"minimum-order-summary"}),x&&s.jsx(pd,{orderId:t.orderId,thresholds:A,page:"basket",className:"salt-m-t--2"}),s.jsx(ae.Buttons,{loading:n,children:s.jsx(ep,{name:a,basketSummary:t,className:"salt-m-t--4"})})]})},Dpt=({basketSummary:e})=>{const t=e?.checkout?.shippingGroupType,{formatMessage:n}=M(),[o,r]=h.useState(!1),a=Cpt(t),{order:i,count:l}=UN(t),c=n("basket.checkout.group.overview.header.main",{name:"",order:i,count:l}),d=E(D("csc.b")),{smallOrderChargeThresholds:u,shouldDisplaySmallOrderCharge:m}=JC(e),{totalPrice:g,priceNote:f,summaryTitle:y,totalPriceTitle:I,ariaExpandedLabel:S,ariaCollapsedLabel:C}=rQ(e),_=`${n("summary.title")} ${c}`;return h.useEffect(()=>{r(!0)},[]),s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12,lg:9},children:s.jsx("div",{"data-test":"basket-products-overview",children:s.jsx(Apt,{basketSummary:e,checkoutButtonName:a})})}),s.jsx(cs,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(Y.Item,{colSpan:{lg:3},children:s.jsx("div",{"data-test":"basket-collapsible-summary",children:d?s.jsxs(HP,{summaryTitle:y,totalPrice:g,totalPriceTitle:I,priceNote:f,loading:!e,basketSummary:e,breakpoint:"lg-up",loadedViewPortSize:o,ariaExpandedLabel:S,ariaCollapsedLabel:C,ariaHeader:_,name:ri(t),renderButtonsSection:()=>s.jsx(ep,{name:a,basketSummary:e,className:"salt-m-t--4"}),renderItemsSection:()=>s.jsx(dQ,{basketSummary:e,page:"basket"}),renderItemsBySellerSection:()=>s.jsx(uQ,{basketSummary:e}),children:[s.jsx(Oh,{loyalty:e?.loyalty?.earnings}),e&&s.jsx(tp,{basketSummary:e,dataTest:"minimum-order-summary"}),m&&s.jsx(pd,{orderId:e.orderId,thresholds:u,page:"basket",className:"salt-m-t--2"})]}):s.jsx(_7,{basketSummary:e,loadedViewPortSize:o,loading:!e,checkoutButtonName:a,name:ri(t),ariaHeader:_,showMinimumSpend:!0})})})})]})},v7=()=>{const e=qC(bP),t=E(vhe);return s.jsxs(h.Fragment,{children:[s.jsx(b,{"data-test":"basket-remove-unavailable-items-open-modal-button","data-synthetics":"basket-remove-unavailable-items-open-modal-button",onClick:e,intent:"secondary",fill:!0,children:s.jsx(b.Text,{children:s.jsx(v,{id:"basket.remove.unavailable.items.button.text"})})}),s.jsx(D8,{products:t})]})},Opt=()=>{const e=M(),[t]=fe(["thcu"]),[n,o]=h.useState(!1),r=E(CS),a=r.map(l=>l.productId),i=e.formatMessage("basket.unavailable.items.section.title");return s.jsxs(st,{expanded:n,onToggle:()=>o(l=>!l),name:"basket-unavailable-items",aria:{expandedLabel:e.formatMessage("basket.unavailable.items.section.title"),collapsedLabel:e.formatMessage("basket.unavailable.items.section.title")},children:[s.jsx(Zg,{basketItems:r,name:i}),s.jsxs(st.ControlSection,{children:[s.jsx(Zp,{basketItems:r,name:i,showQuantity:!t}),s.jsx(st.ToggleSwitch,{"data-test":"collapsible-box-toggle-switch"})]}),s.jsxs(st.ContentCollapsed,{maxHeight:"100px",children:[s.jsx(ET,{basketItems:r,visible:!n,setExpanded:o}),s.jsx(Kt,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx("div",{className:"salt-m-t--4",children:s.jsx(ae.Separator,{})})})]}),s.jsx(st.ContentExpanded,{maxHeight:"100%",overflow:"visible",children:s.jsx("div",{className:"salt-m-t--4 salt-m-r--1 salt-m-l--1",children:s.jsx(FN,{basketProducts:a})})}),s.jsx(Kt,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx("div",{className:"salt-m-t--2",children:s.jsx(v7,{})})})]})},Ppt=()=>s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12,lg:9},children:s.jsx("div",{"data-test":"basket-unavailable-items-overview-section",children:s.jsx(Opt,{})})}),s.jsx(cs,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(Y.Item,{colSpan:{lg:3},children:s.jsx("div",{"data-test":"basket-remove-unavailable-items-section",children:s.jsx(v7,{})})})})]}),Npt=({order:e,count:t,shippingGroupType:n,shippingGroupTypeDisplayName:o})=>{const r=M(),a=E(Hx(n)),i=r.formatMessage("basket.checkout.group.overview.header.main",{name:o,order:e,count:t});return s.jsxs(h.Fragment,{children:[s.jsx(Zp,{name:i,basketItems:a,as:"h2"}),s.jsx(ET,{visible:!0,basketItems:a}),e<t&&s.jsx("div",{className:"salt-m-b--4"})]})},Lpt=()=>{const e=Hg(P8),n=$g()?"left":"center",o=pl(),r=E(Sd);return s.jsxs(G,{isOpen:e,onRequestClose:o,aria:{labelledby:MF},children:[s.jsx(G.Header,{align:n,children:s.jsx(ne,{as:"h1",id:MF,children:s.jsx(v,{id:"basket.multiple.deliveries.modal.heading"})})}),s.jsxs(G.Body,{children:[s.jsx("div",{className:"salt-m-b--4",children:s.jsx(P,{size:"l",children:s.jsx(v,{id:"basket.multiple.deliveries.modal.info"})})}),r.map((a,i)=>s.jsx(Npt,{order:i+1,count:r.length,shippingGroupType:a?.checkout?.shippingGroupType,shippingGroupTypeDisplayName:a?.checkout?.shippingGroupTypeDisplayName},a?.checkout?.shippingGroupType))]}),s.jsx(G.Footer,{align:n,flow:"column",children:s.jsx(b,{fill:!0,intent:"primary","data-test":"multipl-deliveries-confirm",onClick:o,children:s.jsx(b.Text,{children:s.jsx(v,{id:"basket.multiple.deliveries.modal.confirm"})})})})]})},kpt=e=>{const[t]=fe(["thcu"]),{basketCheckoutGroups:n}=e,o=E(CS),r=E(gi),a=F();return h.useEffect(()=>{!localStorage.getItem(gh)&&r&&n.length>1&&(localStorage.setItem(gh,"true"),a(Z.openModal(P8)))},[n.length,r,a]),s.jsx(Y,{flush:!0,children:s.jsxs(Y.Item,{colSpan:{xs:12},children:[n.map((i,l)=>s.jsxs(h.Fragment,{children:[s.jsx(Dpt,{basketSummary:i}),l+1<n.length&&s.jsx(Zn,{className:"salt-m-y--4"})]},i?.checkout?.shippingGroupType)),!!o.length&&s.jsxs(h.Fragment,{children:[!!n.length&&s.jsx(Zn,{className:"salt-m-y--4"}),s.jsx(Ppt,{})]}),t&&s.jsx(Kt,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(aI,{className:"salt-m-y--4"})}),s.jsx(Lpt,{})]})})},gl=e=>e.data.toggleablePromotions?.data,A7=V(gl,e=>e&&(HK(e)||VK(e))),Mpt=V(gl,e=>e&&!HK(e)&&VK(e)),b7=V(gl,e=>e&&E1e(e)),x7=V(gl,e=>e&&f1e(e)),R7=V(gl,e=>e&&C1e(e)),D7=V(gl,e=>e&&v1e(e)),O7=V(gl,e=>e&&x1e(e)),P7=V(gl,e=>e&&R1e(e)),GN=V(gl,e=>e&&D1e(e)),jpt=V(P7,GN,(e,t)=>e&&t&&O1e(e,t)),$N=V(P7,e=>e&&P1e(e)),N7=V(GN,e=>e&&N1e(e)),wpt=V(x7,e=>e&&L1e(e)),Fpt=V(R7,e=>e&&k1e(e)),Bpt=()=>{const e=Ne();return E(t=>Td(t,e))},Upt=e=>e===dn.SAVING?"orders":e===dn.LOYALTY?"loyalty":e===dn.DELIVERY?"home_delivery":"",L7=({dataToDisplayList:e,as:t,handleClick:n})=>{const o=Object.keys(e);return s.jsx(zs,{direction:"column","data-test":"promotions-summary-list",gap:["md"],children:o.map(r=>e[r]?.length?s.jsxs(zs,{direction:"row","data-test":`list-item-${r}`,type:t==="button"?"button":void 0,as:t??"div",onClick:n,gap:["sm"],align:"flex-start",wrap:"nowrap",children:[s.jsx(me,{name:Upt(r),height:18,width:18}),s.jsx(zs,{direction:"column",gap:["xs"],children:e[r]?.map((a,i)=>s.jsx(P,{"data-test":`description-${r}`,children:a},`${a}-${i}`))})]},r):null)})},Gpt=e=>{const t=M(),n=E($N),o=E(N7),r=E(jpt),[a,i]=fe(["tp","tp.new"]),l=i&&!a,c=t.formatMessage("toggleablepromotions.list.no.discounts.selected"),d=t.formatMessage("toggleablepromotions.list.empty")||"No discount applied";return s.jsx("div",{className:"salt-p-b--4",children:n||o?s.jsx(L7,{dataToDisplayList:r,...e}):s.jsx(P,{"data-test":"promotions-summary-list-no-discounts",children:l?d:c})})},k7=()=>{const e=F(),t=M(),n=eD(),o=t.formatMessage("toggleablepromotions.list.button.edit"),r=t.formatMessage("toggleablepromotions.list.button.select"),a=t.formatMessage("toggleablepromotions.list.alert.preapplied"),i=Bpt(),[l,c]=fe(["tp","tp.new"]),d=c&&!l,u=E($N),m=E(Mpt),g=()=>{n(i),e(wu({type:Io.ORDER_DISCOUNT_FORM_MODAL_DISPLAYED,description:"A modal for order promotions is displayed",source:"orderPromotionsButtonClicked"})),e(Z.openModal("discountOnOrder"))};return s.jsxs(h.Fragment,{children:[s.jsx(Gpt,{}),m&&!d?s.jsx(P,{"data-test":"promotions-summary-alert-pre-applied-only",children:a}):s.jsx(b,{fill:!0,intent:"secondary",onClick:()=>g(),"data-test":"edit-select-promotions-button",children:s.jsx(b.Text,{"data-test":"edit-select-promotions-button-text",children:d||!u?r:o})})]})},$pt=({isPromotionsAvailable:e,intl:t,actions:{getToggleablePromotions:n,sendPromotionsDropdownClickedPageEvent:o}})=>{const[r,a]=h.useState(!1),i=()=>a(m=>!m);if(h.useEffect(()=>{n()},[]),!e)return null;const l=t.formatMessage("toggleablepromotions.accessibility.toggle.switch.on.label"),c=t.formatMessage("toggleablepromotions.accessibility.toggle.switch.off.label"),d=t.formatMessage("toggleablepromotions.list.title"),u=()=>{i(),o()};return s.jsxs(st,{expanded:r,onToggle:u,aria:{expandedLabel:l,collapsedLabel:c},name:"collapsible-promotions",children:[s.jsxs(st.ControlSection,{children:[s.jsx(ne,{as:"span",children:d}),s.jsx(st.ToggleSwitch,{})]}),s.jsx(st.ContentExpanded,{children:s.jsx("div",{className:"salt-p-t--4",children:s.jsx(k7,{})})})]})},Hpt=e=>({isPromotionsAvailable:A7(e)}),Vpt=ot({sendPromotionsDropdownClickedPageEvent:B1e,getToggleablePromotions:cd}),XA=Ct(Bt,ke(Hpt,Vpt))($pt),Ypt=e=>async t=>{if(!e)return null;try{const n=await t(Yf.fetchNextAvailableSlot(e));return Q3(n?.payload?.responseData)}catch{return null}},Wpt={fetchNextAvailableSlot:Ypt},qpt=D("bt.spl"),Kpt=()=>{const e=ul(),[t,n]=h.useState(vt()),o=Md(),r=F(),a=new URLSearchParams([["source","homepage card"],["sourceEventId",t]]),i=VP({searchParams:a}),l=E(Jt),c=E(Vt),d=E(At),u=E(N5e),m=E(qpt),g=E(Fa),f=E(Ho),y=h.useRef(u.lastUpdated),I=u.data?"next available slot":"book a slot",S=m?"logged.in.home.page.book.slot.card.title.grocery":"logged.in.home.page.book.slot.card.title";h.useEffect(()=>{m?C():r(Wpt.fetchNextAvailableSlot(g))},[g]),h.useEffect(()=>{!u.isFetching&&u.lastUpdated&&y.current!==u.lastUpdated&&C(),y.current=u.lastUpdated});const C=()=>{r(U.analyticsEvent({type:Ss.HOME_CARD_IMPRESSION,data:{CARD_TYPE:"slot booking",STATUS:I}}))},_=()=>{const N=u.data?.startTime,k=u.data?.endTime,j=u.data?.timeZoneId,w=u.data?.address,L=u.data?.type,B=u.data?.deliveryTimeInMinutes,W=u.data?.deliveryMethod,$=L==="ON_DEMAND"&&W==="CUSTOMER_COLLECTION",K=$?"logged.in.home.page.book.slot.card.subtitle.next.available.express.collection.slot":"logged.in.home.page.book.slot.card.subtitle.slot.and.address.format",Q=$?null:s.jsx(go,{dateIsoFrom:N,dateIsoTo:k,timeZoneId:j,dateFormat:l,timeFormat:c}),X=o(B);return w?s.jsx(v,{"data-test":"next-available-slot-card-formatted-interval",id:K,values:{interval:Q,address:w.nickname,readyTimeSpan:X}}):Q},A=async()=>{r(U.analyticsEvent({type:Te.REDIRECT_TO_SLOT_BOOKING,description:"User clicked link to be redirected to slot booking",pageEventAttributes:{componentLocation:"Body",componentType:"Card",linkType:"Button",userInteraction:"BUTTON_CLICKED"}})),r(U.analyticsEvent({type:Ss.HOMEPAGE_SLOT_BOOKING_CARD_CLICKED,status:I,orderId:d,pageEventId:t}));const N=await Yo.fetchAnalyticsMetadataByActiveCart(f);r(U.analyticsEvent({type:_e.BEGIN_CHECKOUT,meta:N})),e(N),n(vt())},x=N=>r(ks({name:xS,event:N})),R=N=>{x(N),A()},O=()=>{const N=u.data?.type,k=u.data?.deliveryMethod,j=N==="ON_DEMAND"&&k==="HOME_DELIVERY";return u.data&&!j?s.jsxs(h.Fragment,{children:[s.jsx(v,{id:"logged.in.home.page.book.slot.card.subtitle.next.available.slot"})," ",_()]}):s.jsx(v,{id:"logged.in.home.page.book.slot.card.subtitle.no.next.available.slot"})};return g&&(u.isFetching||!u.lastUpdated&&!u.fetchError&&!m)?s.jsx(xn.Skeleton,{description:!0,"data-test":"slot-card-skeleton"}):s.jsx(xn,{"data-test":"next-available-slot-card",title:{text:s.jsx(v,{id:S}),as:"h2"},description:O(),icon:"slot",onClick:R,to:i})},zpt=()=>{const e=F(),{formatMessage:t}=M();return h.useEffect(()=>{e(U.analyticsEvent({type:Ss.HOME_CARD_IMPRESSION,data:{CARD_TYPE:"slot booking",STATUS:"slots not available"}}))},[]),s.jsx(P$,{"data-test":"slot-service-down-card",title:{text:t("logged.in.home.page.book.slot.card.title.na"),as:"h2"},description:t("logged.in.home.page.book.slot.card.subtitle.na"),icon:"info_default"})},Qpt=D("mtz"),tE=({dateIso:e,timeZoneId:t,timeFormat:n,local:o})=>{const r=E(Ed)||"",a=E(Qpt),i=E(Yt);if(!e)return null;if(!a)return s.jsx(ie.Fragment,{children:q$(n,e)});if(i)return null;const{displayTimeZoneId:l,showTimeZoneAbbreviation:c}=hC(t,r,o);return s.jsx(ie.Fragment,{children:$b(e,l,n,c)})},Xpt=e=>{const t=nl(e,At(e));return t?{start:t.dates.deliveryStartDate,end:t.dates.deliveryEndDate,timeZoneId:t.dates.timeZoneId,nickname:t.addressNickName,slotId:t.slotId}:null},Zpt=({componentContext:e})=>{const t=ul(),n=F(),{formatMessage:o,formatNumber:r}=M(),a=ze(),i=E(Cn),l=E(cS),c=E(At),d=E(Jt),u=E(Vt),m=E(Xpt),g=i&&i.deliveryType===Et.clickAndCollect.type,[f,y]=h.useState(vt()),I=Md(),S=E(D("mins")),C=E(Ho),_=S?a(l):null,A=S?o("slot.card.minimum.order.text",{amount:_}):null,x=()=>s.jsx(v,{id:"slotbooking.navigation.card.change.slot.title"}),R=Q=>s.jsx(go,{dateIsoFrom:Q.start,dateIsoTo:Q.end,timeZoneId:Q.timeZoneId,local:!0,dateFormat:d,timeFormat:u}),O=()=>i?s.jsx(v,{id:"slotbooking.navigation.card.subtitle.slot.and.address.format",values:{interval:R(i),address:i.nickname}}):null,N=()=>i?s.jsx(tE,{dateIso:i.expiryTime,timeZoneId:i.timeZoneId,local:!0,timeFormat:u}):null,k=()=>s.jsx(v,{id:"slotbooking.navigation.card.change.slot.expiration.alert.text.hint",values:{expiryTime:N()}}),j=()=>{if(!i)return null;const{slotType:Q,deliveryMethod:X,deliveryTimeInMinutes:re,collectionTimeInMinutes:ue,nickname:te}=i,ce=de=>r(de||0,{style:"unit",unit:"minute",unitDisplay:"short"});switch(!0){case(Q===Pa&&X===Et.clickAndCollect.method):return s.jsx(v,{id:"slotbooking.navigation.card.express.collection.slot.new",values:{address:te,readyTimeSpan:I(re),maxTimeSpan:I(ue)}});case(Q===Pa&&X===Et.vanDelivery.method):return s.jsx(v,{id:"slotbooking.navigation.card.fast.delivery.slot.new",values:{address:te,duration:ce(re||0)}});default:return s.jsx(v,{id:"slotbooking.navigation.card.slot.new",values:{newSlotDeliveryInterval:R(i),address:te}})}},w=()=>m?s.jsx(v,{id:"slotbooking.navigation.card.slot.old",values:{oldSlotDeliveryInterval:R(m),address:m.nickname}}):null,L=()=>m&&i&&m.slotId!==i.slotId,B=Q=>{n(ks({name:xS,event:Q}))},W=async()=>{n(U.analyticsEvent({type:Te.REDIRECT_TO_SLOT_BOOKING,description:"User clicked link to be redirected to slot booking",pageEventAttributes:{componentLocation:"Body",componentType:"Card",linkType:"Button",userInteraction:"BUTTON_CLICKED"}})),n(U.analyticsEvent({type:js.EDIT_PAGE_SLOT_BOOKING_CARD_CLICKED,status:"slot reserved",orderId:c,pageEventId:f}));const Q=await Yo.fetchAnalyticsMetadataByActiveCart(C);n(U.analyticsEvent({type:_e.BEGIN_CHECKOUT,meta:Q})),t(Q),y(vt())},$=Q=>{B(Q),W()},K=nn(sr({inCheckoutWalk:!1}));return s.jsx(xn,{"data-test":"slot-edit-card",title:{text:x(),as:"h2"},description:L()?j():O(),additionalInfo:L()?w():A,icon:`${g?"click_collect":"home_delivery"}`,alertBanner:i&&i.expiryTime?{intent:"warning",text:k()}:void 0,onClick:$,to:{...K,search:`${K.search}&source=${encodeURIComponent(e)}&sourceEventId=${f}`}})},Jpt=({componentContext:e})=>{const t=E(a=>Zt(a)),n=E(dS),o=E(Y0);return!n&&t.isFetching?s.jsx(xn.Skeleton,{"data-test":"slot-card-skeleton"}):n?s.jsx(Zpt,{componentContext:e}):o||t&&t.fetchError?s.jsx(zpt,{}):s.jsx(Kpt,{})},av={EXCEEDED_MAX_QUANTITY_MULTIPLE:"EXCEEDED_MAX_QUANTITY_MULTIPLE",EXCEEDED_MAX_QUANTITY_SINGLE:"EXCEEDED_MAX_QUANTITY_SINGLE",TIME_RESTRICTION_MERGE_EDIT:"TIME_RESTRICTION_MERGE_EDIT"},emt={LIMITED_AVAILABILITY:"basket.merge.limited.availability",NO_AVAILABILITY:"basket.merge.no.availability",EXCEEDED_MAX_QUANTITY:"basket.merge.reorder.exceeded.quantity",EXCEEDED_BASKET_MAX_QUANTITY:"basket.merge.reorder.exceeded.quantity",UNKNOWN_PRODUCT:"basket.merge.unknown.product",UNKNOWN:"basket.merge.unknown.reason",UNDEFINED_SELLER_ID:"basket.merge.unknown.reason",OUT_OF_STOCK:"basket.merge.out.of.stock",TIME_RESTRICTION:"basket.merge.time.restriction",UNAVAILABLE:"merge-cart-with-edit-order.unavailable-reason.item-cannot-be-added",EXCEEDED_MAX_QUANTITY_MULTIPLE:"merge-cart-with-edit-order.unavailable-reason.max-quantity-reached.multiple",EXCEEDED_MAX_QUANTITY_SINGLE:"merge-cart-with-edit-order.unavailable-reason.max-quantity-reached.single",TIME_RESTRICTION_MERGE_EDIT:"merge-cart-with-edit-order.unavailable-reason.outside-of-deliverable-time-zone"},xB="basket-merge-conflict-modal-header-label",M7="An unavailable items modal was displayed",fT="basketMergeConflict",{Wrapper:tmt,Body:smt,Media:nmt,Image:omt,Title:rmt}=wMe,amt={product:p.shape({productId:p.string,image:p.shape({description:p.string,src:p.string}),name:p.string,price:p.shape({current:Ye,original:Ye}),reason:p.string,favorite:p.shape({message:p.string}),offer:p.shape({label:p.string,message:p.string,url:p.string}),alcohol:p.bool,restrictedVisibility:p.string}).isRequired,messages:p.shape({OUT_OF_STOCK:p.string,TIME_RESTRICTION:p.string,LIMITED_AVAILABILITY:p.string,EXCEEDED_MAX_QUANTITY:p.string,CHECKOUT_TIME_RESTRICTED:p.string}).isRequired},sE=({product:e,messages:t})=>{const n=E(D("prp"));return s.jsx(pc,{isActive:e.alcohol,overlay:s.jsx(Yd,{shouldRenderButton:!1}),children:s.jsx(tmt,{"data-test":"simple-fop",children:s.jsxs(aT,{product:e,children:[s.jsxs(nmt,{children:[e.favorite?s.jsx(nt.ImageTopBar,{children:s.jsx(nt.FopTopBarIcon,{name:"favourites",width:24})}):null,lI(s.jsx(omt,{"data-test":"simple-image",alt:e.image.description,src:e.image.src}),e.restrictedVisibility)]}),s.jsxs(smt,{children:[s.jsx(rmt,{children:e.name}),n&&s.jsx("div",{className:"salt-m-b--1",children:s.jsx(dN,{})}),s.jsx("div",{className:"salt-m-b--1",children:s.jsx(cN,{})}),s.jsx(Ce,{intent:"error",size:"s","data-test":"alert-reason",text:t[e.reason]||e.reason})]})]})})})};sE.propTypes=amt;sE.displayName="SimpleFop";const j7=({data:e})=>e.basketMerge?.mergeResults?.limitedItems||[],imt=({data:e})=>e.basketMerge?.mergeResults?.destination||jt(),lmt=({data:e})=>e.basketMerge?.mergeResults?.sourceEventId,cmt=(e,t=!1)=>{const{reason:n,addedAmount:o,requestedAmount:r,timeRestriction:a,deliveryTimeRestrictionMessage:i}=e,l=r-o;let c=n;t&&(n===Oj.TIME_RESTRICTION?c=av.TIME_RESTRICTION_MERGE_EDIT:n===Oj.EXCEEDED_MAX_QUANTITY&&(l>1?c=av.EXCEEDED_MAX_QUANTITY_MULTIPLE:c=av.EXCEEDED_MAX_QUANTITY_SINGLE));const d=emt[c];if(!d)return n;if(i)return{[n]:i};const u=a&&{to:a.deliverableTo,from:a.deliverableFrom};return{[n]:s.jsx(v,{id:d,values:{addedAmount:o,count:l,requestedAmount:r,...u}})}},dmt=({limitedItem:e,product:t,isBasketMergeEditOrder:n})=>{if(!e||!t)return null;const o={...t,...e};return s.jsx(Ve.Item,{children:s.jsx(ve,{condensed:!0,children:s.jsx(sE,{product:o,messages:cmt(o,n)})})},e.productId)},w7=({isBasketMergeEditOrder:e})=>{const t=E(j7),n=E(ir);return!t?.length||t?.every(o=>!n?.[o?.productId])?null:s.jsx(Ve,{inline:!1,children:t?.map(o=>s.jsx(dmt,{isBasketMergeEditOrder:e,limitedItem:o,product:n?.[o?.productId]},o.productId))})},ZA="editOrderMergeUnavailableItems",umt=()=>{const{formatMessage:e}=M(),t=F(),n=E(Vo(ZA)),o=E(D("m.la.h")),r=E(Ue(ZA)),a="edit-order-modal-header",i=()=>{t(Z.closeModal()),n?.afterClose()},l=n?.withProductsFetchError?"merge-cart-with-edit-order.unavailable-items-modal.alert.error":"merge-cart-with-edit-order.unavailable-items-modal.text";return s.jsxs(G,{isOpen:r,onRequestClose:i,aria:{labelledby:a},children:[s.jsx(G.Header,{align:o?"left":"center",children:s.jsx(ne,{as:"h1",id:a,children:e("merge-cart-with-edit-order.unavailable-items-modal.title")})}),s.jsxs(G.Body,{children:[s.jsx(Ce,{className:"salt-m-b--4",intent:"error",text:e(l),showIcon:!1}),!n?.withProductsFetchError&&s.jsx(w7,{isBasketMergeEditOrder:!0})]}),s.jsx(G.Footer,{align:o?"left":"center",children:s.jsx(b,{intent:"primary",onClick:i,fill:!0,children:s.jsx(b.Text,{children:e("merge-cart-with-edit-order.unavailable-items-modal.confirm-button")})})})]})},F7=(e=!1)=>t=>{t(e?zn.LEGACY_addServerSideNotifications([ro.LEGACY_showBasketMergeSucceedPriceChanged.key]):zn.LEGACY_addServerSideNotifications([ro.LEGACY_showBasketMergeSucceed.key]))},RB=(e=!1)=>{const t=e?"basket.merge.prices.promos.changed.notification":"merge-cart-with-edit-order.toast.successful";z.success(t)},DB=()=>{z.error("merge-cart-with-edit-order.toast.all-with-conflicts")},B7=({viaCartToken:e}={viaCartToken:!1})=>t=>{t(e?zn.LEGACY_addServerSideNotifications([ro.LEGACY_showBasketMergeFailedViaToken.key]):zn.LEGACY_addServerSideNotifications([ro.LEGACY_showBasketMergeFailed.key]))},pmt=e=>async t=>{try{const n=await t(vr.mergeBasket(e)),{status:o,pricesPromosChanged:r}=n.payload.responseData;switch(o){case Sr.SUCCESSFUL:{t(F7(r));break}case Sr.ALL_WITH_CONFLICTS:case Sr.WITH_CONFLICTS:t(Z.openModal(fT));break;default:break}}catch{t(B7({viaCartToken:!1}))}},mmt=()=>async(e,t)=>{const n=t(),r=Zt(n)?.checkoutCorrelationId,l=Ds(n)?.order?.orderId;let c=null;try{c=await e(vr.mergeBasket()),e(U.analyticsEvent({type:Te.MERGE_CART,prevOrderId:r,nextOrderId:l}));const f={event:"merge_cart",type:"edit-merge",previous_transaction_id:r,osp_transaction_id:l};J.sendEvent({GA:f,WA:null})}catch{DB();return}const{status:d,limitedItems:u,pricesPromosChanged:m}=c.payload.responseData;let g=!1;if(u?.length&&d!==Sr.ALL_WITH_CONFLICTS)try{await e(Ci({products:u.map(({productId:f})=>({id:f})),ignoreProductCache:!0}))}catch{g=!0}switch(d===Sr.WITH_CONFLICTS&&!u?.length&&(g=!0),d){case Sr.SUCCESSFUL:{RB(m);break}case Sr.ALL_WITH_CONFLICTS:case Sr.WITH_CONFLICTS:{if(e(Z.openModal(ZA,{withProductsFetchError:g,afterClose:()=>{d===Sr.ALL_WITH_CONFLICTS?DB():RB(m)}})),u?.length){const y=u?.map(I=>I.productId);e(U.analyticsEvent({type:Te.SOME_ITEMS_UNABLE_TO_ADD_MODAL_DISPLAYED,orderId:l,productId:y}))}const f=On(n);u?.forEach(y=>{e(U.analyticsEvent({type:Te.SOME_ITEMS_UNABLE_TO_ADD_IMPRESSION,pageViewId:f,pageComponents:{productId:y?.productId,reason:y?.reason}}))});break}case Sr.NO_ACTION:{e(U.analyticsEvent({type:Te.ADD_PRODUCT_TO_ORDER_WITH_NO_ITEMS_REQUESTED,checkoutCorrelationId:r}));break}}},hmt=({cartToken:e})=>async t=>{try{const n=await t(vr.mergeBasketViaCartToken(e)),{status:o,pricesPromosChanged:r}=n.payload.responseData;switch(o){case Sr.SUCCESSFUL:{t(F7(r));break}case Sr.ALL_WITH_CONFLICTS:case Sr.WITH_CONFLICTS:t(Z.openModal(fT));break;default:break}}catch{t(B7({viaCartToken:!0}))}},HN={mergeCartWithVisitorCart:pmt,mergeBasketViaCartToken:hmt,mergeCartWithEditOrder:mmt},gmt=e=>!D("ord.ot.hide")(e),Emt=(e,t,n)=>{gmt(n)&&ymt(e)&&Object.keys(e.payload.order).filter(o=>fmt(e.payload.order[o])).forEach(o=>{t(Lhe(o)).then(r=>{Object.keys(r.payload.responseData).length!==0&&t(khe(r.payload.responseData))}).catch(()=>{})})},fmt=e=>e.status!=="CANCELLED"&&e.status!=="DELIVERED"&&Ge().isSameOrBefore(e.dates.deliveryStartDate,"day"),ymt=e=>e&&e.payload&&e.payload.order,VN={getDeliveryStatuses:Emt},U7=D("rec.o"),G7=({id:e,response:t,dispatch:n})=>{if(wo(t,`payload.responseData.entities.order[${e}].recurringShoppingDefinition.isNew`,!1)){const r=wo(t,`payload.responseData.entities.order[${e}].recurringShoppingDefinition.name`,"");n(zy.showRecurringOrderCreatedNotification(r))}},Imt=e=>(t,n)=>t(ta.getOrder(e)).then(o=>{if(o)return U7(n())&&G7({id:e,response:o,dispatch:t}),t(lg(o.payload.responseData.entities))}).catch(()=>!1),Smt=e=>(t,n)=>t(ta.getDecoratedOrder(e)).then(o=>{if(o){const{entities:r,missedPromotions:a}=o.payload.responseData;U7(n())&&G7({id:e,response:o,dispatch:t}),a?.length&&t(Ao.addMissedPromotions(a)),t(lg(r)),t(Ft.setProducts(r))}}).catch(()=>!1),Cmt=e=>(t,n)=>t(ta.getDecoratedOrder(e)).then(o=>{if(o){const{entities:r,missedPromotions:a}=o.payload.responseData;a?.length&&t(Ao.addMissedPromotions(a)),t(lg(r)),t(Ft.setProducts(r)),VN.getDeliveryStatuses({payload:r},t,n())}}).catch(()=>!1),Tmt=e=>t=>t(ta.getOrder(e)).then(n=>n&&t(lg(n.payload.responseData.entities))).catch(()=>!1),Wo={getOrderWithRecurringNotification:Imt,getDecoratedOrderWithRecurringNotification:Smt,getDecoratedOrderCall:Cmt,getOrder:Tmt},_mt="SHOW_ORDER_DETAILS",yT=()=>{z.error("toast.notification.generic.error")},vmt=({orderId:e,navigate:t,redirectToDetails:n=!0,onSuccess:o=()=>{}})=>(r,a)=>r(ta.cancelOrder(e)).then(()=>{const i={event:"event",ecommType:"enhanced",eventCategory:"E-commerce",eventLabel:"cancelled-order",eventAction:"OrderCancelled",ecommerce:{refund:{actionField:{id:e}}}};return J.sendEvent({GA:i,WA:null}),r(U.analyticsEvent({type:js.ORDER_CANCELLED,orderId:e}))}).then(async()=>n?t(gn(e)):Promise.all([r(Ht.getBasket()),r(Wo.getDecoratedOrderCall(e))])).then(async()=>{const i=a(),l=nl(i,e);let c;if(l?.checkoutId){const u=Ho(i);c=await Yo.fetchAnalyticsMetadataByCheckoutId(l.checkoutId,u)}r(U.analyticsEvent({type:js.ORDER_CANCELLED_GA4,orderId:e,state:i,meta:c})),o();const d=qSe({orderId:e,state:i,meta:c});J.sendEvent({GA:d,WA:null})}).catch(yT),Amt=(e,t,n=!0)=>(o,r)=>o(ta.cancelOrderChanges(e,hn(r()))).then(async()=>n?t(gn(e)):Promise.all([o(Ht.getBasket()),o(Wo.getDecoratedOrderCall(e))])).catch(yT),bmt=(e,t,{redirectToDetails:n=!0,mergeBasket:o=!1}={})=>(r,a)=>r(ta.editOrder(e,hn(a()))).then(async()=>(o&&await r(HN.mergeCartWithEditOrder()),n?t(gn(e)):Promise.all([r(Ht.getBasket()),r(Wo.getDecoratedOrderCall(e))]))).catch(yT),xmt=(e,t,n)=>(o,r)=>Rmt(t)(o,r).then(()=>{o(Z.closeModal()),e===_mt?n(gn(t)):window.location.reload()}).catch(yT),Rmt=e=>(t,n)=>t(ta.cancelOrderChanges(e,hn(n()))).then(()=>t(vr.mergeBasket(up(n())))),ci={cancelOrder:vmt,cancelOrderEditExpired:xmt,cancelChanges:Amt,editOrder:bmt},YN=()=>{const e=E(D("al")),{sendPageViewEvent:t}=QR(),n=Ne(),o=F();return()=>e?t({page:n.pathname}):o(U.analyticsEvent({type:js.EDIT_ORDER_PAGE_VIEW_EVENT,page:"order-details",location:n}))},IT="cancel-generic-modal-header",Dmt="order-details",$7=({orderId:e,page:t,isCancelChanges:n=!1})=>{const o=F(),r=We(),a=YN(),i=E(D("m.la.h")),l=t===Dmt,c=g=>{o(U.analyticsEvent({type:js.CANCEL_ORDER_MODAL_DISPLAYED,orderId:e,userAction:g}))},d=g=>{o(U.analyticsEvent({type:js.DISCARD_CHANGES_MODAL_DISPLAYED,orderId:e,userAction:g}))},u=()=>{n?d("Cancel"):c("Dismiss"),o(Z.closeModal())},m=async()=>{n?(d("Discard"),await o(ci.cancelChanges(e,r,!l))):(c("Cancel order"),await o(ci.cancelOrder({orderId:e,navigate:r,redirectToDetails:!l,onSuccess:()=>{z.success("order.details.order_cancelled_notification")}}))),l&&a(),o(Z.closeModal())};return s.jsxs(h.Fragment,{children:[s.jsx(G.Header,{align:i?"left":"center","data-test":"cancel-generic-modal-content-header",children:s.jsx(ne,{as:"h2",id:IT,children:n?s.jsx(v,{id:"orders.list.cancel.changes.modal.heading"}):s.jsx(v,{id:"orders.list.cancel.order.modal.heading"})})}),s.jsx(G.Body,{"data-test":"cancel-generic-modal-content-body",children:s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{className:"salt-m-t--4",fill:!0,intent:"secondary",onClick:u,"data-test":"cancel-order-dismiss-button",children:s.jsx(b.Text,{children:n?s.jsx(v,{id:"orders.list.cancel.changes.modal.dismiss"}):s.jsx(v,{id:"orders.list.cancel.order.modal.dismiss"})})})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{fill:!0,intent:"primary",className:"salt-m-t--4","data-synthetics":n?null:"cancel-order-confirm-button","data-test":"cancel-order-confirm-button",onClick:m,children:s.jsx(b.Text,{children:n?s.jsx(v,{id:"orders.list.cancel.changes.modal.cancel.changes"}):s.jsx(v,{id:"orders.list.cancel.order.modal.cancel.order"})})})})]})})]})},WN=({orderId:e,page:t})=>{const n=F(),o=ts(),r=E(Ue(`cancelChanges${e}`)),a=()=>{o({type:js.DISCARD_CHANGES_MODAL_DISPLAYED,orderId:e,userAction:"Close"}),n(Z.closeModal())};return s.jsx(G,{isOpen:r,onRequestClose:a,aria:{labelledby:IT},children:s.jsx($7,{orderId:e,isCancelChanges:!0,page:t})})},H7=e=>{const{orderId:t}=e,n=M(),o=F(),r=()=>o(Z.openModal(`cancelChanges${t}`));return s.jsxs(h.Fragment,{children:[s.jsx(b,{size:"m",intent:"secondary",fill:!0,onClick:r,"data-test":"cancel-changes-button",children:s.jsx(b.Text,{children:n.formatMessage("order.undo.changes")})}),s.jsx(WN,{orderId:t,page:"order-details"})]})},qN=({orderId:e,page:t})=>{const n=F(),o=ts(),r=E(Ue(`cancelOrder${e}`)),a=()=>{o({type:js.CANCEL_ORDER_MODAL_DISPLAYED,orderId:e,userAction:"Close"}),n(Z.closeModal())};return s.jsx(G,{isOpen:r,onRequestClose:a,aria:{labelledby:IT},children:s.jsx($7,{orderId:e,page:t})})},V7=({orderId:e})=>{const t=M(),n=F(),o=()=>{n(Z.openModal(`cancelOrder${e}`))};return s.jsxs(h.Fragment,{children:[s.jsx(b,{size:"m",intent:"secondary",fill:!0,onClick:o,"data-test":"cancel-order-button",children:s.jsx(b.Text,{children:t.formatMessage("order.cancel")})}),s.jsx(qN,{orderId:e,page:"order-details"})]})},Omt=({basket:e})=>s.jsxs(ve,{children:[s.jsx(H7,{orderId:e.orderId||""}),s.jsx("div",{className:"salt-m-t--2",children:s.jsx(V7,{orderId:e.orderId||""})})]}),Pmt=({basketSummary:e})=>{const t=ps({breakpoint:"lg-up"}),n=E(mp),[o]=fe(["thcu"]),{shippingGroupType:r,shippingGroupTypeDisplayName:a}=e.checkout,i=e.items;if(!a||!i.length||n)return null;const l=!!e.slot,c=e.slot||e.nextAvailableSlot;return s.jsxs(ve,{"data-test":"basket-delivery-info-box",children:[s.jsx(Zp,{name:a,basketItems:i,as:"h2",showQuantity:!o}),!o&&s.jsxs(h.Fragment,{children:[s.jsx(C7,{slot:c,slotBooked:l,shippingGroupType:r}),t&&s.jsx(tp,{basketSummary:e,dataTest:"basket-delivery-minimum-order"})]})]})},Nmt=D("mtz"),Lmt=e=>{if(!e.dateIso)return null;if(!e.multiTimeZoneEnabled)return s.jsx(h.Fragment,{children:K$(e.dateIso,e.dateFormat,e.timeFormat)});if(e.isServerRendered)return null;const{displayTimeZoneId:t,showTimeZoneAbbreviation:n}=hC(e.timeZoneId,e.defaultTimeZoneId,e.local);return s.jsx(h.Fragment,{children:Hb(e.dateIso,t,e.dateFormat,e.timeFormat,n)})},kmt=e=>({defaultTimeZoneId:Ed(e),multiTimeZoneEnabled:Nmt(e),isServerRendered:Yt(e)}),El=ke(kmt)(Lmt),Mmt={UNDER_EDIT:"UNDER_EDIT"},Y7=({id:e})=>{const t=E(Xl),n=E(Jt),o=E(Vt),r=t?.orders?.find(i=>i?.editStatus===Mmt.UNDER_EDIT);if(!r)return null;const a=s.jsx(El,{dateIso:r.dates.confirmOrderChangesBy,timeZoneId:r.dates.timeZoneId,local:!0,dateFormat:n,timeFormat:o});return s.jsx("div",{className:"salt-m-t--4",children:s.jsx(P,{size:"m","data-test":"order-edit-cut-off-time",children:s.jsx(v,{id:e,values:{cutoff_time:a}})})})},jmt=()=>{const e=E(At);return e?s.jsxs(Y,{className:"salt-m-x--0 salt-m-b--0 salt-m-t--4",children:[s.jsx(Y.Item,{colSpan:{xs:6},children:s.jsx(V7,{orderId:e})}),s.jsx(Y.Item,{colSpan:{xs:6},children:s.jsx(H7,{orderId:e})})]}):null},wmt=()=>{const{formatMessage:e}=M(),t=E(Cn),n=E(Jt),o=E(Vt);return t?s.jsx("div",{className:"salt-m-t--4",children:s.jsxs(P,{size:"m","data-test":"order-edit-reserved-slot",children:[e("edit.order.slot.time"),s.jsx("span",{className:"salt-m-l--1",children:s.jsx(go,{dateIsoFrom:t.start,dateIsoTo:t.end,timeZoneId:t.timeZoneId,local:!0,dateFormat:n,timeFormat:o})})]})}):null},Fmt=()=>{const e=F(),[t,n]=h.useState(vt()),o=E(At),r=E(Ho),a=ul(),i=nn(sr({inCheckoutWalk:!1})),l={...i,search:`${i.search}&source=${encodeURIComponent("basket")}&sourceEventId=${t}`},c=m=>{e(ks({name:xS,event:m}))},d=async()=>{e(U.analyticsEvent({type:Te.REDIRECT_TO_SLOT_BOOKING,description:"User clicked link to be redirected to slot booking",pageEventAttributes:{componentLocation:"Body",componentType:"Card",linkType:"Button",userInteraction:"BUTTON_CLICKED"}})),e(U.analyticsEvent({type:js.EDIT_PAGE_SLOT_BOOKING_CARD_CLICKED,status:"slot reserved",orderId:o,pageEventId:t}));const m=await Yo.fetchAnalyticsMetadataByActiveCart(r);e(U.analyticsEvent({type:_e.BEGIN_CHECKOUT,meta:m})),a(m),n(vt())},u=m=>{c(m),d()};return s.jsx(b,{asChild:!0,"data-test":"order-edit-change-slot",className:"salt-m-t--2",intent:"secondary",fill:!0,onClick:u,children:s.jsx(Qe,{to:l,intent:"ghost",children:s.jsx(b.Text,{children:s.jsx(v,{id:"edit.order.change.slot"})})})})},Bmt=()=>{const e=E(Cn),t=E(Vt);if(!e?.expiryTime)return null;const n=s.jsx(tE,{dateIso:e.expiryTime,timeZoneId:e.timeZoneId,local:!0,timeFormat:t}),o=s.jsx(v,{id:"slotbooking.navigation.card.change.slot.expiration.alert.text.hint",values:{expiryTime:n}});return s.jsx(Ce,{className:"salt-m-t--2","data-test":"slot-expiry-time-alert",size:"s",intent:"warning",text:o})},Umt=()=>fe(["csoei"])?s.jsxs(h.Fragment,{children:[s.jsx(wmt,{}),s.jsx(Fmt,{}),s.jsx(Bmt,{})]}):null,W7=()=>s.jsxs(h.Fragment,{children:[s.jsx(jmt,{}),s.jsx(Umt,{})]}),q7=()=>s.jsxs(ve,{"data-test":"edit-order",children:[s.jsxs(ne,{as:"h2",children:[s.jsx(me,{name:"orders_edit",width:20,height:20,verticalAlign:"middle",className:"salt-m-r--2"}),s.jsx(P,{size:"l",bold:!0,children:s.jsx(_t,{id:"edit.order.header"})})]}),s.jsx(Y7,{id:"edit.order.checkout.info"}),s.jsx(W7,{})]}),K7=()=>{const[e,t]=h.useState(!1);return s.jsxs(st,{expanded:e,onToggle:()=>t(!e),name:"edit-order",children:[s.jsxs(st.ControlSection,{children:[s.jsxs(ne,{as:"h2",children:[s.jsx(me,{name:"orders_edit",width:20,height:20,verticalAlign:"middle",className:"salt-m-r--2"}),s.jsx(P,{size:"l",bold:!0,children:s.jsx(v,{id:"edit.order.options.header"})})]}),s.jsx(st.ToggleSwitch,{"data-test":"collapsible-box-toggle-switch"})]}),s.jsx(Y7,{id:e?"edit.order.checkout.info":"edit.order.checkout.more.options.info"}),s.jsx(st.ContentExpanded,{maxHeight:"100%",overflow:"visible",children:s.jsx(W7,{})})]})},Gmt=({loading:e=!1})=>{const[t,n,o,r,a,i,l]=fe(["tp","tp.new","csoei","bt.spl","pbpm","csc.b","thcu"]),c=M(),d=ps({breakpoint:"lg-up"}),u=E(mp),m=!d||l,[g,f]=h.useState(!1),y=E(Ze),I=E(Sd),S=E(lS),[C]=I,_=C?.orderId,{smallOrderChargeThresholds:A,shouldDisplaySmallOrderCharge:x}=JC(C),R=F();h.useEffect(()=>{f(!0)},[]);const O=E(O0),N=E(Gie);h.useEffect(()=>{a&&N.length&&R(kd(N))},[R,a,N]);const{totalPrice:k,priceNote:j,summaryTitle:w,totalPriceTitle:L,ariaExpandedLabel:B,ariaCollapsedLabel:W}=rQ(C),$=()=>s.jsx(cs,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(aI,{})}),K=()=>s.jsxs(h.Fragment,{children:[!l&&$(),y&&(t||n)&&s.jsx(XA,{}),l&&s.jsx(aI,{})]}),Q=()=>s.jsxs(h.Fragment,{children:[y&&(t||n)&&s.jsx(XA,{}),l?s.jsx(cs,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(q7,{})}):s.jsxs(h.Fragment,{children:[o&&s.jsx(Jpt,{componentContext:"basket"}),s.jsx(Omt,{basket:C})]})]});return s.jsxs(Y,{flush:!0,className:"salt-gap-y--4 lg:salt-gap-y--0",children:[s.jsx(Y.Item,{colSpan:{xs:12,lg:9},children:s.jsxs(se,{wrap:"nowrap",direction:"column",gap:["md"],children:[!r&&s.jsx(Ee,{asChild:!0,children:s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"catalogue.products.heading"})})}),u&&l&&s.jsx(Kt,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(K7,{})}),r&&C&&s.jsx(Pmt,{basketSummary:C}),s.jsx("div",{children:s.jsx(FN,{basketProducts:O,itemGroups:S})})]})}),s.jsx(Y.Item,{colSpan:{xs:12,lg:3},children:s.jsxs(se,{direction:"column",gap:["md"],children:[i?s.jsxs(HP,{summaryTitle:w,totalPrice:k,totalPriceTitle:L,priceNote:j,loading:e,basketSummary:C,breakpoint:"lg-up",loadedViewPortSize:g,ariaExpandedLabel:B,ariaCollapsedLabel:W,renderButtonsSection:()=>s.jsx(ep,{name:u?c.formatMessage("order.continue.checkout.to.save.changes"):void 0,basketSummary:C,className:"salt-m-t--4"}),renderItemsSection:()=>s.jsx(dQ,{basketSummary:C,page:"basket"}),renderItemsBySellerSection:()=>s.jsx(uQ,{basketSummary:C}),children:[s.jsx(Oh,{loyalty:C?.loyalty?.earnings}),C&&m&&s.jsx(tp,{basketSummary:C,dataTest:"minimum-order-summary"}),x&&s.jsx(pd,{orderId:_,thresholds:A,page:"basket",className:"salt-m-t--2"})]}):s.jsx(_7,{basketSummary:C,checkoutButtonName:u?c.formatMessage("order.continue.checkout.to.save.changes"):void 0,loadedViewPortSize:g,loading:e,showMinimumSpend:m}),u?Q():K()]})})]})},$mt=({loading:e=!1})=>{const[t,n]=fe(["mins","thcu"]),o=KC(),[r,a]=h.useState(!0),i=E(gi),l=E(Yt),c=E(Vx),d=E(Sd),u=E(CS),g=E(YC).length,f=C8(),y=F(),{isBelowMinSpendErrorInUrl:I,errorShippingGroupType:S,shouldShowGenericErrorWhenCheckoutGroupRemoved:C}=net(),_=d.length>1||!!u.length,A=E(mp),x=A?"edit-order":"basket",R=iet(S,t,C),[O,N,k]=E(E8(x)),j=i&&O.length>0&&!k;qZe();const w=E(Ho);h.useEffect(()=>{i&&!l&&!c&&r&&(f(),a(!1))},[i,f,c,l,r]),h.useEffect(()=>{o&&!c&&!r&&y(U.analyticsEvent({type:fs.REGULARS_IN_TROLLEY_TOTAL_COUNT,count:g}))},[g,o,c,r,y]),h.useEffect(()=>{I&&R()},[R,I]),h.useEffect(()=>{(i&&d.length===1||!i&&!d.length)&&localStorage.removeItem(gh)},[d.length,i]);const{viewCartGa4Event:L}=r8(),{data:B,canSendEvent:W,setIsEventSent:$}=a8(),K=i&&!d.length&&!u.length;return h.useEffect(()=>{W&&!K&&w&&((async()=>{const X=await Yo.fetchAnalyticsMetadataByActiveCart(w);await L({payload:B,cartType:"page",meta:X})})(),$())},[W,$,L,B,K,w]),K?s.jsx(Rs,{size:"l",className:"salt-m-t--16","data-test":"basket-spinner"}):!i&&!d.length&&!u.length?A&&n?s.jsxs(Y,{children:[s.jsxs(Y.Item,{colSpan:{xs:12,lg:9},children:[s.jsx(Kt,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(K7,{})}),s.jsx(kF,{flush:!0})]}),s.jsx(cs,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(Y.Item,{colSpan:{lg:3},children:s.jsx(q7,{})})})]}):s.jsx(kF,{}):s.jsxs("div",{className:"salt-m-x--2",children:[s.jsx(Jet,{}),_?s.jsx(kpt,{basketCheckoutGroups:d}):s.jsx(Gmt,{loading:e}),s.jsx(Zet,{}),j&&s.jsx(Y,{flush:!0,children:s.jsx(Y.Item,{colSpan:{xs:12,lg:9},children:s.jsx(f8,{page:x,pageKey:x,className:_?"salt-m-t--2 sm:salt-m-t--0":""})})})]})},Hmt=({loading:e=!1})=>{const t=M(),n=E(D("thcu")),o=E(f=>a4(f)),r=oet(),a=ret(),i=mP(),l=E(f=>Zt(f)),c=Ne(),d=E(mp),u=h.useRef(!1),m=!!c.state?.isBasketBelowThreshold;h.useEffect(()=>{const f=c.state?.notification;if(_Ze(f)){const{type:y,message:I}=f;z[y](I)}window.history.replaceState({},document.title)},[c.state]),h.useEffect(()=>{m&&(i({basketSummary:l,type:"info"}),window.history.replaceState({},""),c.state.isBasketBelowThreshold=void 0),o&&r()},[l,r,c.state,o,i,m]),det(),h.useEffect(()=>{l.items.length>0&&!u.current&&(a(),u.current=!0)},[a,l.items]);const g=()=>s.jsxs(P,{"data-test":"order-details-order-reference",children:[t.formatMessage("order.details.subheading.orderId"),": ",l.orderId]});return s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"basket.page.title"}),s.jsx(_o,{children:s.jsx("meta",{name:"robots",content:"noindex"})}),s.jsxs("div",{className:"salt-m-b--8",children:[s.jsxs(An,{children:[s.jsx(HZe,{}),d&&!n?g():null]}),s.jsx(VC,{}),s.jsx("div",{className:"salt-m-l--2 salt-m-r--2",children:s.jsx(fZe,{})}),s.jsx($mt,{loading:e}),s.jsx(umt,{})]})]})},z7=({loading:e=!1})=>s.jsx(os,{type:"Basket::route",children:s.jsx(Hmt,{loading:e})}),Vmt=e=>[{path:"/basket",Component:e.Main,key:"main",children:[{index:!0,Component:Gl([{condition:t=>!Cd(t),failComponent:aZe}],z7)}]}],Ymt="modulepreload",Wmt=function(e){return"/"+e},OB={},Rn=function(t,n,o){let r=Promise.resolve();if(n&&n.length>0){let c=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=i?.nonce||i?.getAttribute("nonce");r=c(n.map(d=>{if(d=Wmt(d),d in OB)return;OB[d]=!0;const u=d.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":Ymt,u||(g.as="script"),g.crossOrigin="",g.href=d,l&&g.setAttribute("nonce",l),document.head.appendChild(g),u)return new Promise((f,y)=>{g.addEventListener("load",f),g.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return r.then(i=>{for(const l of i||[])l.status==="rejected"&&a(l.reason);return t().catch(a)})},qmt=e=>[{path:"/products/:retailerProductId/details",Component:e.Main,key:"main",children:[{index:!0,lazy:async()=>{const{Bop:t}=await Rn(async()=>{const{Bop:n}=await import("./bop-K01uqWqK.js");return{Bop:n}},__vite__mapDeps([0,1,2,3]));return{Component:t}}}]},{path:"/products/:retailerProductName?/:retailerProductId",Component:e.Main,key:"main",children:[{index:!0,lazy:async()=>{const{Bop:t}=await Rn(async()=>{const{Bop:n}=await import("./bop-K01uqWqK.js");return{Bop:n}},__vite__mapDeps([0,1,2,3]));return{Component:t}}}]}],Kmt=e=>[{path:"/campaign/:pageName",Component:e.Main,children:[{index:!0,lazy:async()=>{const{Campaign:t}=await Rn(async()=>{const{Campaign:n}=await import("./campaign-BAwaXs9s.js");return{Campaign:n}},__vite__mapDeps([4,1,2,3]));return{Component:t}}}]},{path:"/redirect/:pageName",Component:e.Main,children:[{index:!0,lazy:async()=>{const{Campaign:t}=await Rn(async()=>{const{Campaign:n}=await import("./campaign-BAwaXs9s.js");return{Campaign:n}},__vite__mapDeps([4,1,2,3]));return{Component:t}}}]}],KN=()=>"/smart-shop",zN=(e="")=>`${e}/lists`,kZt=(e,{basePath:t=""}={})=>`${zN(t)}/${e}`,Q7=()=>"/regulars",zmt=h.forwardRef((e,t)=>{const{formatMessage:n}=M(),{a11y:o,...r}=e,a=o||{labels:{"arrow-left":n("salt.tabs.left.arrow.a11y.label"),"arrow-right":n("salt.tabs.right.arrow.a11y.label")}};return s.jsx(hy,{a11y:a,...r,ref:t})}),Qmt=h.forwardRef((e,t)=>{const{isSSRNavigation:n}=e;if(n){const{children:d,id:u,href:m,isSSRNavigation:g,...f}=e;return s.jsx(hy.Link,{ref:t,id:u,asChild:!0,children:m?s.jsx(rt,{href:m,...f,children:d}):s.jsx("a",{...f,children:d})})}const{children:o,id:r,to:a,href:i,isSSRNavigation:l,...c}=e;return s.jsx(hy.Link,{ref:t,id:r,asChild:!0,children:a?s.jsx(Qe,{to:a,...c,children:o}):s.jsx("a",{...c,children:o})})}),xa={...zmt,Link:Qmt,LinkText:hy.LinkText},Oi={FAVORITES:"FAVORITES",SHOPPING_LISTS:"SHOPPING_LISTS",INSTANT_SHOP:"INSTANT_SHOP",REGULARS:"REGULARS"},Xmt=(e,t,n)=>t?void 0:`${e.path()}?source=tabs&sourceEventId=${n}`,Zmt=({activeTab:e,children:t})=>{const n=M(),o=F(),r=KC(),a=ZC(),[i,l]=h.useState(vt()),c=m=>{let g,f;switch(m){case Oi.FAVORITES:g=gt.FAVORITES_TAB_CLICKED,f="User clicked on the favorites tab";break;case Oi.INSTANT_SHOP:g=gt.SMART_CART_TAB_CLICKED,f="User clicked on the smart cart tab";break;case Oi.SHOPPING_LISTS:g=gt.LISTS_TAB_CLICKED,f="User clicked on the shopping lists tab";break;case Oi.REGULARS:g=gt.REGULARS_TAB_CLICKED,f="User clicked on the regulars tab";break;default:g=gt.FAVORITES_TAB_CLICKED,f="User clicked on the favorites tab";break}o(U.analyticsEvent({type:g,description:f,pageEventId:i})),l(vt())},u=[{titleKey:"shopping.lists.tab.favs",path:Mg,name:Oi.FAVORITES,hidden:!1},{titleKey:"instant.shop.tab",path:KN,name:Oi.INSTANT_SHOP,hidden:!a},{titleKey:"regular.orders.tab",path:Q7,name:Oi.REGULARS,hidden:!r},{titleKey:"shopping.lists.tab.lists",path:zN,name:Oi.SHOPPING_LISTS,hidden:!1}].filter(m=>!m.hidden);return s.jsxs("div",{className:"salt-m-t--8 salt-m-b--8 lg:salt-m-b--16",children:[s.jsx(xa,{className:"salt-m-b--2",highlightedId:e,children:u.map(m=>{const g=e===m.name;return s.jsx(xa.Link,{id:m.name,to:Xmt(m,g,i),onClick:()=>c(m.name),children:s.jsx(xa.LinkText,{children:n.formatMessage(m.titleKey)})},m.name)})}),t]})},Jmt=ee("GET_FAVORITES_PAGE_ADVERTS"),X7=()=>({type:"API",payload:{url:"/v1/content?page=FAVORITES",...Jmt}}),PB=D("seo.rdbl"),NB=D("di"),JA=({category:e,filters:t,sortOption:n,pageToken:o,isRetailerCategoryId:r=!1})=>async(a,i)=>{const l=i(),c={imageFormats:io(l)??[],isSEOReadableURLEnabled:PB(l),isDynamicImagesEnabled:NB(l)},d={category:e,filters:t,sortOption:n,pageToken:o,isRetailerCategoryId:r,transformerConfig:c},u=Sm.getPPWSFavoritesPage;return a(u(d)).then(async m=>{if(!m)return;let{payload:{responseData:g}}=m;g=gS(g,io(l)??[],PB(l),NB(l));const{entities:f,nextPageToken:y,result:{productGroups:I,missedPromotions:S,breadcrumbs:C,retailerCategoryId:_}}=g;for(const A in f.product)f.product[A]===void 0&&delete f.product[A];return a(Ft.setProducts(f)),S?.length&&a(Ao.addMissedPromotions(S)),{products:ng()(g),productGroups:I,...o&&{nextPageToken:y,productCount:yp(I).length},breadcrumbs:C,retailerCategoryId:_}})},{AdvertisingBannerContent:eht}=aY,LB=T(eht)`
    overflow: ${({isOverflowVisible:e})=>e?"visible":"hidden"};
`,{AdvertisingBanner:tht}=aY,Z7=T(tht)`
    align-self: normal;
`,sht=T(Z7)`
    ${({newProductList:e})=>e?`
        margin-bottom: 0;
        padding-left: 0;
        padding-right: 0;
        min-width: 0;
    `:""}
    > div {
        z-index: 1;
        border: none;
    }

    a {
        &:focus {
            border-radius: var(--salt-radius-default);
        }

        position: static;
        ${oe.smUp`
            position: absolute;
        `}
    }
`,nht=({advert:e,advertProps:{imageUrl:t,imageWidth:n,...o},contentProps:r,children:a,image:i})=>{const[l]=fe(["bl.d"]),[c]=fe(["new.prl"]),d=p8(i);return e?.format==="DOUBLE_TILE"?s.jsx(sht,{"data-test":"standardized-advert",newProductList:c,children:s.jsx(LB,{...r,children:s.jsx(L9,{disableBlurring:l,$imageSet:d,...o,children:a})})}):s.jsx(Z7,{children:s.jsx(LB,{...r,children:s.jsx(yP,{...o,children:a})})})},kB=(e,t)=>{switch(e){case"DOUBLE_TILE":return{sequence:t,size:2};default:return{}}},oht=({advert:e,index:t,page:n})=>{const{reportStaticAdvertImpression:o,reportStaticAdvertClick:r}=XC(n,e?.placement||"WITHIN_GRID"),[a,i]=h.useState(!1),l=e?.images?.[0],d=CN(()=>{e&&l?.url&&o({id:e.id,name:e.name,altText:l.altText,contentSource:e.contentSource,targetUrl:u,linkType:e.target.linkType,segments:e.segments,format:e.format,imageUrl:l.url,...kB(e.format,t)})}),u=O9(e?.target);if(!e||!l?.url)return null;const m=()=>i(!a),g=()=>m(),f=()=>m(),y=()=>{r({id:e.id,name:e.name,altText:l.altText,contentSource:e.contentSource,targetUrl:u,linkType:e.target.linkType,segments:e.segments,format:e.format,imageUrl:l.url,...kB(e.format,t)})},I={linkType:e?.target?.linkType,"data-test":"advertising-banner",href:u,target:e.target?.openInNewTab?"_blank":void 0,isExternalLink:e.isExternalLink,title:l.altText,imageUrl:l.url,imageWidth:l.width,onClick:y,onBlur:f,onFocus:g},S={isOverflowVisible:a};return s.jsx(nht,{advertProps:I,contentProps:S,advert:e,image:l,children:s.jsx(QC,{image:l,contentSource:e.contentSource,pixelDensity:!0,children:s.jsx("img",{ref:d,src:l.url,alt:l?.altText??"",loading:"lazy"})})})},J7=e=>{switch(e){case"search":return Ilt;case"categories":return ult;case"logged-in-homepage":case"logged-out-homepage":return Flt;case"promotions":return Plt;case"favorites":return Alt;default:return()=>null}},eb=({index:e=0,page:t})=>{const n=E(J7(t));return n?s.jsx(oht,{page:t,advert:n,index:e}):null},rht=e=>{switch(e){case"search":return ylt("aboveGrid");case"categories":return dlt("aboveGrid");case"promotions":return klt("aboveGrid");case"favorites":return Rlt("aboveGrid");default:return()=>[[],{randomizeInitialHorizontalAdvert:!1},!1]}},mI=({page:e,pageKey:t,sizes:n,isNoProductsPage:o})=>{const[r,a,i]=E(rht(e)),l=AJe(r);return o||!r.length||i?null:s.jsx(IP,{className:"salt-p-x--2 lg:salt-p-x--0 salt-p-y--2",adverts:l,advertDimensionsMap:d8,page:e,pageKey:t,placement:"ABOVE_GRID",randomInitialIndex:a.randomizeInitialHorizontalAdvert,sizes:n})},aht=({productId:e,retailerProductId:t,regular:n,productIndex:o,subPage:r,section:a,name:i,page:l})=>s.jsx(ZQ,{productId:e,retailerProductId:t,productName:i,initialFrequency:n?.frequency,initialQuantity:n?.quantity,section:a,page:l,subPage:r,productIndex:o}),iht=({page:e,onInitialFopLoad:t,rankingScoreByProductId:n})=>{const o=E(Kze),r=E($ze);return o?s.jsxs(h.Fragment,{children:[s.jsx(Xp,{type:"regular","data-test":"regulars-fop-container",productGroups:[o.group],productsByProductId:o.products,page:e,isFetching:r,onInitialFopLoad:t,rankingScoreByProductId:n,withoutShoppingListsModal:!0,fopControlsFactory:({productId:a,retailerProductId:i,regular:l,productIndex:c,subPage:d,section:u,name:m})=>aht({productId:a,retailerProductId:i,regular:l,productIndex:c,subPage:d,section:u,name:m,page:e})}),s.jsx(Zn,{className:"salt-m-y--4 md:salt-m-y--8"})]}):null};function lht(e){const t=document.querySelector(e);t&&(t.setAttribute("tabindex","-1"),t.focus({preventScroll:!0})),window.scrollTo({top:0,behavior:"smooth"})}const eX=e=>{const{className:t,focusElement:n}=e;return s.jsx("div",{className:`scroll-to-top ${t||""}`,children:s.jsxs(b,{intent:"secondary",fill:!1,onClick:()=>lht(n),children:[s.jsx(b.Icon,{name:"arrow_up"}),s.jsx(b.Text,{children:s.jsx(v,{id:"button.scroll.to.top"})})]})})};function MB(e){return e.type==="PRODUCT"}const jB=e=>{switch(e){case"xs":return"var(--salt-spacing-1)";case"sm":return"var(--salt-spacing-2)";case"md":return"var(--salt-spacing-4)";case"lg":return"var(--salt-spacing-8)";case"xl":return"var(--salt-spacing-16)";default:return"unset"}},cht=T.div`
    display: grid;
    position: relative;
    gap: ${({mobileGap:e})=>jB(e)};

    ${oe.smUp`
         grid-template-columns: repeat(auto-fill, minmax(${H(184)}, 1fr));
         gap: ${({gap:e})=>jB(e)};
    `}
`,wB=T.div`
    display: grid;

    &.aligned-right {
        ${({indexOnSmallScreen:e=3})=>`grid-row: ${e+1};`}
    }

    ${oe.smUp`
        grid-column: span 2;
        ${({rowIndex:e=1})=>`grid-row: ${e};`}

        &.aligned-right {
            ${({rowIndex:e=1})=>`grid-row: ${e};`}
            grid-column-end: -1;
        }

        &:empty {
            display: none;
        }
    }
 `}
`,dht={xs:"S",sm:"M",md:"L",lg:"XL"},hI=(e,t)=>({type:"PRODUCT",group:t,id:e}),uht=(e,t)=>({type:"FAVOURITE_TILE",group:t,id:e}),pht=(e,t,n)=>{if(t.featuredProductsPerViewportMap)(n?t.featuredProductsPerViewportMap[dht[n]]:t.featuredProductsPerViewportMap.XL).forEach(r=>e.push(hI(r,t)));else if(t.viewportConfig){let o=t.products.length;n&&(o=t.viewportConfig[n]),t.products.slice(0,o).forEach(r=>{e.push(hI(r,t))})}},mht=(e,t)=>{const{currentBreakpoint:n}=h.useContext(Pn),o=Cs("default-max-num-products-displayed-in-favorites-cluster"),r=Ne(),[a,i]=fe(["sa.fav","fbf"]),{favoritesOnly:l=void 0}=tt.parse(r.search),d=t&&!l&&a&&i&&t;return h.useMemo(()=>e?e.reduce((u,m)=>(Lt.FEATURED===m.type||Lt.FEATURED_CROSS_SELL===m.type?pht(u,m,n):d&&m.type==="favorite"&&m.products.length===Number(o)?(m.products.forEach(f=>{u.push(hI(f,m))}),u.push(uht("favorite-tiles",m))):m.products.forEach(f=>{u.push(hI(f,m))}),u),[]):[],[e,n])},hht=(e,t=!1)=>{const[n,o]=h.useState(0);return h.useEffect(()=>{if(!t)return()=>{};const r=ed(()=>{e&&e.current&&o(window.getComputedStyle(e.current).getPropertyValue("grid-template-columns").split(" ").length)},100);return r(),window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}},[t,e?.current]),n},ght=(e=[])=>[{type:"MEDIUM_RECTANGLE",rowIndex:1},...e],Eht=()=>[],fht={categories:hlt,search:Tlt},yht=e=>({type:"SHOPPABLE_BANNER",contentSource:e.contentSource,rowIndex:e.position??0,backgroundColor:e.backgroundColor??"#00000",images:e.images??[],productIds:e.productIds??[],placement:e.placement,id:e.id,name:e.name,segments:e.segments,format:e.format}),Iht=(e=[],t=0,n=[])=>{const o=e.slice();return n.forEach(r=>{const{position:a=1}=r,i=o.find(({type:c})=>c==="DOUBLE_TILE_ADVERT"||c==="MEDIUM_RECTANGLE");let l=(a-1)*t;i?.rowIndex===a&&(i.rowIndex+=1),i?.indexOnSmallScreen===a-1&&(i.indexOnSmallScreen+=1),i&&l!==0&&t>1&&(l-=1),o.splice(l,0,yht({...r,position:a}))}),o},Sht=(e,t,n,o)=>{const r=n==="search",a=E(fht[n]??Eht),i=w9[n],[l,c]=E((i??F9)()),u=E(J7(n))?.format==="MEDIUM_RECTANGLE",m=mht(e,r),[g,f]=fe(["sb.test","sb.vs.ca"]),y=l&&c||a?.length!==0,I=hht(o,y),S=h.useMemo(()=>{if(m.length===0||!t||t.length===0||g&&f&&a?.length!==0)return m;const C=new Map;t?.forEach((R,O)=>{R.position&&C.set(R.position,O)});const _=[];let A=0;m.forEach(R=>{let O=C.get(A+1);for(;O||O===0;)_.push(t[O]),A+=1,O=C.get(A+1);_.push(R),A+=1});const x=t.filter(R=>R.position&&R.position>A);return x.length>0?_.concat(x):_},[m,t]);return h.useMemo(()=>{let C=S;return l&&(C=Ult(C,I,c)),u&&(C=ght(C)),a?.length!==0&&I!==0&&(!g||g&&f||g&&!f&&t?.length===0)&&(C=Iht(C,I,a)),C},[S,n,l,u,I,a])},Cht=D("bt.top"),Tht=e=>({renderNode:{[un.BLOCKS.HEADING_1]:(t,n)=>s.jsx(P,{size:"l",bold:!0,className:"salt-m-b--2",children:n}),[un.BLOCKS.PARAGRAPH]:(t,n)=>Array.isArray(n)&&n.length===1&&n[0]===""?s.jsx("br",{}):s.jsx(P,{size:"m",className:"salt-m-b--4",children:n}),[un.BLOCKS.UL_LIST]:(t,n)=>s.jsx("ul",{className:"salt-m-b--4 salt-m-t--0",children:s.jsx(P,{size:"m",children:n})}),[un.BLOCKS.OL_LIST]:(t,n)=>s.jsx("ol",{className:"salt-m-b--4 salt-m-t--0",children:s.jsx(P,{size:"m",children:n})}),[un.BLOCKS.LIST_ITEM]:(t,n)=>s.jsx("li",{children:s.jsx(P,{size:"m",children:n})}),[un.INLINES.HYPERLINK]:(t,n)=>s.jsx(rt,{onClick:()=>e(n,t.data.uri),target:"_blank",size:"m",bold:!0,href:t.data.uri,children:n})}}),tX=()=>{const e=E(zPe),t=(c,d)=>{r({type:ku.SEO_TEXT_BLOCK_ITEM_CLICKED,SEOItemString:c,url:d})},n=ps({breakpoint:"sm-up"}),o=h.useMemo(()=>Tht(t),[e]),r=ts(),a=$I.documentToReactComponents(e,o),i=E(Cht);h.useEffect(()=>{r({type:ku.SEO_CATEGORY_DESCRIPTION_LOADED})},[]);const{ref:l}=wb({triggerOnce:!0,onChange(c){c&&r({type:ku.SEO_CATEGORY_DESCRIPTION_IMPRESSION})}});return e?s.jsx(ve,{ref:l,className:`salt-m-t--8 ${i?"salt-m-b--2":"salt-m-b--8"}`,condensed:n,"data-test":"seo-content-field",children:s.jsx(se,{direction:"column",children:a})}):null},_ht=e=>{const t=F(),[n,o]=h.useState(!0),r=async()=>{o(!0),await t(NW(e)),o(!1)};h.useEffect(()=>{e.length>0?r():o(!1)},[e]);const a=Bde(e);return{productData:E(a),isLoading:n}},FB={landscape:{promotion:{numberOfLines:1,expand:!0,compress:!1},title:{numberOfLines:1},image:{resolution:{height:88,width:88}},packSize:{fontSize:"m",position:np.OWN_LINE},bottomAttributes:{maxLifestyleIcons:3,ratingBadgeOrBoughtDate:!0},price:{direction:"row"}}},BB=De`
    inline-size: ${H(X5)};
`,vht=T.div`
    padding-block-start: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-2);
    inline-size: 100%;
    flex: 1;

    [data-retailer-anchor='fop-skeleton'],
    [data-retailer-anchor='fop'] {
        /* stylelint-disable-next-line plugin/use-logical-properties-and-values, liberty/use-logical-spec */
        height: inherit;
    }
`,Aht=({products:e,group:t,page:n,isLoading:o})=>{const{formatMessage:r}=M(),[a,i]=h.useState(!1),l=h.useRef(null);h.useEffect(()=>{if(!l.current)return()=>{};const d=l.current.querySelector('[class*="_horizontal-scroll__content"]'),u=()=>{d&&i(d.scrollWidth>d.clientWidth)};u();const m=new ResizeObserver(ed(u,250));return m.observe(l.current),()=>{m.disconnect()}},[o]);const c=()=>Array.from({length:e.length}).map((d,u)=>s.jsx(ka,{loading:!0,page:n,type:"products",noOfferLink:!1,displayLandscapeLayout:!0,withoutHeader:!0,fopPositionOnPage:u,overrideConfig:FB,customStyling:BB},`sk-${u}`));return s.jsx(vht,{"data-test":"shoppable-banner-carousel",children:s.jsx(oi,{ref:l,a11y:{labels:{"next-button":r("scroller.accessibility.viewNext"),"previous-button":r("scroller.accessibility.viewPrevious")}},contrastBackground:!0,navigationButtonPosition:a?"header":"side",title:s.jsx("div",{children:" "}),children:o?c():e.map(({productId:d},u)=>s.jsx("div",{id:`carousel-fop-${u}`,children:s.jsx(ka,{productId:d,group:t,position:u,page:n,subPage:null,noOfferLink:!1,type:"products",withoutHeader:!0,customStyling:BB,displayLandscapeLayout:!0,fopPositionOnPage:u,sendFopImpression:!0,loading:!1,overrideConfig:FB})},d))})})},bht=T.div`
    img {
        inline-size: 100%;
    }

    ${oe.smUp`
        flex-basis: 400px;
        block-size:100%;
        img {
            block-size:100%;
        }
    `}
`,xht=({images:e,contentSource:t})=>{const[n]=EP();let o;return n&&(o=rI(e,uJe[n])),s.jsx(bht,{children:o&&s.jsx(QC,{image:o,contentSource:t,children:s.jsx("img",{src:o.url,alt:o.altText,loading:"lazy"})})})},Rht=T.div`
    overflow: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    grid-row: auto;
    grid-column: auto;
    background-color: ${({backgroundColor:e})=>e};
    margin-block-start: var(--salt-spacing-4);
    margin-inline: calc(var(--salt-spacing-2) * -1);
    ${oe.smUp`
        max-height: 220px;
        grid-column: 1 / -1;
        border-radius: var(--salt-radius-default);
        margin-inline: 0;
        flex-direction: row;
        justify-content: space-between;
    `}
`,Dht=({advert:e,page:t})=>{const{rowIndex:n,backgroundColor:o,images:r,productIds:a}=e,{productData:i,isLoading:l}=_ht(a),[c]=bre("shoppable_banner_product_limit");let d=i;c.enabled&&(typeof c.variables.productLimit=="number"?d=i.slice(0,c.variables.productLimit):Me.api.pushError(new Error(`Optimizely: Feature flag 'shoppable_banner_product_limit' is enabled but 
                    'productLimit' is missing or invalid. Value: ${JSON.stringify(c.variables)}`)));const{reportStaticAdvertImpression:u}=XC(t,e.placement),g=CN(()=>{e&&u({id:e.id,name:e.name,altText:r[0]?.altText||"",contentSource:e.contentSource,segments:e.segments,format:e.format,sequence:n,imageUrl:r[0]?.url||""})}),f={type:Lt.SHOPPABLE_BANNER,section:Lt.SHOPPABLE_BANNER,groupTitle:Lt.SHOPPABLE_BANNER,products:a,name:"",clusterBreadcrumbs:[]};return d.forEach(y=>{y.featuredProductCampaign={...y.featuredProductCampaign,campaignId:e.id,campaignName:e.name}}),s.jsxs(Rht,{backgroundColor:o,ref:g,children:[s.jsx(xht,{images:r,contentSource:e.contentSource}),s.jsx(Aht,{products:d,group:f,page:t,isLoading:l})]})},Oht=(e,t)=>{const n=e.item,o=t.item,r=e.isProductDecorated===t.isProductDecorated&&e.isBeingDecorated===t.isBeingDecorated;return $i(n,o)&&r},Pht=h.memo(({displayLandscapeLayout:e,index:t,isProductDecorated:n,item:o,noOfferLink:r=!1,page:a,pageEventId:i,isBeingDecorated:l,type:c,withoutHeader:d})=>{const u=E(_d),g=E(Q1)?.boolean?.includes("favoritesOnly")??!1,f=E(Ox),[y,I]=h.useState(!0),S=h.useRef(null),[C,_]=h.useState(null),[A,x]=h.useState(!0),R=k=>{k&&_(k)};h.useEffect(()=>{if(C)return S.current=xre(C,k=>{I(k)},{rootMargin:"25% 0px 25% 0px"}),()=>{S.current&&S.current()}},[C]),h.useEffect(()=>{if(!C||!(C instanceof Element))return;const k=new MutationObserver(j=>{j.forEach(w=>{if(w.type==="attributes"){const L=w.target;getComputedStyle(L).display==="none"&&(k.disconnect(),S.current&&S.current(),x(!1))}})});return k.observe(C,{attributes:!0}),()=>{k.disconnect(),S.current&&S.current()}},[C]);const O=()=>{if(a==="categories"){const k=u&&u.length>0?[...u].pop().name:"";return k?ri(k.trim()):null}return null},N=h.useMemo(()=>a==="regulars"?g9:{},[a]);if(!A)return null;switch(o.type){case"STATIC_ADVERT":return s.jsx(M9,{advert:o,page:a,sequence:t},`${o.id}${o.position}`);case"FAVOURITE_TILE":return g?null:s.jsx(j9,{favouritesAmount:o.group.products.length,isNewProductList:!0},o.id);case"RECIPE_ADVERT":{const k={isNewProductList:!0,sequence:t,productListName:Ws(a,O())||"",...a==="search"&&{advertPage:Bl.SEARCH,searchPagePath:f},...a==="categories"&&{advertPage:Bl.CATEGORY,categoryPagePath:f}};return o.format===Zy.RECIPE_CARD?s.jsx(p7,{...o.fields,...k},`${o.fields.recipeId}${o.position}`):s.jsx(m7,{...o.fields,...k},`${o.fields.collectionId}${o.position}`)}case"DOUBLE_TILE_ADVERT":{const k=o.aligned==="RIGHT"?"aligned-right":"";return s.jsx(wB,{"data-test":"product-list-ad-container",className:k,rowIndex:o.rowIndex,indexOnSmallScreen:o.indexOnSmallScreen,children:s.jsx(eb,{page:a,index:t})})}case"MEDIUM_RECTANGLE":return s.jsx(wB,{"data-test":"product-list-ad-container",rowIndex:o.rowIndex,children:s.jsx(eb,{page:a})});case"SHOPPABLE_BANNER":return s.jsx(Dht,{advert:o,page:a});case"EMPTY_TILE":return s.jsx("span",{"data-test":"empty-tile"});case"PRODUCT":{if(!n&&!l)return null;const{group:k,id:j}=o,L=!(k.type==="featured")&&(l||!y);return s.jsx(ka,{productId:j,loading:L,group:k,position:t+1,page:a,type:c,subPage:O(),noOfferLink:r,displayLandscapeLayout:e,withoutHeader:d,overrideConfig:N,fopPositionOnPage:t,sendFopImpression:!0,pageEventId:i,inViewRef:t===0?void 0:R})}default:return null}},Oht),UB=24,Nht=({productGroups:e,productsByProductId:t,page:n,noOfferLink:o=!1,type:r,isFetching:a,displayLandscapeLayout:i,withoutHeader:l,productCardAdvertsToInsert:c,loadMoreProducts:d,hasMoreProducts:u,pageEventId:m,onInitialProductsRendered:g})=>{const[f,y]=h.useState([]),[I,S]=h.useState([]),[C,_]=h.useState([]),A=F(),[x,R]=h.useState(!1),{productList:O}=wC(),N=h.useRef(null),k=Sht(e,c,n,N),j=h.useCallback(te=>!!t[te],[t]),w=h.useMemo(()=>{let te=-1;for(let ce=0;ce<k.length;ce+=1){const de=k[ce];if(de?.type==="PRODUCT")if(j(de.id))te=ce;else return te}return te},[k,j]),L=h.useMemo(()=>{if(w===-1||k.length===0||a)return!1;const te=k.filter(ye=>ye.type==="PRODUCT"),ce=k[w],de=te[te.length-1];return ce?.type==="PRODUCT"&&de&&(ce.id===de.id||C.includes(de.id))},[w,C,a]),B=h.useCallback(te=>A(Nwe({productIds:te})).then(ce=>{const de=ce.payload.product;Object.entries(de).length===0?(_(te),Me.api.pushError(new Error(`Failed product decoration, discarding following products: ${te.toString()}`))):_([]),S([]),y([])}).catch(ce=>{Me.api.pushError(new Error(`Failed product decoration for productIds ${te.toString()}`,{cause:ce})),S([...te])}).finally(()=>{R(!1)}),[C]),W=h.useCallback(ed(te=>{B(te)},1e3),[]),$=h.useCallback(()=>{if(I.length>0){R(!0),W(I);return}if(f.length>0)return;if(L){u&&d&&(R(!0),d().finally(()=>{R(!1)}));return}R(!0);const te=w+1,ce=te+UB;let de=k.slice(te,ce).filter(MB).map(ye=>ye.id);de.every(ye=>C.includes(ye))&&(de=k.slice(te+C.length,ce).filter(MB).map(ye=>ye.id)),y(de),B(de)},[w,k,f,I,C]),{ref:K}=wb({rootMargin:"0% 0% 100% 0%",onChange(te){te&&$()}}),Q=h.useMemo(()=>{if(!u&&L)return k;let te=w+1;return f.length>0&&(te+=UB),k.slice(0,te)},[k,f,w]);h.useEffect(()=>{if(a){R(!0);return}Q.filter(ce=>ce.type==="PRODUCT"&&j(ce.id)).length>0&&g?.(),R(!1)},[a]);const X=()=>Array.from({length:25}).map((te,ce)=>s.jsx(ka,{loading:!0,page:n,type:r,noOfferLink:o,displayLandscapeLayout:i,withoutHeader:l,fopPositionOnPage:ce},`sk-${ce}`)),re=(te,ce)=>({index:ce,isProductDecorated:te.type==="PRODUCT"&&j(te.id),item:te,noOfferLink:o,page:n,pageEventId:m,isBeingDecorated:te.type==="PRODUCT"&&f.includes(te.id),type:r,withoutHeader:l}),ue=(te,ce)=>{if(te.type==="PRODUCT"){const{id:de,group:ye}=te;return`${de}${ye.type}${ye.name}${ce}`}return te.type==="DOUBLE_TILE_ADVERT"?`DOUBLE_TILE_ADVERT${te.indexOnSmallScreen}`:te.type==="EMPTY_TILE"?`EMPTY_TILE${ce}`:te.type==="STATIC_ADVERT"?`${te.id}`:te.type==="RECIPE_ADVERT"?`${te.fields.title}`:te.type==="SHOPPABLE_BANNER"?`SHOPPABLE_BANNER${te.rowIndex}`:""};return Q.length===0?null:s.jsxs(h.Fragment,{children:[s.jsxs(cht,{ref:N,gap:O?O.landscape.gap:"md",mobileGap:O?O.portrait.gap:"md","data-retailer-anchor":"product-list",children:[a?X():Q.map((te,ce)=>h.createElement(Pht,{...re(te,ce),key:ue(te,ce)})),s.jsx(fN,{})]}),s.jsx("div",{ref:x?null:K}),n==="categories"?s.jsx(tX,{}):null]})},sX=e=>t=>t(v3e.fetchSearchPageRecipeAdverts(e)).catch(()=>{}),Lht=ee("GET_SEARCH_PAGE_ADVERTS"),nX=e=>{const t=typeof e=="string"?e.trim():"";return{type:"API",payload:{url:`/v1/content?${tt.stringify({page:"SEARCH",key:t})}`,...Lht}}},{GET_SEARCH_CATALOGUE:kht,GET_NEXT_SEARCH_CATALOGUE_PAGE:Mht,GET_CROSS_SELL_PRODUCTS:jht}=ft.types,wht=50,Fht=({category:e,filters:t,sortOption:n,additional:o,pageToken:r,isRetailerCategoryId:a,transformerConfig:i,isCrossSellUpdate:l=!1,headers:c={}})=>(d,u)=>{const m=u(),g=zb(m),{term:f=""}=o,y=tt.stringify({...a?{retailerCategoryId:e}:{categoryId:e},...t&&{filters:tt.stringify(t,{arrayFormat:"separator",arrayFormatSeparator:","})},q:f==="string"?f.substring(0,wht):f,sortOptionId:n,pageToken:r,tag:"web",includeAdditionalPageInfo:!r,maxProductsToDecorate:Kb(m),maxPageSize:bC},{skipEmptyString:!0});return g&&(c.ContentExperienceUserId=g),d({type:"API",transformerConfig:i,payload:{url:`/v6/product-pages/search?${y}`,service:"web_product_page_ws",pathPrefix:{client:"/api/webproductpagews",server:"/core-api"},options:{headers:c,maxRetries:1},...r?Mht:kht,...l?jht:{}}})},Bht={getPPWSSearchPage:Fht},tb=D("seo.rdbl"),sb=D("di"),Uht=({dispatch:e,data:t,state:n,props:o,crossSellProductsAction:r})=>{const{entities:a,result:{productGroups:i}}=t,l=i?.find(d=>d.type==="featured_cross_sell")?.products;l&&l.find(d=>!a.product[d])&&e(r(o)).then(d=>{let{payload:{responseData:u}}=d;u=gS(u,io(n)??[],tb(n),sb(n));for(const m in a.product)a.product[m]===void 0&&delete a.product[m];e(Ft.setProducts(u.entities))})},QN=({category:e,filters:t={},sortOption:n,pageToken:o,additional:r,isRetailerCategoryId:a,headers:i={}})=>(l,c)=>{const d=c(),m={transformerConfig:{imageFormats:io(d)??[],isSEOReadableURLEnabled:tb(d),isDynamicImagesEnabled:sb(d)},category:e,filters:t,sortOption:n,pageToken:o,additional:r,isRetailerCategoryId:a,headers:i},g=Bht.getPPWSSearchPage;return l(g(m)).then(f=>{if(!f)return;let{payload:{responseData:y}}=f;y=gS(y,io(d)??[],tb(d),sb(d));const{entities:I,result:{productGroups:S,missedPromotions:C,nextPageToken:_,breadcrumbs:A,retailerCategoryId:x}}=y;for(const R in I.product)I.product[R]===void 0&&delete I.product[R];return l(Ft.setProducts(I)),o||Uht({dispatch:l,data:y,state:d,props:m,crossSellProductsAction:g}),C?.length&&l(Ao.addMissedPromotions(C)),{products:ng()(y),productGroups:S,...o&&{nextPageToken:_,productCount:yp(S).length},breadcrumbs:A,retailerCategoryId:x}})},XN=function(e){if(!e)return{};const t={},n=e.get($s.ADVERTISING_CONTENT_SOURCE_OVERRIDE);return n&&(t[$s.ADVERTISING_CONTENT_SOURCE_OVERRIDE]=n),t},ST=()=>{const e=F(),[t]=fe(["rec"]),n=Ne(),o=new zi;return{fetchSearchResultsPage:({term:a,category:i,sortOption:l,filters:c})=>{const d=new URLSearchParams(n.search),u=a||d.get("q")||void 0;return e(nX(u)).catch(m=>{Me.api.pushError(m)}),t&&u&&e(sX(u)).catch(m=>{Me.api.pushError(m)}),e(QN({category:i,filters:c,sortOption:l,additional:{term:u},isRetailerCategoryId:!1,headers:XN(o)}))}}},Ght=T(b.Text)`
    white-space: nowrap;
    text-transform: capitalize;
`,oX=({term:e,href:t,a11yLabel:n,handleSuggestionClick:o,source:r})=>{const a=F(),{fetchSearchResultsPage:i}=ST(),l=()=>{o(),i({term:e}).then(()=>{a(ft.setLastFetchedCatalogueLocation(void 0))})};return s.jsx(b,{asChild:!0,intent:"tertiary-contrast",size:"s",children:s.jsxs(Qe,{intent:"ghost",to:t,state:{source:r,isPrefetched:!0},onClick:l,children:[s.jsx(Ee,{children:n}),s.jsx(Ght,{"aria-hidden":"true",children:e})]})})},$ht=Yl`
  from {opacity: 0;}
  to {opacity: 1;}`,Hht=T.div`
    --scrollbar-width: ${({scrollbarWidth:e})=>H(e)};
    --background-color: ${({isSticky:e})=>e?"var(--intent-primary-50)":"var(--background-color)"};

    z-index: 4;
    background-color: var(--background-color);
    inset-block-start: ${({headerSize:e})=>e}px;
    transition: background-color 0.1s linear;
    animation-name: ${({shouldDisplay:e})=>e&&$ht};
    animation-duration: 0.4s;
    position: sticky;
    overflow: visible;
    inline-size: calc(100vi - var(--scrollbar-width));
    margin-inline-start: calc(50% - (50vi - var(--scrollbar-width) / 2));
`,Vht=T(oi)`
    --salt-horizontal-scroll-content-padding: 0;
    --salt-horizontal-scroll-background-color: var(--background-color);
`,Yht=T.div`
    margin-block: 0;
    margin-inline: auto;
    max-inline-size: ${H(1920)};
`,Wht=()=>{const e=ts(),t=F(),n=Ne(),{formatMessage:o}=M(),r=E(B=>On(B)),a=E(PO),i=E(Sp),l=E(Vs),c=E(Dx),[d]=fe(["seo.rdbl"]),[u,m]=h.useState(!1),[g,f]=h.useState(0),[y,I]=h.useState(0),[S,C]=h.useState(!1),_=h.useRef(0),A=h.useRef(null),x=h.useRef([]);if(h.useEffect(()=>()=>{if(x.current.length>0){const B=a?OA(a):void 0;t(U.analyticsEvent({type:hs.SEARCH_SUGGESTION_IMPRESSION,searchSuggestionImpressions:x.current,searchSuggestionType:B,pageViewId:r}))}},[]),h.useEffect(()=>{const B=document.getElementById("product-page"),W=Jr(()=>{if(!B)return;const $=B.getBoundingClientRect().top;$&&$<0&&(m(!0),f(_.current),window.removeEventListener("scroll",W))},50);return window.addEventListener("scroll",W),()=>{window.removeEventListener("scroll",W)}},[c]),h.useEffect(()=>{const B=document.getElementById("main-header"),W=new ResizeObserver(([$])=>{const[{blockSize:K}]=$.borderBoxSize;_.current!==K&&(_.current=K,u&&f(K))});if(B){const{innerWidth:$}=window,{clientWidth:K}=document.documentElement,Q=$-K;y!==Q&&I(Q),W.observe(B)}return()=>{W.disconnect()}},[u]),h.useEffect(()=>{const B=A.current?.offsetHeight??0,$=`-${g+B+1}px 0px 0px 0px`,K=new IntersectionObserver(([Q])=>{if(Q){if(!Q.isIntersecting){C(!0);return}C(!1)}},{rootMargin:$,threshold:0});return A.current&&a&&K.observe(A.current),()=>K.disconnect()},[g,a,c]),!a)return null;const[R,O]=OA(a),k=u&&(()=>{const B=new URLSearchParams(n.search),W=decodeURIComponent(a.searchTermFromQueryParam).toLowerCase(),{correctedSearchTerm:$}=i;return $?$.toLowerCase()===W:W===B.get("q")?.toLowerCase()})()&&!!O.length&&!!c,j=R==="REFINED_SEARCH_SUGGESTION"?"refined":"followOn",w={header:o(`smart.search.ribbon.${j}.header`),buttonLabel:B=>o(`smart.search.ribbon.${j}.accessibility.button.label`,{searchTerm:B})},L=(B,W)=>{e({type:hs.SEARCH_SUGGESTION_CLICKED,id:vt(),userInput:a?.searchTermFromQueryParam,searchSuggestion:B,positionInSuggestionList:W,locale:l,suggestionsCount:O.length,suggestionType:R,location:"RIBBON",pageViewId:r}),e({type:hs.SELECT_SEARCH_SUGGESTION,searchSuggestion:B,suggestionIndex:W,suggestionType:R,location:"RIBBON"});const $={event:"select_search_suggestion",index:W,location:"RIBBON",search_suggestion:B,type:R};J.sendEvent({GA:$,WA:null})};return k?s.jsx(Hht,{headerSize:g,ref:A,isSticky:S,scrollbarWidth:y,shouldDisplay:u,className:"salt-p-y--2",children:s.jsx(Yht,{children:s.jsx(Vht,{className:"salt-m-x--2",navigationButtonPosition:"side",title:s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:w.header})}),a11y:{labels:{"next-button":o("scroller.accessibility.viewNextIn",{title:w.header}),"previous-button":o("scroller.accessibility.viewPreviousIn",{title:w.header})}},flush:!0,children:O.map((B,W)=>s.jsx(N$,{triggerOnce:!0,threshold:.79,onChange:$=>{$&&x.current.push({sequence:W,searchSuggestionType:R,location:"RIBBON",searchTerm:O[W]})},children:s.jsx(oX,{href:li(d,{queryString:`q=${encodeURIComponent(B)}`}),handleSuggestionClick:()=>L(B,W),term:B,a11yLabel:w.buttonLabel(B),source:R})},B))},R)})}):null},qht=({flushTop:e})=>e?0:`calc(${H(20)} + var(--salt-spacing-2))`,Kht=({marginBottom:e})=>e?"var(--salt-spacing-2)":0,zht=T.div`
    margin-block: ${qht} ${Kht};
    margin-inline: var(--salt-spacing-2) 0;
`,rX=({children:e,flushTop:t=!1,marginBottom:n=!0})=>s.jsx(zht,{"data-test":"navigable-content-header",flushTop:t,marginBottom:n,children:s.jsx(P,{bold:!0,asChild:!0,size:"l",children:s.jsx("h2",{children:e})})});rX.displayName="NavigableContentHeader";const GB=e=>e instanceof HTMLElement,aX=({onOpen:e,onClose:t,...n})=>{const o=h.useRef({}),r=E(m=>m.control.modal),a=E(Kg("HEADER")),i=Object.values(r).some(m=>m.isOpen),l=m=>{o.current[m.id]=window.getComputedStyle(m).overflow},c=m=>{m.style.overflow=o.current[m.id]??""},d=()=>{const m=document.querySelector("#modal-body");i&&GB(m)&&(l(m),qA(m)),i||KA(a),a9(i),KA(a),l9(i),e?.()},u=()=>{const m=document.querySelector("#modal-body");GB(m)&&c(m),t?.()};return s.jsx(Rre,{portalContainerSelector:"#modal",onOpen:d,onClose:u,...n})},Qht=T(Qe)`
    inline-size: 100%;
`,nb=({link:e,onClick:t,dataTestId:n,condensed:o=!1,isSelected:r=!1,onListItemBlur:a,onListItemSubmit:i,...l})=>{const c=h.useRef(null),d=F(),u=g=>{c.current&&(g.key===" "||g.key==="Enter")&&(g.preventDefault(),c.current.click(),i&&i())},m=(g,f)=>{d(U.analyticsEvent({type:tn.SELECT_CATEGORY_GA4_EVENT,location:"dropdown",categoryName:g,retailerCategoryId:f}));const y={event:"select_category",id:f,location:"dropdown",name:g};J.sendEvent({GA:y,WA:null}),d(U.analyticsEvent({type:tn.CATEGORY_FILTER_OPTION_CLICKED,categoryName:g}))};return s.jsx(Ve.Item,{children:s.jsx(ve,{className:"salt-d--block",asChild:!0,condensed:o,children:s.jsx(Qht,{standalone:!r,ref:c,to:e.url,tabIndex:r?0:-1,"data-test":n,onClick:()=>{e.name&&e.retailerCategoryId&&m(e.name,e.retailerCategoryId),t&&t()},onBlur:a,onKeyDown:u,...l,children:e.name})})},e.url)};nb.displayName="CategoriesListItem";function iX(e,t){return e?e.map(n=>({url:t({category:n.id,fullURLPath:n.fullURLPath,retailerCategoryId:n.retailerCategoryId}),name:n.name,retailerCategoryId:n.retailerCategoryId})):[]}const lX=h.forwardRef(function({categories:t=[],categoryRootLinks:n=[],buildUrl:o,condensed:r=!1,highlightedIndex:a,onListItemClick:i,onListItemBlur:l,onListKeyDown:c,onListItemSubmit:d},u){return s.jsxs(Ve,{innerRef:u,role:"menu",inline:!1,onKeyDown:c,children:[n&&n.map((m,g)=>s.jsx(nb,{role:"menuitem",dataTestId:"root-category-link",condensed:r,isSelected:a===g,link:m,onListItemBlur:l,onClick:i,onListItemSubmit:d},`${m.name}-${m.url}`)),iX(t,o).map((m,g)=>s.jsx(nb,{role:"menuitem",dataTestId:"category-link",condensed:r,isSelected:a===g+n.length,link:m,onListItemBlur:l,onClick:i,onListItemSubmit:d},`${m.name}-${m.url}`))]})}),Xht=T.div`
    max-block-size: ${H(300)};
    overflow-y: auto;
`,Zht=T.div`
    position: relative;
`,$B=e=>e.name?.trim()[0].toLowerCase(),Jht=({onOpen:e,buildUrl:t,categories:n,categoryRootLinks:o=[]})=>{const r=M(),a=h.useRef(null),[i,l]=ie.useState(-1),c=n.map($B),u=[...o.map($B),...c],m=n.length+o.length,g=i===m-1,f=i===0,y=()=>a.current?.querySelectorAll("a"),I=()=>{const R=m-1,O=y();l(m-1),O?.[R]?.focus()},S=()=>{const O=y();l(0),O?.[0]?.focus()},C=()=>{const R=y();l(O=>(R?.[O+1]?.focus(),O+1))},_=()=>{const R=y();l(O=>(R?.[O-1]?.focus(),O-1))},A=R=>{const O=y();let N,k;R.length>1||(N=i+1,N>=m&&(N=0),k=u.indexOf(R,N),k===-1&&(k=u.indexOf(R,0)),k>-1&&(l(k),O?.[k]?.focus()))},x=(R,O)=>{const{key:N}=R;switch(N){case"ArrowDown":R.preventDefault(),g?S():C();break;case"ArrowUp":R.preventDefault(),f?I():_();break;case"Home":case"PageUp":R.preventDefault(),S();break;case"End":case"PageDown":R.preventDefault(),I();break;case"Tab":S(),O();break;default:A(N.toLowerCase());break}};return s.jsx(Zht,{children:s.jsx(aX,{triggerTitle:r.formatMessage("bottom.sheet.categories.title"),a11y:{label:r.formatMessage("bottom.sheet.categories.title")},onClose:S,onOpen:()=>{S(),e()},renderContent:({closeDropdown:R})=>s.jsx(Xht,{children:s.jsx(lX,{ref:a,condensed:!0,highlightedIndex:i,categories:n,categoryRootLinks:o,buildUrl:t,onListKeyDown:O=>{x(O,R)}})})})})},egt=({isOpen:e,onRequestClose:t,categories:n,categoryRootLinks:o,buildUrl:r,onListItemClick:a,buttonTitle:i,onButtonClick:l})=>{const c=M();return s.jsxs(h.Fragment,{children:[s.jsx(b,{intent:"secondary",onClick:l,"aria-label":c.formatMessage("search.categories.aisles.button"),fill:!0,children:c.formatMessage(i)}),s.jsxs(G,{isOpen:e,onRequestClose:t,scrollToTop:!0,closeMessage:c.formatMessage("categories.accessibility.bottom.sheet.close.button"),asBottomSheet:!0,children:[s.jsx(G.Header,{align:"left",children:s.jsx(ne,{as:"h1",className:"salt-m-l--4",children:c.formatMessage("bottom.sheet.categories.title")})}),s.jsx(G.Body,{"data-test":"bottom-sheet-body",children:s.jsx(lX,{categories:n,categoryRootLinks:o,buildUrl:r,onListItemClick:a})})]})]})},tgt=({categoryRootLinks:e,categories:t,buildUrl:n,sendAnalyticsEvent:o=U.analyticsEvent})=>{const r=F(),[a,i]=h.useState(!1),l=()=>{r(o({type:gt.OPEN_MENU_CLICKED,menuId:"CATEGORY_FILTER"}))},c=()=>{i(!0),l()},d=()=>{i(!1)};return s.jsxs(h.Fragment,{children:[s.jsx(Kt,{breakpoint:"sm-up",remainInDom:!1,children:s.jsx(egt,{buildUrl:n,buttonTitle:"bottom.sheet.categories.title",categories:t,categoryRootLinks:e,isOpen:a,onButtonClick:c,onListItemClick:d,onRequestClose:d})}),s.jsx(cs,{breakpoint:"sm-up",remainInDom:!1,children:s.jsx(Jht,{buildUrl:n,categories:t,onOpen:l,categoryRootLinks:e})})]})},sgt=({categoryRootLinks:e=[],categories:t,buildUrl:n,className:o})=>{const r=F(),a=(i,l)=>{r(U.analyticsEvent({type:tn.SELECT_CATEGORY_GA4_EVENT,categoryName:i,retailerCategoryId:l,location:"sidebar"}));const c={event:"select_category",id:l,location:"sidebar",name:i};J.sendEvent({GA:c,WA:null}),r(U.analyticsEvent({type:tn.CATEGORY_FILTER_OPTION_CLICKED,categoryName:i}))};return s.jsxs(Ve,{inline:!1,className:o,children:[e&&e.map(i=>s.jsx(Ve.Item,{children:s.jsx(Qe,{"data-test":"root-category-link",to:i.url,standalone:!0,children:i.name})},i.url)),iX(t,n).map(i=>s.jsx(Ve.Item,{children:s.jsx(Qe,{"data-test":"root-category-link",to:i.url,standalone:!0,onClick:()=>a(i.name||"",i.retailerCategoryId||""),children:i.name})},i.url))]})},ngt=({options:e,selectedId:t="",sortHandler:n,onOpen:o=()=>{}})=>{const r=M(),a=e.find(c=>c.id===t)||null,i=pgt(a)?r.formatMessage(a.messageKey):r.formatMessage("sort.button.default"),l=e.map(c=>({value:c.id,name:r.formatMessage(c.messageKey)}));return s.jsx("div",{className:"salt-d--inline-block",children:s.jsx(mt.DropdownSelect,{name:"sort","data-test":"sort-button",id:"sort-dropdown-select",onOpen:o,value:{value:a?.id||"",name:i},options:l,placeholder:r.formatMessage("sort.button.default"),label:{text:r.formatMessage("sort.accessibility.button.closed"),isVisuallyConcealed:!0},onOptionChange:c=>{n({id:c.value,messageKey:c.name,selected:!0})}})})},{RadioIconOff:ogt,RadioIconOn:rgt,RadioText:agt}=ha,igt=T(P)`
    overflow: hidden;
`,lgt=T.strong`
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
`,cgt=({checked:e,label:t,dataTestId:n,onClick:o,highlighted:r,setHighlighted:a,className:i})=>s.jsx(Ve.Item,{id:t,role:"option",onClick:o,className:i,"aria-selected":e,onFocus:()=>{a()},tabIndex:0,children:s.jsx(ve,{children:s.jsxs("div",{className:"salt-d--flex",children:[e&&s.jsx(rgt,{name:"radio_on"}),!e&&s.jsx(ogt,{name:"radio_off"}),s.jsx(igt,{"data-test":n,children:s.jsx(agt,{asChild:!0,bold:r,children:s.jsx(lgt,{children:t})})})]})})}),cX=T(cgt)`
    cursor: pointer;
`;cX.displayName="SortListItemMobile";const dgt=({options:e,selectedId:t,sortHandler:n,onOpen:o=()=>{}})=>{const[r,a]=h.useState(!1),i=M(),l=e.find(R=>R.id===t)||null,c=l?.messageKey||"sort.button.default",u=`${i.formatMessage(c)}. ${i.formatMessage("sort.accessibility.button.closed")}`,[m,g]=h.useState(e.findIndex(R=>R.id===t)),[f]=fe(["nfsch"]),[y,I]=h.useState(l?.id),S=R=>{(R.key==="Enter"||R.key===" ")&&C(e[m])};h.useEffect(()=>(document.addEventListener("keydown",S),()=>{document.removeEventListener("keydown",S)}),[m]),h.useEffect(()=>{r||document.removeEventListener("keydown",S)},[r]);const C=R=>{n(R),a(!1)},_=R=>{n(R),a(!1)},A=()=>{o(),I(t),a(!0)},x=()=>{g(e.findIndex(R=>R.id===t)),a(!1)};return s.jsxs(h.Fragment,{children:[s.jsx(b,{intent:"secondary",fill:!0,onClick:A,"data-test":"sort-mobile-button","aria-label":u,children:s.jsx(v,{id:c})}),s.jsxs(G,{isOpen:r,onRequestClose:x,closeMessage:i.formatMessage("sort.accessibility.bottom.sheet.close.button"),asBottomSheet:!0,children:[s.jsx(G.Header,{align:"left",children:s.jsx(ne,{as:"h1",children:s.jsx(v,{id:"bottom.sheet.sort.title"})})}),s.jsx(G.Body,{"data-test":"sort-bottom-sheet-body",children:f?s.jsx(ve,{children:s.jsx(mt.RadioGroup,{value:y,groupLabel:{text:i.formatMessage("bottom.sheet.sort.title"),isVisuallyConcealed:!0},name:"mobileSort",onChange:I,radios:e.map(R=>({value:R.id,label:i.formatMessage(R.messageKey)}))})}):s.jsx(Ve,{inline:!1,role:"listbox",tabIndex:0,children:e.map((R,O)=>s.jsx(cX,{highlighted:m===O,setHighlighted:()=>g(O),checked:t===R.id,label:i.formatMessage(R.messageKey),dataTestId:"sort-mobile-option",onClick:()=>C(R)},R.id))})}),f&&s.jsx(G.Footer,{children:s.jsx(b,{intent:"primary",fill:!0,onClick:()=>_(e.find(R=>R.id===y)),"data-test":"sort-mobile-submit-button",children:s.jsx(v,{id:"bottom.sheet.sort.confirm"})})})]})]})},dX=({changeQuerystringLocation:e,sendAnalyticsEvent:t=U.analyticsEvent})=>{const n=E(Rx),o=E(Px),r=F(),a=M(),i=d=>{d&&e({sortOption:d.id})},l=()=>{r(t({type:gt.OPEN_MENU_CLICKED,menuId:"SORT"}))},c=()=>s.jsxs(h.Fragment,{children:[s.jsxs(cs,{breakpoint:"sm-up",remainInDom:!1,children:[s.jsx(cs,{breakpoint:"lg-up",remainInDom:!1,children:s.jsx(P,{bold:!0,asChild:!0,size:"l",children:s.jsx("h2",{children:a.formatMessage("sort.title")})})}),s.jsx(ngt,{options:n,sortHandler:i,onOpen:l,selectedId:o})]}),s.jsx(Kt,{breakpoint:"sm-up",remainInDom:!1,children:s.jsx(dgt,{options:n,sortHandler:i,selectedId:o,onOpen:l})})]});return n&&n.length>0&&c()},ugt=["sorting.option.favorite","sorting.option.life","sorting.option.name.ascending","sorting.option.name.descending","sorting.option.placeholder","sorting.option.price.ascending","sorting.option.price.descending","sorting.option.price.per.ascending","sorting.option.price.per.descending","sorting.option.customer.rating"],pgt=e=>e!==null&&ugt.includes(e.messageKey);dX.displayName="SortContainer";const mgt=T(ve)`
    display: flex;
    align-items: center;
`,hgt=({filter:e,attribute:t,handleChange:n})=>{const[o,r]=h.useState(()=>e.attributes.some(c=>c.id===t.id&&c.selected));h.useEffect(()=>{r(e.attributes.some(c=>c.id===t.id&&c.selected))},[e]);const{formatMessage:a}=M(),i=()=>t.id==="onOffer"?a("promotions.category.root.name"):t.id==="favoritesOnly"?a("filter.options.label.all.favorites"):t.id==="new"?a("filter.label.new"):"",l=()=>{n(e.id,t.id),r(!o)};return s.jsx(se,{children:s.jsx(mgt,{condensed:!0,"data-test":t.id,children:s.jsx(mo,{input:{onChange:l,checked:o},whiteSpace:"nowrap",bold:!1,className:"salt-m-b--0",labelClassName:"salt-m-b--0",label:i()},`${t.id}${e.id}`)})})},ggt=({filter:e,filterHandler:t})=>{const n=E(Cp),o=(i,l)=>n[i].map(c=>({filterId:i,attributeId:c})).concat({filterId:i,attributeId:l}),r=(i,l)=>n[i].filter(c=>c!==l).map(c=>({filterId:i,attributeId:c})),a=(i,l)=>{let c=[];n[i]?n[i].includes(l)?c=r(i,l):c=o(i,l):c=[{filterId:i,attributeId:l}],t(c,i)};return s.jsx(ie.Fragment,{children:e.attributes.map(i=>s.jsx(hgt,{filter:e,attribute:i,handleChange:a},i.id))})},{RadioIconOff:Egt,RadioIconOn:fgt,RadioText:ygt}=ha,Igt=T(P)`
    overflow: hidden;
`,Sgt=T.strong`
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    align-items: center;
`,Cgt=T(bn)`
    align-items: center;
`,ZN=({bold:e=!1,checked:t=!1,itemProps:n,onClick:o,attribute:r})=>{const{label:a,id:i}=r,{formatMessage:l}=M(),c=l(`filter.customer.rating.attributes.${i}.label`);return s.jsx(Ve.Item,{onClick:o,tabIndex:0,...n,"data-test":r.id,children:s.jsx(ve,{condensed:!0,children:s.jsxs(Cgt,{className:"salt-m-b--0",children:[t&&s.jsx(fgt,{name:"radio_on"}),!t&&s.jsx(Egt,{name:"radio_off"}),s.jsx(Igt,{"data-test":"customer-rating-option",title:c,children:s.jsx(ygt,{asChild:!0,bold:e,children:s.jsxs(Sgt,{className:"salt-d--flex salt-gap--2",children:[s.jsx(CQ,{rating:Number(a),size:24}),c]})})})]})})})};ZN.displayName="CustomerRatingItem";const gI=(e,t)=>e.type==="BRANDS"?t.formatMessage("filter.label.brands"):e.type==="ON_OFFER"?t.formatMessage("promotions.button"):e.type==="FAVORITES"?t.formatMessage("filter.label.favorites"):e.type==="NEW"?t.formatMessage("filter.label.new"):e.type==="CUSTOMER_RATING"?t.formatMessage("filter.label.customer.rating"):e.label,Tgt=T(Ot.Body)`
    min-inline-size: ${H(240)};
    max-inline-size: ${H(340)};
    ${({left:e})=>e&&`inset-inline-start: ${e}px;`}

    /* Override salt-web Dropdown smUp value */
    ${oe.smUp`
        inline-size: ${H(240)};
    `}

    ${oe.lgUp`
        inline-size: 100%;
        inset-inline-start: 0;
        min-inline-size: ${H(240)};
        ${({autoWidthLg:e})=>e&&"inline-size: auto;"};
       ;
    `}
`,HB=(e,t)=>({filterId:e.id,attributeId:t.id}),_gt=({filter:e,isButtonFullWidth:t=!1,filterHandler:n,onOpen:o})=>{const r=M(),a=h.useRef(null),i=e.attributes.find(w=>w.selected),l=gI(e,r),c=r.formatMessage("filter.accessibility.facet",{filterLabel:l}),{getToggleButtonProps:d,getMenuProps:u,getLabelProps:m,getItemProps:g,highlightedIndex:f,selectedItem:y,closeMenu:I,isOpen:S}=Iu({items:e.attributes.map(w=>HB(e,w)),labelId:"customer-rating",menuId:"customer-rating-filter",stateReducer:(w,L)=>{const{type:B,changes:W}=L;switch(B){case Iu.stateChangeTypes.ToggleButtonClick:return W.isOpen?(o(e.id),{...W,highlightedIndex:e.attributes.findIndex($=>$.id===i?.id)||-1,selectedItem:{filterId:e.id,attributeId:i?.id||""}}):W;case Iu.stateChangeTypes.ItemClick:case Iu.stateChangeTypes.ToggleButtonKeyDownEnter:return{...W,highlightedIndex:e.attributes.findIndex(({id:$})=>$===W?.selectedItem?.attributeId),isOpen:!0};case Iu.stateChangeTypes.ToggleButtonBlur:return W.selectedItem?{...W,isOpen:!0,selectedItem:y}:W;default:return W}}}),C=d({"aria-expanded":S,"aria-label":c,"aria-labelledby":void 0,"aria-controls":`filter-facet-${e.id}`,"aria-haspopup":"dialog","aria-activedescendant":void 0,ref:a}),_=()=>{a.current&&a.current.focus()},A=w=>{w.key==="Escape"&&(_(),I())},x=()=>{y&&n([{...y,attributeId:y.attributeId}],y.filterId),_(),I()},R=m({htmlFor:void 0}),O=u(),{ref:N,...k}=O,j=gP(I,[]);return s.jsxs(Ot.Container,{ref:j,"data-test":`filter-facet-${e.id}`,children:[s.jsx(Ot.TriggerDefaultButton,{isOpen:S,text:e.label,fill:t,"data-test":"customer-rating-filter",...R,...C}),s.jsx(Tgt,{isOpen:S,autoWidthLg:!1,"data-test":"filter-facet-dropdown",onKeyDown:A,children:s.jsx(Ot.Content,{children:s.jsxs(Ve,{inline:!1,...k,innerRef:N,children:[e.attributes.map((w,L)=>{const B=y?.attributeId===w.id,W=g({index:L,item:HB(e,w),"aria-selected":B,tabIndex:-1});return s.jsx(ZN,{bold:f===L,checked:B,attribute:w,itemProps:W},w.id)}),s.jsx(b,{intent:"primary",fill:!0,"aria-label":r.formatMessage("filter.accessibility.apply.button"),onClick:x,tabIndex:0,children:s.jsx(b.Text,{children:s.jsx(v,{id:"search.filter.button.apply"})})})]})})})]})},JN=({checked:e,label:t,condensed:n=!0,itemProps:o,onChange:r,...a})=>s.jsx(Ve.Item,{...o,...a,children:s.jsx(ve,{condensed:n,children:s.jsx(mo,{bold:!1,label:t,input:{checked:e,onChange:r},whiteSpace:"nowrap"})})});JN.displayName="FilterListItem";const iv=(e,t)=>({filterId:e.id,attributeId:t.id}),vgt=T(al)`
    position: absolute;
    inset-block-start: calc(var(--salt-spacing-2) * -1);
    inset-inline-end: calc(var(--salt-spacing-2) * -1);
`,Agt=T.div`
    position: relative;
`,bgt=T.div`
    display: flex;
    flex-direction: column;
    max-block-size: ${H(384)};
    block-size: 100%;
`,xgt=T.div`
    flex-shrink: 0;
`,Rgt=T.div`
    flex-grow: 1;
    overflow: auto;
`,Dgt=({onOpen:e,filter:t,filterHandler:n,contrastBackground:o,clearedFilterAttributesHandler:r})=>{const a=M(),i=h.useRef(!1),[l,c]=h.useState(null),d=h.useMemo(()=>t.attributes.filter(x=>x.selected).map(x=>iv(t,x)),[t]),[u,m]=h.useState([]),g=()=>({filterId:t.id,selectedAttributes:u.map(x=>x.attributeId)}),f=()=>{u.length===0&&l&&r&&(r({...l,applyButtonClicked:i.current}),c(null))},y=({selectedItem:x})=>{if(c(null),!x)return;const R=u.findIndex(O=>O.filterId===x.filterId&&O.attributeId===x.attributeId);R>0?m([...u.slice(0,R),...u.slice(R+1)]):m(R===0?[...u.slice(1)]:[...u,x])},I=u.length>0,S=x=>x.id==="onOffer"?a.formatMessage("promotions.category.root.name"):x.id==="favoritesOnly"?a.formatMessage("filter.options.label.all.favorites"):x.id==="new"?a.formatMessage("filter.label.new"):x.label,C=d.length,_=gI(t,a),A=C>0?a.formatMessage("filter.accessibility.facet.with.applied",{filterLabel:_,numberOfAppliedFilters:C}):a.formatMessage("filter.accessibility.facet",{filterLabel:_});return s.jsxs(Agt,{"data-test":`filter-facet-${t.id.toLowerCase()}`,children:[s.jsx(aX,{contrastBackground:o,"data-test":`filter-open-menu-${t.id.toLowerCase()}`,onOpen:()=>{i.current=!1,m(d),e?.(t.id)},onClose:()=>{m(d),f(),i.current=!1},a11y:{label:A},triggerTitle:_,renderContent:({closeDropdown:x})=>s.jsxs(bgt,{"data-test":"filter-facet-dropdown",children:[s.jsx(Ee,{id:"id-filter-facet-dropdown-options-group",children:a.formatMessage("filter.accessibility.facet.list")}),s.jsx(Rgt,{children:t.attributes.map(R=>{const O=!!u.filter(k=>$i(k,iv(t,R))).length,N=S(R);return s.jsx(JN,{label:N,checked:O,onChange:()=>y({selectedItem:iv(t,R)})},`${R.id}${t.id}`)})}),s.jsxs(xgt,{children:[s.jsx(b,{fill:!0,intent:"secondary",className:"salt-m-b--2",onClick:()=>{c(g()),m([])},disabled:!I,"aria-label":a.formatMessage("filter.accessibility.clear.selected.button"),children:s.jsx(b.Text,{children:s.jsx(v,{id:"filter.button.clear.selected"})})}),s.jsx(b,{intent:"primary",fill:!0,"aria-label":a.formatMessage("filter.accessibility.apply.button"),onClick:()=>{i.current=!0,x(),n(u,t.id)},children:s.jsx(b.Text,{children:s.jsx(v,{id:"search.filter.button.apply"})})})]})]})}),C>0&&s.jsx(vgt,{intent:"secondary",count:C})]})},Ogt=({filter:e,filterHandler:t,selectedItems:n})=>{const{formatMessage:o}=M(),r=a=>a.id==="onOffer"?o("promotions.category.root.name"):a.id==="favoritesOnly"?o("filter.options.label.all.favorites"):a.id==="new"?o("filter.label.new"):"";return s.jsx(ie.Fragment,{children:e.attributes.map(a=>{const i=n.some(({attributeId:l})=>l===a.id);return s.jsx(ve,{className:"salt-m-b--2",onClick:l=>{t({filterId:e.id,attributeId:a.id}),l.preventDefault()},children:s.jsx(mo,{bold:!1,label:void 0,whiteSpace:"nowrap",last:!1,input:{checked:i},"aria-selected":i,children:s.jsx(P,{asChild:!0,bold:!0,size:"l",children:s.jsx("h3",{className:"salt-m--0",children:r(a)})})},`${a.id}${e.id}`)},a.id)})})},Pgt=(e,t,n,o)=>{if(e==="onOffer"&&t==="onOffer")return n.formatMessage("promotions.category.root.name");if(e==="favoritesOnly"&&t==="favoritesOnly")return n.formatMessage("filter.options.label.all.favorites");if(e==="new"&&t==="new")return n.formatMessage("filter.label.new");const r=o?.filter(a=>a.id===e).pop();if(r){const a=r.attributes.filter(i=>i.id===t).pop();if(e==="customerRating"&&a)return n.formatMessage(`filter.customer.rating.attributes.${a.id}.label`);if(a)return a.label}return t},Ngt=T(Ve.Item)`
    margin-block-end: 0;
`,Lgt=({filterId:e,attributeLabel:t})=>e==="customerRating"?s.jsxs(se,{gap:["xs"],children:[s.jsx(me,{name:"reviews",height:18,width:18}),t]}):t,eL=({appliedFilterItem:e,onClickHandler:t,filters:n,dataTestId:o})=>{const r=M(),{filterId:a,attributeId:i}=e,l=Pgt(a,i,r,n);return a==="boolean"?null:s.jsx(gD,{minSize:"md",onClick:t,buttonAriaLabel:r.formatMessage("filter.accessibility.clear.single.button",{filterAttribute:l}),as:Ngt,dataTestId:o,children:Lgt({filterId:a,attributeLabel:l})})};eL.displayName="FilterAttribute";const kgt=T.button`
    cursor: pointer;
`,Mgt=T(P)`
    flex-grow: 1;
`,uX=({onClick:e,title:t,numberOfSelectedFilters:n})=>{const r=M().formatMessage("filter.accessibility.facet.with.applied",{filterLabel:t,numberOfAppliedFilters:n});return s.jsx(ve,{asChild:!0,children:s.jsx(kgt,{type:"button",onClick:e,"aria-label":r,children:s.jsxs(se,{align:"center",children:[s.jsx(Mgt,{bold:!0,asChild:!0,size:"l",children:s.jsx("h3",{children:t})}),n>0&&s.jsx(al,{className:"salt-m-r--2",intent:"secondary",count:n}),s.jsx(me,{name:"arrow_right"})]})})})};uX.displayName="FilterFacetCard";const jgt=T(G.Footer)`
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    grid-column-gap: var(--salt-spacing-4);
`,wgt=T(al)`
    position: absolute;
    inset-block-start: calc(var(--salt-spacing-2) * -1);
    inset-inline-end: calc(var(--salt-spacing-2) * -1);
`,Fgt=({appliedFilters:e,allFiltersHandler:t,analyticsEventsHandler:n})=>{const[o,r]=h.useState(!1),[a]=fe(["fbcr"]),[i,l]=h.useState(null),[c,d]=h.useState([]),[u,m]=h.useState(!1),g=E(rg),f=M(),y=h.useMemo(()=>Object.keys(e).reduce((X,re)=>(e[re].forEach(te=>{X.push({attributeId:te,filterId:re})}),X),[]),[e]),[I,S]=h.useState(y);h.useEffect(()=>{S(y)},[y]);const C=X=>{u&&n({type:gt.CLEAR_ALL_FILTERS_BUTTON_CLICKED,payload:{...e,applyButtonClicked:X.toString()}})},_=(X,re)=>{!re&&c.length>0&&i&&n({type:gt.CLEAR_SELECTED_FILTERS_BUTTON_CLICKED,payload:{pageEventAttributes:{[i.id]:c,applyButtonClicked:X.toString()}}})},A=X=>X.id==="onOffer"?f.formatMessage("promotions.category.root.name"):X.id==="favoritesOnly"?f.formatMessage("filter.options.label.all.favorites"):X.id==="new"?f.formatMessage("filter.label.new"):X.label,x=X=>s.jsxs(ie.Fragment,{children:[s.jsx(Ee,{children:f.formatMessage("filter.accessibility.facet.list")}),s.jsx(Ve,{inline:!1,children:X.attributes.map(re=>{const ue=I.some(ce=>ce.attributeId===re.id&&ce.filterId===X.id),te=A(re);return X.type==="CUSTOMER_RATING"&&a?s.jsx(Ve.Item,{onKeyPress:({key:ce})=>{ce==="Enter"&&k(X,re)},children:s.jsx(ZN,{onClick:()=>k(X,re),checked:ue,attribute:re},re.id)},`${re.id}${X.id}`):s.jsx(JN,{label:te,checked:ue,onChange:()=>{const ce=ue?I.filter(de=>de.attributeId!==re.id||de.filterId!==X.id):[...I,{attributeId:re.id,filterId:X.id}];S(ce)},condensed:!1},`${re.id}${X.id}`)})})]}),R=X=>{const{filterId:re,attributeId:ue}=X;return s.jsx(eL,{appliedFilterItem:X,onClickHandler:()=>{const te=I.filter(ce=>ce.attributeId!==ue||ce.filterId!==re);S(te)},filters:g,dataTestId:"applied-filter-tag"},ue)},O=X=>{l(X),n({type:gt.OPEN_MENU_CLICKED,payload:{menuId:X.id}})},N=X=>{const re=I.filter(te=>te.attributeId!==X.attributeId),ue=re.length===I.length?[...re,X]:re;S(ue)},k=(X,re)=>{const te=[...I.filter(ce=>ce.filterId!==X.id),{attributeId:re.id,filterId:X.id}];S(te)},j=()=>{const X=I.some(({filterId:re})=>re!=="boolean");return s.jsxs(h.Fragment,{children:[I.length>0&&X&&s.jsxs("div",{className:"salt-m-b--4",children:[s.jsx(P,{bold:!0,asChild:!0,size:"l",children:s.jsx("h2",{children:s.jsx(v,{id:"bottom.sheet.filter.selected.filters.title"})})}),s.jsx(se,{as:Ve,wrap:"wrap",gap:["sm"],"aria-label":f.formatMessage("filter.accessibility.selected.filters.list"),"data-test":"mobile-selected-filters",children:I.map(R)})]}),g?.length&&s.jsxs(ie.Fragment,{children:[s.jsx(Ee,{children:f.formatMessage("filter.accessibility.facet.list")}),s.jsx(Ve,{inline:!1,children:g.map(re=>{const ue=gI(re,f),te=I.filter(ce=>ce.filterId===re.id).length;return s.jsx(Ve.Item,{children:re.id==="boolean"?s.jsx(Ogt,{filter:re,selectedItems:I,filterHandler:N}):s.jsx(uX,{onClick:()=>O(re),title:ue,numberOfSelectedFilters:te})},re.id)})})]})]})},w=()=>{r(!1),S(y),C(!1),_(!1),l(null),d([])},L=()=>{l(null),_(!1),d([])},B=()=>{if(i){const X=W(i.id);_(!0,X.length>0),l(null)}else C(!0);t(I),r(!1)},W=X=>I.filter(re=>re.filterId===X),$=()=>i?I.reduce((re,ue)=>(ue.filterId===i.id&&re.push(ue.attributeId),re),[]):[],K=y.length,Q=y.length>0?f.formatMessage("filter.accessibility.manage.button.with.applied",{numberOfAppliedFilters:y.length}):f.formatMessage("filter.accessibility.manage.button");return s.jsxs(h.Fragment,{children:[s.jsxs(b,{intent:"secondary",onClick:()=>r(!0),"data-test":"filters-button","aria-label":Q,fill:!0,children:[K>0?s.jsx(wgt,{intent:"secondary",count:K}):null,s.jsx(v,{id:"search.filter.button"})]}),s.jsxs(G,{isOpen:o,onRequestClose:w,closeMessage:f.formatMessage("filter.accessibility.bottom.sheet.close.button"),asBottomSheet:!0,children:[s.jsx(G.Header,{"data-test":"filters-bottom-sheet-header",align:"left",children:s.jsxs(se,{align:"center",children:[i&&s.jsx(b,{onClick:L,intent:"tertiary",fill:!1,"aria-label":f.formatMessage("filter.accessibility.bottom.sheet.back.button"),"data-test":"filters-bottom-sheet-back-button",children:s.jsx(b.Icon,{name:"arrow_left"})}),s.jsx(ne,{as:"h1",children:i?gI(i,f):s.jsx(v,{id:"bottom.sheet.filter.title"})})]})}),s.jsx(G.Body,{"data-test":"filters-bottom-sheet-body",children:i?x(i):j()}),s.jsxs(jgt,{"data-test":"filters-bottom-sheet-footer",children:[i?s.jsx(b,{"aria-label":f.formatMessage("filter.accessibility.clear.selected.button"),intent:"secondary",onClick:()=>{d($()),S(I.filter(X=>X.filterId!==i.id))},fill:!0,disabled:I.filter(X=>X.filterId===i.id).length===0,children:s.jsx(v,{id:"filter.button.clear.selected"})}):s.jsx(b,{"aria-label":f.formatMessage("filter.accessibility.clear.all.button"),intent:"secondary",onClick:()=>{S([]),m(!0)},disabled:I.length===0,children:s.jsx(v,{id:"bottom.sheet.filter.button.clear.all"})}),s.jsx(b,{"aria-label":f.formatMessage("filter.accessibility.mobile.apply.button"),intent:"primary",onClick:B,children:s.jsx(v,{id:"search.filter.button.apply"})})]})]})]})},pX=({changeQuerystringLocation:e})=>{const t=E(rg),n=E(Cp),o=(i,l)=>l.map(c=>s.jsx(eL,{appliedFilterItem:{filterId:i,attributeId:c},onClickHandler:()=>r(i,c),filters:t,dataTestId:"applied-filter-tag"},c)),r=(i,l)=>{const c=a(i,l);e({filters:c})},a=(i,l)=>Object.keys(n).reduce((c,d)=>{if(d!==i)return{...c,[d]:n[d]};const u=n[d].filter(m=>m!==l);return u.length?{...c,[d]:u}:c},{});return Object.keys(n).length>0?s.jsx(se,{as:Ve,align:"center",basis:"100%",wrap:"wrap",gap:["sm"],margin:[null],children:Object.keys(n).map(i=>o(i,n[i]))}):null},mX=({changeQuerystringLocation:e,sendAnalyticsEvent:t=U.analyticsEvent,isRenderClearAllButton:n=!1})=>{const o=E(rg),r=E(Cp),[a]=fe(["fbcr"]),i=F(),l=M(),c=({type:I,payload:S})=>{i(t({type:I,...S}))},d=()=>{i(U.analyticsEvent({type:gt.CLEAR_ALL_FILTERS_BUTTON_CLICKED,...r,applyButtonClicked:"true"}))},u=({menuId:I})=>{c({type:gt.OPEN_MENU_CLICKED,payload:{menuId:I}})},m=({filterId:I,selectedAttributes:S,applyButtonClicked:C})=>{c({type:gt.CLEAR_SELECTED_FILTERS_BUTTON_CLICKED,payload:{pageEventAttributes:{[I]:S,applyButtonClicked:C.toString()}}})},g=I=>{const S=I.filter(C=>C).reduce((C,_)=>(C[_.filterId]||(C[_.filterId]=[]),C[_.filterId].includes(_.attributeId)||C[_.filterId].push(_.attributeId),C),{});e({filters:S})},f=(I,S)=>{const C={};I.length>0&&(C[S]=I.map(_=>_.attributeId)),o?.forEach(_=>{if(_.id!==S){const A=_.attributes.filter(x=>x.selected).map(x=>x.id);A.length>0&&(C[_.id]=A)}}),e({filters:C})},y=()=>s.jsxs(h.Fragment,{children:[s.jsxs(cs,{breakpoint:"sm-up",remainInDom:!1,children:[s.jsx(cs,{breakpoint:"lg-up",remainInDom:!1,children:s.jsxs(h.Fragment,{children:[s.jsxs(se,{justify:"space-between",align:"center",children:[s.jsx(P,{className:n?"":"salt-m-t--4",asChild:!0,size:"l",bold:!0,children:s.jsx("h2",{children:l.formatMessage("filter.title")})}),n&&s.jsx(b,{className:"salt-m-l--4",intent:"tertiary",fill:!1,"data-test":"clear-filters-button",onClick:()=>{e({filters:[]}),d()},"aria-label":l.formatMessage("filter.accessibility.clear.all.button"),children:s.jsx(b.Text,{children:s.jsx(v,{id:"filter.button.clear.all"})})})]}),n&&s.jsx(pX,{changeQuerystringLocation:e})]})}),o.map(I=>I.type==="BOOLEAN"?s.jsx(ggt,{filter:I,filterHandler:f}):I.type==="CUSTOMER_RATING"&&a?s.jsx(_gt,{filter:I,filterHandler:f,onOpen:S=>u({menuId:S}),isButtonFullWidth:!0},I.id):s.jsx(Dgt,{filter:I,filterHandler:f,onOpen:S=>u({menuId:S}),clearedFilterAttributesHandler:S=>m({...S})},I.id))]}),s.jsx(Kt,{breakpoint:"sm-up",remainInDom:!1,children:s.jsx(Fgt,{appliedFilters:r,allFiltersHandler:g,analyticsEventsHandler:c})})]});return s.jsx(h.Fragment,{children:o&&o.length>0&&y()})};mX.displayName="FiltersContainer";const Bgt=D("bt.top"),Ugt=({additionalNavigableContentFactory:e,categories:t,buildUrl:n,children:o,showRefineSortFilters:r,refine:a,showCategoryRefineGroupOnly:i,categoryRootLinks:l,changeQuerystringLocation:c,selectedSortOptionId:d,showSortAndFilters:u})=>{const{currentBreakpoint:m}=h.useContext(Pn),g=E(Cp),f=Ke[m||""]||0,y=f>Ke.xs&&f<Ke.lg,I=M(),S=F(),C=E(Bgt),_=()=>l||t&&t.length>0,A=()=>{S(U.analyticsEvent({type:gt.CLEAR_ALL_FILTERS_BUTTON_CLICKED,...g,applyButtonClicked:"true"}))},x=()=>s.jsx(tgt,{categoryRootLinks:l,categories:t,buildUrl:n,onOpen:a.onOpen,messageKey:"search.categories.aisles.button"}),R=()=>s.jsx(Kt,{breakpoint:"lg-up",display:"inline",remainInDom:!1,children:s.jsx($m.Bar,{children:s.jsx($m,{children:s.jsx("div",{className:"salt-m--1",children:x()})})})}),O=()=>s.jsx(b,{className:"salt-m-l--4",intent:"tertiary",fill:!1,onClick:()=>{c({filters:[]}),A()},"aria-label":I.formatMessage("filter.accessibility.clear.all.button"),children:s.jsx(b.Text,{children:s.jsx(v,{id:"filter.button.clear.all"})})}),N=n({filters:{},sortOption:d}),j=Object.keys(g).some($=>$!=="boolean"),w=C?"salt-m-b--2":"",W=[u||t&&t.length>0?"salt-m-x--2 lg:salt-m-l--0":"salt-m-x--2",w].filter(Boolean).join(" ");return s.jsxs(Y,{flush:!0,children:[(r||t&&t.length>0)&&s.jsxs(Y.Item,{colSpan:{xs:12,lg:2},children:[i&&_()&&R(),r&&s.jsxs($m,{children:[e?.()&&s.jsx("div",{className:`salt-m-b--2 sm:salt-m-b--4 ${u?"lg:salt-m--8":""}`,children:e()}),y&&u&&s.jsxs(ie.Fragment,{children:[s.jsx(P,{className:`${j&&"salt-d--inline"} salt-m-y--2 salt-m-x--2`,bold:!0,asChild:!0,size:"l",children:s.jsx("h2",{children:I.formatMessage("tablet.filter.title")})}),j&&O()]}),s.jsxs(se,{wrap:"nowrap",wrapSmUp:"wrap",gap:["sm"],margin:["xs","sm"],marginSmUp:["xs","sm"],marginLgUp:[null,null,null,"sm"],directionLgUp:"column",gapLgUp:["md"],additionalCssLgUp:`
                                            > * {
                                                width: 100%;
                                            }
                                        `,children:[u&&s.jsxs(h.Fragment,{children:[y&&j&&s.jsx(pX,{changeQuerystringLocation:c}),s.jsx(dX,{changeQuerystringLocation:c}),s.jsx(mX,{changeQuerystringLocation:c,clearFiltersUrl:N,isRenderClearAllButton:j})]}),_()&&s.jsx(Kt,{breakpoint:"lg-up",remainInDom:!1,children:x()})]})]}),_()&&s.jsxs(cs,{breakpoint:"lg-up",children:[s.jsx(rX,{flushTop:!r||!u,children:s.jsx(v,{id:"navigation.categories.title"})}),s.jsx(sgt,{categoryRootLinks:l,categories:t,buildUrl:n,className:"salt-m-t--0 salt-m-r--2 salt-m-b--2 salt-m-l--2"})]})]}),s.jsx(Y.Item,{colSpan:{xs:12,lg:r||t&&t.length>0?10:12},children:s.jsx("div",{className:W,children:o})})]})},Ggt=(e,t,n,o)=>vi(e.retailerProductId,Gp(e.name,{isSEOReadableURLEnabled:n}),{basePath:t+(o||""),queryString:""}),$gt=({products:e,seoReadableLinks:t})=>{const n=E(i=>qe(i,"structured-data-home-url")),o=E(Wt);if(!n||e.length===0)return null;const a={"@context":"https://schema.org","@type":"ItemList",itemListElement:e.map((i,l)=>({"@type":"ListItem",position:l,url:Ggt(i,n,t,o)}))};return s.jsx(_o,{children:s.jsx("script",{"data-test":"product-listing-structured-data",type:"application/ld+json",children:JSON.stringify(a)})})},Hgt=({breadcrumbs:e})=>{const t=E(a=>qe(a,"structured-data-home-url")),n=E(Wt);if(!t||e.length===0)return null;const r={"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:e.map((a,i)=>({"@type":"ListItem",position:i,item:{"@id":Yle(t)+(n||"")+a.url,name:a.name}}))};return s.jsx(_o,{children:s.jsx("script",{"data-test":"breadcrumbs-structured-data",type:"application/ld+json",children:JSON.stringify(r)})})},Vgt=D("seo.ra"),Ygt=D("seo.rdbl"),Wgt=D("dso"),qgt=D("cfop"),Kgt=D("new.prl"),zgt=D("sss"),Qgt=T(Pe.Typography)`
    display: block;
    inline-size: 50%;
    min-block-size: 21px;

    ${oe.smUp`
        min-height: 26px;
        `};

    ${oe.lgUp`
            min-height: 30px;
        `};
`;class Xgt extends h.Component{static getDerivedStateFromProps(t,n){const o=tt.parse(t.location.search),r=t.matchSublocationId?t.matchSublocationId(o):o.sublocationId;return{...n,category:r,fullURLPath:t.breadcrumbFullURLPath,isNoIndexPage:!!o.q,pageKey:r||o.q}}fopContainerElementRef;constructor(t){super(t),this.buildUrl=this.buildUrl.bind(this),this.getPageResults=this.getPageResults.bind(this),this.handleFopVisibiltyChange=this.handleFopVisibiltyChange.bind(this),this.getCategoryRootLinks=this.getCategoryRootLinks.bind(this),this.changeQuerystringLocation=this.changeQuerystringLocation.bind(this),this.fopContainerElementRef=h.createRef(),this.handleFetchNextPage=this.handleFetchNextPage.bind(this),this.sendSelectCategoryEvent=this.sendSelectCategoryEvent.bind(this),this.state={category:void 0,fullURLPath:""}}componentDidMount(){const{catalogueLastUpdated:t,isServerRendered:n,lastFetchedCatalogueLocation:o,actions:r,location:a,breadcrumb:i,retailerCategoryId:l}=this.props,c=a.state&&a.state.fromSlotBooking;n?(t?(this.sendActiveAttributesIfCataloguePage(),this.sendShowCategoryPageEvent(i,l),r.setLastFetchedLocation(this.locationAsString())):this.getPageResults(),this.sendServerRenderedSortAndFilterEvents()):this.locationAsString()===o&&!c?(this.sendActiveAttributesIfCataloguePage(),this.sendShowCategoryPageEvent(i,l)):this.getPageResults()}shouldComponentUpdate(t,n){return!!(t.productsByProductId!==this.props.productsByProductId||t.products!==this.props.products||t.totalProducts!==this.props.totalProducts||this.isPageDifferent(t,n)||t.pageViewId!==this.props.pageViewId||t.shouldShowScrollToTopButton!==this.props.shouldShowScrollToTopButton||this.props.page==="regulars"&&t.productGroups!==this.props.productGroups||!Lu(this.props.withinGridProductCards,t.withinGridProductCards))}componentDidUpdate(t,n){const{filtersFromQueryString:o,products:r,page:a,catalogueLastUpdated:i,selectedSortOptionId:l,actions:c,pageViewId:d,location:u}=this.props,m=a==="search"||a==="categories";t.catalogueLastUpdated!==i&&this.sendActiveAttributesIfCataloguePage(),this.isPageDifferent(t,n)?this.getPageResults().then(()=>{if(m){const f=tt.parse(u.search),y=tt.parse(t.location.search);if(f.sortBy!==y.sortBy){c.sendAnalyticsEvent({type:gt.APPLY_SORT_EVENT,sortOptionId:l,pageType:a});const I={event:"apply_sort",sort:l,type:a};J.sendEvent({GA:I,WA:null})}Lu(t.filtersFromQueryString,o)||this.sendApplyFilterEvent(a,o,r)}}):t.pageViewId!==d&&this.sendActiveAttributesIfCataloguePage()}sendServerRenderedSortAndFilterEvents(){const{filtersFromQueryString:t,products:n,page:o,selectedSortOptionId:r,actions:a}=this.props;if(o==="search"||o==="categories"){if(r){a.sendAnalyticsEvent({type:gt.APPLY_SORT_EVENT,sortOptionId:r,pageType:o});const i={event:"apply_sort",sort:r,type:o};J.sendEvent({GA:i,WA:null})}this.sendApplyFilterEvent(o,t,n)}}sendViewCategoryPageViewEvent(t){const{actions:n}=this.props;if(t.length){const o=t.at(-1),r=t.reduce((i,l,c)=>c<5?(i[`category${c+1}`]=l.name,i):i.categoryMore?(i.categoryMore=`${i.categoryMore}/${l.name}`,i):(i.categoryMore=l.name,i),{category1:null,category2:null,category3:null,category4:null,category5:null,categoryMore:null});n.sendAnalyticsEvent({type:tn.VIEW_CATEGORY_PAGE_VIEW,categoryName:o?.name,retailerCategoryId:o?.retailerCategoryId,...r});const a={event:"view_category",id:o?.retailerCategoryId,name:o?.name,category1:r.category1,category2:r.category2,category3:r.category3,category4:r.category4,category5:r.category5,category_more:r.categoryMore};J.sendEvent({GA:a,WA:null})}}getPageResults(t=0){const{isDefaultSortOrderEnabled:n,fetchPage:o,location:r,navigationType:a,searchQuery:i,selectedSortOptionId:l,actions:c,filtersFromQueryString:d,sortOptions:u}=this.props,m=tt.parse(r.search);if(r.state?.isPrefetched&&a!=="POP")return Promise.resolve();const g=u&&u.find(f=>f.selected);return a==="POP"&&m.q===i?.searchTerm&&(m.sortBy===g?.id||m.sortBy===void 0&&(g?.id==="favorite"||g?.id==="relevance"))&&$i(d,this.getNonEmptyAppliedFilters())?Promise.resolve():o({offset:t,category:this.state.category,filters:fp(m),sortOption:n?m.sortBy:l})?.then(f=>{if(f){const{breadcrumbs:y,retailerCategoryId:I}=f;c.setLastFetchedLocation(this.locationAsString()),this.sendShowCategoryPageEvent(y,I)}return f})}isPageDifferent(t,n){return t.location.search!==this.props.location.search||n.category!==this.state.category}getAppliedFilters(){return this.props.filters.reduce((t,n)=>({...t,[n.id]:n.attributes.filter(o=>o.selected).map(o=>o.id)}),{})}sendApplyFilterEvent(t,n,o){const r=o.length===0,a=Object.keys(n).length===0;let i="";if(n&&Object.entries(n).forEach(([l,c])=>{i+=`${l}=${c?.toString()};`}),this.props.actions.sendAnalyticsEvent({type:r&&!a?gt.FILTER_NO_RESULT:gt.APPLY_FILTER_EVENT,pageType:t,filters:i||null}),r&&!a){const l={event:"filter_no_results",filters:i,type:t};J.sendEvent({GA:l,WA:null})}else{const l={event:"apply_filter",filters:i,type:t};J.sendEvent({GA:l,WA:null})}}getNonEmptyAppliedFilters(){const t=Object.entries(this.getAppliedFilters()).filter(n=>n[1].length>=1);return Object.fromEntries(t)}sendShowCategoryPageEvent(t,n){const{actions:o}=this.props;if(t&&t.length){const r=t.map(i=>i.name).join("/");o.sendAnalyticsEvent({type:gt.SHOW_CATEGORY_PAGE_EVENT,retailerId:n,categoryName:r});const a={event:"event",eventAction:"ShowCategory",eventCategory:"Catalogue",categoryName:r,eventLabel:n};J.sendEvent({GA:a,WA:null}),this.sendViewCategoryPageViewEvent(t)}}sendActiveAttributesIfCataloguePage(){const{actions:t,breadcrumb:n,selectedSortOptionId:o,totalProducts:r,pageError:a}=this.props,i=(n||[]).map(u=>u.id),l=i[i.length-1],c=this.getNonEmptyAppliedFilters(),d={TOTAL_PRODUCTS:r.toString(),SORT:o,BREADCRUMBS:i,PAGE_LOAD_ERROR:!!a,...c};l&&(d.CATEGORY=l),t.sendAnalyticsEvent({type:gt.CATALOGUE_ATTRIBUTES,attributes:d})}changeQuerystringLocation(t){return this.props.navigate(this.buildUrl(t))}locationAsString(){const{location:t}=this.props;return`${t.pathname}${t.search}`}getCategoryId(t,n){const{enableRegionAgnosticCategoriesPerSection:o,isRegionAgnosticEnabled:r}=this.props;return o&&r?n||t||this.state.category:t??this.state.category}buildUrl(t){const{category:n,filters:o,fullURLPath:r,sortOption:a,retailerCategoryId:i}=t,l=r??(this.state.fullURLPath||"");return this.props.getTargetUrl({category:this.getCategoryId(n,i),filters:o??this.props.filtersFromQueryString,fullURLPath:l?.toLowerCase(),...a!==null&&{sortOption:a??this.props.selectedSortOptionId}})}buildBreadcrumbLinks(){const{rootBreadcrumb:t,isDefaultSortOrderEnabled:n}=this.props,o=[];return t&&o.push(t),o.push(...this.props.breadcrumb.map(r=>({id:r.id,name:r.name,retailerCategoryId:r.retailerCategoryId,url:this.buildUrl({category:r.id,fullURLPath:r.fullURLPath,sortOption:n?null:this.props.selectedSortOptionId,retailerCategoryId:r.retailerCategoryId})}))),o}hasNoProducts(){return!this.props.products.length&&this.props.catalogueLastUpdated&&this.props.totalProducts===0}getCategoryRootLinks(){const{category:t}=this.state;return t&&this.props.categoryRootLinks?this.props.categoryRootLinks:void 0}shouldShowRefineSortAndFilters(){const{showCategoryRefineGroupOnly:t,hideFilterBar:n,filtersFromQueryString:o,products:r}=this.props,a=!!Object.keys(o).length;return!t&&!n&&(a||!!r.length)}shouldCataloguePageShowFetching(){return!this.props.isServerRendered&&(this.props.isCatalogueFetching||this.willCatalogueDataReFetchAfterUpdate())}willCatalogueDataReFetchAfterUpdate(){const{location:t}=this.props;return!t.state?.isPrefetched&&this.locationAsString()!==this.props.lastFetchedCatalogueLocation}renderScrollToTopButton(){return s.jsx(eX,{className:"salt-m-y--4",focusElement:"#main-header-logo"})}handleFopVisibiltyChange(t){const{products:n,nextPageToken:o,totalProducts:r,handleFopVisibiltyChange:a}=this.props;a?.({fops:t,category:this.state.category,nextPageToken:o,totalProductsDecorated:n.length,totalProducts:r})}handleFetchNextPage(){const{fetchNextPage:t}=this.props;return t?t({category:this.state.category,nextPageToken:this.props.nextPageToken}):Promise.resolve()}renderProductsPage(){const{breadcrumb:t,rootBreadcrumb:n,fopControlsFactory:o,additionalNavigableContentFactory:r,hideBreadcrumb:a,page:i,withoutHeader:l}=this.props,c=n?[n,...t]:[...t],d=c.length>0?c.map(m=>m.name).join(" > "):null,u=a&&!(i==="logged-in-homepage"||i==="logged-out-homepage");return s.jsxs("div",{"data-test":"products-page",id:"product-page",...u?{className:"salt-m-t--4"}:{},children:[s.jsx($gt,{products:this.props.products,seoReadableLinks:this.props.isSEOReadableURLEnabled}),s.jsx(mI,{page:this.props.page,pageKey:this.state.pageKey,sizes:["SMALL","MEDIUM"]}),s.jsxs(Ugt,{additionalNavigableContentFactory:r,categoryRootLinks:this.getCategoryRootLinks(),showCategoryRefineGroupOnly:this.props.showCategoryRefineGroupOnly,categories:this.props.categories,buildUrl:this.buildUrl,showRefineSortFilters:this.shouldShowRefineSortAndFilters(),refine:{onOpen:()=>{this.props.actions.sendAnalyticsEvent({type:gt.OPEN_MENU,menu:"REFINE"})}},changeQuerystringLocation:this.changeQuerystringLocation,selectedSortOptionId:this.props.selectedSortOptionId,showSortAndFilters:this.props.showSortAndFilters,children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:s.jsx(v,{id:"catalogue.products.heading"})})}),s.jsx(mI,{page:this.props.page,pageKey:this.state.pageKey,sizes:["LARGE"]}),this.props.page==="regulars"&&s.jsx(iht,{page:this.props.page,onInitialFopLoad:this.props.onInitialFopLoad,rankingScoreByProductId:this.props.rankingScoreByProductId}),this.props.isNewProductListEnabled&&this.props.isConfigurableFopEnabled?s.jsx(Nht,{productGroups:this.props.productGroups,productsByProductId:this.props.productsByProductId,page:this.props.page,type:"catalogue",isFetching:this.shouldCataloguePageShowFetching(),productCardAdvertsToInsert:this.props.withinGridProductCards,loadMoreProducts:this.props.fetchNextPage&&this.handleFetchNextPage,hasMoreProducts:!!this.props.nextPageToken,onInitialProductsRendered:this.props.onInitialFopLoad,withoutHeader:l}):s.jsxs(h.Fragment,{children:[s.jsx(Xp,{hideTopBorder:!this.props.hideFilterBar,productGroups:this.props.productGroups,productsByProductId:this.props.productsByProductId,page:this.props.page,type:"catalogue",isFetching:this.shouldCataloguePageShowFetching(),isNextPageFetching:this.props.isNextCataloguePageFetching,onInitialFopLoad:this.props.onInitialFopLoad,renderInitial:()=>s.jsx(eb,{page:this.props.page}),rankingScoreByProductId:this.props.rankingScoreByProductId,breadcrumbValue:d,onFopVisibilityChange:this.props.handleFopVisibiltyChange&&this.handleFopVisibiltyChange,fopControlsFactory:o,hideMoreOptions:!this.props.isUserLoggedIn,withinGridProductCards:this.props.withinGridProductCards,infiniteScrollScrollableElementRef:this.fopContainerElementRef,withoutHeader:l}),i==="categories"?s.jsx(tX,{}):null]}),this.props.shouldShowScrollToTopButton&&this.renderScrollToTopButton()]})]})}renderPages(){return this.hasNoProducts()&&!this.shouldCataloguePageShowFetching()?Object.keys(this.props.filtersFromQueryString).length?this.props.noProductsFilteredPage?.({term:this.props.breadcrumb[0]&&this.props.breadcrumb[0].name,clearFilters:()=>this.changeQuerystringLocation({filters:{}})}):this.props.noProductsPage?.({term:this.props.breadcrumb[0]&&this.props.breadcrumb[0].name}):this.renderProductsPage()}isCategoryBreadcrumbInURLCorrect(){const{location:t,breadcrumbFullURLPath:n}=this.props;return Zo(n).toLowerCase()===t.pathname.toLowerCase()}sendSelectCategoryEvent(t){const{sendAnalyticsEvent:n}=this.props.actions;if(t.retailerCategoryId){n({type:tn.SELECT_CATEGORY_GA4_EVENT,location:"breadcrumb",categoryName:t.name,retailerCategoryId:t.retailerCategoryId});const o={event:"select_category",id:t.retailerCategoryId,location:"breadcrumb",name:t.name?.toString()||""};J.sendEvent({GA:o,WA:null})}}render(){const{pageError:t,isSEOReadableURLEnabled:n,breadcrumbFullURLPath:o,location:r,page:a,categoryId:i,smartSearchSuggestionsFFEnabled:l}=this.props,{isNoIndexPage:c}=this.state;if(!this.props.isCatalogueFetching){if(t)return t.statusCode===ai.NOT_FOUND?s.jsx(lt,{}):s.jsx(ur,{showRefreshLink:!0,statusCode:t.statusCode});const u=tt.parse(r.search);if(n&&a==="categories"&&u.sublocationId===i&&!this.isCategoryBreadcrumbInURLCorrect()){const m=o?.toLowerCase(),g=Zo(m,{queryString:r.search.replace("?","")});return s.jsx(Qn,{to:g})}}const d=l&&a==="search";return s.jsxs(h.Fragment,{children:[c&&s.jsx(_o,{children:s.jsx("meta",{name:"robots",content:"noindex"})}),!this.props.hideBreadcrumb&&s.jsx(An,{id:"products-page-breadcrumb",children:this.shouldCataloguePageShowFetching()?s.jsx(Qgt,{}):s.jsxs(ie.Fragment,{children:[s.jsx(Hgt,{breadcrumbs:this.buildBreadcrumbLinks()}),s.jsx(VR,{className:`${this.props.breadcrumbSubtitle?"salt-m-b--2":""} ${this.props.breadcrumbSubtitle?"lg:salt-m-b--2":"lg:salt-m-b--1"}`,preface:this.props.breadcrumbPreface,trail:this.buildBreadcrumbLinks(),linkElement:Qe,onClick:this.sendSelectCategoryEvent,"data-test":"products-page-breadcrumb-list"}),s.jsx("div",{"aria-live":"polite","aria-busy":this.props.isCatalogueFetching,children:this.props.breadcrumbSubtitle&&s.jsx("div",{className:"salt-m-b--1","aria-atomic":"true",children:this.props.breadcrumbSubtitle})})]})}),!this.props.hideGtmTarget&&s.jsx(Bd,{targetName:Ul.LWCD}),d&&s.jsx(Wht,{},tt.parse(r.search).q?.toString()),this.props.belowBreadcrumbContentFactory&&this.props.belowBreadcrumbContentFactory(),this.renderPages()]})}}const Zgt=(e,t)=>{const n=t.page==="regulars";return{breadcrumb:_d(e),categories:t.categories?t.categories:Hde(e),filters:rg(e),sortOptions:Rx(e),filtersFromQueryString:Cp(e),isCatalogueFetching:Y1(e),categoryId:Gde(e),retailerCategoryId:$de(e),catalogueLastUpdated:W1(e),breadcrumbFullURLPath:xx(e),products:Ude(e),productsByProductId:n?Vze(e):ir(e),productGroups:n?Yze(e):V1(e),selectedSortOptionId:Px(e),totalProducts:Dx(e),lastFetchedCatalogueLocation:Ox(e),isServerRendered:Yt(e),pageViewId:On(e),rankingScoreByProductId:K1(e),isSEOReadableURLEnabled:Ygt(e),nextPageToken:Yde(e),isNextCataloguePageFetching:og(e),isDefaultSortOrderEnabled:Wgt(e),smartSearchSuggestionsFFEnabled:zgt(e),isConfigurableFopEnabled:qgt(e),isNewProductListEnabled:Kgt(e),isUserLoggedIn:Ze(e),isRegionAgnosticEnabled:Vgt(e),searchQuery:Sp(e)}},Jgt=e=>({actions:Ki({sendAnalyticsEvent:U.analyticsEvent,setLastFetchedLocation:ft.setLastFetchedCatalogueLocation},e)}),CT=Ct(Bt,ke(Zgt,Jgt))(Xgt),TT=({clearFilters:e,page:t,term:n})=>{const o=ts(),r=E(Cp);h.useEffect(()=>{o({type:gt.NO_FILTERED_RESULTS_RETURNED,filtersFromQueryString:r,term:n});const i={event:"event",eventAction:"NoFilteredResults",eventCategory:"Catalogue",eventLabel:n};J.sendEvent({GA:i,WA:null})},[]);const a=()=>{o({type:gt.NO_FILTERED_RESULTS_RETURNED_CLEAR_FILTERS_BUTTON_CLICKED,filtersFromQueryString:r,term:n});const i={event:"event",eventAction:"NoFilteredResultsClearFiltersClicked",eventCategory:"Catalogue",eventLabel:n};J.sendEvent({GA:i,WA:null}),e()};return s.jsxs(h.Fragment,{children:[s.jsx(mI,{page:t,pageKey:n,sizes:["LARGE","MEDIUM","SMALL"],isNoProductsPage:!0}),s.jsx("div",{className:"salt-m-y--16",children:s.jsx(Y,{children:s.jsx(Y.Item,{colSpan:{xs:10,sm:8,md:6,lg:4},colStart:{xs:2,sm:3,md:4,lg:5},children:s.jsx(ln,{titleIcon:"info_default",title:"catalogue.no.results.filtered.title",titleAs:"h2",primaryButton:{text:"catalogue.no.results.filtered.clear.filters",onClick:a}})})})})]})},nE=()=>{const[e,t]=h.useState(!1),n=h.useCallback(()=>{const o=window.innerHeight*3,r=window.innerHeight,a=window.scrollY;a>o&&!e?t(!0):a<r&&e&&t(!1)},[e]);return h.useEffect(()=>(n(),document.addEventListener("scroll",n),()=>{document.removeEventListener("scroll",n)}),[n]),e},eEt=T(b)`
    ${e=>e.isFixedAboveFooter?De`
                  position: absolute;
                  inset-block-start: calc(${e.buttonOffsetTop}px + var(--salt-spacing-2));
                  inset-inline-end: var(--salt-spacing-4);
                  box-shadow: var(--salt-elevation-shadow-3);
                  z-index: 0;
              `:De`
                  position: fixed;
                  inset-inline-end: var(--salt-spacing-4);
                  inset-block-end: calc(var(--salt-spacing-4) + ${e.popUpBannerHeight}px);
                  box-shadow: var(--salt-elevation-shadow-3);
                  z-index: 10;
              `}

    ${e=>!e.visible&&De`
            opacity: 0;
            pointer-events: none;
            visibility: hidden;
        `}
`,_T=()=>{const{formatMessage:e}=M(),t=ps({breakpoint:"sm-up"}),n=ps({breakpoint:"md-up"}),[o,r]=h.useState(!1),[a,i]=h.useState(0),[l,c]=h.useState(0),d=nE(),u=ts();h.useEffect(()=>{if(!(t||n))return c(0),()=>{};const f=document.querySelector('[data-test="pop-up-banner"], #StickyBopButton');if(!f)return c(0),()=>{};const y=new ResizeObserver(I=>{for(const S of I)c(S.contentRect.height)});return y.observe(f),()=>{y.disconnect()}},[t,n]),h.useEffect(()=>{const f=document.querySelector("main");if(!f)return()=>{};const y=()=>{const I=f.offsetTop+f.offsetHeight;window.scrollY+window.innerHeight>=I?(r(!0),i(I)):(r(!1),i(0))};return window.addEventListener("scroll",y),window.addEventListener("resize",y),()=>{window.removeEventListener("scroll",y),window.removeEventListener("resize",y)}},[]);const m=()=>{u({type:gt.BACK_TO_TOP_BUTTON_CLICKED})},g=()=>{typeof window<"u"&&(window.scrollTo({top:0,behavior:"smooth"}),m())};return s.jsx(eEt,{"data-test":"scroll-to-top-button",onClick:g,className:"scroll-to-top",isFixedAboveFooter:o,buttonOffsetTop:a,isMobile:t,isTablet:n,popUpBannerHeight:l||0,visible:d,intent:"tertiary-contrast",fill:!1,"aria-hidden":d,"aria-label":e("accessibility.backToTop.button"),children:s.jsx(b.Icon,{name:"arrow_up"})})},tEt=()=>s.jsx(Y,{fixed:!0,className:"salt-m-y--16",children:s.jsx(Y.Item,{colStart:{xs:2,sm:3,md:4,lg:5},colSpan:{xs:10,sm:8,md:6,lg:4},children:s.jsx(ln,{titleIcon:"favourites",title:"favorites.no.results.title",titleAs:"h2",description:"favorites.no.results.text",gtmTargetNameKey:"AWCV",primaryButton:{text:"favorites.no.results.open.navigation",to:"/products"}})})}),VB=({category:e=void 0,sortOption:t=void 0,filters:n={}}={})=>`/favorites?${ES({category:e,filters:n,sortOption:t})}`,sEt=D("bt.top"),nEt=()=>{const e=M(),t=Ne(),n=We(),o=F(),r=E(Ip),i=E(q1)===0,l=E(sEt),c=nE(),d=()=>i?void 0:{name:e.formatMessage({id:"favorites.title"}),url:VB()},u=E(og),m=({category:y,filters:I,sortOption:S})=>(o(X7()),o(JA({category:y,filters:I,sortOption:S}))),g=({category:y,nextPageToken:I})=>o(JA({category:y,pageToken:I})).then(S=>{!u&&S&&S.nextPageToken&&S.productCount===0&&g({category:y,nextPageToken:S.nextPageToken})}),f=h.useCallback(()=>{o(ks({name:wTe}))},[o]);return s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"favorites.title"}),s.jsx(Ee,{asChild:!0,children:s.jsx("h1",{children:e.formatMessage({id:"favorites.title"})})}),s.jsx(CT,{pageError:r,navigate:n,fetchPage:m,page:"favorites",rootBreadcrumb:d(),hideBreadcrumb:i,getTargetUrl:VB,location:t,onInitialFopLoad:f,noProductsPage:()=>s.jsx(tEt,{}),noProductsFilteredPage:({clearFilters:y,term:I})=>s.jsx(TT,{clearFilters:y,page:"favorites",term:I}),showSortAndFilters:!0,fetchNextPage:g,shouldShowScrollToTopButton:l?!1:c}),l&&s.jsx(_T,{})]})},hX=()=>s.jsx(os,{type:"Favorites::route",children:s.jsx(Zmt,{activeTab:Oi.FAVORITES,children:s.jsx(nEt,{})})});hX.fetchData=async({context:{store:e,url:t}})=>{const n=t.searchParams.get("sublocationId")??"",o=t.searchParams.get("sortBy")??"",r=Wt(e.getState()),a=fp(us.parse(t.search)),i=JA({category:n,filters:a,sortOption:o}),l=`${t.pathname}${t.search}`,c=r?.length?l.replace(r,""):l;await Promise.all([e.dispatch(i),e.dispatch(ft.setLastFetchedCatalogueLocation(c)),e.dispatch(X7())])};const oEt={PROMOTIONS:{path:lc(),titleKey:"promotions.tab"},COUPONS:{path:iT(),titleKey:"coupons.tab"}},rEt=({tabs:e=oEt,activeTabType:t,onTabClick:n})=>{const o=M();return s.jsx(xa,{highlightedId:t,className:"salt-m-t--8 salt-m-b--2",children:Object.entries(e).map(([r,a])=>{const i=r===t;return s.jsx(xa.Link,{id:r,to:i?void 0:aEt(a.path),onClick:()=>n&&n(r),children:o.formatMessage(a.titleKey)},r)})})},aEt=e=>({...nn(e),search:"?source=tabs"}),iEt=ee("GET_PROMOTIONS_PAGE_ADVERTS"),gX=()=>({type:"API",payload:{url:"/v1/content?page=PROMOTIONS",...iEt}}),lEt=e=>{const t=Array.from(new Array(10),(o,r)=>r.toString()),n=EX({productIds:t,title:"",productType:e});return{products:t,group:n}},MZt={landscape:{promotion:{compress:!1}}},YB=(e,t,n)=>e.map(o=>({productId:o,group:t,customAnalyticsData:n})),EX=({productIds:e,title:t,productType:n,campaignName:o,campaignId:r,groupTitle:a})=>({name:t,section:n,type:n,products:e,viewportConfig:{lg:1,md:2,sm:3,xs:4},clusterBreadcrumbs:[],campaignName:o||"",campaignId:r||"",groupTitle:a||""}),cEt={landscape:{promotion:{numberOfLines:1,compress:!1},title:{numberOfLines:1},controlsContainer:{position:"priceLine",style:"small"},image:{resolution:{height:88,width:88}},packSize:null,countryOfOrigin:null,bottomAttributes:null,unitPrice:null,price:{direction:"column"}}},dEt=(e="")=>e.charAt(0).toUpperCase()+e.slice(1),uEt=({page:e})=>{const t=E(D("so.pro.micro")),n=E(ec),o=E(eze),r=E(Ze),a=F(),l=t?cEt:{landscape:{promotion:{compress:!1}}};h.useEffect(()=>{!n.isFetching&&!n.lastUpdated&&!n.fetchError&&r&&a(bs.getCurrentCustomer())},[n]);const{formatMessage:c}=M(),d={loggedInTitle:c("shopper.optimisations.logged.in.recommendations.carousel.title",{name:dEt(n?.data?.moniker)}),loggedOutTitle:c("shopper.optimisations.logged.out.recommendations.carousel.title")},u=!o.lastUpdated,g=(()=>{if(u){const{products:y,group:I}=lEt("inspiration_carousel");return YB(y,I)}if(o.data){const y=o.data.products.map(C=>C.productId),I=EX({productIds:y,title:r?d.loggedInTitle:d.loggedOutTitle,productType:"inspiration_carousel"}),S={recommendationId:o.data.recommendationId};return YB(y,I,S)}return[]})();if(!u&&!g.length||o.fetchError)return null;const f=n.lastUpdated?s.jsxs("div",{className:"salt-d--flex",children:[s.jsx(me,{name:"genie",className:"salt-m-r--2"}),s.jsx(ne,{as:"h2",children:d.loggedInTitle})]}):s.jsx(Pe,{width:"10%",height:"30px"});return s.jsx("div",{className:"salt-p-t--2 salt-p-b--4","data-test":"recommended-products-carousel",children:s.jsx(MN,{overrideConfig:l,products:g,titleElement:r?f:d.loggedOutTitle,a11yTitleText:r?d.loggedInTitle:d.loggedOutTitle,loading:u,page:e})})},WB=D("pql.promo"),qB=D("seo.rdbl"),KB=D("di"),pEt=(e,t,n,o)=>(r,a)=>{const i=a(),l=D("di"),c=io(i);return r(Li.getPromotionDetails(e,t,l(i),c,n,o)).then(d=>{if(!d)return;const u=FO(d.payload.responseData,l(i),c),{entities:m,result:{missedPromotions:g}}=u;for(const f in m.product)m.product[f]===void 0&&delete m.product[f];return m&&r(Ft.setProducts(m)),g?.length&&r(Ao.addMissedPromotions(g)),u})},ob=({category:e,filters:t={},sortOption:n,pageToken:o,isRetailerCategoryId:r})=>(a,i)=>{const l=i();return a(WB(l)?Li.getPQLPromotionsPage({imageFormats:io(l)??[],isSEOReadableURLEnabled:qB(l),isDynamicImagesEnabled:KB(l)},e,t,n,o,r):Li.getPromotionsPage(e,t,n,o,r)).then(c=>{if(!c)return;let{payload:{responseData:d}}=c;WB(l)&&(d=dA(d,io(l)??[],qB(l),KB(l)));const{entities:u,result:{missedPromotions:m,nextPageToken:g,productGroups:f,breadcrumbs:y,retailerCategoryId:I}}=d;for(const S in u.product)u.product[S]===void 0&&delete u.product[S];return a(Ft.setProducts(u)),m?.length&&a(Ao.addMissedPromotions(m)),{nextPageToken:g,productCount:yp(f).length,breadcrumbs:y,retailerCategoryId:I}})},jZt={getPromotionDetails:pEt},mEt=()=>{const e=F(),t=We(),n=E(Vs);h.useEffect(()=>{e(U.analyticsEvent({type:Pc.PROMOTIONS_NO_RESULTS,locale:n}))},[]);const o=()=>{t(pn())};return s.jsx(Y,{fixed:!0,className:"salt-m-y--16",children:s.jsx(Y.Item,{colStart:{sm:3,md:4,lg:5},colSpan:{xs:12,sm:8,md:6,lg:4},children:s.jsx(ln,{titleIcon:"promotion",title:"promotions.no.results.title",titleAs:"h2",description:"promotions.no.results.subtext",primaryButton:{text:"promotions.no.results.open.navigation",onClick:o}})})})},fX=e=>{if(e==="promotions")return{};const n=(e?.endsWith("/")?e.slice(0,-1):e)?.split("/")??[],o=n.pop();return{sublocationId:o?.length?o:void 0,fullCataloguePath:n.length?n.join("/"):void 0}},rb=D("seo.rdbl"),ab=D("seo.ra"),hEt=D("cp"),gEt=D("so.promotion"),EEt=D("bt.top"),fEt=()=>{const e=F(),t=M(),n=Ne(),o=We(),r=co(),{sublocationId:a}=fX(r["*"]),i=E(Ip),l=E(og),c=E(fd),d=E(q1),u=E(rb),m=E(ab),g=E(hEt),f=E(gEt),y=E(EEt),I=nE(),S=()=>{f&&e(XKe())};h.useEffect(()=>{S()},[]);const C=L=>{L==="COUPONS"&&e(U.analyticsEvent({type:Pc.COUPONS_TAB_CLICKED}))},_=L=>u?a:L.sublocationId,A=()=>{e(ks({name:WTe}))},x=()=>{const L=t.formatMessage("page.seo.heading",{tagline:t.formatMessage("promotions.page.seo.header.tagline"),separator:" ",name:c});if(!(d===0&&g))return{name:L,url:R()}},R=({category:L=void 0,sortOption:B=void 0,filters:W={},fullURLPath:$=""}={})=>{const K=ES({...!u&&{category:L},filters:W,sortOption:B});return u?NA(L,$,{queryString:K}):lc(void 0,{queryString:K})},O=()=>[{name:t.formatMessage({id:"promotions.category.root.name"}),url:R()}],N=({category:L,nextPageToken:B})=>e(ob({category:L,pageToken:B})).then(W=>{!l&&W&&W.nextPageToken&&W.productCount===0&&N({category:L,nextPageToken:W.nextPageToken})}),k=({fops:L,category:B,nextPageToken:W,totalProductsDecorated:$,totalProducts:K})=>{e(Ci({products:L,updateProducts:!0})),!l&&W&&$>=K-bC*.2&&N({category:B,nextPageToken:W})},j=({category:L,filters:B,sortOption:W})=>(e(gX()).catch($=>{Me.api.pushError($)}),e(ob({category:L,filters:B,isRetailerCategoryId:m,sortOption:W})).catch($=>{Me.api.pushError($)})),w=()=>f&&!a?s.jsx(uEt,{page:"promotions"}):null;return s.jsxs(h.Fragment,{children:[g&&s.jsx(rEt,{activeTabType:"PROMOTIONS",onTabClick:L=>C(L)}),s.jsx(rs,{title:"promotions.title",seoFriendlyMeta:{metaDescriptionTagline:"promotions.meta.descriptionTagline",pageDescription:t.formatMessage("promotions.title")}}),g&&s.jsx(Ee,{asChild:!0,children:s.jsx("h1",{children:t.formatMessage({id:"promotions.title"})})}),s.jsx(CT,{navigate:o,showSortAndFilters:!0,categoryRootLinks:O(),fetchPage:j,page:"promotions",rootBreadcrumb:x(),hideBreadcrumb:g?d===0:!1,belowBreadcrumbContentFactory:w,getTargetUrl:L=>R(L),location:n,onInitialFopLoad:A,noProductsPage:()=>s.jsx(mEt,{}),noProductsFilteredPage:({clearFilters:L,term:B})=>s.jsx(TT,{clearFilters:L,page:"promotions",term:B}),handleFopVisibiltyChange:k,shouldShowScrollToTopButton:y?!1:I,pageError:i,matchSublocationId:_,enableRegionAgnosticCategoriesPerSection:!0,fetchNextPage:N}),y&&s.jsx(_T,{})]})},ib=()=>s.jsx(os,{type:"Promotions::route",children:s.jsx(fEt,{})});ib.fetchData=async({context:{store:e,url:t},params:n})=>{const o=e.getState(),r=fX(n["*"]),a=us.parse(t.search),i=t.searchParams.get("sortBy")??"",l=t.searchParams.get("sublocationId")??"",c=l||r.sublocationId,d=`${t.pathname}${t.search}`,u=t.searchParams.toString(),m=Wt(o),g=l?cA(a):u,f=fp(a)||{};if(ab(o)){await e.dispatch(ft.getCategoryEntity({queryString:`id=${c}`}));const S=z1(e.getState());if(S?.id&&c!==S?.retailerId){const C={queryString:g,basePath:m},_=S?.retailerId;return{redirectTo:rb(o)?NA(_,S?.encodedName?.toLowerCase(),C):lc(_,C),statusCode:ai.MOVED_PERMANENTLY}}}const y=[e.dispatch(ob({category:c,sortOption:i,filters:f,isRetailerCategoryId:ab(o)})).then(()=>{const S=`${t.pathname}${t.search}`,C=m?.length?S.replace(m,""):S;e.dispatch(ft.setLastFetchedCatalogueLocation(C))}),e.dispatch(gX())];await Promise.all(y);const I=Ip(e.getState());if(rb(o)&&!I){let S=xx(e.getState())?.toLowerCase();S&&(S=S.split("/").map(encodeURIComponent).join("/"));const C=NA(c,S,{queryString:g,basePath:m});if(d.toLowerCase()!==C.toLowerCase())return L$(C,ai.MOVED_PERMANENTLY)}};const yEt=({rootpageTitle:e,subpageTitle:t,seoFriendlyMeta:n})=>{const o=E(_d),r=M(),i=o&&o.length>0?[...o].pop().name:null,l=i?t:e,c=o&&o[0]?.name||r.formatMessage("search.categories.title"),d=()=>c===i?c:i?`${c}${r.formatMessage("page.title.separator")}${i}`:c,u={metaDescriptionTagline:c===i?n?.metaDescriptionTagline:n?.metaSubDescriptionTagline,pageDescription:d()};return s.jsx(rs,{title:l,seoFriendlyMeta:u,values:i?{subPageName:i,rootCategoryName:c,separator:r.formatMessage("page.title.separator"),rootPageName:r.formatMessage(e)}:void 0})},IEt=()=>{let e=[],t="";const n=ts(),o=E(u=>On(u)),{formatMessage:r}=M(),[a]=fe(["seo.rdbl"]),i=E(PO),l=E(Vs),c=F();i&&(e=i.refined.slice(0,5),t=i.searchTermFromQueryParam);const d=(u,m)=>{n({type:hs.SEARCH_SUGGESTION_CLICKED,id:vt(),userInput:t,searchSuggestion:u,positionInSuggestionList:m,locale:l,suggestionsCount:e.length,suggestionType:"REFINED_SEARCH_SUGGESTION",location:"NO_RESULTS",pageViewId:o}),n({type:hs.SELECT_SEARCH_SUGGESTION,searchSuggestion:u,suggestionIndex:m,suggestionType:"refined",location:"NO_RESULTS"})};return h.useEffect(()=>{e.length&&c(U.analyticsEvent({pageViewId:o,type:hs.SEARCH_SUGGESTION_IMPRESSION,searchSuggestionImpressions:e.map((u,m)=>({sequence:m,searchSuggestionType:"REFINED_SEARCH_SUGGESTION",location:"NO_RESULTS",searchTerm:u}))}))},[]),s.jsxs(se,{direction:"column",gap:["md"],children:[s.jsxs(se,{gap:["sm"],wrap:"nowrap",align:"center",children:[s.jsx(me,{name:"search"}),s.jsx(ne,{as:"h2",children:r("search.no.results.suggestion.title",{title:t})})]}),s.jsx(P,{size:"l",children:r("search.no.results.suggestion.title.subtext")}),s.jsx(se,{gap:["sm"],align:"center",justify:"flex-start","data-test":"suggestion-search-list",children:e.length>0?e.map((u,m)=>s.jsx(oX,{a11yLabel:r("smart.search.ribbon.refined.accessibility.button.label",{searchTerm:u}),href:li(a,{queryString:`q=${u}`}),term:u,source:"REFINED_SEARCH_SUGGESTION",handleSuggestionClick:()=>d(u,m)},u)):s.jsx(b,{asChild:!0,intent:"primary",fill:!0,children:s.jsx(Qe,{intent:"ghost",href:Zo(),children:s.jsx(b.Text,{children:r("catalogue.no.results.open.navigation")})})})})]})},yX=({page:e,term:t,icon:n="info_default",subtext:o=""})=>{const r=We(),a=E(Vs),i=ts(),[l]=fe(["sss"]),{smartSearchSuggestions:c,isFetching:d,lastUpdated:u}=E(D4),m=l&&e==="search"&&c?.refined.length;h.useEffect(()=>{i({type:gt.CATALOGUE_NO_RESULTS,term:t,locale:a});const y={event:"event",eventAction:"NoResults",eventCategory:"Catalogue",eventLabel:t};J.sendEvent({GA:y,WA:null}),i({type:gt.SEARCH_NO_RESULTS,term:t});const I={event:"search_no_results",search_term:t};J.sendEvent({GA:I,WA:null})},[]);const g=()=>{i({type:gt.CATALOGUE_NO_RESULTS_BROWSE_CLICKED,term:t,locale:a});const y={event:"event",eventAction:"NoResultsBrowseClicked",eventCategory:"Catalogue",eventLabel:t};J.sendEvent({GA:y,WA:null}),r(Zo())};return l&&(d||!u)?null:s.jsxs(h.Fragment,{children:[s.jsx(mI,{page:e,pageKey:t,sizes:["LARGE","MEDIUM","SMALL"],isNoProductsPage:!0}),s.jsx("div",{className:"salt-m-y--16",children:s.jsx(Y,{children:s.jsx(Y.Item,{colSpan:{xs:10,sm:8,md:6,lg:4},colStart:{xs:2,sm:3,md:4,lg:5},children:m?s.jsx(IEt,{}):s.jsx(ln,{title:"catalogue.no.results.title",titleAs:"h2",titleIcon:n,description:o,primaryButton:{text:"catalogue.no.results.open.navigation",onClick:g}})})})})]})},SEt=1e4,CEt=3,_c=16,TEt={headlineText:p.string,headlineColor:p.string,alt:p.string.isRequired,images:p.arrayOf(p.shape({url:p.string.isRequired,width:p.number.isRequired,height:p.number.isRequired})).isRequired,dataTest:p.string,headlineDataTest:p.string},_Et={headlineText:void 0,headlineColor:"#000000",dataTest:void 0,headlineDataTest:void 0},lv=e=>e/CEt,cf=(e,t,n)=>{const o=e.find(a=>lv(a.width)>=t&&lv(a.width)<n);if(!o)return"display: none;";const r=lv(o.height);return`
        display: block;
        background-image: url(${o.url});
        height: ${H(r)};
        background-size: auto ${r}px;
    `},IX=T.div.withConfig({shouldForwardProp:e=>!["width","images","href"].includes(e)})`
    position: relative;
    background-color: var(--intent-secondary-100);
    background-repeat: no-repeat;
    background-position: center;
    inline-size: ${({width:e})=>e};
    border-radius: var(--salt-radius-default);

    ${({images:e})=>cf(e,Ke.xs*_c,Ke.sm*_c)}

    ${oe.smUp`
        ${({images:e})=>cf(e,Ke.sm*_c,Ke.md*_c)}
    `}

    ${oe.mdUp`
        ${({images:e})=>cf(e,Ke.md*_c,Ke.lg*_c)}
    `}

    ${oe.lgUp`
        ${({images:e})=>cf(e,Ke.lg*_c,SEt)}
    `};
`,vEt=T.span.withConfig({shouldForwardProp:e=>!["headlineColor","width","images","href"].includes(e)})`
    font-size: var(--salt-display-font-size);
    font-weight: 600;
    color: ${({headlineColor:e})=>e};
    position: absolute;
    inset-block-end: var(--salt-spacing-8);
    inset-inline-start: var(--salt-spacing-8);
`,vT=({images:e,headlineText:t,headlineColor:n,alt:o,dataTest:r,headlineDataTest:a})=>s.jsxs(IX,{images:e,"data-test":r,children:[s.jsx(Ee,{children:o}),t&&t.length>0&&s.jsx(vEt,{"data-test":a,headlineColor:n,children:t})]});vT.propTypes=TEt;vT.defaultProps=_Et;vT.HorizontalHeroBackground=IX;const SX=()=>{const e=F(),t=h.useCallback(a=>{e(U.analyticsEvent({type:tn.HORIZONTAL_HERO_BANNER_IMPRESSION,...a}));const i={ecommType:"enhanced",event:"view_promotion",eventCategory:"Event page",eventAction:"HERO_IMAGE_BANNER_IMPRESSION",ecommerce:{promoView:{promotions:[{promotionType:"Category Event",id:a.id,name:a.name,creative:a.imageId,position:"Hero Image"}]}}};J.sendEvent({GA:i,WA:null})},[e]),n=h.useCallback(a=>{e(U.analyticsEvent({type:tn.SUB_CATEGORY_IMAGE_IMPRESSION,...a}));const i={ecommType:"enhanced",event:"view_promotion",eventCategory:"Event page",eventAction:"SUB_CATEGORY_IMAGE_IMPRESSION",ecommerce:{promoView:{promotions:[{promotionType:"Category Event",id:a.id,name:a.subCategoryName,creative:a.imageId,position:`Sub category image ${a.sequence}`}]}}};J.sendEvent({GA:i,WA:null})},[e]),o=h.useCallback(a=>{e(U.analyticsEvent({type:tn.SUB_CATEGORY_IMAGE_CLICKED,...a}));const i={ecommType:"enhanced",event:"select_promotion",eventCategory:"Event page",eventAction:"SUB_CATEGORY_IMAGE_CLICKED",ecommerce:{promoClick:{promotions:[{promotionType:"Category Event",id:a.id,name:a.subCategoryName,creative:a.imageId,position:`Sub category image ${a.sequence}`}]}}};J.sendEvent({GA:i,WA:null})},[e]),r=h.useCallback(a=>{e(U.analyticsEvent({type:tn.SHOP_IN_SHOP_CATEGORY_PAGE_VIEW,...a}));const i={event:"view_shop_in_shop",name:a.name,id:a.id,type:a.pageType};J.sendEvent({GA:i,WA:null})},[e]);return{reportHorizontalHeroImpression:t,reportSubCategoryImpression:n,reportSubCategoryClick:o,reportPageView:r}},AEt={id:p.string.isRequired,label:p.string,name:p.string.isRequired,categoryId:p.string,categoryName:p.string,images:p.shape({hero:p.shape({id:p.string.isRequired,name:p.string,headline:p.string,headlineHexColour:p.string,altText:p.string,contentType:p.string,images:p.arrayOf(p.shape({url:p.string,width:p.number.isRequired,height:p.number.isRequired})).isRequired}).isRequired,subCategories:p.arrayOf(p.shape({id:p.string.isRequired,name:p.string.isRequired,label:p.string.isRequired,altText:p.string.isRequired,contentType:p.string,images:p.arrayOf(p.shape({url:p.string.isRequired,width:p.number.isRequired,height:p.number.isRequired})).isRequired,target:p.oneOfType([p.shape({linkType:p.string,openInNewTab:p.bool,ids:p.array}),p.shape({linkType:p.string,openInNewTab:p.bool,values:p.array})]).isRequired})).isRequired})},bEt={reportImpression:p.func.isRequired,children:p.element.isRequired},xEt={children:void 0,reportImpression:void 0},tL=({reportImpression:e,children:t})=>{const n=Eq(e);return s.jsx("div",{ref:n,"data-test":"sis-sub-category",children:t})};tL.propTypes=bEt;tL.defaultProps=xEt;const REt=e=>e?.startsWith("/")&&!e.includes("source=")?e.includes("?")?`${e}&source=SUB_CATEGORY_IMAGE_CLICKED`:`${e}?source=SUB_CATEGORY_IMAGE_CLICKED`:e,DEt=(e,{isSEOReadableURLEnabled:t})=>{if(e)return REt(La.calculateLegacyTargetUrl(e,{isSEOReadableURLEnabled:t}))},OEt=e=>e.openInNewTab?"_blank":void 0,cv=e=>e?e.substring(e.lastIndexOf("/")+1):"",sL=({id:e,name:t,label:n,images:o,categoryId:r,categoryName:a})=>{const i=SX();h.useEffect(()=>{i.reportPageView({event:"view_shop_in_shop",name:t??"",id:e,pageType:"category"})},[]),h.useEffect(()=>{i.reportHorizontalHeroImpression({id:e??"",name:t??"",categoryId:r??"",categoryName:a??"",imageId:o?.hero?.images[0]?.url?cv(o?.hero?.images[0]?.url):"",eventId:e,eventHeadline:o?.hero?.headline??""})},[e,o]);const[l]=fe(["seo.rdbl"]),c=h.useRef([]),d=h.useCallback(({parentCategoryId:f,imageId:y,subCategoryId:I,subCategoryName:S,subCategoryLabel:C,value:_,linkType:A,sequence:x})=>{i.reportSubCategoryClick({id:e??"",parentCategoryId:f,subCategoryId:I,subCategoryName:S,subCategoryLabel:C,value:_,linkType:A,imageId:y,sequence:x?.toString(),event:"shop_in_shop_navigation",pageType:"category"})},[]),u=h.useCallback(({imageId:f,subCategoryId:y,subCategoryName:I,subCategoryLabel:S,sequence:C})=>{c.current.includes(C)||(c.current.push(C),i.reportSubCategoryImpression({id:e??"",categoryId:r??"",categoryName:a??"",imageId:f,subCategoryId:y,subCategoryName:I,subCategoryLabel:S,sequence:C?.toString()}))},[r,a]);if(!o)return null;const{hero:m,subCategories:g}=o;return s.jsxs("div",{className:"salt-m-x--4",children:[s.jsx("div",{className:"salt-m-y--4",children:n&&s.jsx(ne,{as:"h1","ata-test":"sis-label",children:n})}),m&&s.jsx("div",{className:"salt-m-b--4",children:s.jsx(vT,{images:m.images,headlineText:m.headline,headlineColor:m.headlineHexColour,alt:m.altText??"",dataTest:"category-event-hero",headlineDataTest:"sis-hero-headline"})}),g&&s.jsx(He.MediaCardCollection,{formatting:"normal",gridVariant:"auto-fill",children:g.map((f,y)=>{const I=DEt(f?.target,{isSEOReadableURLEnabled:l}),S=OEt(f?.target);return s.jsx(tL,{reportImpression:()=>u({imageId:f?.images[0]?.url?cv(f?.images[0]?.url):"",subCategoryId:f?.id??"",subCategoryName:f?.name??"",sequence:y.toString(),subCategoryLabel:f?.label??""}),children:s.jsx(He.MediaNavigationCard,{variant:"fullImage",formatting:"normal",src:f?.images[0]?.url??"",alt:f?.altText,title:f?.label,href:I,target:S,titleDataTest:"sis-sub-category-label",onClick:()=>{d({parentCategoryId:r??"",subCategoryId:f?.id??"",subCategoryName:f?.name??"",imageId:f?.images[0]?.url?cv(f?.images[0]?.url):"",linkType:f?.target.linkType??"",subCategoryLabel:f?.label??"",value:I,sequence:y.toString()})}})},f?.id??y)})})]})};sL.propTypes=AEt;sL.defaultProps={id:"",label:"",images:void 0,categoryId:"",categoryName:""};const PEt={html:""},CX=({html:e,id:t,name:n})=>{const o=SX();return h.useEffect(()=>{o.reportPageView({event:"view_shop_in_shop",name:n,id:t,pageType:"category"})},[]),e?s.jsx("div",{className:"salt-m--4",dangerouslySetInnerHTML:{__html:e},"data-test":"html-category-event"}):null};CX.defaultProps=PEt;const NEt={id:p.string.isRequired,label:p.string,name:p.string,contentFormat:p.string.isRequired,html:p.string,breadCrumbs:p.arrayOf(p.shape({id:p.string,name:p.string})).isRequired,images:p.shape({hero:p.shape({id:p.string,name:p.string,headline:p.string,headlineHexColour:p.string,altText:p.string,contentType:p.string,images:p.arrayOf(p.shape({url:p.string.isRequired,width:p.number.isRequired,height:p.number.isRequired})).isRequired}).isRequired,subCategories:p.arrayOf(p.shape({id:p.string,name:p.string,label:p.string.isRequired,altText:p.string.isRequired,contentType:p.string,images:p.arrayOf(p.shape({url:p.string.isRequired,width:p.number.isRequired,height:p.number.isRequired})).isRequired,target:p.oneOfType([p.shape({linkType:p.string,openInNewTab:p.bool,ids:p.array,encodedName:p.string}),p.shape({linkType:p.string,openInNewTab:p.bool,values:p.array,encodedName:p.string})]).isRequired})).isRequired})},LEt={id:"",name:"",label:"",contentFormat:"",html:"",images:void 0,breadCrumbs:void 0},nL=({id:e,name:t,label:n,contentFormat:o,images:r,html:a,breadCrumbs:i})=>{const l="html",c="images",d=i?i.slice(-1)[0]:void 0;if(!d)return null;switch(o.toLowerCase()){case c:return s.jsx(sL,{name:t??"",label:n??"",images:r,id:e,categoryId:d?.id,categoryName:d?.name});case l:return s.jsx(CX,{html:a,id:e,name:t??""});default:return null}};nL.propTypes=NEt;nL.defaultProps=LEt;const zB=e=>{const{ITEM_ID:t,ITEM_NAME:n,SEQUENCE:o,SEQUENCE_OF_ITEM_ON_PAGE:r,PAGE_TYPE:a,PAGE_NAME:i,LINK_TYPE:l,LINK_VALUE:c}=e;return i==="homepage"?{id:t,name:n,event:"select_homepage_tile",navigation:"grid",index:o,location:r,link_type:l,target:c}:i==="static_page"?{event:"static_page_navigation",id:t,name:n,navigation:"grid-tile",type:a,index:r,link_type:l,target:c}:i==="shop_in_shop"?{id:t,name:n,event:"shop_in_shop_navigation",navigation:"grid-tile",type:a,index:r,location:null,link_type:l,target:c}:null},Ea=()=>{const e=F(),t=h.useCallback(f=>{e({type:vs.COMPONENTIZED_ATTRIBUTES,payload:f})},[e]),n=h.useCallback(f=>{e({type:vs.GRID_IMPRESSION,payload:f})},[e]),o=h.useCallback(f=>{e({type:vs.GRID_ITEM_IMPRESSION,payload:f})},[e]),r=h.useCallback(f=>{e({type:vs.HORIZONTAL_HERO_BANNER_CLICK,payload:f});const{BANNER_ID:y,BANNER_NAME:I,PAGE_NAME:S,PAGE_TYPE:C,LINK_TYPE:_,TARGET_URL:A,SEQUENCE:x}=f;if(S==="homepage")return;const R={event:`${S}_navigation`,id:y,name:I,navigation:"hero",type:C,index:x,location:null,link_type:_,target:A};J.sendEvent({GA:R,WA:null})},[e]),a=h.useCallback(f=>{e({type:vs.HORIZONTAL_HERO_BANNER_IMPRESSION,payload:f})},[e]),i=h.useCallback(f=>{e({type:vs.GRID_ITEM_CLICKED,payload:f});const y=zB(f);y&&J.sendEvent({GA:y,WA:null})},[e]),l=h.useCallback(f=>{e({type:vs.GRID_ITEM_CLICKED,payload:f});const y=zB(f);y&&J.sendEvent({GA:y,WA:null})},[e]),c=h.useCallback(f=>{e({type:vs.CAROUSEL_ITEM_CLICKED,payload:f});const{ITEM_ID:y,ITEM_NAME:I,SEQUENCE:S,SEQUENCE_OF_ITEM_ON_PAGE:C,LINK_TYPE:_,LINK_VALUE:A}=f,x={id:y,name:I,event:"select_homepage_tile",navigation:"carousel",index:S,location:C,link_type:_,target:A};J.sendEvent({GA:x,WA:null})},[e]),d=h.useCallback(f=>{e({type:vs.NAV_MENU_CLICKED,payload:f})},[e]),u=h.useCallback(f=>{e({type:vs.NAV_ITEM_CLICKED,payload:f});const{ITEM_ID:y,ITEM_NAME:I,LOCATION:S,PAGE_TYPE:C,PAGE_NAME:_,LINK_TYPE:A,LINK_VALUE:x}=f;if(_==="homepage")return;const R={id:y,name:I,event:`${_}_navigation`,navigation:"navigation",type:C,index:null,location:S,link_type:A,target:x};J.sendEvent({GA:R,WA:null})},[e]),m=h.useCallback(f=>{e({type:vs.RICH_TEXT_IMPRESSION,payload:f})},[e]),g=h.useCallback(f=>{e({type:vs.RICH_TEXT_LINK_CLICKED,payload:f});const{RICH_TEXT_ID:y,LINK_TYPE:I,LINK_VALUE:S,PAGE_NAME:C,PAGE_TYPE:_,LOCATION:A}=f;if(C==="homepage")return;const x={id:y,name:y,event:`${C}_navigation`,navigation:"link",type:_,index:null,location:A,link_type:I,target:S};J.sendEvent({GA:x,WA:null})},[e]);return{reportComponentizedAttributes:t,reportGridImpression:n,reportGridItemImpression:o,reportHorizontalHeroBannerClicked:r,reportHorizontalHeroBannerImpression:a,reportGridItemClicked:l,reportCarouselItemClicked:c,reportGridLeadImageClicked:i,reportNavigationMenuClicked:d,reportNavigationItemClicked:u,reportRichTextImpression:m,reportRichTextLinkClicked:g}},kEt=(e,t)=>e?.startsWith("/")&&!e.includes("source=")?e.includes("?")?`${e}&source=${t}`:`${e}?source=${t}`:e,Jp=e=>e?.openInNewTab?"_blank":void 0,mc=(e,t,{isSEOReadableURLEnabled:n})=>{if(e)return kEt(La.calculateLegacyTargetUrl(e,{isSEOReadableURLEnabled:n}),t)},MEt=(e,t)=>e.filter(n=>n.componentType===t),jEt=(e,t,n)=>e.slice(0,n+1).filter(r=>r.componentType===t).length-1,df={getComponentizedItemsByType:MEt,getSequenceByType:jEt},TX=({children:e,target:t,source:n,onClick:o=void 0})=>{const[r]=fe(["seo.rdbl"]);if(!t)return s.jsx(h.Fragment,{children:e});const a=mc(t,n,{isSEOReadableURLEnabled:r}),i=Jp(t);return s.jsx(rt,{"data-test":`${n}-anchor`,href:a,target:i,...o&&{onClick:()=>o()},children:e})},Kd=(e,t={root:null,rootMargin:"-80px 0px 0px 0px",threshold:.5})=>{const n=h.useRef(null),o=eC(n,{freezeOnceVisible:!0,...t}),r=h.useMemo(()=>!!o?.isIntersecting,[o]);return h.useEffect(()=>{r&&e()},[r]),n},QB="fm",wEt="w",FEt="avif",BEt="webp",ko=(e,t,n=!1)=>{const o=e.find(i=>i.assetSize===t);if(!o)return[];const{url:r,width:a}=o;return[FEt,BEt].map(i=>[`${r}?${QB}=${i}&${wEt}=${a/2} ${n?"1x":`${a/2}w`}`,`${r}?${QB}=${i} ${n?"2x":`${a}w`}`].join(","))},UEt=T.div`
    border-radius: var(--salt-radius-default);
    inline-size: 100%;
    aspect-ratio: 2 / 1;
    background-color: var(--intent-secondary-100);

    ${oe.smUp`
        aspect-ratio: 4 / 1;
    `}

    ${oe.lgUp`
        aspect-ratio: 6 / 1;
    `}
`,GEt=()=>s.jsx(UEt,{className:"salt-m-b--2 md:salt-m-b--4",children:s.jsx(Pe,{height:"100%"})}),$Et=T.img`
    border-radius: var(--salt-radius-default);
    display: block;
    inline-size: 100%;
`,HEt=T.picture`
    ${e=>`
        display: ${e.isFetching?"none":"block"};
    `}
    aspect-ratio: 2 / 1;
    ${oe.smUp`
        aspect-ratio: 4 / 1;
    `}

    ${oe.lgUp`
        aspect-ratio: 6 / 1;
    `}
`,VEt=({data:{images:e,altText:t,id:n,target:o,name:r},meta:a})=>{const i=Ea(),[l,c]=h.useState(!0),d=Kd(()=>{const y={ENTRY_ID:a.ENTRY_ID,ENTRY_NAME:a.ENTRY_NAME,HERO_IMAGE_ID:a.HERO_IMAGE_ID,LINK_TYPE:o?.linkType??"",PAGE_TYPE:a.PAGE_TYPE,SEQUENCE:a.SEQUENCE,TARGET_URL:o?.values[0]??"",ENTRY_PUBLISHED_TIMESTAMP:a.ENTRY_PUBLISHED_TIMESTAMP};i.reportHorizontalHeroBannerImpression(y)}),u=()=>{a.LOCATION&&a.BANNER_PLACEMENT&&i.reportHorizontalHeroBannerClicked({BANNER_ID:n,BANNER_NAME:r,CONTENT_SOURCE:"CONTENTFUL",LINK_TYPE:o?.linkType??"",LOCATION:a.LOCATION,PLACEMENT:a.BANNER_PLACEMENT,SEGMENT_ID:"",SEQUENCE:a.SEQUENCE,TARGET_URL:o?.values[0]??"",PAGE_TYPE:a.PAGE_TYPE,PAGE_NAME:a.PAGE_NAME})},m={sm:ko(e,"RATIO_2_1"),md:ko(e,"RATIO_4_1"),lg:ko(e,"RATIO_6_1")},g=e?.find(y=>y.assetSize==="RATIO_2_1")?.url||"",f=()=>{c(!1)};return h.useEffect(()=>{d.current?.complete&&f()},[]),s.jsxs(ie.Fragment,{children:[l&&s.jsx(GEt,{}),s.jsx(TX,{source:"HERO_IMAGE",target:o,onClick:u,children:s.jsxs(HEt,{isFetching:l,children:[Object.entries(m).map(([y,I])=>{const[S,C]=I;return s.jsxs(ie.Fragment,{children:[s.jsx("source",{media:Hi[y],srcSet:S,type:"image/avif"},y),s.jsx("source",{media:Hi[y],srcSet:C,type:"image/webp"},y)]},y)}),s.jsx($Et,{"data-test":`hero-image-${n}`,ref:d,src:g,alt:t,onLoad:f})]})})]})},YEt={lg:"RATIO_4_1",md:"RATIO_4_1",sm:"RATIO_4_1",xs:"RATIO_2_1"},WEt={lg:"RATIO_4_1",md:"RATIO_2_1",sm:"RATIO_4_1",xs:"RATIO_2_1"},qEt={lg:"RATIO_2_1",md:"RATIO_1_1",sm:"RATIO_2_1",xs:"RATIO_1_1"},KEt={lg:"RATIO_4_1",md:"RATIO_2_1",sm:"RATIO_2_1",xs:"RATIO_1_1"},zEt={lg:"RATIO_4_1",md:"RATIO_2_1",sm:"RATIO_2_1",xs:"RATIO_1_1"},QEt={lg:"RATIO_2_1",md:"RATIO_2_1",sm:"RATIO_2_1",xs:"RATIO_1_1"},XEt=e=>{switch(e){case"ITEMS-2__A":return YEt;case"ITEMS-3__A":return WEt;case"ITEMS-4__A":return qEt;case"ITEMS-6__A":return KEt;case"ITEMS-8__A":return zEt;case"ITEMS-9__A":return QEt;default:return null}},ZEt=e=>XEt(e),JEt=T.div`
    grid-area: ${e=>e.gridArea};

    .grid-card {
        max-inline-size: none;
        min-inline-size: unset;
        inline-size: 100%;
    }
`,eft=({data:e,meta:t,gridArea:n})=>{const{tile:o,ratios:r}=e,[a]=fe(["seo.rdbl"]),i=mc(o?.target,"GRID_IMAGE",{isSEOReadableURLEnabled:a}),l=Jp(o?.target),c=Ea(),d=Kd(()=>c.reportGridItemImpression({...t,LINK_VALUE:i||""})),u={xs:ko(o?.images,r?.xs),sm:ko(o?.images,r?.sm),md:ko(o?.images,r?.md),lg:ko(o?.images,r?.lg)},m=o?.images?.find(f=>f.assetSize===r?.lg)?.url||"",g=()=>{c.reportGridItemClicked({ENTRY_ID:t.ENTRY_ID,ENTRY_NAME:t.ENTRY_NAME,GRID_ID:t.GRID_ID,ITEM_ID:o.id,ITEM_NAME:o.name,ITEM_TYPE:"TILE_IMAGE",LINK_TYPE:o.target?.linkType||"",LINK_VALUE:i||"",PAGE_TYPE:t.PAGE_TYPE,PAGE_NAME:t.PAGE_NAME,SEQUENCE:t.SEQUENCE,SEQUENCE_OF_ITEM_ON_PAGE:t.SEQUENCE_OF_ITEM_ON_PAGE})};return s.jsx(JEt,{"data-test":`grid-tile-${o.id}`,ref:d,gridArea:n,children:s.jsx(He.MediaNavigationCard,{className:"grid-card",variant:"fullImage",formatting:"small",dynamicHeight:!0,breakpointSrcSet:u,fallbackSrc:m,isLoading:!m,alt:o?.altText,title:o?.label,content:o?.description,href:i,target:l,onClick:g})})},tft=(e,t)=>t?t.slice(0,e).map(o=>o.items.length).reduce((o,r)=>+o+ +r,0):0,sft={getNumberOfPreviousGridTiles:tft},nft={"ITEMS-2__A":{xs:`
        "gridTile1"
        "gridTile2"
    `,sm:`
        "gridTile1"
        "gridTile2"
    `,md:`
        "gridTile1 gridTile2"
    `,lg:`
        "gridTile1 gridTile2"
    `},"ITEMS-3__A":{xs:`
        "gridTile1"
        "gridTile2"
        "gridTile3"
    `,sm:`
        "gridTile1"
        "gridTile2"
        "gridTile3"
    `,md:`
        "gridTile1 gridTile2 gridTile3"
    `,lg:`
        "gridTile1 gridTile2 gridTile3"
    `},"ITEMS-4__A":{xs:`
        "gridTile1 gridTile2"
        "gridTile3 gridTile4"
    `,sm:`
        "gridTile1 gridTile2"
        "gridTile3 gridTile4"
    `,md:`
        "gridTile1 gridTile2 gridTile3 gridTile4"
    `,lg:`
        "gridTile1 gridTile2 gridTile3 gridTile4"
    `},"ITEMS-6__A":{xs:`
        "gridTile1 gridTile2"
        "gridTile3 gridTile4"
        "gridTile5 gridTile6"
    `,sm:`
        "gridTile1 gridTile2"
        "gridTile3 gridTile4"
        "gridTile5 gridTile6"
    `,md:`
        "gridTile1 gridTile2 gridTile3"
        "gridTile4 gridTile5 gridTile6"
    `,lg:`
        "gridTile1 gridTile2 gridTile3"
        "gridTile4 gridTile5 gridTile6"
    `},"ITEMS-8__A":{xs:`
        "gridTile1 gridTile2"
        "gridTile3 gridTile4"
        "gridTile5 gridTile6"
        "gridTile7 gridTile8"
    `,sm:`
        "gridTile1 gridTile2"
        "gridTile3 gridTile4"
        "gridTile5 gridTile6"
        "gridTile7 gridTile8"
    `,md:`
        "gridTile1 gridTile2 gridTile3 gridTile4"
        "gridTile5 gridTile6 gridTile7 gridTile8"
    `,lg:`
        "gridTile1 gridTile2 gridTile3 gridTile4"
        "gridTile5 gridTile6 gridTile7 gridTile8"
    `},"ITEMS-9__A":{xs:`
        "gridLead gridLead"
        "gridTile1 gridTile2"
        "gridTile3 gridTile4"
        "gridTile5 gridTile6"
        "gridTile7 gridTile8"
    `,sm:`
        "gridLead gridLead gridTile1"
        "gridLead gridLead gridTile2"
        "gridTile3 gridTile4 gridTile5"
        "gridTile6 gridTile7 gridTile8"
    `,md:`
        "gridLead gridLead gridTile1 gridTile2"
        "gridLead gridLead gridTile3 gridTile4"
        "gridTile5 gridTile6 gridTile7 gridTile8"
    `,lg:`
        "gridLead gridLead gridTile1 gridTile2 gridTile3 gridTile4"
        "gridLead gridLead gridTile5 gridTile6 gridTile7 gridTile8"
    `}},oft=e=>{const t=nft[e];return De`
        grid-template-areas: ${t.xs};

        ${oe.smUp`
            grid-template-areas: ${t.sm};
        `}

        ${oe.mdUp`
            grid-template-areas: ${t.md};
        `}

        ${oe.lgUp`
            grid-template-areas: ${t.lg};
        `}
    `},rft=T.div`
    @media (min-width: ${Ke.sm}em) {
        block-size: 1px;
        flex-grow: 1;
    }
`,aft=T.img`
    border-radius: var(--salt-radius-default);
    object-fit: cover;
    inline-size: 100%;
    block-size: 100%;
`,ift=T.div`
    display: flex;
    flex-direction: column;
    grid-area: gridLead;
`,lft=T.picture`
    display: flex;
    block-size: 100%;
`,cft=({data:e,meta:t})=>{const{tile:n}=e,o={xs:ko(n?.images,"RATIO_2_1"),sm:ko(n?.images,"RATIO_1_1"),md:ko(n?.images,"RATIO_1_1"),lg:ko(n?.images,"RATIO_1_1")},r=n?.images?.find(d=>d.assetSize==="RATIO_1_1")?.url||"",[a]=fe(["seo.rdbl"]),i=mc(n?.target,"GRID_IMAGE",{isSEOReadableURLEnabled:a}),l=Ea(),c=Kd(()=>l.reportGridItemImpression(t));return s.jsx(ift,{children:s.jsx(rft,{children:s.jsx(TX,{source:"GRID_IMAGE",target:n.target,onClick:()=>{l.reportGridLeadImageClicked({ENTRY_ID:t.ENTRY_ID,ENTRY_NAME:t.ENTRY_NAME,GRID_ID:t.GRID_ID,ITEM_ID:n.id,ITEM_NAME:n.name,ITEM_TYPE:"LEAD_IMAGE",LINK_TYPE:n.target?.linkType||"",LINK_VALUE:i||"",PAGE_TYPE:t.PAGE_TYPE,PAGE_NAME:t.PAGE_NAME,SEQUENCE:t.SEQUENCE,SEQUENCE_OF_ITEM_ON_PAGE:t.SEQUENCE_OF_ITEM_ON_PAGE})},children:s.jsxs(lft,{ref:c,children:[Object.entries(o).map(([d,u])=>{const[m,g]=u;return s.jsxs(ie.Fragment,{children:[s.jsx("source",{media:Hi[d],srcSet:m,type:"image/avif"},d),s.jsx("source",{media:Hi[d],srcSet:g,type:"image/webp"},d)]})}),s.jsx(aft,{"data-test":`grid-lead-${n.id}`,src:r,alt:n.altText})]})})})})},dft=T.div`
    display: grid;
    ${e=>oft(e.layout)}
    ${oe.xs`
        gap: var(--salt-spacing-2);
    `}
    ${oe.smUp`
        gap: var(--salt-spacing-4);
    `}
    grid-auto-columns: minmax(1px, 1fr);
`,uft=e=>`gridTile${e+1}`,pft=({data:e,meta:t})=>{const{layout:n,label:o}=e,r=ZEt(n),a=Ea(),i=Kd(()=>a.reportGridImpression(t)),l=h.useMemo(()=>sft.getNumberOfPreviousGridTiles(t.SEQUENCE_BY_TYPE,t.COMPONENTIZED_ITEMS_BY_TYPE),[]),c=h.useMemo(()=>e.items.find(u=>u.type==="LEAD_IMAGE"),[e.items]),d=h.useMemo(()=>e.items.filter(u=>u.type==="GRID_TILE"),[e.items]);return s.jsxs(h.Fragment,{children:[o&&s.jsx(ne,{as:"h2",className:"salt-p-b--4",children:o}),!!e?.items?.length&&s.jsxs(dft,{"data-test":`grid-${n}`,ref:i,layout:n,children:[c&&s.jsx(cft,{data:{tile:c},meta:{ENTRY_ID:t.ENTRY_ID,ENTRY_NAME:t.ENTRY_NAME,GRID_ID:e.id,ITEM_ID:c.id,ENTRY_PUBLISHED_TIMESTAMP:c.publishedAt,ITEM_TYPE:"HERO_IMAGE",LABEL:c.label,ALT_TEXT:c.altText,PAGE_TYPE:t.PAGE_TYPE,PAGE_NAME:t.PAGE_NAME,SEQUENCE:0,SEQUENCE_OF_ITEM_ON_PAGE:l}}),d.map((u,m)=>s.jsx(eft,{gridArea:uft(m),data:{tile:u,ratios:r},meta:{ENTRY_ID:t.ENTRY_ID,ENTRY_NAME:t.ENTRY_NAME,GRID_ID:e.id,ITEM_ID:u.id,ENTRY_PUBLISHED_TIMESTAMP:u.publishedAt,ITEM_TYPE:"TILE_IMAGE",LABEL:u.label,ALT_TEXT:u.altText,LINK_TYPE:u.target?.linkType||"",LINK_VALUE:u.target?.values[0]||"",PAGE_TYPE:t.PAGE_TYPE,PAGE_NAME:t.PAGE_NAME,SEQUENCE:m,SEQUENCE_OF_ITEM_ON_PAGE:l+m}},u.id))]})]})},dv=(e,t)=>e.substring(e.lastIndexOf("/")+1)===t?.target?.values[0]?.replace("?type=componentized",""),_X=(e,t)=>{switch(t?.target?.linkType){case"SHOP_IN_SHOP_TEMPLATED":return dv(e,t);case"SHOP_IN_SHOP":return dv(e,t);case"CATEGORY":return dv(e,t);default:return!1}},oL=(e,t)=>{let n=!1;const o=new Array;t?.items?.forEach(a=>{const i=oL(e,a);(i.isCurrentPage||i.isActive)&&(n=!0),o.push(i)});const r={...t,isActive:n,items:o??[]};return r.isCurrentPage||(r.isCurrentPage=_X(e,r)),r},mft=(e,t)=>{const n=new Array;return t.items.forEach(o=>n.push(oL(e,o))),{id:t.id,componentType:t.componentType,items:n}},hft=e=>({items:e}),lb=e=>Array.isArray(e)?1+Math.max(...e.map(lb)):e.items&&e.items.length?1+Math.max(...e.items.map(lb)):0,gft=(e,t,n)=>n===0?e:t?t.items:[],Eft=e=>({back:e.formatMessage("navigation.back"),title:e.formatMessage("shopinshop.navigation.title"),browse:e.formatMessage("shopinshop.navigation.title"),attributeTitle:e.formatMessage("shopinshop.navigation.title")}),fft=(e,t)=>{const n=new Array;for(let o=0;o<e;o+=1)n.push({paneIndex:o,selectedNavigationItemIndex:void 0,selected:void 0,parent:o===0?t:void 0});return n},yft=(e,t,n,o)=>{const r=t-1;return r<0||(e[r]&&(e[r].selected=n,e[r].selectedNavigationItemIndex=o),e[t]&&(e[t].parent=n)),e},Ift=(e,t)=>{const n=t+1;return e[n]&&(e[n].parent=void 0),e[t]&&(e[t].selected=void 0,e[t].selectedNavigationItemIndex=void 0),e},Sft=(e,t)=>{let n="";const o=[...e];return t!==void 0&&o.push(t),o.forEach((r,a)=>{a!==0&&(n+="_"),n+=r}),n},_r={toNavigationBarData:mft,enrichNavigationState:oL,isCurrentPage:_X,getNavigationItemsDepth:lb,createRootNavigation:hft,getNavigationItemsForPane:gft,getFormatMessage:Eft,getInitialNavigationPanes:fft,increamentNavigationPanes:yft,decreamentNavigationPanes:Ift,getDataLayerLocation:Sft},XB=({item:e,isSEOReadableURLEnabled:t,onItemClick:n,meta:o,itemLevel:r,index:a,selectedNavigationItemIndexes:i})=>{const l=Ea();if(e.isCurrentPage)return s.jsx(P,{bold:!0,children:e.label});const c=mc(e?.target,"NAV_BAR",{isSEOReadableURLEnabled:t})||"",d=Jp(e?.target);return e?.target.linkType===Dt.ABSOLUTE_WEB_ADDRESS?s.jsx(rt,{href:c,target:d,onClick:()=>{l.reportNavigationItemClicked({CAMPAIGN_ID:o.CAMPAIGN_ID,CAMPAIGN_NAME:o.CAMPAIGN_NAME,ITEM_ID:e.id,ITEM_NAME:e.name,LABEL:e.label,ITEM_TYPE:"DROPDOWN_ITEM",LEVEL:r,LINK_TYPE:e.target.linkType,LINK_VALUE:e.target.values[0],PAGE_TYPE:o.PAGE_TYPE,PAGE_NAME:o.PAGE_NAME,LOCATION:_r.getDataLayerLocation(i,a)}),n()},children:e.label}):s.jsx(Qe,{to:c,target:d,onClick:()=>{l.reportNavigationItemClicked({CAMPAIGN_ID:o.CAMPAIGN_ID,CAMPAIGN_NAME:o.CAMPAIGN_NAME,ITEM_ID:e.id,ITEM_NAME:e.name,LABEL:e.label,ITEM_TYPE:"DROPDOWN_ITEM",LEVEL:r,LINK_TYPE:e.target.linkType,LINK_VALUE:e.target.values[0],PAGE_TYPE:o.PAGE_TYPE,PAGE_NAME:o.PAGE_NAME,LOCATION:_r.getDataLayerLocation(i,a)}),n()},children:e.label})},Cft=T(Ot.TriggerSaltButton)`
    svg {
        pointer-events: none;
    }
`,Tft=T(Ot.Body)`
    overflow-y: hidden;
    white-space: normal;
    inline-size: max-content;
    max-inline-size: calc(50vi + 50% - 10px);
`,_ft=T(Ve.Item)`
    font-weight: bold;
`,vft=({levelTwoItem:e,isSEOReadableURLEnabled:t,meta:n,selectedNavigationItemIndexes:o})=>{const[r,a]=h.useState(!1),[i,l]=h.useState(!1),c=()=>{i&&(l(!1),a(!1))},d=()=>{l(!i),a(!1)},u=gP(c,[i]),m=typeof window<"u"?{rootMargin:"0px 0px 10000px 0px",threshold:.999,freezeOnceVisible:!0}:{rootMargin:"-80px 0px 0px 0px",threshold:.5},g=h.useRef(null),f=eC(g,m);return h.useCallback(()=>{const y=f&&!f.isIntersecting;i&&y&&a(!r)},[f]),s.jsxs(Ot.Container,{className:"salt-d--inline-block",ref:u,children:[s.jsx(Cft,{"data-test":`navigation-bar-dropdown-button-${e.id}`,intent:"secondary",size:"s",text:e.label,fill:!1,onClick:d,isOpen:i,"aria-expanded":i,"aria-haspopup":"true"}),s.jsx(Tft,{ref:g,isOpen:i,style:{right:r?"0px":void 0},children:s.jsx(Ot.Content,{children:s.jsxs(Ve,{inline:!1,children:[s.jsx(_ft,{"data-test":`navigation-bar-dropdown-item-${e.id}`,children:s.jsx(XB,{item:e,isSEOReadableURLEnabled:t,onItemClick:c,meta:n,index:e.index,itemLevel:1,selectedNavigationItemIndexes:o})}),e.items.map((y,I)=>s.jsx(Ve.Item,{"data-test":`navigation-bar-dropdown-item-${y.id}`,children:s.jsx(XB,{item:y,isSEOReadableURLEnabled:t,onItemClick:c,meta:n,itemLevel:2,index:I,selectedNavigationItemIndexes:[...o,e.index]})},`navigation-bar-dropdown-item-${y.id}`))]})})})]})},Aft=({levelTwoItem:e,isSEOReadableURLEnabled:t,meta:n,index:o,selectedNavigationItemIndexes:r,...a})=>{const i=Ea();if(e.isCurrentPage)return s.jsx(b,{intent:"secondary",size:"s",...a,children:e.label});const l=mc(e?.target,"NAV_BAR",{isSEOReadableURLEnabled:t}),c=Jp(e?.target),d=e?.target.linkType===Dt.ABSOLUTE_WEB_ADDRESS,u=()=>{i.reportNavigationItemClicked({CAMPAIGN_ID:n.CAMPAIGN_ID,CAMPAIGN_NAME:n.CAMPAIGN_NAME,ITEM_ID:e.id,ITEM_NAME:e.name,LABEL:e.label,ITEM_TYPE:"BUTTON",LEVEL:1,LINK_TYPE:e.target.linkType,LINK_VALUE:e.target.values[0],PAGE_TYPE:n.PAGE_TYPE,PAGE_NAME:n.PAGE_NAME,LOCATION:_r.getDataLayerLocation(r,o)})},m=()=>d?s.jsx(rt,{intent:"ghost",href:l,target:c,onClick:u,...a,children:s.jsx(b.Text,{children:e.label})}):s.jsx(Qe,{intent:"ghost",to:l??"",target:c,onClick:u,...a,children:s.jsx(b.Text,{children:e.label})});return s.jsx(b,{intent:"secondary",asChild:!0,size:"s",children:m()})},bft=T(Ve.Item)`
    margin-block-end: 0;
`,xft=(e,t,n,o)=>e.items.map((r,a)=>{const i=mc(r?.target,"NAV_BAR",{isSEOReadableURLEnabled:t}),l=Jp(r?.target),c=r?.target.linkType===Dt.ABSOLUTE_WEB_ADDRESS,{id:d}=r,u=`navigation-bar-tab-${r.id}`,m=`navigation-bar-tab-${r.id}`,g=r.isCurrentPage?void 0:i,f=r.isCurrentPage?void 0:()=>{o.reportNavigationItemClicked({CAMPAIGN_ID:n.CAMPAIGN_ID,CAMPAIGN_NAME:n.CAMPAIGN_NAME,ITEM_ID:r.id,ITEM_NAME:r.name,LABEL:r.label,ITEM_TYPE:"TAB",LEVEL:0,LINK_TYPE:r.target.linkType,LINK_VALUE:r.target.values[0],PAGE_TYPE:n.PAGE_TYPE,PAGE_NAME:n.PAGE_NAME,LOCATION:_r.getDataLayerLocation([n.SEQUENCE],a)})};return c?s.jsx(xa.Link,{id:d,isSSRNavigation:!0,"data-test":m,href:g,target:r.isCurrentPage?void 0:l||"_self",onClick:f,children:r.label},u):s.jsx(xa.Link,{id:d,isSSRNavigation:!0,"data-test":m,href:g,onClick:f,children:r.label},u)}),Rft=(e,t,n,o)=>s.jsx(se,{gap:["sm"],as:Ve,children:e.items.map((r,a)=>s.jsx(bft,{children:r.items.length>0?s.jsx(vft,{levelTwoItem:{...r,index:a},isSEOReadableURLEnabled:t,meta:n,selectedNavigationItemIndexes:o}):s.jsx(Aft,{levelTwoItem:r,isSEOReadableURLEnabled:t,"data-test":`navigation-bar-button-${r.id}`,meta:n,index:a,selectedNavigationItemIndexes:o})},`navigation-bar-button-${r.id}`))}),Dft=({data:e,meta:t})=>{const[n]=fe(["seo.rdbl"]),o=Ea(),r=e.items.find(c=>c.isActive||c.isCurrentPage),a=e.items.find(c=>c.isCurrentPage),i=e.items.findIndex(c=>c.id===r?.id),l=(r?.items||[]).length>0&&i!==void 0;return s.jsxs("div",{"data-test":"navigation-bar-tabs",children:[s.jsx(xa,{highlightedId:a?.id||"","data-test":"navigation-bar-carousel-carousel",className:"salt-m-y--4",children:xft(e,n,t,o)}),r&&l&&Rft(r,n,t,[t.SEQUENCE,i])]})},ZB=T.div`
    white-space: pre-wrap;
    word-wrap: break-word;
`,JB=T(rt)`
    align-items: center;
    display: flex;
    justify-content: space-between;
    padding-block: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-4);
    font-size: var(--salt-text-l-font-size);

    &:hover {
        text-decoration: ${({hasChildren:e})=>e?"none":"underline"};
    }

    &:focus {
        background-color: var(--intent-secondary-100);
    }
`,Oft=e=>{const t=e.parentElement?.previousSibling?.firstChild;t&&t.focus()},eU=(e,t)=>{const n=t==="next"?e.nextElementSibling:e.previousElementSibling;n&&n.focus()},Pft=(e,t,n)=>e.paneIndex===0&&e.paneIndex===t&&n===0?!0:e.paneIndex===t&&n===-1,Nft=({navigationItem:e,isSEOReadableURLEnabled:t,goToChildPane:n,paneOptions:o,activePaneIndex:r,index:a,meta:i,isLastItem:l,selectedNavigationItemIndexes:c,navigationBarId:d})=>{const u=Ea(),m=Pft(o,r,a);let g=null;h.useEffect(()=>{const I=m?setTimeout(()=>g?.focus(),100):void 0;return()=>{clearTimeout(I)}},[g,m]);const f=(I,S)=>{const C=I.key,_=I.code;l&&I.key==="Tab"&&!I.shiftKey?I.preventDefault():S&&(C==="Enter"||_==="Space"||C===" "||C==="ArrowRight")?(I.stopPropagation(),I.preventDefault(),n(r,e,a)):C==="ArrowUp"&&r===0&&a===0?document.getElementById(`navigation-bar-menu-button-${d}`)?.focus():C==="ArrowUp"&&a===-1?Oft(I.currentTarget):C==="ArrowUp"?eU(I.currentTarget,"previous"):C==="ArrowDown"&&eU(I.currentTarget,"next")},y=()=>{const I=e?.target?mc(e?.target,"NAVIGATION_BAR",{isSEOReadableURLEnabled:t}):"",S=o.parent?.id===e?.id,C=S||e.isCurrentPage||e.isActive,_=!!e.items.length&&!S&&r<2,A=_?0:void 0,x=`navigationitem-${e.id}_${o.paneIndex}`;return _?s.jsxs(JB,{"aria-haspopup":"true",role:"menuitem",onClick:R=>{R.stopPropagation(),R.preventDefault(),n(r,e,a)},onKeyDown:R=>f(R,!0),isSEOReadableURLEnabled:t,"data-test":x,hasChildren:_,tabIndex:A,ref:R=>{g=R},children:[s.jsx(ZB,{children:s.jsx(P,{className:"salt-d--inline",size:"l",bold:C,children:e.label})}),_&&s.jsx(me,{name:"arrow_right",height:16,width:16})]}):s.jsx(JB,{href:I,"aria-haspopup":"false",selected:o.selected,isSEOReadableURLEnabled:t,hasChildren:!1,"data-test":x,tabIndex:A,ref:R=>{g=R},onClick:()=>{u.reportNavigationItemClicked({CAMPAIGN_ID:i.CAMPAIGN_ID,CAMPAIGN_NAME:i.CAMPAIGN_NAME,ITEM_ID:e.id,ITEM_NAME:e.name,LABEL:e.label,ITEM_TYPE:"DROPDOWN_ITEM",LEVEL:o.paneIndex,LINK_TYPE:e.target.linkType,LINK_VALUE:e.target.values[0],PAGE_TYPE:i.PAGE_TYPE,PAGE_NAME:i.PAGE_NAME,LOCATION:_r.getDataLayerLocation(c,a===-1?void 0:a)})},onKeyDown:R=>f(R,!1),...e.target?.openInNewTab?{target:"_blank"}:{},children:s.jsx(ZB,{children:s.jsx(P,{className:"salt-d--inline",size:"l",bold:C,children:e.label})})})};return s.jsx(ie.Fragment,{children:y()})},vX=T(Nft)``,Lft=T.ul`
    list-style: none;
    margin: 0;
    padding: 0;
    position: relative;
    inline-size: 100%;
`,kft=({paneOptions:e,goToChildPane:t,activePaneIndex:n,isSEOReadableURLEnabled:o,meta:r,selectedNavigationItemIndexes:a,navigationBarId:i})=>{const l=e.parent;return l?s.jsx(vX,{isSEOReadableURLEnabled:o,goToChildPane:t,activePaneIndex:n,navigationItem:l,paneOptions:e,index:-1,meta:r,isLastItem:!1,selectedNavigationItemIndexes:a,navigationBarId:i},`navigationitem-${l.id}`):null},Mft=({paneOptions:e,goToChildPane:t,activePaneIndex:n,isSEOReadableURLEnabled:o,meta:r,selectedNavigationItemIndexes:a,navigationBarId:i})=>{const l=e.parent?.items;return l?l.map((c,d)=>s.jsx(vX,{isSEOReadableURLEnabled:o,goToChildPane:t,activePaneIndex:n,navigationItem:c,paneOptions:e,index:d,meta:r,isLastItem:d===l.length-1,selectedNavigationItemIndexes:a,navigationBarId:i},`navigationitem-${c.id}`)):null},jft=({paneOptions:e,goToChildPane:t,activePaneIndex:n,isSEOReadableURLEnabled:o,meta:r,selectedNavigationItemIndexes:a,navigationBarId:i})=>s.jsxs(Lft,{id:`navigation-bar-menu-${i}`,"aria-labelledby":`navigation-bar-menu-button-${i}`,children:[n!==0&&kft({paneOptions:e,goToChildPane:t,activePaneIndex:n,isSEOReadableURLEnabled:o,meta:r,selectedNavigationItemIndexes:a,navigationBarId:i}),Mft({paneOptions:e,goToChildPane:t,activePaneIndex:n,isSEOReadableURLEnabled:o,meta:r,selectedNavigationItemIndexes:a,navigationBarId:i})]}),wft=T(jft)``,Fft=T.div`
    background-color: var(--intent-contrast);
    box-sizing: border-box;
    overflow: hidden auto;
    backface-visibility: hidden;
    inline-size: 100%;
`,Bft=T.button`
    display: flex;
    flex-direction: row;
    align-items: center;
    inline-size: 100%;
    line-height: 0;
    background-color: transparent;
    border: none;

    &:hover,
    &:focus {
        background-color: var(--intent-secondary-100);
    }
`,Uft=({paneOptions:e,activePaneIndex:t,isSEOReadableURLEnabled:n,formatMessage:o,goToPreviousPane:r,goToChildPane:a,meta:i,selectedNavigationItemIndexes:l,navigationBarId:c})=>s.jsxs(Fft,{children:[e.paneIndex!==0&&e.paneIndex===t&&s.jsx(Kt,{breakpoint:"lg-up",children:s.jsxs(Bft,{className:"salt-p-y--4 salt-p-r--0 salt-p-l-4",type:"button",onFocus:d=>d.stopPropagation(),onClick:d=>{d.stopPropagation(),d.preventDefault(),r(t)},onKeyDown:d=>{const u=d.key;u==="Enter"||u==="Space"||u==="ArrowLeft"?(d.stopPropagation(),d.preventDefault(),r(t)):u==="ArrowDown"&&(d.currentTarget.parentElement?.nextSibling?.firstChild).focus()},"data-back-button":!0,children:[s.jsx(me,{verticalAlign:"middle",name:"arrow_left",height:18,width:18}),s.jsx("div",{className:"salt-m-r--2",children:s.jsx(P,{size:"l",className:"salt-d--inline-block",children:o.back})})]})}),s.jsx(wft,{paneOptions:e,activePaneIndex:t,isSEOReadableURLEnabled:n,goToChildPane:a,meta:i,selectedNavigationItemIndexes:l,navigationBarId:c})]}),Gft=({panes:e,isSEOReadableURLEnabled:t,formatMessage:n,activePaneIndex:o,goToPreviousPane:r,goToChildPane:a,meta:i,navigationBarId:l})=>{const c=[i.SEQUENCE,...e.filter(d=>d.selectedNavigationItemIndex!==void 0).map(d=>d.selectedNavigationItemIndex)];return s.jsx(h.Fragment,{children:e&&e.map(d=>s.jsx(Uft,{paneOptions:d,activePaneIndex:o,goToPreviousPane:r,goToChildPane:a,formatMessage:n,isSEOReadableURLEnabled:t,meta:i,selectedNavigationItemIndexes:c,navigationBarId:l},`paneindex${d.paneIndex}`))})},$ft=T.div`
    ${Dre("fixed","0px","0px","0px","0px")}
    ${Nb("transform .2s linear opacity")}
    background-color: rgb(0 0 0 / 75%);
    block-size: 100%;
    opacity: 0.7;
    inline-size: 100%;
    z-index: ${Qt.overlay};
`,Hft=T(Ot.TriggerSaltButton).withConfig({shouldForwardProp:e=>!["isOpen"].includes(e.toString())})`
    z-index: ${({isOpen:e})=>e?Qt["nav-menu"]-1:Qt["nav-button"]-1};
`,Vft=T(Ot.Content).attrs(({numberOfPanes:e,dropdownHeight:t,activePaneIndex:n})=>({style:{width:`${100*e}%`,maxHeight:t,transform:`translateX(calc(${n*(100/e)}% * var(--translate-direction)))`}}))`
    --translate-direction: -1;

    html[dir='rtl'] & {
        --translate-direction: 1;
    }

    display: flex;
    margin: 0;
    padding: 0;
    transition: transform 300ms ease-in-out;
    overflow-y: hidden;
`,Yft=T(Ot.Container)`
    position: relative;
`,Wft=T(Ot.Body)`
    z-index: ${Qt["nav-menu"]};
    inline-size: ${"calc(100vi - var(--salt-spacing-4))"};
    ${oe.smUp`
        max-width: 455px;
    `}
`,qft=T.div`
    ${oe.smUp`
        max-width: 455px;
    `}
`,Kft=3,zft=({data:e,meta:t})=>{const n=M(),o=h.useRef(null),r=Ea(),[a,i]=h.useState(!1),[l,c]=h.useState(0),[d,u]=h.useState("100vh"),[m,g]=h.useState("100vh"),[f,y]=h.useState(0),I=_r.getFormatMessage(n),[S]=fe(["seo.rdbl"]),C=_r.createRootNavigation(e.items);h.useLayoutEffect(()=>{if(a&&o.current){const{top:L}=o.current.getBoundingClientRect();y(L)}a&&wy()},[a]);const _=h.useMemo(()=>Math.min(Kft,_r.getNavigationItemsDepth(C)),[]),[A,x]=h.useState(()=>_r.getInitialNavigationPanes(_,C)),R=h.useCallback((L,B,W,$)=>{const K=Math.max(0,L+B);c(K),B===1&&W&&$!==void 0&&x(Q=>_r.increamentNavigationPanes(Q,K,W,$)),B===-1&&K!==0&&x(Q=>_r.decreamentNavigationPanes(Q,K)),K===0&&x(_r.getInitialNavigationPanes(_,C))},[l,x]),O=(L,B,W)=>{R(L,1,B,W)},N=h.useCallback(L=>{R(L,-1)},[]),k=h.useCallback(()=>{i(!0)},[]),j=h.useCallback(()=>{i(!1),c(0),Mu()},[]),w=()=>{let L;typeof window<"u"&&typeof document<"u"&&(L=window.innerHeight);const W=L?`${L}px`:"100vh";u(W)};return h.useEffect(()=>(w(),window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)),[]),h.useEffect(()=>{if(a){const L=f?f+25:0,B=`calc(${d} - ${H(L)})`;g(B)}},[d,a,f]),h.useEffect(()=>{a&&r.reportNavigationMenuClicked({TOTAL_ITEMS:e.items.length})},[a]),s.jsx(Kt,{breakpoint:"lg-up",display:"inline-block",children:s.jsxs(qft,{children:[s.jsx(Ee,{children:s.jsx(P,{children:I.browse})}),s.jsxs(Yft,{as:"nav","aria-label":I.browse,children:[a&&s.jsx($ft,{"data-test":"overlay",onClick:j}),s.jsx(Kt,{breakpoint:"lg-up",display:"inline-block",children:s.jsx(Hft,{intent:"secondary",text:I.browse,id:`navigation-bar-menu-button-${e.id}`,isOpen:a,title:I.attributeTitle,"data-test":"navigation-bar-mobile-button",onClick:()=>a?j():k()})}),a&&s.jsx(Wft,{isOpen:a,ref:o,children:s.jsx(Vft,{activePaneIndex:l,"data-test":"navigation-bar-mobile__dropdown-content",numberOfPanes:_,dropdownHeight:m,children:A&&s.jsx(Gft,{isSEOReadableURLEnabled:S,panes:A,formatMessage:I,activePaneIndex:l,goToPreviousPane:N,goToChildPane:O,meta:t,navigationBarId:e.id})})})]})]})})},Qft=T.div``,Xft=({data:e,meta:t})=>{const{pathname:n}=Ne(),o=h.useMemo(()=>_r.toNavigationBarData(n,e),[n]);return s.jsxs(Qft,{suppressHydrationWarning:!0,"data-test":`navigation-bar-${e.id}`,children:[s.jsx(Kt,{breakpoint:"lg-up",children:s.jsx(zft,{data:o,meta:t})}),s.jsx(cs,{breakpoint:"lg-up",children:s.jsx(Dft,{data:o,meta:t})})]})},Zft=({node:e,children:t,richTextId:n,analyticsEvents:o,pageName:r,pageType:a,location:i})=>{const l=()=>{o.reportRichTextLinkClicked({RICH_TEXT_ID:n,LINK_TYPE:"EXTERNAL WEB ADDRESS",LINK_VALUE:e.data.uri,PAGE_NAME:r,PAGE_TYPE:a,LOCATION:i})};return s.jsx("a",{href:e.data.uri,onClick:l,children:t})},Jft=(e,t,n,o,r)=>{let a;return{renderNode:{[un.BLOCKS.HEADING_1]:(i,l)=>s.jsx(ne,{as:"h2",children:l}),[un.BLOCKS.HEADING_2]:(i,l)=>s.jsx(ne,{as:"h2",children:l}),[un.INLINES.HYPERLINK]:(i,l)=>(a=a!==void 0?a+1:0,s.jsx(Zft,{node:i,richTextId:e,analyticsEvents:t,pageName:n,pageType:o,location:`${r}_${a}`,children:l}))}}},eyt=({data:e,meta:t})=>{const n=Ea(),o=Kd(()=>{const i={CAMPAIGN_ID:t.CAMPAIGN_ID,CAMPAIGN_NAME:t.CAMPAIGN_NAME,RICH_TEXT_ID:e.id,SEQUENCE:t.SEQUENCE};n.reportRichTextImpression(i)}),r=h.useMemo(()=>Jft(e.id,n,t.PAGE_NAME,t.PAGE_TYPE,t.SEQUENCE),[e]),a=h.useMemo(()=>$I.documentToReactComponents(JSON.parse(e.richText),r),[e]);return s.jsx(Y,{"data-test":`rich-text-${e.id}`,flush:!0,children:s.jsx(Y.Item,{colStart:{md:3,lg:4},colSpan:{xs:12,md:8,lg:6},children:s.jsx("div",{ref:o,children:a})})})},tyt=(e,t)=>t?t.slice(0,e).map(o=>o.items.length).reduce((o,r)=>+o+ +r,0):0,syt={getNumberOfPreviousCarouselTiles:tyt},Em={lg:"RATIO_2_1",md:"RATIO_2_1",sm:"RATIO_1_1",xs:"RATIO_1_1"},nyt=({data:e,meta:t})=>{const{formatMessage:n}=M(),o=ll(),r=Ea(),a=Kd(()=>r.reportGridImpression(t)),[i]=fe(["seo.rdbl"]),l=h.useMemo(()=>syt.getNumberOfPreviousCarouselTiles(t.SEQUENCE_BY_TYPE,t.COMPONENTIZED_ITEMS_BY_TYPE),[]);if(e.items.length===0)return null;const c=(m,g)=>{if(!m)return;const{id:f,label:y,altText:I,target:S,publishedAt:C}=e.items[g];r.reportGridItemImpression({ENTRY_ID:t.ENTRY_ID,ENTRY_NAME:t.ENTRY_NAME,GRID_ID:e.id,ENTRY_PUBLISHED_TIMESTAMP:C,ITEM_TYPE:"TILE_IMAGE",ITEM_ID:f,LABEL:y,ALT_TEXT:I,SEQUENCE:g,LINK_TYPE:S?.linkType||"",LINK_VALUE:S?.values[0]||""})},d=e.items.map((m,g)=>{const{id:f,name:y,label:I,description:S,altText:C}=m,_=mc(m?.target,"CAROUSEL_IMAGE",{isSEOReadableURLEnabled:i}),A=Jp(m?.target),x=o==="sm"||o==="xs"?"small":"normal",R={xs:ko(m?.images,Em.xs),sm:ko(m?.images,Em.sm),md:ko(m?.images,Em.md),lg:ko(m?.images,Em.lg)},O=m?.images?.find(N=>N.assetSize===Em.lg)?.url||"";return s.jsx(N$,{triggerOnce:!0,className:"salt-d--inline",onChange:N=>{c(N,g)},"data-test":"carouselTile",children:s.jsx(He.MediaNavigationCard,{variant:"fullImage",formatting:x,title:I,dynamicHeight:!0,breakpointSrcSet:R,fallbackSrc:O,alt:C,content:S,href:_,target:A,onClick:()=>{r.reportCarouselItemClicked({ENTRY_ID:t.ENTRY_ID,ENTRY_NAME:t.ENTRY_NAME,GRID_ID:e.id,ITEM_ID:m.id,ITEM_NAME:y,ITEM_TYPE:"TILE_IMAGE",LINK_TYPE:m.target?.linkType||"",LINK_VALUE:m.target?.values[0]||"",PAGE_NAME:t.PAGE_NAME,SEQUENCE:g,SEQUENCE_OF_ITEM_ON_PAGE:l+g})}})},f)}),u={labels:{"next-button":n("scroller.accessibility.viewNextIn",{title:e.label}),"previous-button":n("scroller.accessibility.viewPreviousIn",{title:e.label})}};return s.jsx(oi,{spacing:4,a11y:u,ref:a,navigationButtonPosition:"header",title:s.jsx(oi.Title,{children:e.label}),children:d})},oyt={"carousel-container":"_carousel-container_1gpaj_1"},uf=Wl.bind(oyt),ryt=({items:e,item:t,id:n,name:o,index:r,meta:a,isLastComponent:i})=>{switch(t.componentType){case"HERO_IMAGE_CONTAINER":return s.jsx("div",{className:uf({"salt-m-b--2 md:salt-m-b--4":!i}),children:s.jsx(VEt,{data:t,meta:{BANNER_PLACEMENT:a.BANNER_PLACEMENT,ENTRY_ID:n,ENTRY_NAME:o,HERO_IMAGE_ID:t.id,LOCATION:a.LOCATION,SEQUENCE:r,PAGE_TYPE:a.PAGE_TYPE,ENTRY_PUBLISHED_TIMESTAMP:a.ENTRY_PUBLISHED_TIMESTAMP,PAGE_NAME:a.PAGE_NAME}})});case"GRID_CONTAINER":return s.jsx("div",{className:uf({"salt-m-b--2 md:salt-m-b--4":!i}),children:s.jsx(pft,{data:t,meta:{GRID_TYPE:"Grid",GRID_ID:t.id,ENTRY_ID:n,ENTRY_NAME:o,GRID_LAYOUT:t.layout,SEQUENCE:r,SEQUENCE_BY_TYPE:df.getSequenceByType(e,"GRID_CONTAINER",r),COMPONENTIZED_ITEMS_BY_TYPE:df.getComponentizedItemsByType(e,"GRID_CONTAINER"),PAGE_TYPE:a.PAGE_TYPE,ENTRY_PUBLISHED_TIMESTAMP:a.ENTRY_PUBLISHED_TIMESTAMP,PAGE_NAME:a.PAGE_NAME}})});case"CAROUSEL_CONTAINER":return s.jsx("div",{className:uf({"carousel-container":!0,"salt-m-b--2 md:salt-m-b--4":!i}),children:s.jsx(nyt,{data:t,meta:{GRID_TYPE:"Carousel",GRID_LAYOUT:t.items.length,ENTRY_ID:n,GRID_ID:t.id,ENTRY_NAME:o,SEQUENCE:r,SEQUENCE_BY_TYPE:df.getSequenceByType(e,"CAROUSEL_CONTAINER",r),COMPONENTIZED_ITEMS_BY_TYPE:df.getComponentizedItemsByType(e,"CAROUSEL_CONTAINER"),ENTRY_PUBLISHED_TIMESTAMP:a.ENTRY_PUBLISHED_TIMESTAMP,PAGE_NAME:a.PAGE_NAME}})});case"NAV_BAR":return s.jsx("div",{className:uf({"salt-m-b--2 md:salt-m-b--4":!i}),children:s.jsx(Xft,{data:t,meta:{CAMPAIGN_ID:n,CAMPAIGN_NAME:o,NAVIGATION_BAR_ID:t.id,SEQUENCE:r,PAGE_TYPE:a.PAGE_TYPE,PAGE_NAME:a.PAGE_NAME}})});case"RICH_TEXT":return s.jsx(eyt,{data:t,meta:{PAGE_TYPE:a.PAGE_TYPE,PAGE_NAME:a.PAGE_NAME,CAMPAIGN_ID:n,CAMPAIGN_NAME:o,SEQUENCE:r}});default:return null}},AX=({items:e,id:t,name:n,meta:o})=>s.jsx(h.Fragment,{children:e.map((r,a)=>{const i=e.length-1===a;return s.jsx(h.Fragment,{children:ryt({item:r,id:t,name:n,index:a,items:e,meta:o,isLastComponent:i})},r.id)})}),ayt=({items:e=[],id:t,name:n,meta:o})=>{const r=Ea();return h.useEffect(()=>{const{totalGrids:a,totalHeroImages:i,totalCarousels:l}=e.reduce((c,d)=>{switch(d.componentType){case"HERO_IMAGE_CONTAINER":return{...c,totalHeroImages:c.totalHeroImages+1};case"GRID_CONTAINER":return{...c,totalGrids:c.totalGrids+1};case"CAROUSEL_CONTAINER":return{...c,totalCarousels:c.totalCarousels+1};default:return c}},{totalGrids:0,totalHeroImages:0,totalCarousels:0});r.reportComponentizedAttributes({TOTAL_GRIDS:a,TOTAL_HERO_IMAGE_BANNERS:i,TOTAL_CAROUSELS:l,ENTRY_ID:t})},[e]),s.jsx(AX,{id:t,items:e,name:n,meta:{PAGE_TYPE:o.PAGE_TYPE,PAGE_NAME:o.PAGE_NAME,BANNER_PLACEMENT:o.BANNER_PLACEMENT,LOCATION:o.LOCATION,ENTRY_PUBLISHED_TIMESTAMP:o.ENTRY_PUBLISHED_TIMESTAMP}})},iyt=()=>{const e=F(),t=h.useCallback(a=>{const i={ecommType:"enhanced",event:"view_promotion",eventCategory:"Shop in Shop page",eventAction:"HERO_IMAGE_BANNER_IMPRESSION",ecommerce:{promoView:{promotions:[{promotionType:"Shop in Shop",id:a.id,name:a.name,creative:a.imageId,position:"Hero Image"}]}}};return J.sendEvent({GA:i,WA:null}),e(U.analyticsEvent({type:Qr.HORIZONTAL_HERO_BANNER_IMPRESSION,...a}))},[e]),n=h.useCallback(a=>{const i={event:"view_promotion",ecommType:"enhanced",eventCategory:"Shop in Shop page",eventAction:"SUB_CATEGORY_IMAGE_IMPRESSION",ecommerce:{promoView:{promotions:[{promotionType:"Shop in Shop",id:a.id,name:a.subCategoryName,creative:a.imageId,position:`Sub category image ${a.sequence}`}]}}};return J.sendEvent({GA:i,WA:null}),e(U.analyticsEvent({type:Qr.SUB_CATEGORY_IMAGE_IMPRESSION,...a}))},[e]),o=h.useCallback(a=>{const i={event:"select_promotion",ecommType:"enhanced",eventCategory:"Shop in Shop page",eventAction:"SUB_CATEGORY_IMAGE_CLICKED",ecommerce:{promoClick:{promotions:[{promotionType:"Shop in Shop",id:a.id,name:a.subCategoryName,creative:a.imageId,position:`Sub category image ${a.sequence}`}]}}};J.sendEvent({GA:i,WA:null}),e(U.analyticsEvent({type:Qr.SUB_CATEGORY_IMAGE_CLICKED,...a}))},[e]),r=h.useCallback(a=>{const i={event:"view_shop_in_shop",name:a.name,id:a.id,type:a.pageType};J.sendEvent({GA:i,WA:null}),e(U.analyticsEvent({type:Qr.SHOP_IN_SHOP_PAGE_VIEW,...a}))},[e]);return{reportHorizontalHeroImpression:t,reportSubCategoryImpression:n,reportSubCategoryClick:o,reportPageView:r}},lyt={id:"",name:"",label:"",componentItems:[]},bX=({label:e,componentItems:t,id:n,name:o})=>{const r=iyt();return h.useEffect(()=>{r.reportPageView({event:"view_shop_in_shop",name:o??"",id:n,pageType:"category"})},[]),s.jsxs("div",{className:"salt-m-t--2 salt-m-r--2 salt-m-l--2","data-test":"sis-category-componentized",children:[e&&s.jsx(ne,{as:"h1","data-test":"sis-label",className:"salt-m-t--4 salt-m-b--4",children:e}),s.jsx(ayt,{items:t,id:n,name:o,meta:{PAGE_TYPE:"category",PAGE_NAME:"shop_in_shop",BANNER_PLACEMENT:"ABOVE_GRID",LOCATION:"SHOP_PRODUCTS"}})]})};bX.defaultProps=lyt;const cyt=ie.memo(bX,function(t,n){return t.id===n.id}),xX=e=>t=>t(D3e.fetchCategoryPageRecipeAdverts(e)).catch(()=>{}),dyt=ee("GET_CATEGORY_PAGE_ADVERTS"),RX=e=>({type:"API",payload:{url:`/v1/content?${tt.stringify({page:"CATEGORY",key:e},{sort:!1})}`,...dyt}}),DX=e=>{if(e==="products"||e==="categories")return{};const n=(e?.endsWith("/")?e.slice(0,-1):e)?.split("/")??[],o=n.pop();return{sublocationId:o?.length?o:void 0,fullCataloguePath:n.length?n.join("/"):void 0}},OX=D("seo.rdbl"),uyt=D("cat.evt"),cb=D("seo.ra"),PX=D("rec"),pyt=D("bt.top"),myt=()=>{const e=M(),t=ho(),n=Ne(),o=We(),r=co(),{sublocationId:a}=DX(r["*"]),i=E(OX),l=E(uyt),c=E(cb),d=E(PX),u=E(Ip),m=E(KPe),g=E(_d),f=E(mlt),y=E(N3e),I=E(pyt),S=E(og),C={allProducts:e.formatMessage("navigation.products")},_=l&&m,A=_&&m.contentFormat!=="COMPONENTIZED",x=_&&m.contentFormat==="COMPONENTIZED",R=!!(x&&m?.componentItems?.length||A&&g?.length),O=nE(),N=()=>{t(ks({name:_?jTe:MTe,variant:_?"shop-in-shop":void 0}))},k=L=>i?a:L.sublocationId,j=({category:L=void 0,sortOption:B=void 0,filters:W={},fullURLPath:$=""}={})=>{const K=ES({...!i&&{category:L},filters:W,sortOption:B});if(i){const Q=$.toLowerCase();return Ui(L,Q,{queryString:K})}return jo({queryString:K})},w=({category:L,nextPageToken:B})=>t(xwe({uri:"/v6/products",category:L,pageToken:B,isRetailerCategoryId:c})).then(W=>{!S&&W&&W.nextPageToken&&W.productCount===0&&w({category:L,nextPageToken:W.nextPageToken})});return s.jsxs(h.Fragment,{children:[A&&s.jsx(nL,{id:m.id,name:m.name,label:m.label,contentFormat:m.contentFormat,images:m.images,html:m.html,breadCrumbs:g}),x&&s.jsx(cyt,{id:m.id,label:m.label,name:m.name,componentItems:m.componentItems}),s.jsx(yEt,{rootpageTitle:"search.categories.title",subpageTitle:"categories.subpage.title",seoFriendlyMeta:{metaDescriptionTagline:"category.meta.descriptionTagline",metaSubDescriptionTagline:"subcategory.meta.descriptionTagline"}}),s.jsx(CT,{navigate:o,enableRegionAgnosticCategoriesPerSection:!0,hideBreadcrumb:R,fetchPage:({category:L,filters:B,sortOption:W})=>(t(RX(L)).catch($=>{Me.api.pushError($)}),d&&L&&t(xX(L)).catch($=>{Me.api.pushError($)}),t(PW({uri:"/v6/products",category:L,filters:B,sortOption:W,isRetailerCategoryId:c}))),page:"categories",getTargetUrl:L=>j(L),rootBreadcrumb:{name:C.allProducts,url:j()},location:n,noProductsFilteredPage:({clearFilters:L,term:B})=>s.jsx(TT,{clearFilters:L,page:"categories",term:B}),noProductsPage:({term:L})=>s.jsx(yX,{page:"categories",term:L}),pageError:u,onInitialFopLoad:N,matchSublocationId:k,showSortAndFilters:!0,withinGridProductCards:[...f,...y],fetchNextPage:w,shouldShowScrollToTopButton:I?!1:O}),I&&s.jsx(_T,{})]})},ay=()=>s.jsx(os,{type:"Categories::route",children:s.jsx(myt,{})});ay.fetchData=async({context:{store:e,url:t},params:n})=>{const o=e.getState(),r=DX(n["*"]),a=us.parse(t.search),i=t.searchParams.get("sublocationId")??"",l=i||r.sublocationId,c=t.searchParams.get("sortBy")??"",d=fp(us.parse(t.search)),m=`${decodeURIComponent(t.pathname)}${t.search}`,g=m.split("?")[1],f=Wt(o),I=[PW({uri:"/v6/products",category:l,filters:d,sortOption:c,isRetailerCategoryId:cb(o)}),RX(l),...PX(o)&&l?[xX(l)]:[]];if(cb(o)){await e.dispatch(ft.getCategoryEntity({queryString:`id=${l}`}));const A=z1(e.getState()),x=i?cA(a):g;if(A?.retailerId&&l!==A?.retailerId){const R=A?.encodedName.toLowerCase(),O=Ui(A?.retailerId,R,{queryString:x,basePath:f});return Promise.resolve({redirectTo:O,statusCode:ai.MOVED_PERMANENTLY})}}await Promise.allSettled(I.map(A=>e.dispatch(A)));const S=`${t.pathname}${t.search}`,C=f?.length?S.replace(f,""):S;e.dispatch(ft.setLastFetchedCatalogueLocation(C));const _=Ip(e.getState());if(OX(o)&&!_){const A=xx(e.getState()),x=l?cA(a):g,R=Ui(l,A,{queryString:x,basePath:f});if(m.toLowerCase()!==R.toLowerCase()){const O=A.toLowerCase(),N=Ui(l,O,{queryString:x,basePath:f});return Promise.resolve({redirectTo:N,statusCode:ai.MOVED_PERMANENTLY})}}return Promise.resolve()};const tU=D("showpromopage"),hyt=e=>[{path:"/products",Component:e.Main,key:"main",children:[{index:!0,Component:ay}]},{path:"/categories",Component:e.Main,key:"main",children:[{index:!0,Component:ay},{path:"*",Component:ay}]},{path:"/favorites",Component:e.Main,key:"main",children:[{index:!0,Component:ws(Ze,hX)}]},{path:"/promotions",Component:e.Main,key:"main",children:[{index:!0,Component:Xt(tU,ib,lt)},{path:"*",Component:Xt(tU,ib,lt)}]}],NX=()=>{const e=E(iS),t=e?sr({inCheckoutWalk:!1,shippingGroupType:e}):jt();return s.jsx(Qn,{to:t})},LX=()=>{const e=E(n=>n.router.location.search),t=!!us.parse(e)[$c];return s.jsx(Qn,{to:tr({queryString:t?SD:""})})},gyt=()=>{const e=E(wYe),t=E(o=>o.router.location.search),n=!!us.parse(t)[$c];return e?s.jsx(Qn,{to:Xh({pageKey:e,queryString:n?SD:""})}):s.jsx(LX,{})},Eyt=1,kX=()=>{const e=F(),{actions:t}=ot({performanceMark:ks})(e);return t.performanceMark},em=()=>{const e=Ne(),t=E(t4(e)),n=E(wd),o=E(e4),r=t&&t.pageIndex+1,a=r&&n?.data?.pages?.[r];return{currentPage:t,nextPage:a?{...a,pageIndex:r}:void 0,numberOfPages:o+Eyt,shouldRefetch:n.data?.shouldRefetch,isFetching:n.isFetching}},MX=()=>{const e=kX(),t=E(wd),{currentPage:n}=em();return o=>n&&t?.data?.pages?.[n.pageIndex+1]?e({name:HTe,attributes:{pageIndex:n.pageIndex},event:o}):e({name:YTe,event:o})},jX=()=>{const e=F(),{currentPage:t}=em(),n=E(At);if(t&&t.productGroups.find(o=>o.freeGifts)){const{productGroups:o}=t;let r=0;const a=o.find(i=>i.freeGifts)?.freeGifts?.promotions?.reduce((i,l)=>{for(const c of l.products)c.selected&&(r+=1);return{allCount:i.allCount+l.products.length,selectedCount:r}},{allCount:0,selectedCount:0});return()=>{e(U.analyticsEvent({type:Kn.CONTINUE_SHOPPING_CLICKED,description:"Checkout walk continue checkout button clicked",pageEventAttributes:{orderId:n,availableGifts:a?.allCount,selectedGifts:a?.selectedCount}}))}}return()=>{}},wX=()=>{const e=M();return{title:e.formatMessage({id:"checkout.walk.progress.title"}),button:e.formatMessage({id:"checkout.walk.next"}),next:e.formatMessage({id:"checkout.walk.next"}),notice:e.formatMessage({id:"checkout.walk.scroll.notice"})}},FX=()=>E(D("cs.prind")),fyt=({productGroup:e,shouldDisplayGroupTitle:t=!0})=>{const n=kX(),o=E(wd),r=E(Ts),{engine:a,groupTitle:i}=e,l=Ne(),c=xO(l);return s.jsxs(h.Fragment,{children:[t&&i?s.jsx("div",{className:"salt-m--2","data-test":`checkout-walk-fop-group-${i}-title`,children:s.jsx(P,{asChild:!0,size:"l",bold:!0,children:s.jsx("h2",{children:i})})}):s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:i})}),s.jsx("div",{className:"salt-m-x--2","data-test":`checkout-walk-fop-group-${i}`,children:s.jsx(Xp,{onInitialFopLoad:()=>n({name:VTe}),productGroups:[{...e,section:a}],productsByProductId:r,page:`checkout-walk-${ri(c)}`,type:"catalogue",isFetching:o.isFetching,showMissedPromotions:a==="MISSED_PROMOTIONS"})})]},a)},yyt=({productGroup:e,shouldDisplayGroupTitle:t=!0})=>s.jsx(os,{type:"CheckoutWalkFopGroup::route",children:s.jsx(fyt,{productGroup:e,shouldDisplayGroupTitle:t})}),Iyt=T(Y.Item)``,Syt=T(Y)`
    @media (min-width: ${Ke.sm}em) {
        grid-template-columns: repeat(auto-fill, minmax(300px, 344px));
    }
    @media (max-width: ${Ke.sm}em) {
        grid-template-columns: none;
    }
`,Cyt=({productGroup:e,pageSubtitle:t})=>{const n=F(),{formatMessage:o}=M(),r=E(wd),a=Ne(),i=xO(a),l=E(FYe()),{freeGifts:c,groupTitle:d}=e;let u=[];c?.promotions.forEach(f=>{const y=f.products.map(I=>I.productId);u=[...u,...y]}),h.useEffect(()=>()=>{n(NW(u))},[]),h.useEffect(()=>{n(U.analyticsEvent({type:Kn.CHECKOUT_WALK_FREE_GIFT,location:a}))},[n,a]);const m=c?.allPromotionsUsageLimit!=null?c.allPromotionsUsageLimit:l.availableProductsCount,g=(f,y)=>y>0?o("free.gift.campaign.limit.any.selected",{selected:y,count:f}):o("free.gift.campaign.limit.none.selected",{count:f});return s.jsxs(h.Fragment,{children:[s.jsx("h2",{className:"salt-m-x--2","data-test":"checkout-walk-free-gifts-all-counter","aria-label":o("free.gift.total.limit.accessibility",{selected:l.allSelectedCount,total:m}),children:o("free.gift.total.limit",{selected:l.allSelectedCount,total:m})}),t&&s.jsx(P,{asChild:!0,className:"salt-m-x--2 salt-m-y--4",children:s.jsx("p",{children:t})}),c?.promotions.map(({promotionUsageLimit:f,promotionId:y,products:I},S)=>{const C=f??I.length,_=I.map(N=>N.productId),A=l.allSelectedCount>=m,x=!!l?.[y]&&l[y]>=C,R=I.reduce((N,k)=>({...N,[k.productId]:k.selected}),{}),O=()=>s.jsx(Syt,{flush:!0,children:I.map(({productId:N},k)=>s.jsx(Iyt,{children:s.jsx(ka,{productId:N,group:{products:_,type:"products",section:"free_gift",name:`free-gifts-${N}`,clusterBreadcrumbs:[],gifts:{isAllPromotionsLimitReached:A,isSinglePromotionLimitReached:x,selectedGifts:R},groupTitle:d,promotionId:y},position:k,page:`checkout-walk-${i}`,subPage:null,noOfferLink:!1,type:"products",withoutHeader:!0,displayLandscapeLayout:!0,fopPositionOnPage:k,sendFopImpression:!0,loading:r.isFetching})},N))},y);return s.jsx("div",{className:"salt-m-x--2",children:c?.promotions.length>1?s.jsxs(is,{children:[s.jsx(is.Title,{active:!0,children:s.jsx(P,{asChild:!0,size:"l",bold:!0,children:s.jsx("h2",{"aria-label":o("free.gift.campaign.limit.accessibility",{selected:l?.[y],total:f,index:S+1}),children:g(f,l?.[y]??0)})})}),s.jsx(is.Content,{active:!0,className:"salt-p-x--0",children:O()})]}):s.jsx(ie.Fragment,{children:O()})},y)})]})},Tyt=e=>s.jsx(os,{type:"CheckoutWalkFreeGifts::route",children:s.jsx(Cyt,{...e})}),rL=({handleRedirect:e,onContinueClick:t=()=>{}})=>{const{next:n}=wX(),o=MX(),r=jX(),a=h.useCallback(()=>{o(),r(),t()},[o,t,r]);return s.jsx(b,{intent:"action",fill:!0,asChild:!0,onClick:a,"data-test":"checkout-walk-crumbs-link",children:s.jsx(Qe,{to:e(),intent:"ghost",children:s.jsx(b.Text,{children:n})})})};rL.propTypes={handleRedirect:p.func.isRequired,onContinueClick:p.func};rL.defaultProps={onContinueClick:()=>{}};const _yt=D("barv2"),vyt=()=>{const e=E(wd),{currentPage:t}=em(),n=M(),o={position:(e.data.pages.length+1).toString(),name:n.formatMessage({id:"checkout.progress.payment"}),selected:!1},r=(a,i)=>({position:(i+1).toString(),name:a,selected:i===t?.pageIndex});return e?.data?.pages?[...e.data.pages.map(a=>a.pageShortName).map(r),o]:[]},Ayt=({label:e,onClick:t=()=>{},url:n,"data-test":o})=>{const r=vyt(),a=E(_yt);return s.jsx(cD,{"data-test":o,trail:r,v2Enabled:a,messages:e,onClick:t,url:n})},byt=({children:e,handleRedirect:t,pageTitle:n,pageName:o})=>{const r=MX(),a=jX(),{button:i,notice:l,title:c}=wX(),{currentPage:d,numberOfPages:u}=em(),m=FX(),{formatMessage:g}=M(),f=(d?.pageIndex||0)+1,y=`${f}/${u}`,I=A=>{a(),r(A)},S=s.jsx(ne,{as:"h1","data-test":"checkout-walk-page-name",children:o}),C=s.jsx(rL,{handleRedirect:t}),_=g("checkout.walk.progress.title",{step:f,numberOfSteps:u,alternativePageName:o});return s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:n,skipFormatTitle:!0}),s.jsx(An,{children:m?s.jsx(ga,{progressFraction:y,overrideText:S,ariaText:_,ringContent:s.jsx(P,{size:"l",bold:!0,children:y})}):S}),s.jsx(Kt,{breakpoint:"sm-up",children:s.jsx(Ce,{intent:"action",className:"salt-m-x--2 salt-m-b--4",text:l,showIcon:!1})}),e,s.jsxs(h.Fragment,{children:[s.jsx(Kt,{breakpoint:"sm-up",children:s.jsx("div",{className:"salt-m--2",children:C})}),s.jsx(cs,{breakpoint:"sm-up",children:s.jsx(Ayt,{"data-test":"checkout-walk-crumbs",label:{button:i,title:c},onClick:I,url:t()})})]})]})},xyt=e=>s.jsx(os,{type:"CheckoutWalkCrumbsLayout::route",children:s.jsx(byt,{...e})}),Ryt=()=>{const e=F(),{actions:t}=ot({analyticsEvent:U.analyticsEvent})(e);return t.analyticsEvent},Dyt=()=>{const e=F();return{checkoutWalkGa4Event:n=>{const o=U.analyticsEvent({type:Kn.CHECKOUT_WALK_GA4,...n}),r={event:"checkout_walk",index:n.index??null,name:n.name??null,currency:n.currency??null,value:n.value?Number(n.value):null,osp_transaction_id:n.transactionId,group_id:n.groupId};return J.sendEvent({GA:r,WA:null}),e(o)}}},AT=()=>E(e=>pa(e)),oE=()=>E(e=>gp(e)),aL=()=>E(e=>Mr(e)),iL=()=>E(At)||"",BX=()=>E(e=>cS(e)),UX=()=>E(e=>ox(e)),Oyt=()=>{const e=AT(),t=BX();return!!(t&&e&&Number(e.amount)<Number(t.amount))},GX=()=>E(e=>Hie(e)),Pyt=()=>Vp(Dn(["sumsub","bt.spl"])),$X=()=>E(e=>W0(e)),Nyt=()=>{const e=ze(),t=$X();return t?e(t):""},Lyt=()=>{const{pathname:e}=Ne(),t=iL(),n=aL();return!!Or({path:gn(t),end:!1},e)&&n},kyt=()=>{const e=Ne();return new URLSearchParams(e.search).get("in-checkout-walk")==="true"},bT=()=>{const{pathname:e}=Ne(),t=Lyt(),n=kyt(),o=[jt(),kr(),sc()].some(a=>Or({path:a,end:!1},e)),r=![CR(),Zh()].some(a=>Or({path:a,end:!1},e));return o&&r||t||n},Myt=()=>{const{pathname:e}=Ne();return!!Or({path:Xh(),end:!1},e)},jyt=()=>{const{pathname:e}=Ne();return!!Or({path:jt(),end:!1},e)},rE=()=>{const e=bT(),t=Myt();return!Pyt()&&e&&!t},tm=()=>{const e=ze(),t=AT();return t?e(t):"?"},lL=()=>{const e=ze();return h.useCallback(t=>e(t),[e])},wyt=()=>{const e=M(),t=lL();return h.useCallback((n,o)=>e.formatMessage(n,{amount:t(o)}),[t,e])},Fyt=()=>{const e=E(Dn(["hhmin","bt.spl"])),t=UX(),n=wyt(),o=BX(),r=!e&&t&&o&&Number(o?.amount||0)>.01,a=rE(),i=GX(),l=$X(),c=lL(),d=ps({breakpoint:"sm-up"});return r?{type:"action",message:d?c(o):n("header.order.status.minimum.order.short",o),"data-test":"checkout-threshold"}:!a&&i&&l?{type:"promotion",message:d?c(l):n("header.order.status.savings",l),"data-test":"savings"}:null},Byt=()=>{const e=F();return h.useCallback(t=>e(ks({name:BTe,event:t,attributes:{}})),[e])},cL=()=>{const e=aL(),t=iL();return e?gn(t):jt()},HX=()=>E(e=>Y0(e)),dL=()=>{const e=E(D("exptr")),t=bT(),n=ps({breakpoint:"sm-up"});return e&&!t&&!n},Uyt=()=>{const e=M(),t=rE(),n=tm(),o=dL(),r=t?e.formatMessage("header.topbar.basket.button.aria.label"):`${e.formatMessage("basket.button.alternative")} ${n}`,a=e.formatMessage(o?"basket.button.open.expanded.trolley.alternative":"basket.button.open.basket.page.alternative");return`${r} - ${a}`},VX=()=>{const e=rE();return{name:aL()?"orders_edit":"trolley",hidePrice:e}},Gyt=()=>{const e=rE(),t=oE();return t>0&&!e?{type:"action",value:t,"data-synthetics":"basket-item-counter","data-test":"basket-counter","aria-hidden":"true"}:null},$yt=()=>!bT(),Hyt=()=>{const e=dL(),t=Vwe(),n=Byt(),o=cL();return e?{onClick:()=>{t()}}:{to:o,onClick:()=>{n()}}},uL=()=>E(e=>Fo(e)),Vyt=()=>{const e=Ryt(),{currentPage:t}=em(),{checkoutWalkGa4Event:n}=Dyt(),o=E(At),r=E(pa),a=uL(),i=(c,d)=>{e({type:As.PAGE_ATTRIBUTES_MULTIPLE,attributes:{CHECKOUT_WALK_PAGE_NAME:t?.pageName,CHECKOUT_WALK_PAGE_SECTION:c.groupTitle,CHECKOUT_WALK_PAGE_SECTION_INDEX:d,CHECKOUT_WALK_PAGE_INDEX:t?.pageIndex,CHECKOUT_WALK_SECTION_PRODUCTS_ENGINE:c.engine}})},l=()=>{n({index:t?.pageIndex,name:t?.pageShortName,currency:r?.currency,value:r?.amount,transactionId:o,groupId:a})};return()=>{t?.productGroups?.forEach(i),l()}},Yyt=()=>{const e=F(),{pathname:t}=Ne(),{currentPage:n,nextPage:o,shouldRefetch:r}=em(),a=Vyt(),i=h.useRef(!0),l=()=>{if(o){const{pageKey:f}=o;return Xh({pageKey:f})}return tr()};if(h.useEffect(()=>{a()},[t]),h.useEffect(()=>(r&&i.current&&(e(YP()),i.current=!1),()=>{e(br.clearCheckoutWalk())}),[e,r]),!n)return s.jsx(Qn,{to:tr()});const{productGroups:c,pageName:d,pageDescription:u}=n,m=c.length>1,g=c.find(f=>f.freeGifts);return s.jsx(xyt,{handleRedirect:l,pageName:d,pageTitle:u,children:g?s.jsx(Tyt,{productGroup:g,pageSubtitle:n.pageSubtitle}):c.map((f,y)=>s.jsx(yyt,{productGroup:f,shouldDisplayGroupTitle:m},f.freeGifts?.promotions[y]?.promotionId))})},Wyt=()=>s.jsx(os,{type:"CheckoutWalk::route",children:s.jsx(Yyt,{})}),qyt=()=>(e,t)=>{const n=rr(t());return e(Lf.getWalletItems(n))},sm={getWalletItems:qyt},Kyt=(e,t,n=100)=>(Math.round(+e*n)+Math.round(+t*n))/n,YX=e=>e.data.orderPayment?.paymentMethodGroups?.data?.overridePaymentMethodGroups,WX=e=>e.data.orderPayment.orderPaymentCheckoutSummary.data,qX=e=>e.data.orderPayment.orderPaymentCheckoutSummary.isFetching||e.data.orderPayment.orderPaymentCheckoutSummaryWithPaymentMethodGroups.isFetching,pL=e=>D("pcs.v2")(e)?e.data.orderPayment.orderPaymentCheckoutSummaryWithPaymentMethodGroups.data?.totalBufferRate:e.data.orderPayment.orderPaymentCheckoutSummary.data?.totalBufferRate,KX=e=>e.data.orderPayment.orderMultiPayments.data?.payments.filter(t=>t.paymentMethod.category==="MONETARY");V(KX,e=>e?.reduce((t,n)=>Kyt(t,n.total.amount),0));const mL=e=>e.data.orderPayment.orderMultiPayments.data?.payments.filter(t=>t.paymentMethod.category==="LOYALTY"),zX=e=>e.data.orderPayment.orderMultiPayments.data?.payments||[],QX=e=>e.data.orderPayment.orderMultiPayments.data?.total,XX=e=>e.data.orderPayment.orderPaymentCheckoutSummaryWithPaymentMethodGroups.data,hL=V(XX,e=>e?.paymentMethodGroups),zyt=V(hL,e=>e?.find(t=>t.name===ct.LOYALTY&&t.available)),Qyt=({state:e,request:t})=>{const{endpoint:n,httpMethod:o,body:r}=t,a=Ii({basePath:Wt(e),target:n}),i=JSON.stringify(r),l={"client-route-id":wa(e),"X-CSRF-TOKEN":Va(e),...i&&{"content-type":"application/json; charset=utf-8"}};return fetch(a,{method:o,credentials:"same-origin",headers:l,body:i}).then(c=>c.ok?c.json():Promise.reject(c))},Xyt=e=>e.map(({codeName:t})=>({type:t})),Zyt=e=>(t,n)=>{const o=n(),i={endpoint:`/payospgateway/v1/active-psps?${tt.stringify({paymentFlow:e})}`,httpMethod:"GET"};return Qyt({state:o,request:i}).then(l=>{const c=Xyt(l);return t(c6.pspsFetched(e,c)),c})},ZX={fetchActivePsps:Zyt},sU=e=>e?e.sort((t,n)=>rh(t.expiryDate)-rh(n.expiryDate)):[],Jyt=e=>{const{availablePaymentChecks:t,checksMissingRequiredTotal:n,maxAmountPayableByPaymentCheck:o}=e?.payload?.responseData||{};return Promise.resolve({payload:{responseData:{availablePaymentChecks:sU(t),checksMissingRequiredTotal:sU(n),maxAmountPayableByPaymentCheck:o}}})},eIt=(e,t,n,o)=>{if(e&&e.payload&&e.payload.responseData){const r=e.payload.responseData||{},{availablePaymentChecks:a,checksMissingRequiredTotal:i}=r;o(U.analyticsEvent({type:xt.PAYMENT_CHECKS_AVAILABILITY_FETCHED_ANALYTICS,paymentChecks:{availablePaymentChecks:a,checksMissingRequiredTotal:i},customerId:t,orderId:n}))}return Promise.resolve(e)},tIt=({basketTotal:e,orderId:t})=>(n,o)=>{const r=rr(o());return n(Xf.fetchAvailablePaymentChecks({basketTotal:e,orderId:t})).then(a=>Jyt(a)).then(a=>eIt(a,r,t,n))},gL={fetchAvailablePaymentChecks:tIt},JX=e=>{const t=At(e),n=Xi(e),o=Fo(e),r=n?.money?.amount;return{loyaltyAmount:r?Number(r):null,orderId:t,groupId:o}},sIt=e=>async(t,n)=>{const o=n(),r=At(o);try{await t(qy.addLoyaltyUnitsToBasket(e)),await t(Ht.getBasket()),z.success("basket.add.loyalty.units.success");const{loyaltyAmount:a,groupId:i}=JX(o),l={transactionId:r,loyaltyAmount:a,groupId:i};t(U.analyticsEvent({type:vy.USE_LOYALTY,...l}));const c={event:"use_loyalty",osp_transaction_id:r,loyalty_amount:a??0,group_id:i};J.sendEvent({GA:c,WA:null}),t(Mo.getPaymentCheckoutSummaryService()),t(U.analyticsEvent({type:_e.LOYALTY_POINTS_ADD_SUCCESS,payload:{pageEventAttributes:{type:"loyaltyPayment",orderId:r}}}))}catch{t(U.analyticsEvent({type:_e.LOYALTY_POINTS_ADD_FAILURE,payload:{pageEventAttributes:{type:"loyaltyPayment",orderId:r}}})),z.error("basket.add.loyalty.units.error")}},nIt=()=>async(e,t)=>{try{const n=t();await e(qy.removeLoyaltyUnitsFromBasket()),await e(Ht.getBasket()),q0(n)==="ORDER_EDIT"&&z.success("loyalty.units.remove.notification.refresh");const{orderId:o,loyaltyAmount:r,groupId:a}=JX(n),i={transactionId:o,loyaltyAmount:r,groupId:a};e(U.analyticsEvent({type:vy.REMOVE_LOYALTY,...i}));const l={event:"remove_loyalty",osp_transaction_id:o??"",loyalty_amount:r??0,group_id:a};J.sendEvent({GA:l,WA:null}),e(Mo.getPaymentCheckoutSummaryService())}catch{z.error("basket.remove.loyalty.units.error")}},kh={addLoyaltyUnitsToBasket:sIt,removeLoyaltyUnitsFromBasket:nIt},oIt=()=>async(e,t)=>{const n=t(),o=D("cdm")(n),r=Cn(n)?.slotId;!o||!r||await e(Lr.getConciergeDelivery(r))},rIt=e=>async(t,n)=>{const o=n(),a=Zt(o)?.orderId,l=Cn(o)?.slotId;!l||!a||await t(Lr.saveConciergeDelivery({slotId:l,isLeftAtConcierge:e,orderId:a}))},eZ={getConciergeDelivery:oIt,saveConciergeDelivery:rIt},iy=e=>{switch(e){case"vouchers.validation.failure.accountCountCondition":case"CUSTOMER_USAGE_EXCEEDED":return"vouchers.validation.failure.account.count.condition";case"vouchers.validation.failure.checkoutDateCondition":case"WRONG_CHECKOUT_DATE":return"vouchers.validation.failure.checkout.date.condition";case"vouchers.validation.failure.deliveryDateCondition":case"WRONG_DELIVERY_DATE":return"vouchers.validation.failure.delivery.date.condition";case"vouchers.validation.failure.firstTimeShopperCondition":case"CUSTOMER_NOT_FIRST_TIME_SHOPPER":return"vouchers.validation.failure.first.time.shopper.condition";case"vouchers.validation.failure.globalCountCondition":case"GLOBAL_USAGE_EXCEEDED":return"vouchers.validation.failure.global.count.condition";case"vouchers.validation.failure.shoppingNumberCondition":return"vouchers.validation.failure.shopping.number.condition";case"vouchers.validation.failure.voucherAssignedToAccountCondition":case"WRONG_CUSTOMER":return"vouchers.validation.failure.voucher.assigned.to.account.condition";case"vouchers.validation.failure.voucherExistsForCodeCondition":case"CODE_NOT_FOUND":case"PromotionNotFound":case"PROMOTION_NOT_FOUND":return"vouchers.validation.failure.voucher.exists.for.code.condition";case"vouchers.validation.failure.voucherDeactivatedCondition":return"vouchers.validation.failure.voucher.deactivated.condition";case"BetterPromotionWasAvailable":case"BETTER_PROMOTION_WAS_AVAILABLE":return"vouchers.validation.failure.better.promotion.was.available";case"ItemMinimumSpendNotMet":case"ITEM_MINIMUM_SPEND_NOT_MET":return"vouchers.validation.failure.item.minimum.spend.not.met";case"MinimumSpendNotMet":case"MINIMUM_SPEND_NOT_MET":return"vouchers.validation.failure.minimum.spend.not.met";case"ProductsToBuyMissingInBasket":case"PRODUCTS_TO_BUY_MISSING_IN_BASKET":case"ProductsToRewardMissingInBasket":case"PRODUCTS_TO_REWARD_MISSING_IN_BASKET":return"vouchers.validation.failure.products.missing.in.basket";case"NoLegalToPromoteItems":case"NO_LEGAL_TO_PROMOTE_ITEMS":return"vouchers.validation.failure.no.legal.to.promote.items";case"basket-ws-100":return"too.many.requests.error.message";case"MARKETING_CONSENTS_NOT_PROVIDED":return"vouchers.validation.failure.marketing.consents.not.provided";default:return"vouchers.validation.failure.unknown.reason"}},aIt=D("mktg.vou"),iIt=(e,t,n,o)=>{const{formatNumber:r}=n,i=(t?.vouchers||[]).find(c=>c.voucherId===e);if(!i)return e;const l=$a(r,i.savings,o);return`${e} (${l})`},lIt=(e,t,n)=>async(o,r)=>{let a;try{if(aIt(r())){a=await o(vl.addVoucherWithMarketingPreferences(e,n));const{voucherAddResult:u}=a.payload.responseData;if(!u?.valid||!u?.inBasket){const m=t.formatMessage(iy(u?.errorCode));return o(U.analyticsEvent({type:Te.VOUCHER_ADD_FAILURE,voucherId:e,failureMessage:m})),m}n&&z.info("marketing.preferences.update.success")}else{a=await o(vl.addVoucherToBasket(e));const{vouchersAddResult:u}=a.payload.responseData;if(!u.length||!u[0]?.valid||!u[0]?.inBasket){const m=t.formatMessage(iy(u[0]?.validationErrorCode));return o(U.analyticsEvent({type:Te.VOUCHER_ADD_FAILURE,voucherId:e,failureMessage:m})),m}}}catch{const m=t.formatMessage(iy(void 0));return o(U.analyticsEvent({type:Te.VOUCHER_ADD_FAILURE,voucherId:e,failureMessage:m})),m}o(Mo.getPaymentCheckoutSummaryService());let i=r();const l=await o(Ht.getCheckoutBasket({appliedPaymentCheckId:ax(i)?.paymentCheckId,fetchAllocatedPaymentChecks:D("pay.check.use")(i)}));if(i=r(),o(jd(a?.payload.responseData.pricingNotifications,!0)),o(U.analyticsEvent({type:Te.VOUCHER_ADD_SUCCESS,voucherId:e,tickboxName:t.formatMessage("marketing.optin.vouchers.title"),tickboxSelected:n!==void 0?n:null,voucherDescription:iIt(e,l,t,pi(i))})),Yie(i).every(u=>u.voucherId!==e)){o(U.analyticsEvent({type:Ay.USE_PROMOTION_CODE,voucherCode:e,transactionId:At(i),groupId:Fo(i)}));const u={event:"use_promotion_code",id:e,group_id:Fo(i),osp_transaction_id:At(i)||""};J.sendEvent({GA:u,WA:null})}return o(Z.closeModal()),z.success("checkout.summary.basket.summary.voucher.success"),null},cIt=e=>(t,n)=>{const o=n(),r=ax(o);return t(vl.removeVoucherFromBasket(e.voucherId)).then(async a=>{await t(Ht.getCheckoutBasket({appliedPaymentCheckId:r?.paymentCheckId})),t(jd(a?.payload.responseData.pricingNotifications??[],!0)),t(Mo.getPaymentCheckoutSummaryService()),t(U.analyticsEvent({type:Te.VOUCHER_REMOVED,voucherId:e.voucherId,voucherDescription:`${e.voucherId} (${e.savings})`}));const i=At(o),l=Fo(o);t(U.analyticsEvent({type:Ay.REMOVE_PROMOTION_CODE,voucherCode:e.voucherId,transactionId:i,groupId:l}));const c={event:"remove_promotion_code",id:e.voucherId,group_id:Fo(o),osp_transaction_id:At(o)??""};J.sendEvent({GA:c,WA:null}),z.success("checkout.summary.basket.summary.voucher.removed")}).catch(a=>{throw new Error(a)})},EI={addVoucherToBasket:lIt,removeVoucherFromBasket:cIt},dIt=T.object`
    inline-size: 100%;
`,uIt=({altText:e,url:t,setIsMissingFrenchAgeRestriction:n})=>(n?.(!t),t?s.jsx("div",{className:"salt-m-t--16",children:s.jsx(dIt,{title:e,data:t,type:"image/svg+xml","data-test":"age-restriction-banner"})}):null),pIt=e=>({url:qe(e,"french-age-restriction-banner-url")||void 0,altText:qe(e,"french-age-restriction-banner-alternative-text")||void 0}),tZ=ke(pIt)(uIt),sZ=(e="en")=>new Intl.Collator(e,{numeric:!0}).compare,mIt=e=>{const t=sZ(e);return(n,o)=>t(n.sellerName||"",o.sellerName||"")},nZ=(e,t,n)=>{const o=sZ(n),a=[...e.keys()].filter(l=>l!==t.sellerName).sort(o);return[t.sellerName,...a].map(l=>({sellerName:l,products:e.get(l)})).filter(l=>l.products)};function EL(e,t,n){const o=e.find(i=>i.sellerName===t),a=e.filter(i=>i.sellerName!==t).sort(mIt(n));return o?[o,...a]:a}function pf(e){return Ge(e.expirationDate,Ge.ISO_8601,!0).isValid()}function nU(e){return[...e].sort((t,n)=>!pf(t)&&!pf(n)?0:pf(t)?pf(n)&&Ge(n.expirationDate).isBefore(Ge(t.expirationDate))?1:-1:1)}function hIt(e,t){return t?.map(n=>({sellerId:n.sellerId,sellerName:n.sellerName,groupName:n.sellerName,items:e?.products?.filter(o=>o.sellerId===n.sellerId)?.map(o=>o.productId)||[]}))||[]}const oZ=({basketItems:e=[],blurOverlay:t,orderItems:n=[],isOrderConfirmation:o=!1})=>{const r=E(f=>qe(f,"seller-sales-enabled")==="true"),a=E(HD),i=E($D)||[],l=E(cC)||[],c=E(V$e),d=E(Ts),u=E(lS),m=E(Vs);let g=[];return o||(g=r&&u?.length?u:[{items:e?.map(f=>f.productId)||[]}]),o&&(r?g=EL(hIt(a,l),c,m):g=[{items:i?.map(f=>f.product?.productId||"")||[],sellerId:"",sellerName:""}]),s.jsx(se,{"data-test":"expanded-products-list",gap:["sm"],className:"salt-m-t--4",children:g.map(({groupName:f,items:y})=>{let I=[];return o?r?I=n?.filter(S=>y.includes(S.productId))||[]:I=i?.map(S=>({productId:S.product?.productId,quantity:{quantityInBasket:S.quantity}}))||[]:I=e?.filter(S=>y.includes(S.productId))||[],s.jsxs(h.Fragment,{children:[r&&f&&!!y.length&&s.jsx(bi,{className:"salt-d--block salt-m-t--4 salt-m-b--2",groupName:f}),I?.map(S=>{const C=d[S.productId];return s.jsx(y7,{basketItem:S,fullWidth:!0,blurOverlay:t,children:C&&s.jsx(P,{className:"salt-m-l--2",children:s.jsx("span",{translate:"no",children:`${S.quantity.quantityInBasket}x ${C.name}`})})},S.productId)})]},f)})})},gIt=({basketItems:e,isOrderConfirmation:t})=>{const[n]=fe(["ord.def.col"]),o=ps({breakpoint:"lg-up"}),[r,a]=h.useState(o&&!n),i=E(HD),l=E($D)||[],c=E(_=>qe(_,"seller-sales-enabled")==="true"),d=M(),u=d.formatMessage("checkout.summary.basket.overview.header.main"),m=ts(),g=()=>{m({type:r?Fe.ITEM_WINDOW_REDUCED:Fe.ITEM_WINDOW_EXPANDED}),a(!r)},{currentBreakpoint:f}=h.useContext(Pn),I=["md","lg"].includes(f)?s.jsx(Yd,{}):void 0;let S=[],C=[];return t?(c?S=i?.products?.map(_=>({..._,quantity:{quantityInBasket:_.quantity}}))||[]:S=l?.map(_=>({productId:_.product?.productId,quantity:{quantityInBasket:_.quantity}}))||[],C=S):C=e,s.jsx("div",{className:"salt-m-b--4",children:s.jsxs(st,{expanded:r,onToggle:g,aria:{expandedLabel:d.formatMessage("checkout.summary.basket.overview.header.main"),collapsedLabel:d.formatMessage("checkout.summary.basket.overview.header.main")},children:[s.jsx(Zg,{name:u,basketItems:C}),s.jsxs(st.ControlSection,{children:[s.jsx(Zp,{basketItems:C,name:u}),s.jsx(st.ToggleSwitch,{})]}),s.jsx(st.ContentCollapsed,{children:s.jsx(ET,{basketItems:C,visible:!r,setExpanded:a})}),s.jsx(st.ContentExpanded,{isScrollHidden:!0,children:s.jsx(oZ,{basketItems:e,blurOverlay:I,orderItems:S,isOrderConfirmation:t})})]})})},EIt=e=>({basketItems:Id(e)}),rZ=Ct(ke(EIt))(gIt),aZ=(e,t)=>({OUT_OF_STOCK:t.formatMessage("product.availability.out.of.stock",{itemQty:e.missingAmount}),TIME_RESTRICTION:e.deliveryTimeRestrictionMessage??t.formatMessage("product.availability.time.restriction",{to:e.timeRestriction?.deliverableTo,from:e.timeRestriction?.deliverableFrom}),LIMITED_AVAILABILITY:t.formatMessage("product.availability.limited",{addedAmount:e.addedAmount,requestedAmount:e.requestedAmount}),CHECKOUT_TIME_RESTRICTED:e.checkoutTimeRestrictionMessage??t.formatMessage("product.checkout.time.restriction",{to:e.checkoutTimeRestriction?.checkoutTo,from:e.checkoutTimeRestriction?.checkoutFrom}),EXCEEDED_MAX_QUANTITY:t.formatMessage("fop.max.quantity")}),fIt=()=>{const e=M(),t=E(SQe);return s.jsx(Ve,{inline:!1,children:t.map(n=>s.jsx(Ve.Item,{children:s.jsx(ve,{condensed:!0,children:s.jsx(sE,{product:n,messages:aZ(n,e)})})},n.productId))})},Mh="UNAVAILABLE_ITEMS_MODAL_NAME",yIt=()=>{const{removeInvalidProducts:e,isRemovingProducts:t,isModalOpen:n,closeModal:o,checkoutErrorCode:r}=TIt();return s.jsxs(G,{showCloseIcon:!0,onRequestClose:o,isOpen:n,aria:{labelledby:Mh},children:[s.jsx(G.Header,{align:"left","aria-live":"polite",children:s.jsx(ne,{as:"h1",id:Mh,children:s.jsx(v,{id:"checkout.summary.invalid.items.modal.title"})})},"header"),s.jsxs(G.Body,{children:[s.jsx(Ce,{className:"salt-m-b--2",intent:"error",size:"s",text:s.jsx(v,{id:"slotbooking.modal.oos.items.unavailable"})}),s.jsx(fIt,{})]},"body"),s.jsxs(G.Footer,{align:"left",children:[r===Z8?s.jsx(b,{className:"salt-m-r--1",onClick:o,intent:"secondary",fill:!0,asChild:!0,"data-test":"back-to-basket",children:s.jsx(rt,{intent:"ghost",href:jt(),children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.invalid.items.modal.back.to.cart"})})})}):s.jsx(b,{className:"salt-m-r--1",onClick:o,intent:"secondary",fill:!0,asChild:!0,"data-test":"find-another-slot",children:s.jsx(rt,{intent:"ghost",href:sr({inCheckoutWalk:!0}),children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.invalid.items.modal.find.slot"})})})}),s.jsx(b,{className:"salt-m-l--1",onClick:e,intent:"primary",fill:!0,loading:t,children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.invalid.items.modal.remove.products"})})})]},"footer")]})},IIt={ageConfirmed:!1},iZ="PHARMACY_MODAL",SIt=Object.freeze({PENDING:"PENDING",ERROR:"ERROR",OK:"OK",CANCEL:"CANCEL",READY:"READY"}),lZ=ie.createContext(IIt),CIt=()=>h.useContext(lZ),zd=()=>{const e=E(D("pay.slct")),t=E(D("pay.pmf"));return e&&t},TIt=()=>{const e=F(),[t,n]=h.useState(!1),o=E(Z5),r=We(),a=E(Vo(Mh))?.checkoutErrorCode,i=E(Ue(Mh)),l=o?.limitedProducts||[],c=o?.cartSplitRequired||!1,d=()=>e(Z.closeModal()),u=(g,f)=>{if(c||g&&f){const y=g&&f;r(jt(),{state:{isBasketBelowThreshold:y}})}};return{removeInvalidProducts:()=>{n(!0),e(ca.removeBasketItems(l.map(({productId:g,missingAmount:f})=>({productId:g,quantity:f})))).then(g=>{const f=g?.basket;u(!f?.checkout?.basketAboveThreshold,!!f?.checkout?.minimumCheckoutThreshold),d()}).catch(()=>(n(!1),z.error("request.error.title")))},isRemovingProducts:t,isModalOpen:i,closeModal:d,checkoutErrorCode:a}},jh=()=>{const e=E(D("pcs.v2"));return E(t=>e?XX(t):WX(t))},cZ=()=>{const e=E(D("pcs.v2"));return E(t=>e?hL(t):YX(t))},fL=()=>{const e=E(D("pcs.v2")),t=E(D("oed")),n=E(D("loy.waon")),o=jh();return!t||!n?!1:e?o?.paymentMethodGroups?.filter(({name:r,displayable:a})=>a&&r!=="LOYALTY").length===0:Number(o?.checkoutPayment?.amountPaidByCustomer)===0&&Number(o?.checkoutPayment?.amountToBeCharged)===0},dZ=()=>{const e=E(D("pcs.v2")),t=E(D("oed")),n=E(D("loy.waon")),o=jh();if(!t||!n)return{hideLoyaltyPaymentButton:!1,disableLoyaltyPaymentButton:!1};if(e){const r=o?.paymentMethodGroups?.find(({name:a})=>a==="LOYALTY");return{hideLoyaltyPaymentButton:!r?.displayable,disableLoyaltyPaymentButton:!r?.available}}else return{hideLoyaltyPaymentButton:Number(o?.checkoutPayment?.amountToBeCharged)===0&&Number(o?.checkoutLoyaltyPayment?.amountToBeCharged)===0,disableLoyaltyPaymentButton:!1}},_It=(e,t)=>{const{deliveryTimeInMinutes:n,collectionTimeInMinutes:o}=t||{},r=mC(e);return n&&o?e.formatMessage("checkout.summary.express.collection.info",{readyTimeSpan:r(n),maxTimeSpan:r(o)}):null},vIt=e=>{const t=e?.deliveryMethod===Et.clickAndCollect.method,n=e?.slotType==="STANDARD",o=e?.deliveryStartDate?.slice(0,10)!==e?.deliveryEndDate?.slice(0,10);return t&&n&&o},uZ=e=>{const t=M(),n=vIt(e),o=e?.deliveryType===Et.clickAndCollect.type,r=e?.deliveryType===Et.vanDelivery.type,a=e?.slotType==="ON_DEMAND",i=r&&a,l=o&&a,c=o?t.formatMessage("checkout.summary.collection.title"):t.formatMessage("checkout.summary.delivery.title"),d=l&&_It(t,e);return{isCollection:o,isFastDelivery:i,standardTitle:!l&&!n&&c,expressCollectionTitle:(l||n)&&t.formatMessage("express.collection.delivery.card.title"),expressCollectionDescription:d,shouldShowStandardDateForExpressCollection:n||l&&!d}},AIt=()=>{const e=zd(),t=E(TO);return e&&t===ct.CASH_ON_DELIVERY},bIt=()=>{const e=F(),t=zd(),n=E(TO),o=oo(n);h.useEffect(()=>{t&&o!==n&&n===ct.CASH_ON_DELIVERY&&e(Lr.setConciergeDelivery(!1))},[n,e,t,o])},pZ=({message:e})=>{const t=M();return s.jsx(Ce,{size:"s",intent:"warning",text:s.jsxs(P,{"data-test":"delivery-collection-point",children:[t.formatMessage("checkout.delivery.collection.point.label")," ",e]})})},xT=({delivery:e})=>e?.address?s.jsx("div",{className:"salt-m-t--2 salt-overflow-wrap--anywhere",children:s.jsxs(P,{"data-pii":"true",bold:!0,children:[s.jsx(v,{id:"checkout.summary.delivery.address.label"}),": ",s.jsxs(P,{"data-test":"delivery-address-body",children:[e.addressNickName&&`${e.addressNickName} - `,e.address]})]})}):null,yL=({delivery:e})=>e?.addressNotes?s.jsx("div",{className:"salt-m-t--2",children:s.jsxs(P,{bold:!0,children:[s.jsx(v,{id:"settings.address.book.add.modal.notes.label"}),": ",s.jsx(P,{"data-test":"delivery-address-notes",children:e.addressNotes})]})}):null,mZ=({externalAddress:e})=>{const{addressDetails:t,externalCollectionPointId:n}=e;return t.openingHours&&t.locationDescription?s.jsx(P,{size:"m",children:s.jsx(v,{id:"delivery.card.locker.external.address.with.location.description.and.opening.hours",values:{lockerName:n,externalAddress:t.formattedAddress,locationDescription:t.locationDescription,openingHours:t.openingHours}})}):t.openingHours?s.jsx(P,{size:"m",children:s.jsx(v,{id:"delivery.card.locker.external.address.with.opening.hours",values:{lockerName:n,externalAddress:t.formattedAddress,openingHours:t.openingHours}})}):t.locationDescription?s.jsx(P,{size:"m",children:s.jsx(v,{id:"delivery.card.locker.external.address.with.description",values:{lockerName:n,externalAddress:t.formattedAddress,locationDescription:t.locationDescription}})}):s.jsx(P,{size:"m",children:s.jsx(v,{id:"delivery.card.locker.external.address",values:{lockerName:n,externalAddress:t.formattedAddress}})})},IL=e=>e.data.delivery.deliveryDetails,xIt=V(IL,e=>e.isFetching);V(IL,e=>e.error);const xi=V(IL,e=>e.options),aE=V(xi,e=>e?.additionalInformation),hZ=V(xi,e=>e?.dropOff),nm=V(hZ,e=>e?.options||[]),om=V(hZ,e=>e?.options.find(t=>t.id===e?.selectedId)),gZ=V(xi,e=>e?.entryInstructions),SL=V(gZ,e=>e?.options.find(t=>t.id===e?.selectedId)),RT=V(gZ,e=>e?.options||[]),RIt=e=>V(RT,t=>e&&t.length?t.filter(n=>n.dropOffAssignment.includes(e)):[]),CL=e=>V(nm,t=>t.find(n=>n.id===e)),DT=e=>V(RT,t=>t.find(n=>n.id===e)),EZ=e=>V(CL(e),t=>t?.entryInstructionsRequired||!1),fZ=e=>V(DT(e),t=>t?.additionalInformationRequired||!1),yZ=V(xi,e=>e?.deliveryAsset),iE=V(yZ,e=>e?.options||[]),IZ=e=>V(iE,t=>e?t.filter(n=>!n.dropOffAssignment||n.dropOffAssignment.includes(e)):t.filter(n=>!n.dropOffAssignment)),DIt=e=>V(iE,t=>t.find(n=>n.id===e)),OT=V(yZ,e=>e?.options.find(t=>t.id===e?.selectedId)),OIt=({onConfirm:e,isLoading:t})=>{const{formatMessage:n}=M();return s.jsx(b,{intent:"primary",loading:t,onClick:e,"data-test":`${vL}-confirm-button`,fill:!0,children:s.jsx(b.Text,{children:n("delivery-details-modal.confirm-button.label")})})},SZ="UNATTENDED",CZ="ATTENDED_WITH_UNATTENDED_CONSENT",PIt=D("daddi"),PT=e=>async(t,n)=>{const{formData:o,deliveryDestinationId:r}=e,{additionalInformationValue:a,entryInstructionId:i,dropOffId:l,deliveryAssetId:c}=o,d=n(),u=At(d),m=hn(d),g=xi(d),f={additionalInformation:g?.additionalInformation?.value!==a,entryInstruction:i&&g?.entryInstructions?.selectedId!==i,dropOff:l&&g?.dropOff?.selectedId!==l,deliveryAsset:c&&g?.deliveryAsset?.selectedId!==c},y=Object.values(f).some(Boolean);if(u&&r&&y&&m){const I={additionalInformation:{value:a},...i?{entryInstruction:{id:i}}:{},...l?{dropOff:{id:l}}:{},...c?{deliveryAsset:{id:c}}:{}},S=await t(jc.updateDeliveryOptions({orderId:u,regionId:m,deliveryDestinationId:r,data:I}));if(S?.payload?.responseData)return t(jc.setDeliveryOptions(S.payload.responseData)),S.payload.responseData}return null},TL=({deliveryDestinationId:e})=>async(t,n)=>{const o=n(),r=PIt(o),a=At(o),i=hn(o);if(r&&a&&e&&i)try{await t(jc.getDeliveryOptions(a,e,i))}catch{z.error("toast.notification.generic.error")}},pt={ADDITIONAL_INFORMATION:"additionalInformation",DROP_OFF_OPTION:"dropOffOption",ENTRY_INSTRUCTION:"entryInstruction",DELIVERY_ASSET:"deliveryAsset"},uv={additionalInformation:{required:"delivery-details-modal.validation.error.additional-information-is-empty"},dropOffOption:{required:"delivery-details-modal.validation.error.drop-off-options-not-selected"},entryInstruction:{required:"delivery-details-modal.validation.error.entry-instructions-not-selected"},deliveryAsset:{required:"delivery-details-modal.validation.error.delivery-asset-not-selected"}},TZ=400,Vm="onSubmit",NIt=({deliveryDestinationId:e,forceDeliveryAssetSelectVisibility:t})=>{const n=F(),[o,r]=h.useState(!1),a=E(RT),i=E(iE),l=E(om),c=E(SL),d=E(OT),u=E(aE),m={[pt.DROP_OFF_OPTION]:l?.id||"",[pt.ENTRY_INSTRUCTION]:c?.id||"",[pt.ADDITIONAL_INFORMATION]:u?.value||"",[pt.DELIVERY_ASSET]:d?.id||""},g=Gn({defaultValues:m,mode:Vm,reValidateMode:Vm}),f=g.watch(pt.DELIVERY_ASSET,d?.id||""),y=x=>{const R=x.target.value;I(R),S(R)},I=x=>{const R=g.getValues(pt.ENTRY_INSTRUCTION);a.filter(k=>k.dropOffAssignment.includes(x)).some(k=>k.id===R)||(g.resetField(pt.ENTRY_INSTRUCTION,{defaultValue:""}),g.clearErrors([pt.ENTRY_INSTRUCTION,pt.ADDITIONAL_INFORMATION]))},S=x=>{i.filter(N=>!N.dropOffAssignment||N.dropOffAssignment.includes(x)).some(N=>N.id===f)||(g.setValue(pt.DELIVERY_ASSET,""),g.clearErrors([pt.DELIVERY_ASSET]),t())},C=()=>{g.unregister(pt.ADDITIONAL_INFORMATION)},_=x=>x[pt.DROP_OFF_OPTION]?Xa.DROP_OFF:x[pt.ENTRY_INSTRUCTION]?Xa.ENTRY_INSTRUCTIONS:x[pt.ADDITIONAL_INFORMATION]?Xa.ADDITIONAL_INFORMATION:x[pt.DELIVERY_ASSET]?Xa.DELIVERY_ASSETS:null,A=async()=>{r(!0);const x=await g.trigger();let R;if(x){const O=g.getValues();try{const N=await n(PT({deliveryDestinationId:e,formData:{additionalInformationValue:O[pt.ADDITIONAL_INFORMATION]||"",dropOffId:O[pt.DROP_OFF_OPTION],entryInstructionId:O[pt.ENTRY_INSTRUCTION],deliveryAssetId:f}}));return N&&z.success("delivery-details-saved.toast"),n(Z.closeModal()),r(!1),{updatedDeliveryOptions:N,errorType:null}}catch{R=Xa.API_ERROR,z.error("toast.notification.generic.error")}}else{const{errors:O}=g.formState;R=_(O)}return r(!1),{updatedDeliveryOptions:null,errorType:R}};return{formContext:g,isUpdating:o,defaultValues:m,dropOffDefaultOptionTitle:l?.displayValue,handleSubmit:A,handleDropOffChange:y,handleEntryInstructionChange:C}},_Z=({className:e})=>{const t=E(D("dass")),n=M(),o=n.formatMessage({id:"delivery-details-modal.unattended-handover-disclaimer.text"}),r=n.formatMessage({id:"delivery-details.packaging-protection-info.text"}),a=t?o:n.formatMessage({id:"delivery-details-modal.unattended-handover-complete-disclaimer.text"},{liability_disclaimer:o,packaging_protection_info:r});return s.jsx(P,{size:"s",className:e,"data-test":"delivery-details-modal-unattended-handover-disclaimer-text",children:a})},_L=(e,t,n)=>e({id:"delivery-details-modal.select-field.accessibility.required-error.label"},{fieldTitle:t,errorMessage:n}),LIt=({intl:e,required:t,optionSelected:n,hasError:o=!1,fieldTitle:r="",errorMessage:a=""})=>{const{formatMessage:i}=e,l={label:r,placeholder:i("delivery-details-modal.delivery-asset-selector.select-option"),required:a,helperText:i("delivery-details.packaging-protection-info.text")},c=o?_L(i,r,a):i(n?"delivery-details.delivery-asset-selector.filled-with-description.option.accessibility.label":"delivery-details-modal.delivery-asset-selector.accessibility.select-option.label",{required:t?i("validation.msg.required"):"",title:l.label,packagingProtectionInfo:l.helperText,optionSelected:n});return{...l,ariaLabel:c}},vZ=({customLabel:e,required:t=!0,options:n=[],onChange:o=()=>{},mode:r})=>{const a=M(),{formatMessage:i}=a,l=$o(),c=td({name:pt.DELIVERY_ASSET}),d=ED(),u=E(DIt(c)),m=!!l.formState.errors[pt.DELIVERY_ASSET],g=i("delivery-details.delivery-asset-selector.title"),f=i("delivery-details-modal.validation.error.delivery-asset-not-selected"),y=h.useMemo(()=>n.map(S=>({value:S.id,label:d({item:S})})),[n]);if(n.length===0)return null;const I=LIt({intl:a,required:t,optionSelected:d({item:u}),hasError:m,fieldTitle:g,errorMessage:f});if(y?.length===1){const S=y.at(0);return s.jsxs("div",{children:[s.jsx(P,{size:"s",bold:!0,children:s.jsx(v,{id:"delivery-view.delivery-asset.label"})}),s.jsx("br",{}),s.jsx(P,{children:S?.label}),s.jsx("br",{}),s.jsx("input",{type:"hidden","data-test":"delivery-asset-single-option",value:S?.value,name:pt.DELIVERY_ASSET})]})}return s.jsx(Fg,{name:pt.DELIVERY_ASSET,label:e||I.label,onChangeCallback:o,"data-test":"delivery-asset-select",placeholder:I.placeholder,helperText:I.helperText,ariaLabel:I.ariaLabel,defaultValue:c,required:{value:t,message:I.required||""},options:y,mode:r})},kIt=({onChange:e,mode:t,options:n})=>{const{formatMessage:o}=M(),r=$o(),a=td({name:pt.DROP_OFF_OPTION}),i=E(CL(a)),l=!!r.formState.errors[pt.DROP_OFF_OPTION],c=o("delivery-details-modal.drop-off-options.title"),d=o("delivery-details-modal.validation.error.drop-off-options-not-selected");if(n.length===0)return null;const u=()=>l?_L(o,c,d):i?o({id:"delivery-details-modal.drop-off.filled.option.accessibility.label"},{required:o("validation.msg.required"),option_selected:i.displayValue}):o({id:"delivery-details-modal.drop-off.select.option.accessibility.label"},{required:o("validation.msg.required")}),m={label:c,placeholder:o("slot.booking.delivery.select-drop-off-option"),required:d,ariaLabel:u()},g=n.map(f=>({value:f.id,label:f.displayValue}));return s.jsx(Fg,{name:pt.DROP_OFF_OPTION,label:m.label,onChangeCallback:e,"data-test":"drop-off-select",placeholder:m.placeholder,defaultValue:a,ariaLabel:m.ariaLabel,required:{value:!0,message:m.required},options:g,mode:t})},MIt=({options:e,onChange:t,mode:n})=>{const{formatMessage:o}=M(),r=$o(),a=td({name:pt.DROP_OFF_OPTION}),i=E(EZ(a)),l=td({name:pt.ENTRY_INSTRUCTION}),c=E(DT(l)),d=!!r.formState.errors[pt.ENTRY_INSTRUCTION],u=o("delivery-details-modal.entry-instructions.title"),m=o("delivery-details-modal.validation.error.entry-instructions-not-selected");if(!e.length)return null;const g=()=>d?_L(o,u,m):c?o({id:"delivery-details-modal.entry.instructions.filled.option.accessibility.label"},{required:i?o("validation.msg.required"):"",option_selected:c.displayValue}):o({id:"delivery-details-modal.entry.instructions.select.option.accessibility.label"},{required:i?o("validation.msg.required"):""}),f={label:u,placeholder:o("delivery-details-modal.select-instructions.title"),required:m,ariaLabel:g()},y=e.map(I=>({value:I.id,label:I.displayValue}));return s.jsx(Fg,{name:pt.ENTRY_INSTRUCTION,label:f.label,onChangeCallback:t,"data-test":"entry-instruction-select",placeholder:f.placeholder,ariaLabel:f.ariaLabel,defaultValue:l,required:{value:i,message:f.required},options:y,mode:n})},jIt=({formContext:e})=>{const t=E(D("dede")),{formatMessage:n}=M(),{getValues:o}=e,r=o(pt.ENTRY_INSTRUCTION),a=o(pt.ADDITIONAL_INFORMATION),i=E(DT(r)),l=E(fZ(r)),c=E(aE),d=t&&l,u=d?n({id:"validation.msg.required"}):"",m=i?.additionalInformationHint||c?.defaultHint||"",g=t?"delivery-details-modal.additional-information.title":"delivery-instructions.title",f=t?n(a?"delivery-details-modal.additional.instructions.filled.option.accessibility.label":"delivery-details-modal.additional.information.select.option.accessibility.label",a?{required:u,information_entered:a}:{required:u,hint:m}):n(a?"delivery-details-modal.delivery.instructions.filled.option.accessibility.label":"delivery-details-modal.delivery.instructions.select.option.accessibility.label",a?{required:u,informationEntered:a}:{required:u,hint:m});return{additionalInfoLabel:g,additionalInfoAriaLabel:f,isAdditionalInfoRequired:d,additionalInfoPlaceholder:m}},wIt=({formContext:e,shouldShowMoreDeliveryDetails:t=!1,showDeliveryAssetSelect:n=!1,handoverType:o,dropOffOptions:r,instructionOptions:a,deliveryAssetOptions:i,onSubmit:l,handleDropOffChange:c,handleEntryInstructionChange:d})=>{const{additionalInfoLabel:u,additionalInfoAriaLabel:m,isAdditionalInfoRequired:g,additionalInfoPlaceholder:f}=jIt({formContext:e}),y=t&&(o===SZ||o===CZ);return s.jsx($n,{...e,children:s.jsxs("form",{"data-test":`${vL}-form`,onSubmit:e.handleSubmit(l),children:[t&&s.jsxs(h.Fragment,{children:[s.jsx(kIt,{options:r,onChange:c,mode:Vm}),s.jsx(MIt,{options:a,onChange:d,mode:Vm})]}),s.jsx(HC,{name:pt.ADDITIONAL_INFORMATION,label:u,ariaLabel:m,formattedPlaceholder:f,required:g,requiredMessage:"delivery-details-modal.validation.error.additional-information-is-empty",maxLength:TZ}),n&&s.jsx(vZ,{options:i,mode:Vm}),y&&s.jsx(_Z,{})]})})},AZ=({className:e})=>{const{formatMessage:t}=M(),o=E(D("dede"))?"delivery-details-modal.title":"delivery-instructions.title";return s.jsx(ne,{as:"h1",className:e,children:t(o)})},lE="DELIVERY_DETAILS_MODAL_NAME",vL="delivery-details-modal",bZ=({trigger:e=Dy.DELIVERY_OPTIONS_CLICKED,onDeliveryDetailsSaved:t=()=>{},handleModalClose:n=()=>{},showDeliveryAssetInitially:o=!0,deliveryDestinationId:r})=>{const[a,i]=h.useState(!1),[l,c]=h.useState(null),d=F(),u=E(Ue(lE)),[m,g]=fe(["dede","dass"]),{deliveryDetailsModalDisplayed:f,deliveryOptionsViewed:y}=bo(),I=()=>{i(!0)},S=()=>{i(!1)},{formContext:C,isUpdating:_,defaultValues:A,dropOffDefaultOptionTitle:x,handleSubmit:R,handleDropOffChange:O,handleEntryInstructionChange:N}=NIt({forceDeliveryAssetSelectVisibility:I,deliveryDestinationId:r}),k=td({control:C.control,name:pt.DROP_OFF_OPTION}),j=E(CL(k)),w=E(nm),L=E(RIt(k)),B=E(IZ(k)),W=!!(g&&(o||a)&&B.length);h.useEffect(()=>{u&&(S(),C.reset(A),y({selectedDropOff:x}))},[u]);const $={trigger:e,deliveryInstructionsEnabled:!0,unattendedDeliveryEnabled:!!(m&&w.length),assetChoiceEnabled:W,dropOffOptionsSelected:j?.displayValue,...l?{errorDisplayed:l}:{}},K=()=>{f({...$,modalClosed:Oy.CLOSED}),c(null),d(Z.closeModal()),C.reset(),n()},Q=()=>{R().then(({updatedDeliveryOptions:re,errorType:ue})=>{ue&&!l?c(ue):ue||(f({...$,modalClosed:Oy.CONFIRMED}),c(null)),re&&t(re)})},X={handoverType:j?.handoverType,formContext:C,shouldShowMoreDeliveryDetails:m,showDeliveryAssetSelect:W,dropOffOptions:w,instructionOptions:L,deliveryAssetOptions:B,onSubmit:R,handleEntryInstructionChange:N,handleDropOffChange:O};return s.jsxs(G,{isOpen:u,onRequestClose:K,asBottomSheet:!0,children:[s.jsx(G.Header,{align:"left",children:s.jsx(AZ,{})}),s.jsx(G.Body,{"data-test":vL,children:s.jsx(wIt,{...X})}),s.jsx(G.Footer,{children:s.jsx(OIt,{onConfirm:Q,isLoading:_})})]})},FIt=()=>{const e=F(),t=E(D("daddi")),n=E(D("dede")),o=E(xi),r=E(om),a=E(SL),i=!!o?.additionalInformation?.value,l=t&&(i||!n),c=n&&!!a?.displayValue,d=n&&!!r?.displayValue,u=()=>{e(Z.openModal(lE))},m=()=>n?"delivery-view.additional-information.label":i?"delivery-view.delivery-instructions.title":"delivery-view.delivery-instructions.title.empty-content",g=()=>n?"delivery-view.edit-delivery-details-button.title":i?"delivery-view.edit-delivery-instructions-button.title":"delivery-view.add-delivery-instructions-button.title";return{isDeliveryAdditionalInfoEnabled:t,isDeliveryDetailsEnabled:n,showAdditionalInfo:l,showDeliveryDetailsEntry:c,showDeliveryDetailsDropOff:d,onEditDeliveryDetailsClick:u,additionalInfoLabelId:m(),buttonTextId:g(),defaultDeliveryOptions:o,defaultDeliveryDetailsDropOff:r,defaultDeliveryDetailsEntryInstructions:a}},BIt=/\S+/,UIt=e=>BIt.test(e||""),GIt=T.div`
    word-wrap: break-word;
`,Bc=({labelId:e="",value:t="",allowEmpty:n=!1})=>{const o=s.jsx(P,{bold:!0,children:s.jsx(v,{id:e})}),r=n||UIt(t);return s.jsx(ie.Fragment,{children:r&&s.jsx(GIt,{className:"salt-m-t--2",children:s.jsx(v,{id:"delivery-view.entry",values:{label:o,value:t}})})})},AL=()=>{const{isDeliveryDetailsEnabled:e,isDeliveryAdditionalInfoEnabled:t,showDeliveryDetailsDropOff:n,defaultDeliveryDetailsDropOff:o,showDeliveryDetailsEntry:r,defaultDeliveryDetailsEntryInstructions:a,showAdditionalInfo:i,additionalInfoLabelId:l,defaultDeliveryOptions:c,onEditDeliveryDetailsClick:d,buttonTextId:u}=FIt();return!t&&!e?null:s.jsxs("div",{"data-test":"pre-order-delivery-details",className:"salt-m-t--4",children:[n&&s.jsx(Bc,{labelId:"delivery-view.drop-off-option.label",value:o?.displayValue}),r&&s.jsx(Bc,{labelId:"delivery-view.entry-instruction.label",value:a?.displayValue}),i&&s.jsx(Bc,{labelId:l,value:c?.additionalInformation?.value,allowEmpty:!e}),s.jsx(b,{fill:!0,className:"salt-m-t--2",onClick:d,intent:"secondary","data-test":"edit-delivery-details",children:s.jsx(b.Text,{children:s.jsx(v,{id:u})})})]})},$It={DELIVERY_DETAILS_NOT_FOUND:404},xZ=ee("GET_DELIVERY_DETAILS"),HIt=e=>({type:"API",payload:{url:`/ecomfulfillments/v1/order/${e}/delivery-details`,options:{method:"GET"},service:"ecomfulfillments",...xZ}}),VIt={getDeliveryDetails:HIt,types:{GET_DELIVERY_DETAILS:xZ}},YIt=D("daddi"),WIt=({orderId:e}={})=>{const t=F(),n=E(YIt),[o,r]=h.useState(null),[a,i]=h.useState(!1);return h.useEffect(()=>{(async()=>{if(n&&e){i(!0);try{const c=await t(VIt.getDeliveryDetails(e));c?.payload?.responseData&&r(c.payload.responseData)}catch(c){c.statusCode!==$It.DELIVERY_DETAILS_NOT_FOUND&&z.error("toast.notification.generic.error")}finally{i(!1)}}})()},[e]),{deliveryDetails:o,isLoading:a}},cE=h.memo(({orderId:e})=>{const t=ED(),{deliveryDetails:n}=WIt({orderId:e}),[o,r,a]=fe(["daddi","dede","dass"]),{additionalInformation:i,entryInstruction:l,dropOff:c,deliveryAsset:d}=n??{},u=o&&!!i?.value,m=r&&!!l?.displayValue,g=r&&!!c?.displayValue,f=a&&!!d?.displayValue;if(!o||!u&&!g&&!m&&!f)return null;const y=r?"delivery-view.additional-information.label":"delivery-view.delivery-instructions.title",I={item:d,withDescription:!1};return s.jsxs("div",{"data-test":"post-order-delivery-details",className:"salt-m-t--2",children:[g&&s.jsx(Bc,{labelId:"delivery-view.drop-off-option.label",value:c?.displayValue}),m&&s.jsx(Bc,{labelId:"delivery-view.entry-instruction.label",value:l?.displayValue}),u&&s.jsx(Bc,{labelId:y,value:i?.value}),f&&s.jsx(Bc,{labelId:"delivery-view.delivery-asset.label",value:t(I)})]})}),Tt={messages:{EMPTY_WALLET:"EMPTY_WALLET",NO_WALLET_ITEM_SELECTED:"NO_WALLET_ITEM_SELECTED",DEFAULT_WALLET_ITEM_EXPIRED:"DEFAULT_WALLET_ITEM_EXPIRED",NO_SLOT_SELECTED:"NO_SLOT_SELECTED",CONCIERGE_SAVING_ERROR:"CONCIERGE_SAVING_ERROR",BASKET_BELOW_THRESHOLD:"BASKET_BELOW_THRESHOLD",BASKET_MARKED_CANNOT_CHECKOUT:"BASKET_MARKED_CANNOT_CHECKOUT",TERMS_AND_CONDITIONS_UNCHECKED:"TERMS_AND_CONDITIONS_UNCHECKED",VALIDATION_SUCCESS:"VALIDATION_SUCCESS",RECURRING_SHOPPING_DEFINITION_CREATE_FORM_INCOMPLETE:"RECURRING_SHOPPING_DEFINITION_CREATE_FORM_INCOMPLETE",RECURRING_SHOPPING_DEFINITION_CREATE_FORM_INCOMPLETE_NAME:"RECURRING_SHOPPING_DEFINITION_CREATE_FORM_INCOMPLETE_NAME",RECURRING_SHOPPING_DEFINITION_CREATE_FORM_INCOMPLETE_DEFINITION:"RECURRING_SHOPPING_DEFINITION_CREATE_FORM_INCOMPLETE",AGE_CHECK_NOT_CONFIRMED:"AGE_CHECK_NOT_CONFIRMED",BONUS_CHECK_NOT_AVAILABLE:"BONUS_CHECK_NOT_AVAILABLE",RECURRING_ORDERS_TO_SAVE_PAYMENT_METHOD_UNCHECKED:"RECURRING_ORDERS_TO_SAVE_PAYMENT_METHOD_UNCHECKED",NO_BILLING_ADDRESS:"NO_BILLING_ADDRESS",TERMS_AND_CONDITIONS_FETCH_ERROR:"TERMS_AND_CONDITIONS_FETCH_ERROR",INVALID_SLOT_ERROR:"INVALID_SLOT_ERROR",UNSUPPORTED_PAYMENT_METHOD_GROUP_ERROR:"UNSUPPORTED_PAYMENT_METHOD_GROUP_ERROR",NO_FINANCING_PROVIDER_SELECTED:"NO_FINANCING_PROVIDER_SELECTED",PAYMENT_CHECKOUT_RESTRICTION:"PAYMENT_CHECKOUT_RESTRICTION",NO_AVAILABLE_PAYMENT_METHOD:"NO_AVAILABLE_PAYMENT_METHOD"},status:{SUCCESS:"SUCCESS",FAILURE:"FAILURE"}},cn=!1,qIt={status:Tt.status.SUCCESS,message:Tt.messages.VALIDATION_SUCCESS},KIt={focusErrorElement:(e,t)=>{}},{AGE_CHECK_NOT_CONFIRMED:zIt,TERMS_AND_CONDITIONS_UNCHECKED:QIt,DEFAULT_WALLET_ITEM_EXPIRED:XIt,NO_BILLING_ADDRESS:ZIt,NO_FINANCING_PROVIDER_SELECTED:JIt,RECURRING_SHOPPING_DEFINITION_CREATE_FORM_INCOMPLETE:eSt,RECURRING_SHOPPING_DEFINITION_CREATE_FORM_INCOMPLETE_DEFINITION:tSt,RECURRING_SHOPPING_DEFINITION_CREATE_FORM_INCOMPLETE_NAME:sSt,NO_WALLET_ITEM_SELECTED:nSt,EMPTY_WALLET:oSt,UNSUPPORTED_PAYMENT_METHOD_GROUP_ERROR:rSt}=Tt.messages,hd={[QIt]:"terms-and-conditions",[oSt]:"payment-section",[XIt]:"payment-section",[nSt]:"payment-section",[JIt]:"financing-provider-dropdown",[rSt]:"payment-section",[zIt]:"age-confirmation",[tSt]:xo,[sSt]:Ko,[ZIt]:"billing-address-button"},RZ=ie.createContext(KIt),aSt=()=>h.useContext(RZ),iSt=({children:e})=>{const t=(n,o)=>{if(n)if(n===eSt){const r=hd[o?.isRecurringDefinitionValid||o?.isRecurringNameValid];document.getElementById(r)?.focus({preventScroll:!0})}else document.getElementById(hd[n])?.focus({preventScroll:!0})};return s.jsx(RZ.Provider,{value:{focusErrorElement:t},children:e})},bL=({ageRestriction:e,ageConfirmed:t,onClickAgeConfirmation:n,isAgeConfirmationError:o,ageConfirmationFormRef:r})=>{const a=M(),[i]=fe(["nfchk"]);return s.jsxs("div",{className:"salt-m-t--4",ref:r,children:[i?s.jsx(mt.Checkbox,{id:hd[Tt.messages.AGE_CHECK_NOT_CONFIRMED],name:"summary-age-confirmation-checkbox",value:"summary-age-confirmation-checkbox",checked:t,onChange:n,label:s.jsx(v,{id:"checkout.summary.age.confirmation.label",values:{age:e}}),error:o?a.formatMessage("checkout.summary.age.confirmation.error"):"",required:!0,"data-test":"summary-age-confirmation-checkbox"}):s.jsx(mo,{last:!0,id:hd[Tt.messages.AGE_CHECK_NOT_CONFIRMED],input:{checked:t,onChange:n},bold:!1,meta:{error:o?a.formatMessage("checkout.summary.age.confirmation.error"):"",invalid:o,touched:o},label:s.jsx(v,{id:"checkout.summary.age.confirmation.label",values:{age:e}}),whiteSpace:"pre-wrap","data-test":"summary-age-confirmation-checkbox"}),s.jsx(Ce,{className:"salt-m-t--2",intent:"warning",size:"s",text:s.jsx(v,{id:"checkout.summary.age.confirmation.warning"})})]})},lSt=({orderId:e,carrierDetails:t,delivery:n,isCompletedOrder:o=!1,actions:r,canChangeDelivery:a=!0,onChangeDeliveryButtonClick:i,onClickAgeConfirmation:l=()=>{},ageConfirmed:c=!1,isAgeConfirmationEnabled:d,isAgeConfirmationError:u=!1,ageConfirmationFormRef:m})=>{const g=ul(),f=We(),y=E(D("daddi")),{externalAddress:I,ageRestriction:S}=n||{},C=!y&&!I,{name:_,iconUrl:A,iconDescription:x}=t,R=E(Ho),O=async()=>{i&&i(I?.externalCollectionPointId);const k=await Yo.fetchAnalyticsMetadataByActiveCart(R);r.sendAnalyticsEvent({type:_e.BEGIN_CHECKOUT,meta:k}),g(k),f(sr({inCheckoutWalk:!0}))},N=I?s.jsx(mZ,{externalAddress:I}):s.jsx(xT,{delivery:n});return s.jsxs(ve,{className:"salt-m-b--2",children:[s.jsxs(se,{align:"center",wrap:"nowrap",as:"span",className:"salt-m-b--2",children:[s.jsx(se,{as:"span",className:"salt-m-r--2",children:s.jsx(Vd,{src:A,alt:_!==x?x:void 0,height:31,width:31})}),s.jsx(ne,{as:P,children:_})]}),s.jsxs(se,{direction:"column",className:"salt-m-b--2",gap:["sm"],children:[s.jsx(P,{size:"l",bold:!0,children:s.jsx(eE,{dates:{deliveryStartDate:n?.deliveryStartDate,deliveryEndDate:n?.deliveryEndDate,deliveryTimeInMinutes:n?.deliveryTimeInMinutes,collectionTimeInMinutes:n?.collectionTimeInMinutes,timeZoneId:n?.timeZoneId},carrierType:t.slotBookingComponent,slotTimesDisplayMode:o?Oq:t.slotTimesDisplayMode})}),N]}),C&&s.jsx(yL,{delivery:n}),a&&s.jsx("div",{className:"salt-m-t--4",children:s.jsx(b,{onClick:O,intent:"secondary",fill:!0,"data-test":"change-delivery-button",children:s.jsx(v,{id:"checkout.summary.delivery.change.button"})})}),o?s.jsx(cE,{orderId:e}):s.jsx(AL,{}),S&&d&&s.jsx(bL,{ageRestriction:S,ageConfirmed:c,ageConfirmationFormRef:m,onClickAgeConfirmation:l,isAgeConfirmationError:u})]})},xL=({size:e})=>{const t=M(),n=F(),o=E(xg),r=zd(),a=AIt(),[i]=fe(["nfchk"]);return s.jsxs("div",{className:"salt-d--block salt-m-t--4 salt-m-b--2","data-test":"concierge-delivery",children:[s.jsxs("span",{className:"salt-d--block salt-m-y--2",children:[s.jsx(P,{className:"salt-d--inline salt-m-r--1",bold:!0,size:e,children:s.jsx(v,{id:"checkout.summary.concierge.delivery.notification"})}),s.jsx(P,{className:"salt-d--inline",size:e,children:s.jsx(v,{id:"checkout.summary.concierge.delivery.notification.optional"})})]}),!a&&(i?s.jsx(mt.Checkbox,{name:"concierge-checkbox",value:"concierge-checkbox",checked:o,onChange:()=>n(Lr.setConciergeDelivery(!o)),label:s.jsxs(h.Fragment,{children:[s.jsx(P,{className:"salt-m-r--1",children:s.jsx(v,{id:"checkout.summary.concierge.termsandconditions.prelink.text"})}),s.jsx(rt,{target:"_blank",href:t.formatMessage("checkout.summary.concierge.termsandconditions.link.url"),onClick:()=>{n(U.analyticsEvent({type:_e.CONCIERGE_TERMS_AND_CONDITIONS_CLICKED}))},children:s.jsx(v,{id:"checkout.summary.concierge.termsandconditions.link.text"})})]}),"data-test":"concierge-checkbox"}):s.jsx(mo,{last:!0,input:{onChange:()=>n(Lr.setConciergeDelivery(!o)),checked:o},bold:!1,label:s.jsxs(h.Fragment,{children:[s.jsx(P,{className:"salt-m-r--1",children:s.jsx(v,{id:"checkout.summary.concierge.termsandconditions.prelink.text"})}),s.jsx(rt,{target:"_blank",href:t.formatMessage("checkout.summary.concierge.termsandconditions.link.url"),onClick:()=>{n(U.analyticsEvent({type:_e.CONCIERGE_TERMS_AND_CONDITIONS_CLICKED}))},children:s.jsx(v,{id:"checkout.summary.concierge.termsandconditions.link.text"})})]}),"data-test":"concierge-checkbox"})),r&&s.jsx(Ce,{intent:"info",size:"s","data-test":"concierge-pay-on-delivery-notification",text:t.formatMessage("checkout.summary.concierge.delivery.pay.on.delivery.notification")})]})};xL.defaultProps={size:"l"};const cSt=({actions:e,delivery:t,isAgeConfirmationError:n=!1,onClickAgeConfirmation:o=()=>{},ageConfirmationFormRef:r,showDeliveryPass:a=!1,canChangeDelivery:i=!0,isAgeConfirmationEnabled:l=!1,ageConfirmed:c=!1,isConciergeDeliveryMethodEnabled:d=!1,conciergeDelivery:u=!1,onChangeDeliveryButtonClick:m,isCompletedOrder:g,orderId:f})=>{const y=ul(),I=We(),S=E(Ho);if(!t)return null;const C=t.deliveryType===Et.clickAndCollect.type,_=C?"checkout.summary.collection.change.button":"checkout.summary.delivery.change.button",A=async()=>{m&&m();const x=await Yo.fetchAnalyticsMetadataByActiveCart(S);e.sendAnalyticsEvent({type:_e.BEGIN_CHECKOUT,meta:x}),y(x),I(sr({inCheckoutWalk:!0}))};return s.jsxs(h.Fragment,{children:[a&&t.hasDeliveryPass?s.jsx(Ce,{intent:"success",showIcon:!1,text:s.jsx(v,{id:"checkout.complete.delivery.pass"}),link:s.jsx(Ce.Link,{to:JD(),children:s.jsx(v,{id:"checkout.complete.manage.delivery.pass"})})}):null,t.ageRestriction&&!l&&s.jsx(Ce,{className:i?"salt-m-b--2":"",intent:"warning",text:s.jsx(v,{id:"checkout.summary.age.restriction.warning",values:{age:t.ageRestriction}}),showIcon:!1}),d&&i&&!C&&s.jsx(xL,{size:"m"}),d&&!i&&u&&s.jsx("div",{className:"salt-m-t--4","data-test":"concierge-info",children:s.jsx(Ce,{intent:"info",text:s.jsx(v,{id:"checkout.complete.concierge.info"})})}),i?s.jsx(b,{intent:"secondary",fill:!0,onClick:A,"data-test":"change-delivery-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:_})})}):null,!C&&s.jsx(ie.Fragment,{children:g?s.jsx(cE,{orderId:f}):s.jsx(AL,{})}),t.ageRestriction&&l&&s.jsx(bL,{ageRestriction:t.ageRestriction,ageConfirmed:c,ageConfirmationFormRef:r,onClickAgeConfirmation:o,isAgeConfirmationError:n})]})},dSt=({delivery:e,orderId:t,onChangeDeliveryButtonClick:n,actions:o,isAgeConfirmationEnabled:r,ageConfirmationFormRef:a,onClickAgeConfirmation:i=()=>{},ageConfirmed:l=!1,isAgeConfirmationError:c=!1,isCompletedOrder:d=!1})=>{const u=ul(),m=M(),g=We(),f=E(Ho),y=m.formatNumber(e?.deliveryTimeInMinutes||0,{style:"unit",unit:"minute",unitDisplay:"short"}),I=async()=>{n&&n();const _=await Yo.fetchAnalyticsMetadataByActiveCart(f);o.sendAnalyticsEvent({type:_e.BEGIN_CHECKOUT,meta:_}),u(_),g(sr({inCheckoutWalk:!0}))},S=()=>d?s.jsx(v,{id:"checkout.complete.fast.delivery.title.with.time",values:{time:So(e?.deliveryEndDate||"",e?.timeZoneId||"",vn)}}):s.jsx(v,{id:"order.details.fast.delivery.title.with.time",values:{duration:y}}),C=()=>d?s.jsxs(ie.Fragment,{children:[s.jsx(cE,{orderId:t}),s.jsx(Ce,{intent:"info",size:"s",className:"salt-m-t--2",text:m.formatMessage("order.card.reserved.fast.delivery.alert")})]}):s.jsx(AL,{});return s.jsxs(ve,{className:"salt-m-b--2",children:[s.jsx(ne,{as:"h2",children:S()}),s.jsx(xT,{delivery:e}),!d&&s.jsxs(ie.Fragment,{children:[e?.ageRestriction&&!r&&s.jsx(Ce,{className:"salt-m-t--2",intent:"warning",text:s.jsx(v,{id:"checkout.summary.age.restriction.warning",values:{age:e.ageRestriction}}),showIcon:!1}),s.jsx(b,{className:"salt-m-t--2",intent:"secondary",fill:!0,onClick:I,"data-test":"change-delivery-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.delivery.change.button"})})})]}),C(),!d&&e?.ageRestriction&&r&&s.jsx(bL,{ageRestriction:e.ageRestriction,ageConfirmed:l,ageConfirmationFormRef:a,onClickAgeConfirmation:i,isAgeConfirmationError:c})]})},uSt=D("ag"),pSt=D("cdm"),mSt=e=>{const t=E(D("daddi")),{dateFormat:n,timeFormat:o,isCompletedOrder:r,canChangeDelivery:a=!0,delivery:i=null,showDeliveryPass:l=!1,deliveryCardImpression:c}=e,{isCollection:d,isFastDelivery:u,standardTitle:m,expressCollectionTitle:g,expressCollectionDescription:f,shouldShowStandardDateForExpressCollection:y}=uZ(i),{isReady:I,carrierDetails:S}=Jg({carrierId:i?.carrierId,shippingGroupType:i?.shippingGroupType}),{externalAddress:C}=i||{};if(h.useEffect(()=>{I&&i?.addressId&&c&&c(i.addressId,i.deliveryDestinationId,S?.name,C?.externalCollectionPointId)},[S?.name,i?.addressId,i?.deliveryDestinationId,c,C?.externalCollectionPointId,I]),!i||!I)return s.jsx(Ns.Skeleton,{});if(S)return s.jsx(lSt,{carrierDetails:S,...e});if(u)return s.jsx(dSt,{isCompletedOrder:r,...e});let _=null;i.ageRestriction||l&&i.hasDeliveryPass?_="2":a&&(_="4");const A=s.jsx(P,{size:"l","data-test":"delivery-date",className:"salt-d--inline",bold:!0,children:s.jsx(go,{dateIsoFrom:i.deliveryStartDate,dateIsoTo:i.deliveryEndDate,dateFormat:n,timeZoneId:i.timeZoneId,timeFormat:o})});return s.jsxs(ve,{children:[s.jsxs("div",{className:"salt-m-b--2 salt-overflow-wrap--anywhere",children:[m&&s.jsx(P,{asChild:!0,size:"l",bold:!0,children:s.jsxs("h2",{children:[m,": ",A]})}),g&&s.jsx(ne,{as:"h2",className:"salt-p-b--2",children:g})]}),s.jsxs("div",{className:`salt-m-b--${_}`,children:[f&&!y&&s.jsx(P,{"data-test":"express-collection-description",size:"l",bold:!0,children:f}),y&&s.jsx(P,{size:"l",bold:!0,children:A}),s.jsx(xT,{delivery:i}),i.additionalInformation&&d&&s.jsx("div",{className:"salt-m-t--4",children:s.jsx(pZ,{message:i.additionalInformation})}),!t&&s.jsxs(ie.Fragment,{children:[i.additionalInformation&&!d&&s.jsx("div",{className:"salt-m-t--2",children:s.jsx(P,{"data-test":"delivery-address-additional-information",className:"salt-d--inline",children:i.additionalInformation})}),s.jsx(yL,{delivery:i})]})]}),s.jsx(cSt,{...e})]})},hSt=e=>({dateFormat:Jt(e),timeFormat:Vt(e),isAgeConfirmationEnabled:uSt(e),isConciergeDeliveryMethodEnabled:pSt(e),conciergeDelivery:xg(e)}),gSt=ot({onClickConciergeDelivery:Lr.setConciergeDelivery,sendAnalyticsEvent:U.analyticsEvent}),RL=Ct(Bt,ke(hSt,gSt))(mSt),ESt=()=>{const[e,t]=h.useState(!1);return s.jsxs(st,{expanded:e,onToggle:()=>t(n=>!n),children:[s.jsxs(st.ControlSection,{children:[s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"checkout.summary.additional.info.box.title"})}),s.jsx(st.ToggleSwitch,{})]}),s.jsx(st.ContentCollapsed,{children:s.jsx("div",{className:"salt-m-t--4",children:s.jsx(v,{id:"checkout.summary.additional.info.box.short.description"})})}),s.jsxs(st.ContentExpanded,{children:[s.jsx("div",{className:"salt-m-t--4",children:s.jsx(P,{children:s.jsx(v,{id:"checkout.summary.additional.info.box.short.description"})})}),s.jsx("div",{className:"salt-m-t--4",children:s.jsx(P,{children:s.jsx(v,{id:"checkout.summary.additional.info.box.extended.description"})})})]})]})},fSt=({billingAddress:e})=>s.jsxs(ie.Fragment,{children:[s.jsxs(P,{className:"salt-m-b--0",children:[s.jsxs(P,{bold:!0,children:[s.jsx(v,{id:"invoice.billing.address.individual.name.label"}),":"," "]}),e.fullName]}),s.jsx(P,{className:"salt-m-b--0",children:s.jsxs(P,{bold:!0,children:[s.jsx(v,{id:"invoice.billing.address.billing.address.label"}),":"]})}),s.jsxs(P,{children:[e.addressLine1,e.addressLine2?`/${e.addressLine2}`:""]}),s.jsxs(P,{children:[e.postalCode," ",e.city]})]}),ySt=({billingAddress:e})=>s.jsxs(ie.Fragment,{children:[s.jsxs(P,{className:"salt-m-b--0",children:[s.jsxs(P,{bold:!0,children:[s.jsx(v,{id:"invoice.billing.address.company.name.label"}),":"," "]}),e.fullName]}),s.jsxs(P,{className:"salt-m-b--0",children:[s.jsxs(P,{bold:!0,children:[s.jsx(v,{id:"invoice.billing.address.company.tax.number.label"}),":"," "]}),e.taxNumber]}),s.jsxs(ie.Fragment,{children:[s.jsx(P,{className:"salt-m-b--0",children:s.jsxs(P,{bold:!0,children:[s.jsx(v,{id:"invoice.billing.address.billing.address.label"}),":"]})}),s.jsxs(P,{className:"salt-m-b--0",children:[e.addressLine1,e.addressLine2?.length?`/${e.addressLine2}`:""]}),s.jsxs(P,{className:"salt-m-b--0",children:[e.postalCode," ",e.city]})]})]}),sa={INDIVIDUAL:"individual",COMPANY:"company"},ISt=()=>s.jsxs(ie.Fragment,{children:[s.jsxs(P,{bold:!0,children:[s.jsx(v,{id:"invoice.billing.address.billing.address.label"}),": "]}),s.jsx(v,{id:"invoice.billing.address.not.provided"})]}),oU=({billingAddress:e,type:t})=>{const n=h.useMemo(()=>t===sa.INDIVIDUAL?s.jsx(fSt,{billingAddress:e}):t===sa.COMPANY?s.jsx(ySt,{billingAddress:e}):s.jsx(ISt,{}),[e,t]);return s.jsx(Y,{className:"salt-m-x--0 salt-m-b--4",children:s.jsx(Y.Item,{colSpan:{xs:12,lg:6},children:s.jsx(se,{direction:t?"column":"row",children:n})})})},SSt=h.forwardRef((e,t)=>{const{formatMessage:n}=M(),{a11y:o,...r}=e,a=o||{labels:{"arrow-left":n("salt.tabs.left.arrow.a11y.label"),"arrow-right":n("salt.tabs.right.arrow.a11y.label")}};return s.jsx(If,{a11y:a,...r,ref:t})}),ki={...SSt,TabList:If.TabList,Tab:If.Tab,TabPanel:If.TabPanel},CSt=[sa.INDIVIDUAL,sa.COMPANY],TSt=({formType:e,setFormType:t})=>{const n=M();return s.jsx(ki,{selectedId:e,className:"salt-m-b--8",children:s.jsx(ki.TabList,{children:CSt.map(o=>s.jsx(ki.Tab,{id:o,onClick:()=>t(o),children:n.formatMessage(`invoice.billing.address.form.${o.toLowerCase()}`)},o))})})},{Header:_St}=G,vSt=({children:e})=>s.jsx(_St,{align:"left",children:s.jsx(ne,{as:"h1",id:dc,children:e})}),DZ=[{name:"street",validationRuleName:"addressLine1",required:!0},{name:"apartment.number",validationRuleName:"addressLine2"},{name:"postal.code",required:!0,validationRuleName:"postalCode"},{name:"city",validationRuleName:"city",required:!0}],ASt=[{name:"full.name",validationRuleName:"fullName",required:!0},...DZ],bSt=e=>{e=e.replace(/[ -]/gi,"");const t=[6,5,7,2,3,4,5,6,7];let n=0;const o=+e.substring(9);for(let r=0;r<t.length;r++)n+=+e[r]*t[r];return n%11===o},xSt=[{name:"company.name",validationRuleName:"fullName",required:!0},{name:"tax.number",validationRuleName:"taxNumber",required:!0,validate:{validateFunction:bSt,message:"invoice.billing.tax.number.invalid.error"}},...DZ],NT=e=>e.data.customer.billingAddress,RSt=e=>({fullName:qe(e,"billing-addresses-customer-details-full-name-validation")||"",companyName:qe(e,"billing-addresses-customer-details-full-name-validation")||"",addressLine1:qe(e,"customer-addresses-address-details-address-line1-validation")||"",addressLine2:qe(e,"customer-addresses-address-details-address-line2-validation")||"",city:qe(e,"customer-addresses-address-details-city-validation")||"",postalCode:qe(e,"customer-addresses-address-details-postal-code-validation")||"",taxNumber:qe(e,"billing-addresses-customer-details-tax-number-validation")||""}),DSt=e=>e.data.customer.billingAddressValidation,Wa=({isLoading:e,children:t})=>e?s.jsxs(se,{direction:"column",align:"center",children:[s.jsx(Rs,{}),s.jsx(P,{bold:!0,className:"salt-p-t--2",children:s.jsx(_t,{id:"loading.spinner.label"})})]}):s.jsx(h.Fragment,{children:t}),OZ=e=>{const t=E(RSt),{data:n,isFetching:o}=E(DSt);return{targetValidationRules:e?t:n,isFetchingValidationRules:o}},OSt={"full.name":"fullName","company.name":"companyName",street:"addressLine1","apartment.number":"addressLine2","postal.code":"postalCode",city:"city","tax.number":"taxNumber"},PSt=(e,t)=>Object.entries(t).some(([n,o])=>o!==e[n]),NSt=(e,t,n,o)=>o?t(e)||n:!0,LSt=({formFields:e,formContext:t,setIsOpen:n,formType:o})=>{const r=M(),a=F(),[i,l]=fe(["bam.av","bavm"]),{data:c}=E(NT),d=zd(),u=E(Cn),m=E(D("pcs.v2")),[g,f]=h.useState(!1),{targetValidationRules:y,isFetchingValidationRules:I}=OZ(!!l),S=o===sa.COMPANY,C=()=>{PSt(c,t.getValues())&&(m?a(Mo.withOverridePaymentMethodGroups(Mo.getOrderPaymentCheckoutSummaryWithPaymentMethodGroups)):d&&a(Mo.getOverridePaymentMethodGroups(u)))},_=()=>{const x=Object.entries(t.getValues()).reduce((B,[W,$])=>({...B,[W]:$?.trim()}),{}),{fullName:R,companyName:O,city:N,postalCode:k,taxNumber:j,addressLine1:w,addressLine2:L}=x;return{customerDetails:{fullName:S?O:R,taxNumber:S?j:void 0},addressDetails:{addressLine1:w,addressLine2:L||null,city:N,postalCode:k}}},A=async()=>{const x=_();try{await a(No.postBillingAddress(x)),C(),n(!1)}catch{z.error("toast.notification.generic.error")}};return h.useEffect(()=>{l||a(No.getBillingAddressValidationRules())},[a,l]),h.useEffect(()=>{!g&&Object.keys(c).length&&(S&&t.setValue("companyName",c.fullName),Object.entries(c).forEach(([x,R])=>t.setValue(x,R)),f(!0)),t.clearErrors()},[e,t,c,g,S]),s.jsx(Wa,{isLoading:!l&&I,children:s.jsx($n,{...t,children:s.jsx("form",{onSubmit:t.handleSubmit(A),id:"billingAddressForm",children:s.jsx("div",{children:e.map(({name:x,validationRuleName:R,required:O,validate:N})=>{const k=r.formatMessage(`invoice.billing.address.${x}.input.label`),j=R?{value:new RegExp(y[R]),message:r.formatMessage(`invoice.billing.${x}.wrong.format.error`)}:void 0,w=O?{value:!0,message:r.formatMessage("invoice.billing.required.field.error")}:void 0,L=B=>N?NSt(B,N.validateFunction,r.formatMessage(N.message),!!i):O&&(!!B.trim()||r.formatMessage("invoice.billing.required.field.error"));return s.jsx(Jo,{name:OSt[x],label:k,placeholder:k,required:w,pattern:j,validate:L},x)})})})})})},mf={"full.name":"fullName","company.name":"companyName",street:"addressLine1","apartment.number":"addressLine2","postal.code":"postalCode",city:"city","tax.number":"taxNumber"},kSt=e=>e instanceof HTMLInputElement,MSt=e=>{const t=e.querySelector(":invalid");kSt(t)&&(t?.scrollIntoView({behavior:"smooth",block:"center"}),t?.focus())},jSt=(e,t)=>Object.entries(t).some(([n,o])=>o!==e[n]),wSt=({formFields:e,setIsOpen:t,formType:n})=>{const o=M(),r=F(),[a,i]=fe(["bam.av","bavm"]),[l,c]=h.useState({}),{data:d}=E(NT),u=zd(),m=E(Cn),{targetValidationRules:g,isFetchingValidationRules:f}=OZ(!!i),y=n===sa.COMPANY,I=R=>{!jSt(d,R)&&!u||r(Mo.getOverridePaymentMethodGroups(m))},S=(R,O,N)=>a?O(R)||N:!0,C=R=>{const O=R.entries().reduce(($,[K,Q])=>({...$,[K]:Q?.toString().trim()}),{}),{fullName:N,companyName:k,city:j,postalCode:w,taxNumber:L,addressLine1:B,addressLine2:W}=O;return{customerDetails:{fullName:y?k:N,taxNumber:y?L:void 0},addressDetails:{addressLine1:B,addressLine2:W||null,city:j,postalCode:w}}},_=R=>{const O={};return e.forEach(({name:N,required:k,validate:j,validationRuleName:w})=>{const L=mf[N],B=R.elements.namedItem(L);if(!(B instanceof HTMLInputElement))return;B.setCustomValidity("");const W=B.value.trim();if(k&&!W){const $=o.formatMessage("invoice.billing.required.field.error");O[L]=$,B.setCustomValidity($);return}if(W){if(j){const $=S(W,j.validateFunction,o.formatMessage(j.message));if(typeof $=="string"){O[L]=$,B.setCustomValidity($);return}}if(w){const $=g[w];if($&&!new RegExp($).test(B.value)){const K=o.formatMessage(`invoice.billing.address.${N}.wrong.format.error`);O[L]=K,B.setCustomValidity(K);return}}}}),O},A=async R=>{R.preventDefault();const O=R.currentTarget;c({});const N=_(O);if(MSt(O),Object.values(N).length>0){c(N);return}const k=new FormData(O),j=C(k);try{await r(No.postBillingAddress(j)),I({...j.customerDetails,...j.addressDetails}),O.reset(),t(!1)}catch{z.error("toast.notification.generic.error")}};h.useEffect(()=>{i||r(No.getBillingAddressValidationRules())},[r,i]);const x=()=>{const R={};return y&&(R.companyName=d.fullName),Object.entries(d).forEach(([O,N])=>R[O]=N),R};return s.jsx(Wa,{isLoading:!i&&f,children:s.jsx(mt,{noValidate:!0,onSubmit:A,id:"billingAddressForm",children:e.map(({name:R,required:O})=>{const N=o.formatMessage(`invoice.billing.address.${R}.input.label`),k=o.formatMessage("salt.form.text-field.clear-button.a11y.label");return s.jsx(mt.TextField,{required:O,placeholder:N,className:"salt-m-b--4",label:{text:N},name:mf[R],errorMessage:l[mf[R]],defaultValue:x()[mf[R]],clearButton:{ariaLabel:k}},R)})})})},FSt=({setIsOpen:e})=>s.jsxs("div",{className:"salt-m-t--8 salt-d--flex",children:[s.jsx(b,{type:"button",fill:!0,className:"salt-m-r--2",intent:"secondary",onClick:()=>e(!1),children:s.jsx(b.Text,{children:s.jsx(v,{id:"invoice.billing.address.modal.cancel"})})}),s.jsx(b,{type:"submit",fill:!0,intent:"primary",form:"billingAddressForm",children:s.jsx(b.Text,{children:s.jsx(v,{id:"invoice.billing.address.modal.confirm"})})})]}),{Body:BSt}=G,USt="add-billing-address-modal-header",GSt=({isOpen:e,setIsOpen:t,billingAddressType:n})=>{const[o]=fe(["nfchk2"]),[r,a]=h.useState(()=>sa.INDIVIDUAL);h.useEffect(()=>a(n||sa.INDIVIDUAL),[n]);const i=Gn(),c=r===sa.INDIVIDUAL?ASt:xSt;return s.jsxs(G,{isOpen:e,onRequestClose:()=>t(!1),maxWidth:"md",aria:{labelledby:USt},children:[s.jsx(vSt,{children:s.jsx(v,{id:"invoice.billing.address.modal.header"})}),s.jsxs(BSt,{children:[s.jsx(TSt,{formType:r,setFormType:a}),o?s.jsx(wSt,{formFields:c,setIsOpen:t,formType:r}):s.jsx(LSt,{formFields:c,setIsOpen:t,formContext:i,formType:r}),s.jsx(FSt,{setIsOpen:t})]})]})},$St=()=>e=>e(No.getDefaultBillingAddress()).catch(t=>(t.statusCode!==404&&Me.api.pushError(new Error("Default billing address couldn't be fetched")),null)),HSt={getDefaultBillingAddress:$St},VSt=({setIsModalOpen:e,isBillingAddressProvided:t})=>s.jsx(b,{intent:"secondary",id:hd[Tt.messages.NO_BILLING_ADDRESS],fill:!0,onClick:()=>e(!0),children:s.jsx(b.Text,{children:t?s.jsx(v,{id:"invoice.billing.address.management.change.address.button"}):s.jsx(v,{id:"invoice.billing.address.management.add.address.button"})})}),PZ=e=>!!e&&!!Object.keys(e).length;function YSt(e){if(PZ(e))return e.taxNumber?sa.COMPANY:sa.INDIVIDUAL}const DL=({isReadOnly:e,billingAddressRef:t,orderBillingAddress:n,editOrderMode:o,className:r="salt-m-b--4"})=>{const a=F(),[i,l]=h.useState(!1),c=E(NT),d=c.data;h.useEffect(()=>{!o&&o!==null&&!e&&!c.isFetching&&!c.fetchError&&!d.billingAddressId&&a(HSt.getDefaultBillingAddress()),o&&!d.billingAddressId&&n?.billingAddressId&&a(No.setBillingAddress(n))},[a,e,d.billingAddressId,c.isFetching,c.fetchError,o,n]);const u=e?n:d,m=YSt(u);return s.jsxs(ie.Fragment,{children:[s.jsxs(ve,{"data-test":"invoice-section",className:r,tabIndex:0,"aria-describedby":"no-billing-address-a11y",ref:t,children:[s.jsxs(ne,{as:"h2",className:"salt-m-b--4",children:[s.jsx(v,{id:"invoice.billing.address.management.box.title"}),":"," ",m===sa.COMPANY?s.jsx(v,{id:"invoice.billing.address.type.company"}):s.jsx(v,{id:"invoice.billing.address.type.individual"})]}),e?s.jsx(oU,{billingAddress:u,type:m}):s.jsxs(ie.Fragment,{children:[s.jsx(oU,{billingAddress:u,type:m}),s.jsx(VSt,{setIsModalOpen:l,isBillingAddressProvided:PZ(u)})]})]}),s.jsx(GSt,{isOpen:i,setIsOpen:l,billingAddressType:m})]})},pv="concierge-delivery-error-modal-header",WSt=D("m.la.h"),qSt=({onCancel:e=()=>{},onSubmit:t=()=>{},modalLeftAlignEnabled:n})=>{const o=E(Ue("conciergeDeliveryError")),r=F(),a=h.useCallback(()=>{e(),r(Z.closeModal())},[r,e]),i=h.useCallback(l=>{t(l),r(Z.closeModal())},[r,t]);return s.jsxs(G,{isOpen:o,onRequestClose:a,aria:{labelledby:pv},children:[s.jsx(G.Header,{align:n?"left":"center",children:s.jsx(ne,{as:"h2",id:pv,"data-test":pv,children:s.jsx(v,{id:"checkout.summary.concierge.delivery.error.modal.header"})})}),s.jsx(G.Body,{children:s.jsx(v,{id:"checkout.summary.concierge.delivery.error.modal.text"})}),s.jsxs(G.Footer,{className:"salt-gap--2",align:n?"left":"center",children:[s.jsx(b,{intent:"secondary",onClick:a,"data-test":"concierge-delivery-error-modal-cancel-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"request.error.cancel.button"})})}),s.jsx(b,{intent:"primary",onClick:i,"data-test":"concierge-delivery-error-modal-submit-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.next.line1"})})})]})]})},KSt=e=>({modalLeftAlignEnabled:WSt(e)}),zSt=ke(KSt)(qSt),QSt=D("pay.nsc"),XSt=D("pay.ew"),ZSt=D("pay.ywlt"),NZ=()=>{const e=F(),t=E(QSt),n=E(XSt),o=E(ZSt),r=E(fae),a=t&&!o;h.useEffect(()=>{a?e(kt.setToSavePaymentMethod(r)):n&&e(kt.setToSavePaymentMethod(!0))},[])},OL=()=>{const e=E(D(fz)),t=E(D(IVe)),n=E(D(yz));return e&&t&&!n},JSt=({actualAmount:e,expectedAmount:t,reason:n,transformed:o})=>({productId:o.productId,name:o.name,image:o.image,alternatives:o.alternatives,reason:n,price:(({original:r,current:a,reference:i})=>({original:r,current:a,reference:i}))(o.price),...t&&{requestedAmount:t},...e&&{addedAmount:e},missingAmount:Math.abs(e-t),...o.timeRestriction&&{timeRestriction:o.timeRestriction},...o.checkoutTimeRestriction&&{checkoutTimeRestriction:o.checkoutTimeRestriction},...o.alcohol&&{alcohol:o.alcohol},...o.deliveryTimeRestrictionMessage&&{deliveryTimeRestrictionMessage:o.deliveryTimeRestrictionMessage},...o.checkoutTimeRestrictionMessage&&{checkoutTimeRestrictionMessage:o.checkoutTimeRestrictionMessage}}),eCt=(e=[])=>e.map(({actualAmount:t,expectedAmount:n,reason:o,product:r})=>JSt({actualAmount:t,expectedAmount:n,reason:o,transformed:r})),tCt=(e,t)=>{const n=e.map(({reason:o,expectedQuantity:r,actualQuantity:a,productId:i})=>({productId:i,actualAmount:a,expectedAmount:r,reason:o,product:t.find(l=>l.productId===i)}));return eCt(n)},sCt=D("di"),nCt=async(e,t,n,o,r)=>e(Ft.decorateProductsPPWSAction(t)).then(async a=>{const{payload:{responseData:i}}=a;await e(wc.setLimitedProducts(tCt(o,i.products.map(l=>tl(l,io(n)??[],sCt(n)))),r))}),oCt=()=>(e,t)=>e(wc.getCheckoutValidation()).then(async n=>{if(n){const{limitedProducts:o,cartSplitRequired:r}=n.payload.responseData;if(o?.length>0){const a=o.map(l=>l.productId),i=t();await nCt(e,a,i,o,r)}else await e(wc.setLimitedProducts([],r))}}).catch(n=>{Me.api.pushError(new Error("Couldn't fetch checkout items restrictions"),{context:{errorMessage:n.message}})}),rCt={fetchCheckoutValidation:oCt},{CheckboxIconOff:aCt,CheckboxIconOn:iCt,CheckboxText:lCt,ContentWrapper:cCt}=kS;function fI({name:e,label:t,required:n,description:o=null,bold:r=!0,value:a,...i}){const l=$o(),c=l.watch(e),d=nP(e,l),u=!c&&!!d;return s.jsx(ie.Fragment,{children:s.jsx(Oa,{children:s.jsxs(bn,{onClick:()=>{l.trigger(e)},hasError:u,htmlFor:e,children:[s.jsx("input",{type:"checkbox",id:e,"data-test":e,...i,...l.register(e,{required:n})}),c?s.jsx(iCt,{name:"checkbox_on"}):s.jsx(aCt,{name:"checkbox_off"}),s.jsxs(P,{children:[s.jsx(lCt,{bold:r,children:t}),s.jsxs(cCt,{children:[o,u&&s.jsx(Ua,{role:"alert",children:d})]})]})]})})})}const Kr="SELECT_ALL",Hu="CONSENT",PL="terms-and-conditions-modal",{Header:dCt}=G,LZ=({children:e})=>s.jsx(dCt,{align:"left",children:s.jsx(ne,{as:"h1",id:PL,className:"salt-p-y--4",children:e})}),kZ=({setIsOpen:e,isSaltFormEnabledForCheckout:t})=>s.jsxs("div",{className:"salt-p-t--4 salt-p-b--8 salt-p-x--8 salt-d--flex",children:[s.jsx(b,{type:"button",fill:!0,className:"salt-m-r--2",intent:"secondary",onClick:()=>e(!1),children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.terms.and.conditions.modal.cancel.button"})})}),s.jsx(b,{type:"submit",fill:!0,intent:"primary",form:t?void 0:"termsAndConditions",children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.terms.and.conditions.modal.place.order.button"})})})]}),uCt=({check:e,index:t,areAllChecked:n,watch:o,setValue:r,setError:a,getFieldState:i,clearErrors:l})=>{const{preLinkText:c,link:d,postLinkText:u,linkText:m}=e,{formatMessage:g}=M(),f=C=>{r(C,!o(C)),n()?(r(Kr,!0),l(Kr)):(r(Kr,!1),a(Kr,{message:g("checkout.summary.terms.and.conditions.modal.agree.to.all.error")}))},y=()=>i(Kr).invalid&&!o(`${Hu}-${t}`),I=s.jsxs("span",{style:{color:`${y()?"var(--typography-error, var(--intent-error))":"inherit"}`},children:[s.jsx("sup",{children:"*"}),c,s.jsx(rt,{style:{color:"inherit"},target:"_blank",href:d,children:m}),u]}),S=`${Hu}-${t}`;return s.jsx(fI,{name:S,label:I,bold:!1,onClick:()=>f(S),className:"salt-m-l--8"})},MZ=()=>{const{formatMessage:e}=M();return s.jsxs(P,{children:[s.jsx(v,{id:"checkout.summary.terms.and.conditions.modal.gdpr.text"})," ",s.jsxs(rt,{href:e("checkout.summary.terms.and.conditions.modal.gdpr.privacy.policy.url"),children:[" ",s.jsx(v,{id:"checkout.summary.terms.and.conditions.modal.gdpr.privacy.policy"})]})]})},{Body:pCt}=G,mCt=({isOpen:e,setIsOpen:t,checkout:n})=>{const{formatMessage:o}=M(),r=F(),a=E(r6),i=E(a6),l=Gn(),{watch:c,setValue:d,handleSubmit:u,setError:m,getFieldState:g,clearErrors:f}=l;h.useEffect(()=>{(async()=>{try{await r(Gm.getTermsAndConditions())}catch{Me.api.pushError(new Error("Terms and conditions fetch error"))}})()},[r]);const y=C=>a.forEach((_,A)=>{d(`${Hu}-${A}`,C)}),I=()=>c(a.map((C,_)=>`${Hu}-${_}`)).every(C=>!!C),S=()=>{d(Kr,!c(Kr)),c(Kr)?y(!0):y(!1)};return s.jsxs(G,{isOpen:e,onRequestClose:()=>t(!1),maxWidth:"md",aria:{labelledby:PL},isLoading:i,children:[s.jsx(LZ,{children:s.jsx(v,{id:"checkout.summary.terms.and.conditions.modal.header"})}),s.jsxs(pCt,{className:"salt-p-t--0",children:[s.jsx($n,{...l,children:s.jsxs("form",{id:"termsAndConditions",onSubmit:u(n),className:"salt-m-b--8",children:[s.jsx(fI,{name:Kr,label:o("checkout.summary.terms.and.conditions.modal.agree.to.all"),onClick:S,bold:!1,required:{value:!0,message:o("checkout.summary.terms.and.conditions.modal.agree.to.all.error")}}),a.map((C,_)=>{const A=`${Hu}-${_}`;return s.jsx(uCt,{areAllChecked:I,index:_,check:C,watch:c,setValue:d,setError:m,getFieldState:g,clearErrors:f},A)})]})}),s.jsx(MZ,{})]}),s.jsx(kZ,{setIsOpen:t})]})},ly="SLOT_NOT_DELIVERABLE_MODAL_NAME",hCt=()=>{const e=F(),t=E(Ue(ly)),n=()=>e(Z.closeModal());return s.jsxs(G,{showCloseIcon:!0,onRequestClose:n,isOpen:t,aria:{labelledby:ly},children:[s.jsx(G.Header,{align:"left","aria-live":"polite",children:s.jsx(ne,{as:"h1",id:ly,children:s.jsx(v,{id:"checkout.summary.slot.not.deliverable.modal.title"})})},"header"),s.jsx(G.Body,{children:s.jsx(v,{id:"checkout.summary.slot.not.deliverable.modal.description"})},"body"),s.jsxs(G.Footer,{align:"left",children:[s.jsx(b,{className:"salt-m-l--1 salt-m-r--1",onClick:n,intent:"secondary",fill:!0,children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.slot.not.deliverable.modal.cancel.button"})})}),s.jsx(b,{className:"salt-m-r--1 salt-m-l--1",onClick:n,intent:"primary",fill:!0,asChild:!0,"data-test":"select-shipping-method-button",children:s.jsx(rt,{intent:"ghost",href:sr({inCheckoutWalk:!0}),children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.slot.not.deliverable.modal.select.shipping.method.button"})})})})]},"footer")]})},gCt=({isOpen:e,onConfirm:t,pendingRecurringOrders:n})=>{const[o]=fe(["nfchk"]),{formatMessage:r}=M(),a=F(),i=E(Dz),l=E(Jt),c=()=>{a(Z.closeModal())},d=y=>{try{t(y),localStorage.setItem("editRecurringOrderOption",i)}catch{localStorage.removeItem("editRecurringOrderOption")}c()},u=y=>{const{value:I}=y.target;a(GA.setEditRecurringOrderOption(I))},m=y=>{a(GA.setEditRecurringOrderOption(y))},g=n.map(y=>Ks(l,y.date)).join(", "),f=[{value:Ni.THIS_ORDER_ONLY,label:r("edit.recurring.order.modal.option.one")},{value:Ni.THIS_AND_FUTURE_ORDERS,label:r("edit.recurring.order.modal.option.two"),additionalText:r("edit.recurring.order.modal.option.two.subtext"),progressiveDisclosure:n.length>0?s.jsx(Ce,{size:"s",text:s.jsxs(se,{children:[r("edit.recurring.order.modal.banner.alert.text"),s.jsx(P,{size:"s",children:g})]}),intent:"warning"}):null}];return s.jsxs(G,{isOpen:e,onRequestClose:c,closeMessage:r("edit.recurring.order.modal.close.icon"),children:[s.jsx(G.Header,{align:"left",children:s.jsx(ne,{as:"h2",children:r("edit.recurring.order.modal.title")})}),s.jsx(G.Body,{children:o?s.jsx(ve,{children:s.jsx(mt.RadioGroup,{groupLabel:{text:r("edit.recurring.order.modal.title"),isVisuallyConcealed:!0},name:"editRecurringOrder",value:i,onChange:m,radios:f,required:!0})}):s.jsxs(se,{className:"salt-gap-y--2",children:[s.jsx(ia,{checked:i===Ni.THIS_ORDER_ONLY,"data-test":"this-order-only-option",value:Ni.THIS_ORDER_ONLY,disabled:!1,label:"",last:!0,bold:!1,error:"",role:void 0,onChange:u,children:r("edit.recurring.order.modal.option.one")},""),s.jsx(ia,{checked:i===Ni.THIS_AND_FUTURE_ORDERS,"data-test":"this-and-future-orders-option",value:Ni.THIS_AND_FUTURE_ORDERS,disabled:!1,label:"",last:!0,bold:!1,error:"",role:void 0,onChange:u,children:s.jsxs(se,{children:[r("edit.recurring.order.modal.option.two"),s.jsx(P,{size:"s",children:r("edit.recurring.order.modal.option.two.subtext")})]})},""),i===Ni.THIS_AND_FUTURE_ORDERS&&n.length>0&&s.jsx(Ce,{text:s.jsxs(se,{children:[r("edit.recurring.order.modal.banner.alert.text"),s.jsx(P,{children:g})]}),intent:"warning",showIcon:!1})]})}),s.jsxs(G.Footer,{align:"center",className:"salt-gap-x--2",children:[s.jsx(b,{intent:"secondary",onClick:c,fill:!0,children:s.jsx(b.Text,{children:r("edit.recurring.order.modal.cancel.button")})}),s.jsx(b,{intent:"primary",onClick:d,fill:!0,children:s.jsx(b.Text,{children:r("edit.recurring.order.modal.confirm.button")})})]})]})};class ECt extends Error{}class fCt extends Error{}const{Body:yCt}=G,ICt=({isOpen:e,setIsOpen:t,checkout:n})=>{const{formatMessage:o}=M(),r=F(),a=E(r6),i=E(a6),l=h.useRef(null),[c,d]=h.useState("");h.useEffect(()=>{async function I(){try{await r(Gm.getTermsAndConditions())}catch{Me.api.pushError(new Error("Terms and conditions fetch error"))}}I()},[r]);const u=I=>{I.preventDefault();const S=I.currentTarget;new FormData(S).get(Kr)?n():d(o("checkout.summary.terms.and.conditions.modal.agree.to.all.error"))},m=()=>{l.current?.reset(),d(""),t(!1)},g={label:o("checkout.summary.terms.and.conditions.modal.agree.to.all"),value:Kr,name:Kr},f=a.map((I,S)=>{const C=s.jsxs("span",{children:[I.preLinkText," ",s.jsx(rt,{target:"_blank",href:I.link,children:I.linkText})," ",I.postLinkText]}),_=`${Hu}-${S}`;return{label:C,value:_,name:_}}),y=[g,...f];return s.jsx(G,{isOpen:e,onRequestClose:m,maxWidth:"md",aria:{labelledby:PL},isLoading:i,children:s.jsxs(mt,{ref:l,onSubmit:u,noValidate:!0,children:[s.jsx(LZ,{children:s.jsx(v,{id:"checkout.summary.terms.and.conditions.modal.header"})}),s.jsxs(yCt,{className:"salt-p-t--0",children:[s.jsx(mt.CheckboxList,{groupLabel:o("checkout.summary.terms.and.conditions.modal.header"),options:y,nested:!0,className:"salt-m-b--8",required:!0,error:c}),s.jsx(MZ,{})]}),s.jsx(kZ,{setIsOpen:t,isSaltFormEnabledForCheckout:!0})]})})},SCt=D("gtm.opfc"),CCt=e=>({"client-route-id":wa(e),"X-CSRF-TOKEN":Va(e),"Content-Type":"application/json"}),TCt=({navigate:e,resultToken:t})=>(n,o)=>{const r=o(),a=Wt(r);return fetch(Ii({basePath:a,target:"/v1/orderpayment/checkout/validate"}),{credentials:"same-origin",method:"POST",headers:CCt(r),body:JSON.stringify({resultToken:t})}).then(i=>i.json().then(l=>({response:i,data:l}))).then(({data:i,response:l})=>{if(l&&!l.ok){const c=new Error;return c.statusCode=l.status,c.message=i.message,Promise.reject(c)}return i}).then(async i=>{const l=!SCt(r),{analyticsPayload:c,isOrderFetched:d}=await n(U8(!0,i));d&&(l?n(U.analyticsEvent({type:_e.ORDER_PURCHASED,...c})):localStorage.setItem(uh,JSON.stringify(c)),c.recurringShoppingDefinition&&n(U.analyticsEvent({type:_e.RECURRING_ORDER_CREATED,recurringShoppingDefinition:c.recurringShoppingDefinition}))),n(Ht.getBasket()),e(Zh({orderId:i.orderId}))}).catch(i=>{(i.statusCode===401||i.statusCode===403)&&window.location.assign(Fr({basePath:a,queryString:`destination=${encodeURIComponent(tr({basePath:a}))}`}));const l=i.message&&mS(i.message)?i.message:"order.cow.3ds.error";z.error(l),n(U.analyticsEvent({type:_e.PLACE_ORDER,status:"FAILURE",error:`FAILED_AFTER_CLICK - ${l}`})),e(tr())})},_Ct={validateCheckout:TCt},NL=()=>{const e=F(),t=We(),n=Ne(),{recoveryToken:o}=tt.parse(n.search),r=!!o;return{canCheckout:()=>e(KP()).then(({canCheckout:l,redirect:c})=>(l||t(c),l)),handlePaymentAuthenticationSuccess:l=>(e(ks({name:r?xTe:bTe})),e(_Ct.validateCheckout({navigate:t,resultToken:l.resultToken})))}},vCt=D("pay.nsc"),ACt=D("pay.ew"),bCt=D("pay.nsd"),xCt=D("rec.o"),RCt=D("pay.check.use"),DCt=D("ag"),OCt=D("cdm"),PCt=D("bam"),NCt=D("bam.r"),LCt=D("cs.tcd"),kCt=D("ro.e"),MCt=D("loy.waon"),jCt=D("oed"),wCt=D("pcs.v2"),FCt=e=>{const{actions:t,basket:n,walletItemId:o,conciergeDeliveryState:r,isUnsavedPaymentMethodSelected:a,psp:i=null,isBasketOrderUnderEdit:l,isRecurringShoppingDefinitionCreateFormValid:c,recurringShoppingDefinitionCreateFormFieldsValidation:d,isUsePaymentChecksEnabled:u,selectedRecurringShoppingDefinitionCreateFrequency:m,selectedRecurringShoppingDefinitionName:g,setUnresolvableCheckoutErrorAlert:f,appliedPaymentChecks:y=[],isAgeConfirmationEnabled:I,isConciergeEnabled:S,setAgeConfirmationError:C,wallet:_,basketHasItems:A,basketThreshold:x,isNonSavedCardPaymentEnabled:R,isExternalWalletEnabled:O,isRecurringOrdersEnabled:N,scrollToRecurringShoppingDefinitionCreateSection:k,isTermsAndConditionsAcknowledged:j,setTermsAndConditionsAcknowledgeError:w,setFinancingProviderNotSelectedError:L,scrollToPaymentSection:B,updateRecurringDefinitionPayment:W,isNonSavedDialogEnabled:$,setPsp:K,paymentSession:Q,toSavePaymentMethod:X,isRecurringOrdersSelected:re,retailerFinancingPlanId:ue,paymentOptionAndType:{paymentOption:te,paymentType:ce},selectedRetailerFinancingProvider:de,selectedFinancingProviderId:ye,billingAddressManagementEnabled:Ae,billingAddress:Je,scrollToBillingAddressSection:Ie,mandatoryBillingAddressEnabled:je,termsAndConditionsDialogEnabled:Le,editRecurringOrdersEnabled:Be,currentOrderEntity:be,currentRecurringOrderId:he,pendingOrders:ge,recurringOrder:Oe,editRecurringOrderOption:Xe,isOrderEditDifferenceEnabled:Se,isLoyaltyPaymentEnabled:dt,isPaymentCheckoutSummaryV2Enabled:et,className:we=""}=e,[Ut,ys]=h.useState(!1),Xs=E(Jn),Ur=E(OQe),as=cZ(),Gr=E(JO),es=zd(),{focusErrorElement:nu}=aSt(),pr=F(),$r=We(),fc=ze(),{formatNumber:yc}=M(),ou=E(Ue("EditRecurringOrders")),{checkoutPayment:Ic,checkoutRestrictions:Nn,currency:Hr}=jh()||{},Ia=!N||l||c,to=te===ct.PAY_NOW&&!O,Eo=to&&!o&&!a,Sc=_.items.find(ut=>ut.isDefault),Di=Sc&&Sc.expired,Il=to&&!R&&!_.items.length,Cc=OL(),{ageConfirmed:mr}=CIt(),s_=E(D("cs.tca"));NZ();const[ru]=fe(["nfchk2"]),[SM,CM]=h.useState(!1),TM=!!Object.keys(Je).length,bE=jh(),_M=fL(),{hideLoyaltyPaymentButton:_oe}=dZ(),Ka=h.useCallback((ut,ss)=>z.warning(ut,ss),[]),vM=h.useCallback(()=>Ia?cn:(k(),{status:Tt.status.FAILURE,message:Tt.messages.RECURRING_SHOPPING_DEFINITION_CREATE_FORM_INCOMPLETE,metadata:{...!d.recurringShoppingDefinition&&{isRecurringDefinitionValid:Tt.messages.RECURRING_SHOPPING_DEFINITION_CREATE_FORM_INCOMPLETE_DEFINITION},...!d.recurringName&&{isRecurringNameValid:Tt.messages.RECURRING_SHOPPING_DEFINITION_CREATE_FORM_INCOMPLETE_NAME}}}),[Ia,k]),AM=h.useCallback(()=>Cc&&re&&!X?(t.setIsToSavePaymentMethodValid(!1),{status:Tt.status.FAILURE,message:Tt.messages.RECURRING_ORDERS_TO_SAVE_PAYMENT_METHOD_UNCHECKED}):cn,[re,X,Cc]),bM=h.useCallback(()=>n.slot?cn:{status:Tt.status.FAILURE,message:Tt.messages.NO_SLOT_SELECTED},[n]),xM=h.useCallback(()=>n?.checkout?.canCheckout?cn:{status:Tt.status.FAILURE,message:Tt.messages.BASKET_MARKED_CANNOT_CHECKOUT},[n]),RM=h.useCallback(()=>n?.checkout?.basketAboveThreshold?cn:{status:Tt.status.FAILURE,message:Tt.messages.BASKET_BELOW_THRESHOLD},[n]),DM=h.useCallback(()=>s_&&!j?(w(),{status:Tt.status.FAILURE,message:Tt.messages.TERMS_AND_CONDITIONS_UNCHECKED}):cn,[j,w]),OM=h.useCallback(()=>{const ut=et&&as?.some(ss=>ss.name!==ct.LOYALTY&&ss.displayable);return Eo&&ut?(t.setUnselectedPaymentWarning(!0),B(),{status:Tt.status.FAILURE,message:Tt.messages.NO_WALLET_ITEM_SELECTED}):cn},[t,Eo,B]),PM=h.useCallback(()=>Eo&&Di?(Ka("checkout.summary.default.payment.method.expired.toast",{id:"payment-notification-a11y"}),t.setUnselectedPaymentWarning(!0),B(),{status:Tt.status.FAILURE,message:Tt.messages.DEFAULT_WALLET_ITEM_EXPIRED}):cn,[t,Di,Eo,B,Ka]),NM=h.useCallback(()=>Il?(Ka("checkout.summary.no.payment.method.toast",{id:"payment-notification-a11y"}),B(),{status:Tt.status.FAILURE,message:Tt.messages.EMPTY_WALLET}):cn,[Il,B,Ka]),LM=h.useCallback(()=>I&&n.ageRestriction&&!mr?(C?.(),{status:Tt.status.FAILURE,message:Tt.messages.AGE_CHECK_NOT_CONFIRMED}):cn,[mr,n,I,C]),voe=h.useCallback(()=>Ae&&je&&!TM?(Ka("checkout.summary.no.billing.address.toast",{id:"no-billing-address-a11y"}),Ie(),{status:Tt.status.FAILURE,message:Tt.messages.NO_BILLING_ADDRESS}):cn,[Ae,TM,Ka]),kM=h.useCallback(async()=>{if(!S||r.initialValue===r.currentValue||r.currentValue===null||!n?.slot?.slotId)return cn;try{return await t.saveConciergeDelivery(r.currentValue),r.currentValue?t.sendAnalyticsEvent({type:_e.CONCIERGE_CHECK_BOX_CHECKED}):t.sendAnalyticsEvent({type:_e.CONCIERGE_CHECK_BOX_UNCHECKED}),cn}catch{return t.openConciergeDeliveryErrorModal(),{status:Tt.status.FAILURE,message:Tt.messages.CONCIERGE_SAVING_ERROR}}},[t,n,r,S]),MM=h.useCallback(async()=>{if(u&&y.length>0){const ut=await t.fetchAvailablePaymentChecks({basketTotal:n?.totals?.finalPrice,orderId:n.orderId});if(ut?.payload?.responseData){const{availablePaymentChecks:ss}=ut.payload.responseData;if(!y.every(cm=>ss.find(JM=>JM.paymentCheckId===cm.paymentCheckId)))return Ka("checkout.summary.bonus.check.not.available.toast"),{status:Tt.status.FAILURE,message:Tt.messages.BONUS_CHECK_NOT_AVAILABLE}}}return cn},[t,y,n,u,Ka]),jM=h.useCallback(()=>Ur?(Ka("toast.notification.generic.error"),{status:Tt.status.FAILURE,message:Tt.messages.TERMS_AND_CONDITIONS_FETCH_ERROR}):cn,[Ur]),wM=h.useCallback(()=>!et&&te===ct.LOYALTY?cn:es&&as&&!as.find(ut=>ut.name===te&&ut.available)?(Ka("checkout.summary.payment.options.payAtDelivery.limitation.warning",{id:"payment-notification-a11y"}),B(),Me.api.pushError(new fCt(`selected: ${te}, available: ${JSON.stringify(as)}`)),{status:Tt.status.FAILURE,message:Tt.messages.UNSUPPORTED_PAYMENT_METHOD_GROUP_ERROR}):cn,[te,as]),FM=h.useCallback(()=>{const ut=Gr?.financingProviders,ss=!Se||!!Number(Ic?.amountToBeCharged);return te===ct.INSTALMENTS&&ut&&ut.length>0&&!de&&ss?(B(),L(),{status:Tt.status.FAILURE,message:Tt.messages.NO_FINANCING_PROVIDER_SELECTED}):cn},[de,te,Gr,L,Ic?.amountToBeCharged]),BM=h.useCallback(()=>fc(x),[x,fc]),UM=h.useCallback((ut,ss)=>{t.analyticsEvent({type:_e.PLACE_ORDER,status:ut.status,error:ut.message,walletItemId:o,isRecurringShoppingDefinitionCreationRequested:ss})},[t,o]),GM=h.useCallback(()=>{t.analyticsEvent({type:_e.PLACE_ORDER_CONFIRMATION,isEditedOrder:l});const ut={event:"event",ecommType:"enhanced",eventCategory:"Checkout Funnel",eventAction:"CheckoutConfirmation",eventLabel:"Not Set",ecommerce:{checkout:{actionField:{step:6,option:l?"edited-order":"new-order"},products:Xs.map(ss=>Ys(ss))}}};J.sendEvent({GA:ut,WA:null})},[t,l,Xs]),$M=h.useCallback(()=>n?.checkout?.checkoutRestrictions?.includes(W2.INVALID_SLOT)?{status:Tt.status.FAILURE,message:Tt.messages.INVALID_SLOT_ERROR}:cn,[n]),HM=h.useCallback(()=>{const ut={CHARGE_AMOUNT_BELOW_THRESHOLD:"checkout.summary.chargeBelowThreshold.error"};return Nn&&Nn.length>0?(Nn.forEach(({type:ss,minimum:Pt})=>{z.warning({key:ut[ss],substitutions:{amount:yc(Number(Pt),{style:"currency",currency:Hr})}},{id:"payment-notification-a11y"})}),{status:Tt.status.FAILURE,message:Tt.messages.PAYMENT_CHECKOUT_RESTRICTION}):cn},[Nn?.length]),VM=h.useCallback(()=>dt&&Se&&et&&as&&_M&&!WM(as)?.available?(z.error("toast.notification.generic.error"),Me.api.pushError(new ECt("No available payment method error")),{status:Tt.status.FAILURE,message:Tt.messages.NO_AVAILABLE_PAYMENT_METHOD}):cn,[_M,_oe]),YM=h.useCallback(async()=>$M()||NM()||PM()||OM()||DM()||FM()||LM()||RM()||xM()||bM()||vM()||AM()||voe()||await MM()||await kM()||jM()||wM()||HM()||VM()||qIt,[$M,LM,RM,xM,MM,PM,OM,bM,NM,vM,DM,AM,kM,jM,wM,FM,HM,VM]),xE=h.useCallback(()=>N&&g!==""&&m&&m!==Lo&&!l?{name:g,frequency:k2e[m]}:void 0,[N,m,g,l]),WM=ut=>ut?.find(({name:ss})=>ss===ct.LOYALTY),Aoe=te===ct.INSTALMENTS&&ue?{instalmentsOptions:{retailerFinancingPlanId:ue===Sz?null:ue,retailerFinancingProviderId:de,financingProviderId:ye}}:{},qM=()=>({...Aoe,group:te,type:ce||"UNKNOWN",toSave:[ct.PAY_NOW,ct.UNKNOWN].includes(te)&&X,walletItemId:o}),boe=ut=>{if(ut?.paymentMethodGroups.filter(Pt=>Pt.name!==ct.LOYALTY).every(({displayable:Pt})=>!Pt)&&dt&&Se){const Pt=WM(ut?.paymentMethodGroups||[]);return{group:ct.LOYALTY,type:Pt?.applicableType}}return qM()},xoe=ut=>dt&&Se&&Number(bE?.checkoutPayment.amountPaidByCustomer)===0&&Number(bE?.checkoutPayment.amountToBeCharged)===0?{group:ut?.loyaltyPaymentMethod?.group,type:ut?.loyaltyPaymentMethod?.type}:qM(),Roe=()=>et?boe(bE):xoe(bE),KM=()=>be!==void 0&&be.recurringShoppingDefinition,Doe=()=>{if(!l)return;const ut=Be?Xe==="THIS_AND_FUTURE_ORDERS":void 0;if(!(ut===void 0&&W===void 0))return{replaceItems:ut,replacePayment:W}},Ooe=()=>{const ut=xE();if(!ut&&!l||l&&!KM())return;const ss=Doe();if(!ut&&!ss)return;let Pt={};return ut&&(Pt={...Pt,signup:ut}),ss&&(Pt={...Pt,edit:ss}),Pt},{handlePaymentAuthenticationSuccess:Poe}=NL(),Noe=M(),zM=h.useCallback(()=>{const ut=Ooe(),ss={paymentSession:Q,billingAddressId:Je.billingAddressId,paymentMethod:Roe(),...u&&y&&{paymentCheckIds:y.map(Pt=>Pt.paymentCheckId)},...ut?{recurringOrder:ut}:{},psp:i};t.makeCheckoutRequest($r,ss,Poe,Noe,{threshold:BM()}).then(Pt=>{Pt&&Pt.error&&(Pt.errorMessageKey&&eQ.includes(Pt.errorMessageKey)&&t.fetchCheckoutValidation().then(()=>{t.openUnavailableItemsModal({checkoutErrorCode:Pt.errorMessageKey})}),Pt.errorMessageKey&&Pt.errorMessageKey===J8&&t.openSlotNotDeliverableModal(),Pt.showErrorAsAlert&&f(Pt.errorMessageKey))})},[t,y,BM,xE,u,i,f,o,W,Q,X]),n_=()=>{GM(),Q.requestPayment(),zM()},lm=h.useCallback(async ut=>{t.performanceMark({name:ATe,event:ut,attributes:void 0});const ss=await YM();ss.status===Tt.status.FAILURE&&nu(ss.message,ss.metadata);const Pt=!!xE();UM(ss,Pt),ss.status===Tt.status.SUCCESS?Le?ys(!0):n_():(ss.message===Tt.messages.INVALID_SLOT_ERROR&&t.openInvalidSlotModal(),CM(!1))},[Q,t,xE,zM,GM,UM,YM]);h.useEffect(()=>{SM&&lm()},[SM]);const QM=h.useCallback(ut=>{K(ut,()=>{CM(!0)})},[K]),XM=h.useCallback(ut=>{$&&!o?t.openNonSavedPspModal({setPsp:QM}):lm(ut)},[t,lm,$,QM,o]),Loe=h.useCallback(ut=>{t.setConciergeDelivery(r.initialValue),lm(ut)},[t,lm,r]),koe=()=>{pr(Z.openModal("EditRecurringOrders"))},Moe=()=>{const ut=be?.groupedProducts?.products?.map(Pt=>({productId:Pt.productId,quantity:Pt.quantity}))??[],ss=n.items.map(Pt=>({productId:Pt.productId,quantity:Pt.quantity.quantityInBasket}));return ut?.length!==ss.length?!0:ut.every(({quantity:Pt,productId:cm})=>ss.filter(ej=>ej.productId===cm&&ej.quantity!==Pt).length>0)},ZM=()=>ge.orders.map(Pt=>({orderId:Pt.orderId,date:Pt.dates.deliveryStartDate,recurringOrder:Pt.recurringShoppingDefinition?.definitionId??null})).filter(Pt=>Pt.recurringOrder===he&&Pt.orderId!==n.orderId).sort((Pt,cm)=>le(Pt.date)-le(cm.date)),joe=()=>{if(Oe?.definitionId===he)return!0;const ut=le(be.dates.deliveryStartDate);return ZM().some(ss=>le(ss.date)>ut)},woe=()=>KM()?joe():!1,Foe=ut=>{Be&&woe()&&Moe()?koe():XM(ut)};return s.jsxs(h.Fragment,{children:[s.jsx(b,{intent:"action",fill:!0,disabled:!A,onClick:Foe,"data-synthetics":"place-order-button","data-test":"place-order-button",className:we,children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.next.line1"})})}),S&&s.jsx(zSt,{onSubmit:Loe}),Le&&ru&&s.jsx(ICt,{isOpen:Ut,setIsOpen:ys,checkout:n_}),Le&&!ru&&s.jsx(mCt,{isOpen:Ut,setIsOpen:ys,checkout:n_}),ou&&s.jsx(gCt,{isOpen:ou,onConfirm:XM,pendingRecurringOrders:ZM()})]})},BCt=e=>{const t=Zt(e),n=nl(e,t.orderId),o=n?.recurringShoppingDefinition?.definitionId,r=Xl(e),a=DO(o)(e);return{basket:t,wallet:Pg(e),conciergeDeliveryState:K0e(e),basketHasItems:gi(e),basketThreshold:cS(e),isBasketOrderUnderEdit:Mr(e),isNonSavedCardPaymentEnabled:vCt(e),isNonSavedDialogEnabled:bCt(e),isExternalWalletEnabled:ACt(e),isRecurringOrdersEnabled:xCt(e),isRecurringShoppingDefinitionCreateFormValid:w2e(e),recurringShoppingDefinitionCreateFormFieldsValidation:F2e(e),selectedRecurringShoppingDefinitionCreateFrequency:Rg(e),selectedRecurringShoppingDefinitionName:Rz(e),isUsePaymentChecksEnabled:RCt(e),appliedPaymentChecks:rx(e),isAgeConfirmationEnabled:DCt(e),isConciergeEnabled:OCt(e),toSavePaymentMethod:Dg(e),isRecurringOrdersSelected:CO(e),retailerFinancingPlanId:Bz(e),paymentOptionAndType:jp(e),selectedRetailerFinancingProvider:_O(e),selectedFinancingProviderId:vO(e),billingAddressManagementEnabled:PCt(e),billingAddress:NT(e).data,mandatoryBillingAddressEnabled:NCt(e),termsAndConditionsDialogEnabled:LCt(e),editRecurringOrdersEnabled:kCt(e),currentOrderEntity:n,currentRecurringOrderId:o,pendingOrders:r,recurringOrder:a,editRecurringOrderOption:Dz(e),isLoyaltyPaymentEnabled:MCt(e),isOrderEditDifferenceEnabled:jCt(e),isPaymentCheckoutSummaryV2Enabled:wCt(e)}},UCt=e=>({actions:Ki({makeCheckoutRequest:Cnt,setUnselectedPaymentWarning:kt.setUnselectedPaymentWarning,analyticsEvent:U.analyticsEvent,performanceMark:ks,fetchAvailablePaymentChecks:t=>gL.fetchAvailablePaymentChecks(t),openConciergeDeliveryErrorModal:()=>Z.openModal("conciergeDeliveryError"),sendAnalyticsEvent:U.analyticsEvent,saveConciergeDelivery:eZ.saveConciergeDelivery,setConciergeDelivery:Lr.setConciergeDelivery,openNonSavedPspModal:t=>Z.openModal("selectNonSavedPspModal",t),setIsToSavePaymentMethodValid:kt.setIsToSavePaymentMethodValid,fetchCheckoutValidation:rCt.fetchCheckoutValidation,openUnavailableItemsModal:t=>Z.openModal(Mh,t),openSlotNotDeliverableModal:t=>Z.openModal(ly,t),openInvalidSlotModal:()=>Z.openModal(LD)},e)}),jZ=ke(BCt,UCt)(FCt),GCt=({basketSummary:e,page:t})=>{const n=E(sT),o=E(aQ),r=E(iQ),a=E(zP),i=E(nT),l=E(oT),c=E(cQ),d=e?.totals?.itemPriceAfterPromos,u=e?.totals?.paymentSplit?.paidByLoyalty,m=e?.totals?.paymentSplit?.remainingPayment,g=e?.totals?.display?.finalPrice,f=!!Number(e?.totals?.savingsPrice?.amount),y=d?.amount!==e?.totals?.finalPrice?.amount,I=!!Number(e?.totals?.paymentSplit?.paidByLoyalty?.amount)||!!Number(e?.totals?.paymentSplit?.remainingPayment?.amount),S=tg(e?.items);return e?s.jsxs(ie.Fragment,{children:[s.jsxs(pe,{children:[s.jsx(ae.Items,{itemsRetailPrice:e?.totals?.itemsRetailPrice,quantity:S,withTaxNote:n}),s.jsx(ae.Savings,{savings:e?.totals?.savingsPrice}),l&&i&&f&&s.jsx(Ai,{isSummarySection:!0,className:"salt-m-b--2"}),s.jsx(ae.SavingsWithPaymentMethod,{savings:e?.totals?.paymentMethodSavingsPrice}),o&&f&&!!d&&y&&s.jsx(ae.Subtotal,{value:d,withTaxNote:n}),s.jsx(QP,{basketSummary:e,taxNoteEnabled:n,getLoyaltySpent:Xi,page:t})]}),s.jsx(XP,{basketSummary:e,taxNoteEnabled:n}),r&&u&&m&&I&&s.jsxs(h.Fragment,{children:[s.jsx(ae.Separator,{}),s.jsx(pe,{"data-test":"summary-payment-list",children:s.jsx(ae.PaymentChecks,{"data-test":"summary-payment-checks",remainingBalance:m,paidByCheck:u})})]}),a&&!c&&g&&u&&s.jsx(ae.PaymentLoyalty,{subtotalPrice:g,paidByLoyalty:u}),s.jsx(ae.Separator,{})]}):null},$Ct=({basketSummary:e,page:t})=>{const n=E(sT),o=E(iQ),r=E(zP),a=E(nT),i=E(oT),l=E(cQ),c=e?.totals?.paymentSplit?.paidByLoyalty,d=e?.totals?.paymentSplit?.remainingPayment,u=e?.totals?.display?.finalPrice,m=!!Number(e?.totals?.savingsPrice?.amount),g=!!Number(e?.totals?.paymentSplit?.paidByLoyalty?.amount)||!!Number(e?.totals?.paymentSplit?.remainingPayment?.amount);return!e||!e.totalsGroups?null:s.jsx(h.Fragment,{children:e.totalsGroups.map(f=>{if(!Number(f.totals?.display?.finalPrice?.amount))return null;const{groupName:y}=f,I=rT(e.itemGroups,y,e.items);return s.jsxs(ie.Fragment,{children:[s.jsx(bi,{groupName:y,className:"salt-d--block salt-m-y--2"}),s.jsxs(pe,{children:[s.jsx(ae.Items,{itemsRetailPrice:e?.totals?.itemsRetailPrice,quantity:I,withTaxNote:n}),s.jsx(ae.Savings,{savings:e?.totals?.savingsPrice}),i&&a&&m&&s.jsx(Ai,{isSummarySection:!0,className:"salt-m-b--2"}),s.jsx(ae.SavingsWithPaymentMethod,{savings:e?.totals?.paymentMethodSavingsPrice}),s.jsx(QP,{basketSummary:e,taxNoteEnabled:n,getLoyaltySpent:G0(y),page:t})]}),s.jsx(XP,{basketSummary:e,taxNoteEnabled:n}),o&&c&&d&&g&&s.jsxs(h.Fragment,{children:[s.jsx(ae.Separator,{}),s.jsx(pe,{"data-test":"summary-payment-list",children:s.jsx(ae.PaymentChecks,{"data-test":"summary-payment-checks",remainingBalance:d,paidByCheck:c})})]}),r&&!l&&u&&c&&s.jsx(ae.PaymentLoyalty,{subtotalPrice:u,paidByLoyalty:c}),s.jsx(pe,{"data-test":"summary-seller-total",children:s.jsx(ae.Subtotal,{value:u,label:"summary.total",withTaxNote:n})})]},y)})})},HCt=()=>{const e=E(lQ),t=E(Lnt);return!e&&!t?null:s.jsx("div",{className:"salt-p-t--2 salt-p-x--4","data-test":"loyalty-earnings-summary",children:s.jsx(Hd,{getQuantity:eg,allowZero:!0})})},VCt=()=>{const e=F(),t=h.useCallback((o,r,a,i)=>{const l={ADDRESS_ID:o,DELIVERY_DESTINATION_ID:r,CARRIER_NAME:a,EXTERNAL_COLLECTION_POINT_ID:i};return e(U.analyticsEvent({type:_e.DELIVERY_CARD_IMPRESSION,impression:l}))},[e]),n=h.useCallback(o=>e(U.analyticsEvent({type:_e.CHANGE_DELIVERY_BUTTON_CLICKED,EXTERNAL_COLLECTION_POINT_ID:o})),[e]);return h.useMemo(()=>({deliveryCardImpression:t,changeDeliveryButtonClicked:n}),[n,t])},db=({isExpanded:e})=>{const{formatMessage:t}=M(),n=E(Mie),o=E(D("oed")),r=E(D("loy.waon")),{currency:a,checkoutPayment:i,checkoutLoyaltyPayment:l}=jh()||{},c=Cs("seller-sales-enabled")==="true";if(!i||!o)return null;const{amountPaidByCustomer:d,amountToBeCharged:u,amountToBeRefunded:m}=i||{},{amountToBeRefunded:g,amountToBeCharged:f,amountPaidByCustomer:y}=l||{},S=[u,m,r&&g].filter(A=>Number(A)>0).length,C=Number(d)===0&&Number(u)>0&&Number(f)>0,_=(Number(d)>0||Number(y)>0)&&Number(u)>0;return e?s.jsxs(pe,{children:[r&&Number(n?.amount)>0&&s.jsx(ae.TotalLoyaltyCharged,{amount:n?.amount,currency:a}),Number(d)>0&&s.jsx(ae.TotalCharged,{amount:d,currency:a}),(C||_||S===0)&&s.jsx(ae.TotalDifferenceToCharge,{amount:u,currency:a,inline:!e}),(c?!(Number(u)>0):!0)&&Number(m)>0&&s.jsx(ae.TotalDifferenceToRefund,{amount:m,currency:a,inline:!e}),r&&Number(g)>0&&s.jsx(ae.TotalLoyaltyDifferenceToRefund,{amount:g,currency:a,inline:!e})]}):S===0||S===1&&Number(u)>0?s.jsx(ae.TotalDifferenceToCharge,{amount:u,currency:a,inline:!e}):S===1&&Number(m)>0?s.jsx(ae.TotalDifferenceToRefund,{amount:m,currency:a,inline:!e}):S===1&&Number(g)>0&&r?s.jsx(ae.TotalLoyaltyDifferenceToRefund,{amount:g,currency:a,inline:!e}):S>1?s.jsx(P,{children:t("summary.difference.multiple.transactions")}):null},rU="delivery-asset-card",YCt=({onChange:e})=>{const t=F(),{formatMessage:n}=M(),o=E(xi),r=E(Fa),a=E(IZ(o?.dropOff?.selectedId)),{deliveryAssetChanged:i}=bo(),l=a.find(m=>m.id===o?.deliveryAsset?.selectedId)?.id||"",c={[pt.DELIVERY_ASSET]:l};h.useEffect(()=>{d.reset(c)},[o?.deliveryAsset?.selectedId]);const d=Gn({defaultValues:c,mode:"onChange"}),u=async()=>{if(await d.trigger()){const g=d.getValues(),f=o?.deliveryAsset?.selectedId;try{const y=await t(PT({deliveryDestinationId:r,formData:{additionalInformationValue:o?.additionalInformation?.value||"",dropOffId:o?.dropOff?.selectedId||"",entryInstructionId:o?.entryInstructions?.selectedId||"",deliveryAssetId:g[pt.DELIVERY_ASSET]}}));y&&(i({deliveryAssetId:y.deliveryAsset?.selectedId||"",preselectedDeliveryAssetId:f}),e())}catch{z.error("toast.notification.generic.error")}}};return s.jsx(ve,{"data-test":rU,className:"salt-m-y--4",children:s.jsx($n,{...d,children:s.jsxs("form",{"data-test":`${rU}-form`,onSubmit:d.handleSubmit(u),children:[s.jsx(Bo,{children:s.jsx(vZ,{options:a,customLabel:s.jsx(P,{size:"l",bold:!0,children:n("delivery-details.delivery-asset-selector.title")}),onChange:u,required:!1})}),s.jsx("button",{type:"submit",className:"salt-d--none",children:"submit"})]})})})},wZ=({label:e,value:t,required:n,dropOffId:o,errorMessage:r,onOptionChange:a,singleOptionAsText:i,showDeliveryAssetSelectByDefault:l})=>{const c=M(),[d,u]=h.useState(!1),m=E(iE),g=ED(),f=c.formatMessage("delivery-details.delivery-asset-selector.title"),y={text:e||f},I=c.formatMessage("delivery-details-modal.delivery-asset-selector.select-option"),S=c.formatMessage("delivery-details.packaging-protection-info.text"),_=o?m.filter(N=>N.dropOffAssignment?.includes(o)||!N.dropOffAssignment):m,A=!!_.find(N=>N.id===t?.id),x=_.map(N=>({value:N.id,name:g({item:N,withDescription:!1}),additionalInfo:N.description}));if(!l&&A&&!d||x.length===0)return null;if(i&&x.length===1){const N=x.at(0);return s.jsxs("div",{children:[s.jsx(P,{size:"s",bold:!0,children:s.jsx(v,{id:"delivery-view.delivery-asset.label"})}),s.jsx("br",{}),s.jsx(P,{children:N?.name}),s.jsx("br",{}),s.jsx(P,{children:N?.additionalInfo}),s.jsx("input",{type:"hidden",value:N?.value,name:pt.DELIVERY_ASSET})]})}const R=A?{name:g({item:t}),value:t?.id??""}:void 0,O=({value:N})=>{a?.(_.find(k=>k.id===N)),u(!0)};return s.jsx(mt.DropdownSelect,{contrastBackground:!0,required:n,error:r,label:y,value:R,options:x,placeholder:I,additionalText:S,"data-test":"delivery-asset-select",onOptionChange:O,name:pt.DELIVERY_ASSET})},aU="delivery-asset-card",WCt=({onChange:e})=>{const{formatMessage:t}=M(),n=F(),{deliveryAssetChanged:o}=bo(),r=E(Fa),a=E(xi),i=E(OT),l=E(om),[c,d]=h.useState(i);h.useEffect(()=>{d(i)},[i]);const u=async g=>{const f=a?.deliveryAsset?.selectedId;try{const y=await n(PT({deliveryDestinationId:r,formData:{additionalInformationValue:a?.additionalInformation?.value||"",dropOffId:a?.dropOff?.selectedId||"",entryInstructionId:a?.entryInstructions?.selectedId||"",deliveryAssetId:g}}));y&&(o({deliveryAssetId:y.deliveryAsset?.selectedId||"",preselectedDeliveryAssetId:f}),e())}catch{z.error("toast.notification.generic.error")}},m=async g=>{d(g),await u(g?.id)};return s.jsxs(ve,{"data-test":aU,className:"salt-m-y--4",children:[s.jsx(ne,{as:"span",className:"salt-d--block salt-m-b--4",children:s.jsx(_t,{id:"delivery-details.delivery-asset-selector.title"})}),s.jsxs(mt,{"data-test":`${aU}-form`,children:[s.jsx(wZ,{dropOffId:l?.id,value:c,onOptionChange:m,showDeliveryAssetSelectByDefault:!0,label:t("delivery-details.delivery-asset-selector.title")}),s.jsx("button",{type:"submit",className:"salt-d--none",children:"submit"})]})]})},qCt=({age:e,redirectOnCancel:t,messages:n,isOpen:o=!0})=>{const{formatMessage:r}=M(),a=E(D("m.la.h")),i=Ne(),l=We(),c=E(E0),d=a?"left":"center",u={button:r("bop.age.restricted.url.verify.age.button"),body:r("bop.age.restricted.url.body",{age:e}),cancel:r("bop.age.restricted.url.go.back.button"),header:r("bop.age.restricted.url.title"),...n},m=()=>{const f=new URLSearchParams;return f.append("destination",`${i.pathname}${i.search}`),f.append("ageVerified","false"),Fr({queryString:f.toString()})},g=()=>{if(t)l(t());else{if(c>1){l(-1);return}l(pn())}};return s.jsx(G,{isOpen:o,aria:{labelledby:u.header},children:s.jsxs(G.ModalForm,{children:[s.jsx(G.Header,{align:d,children:s.jsx(ne,{as:"h1",children:u.header})}),s.jsx(G.Body,{children:u.body}),s.jsxs(G.Footer,{align:d,className:"salt-gap-x--2",children:[s.jsx(b,{fill:!0,intent:"secondary",onClick:g,children:s.jsx(b.Text,{children:u.cancel})}),s.jsx(b,{asChild:!0,intent:"primary",fill:!0,children:s.jsx(rt,{href:m(),intent:"ghost",children:s.jsx(b.Text,{children:u.button})})})]})]})})},KCt=({className:e=""})=>s.jsx(Ce,{className:e,intent:"warning",text:s.jsx(v,{id:"checkout.summary.non.editable.order.alert"})}),zCt=e=>{const t=M(),n=E(D("dede")),o=E(DT(e)),r=E(fZ(e)),a=E(aE),i=n&&r,l=o?.additionalInformationHint||a?.defaultHint||"";return{additionalInfoLabel:n?t.formatMessage("delivery-details-modal.additional-information.title"):t.formatMessage("delivery-instructions.title"),isAdditionalInfoRequired:i,additionalInfoPlaceholder:l}},QCt=({defaultValue:e,errorMessages:t,selectedEntryInstructionId:n})=>{const o=M(),{additionalInfoLabel:r,additionalInfoPlaceholder:a,isAdditionalInfoRequired:i}=zCt(n??""),l=E(dp),c=t[pt.ADDITIONAL_INFORMATION];return s.jsx(mt.TextField,{"data-pii":"true",className:"salt-m-t--4",pattern:l,errorMessage:c,defaultValue:e,"data-test":"addresses-notes-input",required:i,label:{text:r},placeholder:a,maxLength:TZ,name:pt.ADDITIONAL_INFORMATION,clearButton:{ariaLabel:o.formatMessage("salt.form.text-field.clear-button.a11y.label")}})},XCt=({dropOffId:e,defaultValue:t,errorMessage:n,onOptionChange:o})=>{const r=M(),a=E(RT),l={text:r.formatMessage("delivery-details-modal.entry-instructions.title")},c=E(EZ(e)),d=r.formatMessage("delivery-details-modal.select-instructions.title"),u=a.filter(I=>I.dropOffAssignment.includes(e)),m=!!u.find(I=>I.id===t?.value),g=u.map(I=>({value:I.id,name:I.displayValue})),f=g.length===0,y=g.length===1;if(f)return o(""),null;if(y){const I=g[0]?.value??"";return o(I),s.jsx("input",{"aria-hidden":!0,type:"hidden",value:I,name:pt.ENTRY_INSTRUCTION})}return s.jsx(mt.DropdownSelect,{label:l,contrastBackground:!0,required:c,error:n,options:g,placeholder:d,"data-test":"entry-instruction-select",name:pt.ENTRY_INSTRUCTION,defaultValue:m?t:void 0,onOptionChange:I=>o(I.value)})},ZCt=T.div`
    display: flex;
    flex-direction: column;
    gap: var(--salt-spacing-4);
`,JCt=({errorMessages:e,onDropOffOptionChange:t,selectedDropOffOptionId:n,showDeliveryAssetSelect:o})=>{const r=M(),[a]=fe(["dede"]),i=E(nm),l=E(aE),c=E(OT),d=E(SL),[u,m]=h.useState(d?.id),[g,f]=h.useState(c);h.useEffect(()=>{f(c)},[c]);const y={value:d?.id||"",name:d?.displayValue||""},I=l?.value||"",S=i.find(x=>x.id===n)?.handoverType,C=a&&(S===SZ||S===CZ),A={text:r.formatMessage("delivery-details-modal.drop-off-options.title"),isVisuallyConcealed:!1};return s.jsxs(ie.Fragment,{children:[s.jsx(ve,{children:s.jsx(mt.RadioGroup,{required:!0,"data-test":"drop-off-select",groupLabel:A,value:n,onChange:t,error:e[pt.DROP_OFF_OPTION],name:pt.DROP_OFF_OPTION,radios:i.map(x=>({value:x.id,label:x.displayValue,additionalText:x.description,progressiveDisclosure:n===x.id&&s.jsxs(ZCt,{children:[s.jsx(XCt,{dropOffId:x.id,defaultValue:y,onOptionChange:m,errorMessage:e[pt.ENTRY_INSTRUCTION]}),s.jsx(wZ,{required:!0,singleOptionAsText:!0,dropOffId:x.id,value:g,onOptionChange:f,showDeliveryAssetSelectByDefault:o,errorMessage:e[pt.DELIVERY_ASSET]})]})}))})}),s.jsx(QCt,{errorMessages:e,defaultValue:I,selectedEntryInstructionId:u}),C&&s.jsx(_Z,{className:"salt-d--block salt-m-t--4"})]})},eTt=e=>e[pt.DROP_OFF_OPTION]?Xa.DROP_OFF:e[pt.ENTRY_INSTRUCTION]?Xa.ENTRY_INSTRUCTIONS:e[pt.ADDITIONAL_INFORMATION]?Xa.ADDITIONAL_INFORMATION:e[pt.DELIVERY_ASSET]?Xa.DELIVERY_ASSETS:null,tTt=e=>e instanceof HTMLElement,sTt=e=>{const t=e.querySelector("input:invalid"),n=t?.checkVisibility()?t:t?.previousSibling;tTt(n)&&(n?.scrollIntoView({behavior:"smooth",block:"center"}),n?.focus())},nTt=({showDeliveryAssetInitially:e,deliveryDestinationId:t,trigger:n,onDeliveryDetailsSaved:o})=>{const r=M(),a=F(),i=E(nm),l=E(om),c=E(OT),{deliveryDetailsModalDisplayed:d,deliveryOptionsViewed:u}=bo(),[m,g]=fe(["dede","dass"]),[f,y]=h.useState(!1),[I,S]=h.useState({}),C=h.useRef(null),[_,A]=h.useState(l?.id??""),x=i.find(W=>W.id===_),R=!!(g&&e),O=W=>{const $={};return x?(Object.values(pt).forEach(K=>{const Q=W.elements.namedItem(K);if(Q instanceof HTMLInputElement){if(!Q.validity.valid){if(Q.validity.valueMissing){const X=uv[K].required;$[K]=r.formatMessage(X)}Q.validity.patternMismatch&&($[K]=r.formatMessage("validation.form.restricted.chars"))}K==="additionalInformation"&&Q.required&&Q.value.replace(/\s/g,"").length===0&&($[K]=r.formatMessage(uv.additionalInformation.required))}}),$):($[pt.DROP_OFF_OPTION]=r.formatMessage(uv[pt.DROP_OFF_OPTION].required),$)},N=W=>{const $=new FormData(W),K=$.get(pt.DROP_OFF_OPTION)?.toString(),Q=$.get(pt.ENTRY_INSTRUCTION)?.toString(),X=$.get(pt.DELIVERY_ASSET)?.toString(),re=$.get(pt.ADDITIONAL_INFORMATION)?.toString();return{dropOffId:K,entryInstructionId:Q,deliveryAssetId:X,additionalInformationValue:re}},k=async W=>{W.preventDefault(),y(!0);let $;const K=W.currentTarget,Q=O(K);if(Object.values(Q).length>0)return S(Q),sTt(K),y(!1),{updatedDeliveryOptions:null,errorType:eTt(Q)};const{additionalInformationValue:X,deliveryAssetId:re,dropOffId:ue,entryInstructionId:te}=N(K);try{const ce=await a(PT({deliveryDestinationId:t,formData:{additionalInformationValue:X??"",dropOffId:ue,entryInstructionId:te,deliveryAssetId:re??c?.id}}));return ce&&(S({}),z.success("delivery-details-saved.toast")),y(!1),a(Z.closeModal()),{updatedDeliveryOptions:ce,errorType:null}}catch{$=Xa.API_ERROR,z.error("toast.notification.generic.error")}return y(!1),{updatedDeliveryOptions:null,errorType:$}},j={trigger:n,deliveryInstructionsEnabled:!0,unattendedDeliveryEnabled:!!(m&&i.length),assetChoiceEnabled:R,dropOffOptionsSelected:x?.displayValue,...C.current?{errorDisplayed:C.current}:{}},w=async W=>{const{updatedDeliveryOptions:$,errorType:K}=await k(W);K&&!C.current?C.current=K:K||(d({...j,modalClosed:Oy.CONFIRMED}),C.current=null),$&&o?.($)},L=()=>{d({...j,modalClosed:Oy.CLOSED,...C.current?{errorDisplayed:C.current}:{}}),C.current=null},B=()=>u({selectedDropOff:l?.displayValue});return h.useEffect(()=>(B(),()=>{L()}),[]),s.jsxs(mt,{noValidate:!0,onSubmit:w,"data-test":`${ub}-form`,children:[s.jsx(JCt,{errorMessages:I,selectedDropOffOptionId:_,showDeliveryAssetSelect:R,onDropOffOptionChange:W=>A(W)}),s.jsx(b,{fill:!0,type:"submit",intent:"primary",loading:f,className:"salt-m-t--8","data-test":`${ub}-confirm-button`,children:s.jsx(b.Text,{children:r.formatMessage("delivery-details-modal.confirm-button.label")})})]})},oTt="DELIVERY_DETAILS_MODAL_NAME",ub="delivery-details-modal",FZ=({trigger:e=Dy.DELIVERY_OPTIONS_CLICKED,onDeliveryDetailsSaved:t=()=>{},handleModalClose:n=()=>{},showDeliveryAssetInitially:o=!0,deliveryDestinationId:r})=>{const a=F(),i=E(Ue(oTt)),l=()=>{n(),a(Z.closeModal())};return s.jsxs(G,{asBottomSheet:!0,isOpen:i,onRequestClose:l,children:[s.jsx(G.Header,{align:"left",children:s.jsx(AZ,{})}),s.jsx(G.Body,{"data-test":ub,children:s.jsx(nTt,{trigger:e,deliveryDestinationId:r,onDeliveryDetailsSaved:t,showDeliveryAssetInitially:o})})]})},rTt=()=>{const[e,t]=h.useState(!1);return s.jsxs(st,{expanded:e,onToggle:()=>t(n=>!n),children:[s.jsxs(st.ControlSection,{children:[s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"checkout.summary.electronic.device.collection.title"})}),s.jsx(st.ToggleSwitch,{})]}),s.jsx(st.ContentCollapsed,{children:s.jsx("div",{className:"salt-m-t--4",children:s.jsx(v,{id:"checkout.summary.electronic.device.collection.short.description"})})}),s.jsxs(st.ContentExpanded,{children:[s.jsx("div",{className:"salt-m-t--4",children:s.jsx(P,{children:s.jsx(v,{id:"checkout.summary.electronic.device.collection.short.description"})})}),s.jsx("div",{className:"salt-m-t--4",children:s.jsx(P,{children:s.jsx(v,{id:"checkout.summary.electronic.device.collection.additional.info"})})})]})]})},aTt=({checkoutErrorMessage:e})=>s.jsx(Ce,{intent:"error",showIcon:!1,"data-test":"unresolvable-checkout-error-alert",text:e}),iTt=D("cs.tca"),lTt=({isTermsAndConditionsCheckboxAcknowledged:e,isTermsAndConditionsAcknowledgeError:t,toggleTermsAndConditionsCheckbox:n})=>{const o=M(),r=E(iTt),[a]=fe(["nfchk"]),i=o.formatMessage("checkout.summary.termsandconditions.link.url"),l=o.formatMessage("checkout.summary.termsandconditions.second.link.url"),c=o.formatMessage("checkout.summary.termsandconditions.error");return r?s.jsx(h.Fragment,{children:a?s.jsx(mt.Checkbox,{id:hd[Tt.messages.TERMS_AND_CONDITIONS_UNCHECKED],value:"summary-t-and-c-checkbox",name:"summary-t-and-c-checkbox",checked:e,onChange:n,error:t?c:"",required:!0,label:s.jsxs(h.Fragment,{children:[s.jsx(v,{id:"checkout.summary.termsandconditions.prelink.text"})," ",s.jsx(rt,{target:"_blank",href:i,className:"salt-d--block sm:salt-d--inline",children:s.jsx(v,{id:"checkout.summary.termsandconditions.link.text"})})," ",s.jsx(v,{id:"checkout.summary.termsandconditions.postlink.text"}),l?.trim()&&s.jsxs(h.Fragment,{children:[" ",s.jsx(rt,{href:l,target:"_blank","data-test":"summary-t-and-c-second-link",children:s.jsx(v,{id:"checkout.summary.termsandconditions.second.link.text"})})]})]}),"data-test":"summary-t-and-c-checkbox"}):s.jsx(mo,{last:!0,id:hd[Tt.messages.TERMS_AND_CONDITIONS_UNCHECKED],input:{onChange:n,checked:e},bold:t,meta:{error:t?c:"",touched:t,invalid:t},label:s.jsxs(h.Fragment,{children:[s.jsx(v,{id:"checkout.summary.termsandconditions.prelink.text"})," ",s.jsx(rt,{target:"_blank",href:i,bold:t,className:"salt-d--block sm:salt-d--inline",children:s.jsx(v,{id:"checkout.summary.termsandconditions.link.text"})})," ",s.jsx(v,{id:"checkout.summary.termsandconditions.postlink.text"}),l?.trim()&&s.jsxs(h.Fragment,{children:[" ",s.jsx(rt,{href:l,target:"_blank","data-test":"summary-t-and-c-second-link",children:s.jsx(v,{id:"checkout.summary.termsandconditions.second.link.text"})})]})]}),"data-test":"summary-t-and-c-checkbox"})}):s.jsxs(P,{children:[s.jsx(v,{id:"checkout.summary.termsandconditions.prelink.text"})," ",s.jsx(rt,{target:"_blank",href:i,className:"salt-d--block sm:salt-d--inline",children:s.jsx(v,{id:"checkout.summary.termsandconditions.link.text"})})," ",s.jsx(v,{id:"checkout.summary.termsandconditions.postlink.text"})," ",l?.trim()&&s.jsx(rt,{href:l,target:"_blank","data-test":"summary-t-and-c-second-link",children:s.jsx(v,{id:"checkout.summary.termsandconditions.second.link.text"})})]})},cTt=e=>{const t=h.useRef({}),n=h.useRef([]),o=(a,i)=>{i!==void 0&&!t.current[i]&&(n.current.push(a),t.current[i]=!0)},r=()=>{n.current.length>0&&(e({type:xt.WALLET_ITEM_IMPRESSION,walletItemImpressions:n.current}),n.current=[])};return h.useEffect(()=>{r()}),{impression:o,impressionSent:t,queuedImpressions:n}},dTt=(e,{walletItemId:t,fundingInstrumentId:n})=>{const o=a=>a.walletItemId===t,r=a=>a.fundingInstrumentId===n;return t&&e.find(o)||n&&e.find(r)},uTt=({wallet:e,initialFundingInstrumentId:t,initialWalletItemId:n,getWalletItems:o,updateSelectedPaymentMethod:r,isWalletItemDisabledOrExpired:a,showInvoicePaymentOption:i})=>{const l=F();h.useEffect(()=>{!e.lastUpdated&&!e.isFetching&&o()},[]),h.useEffect(()=>{e.lastUpdated&&c(e.items)},[e.items,i]);const c=d=>{if(i){r(GZ);return}const m=dTt(d,{walletItemId:n,fundingInstrumentId:t})||d.find(y=>y.isDefault),[g]=d,f=m||g||UZ;a(f)&&l(kt.setPaymentOptionAndType({paymentOption:ct.PAY_NOW,paymentType:at.UNKNOWN})),r(f)}},pTt=e=>e?.filter(t=>t.available&&t.name!==ct.LOYALTY).map(({name:t,retailerFinancingPlanIds:n})=>({name:t,retailerFinancingPlanIds:n})),mTt=()=>async e=>{try{await e(Jf.fetchActivePaymentMethodGroups())}catch{z.error("request.error.title")}},hTt=()=>async(e,t)=>{const n=t(),o=sx(n)?.amount||"",r=D("pcs.v2")(n);let a;r?a=hL(n):a=YX(n);const i=pTt(a);try{await e(ey.fetchPaymentMethodGroupsMetadata({groups:i??null,amount:o}))}catch{z.error("request.error.title")}},gTt=()=>async e=>{try{await e(ty.fetchPaymentMethodGroupPromotions())}catch{z.error("request.error.title")}},cy={fetchActivePaymentMethodGroups:mTt,fetchPaymentMethodGroupsMetadata:hTt,fetchPaymentMethodGroupPromotions:gTt},wh=({paymentInfo:{paymentMethodV2:e,cardType:t},iconAriaLabel:n})=>{const o=c3({cardType:t,paymentMethod:e});return s.jsx(me,{name:o,...ETt(o),"aria-label":n,tabIndex:0})},ETt=e=>{switch(e){case Gt.INVOICE:case Gt.BANK_TRANSFER:case Gt.BLIK:return{};case Gt.PAYPAL:return{height:20,width:42};default:return{height:20,width:40}}},LL=({walletItem:e,checked:t,disabled:n})=>{const o=M(),r=o.formatMessage("checkout.summary.payment.method.expired");let a;e.paymentMethod===at.CARDS?a=o.formatMessage("payment.card.description",{cardName:(e.details.cardTypeDisplayName||"card").toLowerCase(),cardNumber:e.details.lastFourDigits,cardExpiryDate:`(${e.details.expiryMonth}/${e.details.expiryYear})`}):e.paymentMethod===at.PAYPAL&&(a=o.formatMessage("order.online.receipt.payment.accessibility.paypal",{emailAddress:e.details.emailAddress?.toLowerCase()}));const i=s.jsx(wh,{paymentInfo:{paymentMethodV2:e.paymentMethod,...e.details}});return s.jsx(ia,{checked:t,label:i,name:"payment",disabled:n,error:e.expired?r:"",type:"radio",value:e.walletItemId,"aria-label":a,children:s.jsx(Dh,{paymentInfo:{nonSavedFundingInstrument:!1,paymentMethodV2:e.paymentMethod,...e.details}})},e.walletItemId)},fTt=({walletItem:e,impression:t,onClick:n,disabled:o,checked:r})=>{const a="wallet-item-type-card",i=`wallet-item-row-${e.walletItemId}`;return t({IS_DEFAULT:e.isDefault,WALLET_ITEM_ID:e.walletItemId},e.walletItemId),s.jsx(aa.Row,{onClick:l=>n(l,e),disabled:o,"data-synthetics":a,"data-test":i,children:s.jsx(LL,{walletItem:e,checked:r,disabled:o})},e.walletItemId)},yTt=({isSelected:e,onClick:t})=>s.jsxs(h.Fragment,{children:[s.jsx("div",{className:"salt-m-t--4 salt-m-b--4",children:s.jsx(P,{bold:!0,children:s.jsx(v,{id:"checkout.summary.payment.method.unsaved.title"})})}),s.jsx("div",{className:"salt-m-t--4 salt-m-b--4",children:s.jsx(aa,{children:s.jsx(aa.Row,{onClick:t,"data-test":"unsaved-payment-method",children:s.jsx(ia,{checked:e,name:"payment",label:s.jsx(wh,{paymentInfo:{paymentMethodV2:at.CARDS}}),children:s.jsx(P,{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},"data-pii":"true",children:s.jsx(v,{id:"checkout.summary.payment.method.unsaved.description"})})})})})}),e&&s.jsx("div",{className:"salt-m-t--4",children:s.jsx(Ce,{intent:"warning","data-test":"payment-unsaved-method-alert",text:s.jsx(v,{id:"checkout.summary.payment.method.unsaved.alert"})})})]}),ITt=({isSelected:e,onClick:t})=>s.jsx("div",{className:"salt-m-t--4 salt-m-b--4",children:s.jsx(aa,{children:s.jsx(aa.Row,{onClick:t,"data-test":"invoice-payment-method",children:s.jsx(LL,{walletItem:{walletItemId:"INVOICE",paymentMethod:"INVOICE"},checked:e,disabled:!1})})})}),STt=({supportNonSavedPayment:e})=>{const t=M(),n={alertText:t.formatMessage("checkout.summary.payment.method.alert"),testName:"payment-missing-wallets-alert"},o={alertText:t.formatMessage("checkout.summary.payment.method.nonblocking.alert"),testName:"payment-missing-wallets-alert-non-blocking"},{alertText:r,testName:a}=e?o:n;return s.jsx(Ce,{intent:"warning","data-test":a,text:r,className:"salt-m-b--2",showIcon:!1})},CTt=()=>{const t=M().formatMessage("checkout.summary.default.payment.method.expired.alert");return s.jsx(Ce,{intent:"warning","data-test":"payment-default-expired-alert",text:t,className:"salt-m-b--4",showIcon:!1})},TTt=()=>{const t=M().formatMessage("checkout.summary.payment.method.unselected");return s.jsx(Ce,{intent:"warning","data-test":"payment-unselected-wallet-alert",text:t,className:"salt-m-b--2",showIcon:!1})},_Tt={TOO_MANY_REQUESTS:429},vTt=600,mv={modalName:"psp",createWalletItemCreationSession:()=>{const e=TVe(window.location);return wO.createWalletItemCreationSession({url:e})},setAddWalletItemFrameUrl:Wy.setAddWalletPspwebFrameUrl},ATt=e=>z.warning({key:"settings.wallet.create.item.rate.limited",substitutions:{numberOfMinutes:e}}),bTt=()=>z.error("settings.wallet.create.item.error"),xTt=()=>{const e={event:"event",eventCategory:"Payment",eventAction:"AddWalletItemError"};return J.sendEvent({GA:e,WA:null}),U.analyticsEvent({type:xt.ADD_WALLET_ITEM,event:"ERROR"})},RTt=()=>{const e={event:"event",eventCategory:"Payment",eventAction:"AddWalletItemStart"};return J.sendEvent({GA:e,WA:null}),U.analyticsEvent({type:xt.ADD_WALLET_ITEM,event:"START"})},DTt=e=>e.statusCode===_Tt.TOO_MANY_REQUESTS,pb=()=>e=>t=>{if(e(Z.closeModal()),e(xTt()),DTt(t)){const n=vTt/60;ATt(n)}else bTt()},OTt=()=>e=>Promise.resolve(e(RTt())).then(()=>e(Z.openModal(mv.modalName))).then(()=>e(mv.createWalletItemCreationSession())).then(t=>e(mv.setAddWalletItemFrameUrl(t.payload.responseData.sessionUrl))).catch(pb()(e)),PTt=e=>t=>Promise.resolve(t(wO.createWalletItem(e))),dE={startAddWalletItem:OTt,createWalletItem:PTt},NTt=3e3,BZ=({throttleTimeoutMs:e=NTt}={})=>{const t=h.useRef(null);return{shouldLogUnauthorizedAttempt:r=>{const a=Mt().valueOf(),i=t.current;return t.current={origin:r,timestamp:a},!i||i.origin!==r||a-i.timestamp>e},resetThrottling:()=>{t.current=null}}},LTt=({pspIFrameRef:e,onTokenizationSuccess:t,onTokenizationError:n,logUnauthorizedPostMessageAttempt:o,isSkipXssCheckEnabled:r=!1})=>{const{shouldLogUnauthorizedAttempt:a}=BZ({throttleTimeoutMs:3e3}),i=d=>{d.redirectUrl&&window.location.assign(d.redirectUrl)},l=d=>{const u=e.current?.contentWindow;u&&u.postMessage(d.data,"*")},c=d=>!r&&!EO(d.origin)?(a(d.origin)&&o(d.origin),Promise.resolve()):(l(d),d.data?.type==="TRIGGER_EXTERNAL_REDIRECT"&&i(d.data),d.data?.type==="TOKENIZATION_ERROR"?(n(d),Promise.resolve()):!d.data||d.data.type!=="TOKENIZATION_RESULT_TOKEN"||!d.data.resultToken?Promise.resolve():t(d));h.useEffect(()=>(window.addEventListener("message",c),()=>{window.removeEventListener("message",c)}),[])},kTt="psp",kL=({close:e})=>{const t=F(),n=M(),o=h.useRef(null),r=E(Ue(kTt)),a=E(D(gO)),i=E(D("pay.skpxss")),l=E(l2e),c=y=>{y&&y.preventDefault(),e?e():t(Z.closeModal()),t(Wy.resetAddWalletPspwebFrameUrl())};LTt({pspIFrameRef:o,onTokenizationSuccess:async y=>t(dE.createWalletItem(y.data.resultToken)).then(({payload:I})=>{const S={event:"event",eventCategory:"Payment",eventAction:"AddWalletItemSuccess",walletItemId:I?.responseData?.walletItemId};return J.sendEvent({GA:S,WA:null}),t(U.analyticsEvent({type:xt.ADD_WALLET_ITEM,event:"COMPLETE",walletItemId:I?.responseData?.walletItemId}))}).catch(t(pb())).finally(()=>c()),onTokenizationError:y=>{t(pb())(y),c()},logUnauthorizedPostMessageAttempt:y=>t(U.analyticsEvent({type:xt.UNAUTHORIZED_POST_MESSAGE_ATTEMPT,origin:y})),isSkipXssCheckEnabled:i});const g="wallet-modal-header",f=!l;return s.jsxs(G,{isOpen:r,onRequestClose:c,aria:{labelledby:g},asBottomSheet:!0,children:[s.jsx(G.Header,{align:a?"left":"center",children:s.jsx(ne,{as:"h1",id:g,"data-test":g,children:n.formatMessage("settings.wallet.add.card.modal.title")})}),s.jsxs(G.Body,{children:[l&&s.jsx("div",{className:"salt-m-b--2",children:s.jsx("iframe",{sandbox:"allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox",title:n.formatMessage("settings.wallet.add.card.modal.title"),src:l,"data-synthetics":"psp-iframe","data-test":"psp-iframe",height:600,width:"100%",ref:o,style:{display:"initial"}})}),f&&s.jsx("div",{className:"salt-m--8",children:s.jsx(Rs,{"data-test":"psp-modal-spinner"})})]})]})},MTt=({isSelected:e,onClick:t})=>s.jsx(aa.Row,{onClick:t,"data-test":"apple-pay-payment-method",children:s.jsx(LL,{walletItem:{walletItemId:"APPLE_PAY",paymentMethod:"APPLE_PAY"},checked:e,disabled:!1})}),jTt=({applePayId:e})=>{const[,t]=h.useState(!1),o=E(jg)?.some(i=>i.type===at.APPLE_PAY),r=()=>{window.ApplePaySession?.canMakePayments()&&t(!0)},a=(i,l,c,d,u)=>{z.info("checkout.summary.payment.options.applePay.loading.error"),Me.api.pushError(new Error("Apple Pay SDK failed to load"),{context:{error:u?.message}})};return h.useEffect(()=>{if(o&&!window.ApplePaySession){const i=document.createElement("script");i.src="https://applepay.cdn-apple.com/jsapi/v1.3.2/apple-pay-sdk.js",i.async=!0,i.integrity="sha384-DZRWMZLyVXr+7shJfal8pIG2v4KisLoSWFjZQMUv0+GWaCwoa82qeHsWrbBIUDPU",i.crossOrigin="anonymous",i.onload=r,i.onerror=a,document.getElementById(e)?.appendChild(i)}},[e,o]),typeof window>"u"?!1:(window.ApplePaySession?.canMakePayments()&&o)??!1},wTt={failedPaymentFundingInstrumentId:p.string,initialFundingInstrumentId:p.string,initialWalletItemId:p.string,primaryButton:p.element,additionalAlert:p.element,isFailedPayment:p.bool,onSelectPaymentMethod:p.func,supportNonSavedPayment:p.bool,selectedPayment:p.shape({walletItemId:p.string,expired:p.bool}),showRecurringOrderCheckbox:p.bool,updatePayerForRecurringOrder:p.func,additionalDescription:p.node,payerForRecurringOrder:p.bool,isSelectedRecurringShoppingDefinitionFrequencyDefined:p.bool,isOverridePaymentMethodGroupsEnabled:p.bool,overridePaymentMethodGroups:p.arrayOf(p.shape({name:p.string,retailerFinancingPlanIds:p.arrayOf(p.string)})),enablePayByCardOptionWhenNoMetadataAvailable:p.bool},FTt={failedPaymentFundingInstrumentId:void 0,initialFundingInstrumentId:void 0,initialWalletItemId:void 0,isFailedPayment:!1,onSelectPaymentMethod:()=>{},supportNonSavedPayment:!1,primaryButton:null,additionalAlert:null,selectedPayment:void 0,showRecurringOrderCheckbox:!1,payerForRecurringOrder:!1,updatePayerForRecurringOrder:()=>{},isSelectedRecurringShoppingDefinitionFrequencyDefined:!1,overridePaymentMethodGroups:void 0,isOverridePaymentMethodGroupsEnabled:!1,enablePayByCardOptionWhenNoMetadataAvailable:!1,additionalDescription:void 0},UZ={paymentMethodGroup:ct.PAY_NOW,paymentMethod:at.CARDS,walletItemId:null,isUnsavedPaymentMethodSelected:!0},GZ={paymentMethodGroup:ct.B2B_DEFERRED_PAYMENT,paymentMethod:at.INVOICE,walletItemId:null,isUnsavedPaymentMethodSelected:!0},BTt={paymentMethodGroup:ct.PAY_NOW,paymentMethod:at.APPLE_PAY,walletItemId:null,isUnsavedPaymentMethodSelected:!1},uE=e=>{const{additionalAlert:t,failedPaymentFundingInstrumentId:n,initialFundingInstrumentId:o,initialWalletItemId:r,isFailedPayment:a,isSelectedRecurringShoppingDefinitionFrequencyDefined:i,onSelectPaymentMethod:l,payerForRecurringOrder:c,primaryButton:d,selectedPayment:u,showRecurringOrderCheckbox:m,supportNonSavedPayment:g,updatePayerForRecurringOrder:f,overridePaymentMethodGroups:y,isOverridePaymentMethodGroupsEnabled:I,enablePayByCardOptionWhenNoMetadataAvailable:S,additionalDescription:C}=e,[_,A]=h.useState(u),x=F(),[R]=fe(["nfpay"]),O="script-container-id",N=M(),{impression:k}=cTt(he=>x(U.analyticsEvent(he))),j=E(Pg),w=E(K2e),L=E(he=>he.session.isSuperuser),B=E(he=>qe(he,"textbox-visibility-management-select-wallet-item-warning-is-selected-aware")==="true"),W=E(he=>qe(he,"textbox-visibility-management-add-wallet-item-button-text-is-wallet-items-aware")==="true"),$=E(jg)||[],K=jTt({applePayId:O}),Q=he=>{ce(he)||(l(he),A(he),x(kt.setPaymentOptionAndType({paymentOption:he.paymentMethodGroup,paymentType:he.paymentMethod})),x(kt.setToSavePaymentMethod(!he.isUnsavedPaymentMethodSelected)))};h.useEffect(()=>{I&&y?.length&&x(cy.fetchPaymentMethodGroupsMetadata())},[I&&y?.length]);const X=$.find(he=>he.name===ct.B2B_DEFERRED_PAYMENT),ue=I&&y?.length>0&&$.find(he=>he.name===ct.PAY_NOW)||S||!I,te=he=>he&&he===n,ce=he=>te(he.fundingInstrumentId)||he.expired;uTt({wallet:j,initialFundingInstrumentId:o,initialWalletItemId:r,updateSelectedPaymentMethod:Q,isWalletItemDisabledOrExpired:ce,getWalletItems:()=>x(sm.getWalletItems()),showInvoicePaymentOption:X});const de=(he,ge)=>{he.preventDefault(),he.stopPropagation(),Q(ge)},ye=he=>he&&!te(he.fundingInstrumentId)&&Ae(he),Ae=he=>_&&he.walletItemId===_?.walletItemId,Je=({target:{checked:he}})=>{f(he)};if(!j.lastUpdated||a&&!n)return s.jsx(Ns.Skeleton,{});const je=j.items.length>0,Le=B?je:w,Be=W&&!je?N.formatMessage("checkout.summary.payment.method.button.empty.wallet"):N.formatMessage("checkout.summary.payment.method.button"),be=_&&_.expired;return s.jsxs(h.Fragment,{children:[s.jsxs("div",{className:"salt-m-b--4 salt-m-t--2",children:[!je&&!a&&s.jsx(STt,{supportNonSavedPayment:g}),t,Le&&s.jsx(TTt,{}),je&&ue&&s.jsxs(h.Fragment,{children:[s.jsxs(aa,{fluid:!0,children:[be&&s.jsx(CTt,{}),j.items.map(he=>s.jsx(fTt,{walletItem:he,impression:k,onClick:de,disabled:ce(he),checked:ye(he)})),K&&s.jsx(MTt,{isSelected:_?.paymentMethod==="APPLE_PAY",onClick:he=>de(he,BTt)})]}),g&&!i&&s.jsx(yTt,{isSelected:_?.paymentMethod==="CARDS"&&_?.isUnsavedPaymentMethodSelected,onClick:he=>de(he,UZ)})]})]}),m&&R&&s.jsx(mt.Checkbox,{label:s.jsx(v,{id:"payment.modal.recurring.orders.checkbox"}),checked:c,onChange:Je,name:"use-payment-for-recurring-orders",value:"use-payment-for-recurring-orders","data-test":"use-payment-for-recurring-orders",className:"salt-m-b--4"}),m&&!R&&s.jsx(mo,{label:s.jsx(v,{id:"payment.modal.recurring.orders.checkbox"}),input:{checked:c,onChange:Je},bold:!1,"data-test":"use-payment-for-recurring-orders"}),X&&s.jsxs(ie.Fragment,{children:[s.jsx("div",{className:"salt-m-t--4 salt-m-b--4",children:s.jsx(P,{bold:!0,children:s.jsx(v,{id:"checkout.summary.payment.method.other.label"})})}),s.jsx(ITt,{isSelected:_?.paymentMethod==="INVOICE",onClick:he=>de(he,GZ)})]}),C,d,!L&&s.jsx(b,{onClick:()=>{x(U.analyticsEvent({type:xt.ADD_PAYMENT_METHOD_MODAL_DISPLAYED,userAction:"open"})),x(dE.startAddWalletItem())},intent:"secondary",fill:!0,"data-test":"add-payment-method-button","data-synthetics":"add-payment-method-button",children:s.jsx(b.Text,{children:Be})}),s.jsx(kL,{}),s.jsx("span",{id:O})]})};uE.propTypes=wTt;uE.defaultProps=FTt;const $Z=e=>{const t=E(Vs);return new Intl.NumberFormat(t||"en-GB",{maximumFractionDigits:2}).format(Number(e)*100)},UTt=({bufferRate:e="0",action:t,analyticsEvent:n})=>{const o=M(),r=$Z(e);return s.jsxs(h.Fragment,{children:[s.jsx("div",{className:"salt-m-b--4","data-test":"payment-buffer-notice-text",children:s.jsx(v,{id:"checkout.summary.payment.paymentBuffer.notice",values:{bufferPercent:r}})}),s.jsx(b,{intent:"secondary",fill:!0,onClick:Ct(t,()=>n({type:_e.FIND_OUT_MORE_BUTTON_CLICKED,description:"User clicked find out more button"})),"data-test":"payment-buffer-open-modal-button","aria-label":o.formatMessage("checkout.summary.payment.paymentBuffer.accessibility.notice.button",{bufferPercent:r}),children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.payment.paymentBuffer.notice.button"})})})]})},iU=({handleBoxClick:e,paymentMethod:t,icon:n,text:o,dataTest:r,checked:a})=>s.jsx(ve,{onClick:i=>e(i),"data-synthetics":"payment-method-option",children:s.jsx(ia,{checked:a,label:s.jsx(me,{name:n}),value:t,"data-test":r,disabled:!1,error:"",role:void 0,last:!0,bold:!0,children:s.jsx(v,{id:o})})}),GTt=({onSelectPaymentMethod:e,isCheckoutSummaryInvoiceModalOpen:t,isSelectedRecurringShoppingDefinitionFrequencyDefined:n})=>{const[o,r]=h.useState(at.INVOICE),a=!n,i=h.useCallback(c=>{e(c),r(c)},[e]),l=(c,d)=>{c.preventDefault(),c.stopPropagation(),i(d)};return h.useEffect(()=>{e(at.INVOICE)},[]),h.useEffect(()=>{!a&&o===at.CARDS&&!t&&i(at.INVOICE)},[t,o,a,i]),s.jsxs(h.Fragment,{children:[s.jsx(iU,{paymentMethod:at.INVOICE,icon:"invoice",text:"checkout.summary.payment.method.label.pay.with.invoice",dataTest:"external-wallet-payment-selector-invoice-radio",handleBoxClick:c=>l(c,at.INVOICE),checked:at.INVOICE===o}),a&&s.jsx("div",{className:"salt-m-b--2",children:s.jsx(iU,{paymentMethod:at.CARDS,icon:"payment_card",text:"checkout.summary.payment.method.label.pay.by.card",dataTest:"external-wallet-payment-selector-card-radio",handleBoxClick:c=>l(c,at.CARDS),checked:at.CARDS===o})})]})},$Tt=({isOpen:e,isLoading:t,actions:{closeModal:n},resetRecurringShoppingForm:o})=>{const r=()=>{o(),n()},a=()=>{n()},i="invoice-warning-modal-header";return s.jsxs(G,{isOpen:e,isLoading:t,aria:{labelledby:i},children:[s.jsx(G.Header,{align:"left",children:s.jsxs(ne,{as:"h1",id:i,children:[s.jsx("div",{className:"salt-m-b-r--2 salt-d--inline-block",children:s.jsx(me,{name:"invoice",height:30,width:30,verticalAlign:"sub"})}),s.jsx(v,{id:"checkout.summary.modal.invoice.title"})]})}),s.jsxs(G.Body,{children:[s.jsx("div",{className:"salt-m-t--4 salt-m-b--8",children:s.jsx(P,{children:s.jsx(v,{id:"checkout.summary.modal.invoice.body"})})}),s.jsx(Ce,{intent:"warning",showIcon:!1,text:s.jsx(v,{id:"checkout.summary.modal.invoice.alert.warning.text"})})]}),s.jsxs(G.Footer,{className:"salt-gap--2",align:"left",children:[s.jsxs(b,{intent:"secondary",onClick:r,"data-test":"invoice-warning-modal-cancel-button",children:[s.jsx(Ee,{children:s.jsx(v,{id:"checkout.summary.modal.invoice.cancel.accessibility"})}),s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.modal.invoice.cancel"})})]}),s.jsx(b,{intent:"action",onClick:a,"data-test":"invoice-warning-modal-continue-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.modal.invoice.continue"})})})]})]})},HTt=e=>({isOpen:Ue("checkoutSummaryInvoice")(e),isLoading:q4(e),hasFetchError:K4(e),isFetched:W4(e)}),VTt=ot({closeModal:Z.closeModal}),YTt=Ct(ke(HTt,VTt))($Tt),WTt=({provider:e,onClick:t,instrumentType:n,showProvider:o,intl:r})=>{const a={[Pu.CARD]:"payment_card",[Pu.PAYPAL]:"paypal"},i={[Pu.CARD]:r.formatMessage("settings.wallet.add.item.modal.add.card"),[Pu.PAYPAL]:r.formatMessage("settings.wallet.add.item.modal.add.paypal")};return s.jsxs(b,{className:"salt-m-b--2",fill:!0,intent:"secondary","data-test":`wallet-item-add-${e.name.toLowerCase()}-button`,"data-synthetics":`wallet-item-add-${e.name.toLowerCase()}-button`,onClick:t,children:[s.jsx(b.Icon,{name:a[n]}),s.jsxs(b.Text,{children:[i[n],o?s.jsxs("span",{"data-test":"provider-name",children:["` ($",e.name,")`"]}):null]})]},e.name)};function qTt({activePsps:e,isOpen:t,onSelectPsp:n}){h.useEffect(()=>{if(!t)return;if(!e.length){Me.api.pushError(new Error("There is no active psp in the environment"));return}const o=e.filter(r=>!r.isKnown()).map(r=>r.rawId);if(o.length){Me.api.pushError(new Error(`These activePsps do not match any psp: ${o.join(", ")}`));return}if(e.length===1){const[r]=e;r&&n(r)}},[t,e,n])}const KTt=D("ppn"),zTt=D("m.la.h"),HZ=({isOpen:e=!1,modalLeftAlignEnabled:t=!1,isShowPaymentProviderNameFlagEnabled:n=!1,activePsps:o,actions:r,paymentFlow:a,onSelectPsp:i,close:l})=>{const[c,d]=h.useState(!1),u=M(),m={title:u.formatMessage("settings.wallet.add.item.modal.title")};h.useEffect(()=>{r.fetchActivePsps(a)},[]);const g=C=>{d(!0),i(C),f()};qTt({onSelectPsp:g,activePsps:o,isOpen:e});const f=()=>{r.analyticsEvent({type:xt.ADD_PAYMENT_METHOD_MODAL_DISPLAYED,userAction:"close"}),d(!1),l?l():r.close()},y=C=>{if(!C.isKnown())return null;const _=C.id===ds.PayPal?Pu.PAYPAL:Pu.CARD;return s.jsx(WTt,{provider:C,onClick:()=>g(C),showProvider:n,instrumentType:_,intl:u},C.name)},I=o.filter(C=>C.isKnown());if(I.length<2)return null;const S="select-wallet-item-modal-header";return s.jsxs(G,{isOpen:e,onRequestClose:()=>f(),loadingPlaceholder:"spinner",isLoading:c,aria:{labelledby:S},children:[s.jsx(G.Header,{align:t?"left":"center",children:s.jsx(ne,{as:"h1",id:S,"data-test":S,children:m.title})}),s.jsx(G.Body,{children:I?.map(C=>y(C))})]})},QTt=e=>({isShowPaymentProviderNameFlagEnabled:KTt(e),modalLeftAlignEnabled:zTt(e)}),XTt=ot({fetchActivePsps:ZX.fetchActivePsps,close:Z.closeModal,analyticsEvent:U.analyticsEvent});HZ.defaultProps={close:void 0,isShowPaymentProviderNameFlagEnabled:!1,modalLeftAlignEnabled:!1};const ZTt=ke(QTt,XTt)(HZ),JTt=UQe(nI.NON_SAVED),VZ=({isOpen:e=!1,activePsps:t,close:n,modalOptions:{setPsp:o}={setPsp:()=>{}}})=>{const r=a=>{a.id===FD.Braintree?o("BraintreePspWeb"):o(a.id)};return s.jsx(ZTt,{activePsps:t,onSelectPsp:r,isOpen:e,paymentFlow:nI.NON_SAVED,close:n})};VZ.defaultProps={close:void 0};const lU="selectNonSavedPspModal",e_t=e=>({activePsps:JTt(e),isOpen:Ue(lU)(e),modalOptions:Vo(lU)(e)}),t_t=ke(e_t)(VZ),s_t=({onChange:e})=>{const t=E(CO);return h.useEffect(()=>{e(t)},[t]),{hasRecurringOrders:t}},ML=({className:e="salt-m-t--4 salt-m-b--2",dataTestId:t="save-payment-details"})=>{const n=F(),o=E(Dg),r=M(),a=r.formatMessage("checkout.summary.save.payment.details.link"),i=u=>{n(kt.setToSavePaymentMethod(u)),n(kt.setIsToSavePaymentMethodValid(!0))};s_t({onChange:i});const c=E(Q2e)?"":r.formatMessage("checkout.summary.save.payment.details.validation.error"),d=!!a.trim();return s.jsx("div",{className:e,"data-test":t,children:s.jsx(mo,{last:!0,input:{onChange:()=>i(!o),checked:o},bold:!!c,meta:{error:c,touched:!!c,invalid:!!c},label:s.jsxs(h.Fragment,{children:[s.jsx(v,{id:"checkout.summary.save.payment.details.prelink.text"}),d&&s.jsx(rt,{className:"salt-d--inline-block",target:"_blank",href:a,children:s.jsx(v,{id:"checkout.summary.save.payment.details.link.text"})})]}),"data-test":"save-payment-details-checkbox"})})},n_t=D("m.la.h"),YZ="failure-modal-header",jL=({actions:e})=>{const t=E(n_t);return s.jsxs(h.Fragment,{children:[s.jsx(G.Header,{align:t?"left":"center","data-test":"failure-modal-header",children:s.jsx(ne,{as:"h2",id:YZ,children:s.jsx(v,{id:"failure.modal.title"})})},"header"),s.jsx(G.Body,{children:s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{colStart:{xs:2,md:3,lg:4},colSpan:{xs:10,md:8,lg:6},children:s.jsx(se,{justify:"center",children:s.jsx(me,{error:!0,name:"status_no",height:100,width:100})})}),s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(P,{children:s.jsx(v,{id:"failure.modal.body"})})})]})},"body"),s.jsx(G.Footer,{align:t?"left":"center",children:s.jsx(b,{fill:!0,intent:"primary","data-test":"failure-modal-button",onClick:e.onButtonClick,children:s.jsx(b.Text,{children:s.jsx(v,{id:"failure.modal.button"})})})})]})},o_t=({modalLeftAlignEnabled:e,isLoyaltyPaymentEnabled:t})=>s.jsxs(G.Header,{align:e?"left":"center",children:[!e&&!t&&s.jsx(me,{name:"loyalty",height:64,width:64,verticalAlign:"middle"}),!e&&s.jsx("div",{className:"salt-m-l--4"}),s.jsxs(ne,{as:"h2",id:"redeem-loyalty-modal-header",children:[e&&!t&&s.jsx("div",{className:"salt-m-r--1 salt-d--inline-block",children:s.jsx(me,{name:"loyalty",height:30,width:30,verticalAlign:"sub"})}),s.jsx(v,{id:"loyalty.modal.heading"})]})]}),mb=({type:e="button",isRedeemable:t,closeModal:n,redeemLoyaltyPointsAndClose:o,className:r="salt-m-t--4"})=>s.jsx("div",{className:r,children:t?s.jsx(b,{type:e,intent:"primary",fill:!0,"data-test":"redeem-loyalty-and-close-button","data-synthetics":"basket-redeem-loyalty-points",onClick:e==="button"?o:void 0,children:s.jsx(b.Text,{children:s.jsx(v,{id:"loyalty.modal.redeem.button"})})}):s.jsx(b,{type:e,intent:"primary",fill:!0,"data-test":"back-to-basket-button","data-synthetics":"basket-back",onClick:n,children:s.jsx(b.Text,{children:s.jsx(v,{id:"loyalty.modal.back"})})})}),r_t=D("loyalty"),a_t=({actions:e,currentOrderId:t,balance:n,canRedeem:o,loyaltyDisplayType:r,minSpend:a,balanceProgress:i,minSpendShortfall:l,isBalanceBelowMin:c,areApplicableItemsBelowMin:d,isUnApplicableItemsRestricted:u,isPartiallyRedeemable:m})=>{h.useEffect(()=>{const A={orderId:t,loyaltyMoney:n.money.amount,loyaltyCurrency:n.money.currency,loyaltyUnits:n.units,canRedeemLoyalty:o};e.analyticsEvent({type:_e.APPLICABLE_LOYALTY,...A})},[e,t,n,o]);const g=A=>r==="CURRENCY"?s.jsx(aGe,{price:A.money}):A.units,f=()=>s.jsxs(pe.Group,{children:[s.jsx(pe.Title,{children:s.jsx(v,{id:"loyalty.modal.discount.caption"})}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx(P,{intent:"promotion",bold:!0,children:s.jsx($u,{discount:!0,getQuantity:PA})})})]}),y=()=>c?s.jsxs(h.Fragment,{children:[s.jsx(P,{children:s.jsx(v,{id:"loyalty.modal.minimum.caption",values:{minSpend:g(a),minSpendShortfall:g(l)}})}),s.jsx("div",{className:"salt-m-t--4",children:s.jsx(sC,{progress:i})})]}):null,I=()=>d?s.jsx(Ce,{intent:"warning",showIcon:!1,text:s.jsx(v,{id:"loyalty.modal.applicable.items.below.min.alert"})}):null,S=()=>u?s.jsx(Ce,{intent:"warning",showIcon:!1,text:s.jsx(v,{id:"loyalty.modal.non.applicable.items.alert"})}):null,C=()=>n?s.jsxs(pe.Group,{children:[s.jsx(pe.Title,{children:s.jsx(v,{id:"loyalty.modal.balance.caption"})}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx($u,{getQuantity:Og})})]}):null,_=()=>m||d?s.jsxs(pe.Group,{children:[s.jsx(pe.Title,{children:s.jsx(v,{id:"loyalty.modal.redeemable.caption"})}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx($u,{getQuantity:PA})})]}):null;return s.jsxs(h.Fragment,{children:[s.jsxs(pe,{children:[C(),_(),f()]}),y(),I(),S()]})},i_t=e=>({loyaltyDisplayType:r_t(e)?LO(e):null,minSpend:z4(e),balanceProgress:Hqe(e),minSpendShortfall:Fqe(e),balance:Og(e),isPartiallyRedeemable:Vqe(e),isBalanceBelowMin:Uqe(e),areApplicableItemsBelowMin:Gqe(e),isUnApplicableItemsRestricted:$qe(e),canRedeem:Yqe(e),currentOrderId:At(e)}),l_t=e=>({actions:Ki({analyticsEvent:U.analyticsEvent},e)}),c_t=ke(i_t,l_t)(a_t),d_t=({isRedeemable:e,closeModal:t,addLoyaltyUnitsToBasket:n})=>{const o=()=>{n(),t()};return s.jsxs(G.Body,{children:[s.jsx(c_t,{}),s.jsx(mb,{isRedeemable:e,closeModal:t,redeemLoyaltyPointsAndClose:o})]})},u_t=({usedPoints:e,spendConversionRate:t,isIntendedPointsValid:n,amountToBePaidByCustomer:o})=>{const r=ze();return o&&t!==1?s.jsxs(pe.Group,{children:[s.jsx(pe.Title,{padding:"md",children:s.jsx(v,{id:"loyalty.modal.discount.caption"})}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx(P,{intent:"promotion",bold:!0,children:r({...o,amount:n?fi(e*t):0})})})]}):null},p_t=({balance:e})=>{const t=Yp({getQuantity:e});return t?s.jsxs(pe.Group,{children:[s.jsx(pe.Title,{padding:"md",children:s.jsx(v,{id:"loyalty.modal.balance.caption"})}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx(P,{bold:!0,children:t})})]}):null},m_t=({amountToBePaidByCustomer:e})=>{const t=ze();return e?s.jsxs(pe.Group,{children:[s.jsx(pe.Title,{padding:"md",children:s.jsx(v,{id:"loyalty.modal.order.offered.price.caption"})}),s.jsx(pe.Description,{nowrap:!0,children:s.jsx(P,{bold:!0,"data-test":"loyalty-modal-order-offered-price-amount",children:t(e)})})]}):null},Qa={AmountStepMismatch:"loyalty.modal.validation.status.step-mismatch",AmountExceedsBalance:"loyalty.modal.validation.status.balance-exceeded",AmountExceedsOrderValue:"loyalty.modal.validation.status.order-value-exceeded",AmountNotProvided:"loyalty.modal.validation.status.amount-not-provided",NonNumericalInput:"loyalty.modal.validation.status.non-numerical-input",AmountBelowMinSpend:"loyalty.modal.validation.status.below.min.spend",AmountExceedsMaxSpend:"loyalty.modal.validation.status.above.max.spend",MinMonetarySpend:"exceeded.loyalty.points.amount.validation.error"},Ir="loyalty-points-amount-to-use",h_t=T(Jo)`
    &::-webkit-outer-spin-button,
    &::-webkit-inner-spin-button {
        appearance: none;
        margin: 0;
    }
`,g_t="^[1-9]+[0-9]*$",E_t=({setUsedPoints:e,formContext:t,balance:n,onInvalid:o,closeModal:r,isRedeemable:a,errorMessage:i,minSpendUnits:l,maxSpendUnits:c,minMonetarySpend:d,spendIncrementStep:u,spendConversionRate:m,defaultRedeemableUnits:g,addLoyaltyUnitsToBasket:f,loyaltyUnitsLeftToSpend:y,amountToBePaidByCustomer:I})=>{const S=M(),C=ze(),[_]=fe(["nfchk"]),A=w=>{const L=Number(w);return d&&Number(d.amount)&&L>Number(y)?S.formatMessage(Qa.MinMonetarySpend,{points:y,money:C(d)}):L>n.units?S.formatMessage(Qa.AmountExceedsBalance):L>c?S.formatMessage(Qa.AmountExceedsMaxSpend,{maxSpendUnits:c}):L>Number(I.amount)/m?S.formatMessage(Qa.AmountExceedsOrderValue):L<l?S.formatMessage(Qa.AmountBelowMinSpend,{minSpendUnits:l}):(e(L),!0)},x=()=>{t.getFieldState(Ir).invalid||(f(Number(t.getValues(Ir))),r())},R=w=>{w.preventDefault();let L="";const B=w.target;B instanceof HTMLInputElement&&!B.validity.valid&&(B.validity.patternMismatch?L=S.formatMessage(Qa.NonNumericalInput):B.validity.valueMissing?L=S.formatMessage(Qa.AmountNotProvided):B.validity.stepMismatch&&(L=S.formatMessage(Qa.AmountStepMismatch)),B.focus()),o(L)},O=w=>{const L=A(w??"");return e(Number(w)),typeof L=="string"?(o(L),!1):(o(""),!0)},N=w=>{w.preventDefault();const L=w.currentTarget,B=L.elements.namedItem(Ir),$=new FormData(L).get(Ir)?.toString();if(!O($??"")&&B instanceof HTMLInputElement){B.focus();return}L.checkValidity(),f(Number($)),r()},k=()=>{O("")},j=w=>{const L=w.target.value;O(L)};if(_){const w=S.formatMessage("loyalty.modal.configurable.spend.caption"),L=S.formatMessage("loyalty.modal.configurable.spend.placeholder"),B=S.formatMessage("salt.form.text-field.clear-button.a11y.label");return s.jsxs(mt,{onSubmit:N,onInvalid:R,children:[s.jsx(mt.TextField,{required:!0,type:"number",onBlur:j,onClear:k,step:u,pattern:g_t,errorMessage:i,label:{text:w},placeholder:L,id:Ir,defaultValue:g,name:Ir,"data-test":"configurable-loyalty-points-input-field",clearButton:{ariaLabel:B}},Ir),s.jsx(mb,{type:"submit",className:"salt-m-t--8",closeModal:r,isRedeemable:a})]})}return s.jsx($n,{...t,children:s.jsxs("form",{onSubmit:t.handleSubmit((w,L)=>{L?.preventDefault();const{[Ir]:B}=w;f(Number(B)),r()}),children:[s.jsx(h_t,{name:Ir,id:Ir,label:S.formatMessage("loyalty.modal.configurable.spend.caption"),placeholder:S.formatMessage("loyalty.modal.configurable.spend.placeholder"),pattern:{value:/^[1-9]+[0-9]*$/,message:S.formatMessage(Qa.AmountNotProvided.toString())},validate:A,hasRequiredSymbol:!1,type:"number",step:u,valueAsNumber:!1,"data-test":"configurable-loyalty-points-input-field",required:{value:!0,message:S.formatMessage(Qa.NonNumericalInput.toString())}},Ir),s.jsx(mb,{isRedeemable:a,closeModal:r,redeemLoyaltyPointsAndClose:x,className:"salt-m-t--8"})]})})},f_t=({redeemableUnits:e,balance:t,spendConversionRate:n,spendIncrementStep:o,isRedeemable:r,closeModal:a,addLoyaltyUnitsToBasket:i,amountToBePaidByCustomer:l,maxSpendUnits:c,minSpendUnits:d,minMonetarySpend:u,loyaltyUnitsLeftToSpend:m})=>{const[g,f]=h.useState(e),y=E(At),[I]=fe(["nfchk"]),[S,C]=h.useState(""),_=F();h.useEffect(()=>{_(U.analyticsEvent({type:_e.LOYALTY_POINTS_DISPLAYED,payload:{pageEventAttributes:{type:"loyaltyPayment",orderId:y,balance:t}}}))},[t,y,_]);const A=Gn({mode:"onBlur",reValidateMode:"onBlur",defaultValues:{[Ir]:e===0?void 0:e}});return s.jsx(G.Body,{children:s.jsxs(pe,{children:[s.jsx(p_t,{balance:Og}),s.jsx(m_t,{amountToBePaidByCustomer:l}),s.jsx(u_t,{usedPoints:g,isIntendedPointsValid:I?!S:!A.getFieldState(Ir).invalid,amountToBePaidByCustomer:l,spendConversionRate:n}),s.jsx(E_t,{errorMessage:S,onInvalid:x=>C(x),defaultRedeemableUnits:e===0?void 0:e.toString(),setUsedPoints:f,formContext:A,spendIncrementStep:o,balance:t,amountToBePaidByCustomer:l,spendConversionRate:n,isRedeemable:r,closeModal:a,addLoyaltyUnitsToBasket:i,maxSpendUnits:c,minSpendUnits:d,minMonetarySpend:u,loyaltyUnitsLeftToSpend:m})]})})},y_t=e=>({amountToBePaidByCustomer:zqe(e),balance:Og(e),spendConversionRate:qqe(e),spendIncrementStep:Wqe(e),maxSpendUnits:Qqe(e),minSpendUnits:Q4(e),minMonetarySpend:Xqe(e),loyaltyUnitsLeftToSpend:Zqe(e)}),I_t=Ct(ke(y_t))(f_t),S_t=D("m.la.h"),C_t=D("loy.waon"),T_t=({isOpen:e,isLoading:t,hasFetchError:n,isRedeemable:o,redeemableUnits:r,isLoyaltyPaymentEnabled:a,actions:{closeModal:i,addLoyaltyUnitsToBasket:l,getApplicableLoyalty:c},isFetched:d,modalLeftAlignEnabled:u=!1})=>s.jsx(G,{isOpen:e,isLoading:t,onAfterOpen:()=>c(),onRequestClose:i,aria:{labelledby:n?YZ:"redeem-loyalty-modal-header"},asBottomSheet:!0,children:n?s.jsx(jL,{actions:{onButtonClick:()=>c()}}):s.jsxs(h.Fragment,{children:[s.jsx(o_t,{modalLeftAlignEnabled:u,isLoyaltyPaymentEnabled:a}),d&&(a?s.jsx(I_t,{isRedeemable:o,redeemableUnits:r,closeModal:i,addLoyaltyUnitsToBasket:l}):s.jsx(d_t,{isRedeemable:o,closeModal:i,addLoyaltyUnitsToBasket:l}))]})}),__t=e=>({isOpen:Ue("redeemLoyalty")(e),isLoading:q4(e),hasFetchError:K4(e),isRedeemable:Bqe(e),redeemableUnits:MO(e),isFetched:W4(e),modalLeftAlignEnabled:S_t(e),isLoyaltyPaymentEnabled:C_t(e)}),v_t=e=>({actions:Ki({closeModal:Z.closeModal,addLoyaltyUnitsToBasket:kh.addLoyaltyUnitsToBasket,getApplicableLoyalty:Pf.getApplicableLoyalty},e)}),WZ=Ct(ke(__t,v_t))(T_t),yI=({type:e,action:t,readOnly:n=!1,children:o})=>{const r=M();return s.jsx(ve,{condensed:!0,"data-test":`summary-${e}`,className:"salt-p--0",children:s.jsxs(se,{justify:"space-between",align:"center",wrap:"nowrap",children:[s.jsxs(se,{className:"salt-m-r--1",align:"center",wrap:"nowrap",children:[!n&&s.jsx(me,{className:"salt-m-r--1",success:!0,name:"status_yes",verticalAlign:"bottom",lineHeight:"0",height:20,width:20}),s.jsx(P,{children:o})]}),!n&&s.jsx(b,{intent:"tertiary",fill:!1,"data-test":`${e}-remove`,"aria-label":r.formatMessage("summary.component.accessibility.discount.remove.button.label"),onClick:t,children:s.jsx(b.Icon,{name:"close_default","aria-hidden":!0})})]})})},qZ=({loyaltyInBasket:e,removeLoyaltyUnitsFromBasket:t})=>s.jsx(Ve.Item,{children:s.jsx(yI,{type:"loyalty",action:t,children:s.jsx(v,{id:"checkout.summary.discounts.loyalty.redeemed",values:{loyaltyRedeemed:e}})})},"loyalty"),A_t=T.div`
    padding-block: var(--salt-spacing-1) 0;
    padding-inline: var(--salt-spacing-8) 0;
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    column-gap: var(--salt-spacing-1);
`,b_t=T.span`
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    border: var(--salt-border-1) solid var(--intent-secondary-900);
    border-radius: var(--salt-radius-default);
    block-size: ${H(24)};
    inline-size: ${e=>`${H(e.containerWidth)}`};
    overflow: hidden;
`,x_t=h.memo(({icons:e})=>{const{formatMessage:t}=M(),n=Cs("financing-options-option-name");return e?.length?s.jsx(A_t,{"data-test":"payment-list-item-icons",children:e.map(o=>{const r=R_t({name:o,formatMessage:t,defaultAltText:n}),{containerWidth:a,width:i,height:l}=D_t(o);return s.jsxs(b_t,{"data-test":"payment-list-item-icon",containerWidth:a,children:[s.jsx(me,{name:o,height:l,width:i,"aria-hidden":"true"}),s.jsx(Ee,{children:r})]},o)})}):null}),R_t=({name:e,formatMessage:t,defaultAltText:n})=>{switch(e){case Gt.VISA:return t("checkout.summary.payment.options.cardsAndPaypal.accessibility.visa");case Gt.MASTERCARD:return t("checkout.summary.payment.options.cardsAndPaypal.accessibility.mastercard");case Gt.PAYPAL:return t("checkout.summary.payment.options.cardsAndPaypal.accessibility.payPal");case Gt.BLIK:return t("checkout.summary.payment.options.payNow.accessibility.blik");case Gt.BANK_TRANSFER:return t("checkout.summary.payment.options.payNow.accessibility.bankTransfer");case Gt.PAYMENT_CARD:return t("checkout.summary.payment.options.payNow.accessibility.paymentCard");case Gt.VISA_PHONE:return t("checkout.summary.payment.options.payNow.accessibility.visaPhone");case Gt.GOOGLE_PAY:return t("checkout.summary.payment.options.payNow.accessibility.googlePay");case Gt.APPLE_PAY:return t("checkout.summary.payment.options.payNow.accessibility.applePay");case Gt.SMARTNEY:return t("checkout.summary.payment.options.payNow.accessibility.smartney");case Gt.ONEY:return t("checkout.summary.payment.options.payNow.accessibility.oney");case Gt.L_PAY:return t("checkout.summary.payment.options.payNow.accessibility.lPay");default:return n}},D_t=e=>{switch(e){case Gt.PAYPAL:return{width:57,containerWidth:69,height:14};case Gt.FINANCING_OPTION_ICON:return{width:82,containerWidth:92,height:14};case Gt.BANK_TRANSFER:case Gt.PAYMENT_CARD:case Gt.VISA_PHONE:case Gt.GOOGLE_PAY:case Gt.APPLE_PAY:return{width:26,containerWidth:36,height:20};case Gt.NAVERPAY:case Gt.KAKAOPAY:return{width:35,containerWidth:35,height:23};case Gt.L_PAY:return{width:45,containerWidth:45,height:23};default:return{width:24,containerWidth:36,height:14}}},{RadioIconOff:O_t,RadioIconOn:P_t}=ha,N_t=T.div`
    margin-block-end: var(--salt-spacing-0.5);

    &:last-child {
        margin-block-end: var(--salt-spacing-2);
    }
`,L_t=T.label`
    font-weight: 600;
    font-size: ${H(16)};
    display: flex;
    align-items: center;
    column-gap: var(--salt-spacing-1);
    padding-inline-start: 0;
    inline-size: fit-content;
`,k_t=T.input`
    block-size: 0;
    inline-size: 0;
    position: absolute;
    appearance: none;

    &:focus + span {
        outline: ${H(5)} auto Highlight;
        outline: ${H(5)} auto -webkit-focus-ring-color;
        outline-offset: ${H(1)};
    }
`,M_t=({label:e,onChange:t,ariaLabel:n,icons:o,checked:r,children:a,value:i,promotion:l})=>{const{formatMessage:c}=M();return s.jsxs(N_t,{children:[s.jsxs(se,{"data-test":"payment-list-item-header",className:"salt-m-y--2",direction:"column",children:[s.jsxs(se,{direction:"row",align:"center",justify:"space-between",additionalCss:"flex: 1",children:[s.jsx(se,{direction:"row",wrap:"nowrap",children:s.jsxs(L_t,{"aria-label":n,children:[s.jsx(k_t,{type:"radio",checked:r,name:"payment-option","data-test":"payment-list-item-control",value:i,onChange:t,"data-synthetics":"payment-method-option"}),r&&s.jsx(P_t,{name:"radio_on"}),!r&&s.jsx(O_t,{name:"radio_off"}),s.jsx("span",{children:e})]})}),l&&s.jsx(P,{intent:"promotion",size:"s",children:c("checkout.summary.payment.method.promotion.available")})]}),s.jsx(x_t,{icons:o})]}),s.jsx(HS.Provider,{value:{expanded:r,name:"payment-list-item",onToggle:()=>{}},children:s.jsx(st.ContentExpanded,{children:s.jsx("div",{className:"salt-p salt-p-l--8 salt-p-r--0.5",children:a})})})]})};class j_t extends Error{}class cU extends Error{}const KZ=()=>{const{formatMessage:e}=M(),t=E(jg);return h.useMemo(()=>{if(!t)return[];const n=[{id:ct.PAY_NOW,title:e("checkout.summary.payment.options.payNow.title"),ariaLabel:e("checkout.summary.payment.options.payNow.accessibility.radio.label"),type:at.UNKNOWN},{id:ct.L_PAY,title:e("checkout.summary.payment.options.payNow.lPay.title"),ariaLabel:e("checkout.summary.payment.options.payNow.lPay.accessibility.radio.label"),type:at.L_PAY},{id:ct.CASH_ON_DELIVERY,title:e("checkout.summary.payment.options.payAtDelivery.title"),ariaLabel:e("checkout.summary.payment.options.payAtDelivery.accessibility.radio.label"),type:at.CASH_ON_DELIVERY},{id:ct.B2B_DEFERRED_PAYMENT,title:e("checkout.summary.payment.options.invoice.title"),ariaLabel:e("checkout.summary.payment.options.invoice.accessibility.radio.label"),type:at.INVOICE},{id:ct.INSTALMENTS,title:e("checkout.summary.payment.options.financingOptions.title"),ariaLabel:e("checkout.summary.payment.options.instalments.accessibility.radio.label"),type:at.CARD_INSTALMENTS},{id:ct.KAKAOPAY,title:e("checkout.summary.payment.options.kakaopay.title"),ariaLabel:e("checkout.summary.payment.options.kakaopay.accessibility.radio.label"),type:at.KAKAOPAY},{id:ct.NAVERPAY,title:e("checkout.summary.payment.options.naverpay.title"),ariaLabel:e("checkout.summary.payment.options.naverpay.accessibility.radio.label"),type:at.NAVERPAY}];return t.reduce((o,r)=>{const a=n.find(i=>i.id===r.name&&i.type===r.type);return a&&o.push({...a,promotion:r.promotion,icons:r.iconAssetsNames}),o},[])},[t,e])},II=({message:e})=>{const n=M().formatMessage(e);return!n.trim()?null:s.jsx(Ce,{intent:"info",className:"salt-m-t--2",size:"s",text:n})},w_t=({interestRates:e,commissionFee:t})=>{const{formatNumber:n,formatMessage:o}=M(),r=ze();return s.jsxs(se,{wrap:"wrap",align:"center",justify:"flex-start",children:[e.map(({name:a,value:i,accessibilityLabel:l})=>s.jsxs("span",{className:"salt-m-r--1",children:[s.jsxs(P,{size:"s",className:"salt-m-r--0.5","aria-hidden":"true",children:[a,":"]}),s.jsx(Ee,{children:l}),s.jsx(P,{size:"s",bold:!0,children:n(i,{style:"percent",minimumFractionDigits:2})})]},a)),s.jsxs("span",{children:[s.jsxs(P,{size:"s",className:"salt-m-r--0.5",children:[o("checkout.summary.payment.options.financingOptions.calculator.commissionFee"),":"]}),s.jsx(P,{size:"s",bold:!0,children:r(t)})]})]})},F_t=({activeOption:{totalAmount:e,monthlyAmount:t,offerAvailabilityEnd:n,commissionFee:o,interestRates:r}})=>{const a=ze(),i=E(Jt),l=h.useMemo(()=>n&&Ks(i,n),[n]);return!t||!e||!n||!o||!r?null:s.jsxs("div",{"data-test":"instalments-calculator",children:[t&&s.jsx(ne,{as:"span",className:"salt-m-b--1",children:s.jsx(v,{id:"checkout.summary.payment.options.financingOptions.calculator.paymentPerMonth",values:{paymentAmount:a(t)}})}),e&&s.jsx("div",{className:"salt-m-b--1",children:s.jsx(P,{size:"l",className:"salt-m-r--0.5",children:s.jsx(v,{id:"checkout.summary.payment.options.financingOptions.calculator.total",values:{paymentTotalAmount:a(e)}})})}),r&&o&&s.jsx("div",{className:"salt-m-b--2",children:s.jsx(w_t,{interestRates:r,commissionFee:o})}),l&&s.jsx(Ce,{intent:"warning",showIcon:!1,text:s.jsx(v,{id:"checkout.summary.payment.options.financingOptions.calculator.validUntil",values:{validityЕndDate:l}})})]})},B_t=({activePlan:e,financingPlans:t})=>{const n=Cs("financing-options-instalment-plans-description-url");if(!t?.length)return null;const o=t.find(r=>r.retailerFinancingPlanId===e);return s.jsxs("div",{className:"salt-m-t--2",children:[o&&s.jsx(F_t,{activeOption:o}),o?.description&&o?.linkDescription&&s.jsxs(P,{"data-test":"financing-option-text",children:[o?.description,n&&s.jsx(rt,{className:"salt-m-l--0.5",target:"_blank",href:n,children:o.linkDescription})]})]})},{RadioIconOff:U_t,RadioIconOn:G_t}=ha,$_t=T.div`
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--salt-spacing-4);
    cursor: pointer;
    background: white;
    border-radius: var(--salt-radius-default);
    margin-block-end: var(--salt-spacing-1);
`,H_t=T.div`
    display: flex;
    align-items: center;
    gap: var(--salt-spacing-2);
`,V_t=T.span`
    margin-block-end: var(--salt-spacing-2);
`,Y_t=({value:e,label:t,promotionText:n,icon:o,isSelected:r,onClick:a,dataTest:i,previousSelectValue:l,enableAriaLabel:c=!0,...d})=>{const{formatMessage:u}=M(),m=f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),a())},g=()=>{const f=[];return f.push(u(r?"checkout.summary.payment.options.financingOptions.modal.accessibility.option.selected.label":"checkout.summary.payment.options.financingOptions.modal.accessibility.option.unselected.label",{option:t})),l&&f.push(l),n&&f.push(n),f.join(", ")};return s.jsxs($_t,{className:r?"selected":"",onClick:a,onKeyDown:m,"data-test":i||`select-option-${e}`,role:"option",tabIndex:0,"aria-label":c?g():void 0,"aria-selected":r,...d,children:[s.jsxs(H_t,{children:[r?s.jsx(G_t,{name:"radio_on"}):s.jsx(U_t,{name:"radio_off"}),o&&s.jsx(V_t,{children:o}),s.jsx("span",{children:t})]}),n&&s.jsx(P,{intent:"promotion",size:"s",children:n})]})},W_t=(()=>{let e=0;return{next(){return e+=1,`uid-${e}`}}})(),q_t=T.span`
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    color: ${({disabled:e})=>e?"var(--intent-content-200)":"var(--intent-content)"};
`,wL=({onChange:e,value:t,children:n,placeholder:o="",size:r="md",id:a="",error:i,label:l="",hideLabel:c,helperText:d="",flush:u=!1,className:m,fill:g,options:f=[],confirmText:y="",confirmArialLabel:I,closeMessage:S="",previousSelectValue:C,autoOpenSecondModal:_=!1,enableAriaLabel:A=!0,secondaryOptions:x=[],blockModalOpening:R=!1,onSecondarySelect:O,...N})=>{const j=h.useRef(a||W_t.next()).current,w=`${j}-error-message`,L=!!i,[B,W]=h.useState(!1),[$,K]=h.useState(t),[Q,X]=h.useState(t),re=E(_O),ue=E(D("pbpm")),te=E(D("nfpay"));h.useEffect(()=>{ue&&(K(t),X(t))},[re,ue]);const ce=Oe=>{const Xe=[],Se=et=>Array.isArray(et.props?.children)&&et.props.children.length>0,dt=et=>Se(et)&&et.type!=="option"?et.props.children.map(we=>dt(we).flat()):[et];return h.Children.toArray(Oe).map(et=>dt(et).flat()).flat().filter(et=>et.type==="option").forEach(et=>{Xe.push({value:et.props.value,label:et.props.children})}),Xe},de=()=>{R||(X($),W(!0))},ye=()=>{W(!1),X($)},Ae=Oe=>{X(Oe.value)},Je=()=>{K(Q);const Oe={target:{value:Q,name:N.name}};e?.(Oe),ye()},Ie=Oe=>{Oe.key==="Enter"&&(Oe.preventDefault(),de())},je=()=>{const Oe=Le.find(Xe=>Xe.value===$);return Oe?Oe.label:o},Le=f.length>0?f:ce(n),Be=Le.map(Oe=>({value:String(Oe.value),label:Oe.label,icon:Oe.icon,promotionText:Oe.promotionText})),be=()=>te?s.jsx(ve,{children:s.jsx(mt.RadioGroup,{name:`select-modal-${j}`,groupLabel:{text:String(l),isVisuallyConcealed:!0},value:Q??"",onChange:Oe=>X(Oe),radios:Be,required:!0,disabled:R})}):s.jsx("div",{className:"salt-m-b--4",children:Le.map(Oe=>s.jsx(Y_t,{value:Oe.value,previousSelectValue:C,label:Oe.label,promotionText:Oe.promotionText,icon:Oe.icon,isSelected:Q===Oe.value,onClick:()=>Ae(Oe),dataTest:`select-option-${Oe.value}`,enableAriaLabel:A},Oe.value))}),he=N["data-test"]&&N["data-test"]!==""?`${N["data-test"]}-select-modal-result`:"select-modal-result",ge="select-modal-header";return s.jsxs(ie.Fragment,{children:[s.jsxs(Oa,{"data-test":"select-modal-wrapper",fill:g,className:m,children:[!!l&&s.jsx(bn,{visuallyConcealed:!!c,hasError:!!i,htmlFor:j,isRequired:N.required,children:l}),d&&s.jsx(P,{className:"salt-d--block salt-m-b--1",children:d}),s.jsx(Au.SelectWrapper,{hasError:L,size:r,onClick:de,"data-test":N["data-test"]||"select-modal-trigger",onKeyDown:Ie,tabIndex:0,children:s.jsx(q_t,{"data-test":he,disabled:R,children:$?je():s.jsx(Au.Placeholder,{hasError:L,children:o})})}),L&&s.jsx(Ua,{"data-test":"form-field-error-message",id:w,children:i})]}),s.jsxs(G,{isOpen:B,onRequestClose:ye,maxWidth:"sm","data-test":"select-modal-options",closeMessage:S,aria:{labelledby:ge},children:[s.jsx(G.Header,{children:s.jsx(ne,{as:"h1",id:ge,children:s.jsx(P,{children:l})})}),s.jsx(G.Body,{children:be()}),s.jsx(G.Footer,{children:s.jsx(b,{intent:"primary",fill:!0,onClick:Je,"data-test":"select-modal-confirm","aria-label":I,children:y})})]})]})};wL.displayName="SelectModal";const K_t=({value:e,onChange:t,options:n,activeProvider:o,enableAriaLabel:r=!0})=>{const{formatMessage:a}=M(),i="financing-option-dropdown",l=a("checkout.summary.payment.options.financingOptions.dropdown.label"),c=n.find(({retailerFinancingPlanId:u})=>u===e)?.displayName,d=a("checkout.summary.payment.options.financingOptions.accessibility.radio.label",{financingOption:c});return s.jsx(wL,{label:s.jsx(P,{size:"l",bold:!0,children:l}),confirmText:a("checkout.summary.payment.options.financingOptions.modal.confirm"),confirmArialLabel:a("checkout.summary.payment.options.financingOptions.modal.accessibility.confirm"),id:i,tabIndex:0,name:l,value:e??"",previousSelectValue:o,onChange:t,enableAriaLabel:r,"aria-label":d,closeMessage:a("checkout.summary.payment.options.financingOptions.modal.accessibility.close",{title:l}),"data-test":"financing-options-select",children:n.map(({retailerFinancingPlanId:u,displayName:m})=>s.jsx("option",{value:u?.toString(),children:m},u))})},z_t=({value:e,onChange:t,options:n,isFinancingProviderNotSelectedError:o,blocked:r,enableAriaLabel:a=!0})=>{const{formatMessage:i}=M(),l="financing-provider-dropdown",c=i("checkout.summary.payment.options.financingProviders.accessibility.dropdown.label"),d=n.find(({retailerFinancingProviderId:f})=>f===e)?.name,u=i("checkout.summary.payment.options.financingProviders.accessibility.radio.label",{financingProvider:d}),m=i("checkout.summary.payment.options.financingProviders.accessibility.dropdown.placeholder"),g=i("checkout.summary.payment.options.financingProviders.accessibility.dropdown.errorMessage");return s.jsx("div",{className:"salt-m-b--2",tabIndex:0,children:s.jsx(wL,{id:l,name:c,value:e,onChange:t,"aria-label":u,label:s.jsx(P,{size:"l",bold:!0,children:c}),size:"md",placeholder:m,confirmText:i("checkout.summary.payment.options.financingOptions.modal.confirm"),confirmArialLabel:i("checkout.summary.payment.options.financingOptions.modal.accessibility.confirm"),closeMessage:i("checkout.summary.payment.options.financingOptions.modal.accessibility.close",{title:c}),options:n.map(f=>({value:f.retailerFinancingProviderId,label:f.name,promotionText:f.promotion?i("checkout.summary.payment.method.promotion.available"):void 0})),enableAriaLabel:a,blockModalOpening:r,error:!e&&o?g:"","data-test":"financing-providers-select",required:!0,children:n.map(({retailerFinancingProviderId:f,name:y})=>s.jsx("option",{value:f,children:y},f))})})},Q_t=({isFinancingProviderNotSelectedError:e,enableAriaLabel:t=!0})=>{const{formatMessage:n}=M(),o=F(),r=E(mp),a=E(JO),i=E(_O),l=E(Bz),c=E(D("pbpm")),d=E(qie),u=KZ(),m=u.length===1&&u[0]?.type===at.CARD_INSTALMENTS,g=c&&r&&m,f={retailerFinancingPlanId:Sz,displayName:n("checkout.summary.payment.options.financingOptions.lumpSum.label")},y=a?.financingPlans?.displayLumpSum;let I=a?.financingPlans?.options;const S=a?.financingProviders||[],C=O=>y?f.retailerFinancingPlanId:I?.find(N=>N?.financingProviders?.indexOf(O)!==-1)?.retailerFinancingPlanId;ie.useEffect(()=>{if(c&&d){const O=S.find(k=>k.financingProviderId===d);if(!O)return;const N=C(O.retailerFinancingProviderId);o(kt.setFinancingProviders({retailerFinancingProviderId:O.retailerFinancingProviderId,financingProviderId:d})),o(kt.setFinancingOption(N))}else if(S.length===1){const O=S[0]?.retailerFinancingProviderId,N=S[0]?.financingProviderId;if(!O)return;if(o(kt.setFinancingProviders({retailerFinancingProviderId:O,financingProviderId:N})),c&&(!d||d!==N)){if(d&&d!==N&&Me.api.pushError(new j_t("Saved financing provider id is not available on providers list")),!a?.paymentMethodGroupId){z.error("toast.notification.generic.error"),Me.api.pushError(new cU("Can't preselect financing provider. Missing instalments method group id"));return}o(Ht.updateCheckoutCart({paymentMethodGroup:{paymentMethodGroupId:a.paymentMethodGroupId,financingProviderId:N}}))}const k=C(O);o(kt.setFinancingOption(k))}},[S,d,a]),ie.useEffect(()=>{const O=I?.find(N=>N.retailerFinancingPlanId===l);if(l&&!O&&i){const N=C(i);o(kt.setFinancingOption(N))}},[I?.length,i]),y&&I&&(I=[f,...I]);const _=O=>{if(g)return;const N=O.target.value,k=C(N),j=S.find(w=>w.retailerFinancingProviderId===N)?.financingProviderId;if(c){if(!a?.paymentMethodGroupId){z.error("toast.notification.generic.error"),Me.api.pushError(new cU("Can't  change financing provider. Missing instalments method group id"));return}o(Ht.updateCheckoutCart({paymentMethodGroup:{paymentMethodGroupId:a.paymentMethodGroupId,financingProviderId:j}}))}o(kt.setFinancingProviders({retailerFinancingProviderId:N,financingProviderId:j})),o(kt.setFinancingOption(k))},A=O=>{const{value:N}=O.target;o(kt.setFinancingOption(N))},x=ie.useMemo(()=>I?.filter(O=>O.retailerFinancingPlanId===f.retailerFinancingPlanId?!0:O?.financingProviders?.indexOf(i)!==-1)||[],[i,I]),R=S.find(O=>O.retailerFinancingProviderId===i)?.name;return s.jsxs("div",{"data-test":"financing-option-content",children:[s.jsx(II,{message:"checkout.summary.payment.options.financingOptions.info"}),S?.length>1&&s.jsx(z_t,{value:i,onChange:_,options:S,isFinancingProviderNotSelectedError:e,enableAriaLabel:t,blocked:g}),x.length>0&&l&&s.jsx(K_t,{value:l,activeProvider:R,onChange:A,options:x,enableAriaLabel:t},i+l),l&&s.jsx(B_t,{activePlan:l,financingPlans:x})]})},dU=()=>{const e=M(),t=E(D(fz)),n=e.formatMessage("checkout.summary.payment.options.payNow.viewAllPaymentMethods.link"),o=!!n.trim();return s.jsxs("div",{"data-test":"pay-now-content",children:[o&&s.jsx(rt,{target:"_blank",href:n,children:s.jsx(v,{id:"checkout.summary.payment.options.payNow.viewAllPaymentMethods.link.text"})}),s.jsx(II,{message:"checkout.summary.payment.options.payNow.info"}),t&&s.jsx(ML,{className:"salt-m-y--2",dataTestId:"cards-option-save-details-box"})]})},X_t=({paymentOption:e,isFinancingProviderNotSelectedError:t})=>{switch(e){case ct.PAY_NOW:return s.jsx(dU,{});case ct.INSTALMENTS:return s.jsx(Q_t,{isFinancingProviderNotSelectedError:t});case ct.CASH_ON_DELIVERY:return s.jsx("div",{"data-test":"cash-on-delivery-content",children:s.jsx(II,{message:"checkout.summary.payment.options.payAtDelivery.info"})});case ct.B2B_DEFERRED_PAYMENT:return s.jsx("div",{"data-test":"b2b-deferred-content",children:s.jsx(II,{message:"checkout.summary.payment.options.invoice.info"})});case ct.KAKAOPAY:case ct.L_PAY:case ct.NAVERPAY:return null;default:return s.jsx(dU,{})}},Z_t=T.fieldset`
    border: none;
    padding: 0;
    margin: 0;
    min-inline-size: inherit;
    white-space: normal;
    overflow-wrap: anywhere;
`,J_t=({options:e,testId:t,isFinancingProviderNotSelectedError:n,overridePaymentMethodGroups:o})=>{const{formatMessage:r}=M(),a=F(),{paymentOption:i,paymentType:l}=E(jp),c=E(vO),d=`${i}:${l}`,u=E(D("pbpm")),m=E(cx),f=E(JO)?.financingProviders||[];h.useEffect(()=>{if(!m&&o&&u){Me.api.pushLog([`PBPM no payment group form basket ${m}`],{level:Za.DEBUG});const I=o?.find(S=>S.available&&S.name!==ct.LOYALTY);if(!I?.paymentMethodGroupId){z.error("toast.notification.generic.error"),Me.api.pushLog(["PBPM paymentMethodGroupId unavailable"],{level:Za.ERROR});return}I.name!==ct.INSTALMENTS?(a(Ht.updateCheckoutCart({paymentMethodGroup:{paymentMethodGroupId:I.paymentMethodGroupId}})).catch(()=>z.error("toast.notification.generic.error")),Me.api.pushLog([`PBPM update checkout cart paymentMethodGroupId: ${I.paymentMethodGroupId}`],{level:Za.DEBUG})):I.name===ct.INSTALMENTS&&f.length===1&&(a(Ht.updateCheckoutCart({paymentMethodGroup:{paymentMethodGroupId:I.paymentMethodGroupId,financingProviderId:f[0]?.financingProviderId}})).catch(()=>z.error("toast.notification.generic.error")),Me.api.pushLog([`PBPM update checkout cart instalments and only one available financingProviderId: ${I.paymentMethodGroupId}, financingProviderId: ${f[0]?.financingProviderId}`],{level:Za.DEBUG}))}},[]);const y=async I=>{const[S,C]=I.target.value.split(":");if(u){const _=o?.find(A=>A.name===S)?.paymentMethodGroupId;if(_&&S!==ct.INSTALMENTS)try{await a(Ht.updateCheckoutCart({paymentMethodGroup:{paymentMethodGroupId:_}}))}catch{z.error("toast.notification.generic.error");return}else if(_&&S===ct.INSTALMENTS&&c)try{await a(Ht.updateCheckoutCart({paymentMethodGroup:{paymentMethodGroupId:_,financingProviderId:c}}))}catch{z.error("toast.notification.generic.error");return}a(cd())}a(kt.setPaymentOptionAndType({paymentOption:S,paymentType:C}))};return s.jsxs(Z_t,{"data-test":t,children:[s.jsx(Ee,{asChild:!0,children:s.jsx("legend",{children:s.jsx(ne,{as:"h3",children:r("checkout.summary.payment.options.accessibility.invisible.subtitle")})})}),e.map(I=>{const{id:S,title:C,ariaLabel:_,icons:A,type:x,promotion:R}=I,O=l?`${S}:${x}`:S;return s.jsx(M_t,{label:C,onChange:y,checked:O===d,ariaLabel:_,icons:A,value:O,promotion:R,children:s.jsx(X_t,{paymentOption:S,isFinancingProviderNotSelectedError:n})},C)})]})},evt=({type:e=null,option:t=ct.PAY_NOW})=>{const n=F(),{paymentOption:o,paymentType:r}=E(jp);h.useEffect(()=>{(!r||e&&e!==r||t!==o)&&n(kt.setPaymentOptionAndType({paymentOption:t,paymentType:e}))},[e,t])},tvt=T.div`
    display: flex;
    align-items: center;
    column-gap: var(--salt-spacing-1);
    padding-inline-start: 0;
`,svt=T.div`
    padding-block: var(--salt-spacing-1) 0;
    padding-inline: var(--salt-spacing-8) 0;
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    column-gap: var(--salt-spacing-1);
`,hv=()=>s.jsxs(se,{className:"salt-m-b--4",direction:"column",children:[s.jsxs(tvt,{children:[s.jsx(Pe.Icon,{size:"l"}),s.jsx(Pe.Typography,{className:"salt-m--2",fill:50})]}),s.jsx(svt,{children:s.jsx(Pe,{height:"20px",width:"36px"})})]}),nvt=()=>s.jsxs("div",{children:[s.jsx(hv,{}),s.jsx(hv,{}),s.jsx(hv,{})]}),ovt=({usesOverridePaymentMethodGroups:e,overridePaymentMethodGroups:t,isFinancingProviderNotSelectedError:n})=>{const{formatMessage:o}=M(),r=F(),a=E(sx)?.amount,i=E(D("pbpm")),l=E(cx),c=E(t9e),d=E(vO),u=E(QQe)||[],m=E(jg);h.useEffect(()=>{r(cy.fetchActivePaymentMethodGroups())},[]),h.useEffect(()=>{i&&m?.length&&m.length>0&&r(cy.fetchPaymentMethodGroupPromotions())},[m?.length,i,r]),h.useEffect(()=>{a&&!c&&(!e||t)&&r(cy.fetchPaymentMethodGroupsMetadata())},[t,a,e,r]);const g=x=>!!x&&"displayable"in x,f=h.useMemo(()=>{if(i&&l)return t?.find(x=>x?.paymentMethodGroupId===l)},[i,l,t]),y=()=>{const x=t?.find(R=>R.available&&R.name!==ct.LOYALTY);return i&&l&&t&&g(x)?f?.name===ct.LOYALTY?(x.paymentMethodGroupId&&r(Ht.updateCheckoutCart({paymentMethodGroup:{paymentMethodGroupId:x.paymentMethodGroupId,financingProviderId:x.name===ct.INSTALMENTS?d:void 0}})),Me.api.pushLog([`PBPM basketPaymentMethodGroupId: ${l}, preselectedPaymentMethod: ${x.name}`],{level:Za.DEBUG}),x.name||m?.[0]?.name||ct.PAY_NOW):(f||(z.error("toast.notification.generic.error"),Me.api.pushLog(["PBPM no memoizedPaymentMethodGroupFromBasket"],{level:Za.DEBUG})),f?.name||x?.name||m?.[0]?.name||ct.PAY_NOW):x?x.name:m?.[0]?.name||ct.PAY_NOW},I=()=>{const x=y();return m?.find(R=>R.name===x)?.type};evt({option:y(),type:I()});const S=KZ(),C="payment-selector",_=o("checkout.summary.payment.options.payAtDelivery.limitation.warning"),A=u.includes(ct.CASH_ON_DELIVERY);return s.jsxs(h.Fragment,{children:[A&&_.trim()&&s.jsx(Ce,{intent:"info",className:"salt-m-t--2 salt-m-b--2",size:"s",text:_}),m?s.jsx(J_t,{options:S,testId:C,isFinancingProviderNotSelectedError:n,overridePaymentMethodGroups:t}):s.jsx(nvt,{})]})},rvt=()=>{const e=F(),t=fL(),n=E(D(yz)),o=E(D(Iz)),r=E(D(CVe)),a=E(D("pcs.v2")),i=E(D("oed")),l=E(D("loy.waon")),c=E(zyt),d=E(WX);h.useEffect(()=>{!n&&!r&&(t?c?e(kt.setPaymentOptionAndType({paymentOption:c.name,paymentType:c.applicableType})):!a&&i&&l&&Number(d?.checkoutPayment.amountPaidByCustomer)===0&&Number(d?.checkoutPayment.amountToBeCharged)===0&&d?.loyaltyPaymentMethod?e(kt.setPaymentOptionAndType({paymentOption:d.loyaltyPaymentMethod.group,paymentType:d.loyaltyPaymentMethod.type})):e(kt.setPaymentOptionAndType({paymentOption:ct.PAY_NOW,paymentType:at.UNKNOWN})):o||e(kt.setPaymentOptionAndType({paymentOption:ct.PAY_NOW,paymentType:at.UNKNOWN})))},[e,n,o,t,r,c])},avt=D("pay.nsc"),ivt=D("pay.ew"),lvt=D("rec.o"),cvt=D("pb.pc"),dvt=D("pay.nsd"),uvt=D("pay.ywlt"),pvt=D("loy.waon"),mvt=D("pcs.v2"),hvt=({intl:e,actions:t,isNonSavedCardPaymentEnabled:n,isPaymentBufferNoticeInPaymentSectionEnabled:o,isCheckoutSummaryInvoiceModalOpen:r,isRecurringOrdersEnabled:a,paymentSectionRef:i,shouldShowExternalWalletPaymentSelector:l,isSelectedRecurringShoppingDefinitionFrequencyDefined:c,setSelectedPaymentMethodExternalWallet:d,setSelectedWalletItem:u,isNonSavedDialogEnabled:m,isYourWalletEnabled:g,isLoyaltyPaymentEnabled:f,totalBufferRate:y,isFinancingProviderNotSelectedError:I,isPaymentCheckoutSummaryV2Enabled:S})=>{const C=F(),_=OL(),A=E(D(Iz)),x=E(PC),R=zd(),O=cZ(),N=E(xg),k=E(Cn),j=JSON.stringify(E(Sie)||[]),w=E(sx),L=JSON.stringify(E(O0)||[]),B=E(D("pbpm")),W=E(cx),$=E(yie),K=E(qX),Q=E(At),X=_&&!A,re=l&&!A,ue={paymentTitle:e.formatMessage("checkout.summary.payment.method.title"),loyaltyPaymentInfo:e.formatMessage("checkout.summary.payment.loyalty.additional.payment.required")},te=()=>{t.analyticsEvent({type:_e.RECURRING_SHOPPING_DEFINITION_FREQUENCY_SELECTED,data:{recurringFrequency:Lo}}),t.analyticsEvent({type:_e.RECURRING_SHOPPING_DEFINITION_LABEL_WRITTEN,data:{recurringFrequencyName:""}})},ce=Yp({getQuantity:Xi});h.useEffect(()=>{S&&!K?C(Mo.withOverridePaymentMethodGroups(Mo.getOrderPaymentCheckoutSummaryWithPaymentMethodGroups)):R&&C(Mo.getOverridePaymentMethodGroups(k))},[R,C,N,k,j,w,L]),bIt();const de=fL(),{hideLoyaltyPaymentButton:ye,disableLoyaltyPaymentButton:Ae}=dZ();h.useEffect(()=>{if(de&&B&&f&&!K&&!$){const Ie=O?.find(je=>je.name===ct.LOYALTY);Ie?.paymentMethodGroupId&&Ie?.paymentMethodGroupId!==W&&C(Ht.updateCheckoutCart({paymentMethodGroup:{paymentMethodGroupId:Ie.paymentMethodGroupId}})),C(kt.setPaymentOptionAndType({paymentOption:Ie?.name,paymentType:Ie?.applicableType}))}},[de,B,C,O,W,f]);const Je=()=>{t.analyticsEvent({type:_e.LOYALTY_POINTS_BUTTON_CLICKED,payload:{pageEventAttributes:{type:"loyaltyPayment",action:Number(ce)?"edit":"apply"}}}),Ae?(t.analyticsEvent({type:_e.PAYMENT_PROMOTION_APPLIED_TOAST_DISPLAYED,description:"User sees the toast notification",pageEventAttributes:{orderId:Q}}),z.warning("payment.promotion.loyalty.add.restriction.notification")):t.openLoyaltyRedeemModal()};return rvt(),s.jsxs(ve,{tabIndex:0,"aria-describedby":"payment-notification-a11y",ref:i,children:[s.jsx("div",{className:"salt-m-b--2",children:s.jsx(ne,{as:"h2",children:ue.paymentTitle})}),A&&!g&&!de&&s.jsx(ovt,{usesOverridePaymentMethodGroups:R,overridePaymentMethodGroups:O,isFinancingProviderNotSelectedError:I}),s.jsx("div",{className:"salt-m-b--4",children:y&&o?s.jsx(h.Fragment,{children:s.jsx("div",{className:"salt-m-b--4",children:s.jsx(UTt,{analyticsEvent:t.analyticsEvent,bufferRate:y,action:t.openPaymentBufferModal})})}):s.jsx(v,{id:"checkout.summary.payment.method.message"})}),re&&s.jsxs(h.Fragment,{children:[s.jsx(GTt,{onSelectPaymentMethod:d,isSelectedRecurringShoppingDefinitionFrequencyDefined:c,isCheckoutSummaryInvoiceModalOpen:r}),a&&s.jsx(YTt,{resetRecurringShoppingForm:te})]}),g&&s.jsx(uE,{isSelectedRecurringShoppingDefinitionFrequencyDefined:c,isOverridePaymentMethodGroupsEnabled:R,supportNonSavedPayment:n,onSelectPaymentMethod:u,overridePaymentMethodGroups:O}),X&&s.jsx(ML,{}),m&&s.jsx(t_t,{}),f&&x&&!ye&&s.jsxs("div",{children:[s.jsx(Zn,{}),ue.loyaltyPaymentInfo&&s.jsx("div",{className:"salt-m-t--4",children:s.jsx(Ce,{intent:"info","data-test":"loyalty-payment-info",text:ue.loyaltyPaymentInfo,showIcon:!1})}),s.jsx("div",{className:"salt-m-t--4",children:!!ce&&s.jsx(Ve,{inline:!1,children:s.jsx(qZ,{loyaltyInBasket:ce,removeLoyaltyUnitsFromBasket:t.removeLoyaltyUnitsFromBasket})})}),s.jsx("div",{className:"salt-m-t--4",children:s.jsxs(b,{intent:"secondary",fill:!0,"data-test":"loyalty-payment-add",onClick:Je,loading:$,children:[s.jsx(b.Icon,{name:"loyalty"}),s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.discounts.loyalty"})})]})}),s.jsx(WZ,{})]})]})},gvt=e=>({isNonSavedCardPaymentEnabled:avt(e),externalWalletManagement:ivt(e),isPaymentBufferNoticeInPaymentSectionEnabled:cvt(e),isCheckoutSummaryInvoiceModalOpen:Ue("checkoutSummaryInvoice")(e),isRecurringOrdersEnabled:lvt(e),isNonSavedDialogEnabled:dvt(e),isYourWalletEnabled:uvt(e),isLoyaltyPaymentEnabled:pvt(e),totalBufferRate:pL(e),isPaymentCheckoutSummaryV2Enabled:mvt(e)}),Evt=e=>({actions:Ki({analyticsEvent:U.analyticsEvent,getWalletItems:sm.getWalletItems,openCheckoutSummaryInvoiceModal:()=>Z.openModal("checkoutSummaryInvoice"),openPaymentBufferModal:()=>Z.openModal("paymentBuffer",!1),openLoyaltyRedeemModal:()=>Z.openModal("redeemLoyalty"),removeLoyaltyUnitsFromBasket:kh.removeLoyaltyUnitsFromBasket,performanceMark:ks},e)}),fvt=Ct(Bt,ke(gvt,Evt))(hvt),FL=({getQuantity:e})=>s.jsxs(ve,{"data-test":"loyalty-earnings",children:[s.jsx(ne,{className:"salt-m-b--4",as:"h2",children:s.jsx(v,{id:"checkout.complete.loyalty.title"})}),s.jsx(Hd,{getQuantity:e})]}),yvt=ee("GET_VOUCHERS_MARKETING_PREFERENCES"),Ivt=()=>({type:"API",payload:{service:"marketingpreferences",pathPrefix:{client:"/api/marketing-preferences",server:"/core-api"},options:{method:"GET"},url:"/v1/preferences/groups/voucher/customers/current",...yvt}}),Svt={getMarketingPreferences:Ivt},Cvt=({isConsentChecked:e,setConsentCheckbox:t,name:n})=>{const o=M(),[r]=fe(["nfchk"]),a={title:o.formatMessage("marketing.optin.vouchers.title"),description:o.formatMessage("marketing.optin.vouchers.description")},i=()=>{t(l=>!l)};return e==null?null:s.jsx(ie.Fragment,{children:r?s.jsx(mt.Checkbox,{label:a.title,additionalText:a.description,name:n,value:a.title,className:"salt-m-b--4"}):s.jsx(mo,{bold:!0,input:{checked:e,onChange:i},label:s.jsx(P,{bold:!0,size:"l",children:a.title}),children:s.jsx(P,{size:"l",children:a.description})})})},Tvt=()=>{const e=M(),t=F(),n=h.useRef(null),[o,r]=h.useState(null),[a,i]=h.useState(void 0),[l,c]=h.useState(""),[d,u,m]=fe(["m.la.h","mktg.vou","nfchk"]),[g,f]=h.useState(!1),y=E(u9e),I=E(p9e),S=E(Kie),C=E(Ue("addVoucher")),_={addVoucherModalTitle:e.formatMessage("voucher.modal.title"),voucherPlaceholder:e.formatMessage("voucher.modal.voucher.placeholder"),voucherInputLabel:e.formatMessage("voucher.modal.voucher.input.label"),clearButtonLabel:e.formatMessage("salt.form.text-field.clear-button.a11y.label"),addVoucherModalSubmitButton:e.formatMessage("voucher.modal.submit.button.text"),addVoucherModalSubmitButtonAriaLabel:e.formatMessage("voucher.modal.submit.button.text.description"),saveMarketingPreferences:e.formatMessage("marketing.optin.vouchers.button.title")},A=j=>{r(j.target.value),i(void 0)},x=h.useCallback(()=>{if(o)t(EI.addVoucherToBasket(o.trim(),e,y?void 0:g)).then(j=>{i(j)});else{const j=e.formatMessage("vouchers.validation.failure.no.code.entered");i(j)}},[o,t,e,g,y]),R=j=>{j.key==="Enter"&&o&&x()},O=()=>{m&&(n.current?.reset(),c("")),m||(r(null),i(void 0)),t(Z.closeModal())},N="add-voucher-modal-header",k=j=>{if(!m)return;j.preventDefault();const w=j.currentTarget,L=new FormData(w),B=L.get("voucherId")?.toString(),W=L.get("marketingPreferencesCheckbox");if(B)t(EI.addVoucherToBasket(B.trim(),e,y?void 0:!!W)).then($=>{c($)});else{const $=e.formatMessage("vouchers.validation.failure.no.code.entered");c($)}};return s.jsx(G,{isOpen:C,onRequestClose:O,aria:{labelledby:N},isLoading:I||S,children:s.jsxs(mt,{ref:n,onSubmit:k,children:[s.jsx(G.Header,{align:d?"left":"center",children:s.jsx(ne,{as:"h2",id:N,"data-test":N,children:_.addVoucherModalTitle})}),s.jsx(G.Body,{className:"salt-p-b--2",children:m?s.jsx(mt.TextField,{name:"voucherId",errorMessage:l,"data-test":"voucher-input-field",placeholder:_.voucherPlaceholder,label:{text:_.voucherInputLabel},clearButton:{ariaLabel:_.clearButtonLabel}}):s.jsx(ii,{type:"text","data-test":"voucher-input-field",label:_.voucherInputLabel,placeholder:_.voucherPlaceholder,meta:{invalid:!!a,touched:!0,error:a},input:{onChange:A,onKeyDown:R}})}),s.jsx(G.Footer,{align:"left",className:"salt-p-t--4",children:s.jsxs(se,{direction:"column",basis:"100%",children:[!y&&u&&s.jsx(Cvt,{isConsentChecked:g,setConsentCheckbox:f,name:"marketingPreferencesCheckbox"}),s.jsx(b,{fill:!0,type:m?"submit":"button",onClick:m?void 0:x,intent:"primary",className:"salt-m-t--4","data-test":"voucher-submit-button","aria-label":_.addVoucherModalSubmitButtonAriaLabel,children:s.jsx(b.Text,{children:u?_.saveMarketingPreferences:_.addVoucherModalSubmitButton})})]})})]})})},zZ=p.shape({paymentCheckAmount:Ye.isRequired,expiryDate:p.string.isRequired,paymentCheckId:p.string.isRequired,increaseInTotalRequiredBeforeCheckIsAvailable:Ye}),QZ=p.shape({paymentCheckAmount:Ye.isRequired,expiryDate:p.string.isRequired,paymentCheckId:p.string.isRequired,increaseInTotalRequiredBeforeCheckIsAvailable:Ye.isRequired}),_vt=(e={})=>(t,n)=>{const o="FAILURE",r="SUCCESS",a=d=>t(U.analyticsEvent({type:Te.REDEEM_PAYMENT_CHECK_BUTTON_CLICKED,pageEventAttributes:{status:d,...e.maxRedeemAmount&&{maxRedeemAmount:e.maxRedeemAmount},...e.minRedeemAmount&&{minRedeemAmount:e.minRedeemAmount},paymentCheckId:e.paymentCheckId,paymentCheckAmount:e.paymentCheckAmount&&e.paymentCheckAmount.amount,paymentCheckCurrency:e.paymentCheckAmount&&e.paymentCheckAmount.currency},description:"User clicked on the redeem payment check button"})),i=d=>t(U.analyticsEvent({type:_e.TOAST_NOTIFICATION_DISPLAYED,description:"A toast notification was displayed",pageEventAttributes:{status:d}})),l=()=>Promise.all([Promise.resolve(z.warning("checkout.summary.bonus.check.redeem.error.toast")),i("PAYMENT_CHECK_BELOW_THE_THRESHOLD"),a(o)]),c=()=>Promise.all([a(r),Promise.resolve(z.success("checkout.summary.bonus.check.redeem.success.toast")),i("PAYMENT_CHECK_APPLIED")]);return t(Ht.getCheckoutBasket({appliedPaymentCheckId:e.paymentCheckId})).then(()=>{const d=$0(n());return d&&d.length>=1?l():ax(n())?c():(Me.api.pushError(new Error(`Expected payment check with id: ${e.paymentCheckId} to be applied or removed, but didn't appear in either list`)),a(o))}).catch(d=>(a(o),i("PAYMENT_CHECK_NETWORK_ERROR"),Promise.resolve(new Error(d))))},vvt={addPaymentCheckToBasket:_vt},Avt=D("m.la.h"),bvt={basketTotalValue:Ye.isRequired,paymentChecks:p.shape({checksMissingRequiredTotal:p.arrayOf(QZ)}),formattedMessages:p.shape({paymentCheckDescription:p.func.isRequired,costRequirementToUsePaymentCheck:p.func.isRequired,requirementsNotMetBody:p.func.isRequired,backToCheckoutButton:p.string.isRequired,requirementsNotMetBodyDescription:p.string.isRequired}).isRequired,formatPrice:p.func.isRequired,closeModal:p.func.isRequired,modalLeftAlignEnabled:p.bool},xvt={paymentChecks:[],modalLeftAlignEnabled:!1},BL=({basketTotalValue:e,paymentChecks:t,formatPrice:n,closeModal:o,formattedMessages:r,modalLeftAlignEnabled:a})=>{const i=l=>{const{paymentCheckId:c,paymentCheckAmount:d,expiryDate:u,increaseInTotalRequiredBeforeCheckIsAvailable:m}=l,g=`missing-requirement-payment-check-${c}`;return s.jsxs(pe.Group,{"data-test":g,children:[s.jsx(pe.Title,{children:r.paymentCheckDescription(n(d),yt(u,gy))}),s.jsx(pe.Description,{children:r.costRequirementToUsePaymentCheck(n(m))})]},c)};return s.jsxs(h.Fragment,{children:[s.jsxs(G.Body,{children:[s.jsx(P,{asChild:!0,size:"l",bold:!0,children:s.jsx("h2",{children:r.requirementsNotMetBody(n(e))})}),s.jsx(P,{children:r.requirementsNotMetBodyDescription}),s.jsx("div",{className:"salt-m-t--4",children:s.jsx(pe,{children:t.checksMissingRequiredTotal.map(l=>i(l))},"payment-checks-requirements-not-met-list")})]}),s.jsx(G.Footer,{align:a?"left":"center",children:s.jsx(b,{intent:"primary",onClick:()=>o(),"data-test":"add-payment-check-modal-back-to-checkout-button",children:s.jsx(b.Text,{children:r.backToCheckoutButton})})})]})};BL.propTypes=bvt;BL.defaultProps=xvt;const Rvt=e=>({modalLeftAlignEnabled:Avt(e)}),Dvt=ke(Rvt)(BL),Ovt=D("m.la.h"),Pvt={formattedMessages:p.shape({backToCheckoutButton:p.string.isRequired,noChecksAvailableBody:p.string.isRequired}).isRequired,closeModal:p.func.isRequired,modalLeftAlignEnabled:p.bool},Nvt={modalLeftAlignEnabled:!1},UL=({modalLeftAlignEnabled:e,closeModal:t,formattedMessages:n})=>s.jsxs(h.Fragment,{children:[s.jsx(G.Body,{children:s.jsx(P,{asChild:!0,bold:!0,size:"l",children:s.jsx("h2",{children:n.noChecksAvailableBody})})}),s.jsx(G.Footer,{align:e?"left":"center",children:s.jsx(b,{intent:"primary",onClick:()=>t(),"data-test":"add-payment-check-modal-back-to-checkout-button",children:s.jsx(b.Text,{children:n.backToCheckoutButton})})})]});UL.propTypes=Pvt;UL.defaultProps=Nvt;const Lvt=e=>({modalLeftAlignEnabled:Ovt(e)}),kvt=ke(Lvt)(UL),Mvt=D("m.la.h"),jvt=D("nfpay"),wvt={paymentChecks:p.shape({isFetching:p.bool.isRequired,fetchError:p.bool.isRequired,lastUpdated:p.number,availablePaymentChecks:p.arrayOf(zZ).isRequired,maxAmountPayableByPaymentCheck:Ye}).isRequired,formattedMessages:p.shape({paymentCheckDescription:p.func.isRequired,paymentCheckExpiresOn:p.func.isRequired,selectableChecksMaxRedeemable:p.func.isRequired,selectableCheckRadioButtonSelectNone:p.string.isRequired,selectableChecksMaxRedeemableDescription:p.string.isRequired,selectPaymentChecksRedeemButton:p.string.isRequired}).isRequired,formatPrice:p.func.isRequired,closeModal:p.func.isRequired,redeemSelectedPaymentCheck:p.func.isRequired,modalLeftAlignEnabled:p.bool,isSaltFormEnabledForPayments:p.bool},Fvt={modalLeftAlignEnabled:!1,isSaltFormEnabledForPayments:!1};class GL extends h.Component{constructor(t){super(t),this.handlePaymentCheckSelectedForLegacyForm=this.handlePaymentCheckSelectedForLegacyForm.bind(this),this.redeemCheck=this.redeemCheck.bind(this),this.renderSelectableCheck=this.renderSelectableCheck.bind(this),this.renderSelectNonePaymentCheck=this.renderSelectNonePaymentCheck.bind(this);const n={isNoChecksSelectedOption:!0},o="none";this.state={noPaymentChecksSelectedCheck:n,selectedPaymentCheck:n,selectedValue:o,NONE:o}}handlePaymentCheckSelectedForLegacyForm(t,n){t.preventDefault(),t.stopPropagation(),this.setState({selectedPaymentCheck:n})}handlePaymentCheckSelectedForSaltForm=t=>{const{paymentChecks:n}=this.props,{NONE:o,noPaymentChecksSelectedCheck:r}=this.state;if(t===o){this.setState({selectedValue:o,selectedPaymentCheck:r});return}const a=(n.availablePaymentChecks||[]).find(i=>String(i.paymentCheckId)===String(t))||r;this.setState({selectedValue:String(t),selectedPaymentCheck:a})};redeemCheck(){const{closeModal:t,redeemSelectedPaymentCheck:n,paymentChecks:o}=this.props,{selectedPaymentCheck:r,noPaymentChecksSelectedCheck:a}=this.state,i=d=>d&&d.paymentCheckAmount&&d.paymentCheckAmount.amount||0,l=(d,u)=>i(d)-i(u),c=(d,u)=>i(u)-i(d);if(r!==a){const d=i(o.availablePaymentChecks.slice().sort(c)[0]),u=i(o.availablePaymentChecks.slice().sort(l)[0]);n({...r,minRedeemAmount:u,maxRedeemAmount:d}).then(t)}else t()}renderSelectableCheck(t){const{formattedMessages:n,formatPrice:o}=this.props,{paymentCheckId:r,paymentCheckAmount:a,expiryDate:i}=t,{selectedPaymentCheck:l}=this.state,c=`payment-check-radio-${r}`;return s.jsx(ve,{className:"salt-m-b--2",onClick:d=>this.handlePaymentCheckSelectedForLegacyForm(d,t),children:s.jsx(ia,{checked:t===l,label:n.paymentCheckDescription(o(a),yt(i,gy)),value:r,"data-test":c,last:!0})},r)}renderSelectNonePaymentCheck(){const{formattedMessages:t}=this.props,{noPaymentChecksSelectedCheck:n,selectedPaymentCheck:o}=this.state,r="payment-check-radio-none-selected";return s.jsx(ve,{children:s.jsx(ia,{checked:o===n,onClick:a=>this.handlePaymentCheckSelectedForLegacyForm(a,n),label:t.selectableCheckRadioButtonSelectNone,value:r,"data-test":r,last:!0})},r)}render(){const{modalLeftAlignEnabled:t,formattedMessages:n,formatPrice:o,isSaltFormEnabledForPayments:r,paymentChecks:a}=this.props,{selectedValue:i,NONE:l}=this.state,c=(a.availablePaymentChecks||[]).map(d=>({value:String(d.paymentCheckId),label:o(d.paymentCheckAmount),additionalText:n.paymentCheckExpiresOn(yt(d.expiryDate,gy))}));return c.push({value:l,label:n.selectableCheckRadioButtonSelectNone}),s.jsxs(h.Fragment,{children:[s.jsxs(G.Body,{children:[s.jsx(P,{bold:!0,asChild:!0,size:"l",children:s.jsx("h2",{children:n.selectableChecksMaxRedeemable(o(a.maxAmountPayableByPaymentCheck))})}),s.jsx(P,{children:n.selectableChecksMaxRedeemableDescription}),s.jsx("div",{className:"salt-m-t--4",children:r?s.jsx(ve,{children:s.jsx(mt.RadioGroup,{name:"payment-checks",groupLabel:{text:n.addPaymentCheckModalTitle,isVisuallyConcealed:!0},value:i,onChange:this.handlePaymentCheckSelectedForSaltForm,radios:c})}):s.jsxs(s.Fragment,{children:[a.availablePaymentChecks.map(d=>this.renderSelectableCheck(d)),this.renderSelectNonePaymentCheck()]})})]}),s.jsx(G.Footer,{align:t?"left":"center",children:s.jsx(b,{intent:"primary",onClick:()=>this.redeemCheck(),"data-test":"add-payment-check-modal-redeem-button",children:s.jsx(b.Text,{children:n.selectPaymentChecksRedeemButton})})})]})}}GL.propTypes=wvt;GL.defaultProps=Fvt;const Bvt=e=>({modalLeftAlignEnabled:Mvt(e),isSaltFormEnabledForPayments:jvt(e)}),Uvt=ke(Bvt)(GL),Gvt=D("m.la.h"),$vt={isOpen:p.bool,actions:p.shape({closeModal:p.func.isRequired,fetchAvailablePaymentChecks:p.func.isRequired,fetchBasketWithPaymentCheckSplit:p.func.isRequired,analyticsEvent:p.func.isRequired}).isRequired,modalOptions:p.shape({source:p.string,sourceEventId:p.string}),paymentChecks:p.shape({isFetching:p.bool.isRequired,fetchError:p.bool.isRequired,lastUpdated:p.number,availablePaymentChecks:p.arrayOf(zZ).isRequired,checksMissingRequiredTotal:p.arrayOf(QZ).isRequired,maxAmountPayableByPaymentCheck:Ye}).isRequired,intl:p.objectOf(p.object).isRequired,basketTotalValue:Ye,orderId:p.string.isRequired,modalLeftAlignEnabled:p.bool,currencyFormat:p.string},Hvt={isOpen:!1,basketTotalValue:null,modalOptions:{},modalLeftAlignEnabled:!1};class $L extends h.Component{constructor(t){super(t),this.formatPrice=this.formatPrice.bind(this),this.areChecksAvailable=this.areChecksAvailable.bind(this),this.areChecksAvailableButMissingRequiredTotal=this.areChecksAvailableButMissingRequiredTotal.bind(this),this.areNoPaymentChecksAvailable=this.areNoPaymentChecksAvailable.bind(this),this.isAvailabilityLoaded=this.isAvailabilityLoaded.bind(this);const{intl:n}=this.props;this.formattedMessages={addPaymentCheckModalTitle:n.formatMessage("checkout.summary.bonus.check.redeem.modal.title"),backToCheckoutButton:n.formatMessage("checkout.summary.bonus.check.requirement.not.met.modal.close.button.description"),noChecksAvailableBody:n.formatMessage("checkout.summary.bonus.check.no.checks.modal.body"),requirementsNotMetBody:o=>n.formatMessage("checkout.summary.bonus.check.requirement.not.met.modal.body",{basketValue:o}),requirementsNotMetBodyDescription:n.formatMessage("checkout.summary.bonus.check.requirement.not.met.modal.body.description"),costRequirementToUsePaymentCheck:o=>n.formatMessage("checkout.summary.bonus.check.requirement.not.met.modal.check.requirement.description",{cost:o}),selectableChecksMaxRedeemable:o=>n.formatMessage("checkout.summary.bonus.check.redeem.modal.body",{maxPayableByBonusCheck:o}),selectableChecksMaxRedeemableDescription:n.formatMessage("checkout.summary.bonus.check.redeem.modal.body.description"),paymentCheckDescription:(o,r)=>n.formatMessage("checkout.summary.bonus.check.redeem.modal.check.description",{cost:o,date:r}),paymentCheckExpiresOn:o=>n.formatMessage("checkout.summary.bonus.check.redeem.modal.check.expires.on",{date:o}),selectableCheckRadioButtonSelectNone:n.formatMessage("checkout.summary.bonus.check.redeem.modal.check.no.redeem.option"),selectPaymentChecksRedeemButton:n.formatMessage("checkout.summary.bonus.check.redeem.modal.button.text")}}areChecksAvailable(){const{paymentChecks:t}=this.props,{availablePaymentChecks:n}=t;return t&&n&&n.length>=1}areChecksAvailableButMissingRequiredTotal(){const{paymentChecks:t}=this.props,{checksMissingRequiredTotal:n}=t;return t&&!this.areChecksAvailable()&&n&&n.length>=1}areNoPaymentChecksAvailable(){return!this.areChecksAvailable()&&!this.areChecksAvailableButMissingRequiredTotal()}formatPrice(t){return t&&t.amount&&t.currency?$a(this.props.intl.formatNumber,t,this.props.currencyFormat):""}isAvailabilityLoaded(){const{paymentChecks:t}=this.props,{isFetching:n,lastUpdated:o,fetchError:r}=t;return o&&!r&&!n}componentDidUpdate(t){const{actions:n,basketTotalValue:o,isOpen:r,modalOptions:a,orderId:i}=this.props,{source:l,sourceEventId:c}=a;r===!0&&t.isOpen===!1&&(n.analyticsEvent({type:xt.PAYMENT_CHECK_ADD_MODAL_DISPLAYED,source:l,sourceEventId:c}),i&&o&&n.fetchAvailablePaymentChecks({basketTotal:o,orderId:i}).catch(()=>{z.error("toast.notification.generic.error"),n.closeModal()}))}render(){const{isOpen:t,paymentChecks:n,basketTotalValue:o,actions:r,modalLeftAlignEnabled:a}=this.props;return s.jsxs(G,{isOpen:t,onRequestClose:r.closeModal,isLoading:!this.isAvailabilityLoaded(),loadingPlaceholder:"spinner",children:[s.jsx(G.Header,{align:a?"left":"center","data-test":"add-payment-check-modal-title",children:s.jsx(ne,{as:"h1",children:this.formattedMessages.addPaymentCheckModalTitle})}),t&&this.isAvailabilityLoaded()&&s.jsxs(h.Fragment,{children:[this.areChecksAvailable()&&s.jsx(Uvt,{basketTotalValue:o,formattedMessages:this.formattedMessages,formatPrice:this.formatPrice,closeModal:r.closeModal,paymentChecks:n,redeemSelectedPaymentCheck:r.fetchBasketWithPaymentCheckSplit}),this.areChecksAvailableButMissingRequiredTotal()&&s.jsx(Dvt,{paymentChecks:n,basketTotalValue:o,formatPrice:this.formatPrice,formattedMessages:this.formattedMessages,closeModal:r.closeModal}),this.areNoPaymentChecksAvailable()&&s.jsx(kvt,{closeModal:r.closeModal,formattedMessages:this.formattedMessages})]})]})}}$L.propTypes=$vt;$L.defaultProps=Hvt;const uU="addBonusCheck",Vvt=e=>({isOpen:Ue(uU)(e),paymentChecks:kQe(e),modalOptions:Vo(uU)(e),customerId:rr(e),modalLeftAlignEnabled:Gvt(e),currencyFormat:pi(e)}),Yvt=ot({closeModal:Z.closeModal,fetchAvailablePaymentChecks:gL.fetchAvailablePaymentChecks,fetchBasketWithPaymentCheckSplit:e=>vvt.addPaymentCheckToBasket(e),analyticsEvent:U.analyticsEvent}),Wvt=Ct(Bt,ke(Vvt,Yvt))($L),qvt=({openAddVoucherModal:e,openLoyaltyRedeemModal:t,basketTotalValue:n,orderId:o,openAddPaymentCheckModal:r,shouldShowAddVoucherButton:a,shouldShowAddLoyaltyButton:i,shouldShowAddPaymentChecksButton:l,isRecurringOrder:c})=>{const[d,u]=fe(["tp","tp.new"]),m=M(),g=u&&!d,f=m.formatMessage("checkout.summary.discounts.discount.button")||"Discount code",y=m.formatMessage("checkout.summary.discounts.voucher");return s.jsxs(se,{justify:"space-between",align:"center",gap:["xs"],wrap:"nowrap",children:[a&&s.jsxs(h.Fragment,{children:[s.jsxs(b,{intent:"secondary",fill:!0,"data-test":"voucher-add",onClick:e,children:[s.jsx(b.Icon,{name:"promotion"}),s.jsx(b.Text,{children:g?f:y})]}),s.jsx(Tvt,{})]}),i&&s.jsxs(h.Fragment,{children:[s.jsxs(b,{intent:"secondary",fill:!0,"data-test":"loyalty-add",onClick:t,children:[s.jsx(b.Icon,{name:"loyalty"}),s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.discounts.loyalty"})})]}),s.jsx(WZ,{})]}),l&&s.jsxs(h.Fragment,{children:[s.jsxs(b,{intent:"secondary",fill:!0,"data-test":"payment-check-add-button",disabled:!n||!o,onClick:I=>{c?z.warning("checkout.summary.bonus.check.recurringOrder.warning.toast"):r(I)},children:[s.jsx(b.Icon,{name:"loyalty"}),s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.discounts.bonus.check"})})]}),s.jsx(Wvt,{basketTotalValue:n,orderId:o})]})]})},Kvt=()=>(e,t)=>e(J0()).then(n=>n&&e(t1(n.payload.responseData.entities))).then(n=>{VN.getDeliveryStatuses(n,e,t())}),di={getPendingOrders:Kvt},zvt=()=>{const e=F(),t=M(),[n,o]=fe(["tp","tp.new"]);h.useEffect(()=>{e(cd())},[e]);const r=E(A7),a=E($N),i=E(N7),l=o&&!n,c=t.formatMessage("toggleablepromotions.list.title"),d=t.formatMessage("toggleablepromotions.list.discounts.added")||"Discounts added",u=t.formatMessage("toggleablepromotions.list.add.cart")||"Add to cart discount",m=!i&&!a,f=l?m?u:d:c;return r?s.jsxs(zs,{direction:"column",className:"salt-m-t--4",children:[s.jsx(P,{size:"l",asChild:!0,className:`${m?"salt-m-t--0 salt-m-b--2":"salt-m-t--0 salt-m-b--4"}`,children:s.jsx("h3",{children:f})}),s.jsx(k7,{})]}):null},Qvt=({removeVoucherFromBasket:e,vouchers:t=[],loyaltyInBasket:n=null,removeLoyaltyUnitsFromBasket:o,isPaymentCheckApplied:r,isVoucherApplied:a,isLoyaltyApplied:i,isLoyaltyPaymentEnabled:l,appliedPaymentChecksInBasket:c=[],removePaymentChecksFromBasket:d})=>{const u=ze(),m=f=>f&&f.amount&&f.currency?u(f):"",g=i&&!l;return s.jsxs(Ve,{inline:!1,children:[a&&t.map(f=>f&&s.jsx(Ve.Item,{children:s.jsx(yI,{type:"voucher",action:ed(e.bind(null,{voucherId:f.voucherId,savings:m(f.savings)}),500,{trailing:!1}),children:s.jsx(v,{id:"checkout.summary.discounts.voucher.redeemed.with.savings",values:{voucherName:f.voucherId,savings:m(f.savings)}})})},f.voucherId)),g&&s.jsx(qZ,{loyaltyInBasket:n,removeLoyaltyUnitsFromBasket:o}),r&&c.map(f=>f&&s.jsx(Ve.Item,{children:s.jsx(yI,{type:"payment-check",action:ed(d.bind(null,{paymentCheckId:f.paymentCheckId}),500,{trailing:!1}),children:s.jsx(v,{id:"checkout.summary.discounts.bonus.check.redeemed",values:{value:m(f.paymentCheckAmount)}})})},"payment-check"))]})},Xvt=e=>{const{vouchers:t,loyaltyInBasket:n,isLoyaltyRegistered:o,isLoyaltyRedeemEnabled:r,isUsePaymentChecksEnabled:a,appliedPaymentChecksInBasket:i,isBasketLoading:l,isLoyaltyLoading:c,removePaymentChecksFromBasket:d,isMultiVoucherEnabled:u,isLoyaltyPaymentEnabled:m,orderId:g}=e,f=M(),y=Vp(Ze),I=E(CO),[S,C]=fe(["tp","tp.new"]),_=E(Xl),[A,x]=ie.useState(!1),R=F(),O=l||c,N=!!t?.length,k=!N||u,j=r&&!!n,w=r&&o&&!j,L=j||w,B=a&&i&&i.length>=1&&!L,W=a&&!B&&!L,$=k||w||W,K=N||j||B;ie.useEffect(()=>{W&&!l&&R(di.getPendingOrders())},[R,W,l]),ie.useEffect(()=>{!!_?.orders?.find(de=>de.orderId===g)?.recurringShoppingDefinition?.definitionId&&x(!0)},[_,g]),i&&i.length>=1&&(!a||L)&&d();const Q=C&&!S,X=f.formatMessage("checkout.summary.discounts.new.title")||"Discount Information",re=f.formatMessage("checkout.summary.discounts.title");return s.jsxs(ve,{"data-test":"discount-box",children:[s.jsx("div",{className:"salt-m-b--4",children:s.jsx(ne,{as:"h2",children:Q?X:re})}),O&&s.jsx("div",{className:"salt-m-t--8 salt-m-b--4",children:s.jsx(Rs,{"data-test":"discount-spinner"})}),!O&&$&&s.jsx(qvt,{...e,shouldShowAddVoucherButton:k,shouldShowAddLoyaltyButton:w,shouldShowAddPaymentChecksButton:W&&!A,isRecurringOrder:I}),!O&&K&&s.jsx("div",{className:$?"salt-m-t--4":"",children:s.jsx(Qvt,{...e,isLoyaltyApplied:j,isVoucherApplied:N,isPaymentCheckApplied:B,isLoyaltyPaymentEnabled:m})}),y&&(S||C)&&s.jsx(zvt,{})]})},Zvt=vo(["loyalty","loyred"]),Jvt=D("pay.check.use"),eAt=e=>D("mvpca")(e)&&qe(e,"multiple-vouchers-enabled")==="true",tAt=vo(["loyalty","loyear"]),sAt=D("loyear.csm"),nAt=D("loy.waon"),oAt=D("mktg.vou"),rAt=({actions:e,isMultiVoucherEnabled:t,isLoyaltyRegistered:n,isLoyaltyFetching:o,isLoyaltyRedeemEnabled:r,basketSummary:a,isUsePaymentChecksEnabled:i,isBasketLoading:l,isLoyaltyEarningEnabled:c,loyaltyEarned:d,isLoyaltyEarningMovedToSummaryEnabled:u,isLoyaltyPaymentEnabled:m,isVouchersMarketingPreferencesEnabled:g})=>{const f=()=>{const S=vt();e.analyticsEvent({type:_e.PAYMENT_CHECK_BUTTON_CLICKED,description:"User clicked on the payment check button",pageEventId:S,pageEventAttributes:{orderId:a.orderId}}),e.openAddPaymentCheckModal({sourceEventId:S,source:"PAYMENT_CHECK_BUTTON_CLICK"})},y=async()=>{if(e.analyticsEvent({type:_e.VOUCHER_BUTTON_CLICKED}),e.openAddVoucherModal(),g)try{await e.getMarketingPreferences()}catch{e.closeModal(),z.error("toast.notification.generic.error")}},I=Yp({getQuantity:Xi});return s.jsxs(h.Fragment,{children:[!u&&c&&d&&d.units>0&&s.jsx("div",{className:"salt-m-b--4",children:s.jsx(FL,{getQuantity:eg})}),s.jsx("div",{className:"salt-m-b--4",children:s.jsx(Xvt,{vouchers:a.vouchers,openAddVoucherModal:y,openAddPaymentCheckModal:f,removeVoucherFromBasket:e.removeVoucherFromBasket,loyaltyInBasket:I,openLoyaltyRedeemModal:e.openLoyaltyRedeemModal,isMultiVoucherEnabled:t,isLoyaltyRegistered:n,isLoyaltyRedeemEnabled:r,isUsePaymentChecksEnabled:i,appliedPaymentChecksInBasket:a?.appliedPaymentChecks||[],removePaymentChecksFromBasket:e.removedAppliedPaymentChecksFromBasket,removeLoyaltyUnitsFromBasket:e.removeLoyaltyUnitsFromBasket,basketTotalValue:a?.totals?.finalPrice,orderId:a.orderId,isBasketLoading:l,isLoyaltyLoading:o,isLoyaltyPaymentEnabled:m})})]})},aAt=e=>({isMultiVoucherEnabled:eAt(e),isLoyaltyRegistered:PC(e),isLoyaltyFetching:Lqe(e),isLoyaltyRedeemEnabled:Zvt(e),isLoyaltyEarningMovedToSummaryEnabled:sAt(e),basketSummary:Zt(e),isUsePaymentChecksEnabled:Jvt(e),isLoyaltyEarningEnabled:tAt(e),loyaltyEarned:eg(e),isLoyaltyPaymentEnabled:nAt(e),isVouchersMarketingPreferencesEnabled:oAt(e)}),iAt=e=>({actions:Ki({analyticsEvent:U.analyticsEvent,openAddVoucherModal:()=>Z.openModal("addVoucher"),openAddPaymentCheckModal:t=>Z.openModal("addBonusCheck",t),openLoyaltyRedeemModal:()=>Z.openModal("redeemLoyalty"),removeVoucherFromBasket:EI.removeVoucherFromBasket,removedAppliedPaymentChecksFromBasket:bO.removedAppliedPaymentChecksFromBasket,removeLoyaltyUnitsFromBasket:kh.removeLoyaltyUnitsFromBasket,getMarketingPreferences:Svt.getMarketingPreferences,closeModal:Z.closeModal},e)}),lAt=Ct(Bt,ke(aAt,iAt))(rAt),cAt=Dn(["sumsub","bt.spl"]),dAt=D("cs.ps"),pU=({quantity:e,isLoyaltyRedeemEnabled:t,isLoyaltyPaymentEnabled:n,isUsePaymentChecksEnabled:o,getLoyaltySpent:r,totalsGroup:a,withTaxNote:i=!1,shouldRenderSeparator:l=!0,orderId:c})=>{const d=E(w=>cAt(w)),u=E(w=>dAt(w)),m=E(w=>$ie(w)),g=u?"always":"auto",f=a.totals?.itemPriceAfterPromos,y=a.totals?.display?.finalPrice,I=a.totals?.paymentSplit?.paidByLoyalty,S=a.totals?.paymentSplit?.remainingPayment,C=a.totals?.savingsPrice,_=a.totals?.paymentMethodSavingsPrice,A=E(D("prp")),x=E(D("oed")),R=E(D("sib")),O=E(w=>qe(w,"seller-sales-enabled")==="true"),N=!!Number(C?.amount),k=!O||!!a.delivery||!!a?.deliveryPromotions?.length,j=!!Number(I?.amount)||!!Number(S?.amount);return s.jsxs(h.Fragment,{children:[s.jsxs(pe,{children:[e?s.jsx(ae.Items,{itemsRetailPrice:a.totals?.itemsRetailPrice,quantity:e,withTaxNote:i}):null,s.jsx(ae.Savings,{savings:C}),R&&N&&A&&s.jsx(Ai,{isSummarySection:!0,className:"salt-m-b--2"}),s.jsx(ae.SavingsWithPaymentMethod,{savings:_}),d&&!O&&N&&!!f&&f?.amount!==a.totals?.finalPrice?.amount&&s.jsx(ae.Subtotal,{value:f,withTaxNote:i}),s.jsx(ae.Promotions,{orderLevelPromotions:a.orderLevelPromotions}),s.jsx(ae.Vouchers,{appliedVouchers:a.vouchers,vouchersSavingsPrice:a.totals?.vouchersSavingsPrice}),s.jsx(ae.Delivery,{delivery:a.delivery,withTaxNote:i,signDisplay:g}),k&&s.jsx(ae.DeliveryPromotions,{deliveryPromotions:a?.deliveryPromotions,hideDeliveryPassInfo:!0}),s.jsx(ae.BagCharge,{carrierBag:a.carrierBag,withTaxNote:i,signDisplay:g}),s.jsx(ae.PreparationCost,{preparationCost:a.preparation,withTaxNote:i,signDisplay:g}),s.jsx(ae.Loyalty,{isLoyaltyRedeemEnabled:t,getLoyaltySpent:r}),s.jsx(ae.Deposit,{depositsPrice:a.totals?.depositsPrice,withTaxNote:i,signDisplay:g}),s.jsx(ae.EnvironmentalHandlingCharge,{environmentalHandlingPrice:a.totals?.environmentalHandlingPrice,withTaxNote:i,signDisplay:g}),s.jsx(ae.Invoice,{invoice:a.invoice,withTaxNote:i,signDisplay:g}),s.jsx(ae.SmallOrderCharge,{smallOrderPrice:a.smallOrder,orderId:c,thresholds:a.smallOrderChargeThresholds,withTaxNote:i,signDisplay:g,page:"checkout-summary",withIcon:!0})]}),a.totals?.taxesTotals&&s.jsx(ae.Taxes,{"data-test":"summary-taxes",finalPrice:a.totals?.finalPrice,components:a.totals?.taxesTotals?.taxes?.components,withTaxNote:i}),o&&I&&S&&j&&s.jsxs(h.Fragment,{children:[s.jsx(ae.Separator,{}),s.jsx(pe,{"data-test":"summary-payment-list",children:s.jsx(ae.PaymentChecks,{"data-test":"summary-payment-checks",remainingBalance:S,paidByCheck:I})})]}),n&&!x&&y&&I&&s.jsx(ae.PaymentLoyalty,{subtotalPrice:y,paidByLoyalty:I}),l&&s.jsx(ae.Separator,{}),m&&O&&s.jsx(pe,{"data-test":"summary-seller-total",children:s.jsx(ae.Subtotal,{value:y,label:"summary.total",withTaxNote:i})})]})},uAt=vo(["loyalty","loyred"]),pAt=D("loy.waon"),mAt=vo(["loyalty","loyear"]),hAt=D("loyear.csm"),gAt=D("pay.check.use"),EAt=D("tx.nts"),fAt=e=>{const{basketSummary:t,quantity:n,expanded:o,loadedViewPortSize:r,formattedMessages:a,isBasketLoading:i,isTermsAndConditionsCheckboxAcknowledged:l,isLoyaltyRedeemEnabled:c,isLoyaltyPaymentEnabled:d,isLoyaltyEarningEnabled:u,isLoyaltyEarningMovedToSummaryEnabled:m,isUsePaymentChecksEnabled:g,isTaxNoteEnabled:f,getLoyaltySpent:y,toggleCollapsibleSummaryBoxState:I}=e,S=E(D("oed")),C=ze(),_=E(R=>qe(R,"seller-sales-enabled")==="true");if(!t||!r)return s.jsxs(cs,{breakpoint:"sm-up",children:[s.jsx(Ns,{children:s.jsx(Ns.Skeleton,{})}),s.jsx(ae.Buttons,{loading:i})]});const A=d&&!S?t?.totals?.paymentSplit?.remainingPayment:t?.totals?.display?.finalPrice;return s.jsxs(gs,{expanded:o,onToggle:I,breakpoint:"md-up",sticky:!0,aria:{contentLabel:a.summaryTitle,totalPrice:A&&C(A)},reverseToggleBreakpoint:"md-up",children:[s.jsxs(gs.ControlSection,{children:[o?s.jsx(ne,{as:"span",children:a.summaryTitle}):s.jsxs(se,{as:"span",direction:"column",gap:["xs"],children:[s.jsx(ae.TotalInline,{loading:i,totalPrice:A,withTaxNote:f}),s.jsx(db,{isExpanded:o})]}),s.jsx(gs.ToggleSwitch,{})]}),s.jsxs(gs.Content,{children:[_&&t.totalsGroups?.length?t.totalsGroups.map(R=>{if(!Number(R.totals?.display?.finalPrice?.amount)&&t.items.length===0)return null;const{groupName:O}=R;return s.jsxs(h.Fragment,{children:[s.jsx(bi,{groupName:O,className:"salt-d--block salt-m-y--2"}),s.jsx(pU,{getLoyaltySpent:G0(O),quantity:rT(t.itemGroups,O,t.items),isLoyaltyRedeemEnabled:c,isLoyaltyPaymentEnabled:d,isUsePaymentChecksEnabled:g,withTaxNote:f,totalsGroup:{...R},shouldRenderSeparator:!1,orderId:t.orderId})]},O)}):s.jsx(pU,{getLoyaltySpent:y,quantity:n,isLoyaltyRedeemEnabled:c,isLoyaltyPaymentEnabled:d,isUsePaymentChecksEnabled:g,withTaxNote:f,totalsGroup:t,orderId:t.orderId}),s.jsx(ae.TotalSpaceBetween,{loading:i,totalPrice:A,withTaxNote:f}),s.jsx(db,{isExpanded:o})]}),s.jsxs("div",{children:[u&&m&&s.jsx("div",{className:"salt-p-t--2","data-test":"loyalty-earnings-summary",children:s.jsx(Hd,{getQuantity:eg,allowZero:!0})}),s.jsx(ae.Buttons,{loading:i,children:s.jsx(jZ,{isTermsAndConditionsAcknowledged:l,className:"salt-m-t--4",...e})})]})]})},yAt=e=>({basketSummary:Zt(e),quantity:gp(e),isLoyaltyRedeemEnabled:uAt(e),isLoyaltyPaymentEnabled:pAt(e),isLoyaltyEarningEnabled:mAt(e),isLoyaltyEarningMovedToSummaryEnabled:hAt(e),getLoyaltySpent:Xi,isUsePaymentChecksEnabled:gAt(e),isTaxNoteEnabled:EAt(e)}),IAt=Ct(Bt,ke(yAt))(fAt),SAt=D("mtz"),pE=({dateIsoFrom:e,dateIsoTo:t,timeZoneId:n,timeFormat:o,local:r=!1})=>{const a=E(Ed)||"",i=E(SAt),l=E(Yt);if(!i)return s.jsx(ie.Fragment,{children:Wh(e,t,o)});if(l)return null;const{displayTimeZoneId:c,showTimeZoneAbbreviation:d}=hC(n,a,r);return s.jsx(ie.Fragment,{children:z$(e,t,c,o,d)})},CAt=D("mtz"),Fh=({dateIso:e,timeZoneId:t,dateFormat:n,local:o=!1})=>{const r=E(Ed)||"",a=E(CAt),i=E(Yt);if(!a)return s.jsx(ie.Fragment,{children:Ks(n,e)});if(i)return null;const{displayTimeZoneId:l,showTimeZoneAbbreviation:c}=p0e(t,r,o);return s.jsx(ie.Fragment,{children:So(e,l,n,c)})},LT=e=>{const t=F(),[n,o]=h.useState(!0);return h.useEffect(()=>{(async()=>{try{await t(e)}catch{z.error("toast.notification.generic.error")}o(!1)})()},[]),n},XZ=e=>e.data.recurringOrdersSignUp.eligibility.data,ZZ=e=>e.data.recurringOrdersSignUp.frequency.data,HL=e=>e.data.recurringOrdersSignUp.slots.data,JZ=()=>{const e=E(ZZ),t=LT(ao.getDeliveryFrequency());return[e,t]},mU=T.div`
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
`,TAt=({sendAnalyticsForFrequencySelected:e,sendAnalyticsForLabelWritten:t})=>{const n=M(),[o]=fe(["nfchk"]),r=Gn({mode:"onChange",reValidateMode:"onChange"}),a=E(Rg),i=E(Rz),[l]=JZ(),c=u=>{if(!u?.frequencies?.length)return[];const m=u.frequencies.map(f=>({id:`${f.unit}_${f.value}`,value:n.formatMessage(`orders.list.recurring.order.frequency.every.${f.value}.${f.unit.toLowerCase()}`)}));return[{id:Lo,value:n.formatMessage("checkout.summary.recurring.order.frequency.none")},...m]},d=u=>u.map(({value:m,id:g})=>({value:g,label:m}));if(o){const u=d(c(l)).map(({value:j,label:w})=>({name:w,value:j})),m=u.find(j=>j.value===a),g=n.formatMessage("checkout.summary.recurring.order.frequency.label"),f=n.formatMessage("checkout.summary.recurring.order.name.label"),y=n.formatMessage("checkout.summary.recurring.order.frequency.placeholder"),I=n.formatMessage("checkout.summary.recurring.order.name.placeholder"),S=n.formatMessage("salt.form.text-field.clear-button.a11y.label"),C=j=>{e({[Ko]:i,[xo]:j})},_=j=>{t({[Ko]:j,[xo]:a})},A=a===Lo,x=a==="",R=x&&i,O=`${n.formatMessage("checkout.summary.recurring.order.frequency.label")} ${n.formatMessage("validation.msg.required")}`,N=!x&&!A&&!i,k=`${n.formatMessage("checkout.summary.recurring.order.name.label")} ${n.formatMessage("validation.msg.required")}`;return s.jsxs(Y,{className:"salt-m-b--2",flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(mt.DropdownSelect,{label:{text:g},contrastBackground:!0,options:u,defaultValue:m,placeholder:y,error:R?O:void 0,name:xo,"data-test":xo,onOptionChange:({value:j})=>C(j)})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(mt.TextField,{label:{text:f},contrastBackground:!0,defaultValue:i,placeholder:I,id:Ko,name:Ko,clearButton:{ariaLabel:S},errorMessage:N?k:void 0,onBlur:j=>_(j.target.value)})})]})}return s.jsx($n,{...r,children:s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(mU,{children:s.jsx("div",{className:"salt-m-b--2",children:s.jsx(Fg,{name:xo,placeholder:n.formatMessage("checkout.summary.recurring.order.frequency.placeholder"),defaultValue:a,label:n.formatMessage("checkout.summary.recurring.order.frequency.label"),onChangeCallback:()=>{e({[Ko]:r.getValues(Ko),[xo]:r.getValues(xo)})},validate:u=>(!u||r.getValues(Ko)&&u===Lo)&&`${n.formatMessage("checkout.summary.recurring.order.frequency.label")} ${n.formatMessage("validation.msg.required")}`||!0,options:d(c(l)),deps:[Ko],"data-test":xo},xo)})})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(mU,{children:s.jsx("div",{className:"salt-m-b--2",children:s.jsx(Jo,{name:Ko,id:Ko,label:n.formatMessage("checkout.summary.recurring.order.name.label"),placeholder:n.formatMessage("checkout.summary.recurring.order.name.placeholder"),defaultValue:i,deps:[xo],onBlur:()=>t({[Ko]:r.getValues(Ko),[xo]:r.getValues(xo)}),validate:u=>!u&&r.getValues(xo)&&r.getValues(xo)!==Lo&&`${n.formatMessage("checkout.summary.recurring.order.name.label")} ${n.formatMessage("validation.msg.required")}`||!0,type:"text"},Ko)})})})]})})},_At=D("pay.check.use"),vAt=vo(["loyalty","loyred"]),eJ=e=>{const{selectedRecurringShoppingDefinitionCreateFrequency:t,slot:n,isUsePaymentChecksEnabled:o,appliedPaymentChecksInBasket:r,isLoyaltyRedeemEnabled:a,basketLoyaltySpent:i,isLoyaltyRegistered:l,actions:c}=e,d=()=>c.analyticsEvent({type:_e.RECURRING_SHOPPING_DEFINITION_FORM_CARD_IMPRESSION,recurringShoppingDefinitionCreateFormImpression:{CARD_TYPE:"recurringShoppingDefinitionCreateForm"}});h.useEffect(()=>{d()},[]);const u=C=>{c.analyticsEvent({type:_e.RECURRING_SHOPPING_DEFINITION_FREQUENCY_SELECTED,description:"The user has chosen the frequency for its recurring order from the dropdown menu",data:{recurringFrequency:C["recurring-shopping-definition-create-frequency"]}})},m=C=>{c.analyticsEvent({type:_e.RECURRING_SHOPPING_DEFINITION_LABEL_WRITTEN,description:"The user has written the label for its recurring order",data:{recurringFrequencyName:C["recurring-shopping-definition-create-name"]}})},g=()=>t===xz?"checkout.summary.recurring.order.confirmed.frequency.every.1.week.message":"checkout.summary.recurring.order.confirmed.frequency.every.2.weeks.message",f=a&&!!i,I=f||a&&l&&!f,S=o&&r&&r.length>=1&&!I;return s.jsxs(ve,{children:[s.jsx("div",{className:"salt-m-b--2",children:s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"checkout.summary.recurring.order.title"})})}),S?s.jsx(P,{children:s.jsx(v,{id:"checkout.summary.recurring.order.unavailable.message"})}):s.jsxs(ie.Fragment,{children:[s.jsx("div",{className:"salt-m-b--4",children:s.jsx(P,{children:s.jsx(v,{id:"checkout.summary.recurring.order.create.message"})})}),s.jsx(TAt,{sendAnalyticsForLabelWritten:m,sendAnalyticsForFrequencySelected:u}),n&&t&&t!==Lo&&s.jsx(Ce,{intent:"action",showIcon:!1,"data-test":"recurring-shopping-definition-create-alert",text:s.jsxs(P,{children:[s.jsx(v,{id:g(),values:{slotTimeRange:s.jsx(pE,{dateIsoFrom:n.start,dateIsoTo:n.end,timeZoneId:n.timeZoneId,timeFormat:e.timeFormat}),startingSlotDate:s.jsx(Fh,{dateIso:n.start,timeZoneId:n.timeZoneId,dateFormat:e.dateFormat}),weekDayName:s.jsx(Fh,{dateIso:n.start,timeZoneId:n.timeZoneId,dateFormat:Ma})}})," ",s.jsx(v,{id:"checkout.summary.recurring.order.change.slot.message"})]})})]})]})};eJ.defaultProps={selectedRecurringShoppingDefinitionCreateFrequency:void 0,slot:void 0};const AAt=e=>({slot:aS(e),timeFormat:Vt(e),dateFormat:da(e),selectedRecurringShoppingDefinitionCreateFrequency:Rg(e),isUsePaymentChecksEnabled:_At(e),appliedPaymentChecksInBasket:Zt(e)?.appliedPaymentChecks||[],basketLoyaltySpent:Xi(e),isLoyaltyRedeemEnabled:vAt(e),isLoyaltyRegistered:PC(e)}),bAt=ot({analyticsEvent:U.analyticsEvent}),xAt=Ct(Bt,ke(AAt,bAt))(eJ),RAt=vo(["rec.o","cs.rosu"]),DAt=e=>{const{isBasketOrderUnderEdit:t,basketSummary:n,isRecurringOrdersEnabled:o,isSuperUser:r,isExpressCollectionOrMultidayDelivery:a,isCourierSlot:i,isDefaultShippingGroup:l}=e,c=n.slot?.deliveryMethod===Et.vanDelivery.method&&n.slot?.slotType==="ON_DEMAND";return!o||t||a||i||r||!l||c?null:!n||n.isFetchingCheckoutBasket?s.jsx(Ns.Skeleton,{}):s.jsx("div",{"data-test":"recurring-shopping-definition-create",tabIndex:0,ref:e.recurringShoppingSectionRef,className:"salt-m-b--4",children:s.jsx(xAt,{})})},OAt=e=>({isBasketOrderUnderEdit:Mr(e),basketSummary:Zt(e),isExpressCollectionOrMultidayDelivery:Fie(e),isCourierSlot:_i(e),isRecurringOrdersEnabled:RAt(e),isSuperUser:e.session.isSuperuser,isDefaultShippingGroup:Op(e)}),PAt=Ct(Bt,ke(OAt))(DAt),NAt=e=>!e||!e?.slot?null:{deliveryStartDate:e.slot.start,deliveryEndDate:e.slot.end,addressNickName:e.slot.nickname,addressNotes:e.slot.notes,address:e.slot.displayAddress,additionalInformation:e.slot.collectionPointAdditionalInformation,ageRestriction:e.ageRestriction,deliveryType:e.slot.deliveryType,deliveryMethod:e.slot.deliveryMethod,slotType:e.slot.slotType,deliveryTimeInMinutes:e.slot.deliveryTimeInMinutes,collectionTimeInMinutes:e.slot.collectionTimeInMinutes,carrierId:e?.checkout?.delivery?.carrierId,addressId:e?.slot?.addressId,shippingGroupType:e?.checkout?.shippingGroupType,externalAddress:e?.checkout?.delivery?.externalAddress,timeZoneId:e.slot.timeZoneId,deliveryDestinationId:e?.slot?.deliveryDestinationId},LAt=T.div`
    ${oe.smUp`
            position: sticky;
            top: ${ra.v2.sm}px;
        `}
    ${oe.lgUp`
            position: sticky;
            top: ${ra.v2.lgUp}px;
        `}
`,kAt=e=>{const t=F(),n=Ne(),o=We(),r=E(Fa),a=E(iE),i=E(ir),l=E(om),[c,d,u,m,g,f]=fe(["dass","oed","cs.tcm","cs.tc","cs.bpo","nfuad"]),[y,I,S,C,_]=fe(["cs.aib","bam","csc.b","loy.waon","cs.edci"]),[A,x]=h.useState({isOpen:!1,maxAgeRestriction:void 0}),R=h.useRef(null),[O,N]=h.useState(!1),[k,j]=h.useState(!1),w=()=>{N(Xs=>!Xs),j(!1)},L=()=>{R.current?.scrollIntoView({behavior:"smooth",block:"center"}),j(!0)},{shouldShowUnresolvableErrorAlert:B,ageConfirmed:W,isAgeConfirmationError:$,ageConfirmationFormRef:K,basketSummary:Q,isBasketLoading:X,checkoutErrorMessage:re,paymentSectionRef:ue,recurringShoppingSectionRef:te,isSelectedRecurringShoppingDefinitionFrequencyDefined:ce,setSelectedWalletItem:de,setSelectedPaymentMethodExternalWallet:ye,toggleAgeConfirmationCheckbox:Ae,shouldShowExternalWalletPaymentSelector:Je,billingAddressRef:Ie,orderBillingAddress:je,loadedViewPortSize:Le,formattedMessages:Be,isFinancingProviderNotSelectedError:be,fetchCheckoutBasketWithDeliveryInfo:he}=e,ge=Q.slot?.deliveryMethod===Et.clickAndCollect.method,Oe=!!Q.slot?.latestUpdateTime,Xe=c&&!ge&&!!a.length,Se=C&&!d?Q?.totals?.paymentSplit?.remainingPayment:Q?.totals?.display?.finalPrice,{deliveryCardImpression:dt,changeDeliveryButtonClicked:et}=VCt();h.useEffect(()=>{ge||t(TL({deliveryDestinationId:r}))},[t,r,ge]),h.useEffect(()=>{if(!X){const Xs=Q.items?.some(as=>!!i[as.productId]?.verifyMode),Ur=Q.items?.reduce((as,{productId:Gr})=>{const es=Number(i[Gr]?.ageRestriction);return es>as?es:as},0);Xs&&x(as=>({...as,isOpen:!0,maxAgeRestriction:Ur}))}},[X,Q,i,n,o]);const we=s.jsx("div",{className:"salt-m-b--2 md:salt-m-b--0",children:s.jsx(ve,{"data-test":"summary-t&c-item",tabIndex:0,ref:R,children:s.jsx(lTt,{isTermsAndConditionsCheckboxAcknowledged:O,isTermsAndConditionsAcknowledgeError:k,toggleTermsAndConditionsCheckbox:w})})}),Ut=s.jsxs(h.Fragment,{children:[s.jsxs("div",{className:"salt-m-b--4",children:[g&&s.jsx("div",{className:"salt-m-b--2",children:s.jsx(rZ,{})}),m&&u&&s.jsx(Kt,{breakpoint:"md-up",remainInDom:!1,children:we}),s.jsx(RL,{delivery:Q.slot&&NAt(Q),deliveryCardImpression:dt,onChangeDeliveryButtonClick:et,ageConfirmed:W,isAgeConfirmationError:$,ageConfirmationFormRef:K,onClickAgeConfirmation:Ae})]}),Xe&&!f&&s.jsx(YCt,{onChange:he}),Xe&&f&&s.jsx(WCt,{onChange:he}),s.jsx(PAt,{recurringShoppingSectionRef:te})]}),ys=s.jsxs(h.Fragment,{children:[I&&s.jsx(DL,{billingAddressRef:Ie,orderBillingAddress:je,editOrderMode:Q.basketStatus?Q.basketStatus==="ORDER_EDIT":null,isReadOnly:!1}),s.jsx("div",{className:"salt-m-b--4",children:s.jsx(fvt,{isBasketLoading:X,isSelectedRecurringShoppingDefinitionFrequencyDefined:ce,paymentSectionRef:ue,setSelectedPaymentMethodExternalWallet:ye,setSelectedWalletItem:de,shouldShowExternalWalletPaymentSelector:Je,isFinancingProviderNotSelectedError:be})}),s.jsx(lAt,{isBasketLoading:X}),_&&s.jsx(rTt,{}),y&&s.jsx(ESt,{})]});return s.jsxs(Y,{fixed:!0,flush:!0,"data-test":"summary-grid",children:[!Oe&&s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(KCt,{})}),B&&s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx("div",{className:"salt-m-b--2",children:s.jsx(aTt,{checkoutErrorMessage:re})})}),m&&!u&&s.jsx(Y.Item,{colSpan:{xs:12},children:we}),s.jsxs(Y.Item,{colSpan:{xs:12,md:8},children:[Ut,ys]}),s.jsx(Y.Item,{colSpan:{xs:12,md:4},children:s.jsxs(LAt,{children:[s.jsx("div",{className:"salt-m-b--4",children:S?s.jsx(HP,{summaryTitle:Be.summaryTitle,totalPrice:Se,loading:X,basketSummary:Q,breakpoint:"md-up",loadedViewPortSize:Le,reverseToggleBreakpoint:"md-up",ariaExpandedLabel:Be.summaryExpandLabel,ariaCollapsedLabel:Be.summaryContractLabel,renderButtonsSection:()=>s.jsx(jZ,{setTermsAndConditionsAcknowledgeError:L,isTermsAndConditionsAcknowledged:O,className:"salt-m-t--4",...e}),renderItemsSection:()=>s.jsx(GCt,{basketSummary:Q,page:"checkout-summary"}),renderItemsBySellerSection:()=>s.jsx($Ct,{basketSummary:Q,page:"checkout-summary"}),renderEditOrderDifference:Xs=>s.jsx(db,{isExpanded:Xs}),children:s.jsx(HCt,{})}):s.jsx(IAt,{setTermsAndConditionsAcknowledgeError:L,isTermsAndConditionsCheckboxAcknowledged:O,...e})}),m&&u&&s.jsx(cs,{breakpoint:"md-up",remainInDom:!1,children:we})]})}),f&&l&&s.jsx(FZ,{showDeliveryAssetInitially:!1,deliveryDestinationId:r,onDeliveryDetailsSaved:he}),!f&&s.jsx(bZ,{showDeliveryAssetInitially:!1,deliveryDestinationId:r,onDeliveryDetailsSaved:he}),s.jsx(qCt,{age:A.maxAgeRestriction,redirectOnCancel:jt,isOpen:A.isOpen})]})},MAt=e=>{const t=E(ir),[n,o]=h.useState(0),[r,a]=h.useState(()=>{const l=e.items.map(({productId:c,quantity:d})=>({product:t[c],quantity:d.quantityInBasket})).filter(({product:c})=>c?.medicalQuestionnaireRequired);return o(l.length),l.map(({product:c,quantity:d},u)=>({productId:c.productId,retailerProductId:c.retailerProductId,retailerProductName:c.name,quantity:d,index:u}))}),i=h.useCallback(()=>{const[,...l]=r;return a(()=>l),l[0]||null},[r]);return{medicine:r[0]||null,medicinesCount:n,getNextMedicine:i}},jAt=e=>{const t=M(),{numberOfProducts:n,productIndex:o,productName:r}=e;let a=n>1?`${t.formatMessage("checkout.summary.pharmacy.modal.header.prefix",{productIndex:o+1,numberOfProducts:n})} `:"";return a+=`${t.formatMessage("checkout.summary.pharmacy.modal.header",{productName:r})}`,s.jsx(ie.Fragment,{children:a})},wAt=()=>{const e=M();return s.jsx(ie.Fragment,{children:e.formatMessage("checkout.summary.pharmacy.modal.confirmation-required.header")})},FAt=e=>s.jsx(G.Header,{align:"center","data-test":e.headerLabelId,children:s.jsx(ne,{as:"h2",id:e.headerLabelId,children:e.confirmationRequired?s.jsx(wAt,{}):s.jsx(jAt,{...e})})}),BAt=T.iframe`
    position: relative;
    opacity: ${({hide:e})=>e?0:1};
    overflow: hidden;
`,UAt={OUT_OF_SERVICE_TIME:"Cannot deliver at this time"};function hU(e){return new URL(e).origin}const GAt="https://z1ab96-form-web1.wittymushroom-99a09b56.japaneast.azurecontainerapps.io/pharmacy/form",$At=5e3,HAt="Unexpected error while loading a medical questionnaire iframe",gU={UNKNOWN_STRUCTURE:"Unexpected structure of the event",TIMEOUT:"Event was not received"},VAt=({hide:e,pharmacyData:t,onSuccessCallback:n,onCancelCallback:o,onFailCallback:r,onCannotDeliverAtThisTimeCallback:a,setPending:i})=>{const l=Cs("medical-questionnaire-url"),c=h.useRef(null),d=h.useRef(void 0),u=F();h.useEffect(()=>{i(!0)},[i]);const m=h.useCallback(y=>{const{reason:I,pharmacyData:S}=y;let C=I||"";"errorReason"in y&&(C=I||(y.errorReason?`${HAt}: ${y.errorReason}`:"")),u(U.analyticsEvent({type:_e.PHARMACY_FORM_IFRAME_LOADING_ERROR,reason:C,pharmacyData:S}))},[u]),g=h.useCallback(y=>{y===UAt.OUT_OF_SERVICE_TIME?a():r()},[a,r]),f=h.useCallback(y=>{if(y.origin!==hU(l)&&y.origin!==hU(GAt)||y.source!==c?.current?.contentWindow)return;clearTimeout(d.current);const{OK:I,PENDING:S,ERROR:C,CANCEL:_,READY:A}=SIt,x=y?.data?.reason;switch(y?.data?.status){case A:c?.current?.contentWindow?.postMessage(t,l),i(!1);break;case S:i(!0);break;case I:i(!1),n();break;case _:i(!1),o();break;case C:{i(!1),m({reason:x,pharmacyData:t}),g(x);break}default:m({reason:x,pharmacyData:t,errorReason:gU.UNKNOWN_STRUCTURE});break}},[l,t,i,n,o,m,g]);return h.useEffect(()=>(window.addEventListener("message",f),d.current=setTimeout(()=>{m({pharmacyData:t,errorReason:gU.TIMEOUT})},$At),()=>{clearTimeout(d.current),window.removeEventListener("message",f)}),[f,t,m]),s.jsx(BAt,{hide:e,sandbox:"allow-scripts allow-same-origin allow-forms",title:"medicine-form",src:l,"data-synthetics":"medicine-iframe","data-test":"medicine-iframe",height:600,width:"100%",ref:c})},YAt=T(Rs)`
    position: absolute;
    inset-block-start: 50%;
    inset-inline-start: 50%;
    transform: translate(-50%, -50%);
    z-index: 1001;
`,WAt=({productName:e})=>{const t=M();return s.jsx(ie.Fragment,{children:t.formatMessage("checkout.summary.pharmacy.modal.confirmation-required.message",{productName:e})})},qAt=e=>{const[t,n]=h.useState(!1),{setConfirmationRequired:o,setSubmitSuccessful:r,pharmacyData:a,setNotEnoughTime:i}=e,l=h.useCallback(()=>{r(!0)},[r]),c=h.useCallback(()=>{o(!0)},[o]),d=h.useCallback(()=>{o(!0)},[o]),u=h.useCallback(()=>{i(!0)},[i]);return s.jsxs(ie.Fragment,{children:[t&&s.jsx(YAt,{size:"m"}),s.jsx(VAt,{hide:t,pharmacyData:a,setPending:n,onSuccessCallback:l,onCancelCallback:c,onFailCallback:d,onCannotDeliverAtThisTimeCallback:u},a.productId)]})},KAt=e=>s.jsx(G.Body,{children:e.confirmationRequired?s.jsx(WAt,{productName:e.productName}):s.jsx(qAt,{...e})}),zAt=e=>s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(b,{className:"salt-m-t--4",intent:"primary",fill:!0,onClick:e.continueCheckout,"data-test":"pharmacy-modal-continue-checkout",children:s.jsx(v,{id:"checkout.summary.pharmacy.modal.submit-successful.continue-checkout.button"})})}),QAt=e=>s.jsxs(ie.Fragment,{children:[s.jsx(Y.Item,{colSpan:{xs:12,sm:6},children:s.jsx(b,{className:"salt-m-t--4",intent:"secondary",fill:!0,onClick:()=>e.setConfirmationRequired(!1),children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.pharmacy.modal.confirmation-required.try-again.button"})})})}),s.jsx(Y.Item,{colSpan:{xs:12,sm:6},children:s.jsx(b,{className:"salt-m-t--4",intent:"primary",fill:!0,onClick:e.removeItemFromBasket,"data-test":"pharmacy-confirm-removal",children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.pharmacy.modal.confirmation-required.remove-item.button"})})})})]}),XAt=e=>e.submitSuccessful?s.jsx(zAt,{...e}):e.confirmationRequired?s.jsx(QAt,{...e}):null,ZAt=e=>!e.submitSuccessful&&!e.confirmationRequired?null:s.jsx(G.Footer,{className:"salt-d--block",children:s.jsx(Y,{children:s.jsx(XAt,{...e})})}),JAt=e=>{const{getNextMedicine:t,removeItemFromBasket:n,continueCheckout:o,medicine:r,medicinesCount:a,pharmacyData:i}=e,l="medicine-modal-header",[c,d]=h.useState(!1),[u,m]=h.useState(!1),[g,f]=h.useState(!1),y=F(),I=h.useCallback(()=>{d(!1),m(!1),f(!1)},[d,m,f]),S=h.useCallback(()=>{u?(I(),t()):g||c?(I(),n()):d(!0)},[u,c,g,I,t,n]);return s.jsxs(G,{isOpen:e.open,aria:{labelledby:l},onRequestClose:S,contentLabel:"medicine-modal",maxWidth:"lg",children:[s.jsx(FAt,{headerLabelId:l,confirmationRequired:c,productName:r.retailerProductName,productIndex:r.index,numberOfProducts:a}),s.jsx(KAt,{confirmationRequired:c,setConfirmationRequired:d,setNotEnoughTime:f,setSubmitSuccessful:C=>{C&&y(U.analyticsEvent({type:_e.PHARMACY_FORM_SUBMIT_CLICKED,description:"Pharmacy modal submit button clicked",pageEventAttributes:{orderId:i.orderId,productId:i.productId,shipmentDate:i.shipmentDate,retailerCustomerId:i.retailerCustomerId}})),m(C)},productName:r.retailerProductName,pharmacyData:i}),s.jsx(ZAt,{confirmationRequired:c,submitSuccessful:u,continueCheckout:()=>{I(),o()},removeItemFromBasket:()=>{I(),n()},setConfirmationRequired:d})]})},ebt=(e,t,n,o)=>{const{productId:r,retailerProductId:a,retailerProductName:i,quantity:l}=e;return{productId:r,shipmentDate:n,retailerCustomerId:o,retailerProductId:a,retailerProductName:i,orderId:t,retailerOrderId:t,retailerProductCnt:l}},tbt=({basket:e,actions:t,open:n,requestId:o})=>{const{medicine:r,medicinesCount:a,getNextMedicine:i}=MAt(e),l=E(ua),c=We(),d=F(),u=h.useMemo(()=>r&&e?.orderId&&e?.slot?.start?ebt(r,e.orderId,Ey(e.slot.start),l):null,[e.orderId,e?.slot?.start,r,l]),m=h.useCallback(()=>{u&&t.analyticsEvent({type:_e.PHARMACY_FORM_DELETE_ITEM_CLICKED,description:"Button to remove medicine from trolley clicked",pageEventAttributes:{orderId:u.orderId,productId:u.productId,shipmentDate:u.shipmentDate,retailerCustomerId:u.retailerCustomerId}})},[t,u]),g=h.useCallback(()=>{t.closeModal(),m(),t.batchRemoveFromBasket({page:"pharmacy",product:{...r}}),e.items.length===1&&c(jt()),z.info({key:"checkout.summary.pharmacy.modal.notification.item-removed",substitutions:{productName:r?.retailerProductName}}),i()},[t,e.items?.length,i,c,r,m]),f=h.useCallback(()=>{t.closeModal(),i()},[t,i]),y=h.useCallback(()=>{Me.api.pushError(new Error(`Pharmacy Form could not be loaded due to missing data. RequestId: ${o}`)),g(),z.error("toast.notification.generic.error")},[g,o]);h.useEffect(()=>{u&&(t.openPharmacyModal(),t.analyticsEvent({type:_e.PHARMACY_FORM_DISPLAYED,description:"Pharmacy modal displayed",pageEventAttributes:{orderId:u.orderId,productId:u.productId,shipmentDate:u.shipmentDate,retailerCustomerId:u.retailerCustomerId}}))},[t,d,u]);const S=Object.values(u||{}).some(C=>C===void 0);return h.useEffect(()=>{S&&y()},[y,S]),u?s.jsx(JAt,{open:n,medicine:r,medicinesCount:a,pharmacyData:u,getNextMedicine:i,removeItemFromBasket:g,continueCheckout:f}):null},sbt=e=>({open:Ue(iZ)(e),requestId:tS(e)}),nbt=ot({analyticsEvent:U.analyticsEvent,openPharmacyModal:()=>Z.openModal(iZ),closeModal:Z.closeModal,batchRemoveFromBasket:ca.createBatchRemoveFromBasket()}),obt=Ct(ke(sbt,nbt))(tbt),rbt=()=>async e=>{try{await e(Pm.getRecurringShoppingDefinitions())}catch{}},qa={getRecurringShoppingDefinitions:rbt},an={INITIATE_AUTHENTICATION:"INITIATE_AUTHENTICATION",PAYMENT_REQUESTED:"PAYMENT_REQUESTED",PAYMENT_CANCELLED:"PAYMENT_CANCELLED"};class VL{eventCallbacks=[];eventSpecificCallbacks={[an.PAYMENT_REQUESTED]:[],[an.PAYMENT_CANCELLED]:[],[an.INITIATE_AUTHENTICATION]:[]};requestPayment(){this.notify({eventType:an.PAYMENT_REQUESTED})}cancelPayment(){this.notify({eventType:an.PAYMENT_CANCELLED})}initiatePaymentAuthentication({authenticationUrl:t}){this.notify({eventType:an.INITIATE_AUTHENTICATION,payload:{authenticationUrl:t}})}notify(t){this.eventCallbacks.concat(this.eventSpecificCallbacks[t.eventType]).forEach(n=>n(t))}subscribe(t){this.eventCallbacks.push(t)}unsubscribe(t){this.eventCallbacks=this.eventCallbacks.filter(n=>n!==t)}subscribeToEvent(t,n){this.eventSpecificCallbacks[t].push(n)}unsubscribeToEvent(t,n){this.eventSpecificCallbacks[t]=this.eventSpecificCallbacks[t].filter(o=>o!==n)}}const YL=()=>e=>e(Zf.getCheckoutBaseRecoverUrl()),abt={inModal:!1},ibt=T.iframe`
    inline-size: 100%;
    block-size: ${({iframeHeightInPx:e})=>e}px;
`,tJ=({url:e,handleResult:t,handleError:n,handleCancellation:o,inModal:r,frameHeight:a})=>{const i=E(D("s.res")),l=E(D("pay.skpxss")),c=h.useRef(null),d=M(),u=F(),{shouldLogUnauthorizedAttempt:m}=BZ({throttleTimeoutMs:3e3});let g;a?g=a:g=r?550:650;const f=_=>u(U.analyticsEvent({type:xt.UNAUTHORIZED_POST_MESSAGE_ATTEMPT,origin:_})),y={iframeTitle:d.formatMessage("checkout.3ds.iframe.title"),processingOrder:d.formatMessage("checkout.processing.text")},I=_=>{_.redirectUrl?window.location.assign(_.redirectUrl):(Me.api.pushError(new Error("Received trigger external redirect event, but no redirectUrl was found.")),n())},S=()=>i?void 0:"allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox allow-top-navigation allow-top-navigation-by-user-activation",C=_=>{if(!l&&!EO(_.origin)){m(_.origin)&&f(_.origin);return}_.data.type==="CHECKOUT_RESULT_TOKEN"?t(_.data):_.data.type==="CHECKOUT_ERROR"?n(_.data.reason):_.data.type==="CHECKOUT_CANCELLED"?o():_.data.type==="TRIGGER_EXTERNAL_REDIRECT"&&I(_.data)};return h.useEffect(()=>(window.addEventListener("message",C),()=>{window.removeEventListener("message",C)}),[]),s.jsx(ibt,{"data-pii":"true","data-synthetics":"3ds-iframe","data-test":"3ds-iframe",sandbox:S(),src:e,title:y.iframeTitle,ref:c,iframeHeightInPx:g})};tJ.defaultProps=abt;const lbt=D("pay.ew"),cbt=D("pay.paw"),dbt=T.span`
    font-size: ${H(14)};
`,ubt={actions:p.shape({analyticsEvent:p.func.isRequired,fetchRecoveryUrls:p.func.isRequired}).isRequired,intl:p.any.isRequired,messageCallback:p.func.isRequired,errorCallback:p.func.isRequired,redirectUrlConfig:p.shape({url:p.string.isRequired,text:p.string.isRequired}),location:p.shape({search:p.string.isRequired,state:p.shape({psp:p.string,pspweb:p.shape({url:p.string.isRequired})})}).isRequired,externalWalletManagement:p.bool,isUrlFetching:p.bool,baseUrlLastModified:p.number,recoveryUrls:p.shape({pspweb:p.shape({url:p.string})}),inModal:p.bool,threeDsHeight:p.number},pbt={externalWalletManagement:!1,redirectUrlConfig:void 0,recoveryUrls:{},isUrlFetching:!1,baseUrlLastModified:null,inModal:!1};class WL extends h.Component{constructor(t){super(t),this.handlePspWebMessage=this.handlePspWebMessage.bind(this),this.handle3dsError=this.handle3dsError.bind(this),this.handle3dsCancellation=this.handle3dsCancellation.bind(this),this.setFrameBoxPosition=this.setFrameBoxPosition.bind(this),this.sendPageAttributesEvent=this.sendPageAttributesEvent.bind(this),this.formattedMessages={iframeTitle:t.intl.formatMessage("checkout.3ds.iframe.title"),processingOrder:t.intl.formatMessage("checkout.processing.text"),summaryRedirectWarningText:t.intl.formatMessage("checkout.3ds.summary.redirect.warning.text"),summaryRedirectWarningLinkText:t.intl.formatMessage("checkout.3ds.summary.redirect.warning.link.text")},this.state={isWaiting:!0}}componentDidMount(){const{actions:{fetchRecoveryUrls:t},location:n}=this.props,{recoveryToken:o}=us.parse(n.search);o&&t(),this.setState({isWaiting:!1}),this.sendPageAttributesEvent()}shouldComponentUpdate(t,n){return n.isWaiting!==this.state.isWaiting||this.isRecoveryLoading(t)!==this.isRecoveryLoading(this.props)}setFrameBoxPosition(t){const n=t.target.parentNode,o=n.getBoundingClientRect().top;n.setAttribute("style",`--frameBoxPosition: ${o}px;`)}handlePspWebMessage({resultToken:t}){this.setState({isWaiting:!0},()=>{const{messageCallback:n}=this.props;return n({resultToken:t})})}handle3dsError(t){let n="order.cow.3ds.failure",o="3ds=failure";return t==="TOKEN_NOT_FOUND"&&(n="payments.notification.token.not.found.error",o=o+"&reason=token-not-found"),z.error(n),this.props.errorCallback({errorParam:o})}handle3dsCancellation(){return z.error("order.cow.3ds.user.cancelled"),this.props.errorCallback({errorParam:"3ds=cancelled"})}shouldShowWaiting(){const{isUrlFetching:t,baseUrlLastModified:n}=this.props;return this.state.isWaiting||this.isRecovery()&&this.isRecoveryLoading({isUrlFetching:t,baseUrlLastModified:n})}sendPageAttributesEvent(){this.props.actions.analyticsEvent({type:As.PAGE_ATTRIBUTES_MULTIPLE,attributes:{IS_EXTERNAL_PAYMENT:this.props.externalWalletManagement}})}renderSpinner(){return s.jsxs("div",{className:"salt-m--8",children:[s.jsx(Rs,{"data-test":"3ds-spinner"}),s.jsx("div",{className:"salt-m-t--2",style:{textAlign:"center"},children:this.formattedMessages.processingOrder})]})}renderRedirectWarning(){return s.jsx(Ce,{className:"salt-m-t--8 salt-m-x--1 salt-m-b--4",intent:"warning","data-test":"payment-authentication-warning",showIcon:!1,text:s.jsxs(dbt,{children:[s.jsx("span",{className:"salt-d--inline-block",children:this.formattedMessages.summaryRedirectWarningText})," "]}),link:s.jsx(Ce.Link,{href:this.props.redirectUrlConfig.url,onClick:this.handle3dsCancellation,"data-test":"3ds-redirect-warning",isSSRNavigation:!0,children:this.props.redirectUrlConfig.text})})}buildPspwebRecoveryUrl(){const{recoveryUrls:t,location:n}=this.props,o=t?.pspweb?.url,{recoveryToken:r}=us.parse(n.search);return o&&r?`${o}?${us.stringify({recoveryToken:r})}`:""}isRecovery(){const{pspweb:t}=this.props.location?.state||{};return!t?.url}isRecoveryLoading({isUrlFetching:t,baseUrlLastModified:n}){return t||!n}renderPspContent(){const{pspweb:t}=this.props.location?.state||{};return s.jsx(tJ,{url:t?.url||this.buildPspwebRecoveryUrl(),handleResult:this.handlePspWebMessage,handleError:this.handle3dsError,inModal:this.props.inModal,handleCancellation:this.handle3dsCancellation,frameHeight:this.props.threeDsHeight})}render3dsIFrame(){const t=this.renderPspContent();return s.jsxs(h.Fragment,{children:[this.props.isPaymentAuthenticationWarningEnabled&&this.props.redirectUrlConfig&&this.renderRedirectWarning(),this.props.inModal?t:s.jsx(WS,{onLoad:this.setFrameBoxPosition,children:t})]})}render(){return s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"checkout.3ds.page.title"}),this.shouldShowWaiting()?this.renderSpinner():this.render3dsIFrame()]})}}WL.propTypes=ubt;WL.defaultProps=pbt;const mbt=e=>({externalWalletManagement:lbt(e),isPaymentAuthenticationWarningEnabled:cbt(e),isUrlFetching:HQe(e),recoveryUrls:u6(e),baseUrlLastModified:VQe(e)}),hbt=ot({analyticsEvent:U.analyticsEvent,fetchRecoveryUrls:YL}),kT=Ct(Bt,ke(mbt,hbt))(WL),gbt={taxGroups:p.arrayOf(p.shape()).isRequired,taxTotal:p.string.isRequired,isTaxGrossDisplayed:p.bool},Ebt={isTaxGrossDisplayed:!1},mE=({isTaxGrossDisplayed:e,taxGroups:t,taxTotal:n})=>{const o={totalMessage:e?"payment.modal.tax.breakdown.total.inclusive.tax":"payment.modal.tax.breakdown.total"};return s.jsx(h.Fragment,{children:!!t?.length&&!!n&&s.jsxs(pe,{"data-test":"taxes-breakdown",children:[t.map(r=>s.jsxs(pe.Group,{children:[s.jsxs(pe.Title,{children:[r.displayName," ",s.jsx(O$,{value:r.taxRate/100||0,style:"percent"})]}),s.jsx(pe.Description,{"data-test":"taxes-breakdown-item-description",children:r.valueAndCurrency})]},r.displayName)),s.jsxs(pe.Group,{children:[s.jsx(pe.Title,{children:s.jsx(v,{id:o.totalMessage})}),s.jsx(pe.Description,{"data-test":"taxes-breakdown-total",children:n})]})]})})};mE.propTypes=gbt;mE.defaultProps=Ebt;const fbt=D("m.la.h"),ybt=T(G.Body)`
    overflow: hidden;
    flex-direction: column;
`,dy="paymentPsp",MT=e=>{const{isFetching:t=!1,title:n="",url:o=void 0,taxInfo:{taxGroups:r,taxTotal:a}={taxGroups:[],taxTotal:"",isError:!1},isTaxGrossDisplayed:i=!1,handleError:l=()=>{},handleSuccess:c=()=>{},isRecoveringThreeDs:d=!1,location:u={},maxWidth:m="sm",threeDsHeight:g,onClose:f=()=>{},onAfterClose:y=()=>{},asBottomSheet:I=!1}=e,S=M(),C=F(),_=E(fbt),A=wt(dy),x=k=>{k?.preventDefault?.(),C(U.analyticsEvent({type:Es.SELECTED_DELIVERY_PASS_PLAN_MODAL_DISPLAYED,userAction:"close"})),f?.(),A.close(),y?.()},R=({resultToken:k})=>{k&&c(k)},O={...u,state:{...u.state,pspweb:{url:o}}},N=S.formatMessage("checkout.3ds.summary.redirect.warning.link.text");return s.jsxs(G,{isOpen:A.isOpen,onRequestClose:k=>x(k),isLoading:t,maxWidth:m,asBottomSheet:I,children:[s.jsx(G.Header,{align:_?"left":"center","data-test":"payment-psp-modal-title",children:s.jsx(ne,{as:"h1",children:n})}),s.jsxs(ybt,{className:"salt-d--flex",children:[s.jsx(mE,{isTaxGrossDisplayed:i,taxGroups:r,taxTotal:a}),O.state?.pspweb?.url||d?s.jsx(kT,{"data-test":"payment-psp-subscription-iframe",messageCallback:R,errorCallback:l,location:O,inModal:!0,redirectUrlConfig:{url:tr(),text:N},threeDsHeight:g}):s.jsx("div",{className:"salt-m--8",children:s.jsx(Rs,{"data-test":"payment-psp-modal-spinner"})})]})]})},Ibt=({actions:e,paymentSession:t})=>{const{canCheckout:n,handlePaymentAuthenticationSuccess:o}=NL(),[r,a]=h.useState(void 0);h.useEffect(()=>{const d=({eventType:u,payload:m})=>{switch(u){case an.PAYMENT_REQUESTED:a(void 0),e.openPaymentAuthenticationModal();break;case an.PAYMENT_CANCELLED:e.closeModal();break;case an.INITIATE_AUTHENTICATION:n().then(()=>a(m.authenticationUrl)).catch(e.closeModal);break}};return t.subscribe(d),()=>{e.closeModal(),t.unsubscribe(d)}},[]);const i=d=>o({resultToken:d}),l=()=>e.closeModal(),c=r&&{state:{pspweb:{url:r}}};return s.jsx(MT,{handleError:l,handleSuccess:i,url:r,location:c||{}})},Sbt=ot({closeModal:Z.closeModal,openPaymentAuthenticationModal:()=>Z.openModal("paymentPsp")}),Cbt=ke(null,Sbt)(Ibt),Tbt=T.div`
    text-align: center;
    background-color: #ea5653;
`,_bt=T.object`
    max-inline-size: 100%;
    inline-size: 350px;
    block-size: auto;
`,vbt=({altText:e,url:t,setIsMissingFrenchAlcoholBanner:n})=>(n?.(!t),t?s.jsx(Tbt,{children:s.jsx(_bt,{title:e,data:t,type:"image/svg+xml","data-test":"alcohol-tests-banner"})}):null),Abt=e=>({url:qe(e,"french-alcohol-tests-banner-url")||void 0,altText:qe(e,"french-alcohol-tests-banner-alternative-text")||void 0}),bbt=ke(Abt)(vbt),xbt=D("m.la.h"),gv=e=>({type:_e.PAYMENT_BUFFER_MODAL_DISPLAYED,description:"A payment buffer modal was displayed",pageEventAttributes:{...Object(e)}}),Rbt=e=>{const{actions:t,intl:n,isOpen:o=!1,openOnPageLoad:r=!1,totalBufferRate:a="0",modalLeftAlignEnabled:i=!1}=e,[l]=fe(["nfchk"]),[c,d]=h.useState(!1),u=v9e(),m=h.useCallback(()=>{r&&u(c),t.closeModal()},[t,c,r,u]),g=$Z(a),f="payment-buffer-modal-header";return s.jsxs(G,{isOpen:o,onAfterOpen:()=>t.analyticsEvent(gv({userAction:"open"})),onRequestClose:()=>{t.closeModal(),t.analyticsEvent(gv({userAction:"close",...Object(r&&{checkboxSelected:c,checkboxName:n.formatMessage("checkout.summary.modal.paymentBuffer.checkbox.label")})}))},contentLabel:"payment-buffer-modal",aria:{labelledby:f},children:[s.jsx(G.Header,{align:i?"left":"center","data-test":f,children:s.jsx(ne,{as:"h2",id:f,children:s.jsx(v,{id:"checkout.summary.modal.paymentBuffer.title",values:{bufferPercent:g}})})}),s.jsx(G.Body,{children:s.jsx(P,{asChild:!0,children:s.jsx("p",{children:s.jsx(v,{id:"checkout.summary.modal.paymentBuffer.description",values:{bufferPercent:g}})})})}),r&&s.jsxs(G.Footer,{align:i?"left":"center",flow:"column",children:[l?s.jsx(mt.Checkbox,{name:"cancelOpeningPaymentBufferModalOnLoad",value:"cancelOpeningPaymentBufferModalOnLoad","data-test":"payment-buffer-modal-checkbox","aria-label":n.formatMessage("checkout.summary.modal.paymentBuffer.checkbox.accessibility.label",{bufferPercent:g}),label:n.formatMessage("checkout.summary.modal.paymentBuffer.checkbox.label"),className:"salt-m-b--4",checked:c,onChange:()=>d(!c)}):s.jsx(mo,{name:"cancelOpeningPaymentBufferModalOnLoad","data-test":"payment-buffer-modal-checkbox","aria-label":n.formatMessage("checkout.summary.modal.paymentBuffer.checkbox.accessibility.label",{bufferPercent:g}),label:s.jsx(v,{id:"checkout.summary.modal.paymentBuffer.checkbox.label"}),input:{onChange:()=>d(!c),checked:c},whiteSpace:"pre-wrap",last:!1,bold:!0}),s.jsx(b,{intent:"primary",onClick:()=>{m(),t.analyticsEvent(gv({userAction:"continue",checkboxSelected:c,checkboxName:n.formatMessage("checkout.summary.modal.paymentBuffer.checkbox.label")}))},"data-synthetics":"payment-buffer-modal-action-button","data-test":"payment-buffer-modal-action-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.summary.modal.paymentBuffer.button"})})})]})]})},EU="paymentBuffer",Dbt=e=>({totalBufferRate:pL(e),openOnPageLoad:Vo(EU)(e),isOpen:Ue(EU)(e),modalLeftAlignEnabled:xbt(e)}),Obt=e=>({actions:Ki({closeModal:Z.closeModal,analyticsEvent:U.analyticsEvent},e)}),Pbt=Ct(Bt,ke(Dbt,Obt))(Rbt),Nbt=({title:e})=>{const t=E(e4),n=t>0;if(E(D("cs.prind"))&&n){const r=`${t+1}/${t+1}`;return s.jsx(An,{children:s.jsx(ga,{progressFraction:r,overrideText:s.jsx(ne,{as:"h1",children:e}),ringContent:s.jsx(P,{size:"l",bold:!0,children:r})})})}return s.jsx(An,{children:s.jsx(ne,{as:"h1",children:e})})},Lbt="marketingpreferences",kbt="/api/marketing-preferences",sJ="/v1/marketing-preferences-view",Mbt=ee("GET_MARKETING_PREFERENCES"),jbt=ee("UPDATE_MARKETING_PREFERENCES"),nJ={service:Lbt,pathPrefix:{client:kbt,server:"/core-api"}},wbt=()=>({type:"API",payload:{url:sJ,...nJ,...Mbt}}),Fbt=e=>({type:"API",payload:{url:sJ,...nJ,options:{body:e,method:"PUT"},...jbt}}),oJ={getMarketingPreferences:wbt,updateMarketingPreferences:Fbt},Bbt=async({context:{store:e}})=>e.dispatch(qL()),qL=()=>async e=>{try{await e(oJ.getMarketingPreferences())}catch(t){Me.api.pushError(t instanceof Error?t:new Error(`fetchPreferencesService error: ${JSON.stringify(t)}`))}},KL=()=>{const e=E(IKe),t=F();return{marketingPreferences:e,onFetchMarketingPreferences:h.useCallback(()=>t(qL()),[t])}},rJ=()=>{const e=F();return h.useCallback(t=>e(n=>n(oJ.updateMarketingPreferences(Ubt(t))).then(()=>{const o={event:"event",eventCategory:"Settings",eventAction:"UPDATE_MARKETING_PREFERENCES_SUCCESS",eventLabel:"Not Set"};return J.sendEvent({GA:o,WA:null}),n(qL()),Promise.resolve()}).catch(o=>{const r={event:"event",eventCategory:"Settings",eventAction:"UPDATE_MARKETING_PREFERENCES_ERROR",eventLabel:"Not Set"};throw J.sendEvent({GA:r,WA:null}),o})),[e])},Ubt=e=>Object.entries(e).map(([t,n])=>({preferenceId:t,isChecked:n}));function Gbt(e){const t=M();return{messages:{phoneNumberLabel:t.formatMessage("additional.details.modal.phone.number.label"),phoneFormatError:t.formatMessage("additional.details.modal.phone.format.error"),ageConfirmLabel:t.formatMessage("additional.details.modal.age.confirmation.label",{age:e}),ageConfirmRequired:t.formatMessage("additional.details.modal.age.confirmation.required",{age:e})},formatMessage:t.formatMessage}}function $bt({visibleMarketingPreferences:e,settings:{ageConfirmationRequired:t,requiredAge:n},validation:{phoneNumber:o},forwardedRef:r,onSubmit:a}){const i=Ls(),l=$o(),c=Gbt(n);function d(){const u=l.getValues();let m={phoneNumber:u.details.mobilePhone!=="",ageConfirmation:u.details.ageConfirmed};l.getFieldState("details.mobilePhone").invalid&&(m.phoneNumberError=!0),u.preferences&&(m={...m,...u.preferences}),i.saveDetailsButtonClickedEvent(m)}return s.jsxs("form",{onSubmit:l.handleSubmit(u=>{const{fields:m,...g}=u;d(),a(g)},()=>{d()}),children:[s.jsx(Jo,{name:"details.mobilePhone",label:c.messages.phoneNumberLabel,hasRequiredSymbol:!1,required:{value:!0,message:c.messages.phoneFormatError},pattern:{value:new RegExp(o),message:c.messages.phoneFormatError},"data-pii":"true","data-test":"input-details.mobilePhone"}),e.map(({preferenceId:u,label:m,description:g})=>s.jsx(fI,{name:`preferences.${u}`,label:m,description:g,"data-pii":"true"},u)),t&&s.jsx(fI,{name:"details.ageConfirmed",label:c.messages.ageConfirmLabel,required:{value:!0,message:c.messages.ageConfirmRequired},"data-pii":"true","data-test":"details.ageConfirmed"}),s.jsx("button",{type:"submit","data-test":"additional-details-form-submit",ref:r,className:"salt-d--none",children:"submit"})]})}const Hbt=(e,t)=>t.reduce((n,o)=>{const r=e.find(({id:a})=>a===o);if(r){const{id:a,checkboxText:i,descriptionText:l,isChecked:c}=r;return[...n,{preferenceId:a,label:i||"",description:l||"",value:c}]}return n},[]);function Vbt(){const e=E(mae),{marketingPreferences:{preferences:{preferences:t},isFetching:n,lastUpdated:o},onFetchMarketingPreferences:r}=KL(),a=!(o||n);h.useEffect(()=>{a&&r()},[a]);const i=Hbt(t,e);return{visiblePreferences:i,formData:h.useMemo(()=>i.reduce((l,{preferenceId:c,value:d})=>({...l,[c]:d}),{}),[o])}}const Ybt=ie.forwardRef((e,t)=>{const n=$o(),{visiblePreferences:o,formData:r}=Vbt(),a=e.customerDetails?.mobilePhone,i=E(lae),l=Cs("age-restricted-products-confirmation-age"),c=Number(l),u=Cs("age-restricted-products-should-confirm-age")==="true",[m,g]=h.useState(0);return h.useEffect(()=>{n.setValue("details.mobilePhone",a),n.setValue("preferences",r),g(m+1)},[a,r]),m?s.jsx($bt,{...e,visibleMarketingPreferences:o,forwardedRef:t,validation:{phoneNumber:i},settings:{requiredAge:c,ageConfirmationRequired:u}}):null}),fU="center",aJ=()=>{const e=M(),t=F(),n=ie.useRef(),o=Ls(),r=E(Ue("additionalDetails")),a=E(ec),i=Cs("default-mobile-phone-number-default-country"),{marketingPreferences:{lastUpdated:l}}=KL(),c=rJ(),d={phoneFormatError:e.formatMessage("additional.details.modal.phone.format.error"),modalHeader:e.formatMessage("additional.details.modal.header"),modalBodyLeader:e.formatMessage("additional.details.modal.body.leader"),modalDone:e.formatMessage("additional.details.modal.done")};h.useEffect(()=>{m(a)&&t(bs.getCurrentCustomer())},[]),h.useEffect(()=>{r&&o.userDetailsFormModalDisplayed()},[r]);const u=Gn({mode:"onSubmit"}),m=I=>!I.lastUpdated&&!I.isFetching||I.didInvalidate,g=I=>Promise.allSettled([t(bs.updateAdditionalDetails(I.details,i)),c(I.preferences)]).then(([S])=>{if(S.status==="rejected")throw S.reason;return t(bs.getCurrentCustomer())}).then(()=>t(Z.closeModal())).catch(S=>{S.statusCode===400&&u.setError("details.mobilePhone",{type:"pattern",message:d.phoneFormatError})}),f="additional-details-modal-header",y=I=>{t(Z.closeModal()),I.type==="click"?o.userDetailsFormModalClosed("cross icon"):I.type==="keydown"&&I.code==="Escape"&&o.userDetailsFormModalClosed("escape click")};return s.jsxs(G,{isOpen:r,onRequestClose:y,isLoading:!a.lastUpdated&&!l,aria:{labelledby:f},children:[s.jsx(G.Header,{align:fU,children:s.jsx(ne,{as:"h1",id:f,children:d.modalHeader})}),s.jsxs(G.Body,{children:[s.jsx(P,{className:"salt-d--block salt-m-b--4",children:d.modalBodyLeader}),s.jsx($n,{...u,children:s.jsx(Ybt,{ref:n,onSubmit:g,customerDetails:a.data})})]}),s.jsx(G.Footer,{align:fU,children:s.jsx(b,{intent:"primary",fill:!0,onClick:()=>n.current?.click(),"data-test":"done-button",children:s.jsx(b.Text,{children:d.modalDone})})})]})},Wbt=()=>{const e=F(),t=()=>{e(Z.openModal("additionalDetails"))};return s.jsxs(h.Fragment,{children:[s.jsx(Y,{className:"salt-m-t--4",children:s.jsxs(Y.Item,{colStart:{sm:2,md:4},colSpan:{xs:12,sm:10,md:6},children:[s.jsx(Ce,{intent:"warning",showIcon:!1,text:s.jsx(v,{id:"additional.details.checkout.page.message"}),className:"salt-m-t--8"}),s.jsx(se,{justify:"center",children:s.jsx(b,{intent:"primary",onClick:t,className:"salt-m-t--4",children:s.jsx(b.Text,{children:s.jsx(v,{id:"additional.details.page.button"})})})})]})}),s.jsx(aJ,{})]})};let qbt=class extends h.Component{formattedMessages;paymentSectionRef;ageConfirmationFormRef;recurringShoppingSectionRef;billingAddressSectionRef;paymentSession;constructor(t){super(t),this.isBasketLoading=this.isBasketLoading.bind(this),this.setIsWaiting=this.setIsWaiting.bind(this),this.setUnresolvableCheckoutErrorAlert=this.setUnresolvableCheckoutErrorAlert.bind(this),this.setSelectedWalletItem=this.setSelectedWalletItem.bind(this),this.setSelectedPaymentMethodExternalWallet=this.setSelectedPaymentMethodExternalWallet.bind(this),this.toggleCollapsibleSummaryBoxState=this.toggleCollapsibleSummaryBoxState.bind(this),this.scrollToPaymentSection=this.scrollToPaymentSection.bind(this),this.scrollToRecurringShoppingDefinitionCreateSection=this.scrollToRecurringShoppingDefinitionCreateSection.bind(this),this.sendSummaryToggledAnalyticsEvent=this.sendSummaryToggledAnalyticsEvent.bind(this),this.isSelectedRecurringShoppingDefinitionFrequencyDefined=this.isSelectedRecurringShoppingDefinitionFrequencyDefined.bind(this),this.displayPaymentCheckNotificationFetchingAvailability=this.displayPaymentCheckNotificationFetchingAvailability.bind(this),this.sendVouchersAddedToOrderAnalyticsEvent=this.sendVouchersAddedToOrderAnalyticsEvent.bind(this),this.toggleAgeConfirmationCheckbox=this.toggleAgeConfirmationCheckbox.bind(this),this.setAgeConfirmationError=this.setAgeConfirmationError.bind(this),this.setPsp=this.setPsp.bind(this),this.onPaymentSessionEvent=this.onPaymentSessionEvent.bind(this),this.fetchCheckoutBasketWithDeliveryInfo=this.fetchCheckoutBasketWithDeliveryInfo.bind(this),this.scrollToBillingAddressSection=this.scrollToBillingAddressSection.bind(this),this.openModalAdditionalDetails=this.openModalAdditionalDetails.bind(this),this.fetchOrderInEditOrderMode=this.fetchOrderInEditOrderMode.bind(this),this.setFinancingProviderNotSelectedError=this.setFinancingProviderNotSelectedError.bind(this),this.setIsMissingFrenchAgeRestriction=this.setIsMissingFrenchAgeRestriction.bind(this),this.setIsMissingFrenchAlcoholBanner=this.setIsMissingFrenchAlcoholBanner.bind(this),this.setIsFooterEmpty=this.setIsFooterEmpty.bind(this),this.formattedMessages={paymentTitle:t.intl.formatMessage("checkout.summary.payment.method.title"),button:t.intl.formatMessage("checkout.summary.next.line1"),buttonLine2:t.intl.formatMessage("checkout.summary.next.line2"),processingOrder:t.intl.formatMessage("checkout.processing.text"),title:t.intl.formatMessage("checkout.summary.title"),summaryTitle:t.intl.formatMessage("summary.title"),summaryContractLabel:t.intl.formatMessage("summary.component.accessibility.toggle.switch.off.label"),summaryExpandLabel:t.intl.formatMessage("summary.component.accessibility.toggle.switch.on.label")},this.state={isWaiting:!1,walletItemId:null,isUnsavedPaymentMethodSelected:!1,isFinancingProviderNotSelectedError:!1,expanded:!1,loadedViewPortSize:!1,psp:null,selectedExternalWalletPaymentMethod:null,shouldShowUnresolvableErrorAlert:!1,checkoutErrorMessage:"",isCheckoutBasketFetchedOrFetching:!1,ageConfirmed:!1,isAgeConfirmationError:!1,pharmacyReady:!1,orderDetailsReady:!1,paymentChecksFetchedOrFetching:!1,isMissingFrenchAgeRestriction:!1,isMissingFrenchAlcoholBanner:!1,isFooterEmpty:!1},this.paymentSectionRef=ie.createRef(),this.recurringShoppingSectionRef=ie.createRef(),this.ageConfirmationFormRef=ie.createRef(),this.billingAddressSectionRef=ie.createRef(),this.paymentSession=new VL,t.isPaymentAuthenticationInModalEnabled||this.paymentSession.subscribe(this.onPaymentSessionEvent)}componentDidMount(){const{skipPaymentBufferModalOnPageLoad:t,actions:n,externalWalletManagement:o,isPaymentBufferModalOnLoadEnabled:r,basketSummary:a,isExternalWalletPaymentSelectorEnabled:i,pharmacyEnabled:l,additionalDetails:c,additionalDetailsPopUpSummaryEnabled:d,isPaymentCheckoutSummaryV2Enabled:u,paymentCheckoutSummaryIsFetching:m,navigate:g,isCollapseAllByDefaultEnabled:f}=this.props;d&&(!c.lastUpdated&&!c.isFetching||c.didInvalidate?n.fetchAdditionalDetailsRequired():c.required&&this.openModalAdditionalDetails()),a.fetchErrorCheckoutBasket&&g("/basket",{state:{notification:{type:"error",message:"toast.notification.generic.error"}}}),n.fetchProductEntitiesFromBasket().then(()=>{l&&this.setState({pharmacyReady:!0})}),n.performanceMark({name:$Te}),n.analyticsEvent({type:_e.CHECKOUT_SUMMARY_DISPLAYED});const y={event:"event",ecommType:"enhanced",eventCategory:"Checkout Funnel",eventLabel:"Not Set",eventAction:"CheckoutSummary",ecommerce:{checkout:{actionField:{step:4},products:this.props.basketProducts?.map(S=>Ys(S))}}};J.sendEvent({GA:y,WA:null}),a.isFetchingCheckoutBasket?this.setState({isCheckoutBasketFetchedOrFetching:!0}):this.fetchCheckoutBasketWithDeliveryInfo(),n.fetchActivePsps();const I=typeof window<"u"&&window.matchMedia(`(min-width: ${Ke.md}em)`).matches;if(this.setState({expanded:I&&!f,loadedViewPortSize:!0}),r&&!t&&n.openPaymentBufferModal({openOnPageLoad:!0}),o&&!i){n.analyticsEvent({type:_e.SELECT_PAYMENT});const S={event:"event",ecommType:"enhanced",eventCategory:"Checkout Funnel",eventLabel:"Not Set",eventAction:"PaymentSelected",ecommerce:{checkout:{actionField:{step:5},products:this.props.basketProducts?.map(C=>Ys(C))}}};J.sendEvent({GA:S,WA:null})}n.analyticsEvent({type:As.PAGE_ATTRIBUTES_MULTIPLE,attributes:{IS_EXTERNAL_PAYMENT:o}}),this.sendVouchersAddedToOrderAnalyticsEvent(),this.fetchOrderInEditOrderMode(),m||(u?n.fetchOrderPaymentCheckoutSummaryWithPaymentMethodGroups():n.fetchOrderPaymentCheckoutSummary())}componentDidUpdate(t){const{actions:n,basketSummary:o,isCheckoutSummaryInvoiceModalOpen:r,isAgeConfirmationEnabled:a,additionalDetails:i,additionalDetailsPopUpSummaryEnabled:l,navigate:c}=this.props;l&&i.required!==t.additionalDetails.required&&i.required&&this.openModalAdditionalDetails();const{selectedExternalWalletPaymentMethod:d}=this.state,u=!this.isSelectedRecurringShoppingDefinitionFrequencyDefined(t)&&this.isSelectedRecurringShoppingDefinitionFrequencyDefined(this.props);this.shouldShowExternalWalletPaymentSelector()&&u&&!r&&d===at.CARDS&&n.openCheckoutSummaryInvoiceModal(),o.fetchErrorCheckoutBasket&&!t.basketSummary.fetchErrorCheckoutBasket&&c("/basket",{state:{notification:{type:"error",message:"toast.notification.generic.error"}}}),$i(o.vouchers,t.basketSummary.vouchers)||this.sendVouchersAddedToOrderAnalyticsEvent(),a&&!o.isFetchingCheckoutBasket&&t.basketSummary.isFetchingCheckoutBasket&&n.analyticsEvent({type:As.PAGE_ATTRIBUTES_MULTIPLE,attributes:{AGE_CHECK_REQUIRED:!!o.ageRestriction}}),this.fetchOrderInEditOrderMode(),!this.isBasketLoading()&&!this.state.paymentChecksFetchedOrFetching&&this.displayPaymentCheckNotificationFetchingAvailability();const m=this.state.isMissingFrenchAgeRestriction&&this.state.isMissingFrenchAlcoholBanner;m!==this.state.isFooterEmpty&&this.setIsFooterEmpty(m)}componentWillUnmount(){this.paymentSession.unsubscribe(this.onPaymentSessionEvent)}onPaymentSessionEvent({eventType:t,payload:n}){switch(t){case an.PAYMENT_REQUESTED:this.setIsWaiting();break;case an.PAYMENT_CANCELLED:this.setIsWaiting();break;case an.INITIATE_AUTHENTICATION:this.onPaymentAuthenticationInitiated({eventType:t,payload:n});break}}fetchCheckoutBasketWithDeliveryInfo(){const{actions:t,isUsePaymentChecksEnabled:n}=this.props;t.getCheckoutBasket({...n&&{fetchAllocatedPaymentChecks:!0}}).then(()=>{t.getConciergeDelivery(),this.setState({isCheckoutBasketFetchedOrFetching:!0}),n&&this.displayPaymentCheckNotificationFetchingAvailability()})}onPaymentAuthenticationInitiated({payload:t}){const{authenticationUrl:n}=t;this.props.navigate(eie(),{state:{pspweb:{url:n}}})}fetchOrderInEditOrderMode(){const{actions:t,basketSummary:n,order:o}=this.props;n.basketStatus==="ORDER_EDIT"&&!this.state.orderDetailsReady&&!o.isFetching&&!o.fetchError&&t.getOrder(n.orderId).then(()=>{this.setState({orderDetailsReady:!0})})}displayPaymentCheckNotificationFetchingAvailability(){const{actions:t,appliedPaymentChecks:n,basketSummary:o,isUsePaymentChecksEnabled:r,removedPaymentChecks:a}=this.props,i=a&&a.length>=1;!r||this.isSelectedRecurringShoppingDefinitionFrequencyDefined(this.props)||o.basketStatus==="ORDER_EDIT"&&(!this.state.orderDetailsReady||this.isRecurringOrder())||(this.setState({paymentChecksFetchedOrFetching:!0}),i?(z.warning("checkout.summary.bonus.check.redeem.error.toast"),t.analyticsEvent({type:_e.TOAST_NOTIFICATION_DISPLAYED,description:"A toast notification was displayed",pageEventAttributes:{status:"PAYMENT_CHECK_BELOW_THE_THRESHOLD"}})):(!n||n.length<1)&&t.fetchAvailablePaymentChecks({basketTotal:o?.totals?.finalPrice,orderId:o.orderId}).then(l=>{if(l&&l.payload&&l.payload.responseData){const{availablePaymentChecks:c}=l.payload.responseData;c&&c.length>=1&&(z.info("checkout.summary.bonus.check.available.toast"),t.analyticsEvent({type:_e.TOAST_NOTIFICATION_DISPLAYED,description:"A toast notification was displayed",pageEventAttributes:{status:"PAYMENT_CHECK_AVAILABLE"}}))}}))}isBasketLoading(){const{basketSummary:t}=this.props,{isCheckoutBasketFetchedOrFetching:n}=this.state;return!t||t.isFetching||!n||t.isFetchingCheckoutBasket}setSelectedWalletItem({walletItemId:t,isUnsavedPaymentMethodSelected:n}){this.setState({walletItemId:t,isUnsavedPaymentMethodSelected:n},()=>{const{actions:o,locationPath:r}=this.props;o.analyticsEvent({type:xt.SELECT_WALLET_ITEM,description:"User selected payment method",pageEventAttributes:{page:r,walletItemId:t||"NOT_SAVED"}});const a={event:"event",eventCategory:"Payment",eventAction:"SelectWalletItem",eventLabel:r,walletItemId:t||"NOT_SAVED"};J.sendEvent({GA:a,WA:null}),o.analyticsEvent({type:_e.SELECT_PAYMENT});const i={event:"event",ecommType:"enhanced",eventCategory:"Checkout Funnel",eventLabel:"Not Set",eventAction:"PaymentSelected",ecommerce:{checkout:{actionField:{step:5},products:this.props.basketProducts?.map(l=>Ys(l))}}};J.sendEvent({GA:i,WA:null})})}setSelectedPaymentMethodExternalWallet(t){const{actions:n}=this.props;t===at.CARDS?(n.setPaymentOptionAndType({paymentOption:ct.PAY_NOW,paymentType:at.UNKNOWN}),this.setState({selectedExternalWalletPaymentMethod:t})):t===at.INVOICE&&(n.setPaymentOptionAndType({paymentOption:ct.B2B_DEFERRED_PAYMENT,paymentType:at.INVOICE}),this.setState({selectedExternalWalletPaymentMethod:t})),n.analyticsEvent({type:_e.SELECT_PAYMENT});const o={event:"event",ecommType:"enhanced",eventCategory:"Checkout Funnel",eventLabel:"Not Set",eventAction:"PaymentSelected",ecommerce:{checkout:{actionField:{step:5},products:this.props.basketProducts?.map(r=>Ys(r))}}};J.sendEvent({GA:o,WA:null})}shouldShowExternalWalletPaymentSelector(){const{isExternalWalletPaymentSelectorEnabled:t,externalWalletManagement:n}=this.props;return t&&n}setIsWaiting(){return new Promise(t=>{this.setState(n=>({isWaiting:!n.isWaiting}),()=>t())})}setFinancingProviderNotSelectedError(){this.setState({isFinancingProviderNotSelectedError:!0})}setUnresolvableCheckoutErrorAlert(t){const{intl:n}=this.props,o=n.formatMessage(t);this.setState({shouldShowUnresolvableErrorAlert:!0,checkoutErrorMessage:o})}toggleAgeConfirmationCheckbox(){const{actions:t}=this.props;this.state.ageConfirmed||t.analyticsEvent({type:_e.AGE_CHECK_CONFIRMED}),this.setState(n=>({ageConfirmed:!n.ageConfirmed,isAgeConfirmationError:!1}))}setAgeConfirmationError(){this.ageConfirmationFormRef.current?.scrollIntoView({block:"center",behavior:"smooth"}),this.setState({isAgeConfirmationError:!0})}scrollToPaymentSection(){this.paymentSectionRef.current.scrollIntoView({block:"center",behavior:"smooth"})}scrollToRecurringShoppingDefinitionCreateSection(){this.recurringShoppingSectionRef.current.scrollIntoView({block:"center",behavior:"smooth"})}scrollToBillingAddressSection(){this.billingAddressSectionRef.current.scrollIntoView({block:"center",behavior:"smooth"})}isSelectedRecurringShoppingDefinitionFrequencyDefined(t){return t.isRecurringOrdersEnabled&&!!t.selectedRecurringShoppingDefinitionCreateFrequency&&t.selectedRecurringShoppingDefinitionCreateFrequency!==Lo}sendVouchersAddedToOrderAnalyticsEvent(){const{actions:t,basketSummary:{vouchers:n}}=this.props,o=(n||[]).map(({voucherId:r})=>r);t.analyticsEvent({type:_e.VOUCHERS_ADDED_TO_ORDER,voucherIds:o})}sendSummaryToggledAnalyticsEvent(t){const{actions:n}=this.props,o=t?Wn.SUMMARY_COMPONENT_COLLAPSED:Wn.SUMMARY_COMPONENT_EXPANDED,r=t?"User collapsed the summary component":"User expanded the summary component";n.analyticsEvent({type:o,description:r})}toggleCollapsibleSummaryBoxState(t){const{expanded:n}=this.state;this.sendSummaryToggledAnalyticsEvent(n),t.preventDefault(),this.setState(o=>({expanded:!o.expanded}))}renderSpinner(){return s.jsx(Rs.WithCustomCaption,{size:"l",className:"salt-m-t--32",children:this.formattedMessages.processingOrder})}isRecurringOrder(){const{order:t}=this.props;return!!t.order?.recurringShoppingDefinition}isOrderUnderEdit(){const{order:t}=this.props;return t.order?.editStatus==="UNDER_EDIT"}setPsp(t,n){this.setState({psp:t},()=>{n()})}setIsMissingFrenchAgeRestriction(t){this.setState({isMissingFrenchAgeRestriction:t})}setIsMissingFrenchAlcoholBanner(t){this.setState({isMissingFrenchAlcoholBanner:t})}setIsFooterEmpty(t){this.setState({isFooterEmpty:t})}renderPage(){const{basketSummary:t,pharmacyEnabled:n,order:o,totalBufferRate:r}=this.props,{psp:a,walletItemId:i,expanded:l,loadedViewPortSize:c,ageConfirmed:d,checkoutErrorMessage:u,shouldShowUnresolvableErrorAlert:m,isAgeConfirmationError:g,isUnsavedPaymentMethodSelected:f,pharmacyReady:y,isFinancingProviderNotSelectedError:I}=this.state;return!t.slot&&!t.isFetchingCheckoutBasket&&t.lastCheckoutBasketUpdated?s.jsx(NX,{}):s.jsxs(lZ.Provider,{value:{ageConfirmed:d},children:[s.jsx(rs,{title:"checkout.summary.title"}),s.jsx(Nbt,{title:this.formattedMessages.title}),s.jsx("div",{className:"salt-m-x--2 salt-m-b--2",children:s.jsx(kAt,{shouldShowExternalWalletPaymentSelector:this.shouldShowExternalWalletPaymentSelector(),isSelectedRecurringShoppingDefinitionFrequencyDefined:this.isSelectedRecurringShoppingDefinitionFrequencyDefined(this.props),basketSummary:t,ageConfirmationFormRef:this.ageConfirmationFormRef,ageConfirmed:d,checkoutErrorMessage:u,isAgeConfirmationError:g,shouldShowUnresolvableErrorAlert:m,toggleAgeConfirmationCheckbox:this.toggleAgeConfirmationCheckbox,paymentSectionRef:this.paymentSectionRef,setSelectedWalletItem:this.setSelectedWalletItem,setSelectedPaymentMethodExternalWallet:this.setSelectedPaymentMethodExternalWallet,isBasketLoading:this.isBasketLoading(),recurringShoppingSectionRef:this.recurringShoppingSectionRef,psp:a,expanded:l,formattedMessages:this.formattedMessages,isUnsavedPaymentMethodSelected:f,scrollToPaymentSection:this.scrollToPaymentSection,scrollToRecurringShoppingDefinitionCreateSection:this.scrollToRecurringShoppingDefinitionCreateSection,loadedViewPortSize:c,setAgeConfirmationError:this.setAgeConfirmationError,setUnresolvableCheckoutErrorAlert:this.setUnresolvableCheckoutErrorAlert,toggleCollapsibleSummaryBoxState:this.toggleCollapsibleSummaryBoxState,walletItemId:i,setPsp:this.setPsp,paymentSession:this.paymentSession,billingAddressRef:this.billingAddressSectionRef,scrollToBillingAddressSection:this.scrollToBillingAddressSection,orderBillingAddress:{billingAddressId:o?.order?.billingAddressDetails?.billingAddressId,...o?.order?.billingAddressDetails?.addressDetails,...o?.order?.billingAddressDetails?.customerDetails},totalBufferRate:r,setFinancingProviderNotSelectedError:this.setFinancingProviderNotSelectedError,isFinancingProviderNotSelectedError:I,fetchCheckoutBasketWithDeliveryInfo:this.fetchCheckoutBasketWithDeliveryInfo})}),r&&s.jsx(Pbt,{}),n&&y?s.jsx(obt,{basket:t}):null,!this.state.isFooterEmpty&&s.jsx(Zn,{}),s.jsx(Y,{fixed:!0,children:s.jsxs(Y.Item,{className:"md:salt-p-x--2",colSpan:{xs:12},children:[s.jsx(tZ,{setIsMissingFrenchAgeRestriction:this.setIsMissingFrenchAgeRestriction}),s.jsx(bbt,{setIsMissingFrenchAlcoholBanner:this.setIsMissingFrenchAlcoholBanner})]})}),s.jsx(yIt,{}),s.jsx(hCt,{})]})}openModalAdditionalDetails(){const{actions:t}=this.props;t.openAdditionalDetailsModal()}render(){const{isWaiting:t}=this.state,{isPaymentAuthenticationInModalEnabled:n}=this.props;return s.jsxs(ie.Fragment,{children:[t?this.renderSpinner():this.renderAdditionalDetailsPage(),n&&s.jsx(Cbt,{paymentSession:this.paymentSession})]})}renderAdditionalDetailsPage(){return s.jsx(ie.Fragment,{children:this.props.additionalDetails.required&&this.props.additionalDetailsPopUpSummaryEnabled?s.jsx(Wbt,{}):this.renderPage()})}};const Kbt=e=>({basketProducts:Jn(e)}),zbt=ot({analyticsEvent:U.analyticsEvent,getCheckoutBasket:Ht.getCheckoutBasket,getConciergeDelivery:eZ.getConciergeDelivery,fetchActivePsps:ZX.fetchActivePsps,fetchAvailablePaymentChecks:gL.fetchAvailablePaymentChecks,openCheckoutSummaryInvoiceModal:()=>Z.openModal("checkoutSummaryInvoice"),openPaymentBufferModal:({openOnPageLoad:e})=>Z.openModal("paymentBuffer",e),performanceMark:ks,openAdditionalDetailsModal:()=>Z.openModal("additionalDetails"),addLoyaltyUnitsToBasket:kh.addLoyaltyUnitsToBasket,removeVoucherFromBasket:EI.removeVoucherFromBasket,removedAppliedPaymentChecksFromBasket:bO.removedAppliedPaymentChecksFromBasket,removeLoyaltyUnitsFromBasket:kh.removeLoyaltyUnitsFromBasket,getOrder:Wo.getOrder,getRecurringShoppingDefinitions:qa.getRecurringShoppingDefinitions,fetchProductEntitiesFromBasket:nc,setPaymentOptionAndType:kt.setPaymentOptionAndType,fetchAdditionalDetailsRequired:bs.getRequiresAdditionalDetails,fetchOrderPaymentCheckoutSummary:Dr.getPaymentCheckoutSummary,fetchOrderPaymentCheckoutSummaryWithPaymentMethodGroups:Mo.getOrderPaymentCheckoutSummaryWithPaymentMethodGroups}),Qbt=ke(Kbt,zbt)(qbt),Xbt=D("pay.ew"),Zbt=D("rec.o"),Jbt=D("pay.invoice"),ext=D("pb.pl"),txt=D("pay.check.use"),sxt=D("ag"),nxt=D("pay.pam"),oxt=D("cs.phm"),rxt=D("sb.pop"),axt=D("pcs.v2"),ixt=D("pay.ywlt"),lxt=D("ord.def.col"),cxt=()=>{const e=M(),t=We(),n=E(Xbt),o=E(Zbt),r=E(Jbt),a=E(ext),i=E(txt),l=E(sxt),c=E(nxt),d=E(oxt),u=E(rxt),m=E(_p),g=E(w=>Zt(w)),f=E(pL),y=E(Rg),I=E(ITe),S=E($0),C=E(rx),_=E(Ds),A=E(xC),x=E(gH),R=E(Ue("checkoutSummaryInvoice")),O=E(axt),N=E(ixt),k=E(qX),j=E(lxt);return s.jsx(iSt,{children:s.jsx(Qbt,{intl:e,navigate:t,externalWalletManagement:n,isRecurringOrdersEnabled:o,isExternalWalletPaymentSelectorEnabled:r,isPaymentBufferModalOnLoadEnabled:a,isUsePaymentChecksEnabled:i,isAgeConfirmationEnabled:l,isPaymentAuthenticationInModalEnabled:c,pharmacyEnabled:d,additionalDetailsPopUpSummaryEnabled:u,locationPath:m,basketSummary:g,selectedRecurringShoppingDefinitionCreateFrequency:y,skipPaymentBufferModalOnPageLoad:I,removedPaymentChecks:S,appliedPaymentChecks:C,order:_,allRecurringDefinitions:A,additionalDetails:x,isCheckoutSummaryInvoiceModalOpen:R,totalBufferRate:f,isPaymentCheckoutSummaryV2Enabled:O,isYourWalletEnabled:N,paymentCheckoutSummaryIsFetching:k,isCollapseAllByDefaultEnabled:j})})},iJ=()=>s.jsx(os,{type:"CheckoutSummary::route",children:s.jsx(cxt,{})});iJ.fetchData=({context:{store:e}})=>e.dispatch(sm.getWalletItems());const dxt=()=>{const t={summaryRedirectWarningLinkText:M().formatMessage("checkout.3ds.summary.redirect.warning.link.text")},n=E(D("dcca")),{handlePaymentAuthenticationSuccess:o,canCheckout:r}=NL(),a=We(),i=Ne(),[l,c]=h.useState(!1);h.useEffect(()=>{n?c(!0):r().finally(()=>c(!0))},[]);const d=({errorParam:u})=>a(tr({queryString:u}));return l?s.jsx(kT,{messageCallback:o,errorCallback:d,redirectUrlConfig:{url:tr(),text:t.summaryRedirectWarningLinkText},location:i}):s.jsx(Rs,{size:"l",className:"salt-m-t--32"})},yU=()=>s.jsx(os,{type:"CheckoutPaymentAuthenticationScene::route",children:s.jsx(dxt,{})}),uxt=({paymentAmountSplitPerMethods:e=[]})=>{const t=e.find(o=>o.paymentMethodCategory==="LOYALTY"),n=t&&t.total?t.total.amount:null;return n?s.jsx(yI,{action:()=>{},type:"payment-details-loyalty",readOnly:!0,children:s.jsx(v,{id:"checkout.summary.discounts.loyalty.redeemed",values:{loyaltyRedeemed:n}})}):null},pxt=T(P)`
    max-inline-size: 100%;
`,Qd=({paymentInfo:e,inline:t=!1})=>{const n=E(yae),o=mxt(e,n),{formatMessage:r}=M(),a=i=>{const{paymentMethodV2:l,cardType:c,lastFourDigits:d,expiryMonth:u,expiryYear:m,emailAddress:g}=i;if(l==="PAYPAL")return g?r("order.online.receipt.payment.accessibility.paypal",{emailAddress:g}):r("order.online.receipt.payment.accessibility.paypal.fallback");if(l?.includes("CARD")){if(!c&&!d&&!u&&!m)return r("order.online.receipt.payment.accessibility.card.fallback");if(c&&d&&u&&m)return r("order.online.receipt.payment.accessibility.card",{cardType:c,last4Digits:d,cardExpiryDate:`${u}/${m}`});let f="";if(c&&(f+=c),d){const y=r("order.online.receipt.payment.accessibility.cardEnding",{last4Digits:d});f+=(f?" ":"")+y}if(u&&m){const y=r("order.online.receipt.payment.accessibility.cardExpiryDate",{cardExpiryDate:`${u}/${m}`});f+=(f?" ":"")+y}return f}return l};return s.jsx(pxt,{"data-test":"payment-info-label",children:t?s.jsxs(zs,{as:"span",direction:"row",align:"center",gap:["sm"],wrap:"nowrap",children:[o&&s.jsx(wh,{paymentInfo:e,iconAriaLabel:a(e)}),s.jsx(Dh,{paymentInfo:e})]}):s.jsxs(h.Fragment,{children:[o&&s.jsxs(h.Fragment,{children:[s.jsx(wh,{paymentInfo:e,iconAriaLabel:a(e)}),s.jsx("br",{})]}),s.jsx(Dh,{paymentInfo:e})]})})},mxt=({paymentMethodV2:e,cardType:t},n)=>!(hxt(e,n)||gxt({paymentMethodType:e,cardType:t})),hxt=(e,t)=>{switch(e){case at.CASH_ON_DELIVERY:return!0;case at.INVOICE:return!t;default:return!1}},gxt=({paymentMethodType:e,cardType:t})=>e===at.CARDS&&t===void 0,Ext=({paymentInfo:e})=>s.jsx(ve,{children:s.jsx(Qd,{paymentInfo:e})}),fxt={paymentInfo:null},lJ=({paymentInfo:e})=>e?s.jsxs(ve,{"data-test":"payment-method",children:[s.jsx(ne,{as:"h2",className:"salt-m-b--4",children:s.jsx(v,{id:"checkout.complete.payment.title"})}),s.jsx("div",{className:"salt-m-b--4",children:s.jsx(uxt,{paymentAmountSplitPerMethods:e.paymentAmountSplitPerMethods})}),s.jsx(Ext,{paymentInfo:e})]}):null;lJ.defaultProps=fxt;const IU=({navigate:e})=>{const t=()=>{e(pn())};return s.jsxs(ve,{children:[s.jsx("div",{className:"salt-m-b--4",children:s.jsx(P,{children:s.jsx(v,{id:"checkout.complete.action.buttons.header"})})}),s.jsx(b,{intent:"secondary",fill:!0,"data-test":"back-to-shop-button",onClick:t,children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.complete.back.to.shop"})})})]})},cJ="mergeCartWithEditOrder",dJ=V(D("mcweo"),zl,(e,t)=>e&&!!t?.length),uJ=e=>{const t=F();return()=>{t(Z.openModal(cJ,{orderId:e})),t(U.analyticsEvent({type:Te.ADD_PRODUCT_TO_ORDER_MODAL_DISPLAYED,orderId:e}))}},zL=({redirectToDetails:e=!1})=>{const t=E(Ds),n=We(),o=t?.order,r=o?.orderId,i=E(Zt)?.checkoutCorrelationId,{formatMessage:l}=M(),c=F(),d=E(Ue(cJ)),u=E(D("m.la.h")),m=async()=>{c(U.analyticsEvent({type:Te.CLOSE_BUTTON_CLICKED,checkoutCorrelationId:i})),c(Z.closeModal())},g=async()=>{c(U.analyticsEvent({type:Te.NOT_NOW_BUTTON_CLICKED,orderId:r})),c(Z.closeModal()),await c(di.getPendingOrders()),r&&await c(ci.editOrder(r,n,{redirectToDetails:e,mergeBasket:!1}))},f=async()=>{c(Z.closeModal()),await c(di.getPendingOrders()),r&&await c(ci.editOrder(r,n,{redirectToDetails:e,mergeBasket:!0}))},y=E(Jt),I=E(Vt),S=pK({dateIsoFrom:o?.dates?.deliveryStartDate,dateIsoTo:o?.dates?.deliveryEndDate,timeZoneId:o?.dates?.timeZoneId||"UTC",dateFormat:y,timeFormat:I});return s.jsx(G,{isOpen:d,onRequestClose:m,children:s.jsxs(G.ModalForm,{"data-test":"merge-cart-with-edit-order-modal",children:[s.jsxs(G.Header,{align:u?"left":"center",children:[s.jsx(ne,{as:"h1","aria-hidden":!0,children:l("merge-cart-with-edit-order.merge-cart-modal.title")}),s.jsx(Ee,{children:l("merge-cart-with-edit-order.merge-cart-modal.title.aria.label")})]}),s.jsx(G.Body,{children:l("merge-cart-with-edit-order.merge-cart-modal.alert.text",{date:S})}),s.jsxs(G.Footer,{align:u?"left":"center",className:"salt-gap-x--2",children:[s.jsx(b,{intent:"secondary",onClick:g,fill:!0,"data-test":"merge-cart-with-edit-order-modal-cancel-button",children:s.jsx(b.Text,{children:l("merge-cart-with-edit-order.merge-cart-modal.cancel-button")})}),s.jsx(b,{intent:"primary",onClick:f,fill:!0,"data-test":"merge-cart-with-edit-order-modal-confirm-button",children:s.jsx(b.Text,{children:l("merge-cart-with-edit-order.merge-cart-modal.confirm-button")})})]})]})})},QL=({orderId:e,redirectToDetails:t=!1,sendPageView:n})=>{const o=M(),r=F(),a=We(),i=E(dJ),l=ts(),[c,d]=h.useState(!1),u=E(Ue("editOrder")),[m,g,f]=fe(["m.la.h","oed","nfchk"]),y=E(W$e),I=A9e(),S=uL(),C=YN(),_="edit-order-modal-header",A=()=>{l({type:js.EDIT_ORDER_BUTTON_CLICKED,orderId:e,userAction:"Close"}),r(Z.closeModal());const j={event:"event",ecommType:"enhanced",eventCategory:"E-commerce",eventLabel:"edit-order-clicked",eventAction:"EditOrderButtonClicked",ecommerce:{transactionId:e}};J.sendEvent({GA:j,WA:null})},x=(j,w)=>s.jsxs(se,{wrap:"nowrap",className:"salt-m-t--4 salt-m-b--8",children:[s.jsx("div",{className:"salt-m-x--2",children:s.jsx(me,{height:25,width:25,name:j})}),s.jsx(v,{id:w})]}),R=()=>{d(!c)},O=async()=>{await r(di.getPendingOrders()),await r(ci.editOrder(e,a,{redirectToDetails:t})),n&&C()},N=uJ(e),k=async()=>{I(c),r(Z.closeModal()),l({type:js.EDIT_ORDER_BUTTON_CLICKED,orderId:e});const j={event:"event",ecommType:"enhanced",eventCategory:"E-commerce",eventLabel:"edit-order-clicked",eventAction:"EditOrderButtonClicked",ecommerce:{transactionId:e}};if(J.sendEvent({GA:j,WA:null}),i)N();else{l({type:js.EDIT_ORDER_GA4,orderId:e,groupId:S});const w={event:"edit_order",osp_transaction_id:e,group_id:S};J.sendEvent({GA:w,WA:null}),O()}};return s.jsxs(G,{isOpen:u,onRequestClose:A,aria:{labelledby:_},children:[s.jsx(G.Header,{align:m?"left":"center",children:s.jsx(ne,{as:"h2",id:_,children:o.formatMessage("edit.order.modal.title")})}),s.jsxs(G.Body,{children:[x("orders_edit","edit.order.modal.info.save.changes"),x("slot","edit.order.modal.info.save.slot"),x("payment_card",g&&y?"edit.order.modal.info.charged.or.refunded":"edit.order.modal.info.charged"),s.jsx(Ce,{className:"salt-m-y--8",intent:"warning",text:s.jsx(v,{id:"edit.order.modal.warning"})}),f?s.jsx(mt.Checkbox,{label:o.formatMessage("edit.order.modal.checkbox"),"data-test":"edit-order-modal-checkbox",name:"edit-order-modal-checkbox",value:"edit-order-modal-checkbox",checked:c,onChange:R,className:"salt-m-l--2"}):s.jsx(mo,{label:o.formatMessage("edit.order.modal.checkbox"),input:{checked:c,onChange:R},bold:!1,"data-test":"edit-order-modal-checkbox",className:"salt-m-l--2"})]}),s.jsxs(G.Footer,{align:m?"left":"center",className:"salt-gap-x--2",children:[s.jsx(b,{fill:!0,intent:"secondary",onClick:A,"data-test":"edit-order-cancel-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"edit.order.modal.cancel"})})}),s.jsx(b,{fill:!0,intent:"primary",onClick:k,"data-test":"edit-order-continue-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"edit.order.modal.continue"})})})]})]})},SU=()=>{const e=M(),t=F(),n=We(),o=E(Jt),r=E(Vt),a=E(B$e),i=E(u2);if(!a)return s.jsx(Ns.Skeleton,{});const{orderId:l,confirmOrderChangesBy:c,timeZoneId:d}=a;if(!c)return null;const u={editOrder:e.formatMessage("checkout.complete.edit.order"),editOrderUntil:e.formatMessage("checkout.complete.edit.order.until")},m=()=>{t(U.analyticsEvent({type:js.EDIT_ORDER_BUTTON_CLICKED,orderId:l}));const g={event:"event",ecommType:"enhanced",eventCategory:"E-commerce",eventLabel:"edit-order-clicked",eventAction:"EditOrderButtonClicked",ecommerce:{transactionId:l}};J.sendEvent({GA:g,WA:null}),t(i?ci.editOrder(l,n,{redirectToDetails:!0,mergeBasket:!1}):Z.openModal("editOrder",{orderId:l}))};return s.jsxs(ve,{className:"salt-m-b--4",children:[s.jsx(P,{className:"salt-d--block",children:u.editOrderUntil}),s.jsx(P,{asChild:!0,size:"m",bold:!0,children:s.jsx("strong",{children:s.jsx(El,{dateIso:c,timeZoneId:d,local:!0,dateFormat:o,timeFormat:r})})}),Ge.utc().isBefore(c)?s.jsx(b,{intent:"secondary",fill:!0,"data-test":"edit-order-button",onClick:m,className:"salt-m-t--4",children:s.jsx(b.Text,{children:u.editOrder})}):null,s.jsx(QL,{orderId:l,redirectToDetails:!0}),s.jsx(zL,{redirectToDetails:!0})]})},yxt=vo(["loyalty","loyred"]),Ixt=D("pay.check.use"),Sxt=D("pay.check.show"),Cxt=Dn(["sumsub","bt.spl"]),Txt=D("cs.ps"),_xt=D("or.ph"),CU=e=>{const{paymentSummary:t,withTaxNote:n=!1,page:o}=e,r=t.deliveryPromotions,{paymentInfo:a}=t||{},{paymentAmountSplitPerMethods:i}=a||{},l=E(D("prp")),c=E(D("sib")),d=E(j=>BD(j)||0),u=E(j=>yxt(j)),m=E(()=>UD),g=E(j=>Ixt(j)),f=E(j=>Sxt(j)),y=E(j=>Cxt(j)),I=E(j=>Txt(j)),S=E(j=>_xt(j)),C=E(j=>qe(j,"seller-sales-enabled")==="true"),_=I?"always":"auto",A=j=>(i?.find(w=>w.paymentMethod===j)||{})?.total,x={paidByCheck:A("PAYMENT_CHECK"),paidByCard:A("CARDS"),paidByInvoice:A("INVOICE")},R=Number.isInteger(t.totalItems)?t.totalItems:d,O=!!Number(t?.savings?.amount),N=j=>()=>j.loyalty?.spent,k=()=>R?S?s.jsx(ae.Items,{itemsRetailPrice:t.itemPriceAfterPromos||t.retailPrice,quantity:R,withTaxNote:n}):s.jsxs(h.Fragment,{children:[s.jsx(ae.Items,{itemsRetailPrice:t.itemsRetailPrice||t.retailPrice,quantity:R,withTaxNote:n}),s.jsx(ae.Savings,{savings:t.savings}),s.jsx(ae.SavingsWithPaymentMethod,{savings:t?.paymentMethodSavingsPrice})]}):null;return s.jsxs(h.Fragment,{children:[s.jsxs(pe,{children:[k(),c&&O&&l&&!S&&s.jsx(Ai,{isSummarySection:!0,className:"salt-m-b--2"}),y&&!!Number(t.savings?.amount)&&!!t.itemPriceAfterPromos&&t.itemPriceAfterPromos?.amount!==t.finalPrice?.amount&&!S&&s.jsx(ae.Subtotal,{value:t.itemPriceAfterPromos}),s.jsx(ae.Promotions,{orderLevelPromotions:t.orderLevelPromotions}),s.jsx(ae.Vouchers,{appliedVouchers:t.appliedVouchers||[],vouchersSavingsPrice:t.vouchersSavingsPrice}),s.jsx(ae.Delivery,{delivery:t.delivery,withTaxNote:n,signDisplay:_}),C&&t.isPrimarySeller||!C?s.jsx(ae.DeliveryPromotions,{isDeliveryPromotion:!!r?.[0]?.promoId,deliveryPromotions:r}):null,s.jsx(ae.BagCharge,{carrierBag:t.carrierBag,withTaxNote:n,signDisplay:_}),s.jsx(ae.PreparationCost,{preparationCost:t.preparation,withTaxNote:n,signDisplay:_}),s.jsx(ae.Loyalty,{isLoyaltyRedeemEnabled:u,getLoyaltySpent:C?N(t):m}),s.jsx(ae.Deposit,{depositsPrice:t.depositsPrice,withTaxNote:n,signDisplay:_}),s.jsx(ae.EnvironmentalHandlingCharge,{environmentalHandlingPrice:t.environmentalHandlingPrice,withTaxNote:n,signDisplay:_}),s.jsx(ae.Invoice,{invoice:t.invoice,withTaxNote:n,signDisplay:_}),s.jsx(ae.SmallOrderCharge,{smallOrderPrice:t.smallOrder,thresholds:t.smallOrderChargeThresholds,withTaxNote:n,signDisplay:_,orderId:t.orderId,page:o})]}),s.jsx(ae.Taxes,{finalPrice:t.finalPrice,components:t.taxComponents,withTaxNote:n}),g&&f&&i&&i.length>=1&&(x.paidByCheck||x.paidByInvoice)&&s.jsxs(h.Fragment,{children:[s.jsx(ae.Separator,{}),s.jsx(pe,{"data-test":"summary-payment-list",children:s.jsx(ae.PaymentChecks,{"data-test":"summary-payment-checks",paidByCheck:x.paidByCheck,paidByCard:x.paidByCard,paidByInvoice:x.paidByInvoice})})]}),C?s.jsx(pe,{"data-test":"summary-seller-total",children:s.jsx(ae.Subtotal,{value:t.finalPrice,label:"summary.total"})}):s.jsx(ae.Separator,{})]})},vxt=D("tx.nts"),Axt=(e,t,n,o)=>e?{...t===e.sellerName?{isPrimarySeller:!0,paymentInfo:n.paymentInfo,appliedVouchers:n.appliedVouchers,bags:n.bags}:{appliedVouchers:[],isPrimarySeller:!1},sellerName:e.sellerName,totalItems:e.totalItems,savings:e.orderTotals?.promoSavings,itemsRetailPrice:e.orderTotals?.retailPrice,depositsPrice:e.orderTotals?.depositsPrice,environmentalHandlingPrice:e.orderTotals?.environmentalHandlingPrice,finalPrice:e.orderTotals?.finalPrice,totalPrice:e.orderTotals?.totalPrice,retailPrice:e.orderTotals?.retailPrice,vouchersSavingsPrice:e.orderTotals?.vouchersSavingsPrice,taxComponents:e.orderTotals?.taxesTotals?.taxes?.components,itemPriceAfterPromos:e.orderTotals?.itemPriceAfterPromos,carrierBag:e.charges?.carrierBag,delivery:e.charges?.delivery,deliveryPromotions:e.charges?.deliveryPromotions,invoice:e.charges?.invoice,orderLevelPromotions:e.orderPromotions,preparation:e.charges?.preparation,loyalty:e.loyalty,smallOrder:e.charges?.smallOrder,orderId:o}:null,bxt=D("mpv");function TU({paymentSummary:e,orderId:t,expanded:n,setExpanded:o,isLoyaltyEarningEnabled:r,isLoyaltyEarningMovedToSummaryEnabled:a,primarySellerName:i}){const l=We(),c=M(),d=F(),u=ze(),m=E(w=>cC(w)||[]),g=E(w=>Vs(w)),f=E(w=>qe(w,"seller-sales-enabled")==="true"),y=E(w=>bxt(w)),I=E(vxt),[S]=E(mL)||[],C=E(QX),_=w=>{const L=w?Wn.SUMMARY_COMPONENT_COLLAPSED:Wn.SUMMARY_COMPONENT_EXPANDED,B=w?"User collapsed the summary component":"User expanded the summary component";d(U.analyticsEvent({type:L,description:B}))},A=w=>{_(n),w.preventDefault(),o(!n)},x=()=>{l(gn(t))},R=h.useMemo(()=>EL(m,i,g),[m,i,g]),O=FX(),k=oE()===0||!O;if(!e)return s.jsxs(cs,{breakpoint:"sm-up",children:[s.jsx(Ns,{children:s.jsx(Ns.Skeleton,{})}),s.jsx(ae.Buttons,{loading:!0})]});const j=y?C:e.totalPrice;return s.jsxs(gs,{expanded:n,onToggle:A,breakpoint:"sm-up",sticky:!0,stickyBarEnabled:k,aria:{contentLabel:c.formatMessage("summary.title"),totalPrice:j&&u(j)},children:[s.jsxs(gs.ControlSection,{children:[n?s.jsx(ne,{as:"span",children:c.formatMessage("summary.title")}):s.jsx(ae.TotalInline,{loading:!e,totalPrice:j,withTaxNote:I},"total"),s.jsx(gs.ToggleSwitch,{},"toggleSwitch")]}),s.jsxs(gs.Content,{children:[f?R.map(w=>{const L=Axt(w,i,e,t);return!L||!Number(L.totalPrice?.amount)&&!Number(L.totalItems)?null:s.jsxs(h.Fragment,{children:[s.jsx(bi,{groupName:L.sellerName,className:"salt-d--block salt-m-y--2"}),s.jsx(CU,{paymentSummary:L,withTaxNote:I,page:"order-confirmation"})]},w.sellerId)}):s.jsx(CU,{paymentSummary:e,withTaxNote:I,page:"order-confirmation"}),s.jsx(ae.TotalSpaceBetween,{loading:!e,totalPrice:y?C:e.totalPrice,withTaxNote:I},"total"),y&&S&&s.jsx(pe,{children:s.jsx(jP,{amount:S.total?.amount,currency:S.total?.currency})})]}),s.jsxs("div",{children:[r&&a&&s.jsx("div",{className:"salt-p-t--2","data-test":"loyalty-earnings-summary",children:s.jsx(Hd,{getQuantity:id,allowZero:!0})}),s.jsx(ae.Buttons,{children:s.jsx("div",{className:"salt-p-t--4",children:s.jsx(b,{intent:k?"primary":"secondary",fill:!0,onClick:x,"data-test":"view-order-button","data-synthetics":"view-order-button-on-summary",children:s.jsx(b.Text,{children:c.formatMessage("checkout.complete.view.order")})})})})]})]})}const xxt=({big:e})=>{const t=E(gp);return s.jsx(P,{asChild:!0,size:"l",bold:!0,className:"salt-d--inline-block","data-test":"basket-reminder-title",children:e?s.jsx("h2",{children:s.jsx(v,{id:"checkout.complete.basket.reminder.title",values:{count:t}})}):s.jsx("strong",{children:s.jsx(v,{id:"checkout.complete.basket.reminder.title",values:{count:t}})})})},Rxt=()=>{const e=We(),t=tm(),n=()=>{e(jt())};return s.jsx(b,{intent:"primary",fill:!0,onClick:n,"data-test":"basket-reminder-button",children:s.jsxs(b.Text,{children:[s.jsx(v,{id:"checkout.complete.basket.reminder.view.basket"})," ",t]})})},pJ=({big:e=!1})=>s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{className:"salt-d--flex",colSpan:{xs:12,sm:12,md:8},children:s.jsx(se,{align:"center",children:s.jsx(xxt,{big:e})})}),s.jsx(Y.Item,{colSpan:{xs:12,sm:12,md:4},children:s.jsx(Rxt,{})})]}),Dxt=T.div`
    position: fixed;
    inset-block-end: 0;
    inset-inline: 0;
    max-block-size: calc(100% - var(--salt-spacing-16));
    inline-size: 100%;
    z-index: ${Qt["collapsible-box"]};
`,mJ=()=>E(gp)?s.jsx(Dxt,{"data-test":"sticky-basket-reminder",children:s.jsxs(ve,{children:[s.jsx(pJ,{big:!0}),s.jsx(BW,{renderTo:"#StickyCollapsibleSummary",children:s.jsx(US,{height:GW})})]})}):null;mJ.displayName="TrolleyBottomBar";const Oxt=T(se)`
    text-align: center;
`,Pxt=({formattedMessages:e,orderId:t,className:n})=>s.jsx(Oxt,{justify:"center",className:n,children:s.jsxs("div",{className:"salt-m-b--2 md:salt-m-b--0",children:[s.jsx(me,{success:!0,name:"status_yes",height:42,width:42}),s.jsx(ne,{className:"salt-m-y--2",as:"h1",children:e.title}),s.jsx(P,{size:"m",children:`${e.orderReference}: ${t}`})]})}),hJ=({isLoyaltyEarningEnabled:e,loyaltyEarnings:t,getLoyaltyEarned:n})=>!e||!t||t.units===0?null:s.jsx("div",{className:"salt-m-b--4",children:s.jsx(FL,{getQuantity:n})}),Nxt=()=>s.jsx(Ce,{intent:"info","aria-live":"polite",text:s.jsx(v,{id:"canceled.recurring-order-definition.reference-box.text"})}),hE=e=>{const{pathname:t}=Ne(),n=M(),o=F(),r=E(xC),a={recurringOrderCardTitleAccessibility:n.formatMessage("order.details.recurring.order.card.accessibility.title.label")},{deliveryWindow:i,frequency:l,name:c,definitionId:d}=e.recurringShoppingDefinition,u=gd(i.dayOfWeekIso,Ma),m=i.from&&i.to?`${i.from} - ${i.to}`:"",g=e.alertType&&e.alertText,f=()=>{o(U.analyticsEvent({type:ht.RECURRING_ORDER_CARD_CLICKED}))},y=r.data.some(C=>C.definitionId===d);if(/\/checkout.*\/complete/.test(t)&&!y)return s.jsx(ve,{className:"salt-m-b--4",children:s.jsx(v,{id:"recurring.order.currently.not.visible"})});if(!y)return s.jsx("div",{className:e.className,children:s.jsx(Nxt,{"data-test":"created-from-deleted-recurring-order"})});const S=()=>s.jsxs(ie.Fragment,{children:[s.jsx(v,{id:`order.details.recurring.order.frequency.every.${l.value}.${l.unit.toLowerCase()}`}),`, ${u} ${m}`]});return s.jsx("div",{className:e.className,children:s.jsx(Y,{flush:!0,children:s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(xn,{"data-test":"order-card-recurring",title:{text:c,as:"h2",a11yText:a.recurringOrderCardTitleAccessibility},description:S(),icon:"recurring_order",to:lo(),onClick:f,alertBanner:g?{intent:e.alertType||"action",text:e.alertText}:void 0},e.orderId)})})})},hb=({className:e="salt-m-b--4"})=>{let t="checkout.complete.express.collection.non.editable.alert";const n=E(w$e);return E(F$e)?null:(n&&(t="checkout.complete.noneditable.fast.delivery.order.message"),s.jsx(Ce,{intent:"warning",className:e,text:s.jsx(v,{id:t})}))},Lxt=({delivery:e,order:t,formattedMessages:n,getLoyaltyEarned:o,loyaltyEarnings:r,isRecurringOrdersEnabled:a,isLoyaltyEarningEnabled:i,isLoyaltyEarningMovedToSummaryEnabled:l,billingAddressManagementEnabled:c,isBasketProductOverviewEnabled:d,isProgressIndicatorEnabled:u,children:m})=>s.jsxs(Y.Item,{colSpan:{xs:12,md:8},children:[!u&&s.jsx(hb,{}),u&&s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(se,{justify:"center",children:s.jsxs(ve,{className:"salt-m-b--2  md:salt-m-b--4",children:[s.jsx(P,{className:"salt-d--block",size:"l",asChild:!0,bold:!0,children:s.jsx("h2",{children:n.title})}),s.jsx(P,{className:"salt-d--block",size:"m",children:`${n.orderReference}: ${t?.order?.orderId}`})]})})}),d&&s.jsx("div",{className:"salt-m-b--2",children:s.jsx(rZ,{isOrderConfirmation:!0})}),s.jsx("div",{className:"salt-m-b--4",children:s.jsx(RL,{orderId:t?.order?.orderId,delivery:e,canChangeDelivery:!1,showDeliveryPass:!0,isCompletedOrder:!0})}),a&&t?.order?.recurringShoppingDefinition&&s.jsx(hE,{className:"salt-m-b--4",orderId:t.order.orderId,recurringShoppingDefinition:t.order.recurringShoppingDefinition,alertText:t.order.wasEdited?n.recurringOrderUpdatedAlert:n.recurringOrderCreatedAlert,alertType:"success"}),!l&&s.jsx(hJ,{loyaltyEarnings:r,getLoyaltyEarned:o,isLoyaltyEarningEnabled:i}),c&&t.order&&s.jsx(DL,{isReadOnly:!0,orderBillingAddress:{billingAddressId:t?.order?.billingAddressDetails?.billingAddressId,...t?.order?.billingAddressDetails?.addressDetails,...t?.order?.billingAddressDetails?.customerDetails}}),m]}),kxt=({isRecurringOrdersEnabled:e,order:t,formattedMessages:n})=>!e||!t?.order?.recurringShoppingDefinition?null:s.jsx(hE,{className:"salt-m-y--4",orderId:t.order.orderId,recurringShoppingDefinition:t.order.recurringShoppingDefinition,alertText:t.order.wasEdited?n.recurringOrderUpdatedAlert:n.recurringOrderCreatedAlert,alertType:"success"}),Mxt=({className:e})=>E(gp)?s.jsxs(Y.Item,{colSpan:{xs:12},children:[s.jsx(ve,{className:e,"data-test":"basket-reminder-box",children:s.jsx(pJ,{})}),s.jsx(Zn,{})]}):null,jxt=ee("GET_ORDER_CONFIRMATION_ADVERTS"),gJ=()=>({type:"API",payload:{url:"/v1/content?page=ORDER_CONFIRMATION",...jxt}}),Pl={SMART_SHOP:"smart_shop",CUSTOMER_DEFINED:"customer_defined"},EJ=()=>{const e=h.useRef(!1),t=h.useCallback(()=>{e.current=!0},[]);return{isGA4EventSent:e.current,setIsGA4EventSent:t}},fJ=()=>{const e=!!(typeof window<"u"&&(window.Optanon||window.OneTrust)),t=E(aC),n=t?e:!0,[o,r]=h.useState(n),a=h.useCallback(()=>{r(!0)},[]);return h.useEffect(()=>{if(!(o||!t))return window.addEventListener("onetrustloaded",a),()=>window.removeEventListener("onetrustloaded",a)},[a,t,o]),o},wxt=(e,t)=>{const n=localStorage.getItem(uh);if(!n)return t&&Me.api.pushError(new Error(`no locally stored ORDER_PURCHASE data for orderId: ${e}`)),null;try{return JSON.parse(n)}catch{return Me.api.pushError(new Error("Could not parse local storage data for ORDER_PURCHASE event")),localStorage.removeItem(uh),null}},Fxt=(e,t)=>{const n=E(D("gtm.opfc")),o=E(D("cs.gosd")),r=fJ(),a=h.useRef(!1),i=h.useCallback(()=>{if(a.current)return;o&&Me.api.pushLog([`handler triggered for ORDER_PURCHASE. OrderId: ${e}.`],{level:Za.DEBUG});const l=wxt(e,o);l?.orderId===e?(t({type:_e.ORDER_PURCHASED,...l}),localStorage.removeItem(uh),a.current=!0,o&&Me.api.pushLog([`ORDER_PURCHASE event sent correctly. OrderId: ${e}.`],{level:Za.DEBUG})):o&&Me.api.pushError(new Error(`Missing data or wrong orderId (complete page orderId: ${e}) (ls orderId: ${l?.orderId} provided for ORDER_PURCHASE event`))},[e,o,t]);h.useEffect(()=>{if(!n||a.current)return;if(r){i();return}const l=5e3,c=200;let d=0;const u=setInterval(()=>{if(d+=c,r){clearInterval(u),i();return}d>=l&&(clearInterval(u),o&&Me.api.pushError(new Error(`Timed out waiting for OneTrust for OrderId: ${e}`)))},c);return()=>clearInterval(u)},[r,i,n,o,e])},_U="oces",Bxt=(e,t,n)=>{const o=E(D("cc.op")),[r,a]=ip(),i=E(y=>nl(y,e)),l=E(Ho),c=fJ(),d=E(Ts),u=E(Fo),m=E(qs),g=E(Pr.server.getComputedState).metadata.hasCustomerSubscriptions,f=r.get(_U)==="1";h.useEffect(()=>{!e||f||i||n(e)},[n,e,f,i]),h.useEffect(()=>{!e||f||!i||!c||(t({type:As.PAGE_ATTRIBUTES_MULTIPLE,attributes:{ORDER_CONFIRM_ORDER_ID:e}}),o&&((async(I,S)=>{let C;if(S?.checkoutId&&(C=await Yo.fetchAnalyticsMetadataByCheckoutId(S.checkoutId,l)),t({type:_e.ORDER_CONFIRMED,orderId:I,meta:C}),S){const _=Jst({wasEdited:!!S?.wasEdited,order:S});J.sendEvent({GA:_,WA:null}),ent({order:i,productEntities:d,groupId:u,featuredProductCampaigns:m,hasDeliveryPass:g,meta:C}).forEach(x=>{J.sendEvent({GA:x,WA:null})})}})(e,i),r.set(_U,"1"),a(r,{replace:!0})))},[n,o,t,e,l,f,i,r,a,c,d,u,m,g])},Uxt=({total:e})=>{const{formatMessage:t}=M(),n=ze();return s.jsx(P,{children:`${t("summary.loyalty.units.name")}${` (${n(e)})`}`})},Gxt=({charged:e,refunded:t})=>{const{formatMessage:n}=M(),o=ze(),r={charged:n("multipayment.loyalty.points.paid",{points:o(e)}),refunded:n("multipayment.loyalty.points.refunded",{points:o(t)})};return Number(e.amount)?s.jsx(P,{children:r.charged}):Number(t.amount)?s.jsx(P,{children:r.refunded}):null},yJ=({className:e})=>{const{pathname:t}=Ne(),n=E(D("cc.lca")),o=E(mL);if(!o||!o?.length)return null;const r=n&&!/\/orders\/\d*\/details$/.test(t);return s.jsx("div",{className:e,children:o.map(a=>{const{lastCheckoutAdjustment:{charged:i,refunded:l}}=a;return s.jsx(ve,{children:r?s.jsx(Gxt,{charged:i,refunded:l}):s.jsx(Uxt,{total:a.total})},a.paymentId)})})},IJ=({className:e})=>{const t=E(KX);if(!t||!t?.length)return null;const n=o=>{const{paymentMethod:{type:r},fundingInstrument:a}=o;return{paymentMethodV2:r,nonSavedFundingInstrument:a?.nonSaved,cardType:a?.cardType,lastFourDigits:a?.lastFourDigits,expiryMonth:a?.expiryMonth,expiryYear:a?.expiryYear,emailAddress:a?.emailAddress}};return s.jsx("div",{className:e,children:t.map(o=>s.jsx(ve,{tabIndex:0,children:s.jsx(Qd,{paymentInfo:n(o)})},o.paymentId))})},$xt=()=>E(zX).length?s.jsxs(ve,{"data-test":"payment-method",className:"salt-m-b--4",tabIndex:0,children:[s.jsx(ne,{as:"h2",className:"salt-m-b--4",children:s.jsx(v,{id:"checkout.complete.payment.title"})}),s.jsx(IJ,{className:"salt-m-y--4"}),s.jsx(yJ,{className:"salt-m-y--4"})]}):null,Ym=[{id:"opt0",textKey:"checkout.complete.feedback.options.notSure",value:null,text:"I’m not sure"},{id:"opt1",textKey:"checkout.complete.feedback.options.inNextWeeks",value:"1-2",text:"In the next 1-2 weeks"},{id:"opt2",textKey:"checkout.complete.feedback.options.afterWeeks",value:"2-3",text:"In the next 2-3 weeks"},{id:"opt3",textKey:"checkout.complete.feedback.options.afterWeeks",value:"3",text:"After 3 weeks"}],vU=e=>{const t=Ym.findIndex(({id:r})=>r===e);if(t===-1)return null;const n=Ym[t]?.textKey??"",o=Ym[t]?.value??"";return{optionTextKey:n,optionPosition:t+1,optionValue:o}},AU=({orderId:e})=>{const[t,n]=h.useState(),[o,r]=h.useState(!1),a=F(),{formatMessage:i}=M(),l=()=>a(U.analyticsEvent({type:_e.TOAST_NOTIFICATION_DISPLAYED,description:"A toast notification was displayed",pageEventAttributes:{message:"Thank you for your feedback. Your response has been saved."}})),c=I=>{const{type:S,option:C,position:_}=I;a(U.analyticsEvent({type:S,pageEventAttributes:{optionSelected:C,positionSelected:_}}))},d=I=>{a(U.analyticsEvent({type:_e.SUBMIT_FEEDBACK_IMPRESSION,impression:I}))},u=()=>{z.success("checkout.complete.feedback.notification.success")},m=I=>{const S=vU(I);S&&c({type:_e.SUBMIT_FEEDBACK_INTERACTION,option:i({id:S.optionTextKey},{numberOfWeeks:S.optionValue}),position:S.optionPosition}),n(I)},g=I=>{I.preventDefault();const S=vU(t);S&&(u(),c({type:_e.SUBMIT_FEEDBACK_BUTTON_CLICKED,option:i({id:S.optionTextKey},{numberOfWeeks:S.optionValue}),position:S.optionPosition}),l(),r(!0))};h.useEffect(()=>{const I={ORDER_ID:e,OPTION_STRINGS:Ym.map(({textKey:S,value:C})=>i({id:S},{numberOfWeeks:C}))};d(I)},[]);const f={isVisuallyConcealed:!1,text:i("checkout.complete.feedback.title")},y=Ym.map(({id:I,textKey:S,value:C})=>({value:I,label:s.jsx(v,{id:S,values:{numberOfWeeks:C}})}));return s.jsx(ve,{children:s.jsxs(mt,{onSubmit:g,children:[s.jsx(mt.RadioGroup,{radios:y,value:t,name:"checkoutFeedback",groupLabel:f,onChange:m}),s.jsx(P,{className:"salt-d--block salt-m-t--4",children:s.jsx(v,{id:"checkout.complete.feedback.description"})}),s.jsx(b,{fill:!0,type:"submit",intent:"secondary",className:"salt-m-t--4",disabled:!t||o,"data-test":"checkout-complete-feedback-submit",children:s.jsx(b.Text,{children:s.jsx(v,{id:"checkout.complete.feedback.buttons.submit"})})})]})})},Hxt=e=>{const{customerSegments:t}=fR(e);return t.length?t.reduce((n,o)=>n.concat(o.shortCodes||""),"").includes("sho01"):!1},jT=()=>{const e=F(),t=E(jWe);h.useEffect(()=>{t.showRecurringOrderCreatedNotification&&(z.success({key:"checkout.complete.recurring.order.confirmation.message",substitutions:{recurringOrderName:t.name}}),e(zy.hideRecurringOrderCreatedNotification()))},[t,e])},Vxt=vo(["loyalty","loyear"]),Yxt=D("loyear.csm"),Wxt=D("rec.o"),qxt=D("cs.prind"),Kxt=D("bam"),zxt=D("cs.bpo"),SJ=D("mpv"),Qxt=D("cc.fb"),Xxt=({isProgressIndicatorEnabled:e,order:t,isRecurringOrdersEnabled:n,isLoyaltyEarningEnabled:o,isLoyaltyEarningMovedToSummaryEnabled:r,getLoyaltyEarned:a,delivery:i,paymentSummary:l,loyaltyEarnings:c,actions:d,billingAddressManagementEnabled:u,isBasketProductOverviewEnabled:m,shouldFetchOrderConfirmationPageAdverts:g,shouldRenderHorizontalAdvertsOnOrderConfirmationPage:f,isOrderMultiPaymentsEnabled:y,isFirstTimeShopper:I,isOrderFeedbackEnabled:S})=>{const C=M(),_=We(),A=Ne(),x=h.useRef(!1),R=us.parse(A.search).orderId,O=F(),{isGA4EventSent:N,setIsGA4EventSent:k}=EJ(),[j,w]=h.useState(!1),[,L]=h.useState(!1);h.useEffect(()=>(localStorage.getItem("editRecurringOrderOption")===Ni.THIS_AND_FUTURE_ORDERS&&z.success("edit.recurring.order.notification.text"),()=>{localStorage.removeItem("editRecurringOrderOption")}),[]),h.useEffect(()=>{L(!0)},[]),h.useEffect(()=>{n&&d.getRecurringShoppingDefinitions(),g&&d.getOrderConfirmationAdverts(),y&&d.getOrderMultiPayments(R)},[n,g,d,R,y]),Fxt(R,d.sendAnalyticsEvent),Bxt(R,d.sendAnalyticsEvent,d.getOrder);const B=oo(t.isFetching);h.useEffect(()=>{t.isFetching&&(x.current=!1);const X=B&&!t.isFetching,re=B===void 0&&!t.isFetching;(X||re)&&!x.current&&(d.performanceMark({name:RTe}),x.current=!0)},[d,B,t.isFetching]),h.useEffect(()=>{if(!t.isFetching&&!t.fetchError&&!N&&t.order?.recurringShoppingDefinition){O(U.analyticsEvent({type:ht.RECURRING_ORDER_CREATED_GA4_EVENT,recurringShoppingDefinition:t.order.recurringShoppingDefinition,recurringOrderType:Pl.CUSTOMER_DEFINED}));const re={event:"recurring_order_creation",type:Pl.CUSTOMER_DEFINED,frequency:_S(t.order.recurringShoppingDefinition.frequency)??"",slot_day:vS(t.order.recurringShoppingDefinition.deliveryWindow)??0,slot_start_time:t.order.recurringShoppingDefinition.deliveryWindow?.from,slot_end_time:t.order.recurringShoppingDefinition.deliveryWindow?.to};J.sendEvent({GA:re,WA:null}),k()}},[O,N,t,k]),jT();const W=()=>l?y?s.jsx($xt,{}):s.jsx("div",{className:"salt-m-b--4",children:s.jsx(lJ,{paymentInfo:l.paymentInfo})}):null,$={heading:C.formatMessage("checkout.complete.header.heading"),title:C.formatMessage("checkout.complete.title"),summaryToggleSwitchOffLabel:C.formatMessage("summary.component.accessibility.toggle.switch.off.label"),summaryToggleSwitchOnLabel:C.formatMessage("summary.component.accessibility.toggle.switch.on.label"),summaryTitle:C.formatMessage("summary.title"),orderReference:C.formatMessage("checkout.complete.order.reference"),viewOrder:C.formatMessage("checkout.complete.view.order"),recurringOrderCreatedAlert:C.formatMessage("checkout.complete.recrurring.order.card.alert"),recurringOrderUpdatedAlert:C.formatMessage("checkout.complete.recurring.order.updated.card.alert")},K=s.jsx(ne,{as:"h1",children:$.heading}),Q=()=>s.jsxs(ie.Fragment,{children:[s.jsx(rs,{title:"checkout.complete.page.title"}),e?s.jsx(ga,{completed:!0,overrideText:K}):K]});return R&&!t.fetchError?s.jsxs(h.Fragment,{children:[s.jsx(An,{className:"salt-p-b--0",children:Q()}),s.jsx("div",{className:"salt-p-x--2",children:s.jsxs(Y,{fixed:!0,flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsxs(Y,{flush:!0,children:[!e&&s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Pxt,{className:"salt-m-t--4",formattedMessages:$,orderId:R})}),e&&s.jsxs(cs,{breakpoint:"sm-up",remainInDom:!1,children:[!t?.order?.dates?.confirmOrderChangesBy&&s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(hb,{className:"salt-m-b--0 salt-m-t--2"})}),s.jsx(Mxt,{className:t?.order?.dates?.confirmOrderChangesBy?"salt-m-b--4 salt-m-t--4":"salt-m-b--4"})]})]})}),s.jsxs(cs,{breakpoint:"sm-up",remainInDom:!1,children:[s.jsx(Lxt,{isLoyaltyEarningEnabled:o,isLoyaltyEarningMovedToSummaryEnabled:r,getLoyaltyEarned:a,loyaltyEarnings:c,formattedMessages:$,isProgressIndicatorEnabled:e,order:t,delivery:i,isRecurringOrdersEnabled:n,billingAddressManagementEnabled:u,isBasketProductOverviewEnabled:m,children:W()}),s.jsxs(Y.Item,{colSpan:{xs:12,md:4},children:[s.jsx(SU,{}),s.jsx("div",{className:"salt-m-b--4",children:s.jsx(TU,{paymentSummary:l,orderId:R,primarySellerName:t?.order?.primarySellerName,expanded:j,setExpanded:w,isLoyaltyEarningEnabled:o,isLoyaltyEarningMovedToSummaryEnabled:r})}),S&&I&&s.jsx("div",{className:"salt-m-b--4",children:s.jsx(AU,{orderId:R})}),s.jsx("div",{className:"salt-m-b--2 md:salt-m-b--0",children:s.jsx(IU,{navigate:_})})]})]}),s.jsx(Kt,{breakpoint:"sm-up",remainInDom:!1,children:s.jsxs(Y.Item,{colSpan:{xs:12},children:[s.jsx(hb,{}),e&&s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(se,{justify:"center",children:s.jsxs(ve,{className:t?.order?.dates?.confirmOrderChangesBy?"salt-m-b--4 salt-m-t--2":"salt-m-b--4",children:[s.jsx(P,{className:"salt-d--block",size:"l",asChild:!0,bold:!0,children:s.jsx("h2",{children:$.title})}),s.jsx(P,{className:"salt-d--block",size:"m",children:`${$.orderReference}: ${t?.order?.orderId}`})]})})}),s.jsx(SU,{}),s.jsx(kxt,{isRecurringOrdersEnabled:n,order:t,formattedMessages:$}),o&&!r&&s.jsx(hJ,{loyaltyEarnings:c,getLoyaltyEarned:a,isLoyaltyEarningEnabled:o}),W(),s.jsx("div",{className:"salt-m-b--4",children:s.jsx(RL,{orderId:R,delivery:i,canChangeDelivery:!1,showDeliveryPass:!0,isCompletedOrder:!0})}),S&&I&&s.jsx("div",{className:"salt-m-b--4",children:s.jsx(AU,{orderId:R})}),s.jsx("div",{className:"salt-m-b--2 md:salt-m-b--0",children:s.jsx(IU,{navigate:_})}),s.jsx(TU,{paymentSummary:l,orderId:R,primarySellerName:t?.order?.primarySellerName,expanded:j,setExpanded:w,isLoyaltyEarningEnabled:o,isLoyaltyEarningMovedToSummaryEnabled:r})]})}),e&&s.jsx(Kt,{breakpoint:"sm-up",remainInDom:!1,children:s.jsx(mJ,{})}),f&&s.jsx(Y.Item,{colSpan:{xs:12},"data-test":"horizontal-advert-container",children:s.jsx(f8,{page:"order-confirmation"})})]})})]}):s.jsx(Qn,{to:"/"})},Zxt=e=>({delivery:vg(e)||null,getLoyaltyEarned:id,isLoyaltyEarningEnabled:Vxt(e),isLoyaltyEarningMovedToSummaryEnabled:Yxt(e),isRecurringOrdersEnabled:Wxt(e),order:Ds(e),paymentSummary:ac(e)||void 0,loyaltyEarnings:id(e)||null,isProgressIndicatorEnabled:qxt(e),billingAddressManagementEnabled:Kxt(e),isBasketProductOverviewEnabled:zxt(e),shouldFetchOrderConfirmationPageAdverts:ZZe(e),shouldRenderHorizontalAdvertsOnOrderConfirmationPage:JZe(e),isOrderMultiPaymentsEnabled:SJ(e),isFirstTimeShopper:Hxt(e),isOrderFeedbackEnabled:Qxt(e)}),Jxt=ot({getOrder:Wo.getDecoratedOrderWithRecurringNotification,sendAnalyticsEvent:U.analyticsEvent,performanceMark:ks,getRecurringShoppingDefinitions:qa.getRecurringShoppingDefinitions,getOrderConfirmationAdverts:gJ,getOrderMultiPayments:Dr.getOrderMultiPayments}),CJ=e=>s.jsx(os,{type:"CheckoutComplete::route",children:s.jsx(Xxt,{...e})});CJ.fetchData=({context:{store:e,url:t}})=>{const n=t.searchParams.get("orderId")??"",o=e.getState(),r=SJ(o),a=[e.dispatch(Wo.getDecoratedOrderWithRecurringNotification(n))];return a.push(e.dispatch(gJ())),r&&a.push(e.dispatch(Dr.getOrderMultiPayments(n))),n?Promise.all(a):null};const eRt=ke(Zxt,Jxt)(CJ),bU=D("cow"),tRt=e=>[{path:"/checkout",Component:ws(Ze,e.Checkout,jt()),children:[{index:!0,Component:ws(Ze,Gl([{condition:dS,failComponent:NX},{condition:t=>!bU(t),failComponent:gyt}],LX),jt())},{path:"checkout-walk/:pageKey",Component:ws(Ze,Xt(bU,Wyt,lt),jt())},{path:"summary",Component:ws(Ze,iJ,jt())},{path:"complete",Component:ws(Ze,eRt,jt())},{path:"3ds",Component:ws(Ze,yU,jt())},{path:"3ds/continue",Component:yU},{path:"*",Component:lt}]}],sRt=!!(typeof window<"u"&&window.document?.createElement),nRt=typeof window<"u"?h.useLayoutEffect:h.useEffect,oRt=(e,t)=>{const n=h.useRef(e);nRt(()=>{n.current=e},[e]),h.useEffect(()=>{if(!t&&t!==0)return()=>{};const o=setInterval(()=>n.current(),t);return()=>clearInterval(o)},[t])},rRt=()=>{const e=z.getNotifications().find(t=>t.id===by);return h.useCallback(()=>{e||z.warning("basket.unavailable.data.error",{id:by})},[e])},aRt=()=>{const e=z.getNotifications().find(t=>t.id===by);return h.useCallback(()=>{e&&z.close(by)},[e])},iRt=()=>{const e=E(V0),t=E(r=>r.data.basket.basketId),n=HX(),o=F();oRt(async()=>{!sRt||!n||(Me.api.pushError(new Error("Cart: Unavailable data"),{context:{cartId:t||"",unavailableData:JSON.stringify(e)}}),await o(Ht.getBasket()))},n?2e3:null)},lRt=()=>{const e=HX(),t=oo(e),n=rRt(),o=aRt();h.useEffect(()=>{t!==e&&(e?n():o())},[t,e,n,o])},cRt=()=>(iRt(),lRt(),null),TJ=ie.memo(({quantity:e,price:t,testId:n})=>s.jsx(Ee,{"aria-live":"polite","aria-relevant":"text","aria-atomic":"true","data-test":n,children:s.jsx(v,{id:"header.topbar.basket.button.accessibility.label.price.shown",values:{quantity:e,price:t}})})),dRt=T.span`
    display: flex;
    place-content: center center;
    align-items: center;
    flex-direction: column;
    ${({breakpoint:e})=>oe[or[e].mediaQueryKey]`
        flex-direction: row;
        column-gap: var(--salt-spacing-1);
    `}
`,uRt=D("tx.nts"),pRt=T(b.Text)`
    font-size: var(--salt-text-s-font-size);
`,mRt=()=>{const e=Vp(uRt),t=rE(),n=tm(),o=AT();if(t||!o)return s.jsx(cs,{as:"span",breakpoint:"sm-up",children:s.jsx(v,{id:"header.topbar.basket.button.text","data-test":"basket-text"})});const r=!e||Number(o?.amount??0)===0;return s.jsxs(dRt,{breakpoint:"lg-up","aria-hidden":"true",children:[s.jsx("span",{"data-test":"basket-price",children:n}),!r&&s.jsx(pRt,{"data-test":"basket-price-tax-note",children:s.jsx(v,{id:"price.tax.note.inclusive"})})]})},xU="basket-button-info-badge",hRt=T(b)`
    position: relative;

    ${oe.smUp`
        min-inline-size: ${H(90)};
    `}
`,gRt=T.div`
    position: absolute;
    inset-block-start: calc(var(--salt-spacing-2) * -1);
    inset-inline-end: calc(var(--salt-spacing-2) * -1);
`,ERt=T.div`
    position: absolute;
    inline-size: 100%;
    display: flex;
    justify-content: center;
    inset-block-start: calc(100% - var(--salt-spacing-2));
`,fRt=De`
    background-color: var(--intent-promotion);
    color: var(--intent-promotion-contrast);
`,yRt=De`
    background-color: var(--intent-action-100);
    color: var(--intent-action-100-contrast);
`,IRt=T(Fn)`
    ${e=>e.intent==="action"&&yRt};
    ${e=>e.intent==="promotion"&&fRt};
    max-block-size: ${H(14)};
    min-block-size: ${H(14)};
    min-inline-size: max-content;
`,SRt=T(al)`
    background-color: ${e=>`var(--intent-${e.intent}-900)`};
    color: var(--intent-action-900-contrast);
`,CRt=T.div`
    position: relative;
`,TRt=T(Rs)`
    block-size: ${H(15)};
    inline-size: ${H(15)};

    &::before {
        border-color: var(--intent-content-100);
    }

    &::after {
        border-block-start-color: var(--intent-content);
    }

    &::before,
    &::after {
        block-size: ${H(15)};
        inline-size: ${H(15)};
        border-width: ${H(3)};
    }
`,RU=()=>{const e=VX(),t=AT();return s.jsxs(h.Fragment,{children:[t?s.jsx(b.Icon,{className:`${e.hidePrice?"salt-d--block":"salt-d--none sm:salt-d--block"}`,name:e.name}):s.jsx(TRt,{className:"salt-d--block"}),s.jsx(mRt,{})]})},_J=()=>{const e=E(D("bt.spl")),t=oE(),n=tm(),o=Fyt(),r=Uyt(),a=VX(),i=Gyt(),l=$yt(),c=Hyt(),d=UX(),u=Oyt(),m=e?u:d;return s.jsxs(h.Fragment,{children:[s.jsx(TJ,{quantity:t,price:n,testId:"basket-live-region"}),s.jsxs(CRt,{children:[s.jsx(hRt,{intent:l?"action":"secondary","aria-label":r,"data-test":"basket-button","data-icon":a.name,"data-synthetics":"basket-details-button",onClick:c.onClick,asChild:!!c.to,...o&&{"aria-describedby":xU},children:c.to?s.jsx(Qe,{intent:"ghost",to:c.to,children:s.jsx(RU,{})}):s.jsx(RU,{})}),s.jsx(ERt,{children:o&&s.jsx(IRt,{id:xU,intent:o.type,text:o.message,"data-test":o["data-test"],"data-synthetics":o["data-synthetics"]})}),s.jsx(gRt,{children:i&&s.jsx(SRt,{count:i.value,intent:i.type,"data-synthetics":i["data-synthetics"],"data-test":i["data-test"],"aria-hidden":!!i["aria-hidden"]})})]}),s.jsx(cRt,{}),m&&s.jsx("div",{"data-synthetics":"checkout-threshold"})]})},_Rt=T("div")`
    display: flex;
    gap: var(--salt-spacing-4);
`,DU=T.div`
    display: flex;
    justify-content: space-between;
`,vRt=T(P)`
    color: var(--typography-promotion, var(--intent-promotion));
`,OU=T(P)`
    text-align: start;
`,ARt=()=>{const e=SZe(),t=X6(),n=CZe();return!(!e||t||n)},bRt=()=>{const e=E(D("tx.nts")),t=E(D("prp")),n=E(D("sib")),o=E(Dn(["sumsub","bt.spl"])),r=M(),a=cL(),i=tm(),l=GX(),c=Nyt(),d=Vp(gi),u=ARt(),m=r.formatMessage(o?"summary.subtotal":"summary.total"),y=o?"summary.subtotal.price.note":"summary.total.note";return s.jsxs(se,{direction:"column",additionalCss:"flex: 1;",children:[d&&s.jsxs(h.Fragment,{children:[s.jsxs(DU,{children:[s.jsxs(OU,{size:"l",bold:!0,className:"salt-d--inline-block",children:[s.jsx("span",{"data-test":"expanded-trolley-total-title",children:m}),s.jsx(P,{size:"s","data-test":"expanded-trolley-total-note",className:"salt-m-l--1",bold:!0,children:s.jsx(v,{id:e?"price.tax.note.inclusive":y})})]}),s.jsx(P,{size:"l",bold:!0,children:i})]}),l&&s.jsxs(DU,{children:[s.jsx(OU,{size:"s","data-test":"expanded-trolley-savings",children:s.jsx(v,{id:"summary.savings"})}),s.jsx(vRt,{size:"s",children:c})]}),n&&t&&l&&s.jsx(Ai,{className:"salt-d--block salt-m-y--2"})]}),s.jsxs(_Rt,{className:"salt-m-t--2",children:[s.jsx(b,{intent:u?"secondary":"action",fill:!0,"data-test":"expanded-trolley-basket-button","data-synthetics":"expanded-trolley-basket-button","aria-label":r.formatMessage("basket.button.open.basket.page.alternative"),asChild:!0,children:s.jsx(Qe,{intent:"ghost",href:a,children:s.jsx(b.Text,{children:s.jsx(v,{id:"view.basket"})})})}),u&&s.jsx(ep,{})]})]})},xRt=()=>{const e=eo();return h.useCallback(()=>{e({type:Te.SMART_CART_BUTTON_CLICKED})},[e])},RRt=()=>{const e=M(),t=xRt();return s.jsx(b,{intent:"primary",onClick:t,fill:!1,"data-test":"expanded-trolley-instant-shop-button",asChild:!0,children:s.jsx(rt,{intent:"ghost",href:KN(),children:s.jsx(b.Text,{children:e.formatMessage("instant.shop.empty.trolley.button")})})})},DRt=T(me)`
    margin-inline-end: var(--salt-spacing-2);
`,ORt=()=>{const e=M(),t=ZC();return s.jsxs("div",{"data-test":"expanded-trolley-empty-state",children:[s.jsxs(se,{justify:"center",align:"center",wrap:"nowrap",className:"salt-m-t--8",children:[s.jsx(DRt,{name:"trolley",width:15,height:15}),s.jsx(ne,{as:"h2",children:e.formatMessage("basket.empty.message")})]}),s.jsx(se,{justify:"center",align:"center",wrap:"nowrap",className:"salt-m-t--4",children:t?s.jsx(RRt,{}):s.jsx(P,{size:"l",children:e.formatMessage("empty.trolley.info.message")})})]})},PRt=()=>{const e=M(),{loadingState:t}=XR();return t===ji.INITIAL?null:s.jsx(Ee,{children:s.jsx(P,{"data-test":"expanded-trolley-loading-state","aria-live":"polite","aria-relevant":"text","aria-atomic":"true",children:e.formatMessage(t===ji.LOADING?"expanded.trolley.items.loading.state":"expanded.trolley.items.loaded.state")})})},NRt=T("div")`
    max-inline-size: 100%;
`,LRt=(e,{threshold:t=0,root:n=null,rootMargin:o="0%",freezeOnceVisible:r=!1})=>{const[a,i]=h.useState(void 0),l=a?.isIntersecting&&r,c=([d])=>{i(d)};return h.useEffect(()=>{const d=e?.current;if(!!!window.IntersectionObserver||l||!d)return()=>{};const m={threshold:t,root:n,rootMargin:o},g=new IntersectionObserver(c,m);return g.observe(d),()=>g.disconnect()},[e,n,o,l,t]),a},kRt=(e,t,n,o)=>{const r=h.useRef(null),[a,i]=h.useState(!!t),l=LRt(r,{root:n,freezeOnceVisible:!0}),c=h.useMemo(()=>!!l?.isIntersecting,[l]);return h.useEffect(()=>{!c||a||(i(!0),o(e))},[a,c,o,e,i]),r},MRt={landscape:{image:{resolution:{width:88,height:88},paddings:{top:"md",bottom:"md",right:"xs",left:"xs"}},title:{numberOfLines:1},controlsContainer:{position:"priceLine"},bottomAttributes:{ratingBadgeOrBoughtDate:!1,maxLifestyleIcons:0},price:{direction:"column",fontSize:"l",strikethrough:"s"},footerContainer:{inBasketBackground:!1},divider:!1,topAttributes:{favorite:!1,featured:!1,list:!1,regulars:!1},unitPrice:null,countryOfOrigin:null,packSize:{fontSize:"m",position:np.OWN_LINE},promotion:{numberOfLines:2,compress:!0}}},vJ=({item:e,root:t,loadItemData:n,position:o})=>{const a=E(ir)[e.productId],i=kRt(e.productId,a,t,n);return s.jsx(NRt,{ref:i,"data-test":"expanded-trolley-list-item",className:"salt-m-y--2",children:s.jsx(ka,{displayLandscapeLayout:!0,position:o,fopPositionOnPage:o,product:a,page:"expanded-trolley",subPage:null,noOfferLink:!1,type:"basket",overrideConfig:MRt,loading:!a,group:{type:"unknown",section:"unknown",name:"",products:[],clusterBreadcrumbs:[]}})})},jRt=({innerRef:e})=>{const t=JR(),n=fg();return s.jsx(h.Fragment,{children:n.map((o,r)=>s.jsx(vJ,{item:o,root:e?.current,loadItemData:t,position:r+1},o.productId))})},wRt=({innerRef:e})=>{const t=JR(),n=fg(),o=E(lS);return s.jsx(h.Fragment,{children:o.map(({groupName:r,items:a},i)=>s.jsxs(h.Fragment,{children:[s.jsx(bi,{groupName:r,className:`salt-d--block salt-m-t--${i>0?4:2}`}),a.map((l,c)=>{const d=n.find(u=>u.productId===l);return d?s.jsx(vJ,{item:d,root:e?.current,loadItemData:t,position:c+1},l):null})]},r))})},FRt=()=>{const{formatMessage:e}=M(),t=h.useRef(null),n=E(gi),o=E(Ho),{viewCartGa4Event:r}=r8(),{data:a,canSendEvent:i,setIsEventSent:l}=a8();h.useEffect(()=>{i&&o&&((async()=>{const u=await Yo.fetchAnalyticsMetadataByActiveCart(o);await r({payload:a,cartType:"expanded",meta:u})})(),l())},[i,l,r,a,o]);const c=E(d=>qe(d,"seller-sales-enabled")==="true");return s.jsx("div",{ref:t,"data-retailer-anchor":"expanded-trolley-content",children:n?s.jsxs(h.Fragment,{children:[s.jsx(Ee,{children:s.jsx(ne,{as:"h2",children:e("catalogue.products.heading")})}),s.jsx(PRt,{}),c?s.jsx(wRt,{innerRef:t}):s.jsx(jRt,{innerRef:t})]}):s.jsx(ORt,{})})},BRt=()=>{const e=M(),t=oE(),n=e.formatMessage("header.topbar.basket.button.text"),o=e.formatMessage("shopping.list.card.number.of.items",{numberOfItems:t});return s.jsxs(h.Fragment,{children:[s.jsx(yg,{location:jt(),text:e.formatMessage("basket.button.open.basket.page.alternative"),testId:"expanded-trolley-basket-skip-link"}),s.jsx(P,{asChild:!0,size:"l",bold:!0,id:"drawer-title","aria-label":e.formatMessage("expanded.trolley.close.button.alternative"),children:s.jsx("h1",{children:`${n} (${o})`})})]})},URt=()=>{const e=M(),t=E(Ue(yh)),n=MW(),o=oE(),r=e.formatMessage("shopping.list.card.number.of.items",{numberOfItems:o}),a=tm();return Wwe(),qwe(),s.jsxs(G,{isOpen:t,onRequestClose:n,aria:{label:`${e.formatMessage("expanded.trolley.alternative")} (${r})`},data:{test:"expanded-trolley-drawer"},skipFocusFirst:!0,condensed:!0,context:"drawer",children:[s.jsx(G.Header,{align:"left",children:s.jsx(BRt,{})}),s.jsx(G.Body,{className:"salt-p-y--0",children:s.jsx(FRt,{})}),s.jsx(G.Footer,{children:s.jsx(bRt,{})}),s.jsx(TJ,{quantity:o,price:a,testId:"expanded-trolley-live-region"})]})},GRt=()=>{const[e,t]=h.useState(ji.INITIAL),n=h.useMemo(()=>({loadingState:e,setLoadingState:t}),[e]);return s.jsx("div",{"data-test":"expanded-trolley","data-synthetics":"expanded-trolley",children:s.jsxs(kW.Provider,{value:n,children:[s.jsx(_J,{}),s.jsx(URt,{}),s.jsx(VC,{})]})})},$Rt=({basketSummary:e})=>{const{onConfirmCheckout:t,isCheckoutLoading:n}=oQ(e);return n?null:s.jsx(yg,{location:"/checkout",testId:"checkout-skip-link",text:s.jsx(v,{id:"basket.summary.checkout"}),onClick:t})},HRt=({className:e})=>{const t=E(Dn(["bt.spl","bt.cart"])),n=dL(),o=bT(),r=jyt(),a=!o||r,i=E(c=>Zt(c)),l=MW(!1);return Ywe(l),s.jsxs("div",{className:e,children:[a&&s.jsx($Rt,{basketSummary:t?void 0:i}),n?s.jsx(GRt,{}):s.jsx(_J,{})]})},VRt=({modalName:e=lr,onModalClose:t,onAddressSave:n})=>{const o=F(),r=E(Ue(e)),a=Ls(),i=()=>{t(),a.cancelButtonClicked("cross icon"),o(Z.closeModal())},l=()=>{n("",""),o(Z.closeModal())};return s.jsx(G,{isOpen:r,onRequestClose:i,children:s.jsx(G.Body,{children:s.jsx(K6,{onConfirm:l})})})},AJ=(e,t)=>{const n=e.latitude,o=e.longitude,r=t.latitude,a=t.longitude,i=6371,l=(r-n)*(Math.PI/180),c=(a-o)*(Math.PI/180),d=.5-Math.cos(l)/2+Math.cos(n*(Math.PI/180))*Math.cos(r*(Math.PI/180))*(1-Math.cos(c))/2;return i*2*Math.asin(Math.sqrt(d))},bJ=e=>{if(e.type==="click")return typeof e.target.className=="string"&&e.target.className.includes("Fill")?"unfocusedArea":"cross";if(e.type==="keydown")return"escape"},SI=e=>({lat:e.latitude,lng:e.longitude}),YRt=e=>({latitude:e.lat,longitude:e.lng}),XL=e=>!e.addressLine2||e.addressLine2==="",WRt=(e,t)=>{t(ni.getDeliveryDestinationDeliverability(e)).then(n=>{const{postalCode:o,longitude:r,latitude:a,name:i,formattedAddress:l}=e;return t(ni.prepareTemporaryDeliveryDestination({name:i,coordinates:{latitude:a,longitude:r},postalCode:o,formattedAddress:l,deliveryMethod:"HOME_DELIVERY",deliveryType:"BRANDED_VAN",deliverability:n.payload.responseData.deliverability}))})},wT=e=>t=>t(ni.getDeliveryDestinationDeliverability(e)).then(n=>n.payload.responseData),xJ=e=>t=>e(ni.getTemporaryDeliveryDestination(t.payload.responseData)),qRt=e=>t=>e(sn.openChangeDeliveryDestinationConfirmationModal(ld,t.payload.responseData)),KRt=(e,t)=>t(ni.createTemporaryDeliveryDestination(e)).then(xJ(t)).then(qRt(t)),zRt=(e,t)=>t(ni.createTemporaryDeliveryDestination(e)).then(xJ(t)),QRt="select-candidate-address-back";function XRt({onBack:e,children:t}){return s.jsx(FC,{titleTextId:"addresses.select-candidate-address.title",headingTextId:"addresses.select-candidate-address.heading",buttonTestId:QRt,onBack:e,children:t})}const{RadioIconOff:ZRt,RadioIconOn:JRt}=ha,eDt="select-candidate-address-warning",tDt="select-candidate-address-item",sDt="select-candidate-address-submit",nDt=T(Ce).withConfig({shouldForwardProp:e=>!["isVisible"].includes(e)})`
    visibility: ${({isVisible:e})=>e?"visible":"hidden"};
`,oDt=T(se)`
    align-items: center;
`;function rDt({addresses:e,onSubmit:t,onBack:n}){const o=()=>l.findIndex(d=>d),r=Ls();h.useEffect(()=>{r.selectAddressModalDisplayed(e.length-1)},[]);const a=()=>{const d=o();d!==-1&&t(d)},i=d=>{c(u=>{const m=u.map(()=>!1);return m[d]=!0,m})},[l,c]=h.useState(e.map((d,u)=>e.length===1?u===0:u===1));return s.jsxs(XRt,{onBack:n,children:[s.jsx(P,{className:"salt-m-y--8 salt-d--block",children:s.jsx(v,{id:"addresses.select-candidate-address.option-selection"})}),s.jsx(nDt,{showIcon:!1,intent:"warning","data-test":eDt,text:s.jsx(v,{id:"addresses.select-candidate-address.original-address-warning"}),className:"salt-m-b--4",isVisible:o()===0}),s.jsx(Ve,{inline:!1,role:"listbox",tabIndex:0,className:"salt-m-b--8",children:e.map((d,u)=>s.jsx(Ve.Item,{role:"option","aria-selected":l[u],onFocus:()=>i(u),tabIndex:0,"data-test":tDt,children:s.jsxs(se,{className:"salt-m-b--8",direction:"column",children:[s.jsxs(oDt,{children:[l[u]?s.jsx(JRt,{name:"radio_on",className:"salt-m-r--0"}):s.jsx(ZRt,{name:"radio_off",className:"salt-m-r--0"}),s.jsx(P,{bold:!0,className:"salt-m-l--2",children:u===0?s.jsx(v,{id:"addresses.select-candidate-address.original-address"}):s.jsx(v,{id:"addresses.select-candidate-address.found-address"})})]}),s.jsx(P,{className:"salt-m-l--8 salt-d--block",children:d.formattedAddress})]})},u))}),s.jsx(b,{fill:!0,onClick:a,intent:"primary","data-test":sDt,children:s.jsx(b.Text,{children:s.jsx(v,{id:"addresses.select-candidate-address.submit"})})})]})}const aDt=["geometry"],PU="react-google-map",RJ=()=>{const e=Cs("google-maps-api-key"),t=E(o=>L2(o)),n=E(o=>k2(o));return{...Ore({id:`${PU}-script`,googleMapsApiKey:e,language:t,region:n,version:"3.53",libraries:aDt}),reactMapId:PU}},iDt=T.button`
    cursor: pointer;
    user-select: none;
    border-radius: 2px;
    border: none;
    background: white;
    block-size: 40px;
    inline-size: 40px;
    margin-inline-end: 10px;
    padding: 0;
`,lDt=T(me)`
    vertical-align: middle;

    svg {
        fill: #666;
        block-size: 40px;
        inline-size: 40px;
        padding: 8px;
    }

    svg:hover {
        fill: #333;
    }
`,cDt=5*60*1e3,dDt=()=>{const[e,t]=h.useState(),[n,o]=h.useState(!1),[r,a]=h.useState(!1);return h.useEffect(()=>{DJ(i=>{t(i),a(!0)},()=>{o(!0),a(!0)})},[]),{geoLocation:e,geoLocationError:n,isGeoLocationRequested:r}},DJ=(e,t)=>{const n=o=>{const r={lat:o.coords.latitude,lng:o.coords.longitude};e(r)};navigator.geolocation?navigator.geolocation.getCurrentPosition(n,t,{maximumAge:cDt}):t()},uDt=(e,t)=>s.jsx(iDt,{onClick:e,"aria-label":t,children:s.jsx(lDt,{name:"map_location"})}),pDt=(e,t,n,o)=>{const a=document.createElement("div"),i=o.formatMessage("delivery.collection.map.location.button.accessibility"),l=s.jsx(kb,{store:n,children:uDt(t,i)});Pb.createRoot(a).render(l),e.controls?.[9]?.push(a)},mDt=()=>s.jsx("svg",{viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 2C15.7855 2 18.8691 5.00478 18.9959 8.75935L19 9C19 12.3333 16.6667 16.6667 12 22C7.33333 16.6667 5 12.3333 5 9L5.00406 8.75935C5.1309 5.00478 8.21455 2 12 2ZM12 6C10.3431 6 9 7.34315 9 9C9 10.6569 10.3431 12 12 12C13.6569 12 15 10.6569 15 9C15 7.34315 13.6569 6 12 6Z"})}),hDt=T("div")`
    padding: inherit;
    position: absolute;
    z-index: 1000;
    inline-size: 100%;
    block-size: 100%;
    pointer-events: none;

    svg {
        fill: var(--intent-primary);
        position: relative;
        inset-block-start: calc(50% - 45px);
        inset-inline-start: calc(50% - 25px);
        inline-size: 50px;
        block-size: 50px;
    }
`,gDt=h.forwardRef(({height:e="100%",center:t,zoom:n=17,interactive:o=!1,showGeolocationButton:r=!1,showZoomButtons:a=!0,showFixedMarker:i=!1,onBoundsChanged:l=()=>{},onGeolocationError:c=()=>{},onCenterChanged:d,children:u},m)=>{const{isLoaded:g,reactMapId:f}=RJ(),y=lp(),I=M(),S=Ls(),C=h.useRef(),_=h.useRef(n),A=()=>{if(!C.current)return;const L=_.current,B=C.current.getZoom()||0;B>L?S.zoomButtonClickedEvent("zoomIn"):B<L&&S.zoomButtonClickedEvent("zoomOut"),_.current=B},x=()=>{if(!C||!C.current)return;const L=C.current.getZoom()||0;C.current.setZoom(L+1)},R=()=>{if(!C||!C.current)return;const L=C.current.getZoom()||0;C.current.setZoom(L-1)},O=()=>{S.locateMeButtonClickedEvent(),DJ(L=>{!C||!C.current||C.current.panTo(L)},c)},N=()=>{O()},k=L=>{!C||!C.current||C.current.panTo(L)},j=()=>{if(!C||!C.current)return;const L=C.current.getCenter();if(!L)return;const B={lat:L.lat(),lng:L.lng()};d&&d(B)},w=L=>{C.current=L,r&&pDt(L,()=>N(),y,I),t&&L.setCenter?.(t)};return m&&(m.current={zoomIn:x,zoomOut:R,geolocate:O,setCenter:k}),g?s.jsxs(ie.Fragment,{children:[i&&s.jsx(hDt,{"data-test":"custom-marker-container",children:s.jsx(mDt,{})}),s.jsx(k$,{id:f,mapContainerStyle:{height:e},options:{fullscreenControl:!1,cameraControl:!1,streetViewControl:!1,mapTypeControl:!1,clickableIcons:!1,keyboardShortcuts:o,zoomControl:a&&o,gestureHandling:o?"auto":"none"},zoom:n,onZoomChanged:A,onLoad:w,onBoundsChanged:l,onCenterChanged:j,children:u})]}):s.jsx(Pe,{"data-test":"placeholder",height:e})}),ZL=h.memo(gDt),EDt="confirm-address-map-back";function fDt({onBack:e,children:t}){return s.jsx(FC,{titleTextId:"addresses.confirm-address-map.title",headingTextId:"addresses.confirm-address-map.heading",onBack:e,buttonTestId:EDt,children:t})}const yDt="confirm-address-map-submit";function OJ({address:e,onSubmit:t,onBack:n}){const o=Ls(),[r,a]=h.useState(e.location),i=()=>{t(r)},l=d=>{a({latitude:d.latLng?.lat(),longitude:d.latLng?.lng()})},c=()=>{z.error("delivery.collection.alert.location.permission.blocked")};return h.useEffect(()=>{o.confirmAddressModalDisplayed()},[]),s.jsxs(fDt,{onBack:n,children:[s.jsxs(se,{direction:"column",className:"salt-m-t--8 salt-m-b--4",children:[s.jsx(P,{bold:!0,children:e.formattedAddress}),s.jsx(P,{className:"salt-m-t--4",children:s.jsx(v,{id:"addresses.confirm-address-map.adjust-pin"})})]}),s.jsx(ZL,{height:"300px",center:SI(r),showGeolocationButton:!0,onGeolocationError:c,interactive:!0,children:s.jsx(_m,{position:SI(r),draggable:!0,onDragEnd:l})}),s.jsx(b,{fill:!0,onClick:i,intent:"primary","data-test":yDt,className:"salt-m-t--8",children:s.jsx(b.Text,{children:s.jsx(v,{id:"addresses.confirm-address-map.submit"})})})]})}const IDt="confirm-created-address-back";function SDt({onBack:e,children:t}){return s.jsx(FC,{titleTextId:"addresses.confirm-created-address-map.title",headingTextId:"addresses.confirm-created-address-map.heading",onBack:e,buttonTestId:IDt,children:t})}function FT({address:e,showWarningIfAddressLine2Empty:t=!0,showMap:n=!0,showDeliveryInstructions:o=!1,showAddressLine2:r=!0,addressLine2Label:a,isAddressLine2Required:i=!1,onSubmit:l,onEdit:c,onBack:d}){const u=Ls(),m=e.location?SI(e.location):void 0,g=XL(e.addressDetails),f={formattedAddress:e.formattedAddress,additionalInformation:"",nickname:"",notes:"",addressLine2:e.addressDetails.addressLine2};return h.useEffect(()=>{u.saveAddressModalDisplayed(g)},[]),s.jsx(SDt,{onBack:d,children:s.jsxs(h.Fragment,{children:[n&&m&&s.jsx(ZL,{height:"200px",center:m,children:s.jsx(_m,{position:m,clickable:!1})}),s.jsx(k6,{texts:f}),r&&t&&g&&s.jsx(Ce,{showIcon:!1,intent:"warning","data-test":"addressLine2-empty-warning",text:s.jsx(v,{id:"addresses.confirm-created-address-map.warning"})}),s.jsx(UC,{showAddressLine2:r,addressLine2Label:a,isAddressLine2Required:i,showDeliveryInstructions:o,defaultValues:f,submitLabelId:"addresses.confirm-created-address-map.submit",onEdit:c,onSubmit:l})]})})}const PJ=({actions:e,onConfirm:t,onVisibleComponentChange:n})=>{const o=Ls(),r=M(),a=Ug(),i=!E(D("daddi")),[l,c]=h.useState([]),[d,u]=h.useState(),[m,g]=h.useState(),[f,y]=h.useState(""),[I,S]=rP(f,"MANUAL_FORM_MAP"),{addressGeocoding:C,addressLookup:_,postCustomerAddresses:A,getDeliverability:x}=e,[R,O]=h.useState("FORM"),N=E(cg),k=E(Vs),j=N[0],w=r.formatMessage(`address.form.field.country.name.${j}`);h.useEffect(()=>{n(R)},[R]);const L=te=>{S(te);const ce={...te,country:w};u(ce),Promise.all([C(ce,j),_(ce,j,5)]).then(([de,ye])=>{const Ae=[de,...ye];c(Ae),O("SELECT_CANDIDATE_ADDRESS")}).catch(()=>{z.error("settings.address.book.add.modal.search.no.addresses")})},B=te=>{const ce=l[te];g(ce),y(ce.lookupId),te===0?(o.selectAddressModalClosed("selectAddress","original",te+1),O("CONFIRM_ADDRESS_MAP")):K(ce).then(de=>{const ye=de==="DELIVERABLE";o.selectAddressModalClosed("selectAddress","found",te+1,ye)})},W=te=>{const ce={...m,location:te};g(ce),K(ce).then(de=>{const ye=de==="DELIVERABLE",Ae=AJ(m.location,te);o.confirmAddressModalClosed("confirmAddress",Ae,ye)})},$=te=>{const ce={...m,addressName:te.nickname,deliveryInstructions:te.notes,formattedAddress:te.formattedAddress,language:k,countryCode:j,addressDetails:{...m.addressDetails,addressLine2:te.addressLine2},location:m.location,lookupId:m.lookupId};A(ce).then(de=>a(de.addressId)).then(({addressId:de,deliveryDestinationId:ye})=>{t&&t(de,ye)}).catch(()=>{z.error("toast.notification.generic.error")})},K=te=>x({postalCode:te.addressDetails.postalCode,latitude:te.location.latitude,longitude:te.location.longitude}).then(({deliverability:ce})=>(ce==="DELIVERABLE"?O("CONFIRMATION_FORM"):z.error("settings.addresses.alert.nondeliverable"),ce)).catch(()=>{z.error("toast.notification.generic.error")}),Q=()=>{o.saveAddressModalClosed("editAddress"),O("FORM")},X=()=>{o.saveAddressModalClosed("back"),O("SELECT_CANDIDATE_ADDRESS")},re=()=>{o.selectAddressModalClosed("back"),O("FORM")},ue=()=>{o.confirmAddressModalClosed("back"),O("SELECT_CANDIDATE_ADDRESS")};switch(R){case"CONFIRMATION_FORM":return s.jsx(FT,{address:m,onEdit:Q,onSubmit:$,onBack:X,showDeliveryInstructions:i,showAddressLine2:XL(d)});case"SELECT_CANDIDATE_ADDRESS":return s.jsx(rDt,{addresses:l,onSubmit:B,onBack:re});case"CONFIRM_ADDRESS_MAP":return s.jsx(OJ,{address:m,onSubmit:W,onBack:ue});case"FORM":default:return s.jsx(oP,{formFields:I,onSubmit:L})}};PJ.fetchData=({context:{store:e}})=>e.dispatch(Wc.fetchNewAddressFields(void 0,"MANUAL_FORM_MAP"));const NJ=ee("ADDRESS_GEOCODING"),CDt=(e,t)=>({type:"API",payload:{url:`/v3/address-geocoding?countryCode=${t}`,service:"webaddressws",pathPrefix:{client:"/api/address",server:"/core-api"},options:{method:"POST",body:e},...NJ}}),TDt={types:{ADDRESS_GEOCODING:NJ},addressGeocoding:CDt},_Dt=(e,t)=>n=>n(TDt.addressGeocoding(e,t)).then(o=>o.payload.responseData),LJ={addressGeocoding:_Dt},vDt=ot({addressGeocoding:LJ.addressGeocoding,addressLookup:pP.addressLookup,postCustomerAddresses:Ju.postCustomerAddresses,getDeliverability:wT}),ADt=ke(null,vDt)(PJ),bDt=({modalName:e=lr,visibleComponent:t,onModalClose:n,onAddressSave:o})=>{const r=F(),a=E(Ue(e)),i=Ls(),l=h.useRef(t||"FORM"),c=m=>{l.current=m},d=m=>{const g=bJ(m);switch(l.current){case"CONFIRMATION_FORM":i.saveAddressModalClosed(g);break;case"SELECT_CANDIDATE_ADDRESS":i.selectAddressModalClosed(g);break;case"CONFIRM_ADDRESS_MAP":i.confirmAddressModalClosed(g);break;case"FORM":default:i.addAddressModalClosed(g)}n(),r(Z.closeModal())},u=(m,g)=>{o(m,g),r(Z.closeModal())};return s.jsx(G,{isOpen:a,onRequestClose:d,children:s.jsx(G.Body,{children:s.jsx(ADt,{onConfirm:u,onVisibleComponentChange:c})})})};function Bh({id:e,values:t,...n}){const o=M();let r=o.formatMessage(e);if(t){const a=Pre({id:e,defaultMessage:r.replace(/<([^>]+)>/g,"'<$1>'")});r=o.formatMessage(a,t).replace(/'<([^']+)'?>/g,"<$1>")}return s.jsx("span",{...n,dangerouslySetInnerHTML:{__html:Bu(r)}})}const xDt="_header_gzwoo_1",RDt="_header__row_gzwoo_20",DDt="_header__navbar_gzwoo_46",ODt="_header__item_gzwoo_61",PDt="_header__logo_gzwoo_77",NDt="_header__search_gzwoo_106",LDt="_matchingTerm_gzwoo_172",kDt="_header__bottom_gzwoo_180",gE={header:xDt,"header--overlay-visible":"_header--overlay-visible_gzwoo_13","header--smart-banner":"_header--smart-banner_gzwoo_16",header__row:RDt,"header__nav-button":"_header__nav-button_gzwoo_34",header__navbar:DDt,"header--alternate":"_header--alternate_gzwoo_57",header__item:ODt,"header__item--lg":"_header__item--lg_gzwoo_68",header__logo:PDt,"header__logo--s":"_header__logo--s_gzwoo_83","header__logo--l":"_header__logo--l_gzwoo_91",header__search:NDt,"header__search-list":"_header__search-list_gzwoo_121","header__search-list-item":"_header__search-list-item_gzwoo_159",matchingTerm:LDt,header__bottom:kDt},MDt=T(ii)`
    min-inline-size: 0;
    border-start-end-radius: var(--salt-radius-default) !important;
    border-end-end-radius: var(--salt-radius-default) !important;
`,jDt=T.form`
    inline-size: 100%;
    position: relative;
`;function wDt(){const e=h.useRef(null),[t,n]=h.useState(500),o=()=>{if(e.current){const r=e.current.offsetWidth;n(r)}};return h.useEffect(()=>(o(),window.addEventListener("resize",o),()=>{window&&window.removeEventListener("resize",o)}),[]),{inputRef:e,inputWidth:t}}const FDt=T.ul`
    position: fixed;
    padding: 0;
    inline-size: ${e=>e.width}px;
    max-block-size: 42.3vb;
    overflow-y: auto;
`,BDt=T.li`
    :hover {
        text-decoration: none;
    }
`,NU=Wl.bind(gE),JL=({id:e,placeholderMessage:t,hasError:n,onChange:o,onItemSelected:r,onScrollEnd:a,info:i,children:l})=>{const c=h.useRef(null),[d,u]=h.useState(!0),{inputRef:m,inputWidth:g}=wDt();h.useEffect(()=>{const S=C=>{c.current&&!c.current.contains(C.target)&&u(!1)};return window.addEventListener("mousedown",S),()=>{window&&window.removeEventListener("mousedown",S)}},[]);const f=()=>{u(!0)},y=S=>{S.currentTarget.scrollHeight-S.currentTarget.scrollTop===S.currentTarget.clientHeight&&a&&a()},I=S=>{o(S.target.value)};return s.jsxs(jDt,{ref:c,onSubmit:S=>S.preventDefault(),children:[s.jsx(MDt,{hideLabel:!0,last:!0,label:t,ref:m,id:e,"data-test":`${e}-input`,name:e,placeholder:t,input:{onFocus:f,onChange:I},hasError:n,meta:{invalid:!1,touched:!1}}),d&&s.jsxs(FDt,{className:NU("header__search-list"),"data-test":"search-suggestions-list",onScroll:y,width:g,children:[h.Children.count(l)>0&&i&&s.jsx("div",{className:"salt-p-y--2 salt-p-x--4",children:s.jsx(P,{children:i})}),h.Children.map(l,(S,C)=>s.jsxs("div",{children:[s.jsx(Zn,{}),s.jsx(BDt,{className:NU("header__search-list-item","salt-p--1"),"data-test":"search-suggestions-item",onClick:()=>{u(!1),r(C)},children:S})]}))]})]})},kJ=T(Bh)`
    a {
        color: var(--salt-text-color);
        text-decoration: underline;

        &:hover {
            text-decoration: none;
        }

        &:visited {
            color: var(--salt-text-color);
        }
    }
`;T(b)`
    border-inline-start: none;
    border-start-start-radius: 0;
    border-end-start-radius: 0;
`;const UDt=T.div`
    display: flex;
    flex-direction: column;
    flex-basis: 100%;
    min-block-size: calc(var(--salt-spacing-1) * 50);
`,GDt=T(se)`
    flex-grow: 1;
`,LU=T(b)`
    flex: 1 1 0;
`,$Dt=({onEnterAddressManually:e,onSubmit:t,postCodeRegExp:n=/^[A-Za-z0-9 ]*$/g,actions:o,countryCode:r})=>{const a=Ls(),i=M(),[l,c]=h.useState([]),[d,u]=h.useState(),[m,g]=h.useState(!1),[f,y]=h.useState(!1),[I,S]=h.useState(!1),[C,_]=h.useState(!1),A=i.formatMessage("settings.address.book.add.modal.postcode.placeholder"),x=i.formatMessage("addresses.postcode-lookup.continue"),R=i.formatMessage("addresses.postcode-lookup.enter-address-manually"),O=B=>{const W=l[B];u(W)},k=Jr(B=>{const W=n.test(B);if(g(!1),S(!1),_(!1),c([]),!B){a.searchAddressPostcodeEndTyping(0,!1),g(!0);return}if(!W){a.searchAddressPostcodeEndTyping(0,!0,"invalid postcode"),S(!0);return}j(B)},500),j=B=>{y(!1),c([]),B&&o.addressLookupByPostcode(B,r).then(W=>{c(W),W.length===0?(a.searchAddressPostcodeEndTyping(0,!0,"no results"),y(!0)):a.searchAddressPostcodeEndTyping(W.length,!0)}).catch(W=>{let $="toast.notification.generic.error";W.statusCode===400?($="settings.addresses.alert.no.areas.found",_(!0)):z.error($),a.searchAddressPostcodeEndTyping(0,!0,$)})},w=()=>{if(a.continueAddressAddButtonClicked(),!d){g(!0),document.getElementById("postcode-search")?.focus();return}t(d)},L=(B,W,$)=>s.jsx(P,{className:"salt-p-b--2 salt-d--inline-block","data-test":W,bold:$,children:B.formattedAddress});return s.jsxs(se,{gap:["sm"],children:[s.jsx(rs,{title:"addresses.postcode-lookup.title"}),s.jsx(ne,{as:"h1",children:s.jsx(v,{id:"addresses.postcode-lookup.title"})}),s.jsx(JL,{id:"postcode-search",placeholderMessage:A,hasError:m||f||I||C,onChange:k,onItemSelected:O,children:l.map(B=>L(B,"address-search-item-dropdown"))}),s.jsxs(UDt,{children:[C&&s.jsx(P,{children:s.jsx(kJ,{id:"settings.address.book.add.modal.undeliverable"})}),m&&s.jsx(P,{intent:"error",role:"alert",className:"salt-p-b--2",children:s.jsx("i",{children:s.jsx(v,{id:"settings.address.postcode.required.error.a11y"})})}),f&&s.jsx(P,{intent:"error",role:"alert",className:"salt-p-b--2",children:s.jsx("i",{children:s.jsx(v,{id:"addresses.postcode-lookup.no-results-found"})})}),I&&s.jsx(P,{intent:"error",role:"alert",className:"salt-p-b--2",children:s.jsx("i",{children:s.jsx(v,{id:"settings.address.book.add.modal.postcode.error"})})}),d&&L(d,"selected-address",!0)]}),s.jsxs(GDt,{gap:["sm"],direction:"column",directionSmUp:"row-reverse",children:[s.jsx(LU,{intent:"primary",onClick:w,"data-test":"continue-button",children:s.jsx(b.Text,{children:x})}),s.jsx(LU,{intent:"secondary",onClick:e,"data-test":"enter-address-manually-button",children:s.jsx(b.Text,{children:R})})]})]})},Ev="add-address-modal-postcode-header",HDt=D("m.la.h"),VDt={actions:p.shape({addCustomerAddress:p.func.isRequired,getHomeDeliveryDestinationIdByAddressId:p.func.isRequired,modalClose:p.func.isRequired,getCurrentCustomer:p.func.isRequired,fetchAddressesByPostcode:p.func.isRequired}).isRequired,onAddressSave:p.func.isRequired,onModalClose:p.func.isRequired,customerLastUpdated:p.number,hasAddresses:p.bool.isRequired,registrationPostcode:p.string.isRequired,modalLeftAlignEnabled:p.bool,postCodeMask:p.string,modalName:p.string},YDt={isOpen:!1,customerLastUpdated:void 0,modalLeftAlignEnabled:!1,postCodeMask:"",modalName:lr},ek=({actions:e,onAddressSave:t,onModalClose:n,customerLastUpdated:o,hasAddresses:r,registrationPostcode:a,modalLeftAlignEnabled:i,postCodeMask:l,modalName:c})=>{const d=Ls(),u=M(),m=Gn({mode:"onBlur"}),{isValid:g}=Nre({control:m.control}),[f,y]=h.useState(void 0),[I,S]=h.useState(!1),C=E(Ue(c));h.useEffect(()=>{!o&&!r&&e.getCurrentCustomer()},[]);const _=k=>{y(void 0),e.modalClose(),S(!1),d.cancelButtonClicked(k),d.addressLookupAbandonedGA4(),n()},A=({postcode:k})=>{const j={postCodeUndeliverable:!1,postCodeNotFound:!1,postCodeInvalidCharacters:!1},w=({payload:B})=>{const{responseData:W}=B;y(W),S(!1),d.findAddressButtonClicked(j)},L=B=>{j.postCodeUndeliverable=B.statusCode===400,j.postCodeNotFound=B.statusCode===404,B.statusCode===404&&d.addressLookupAddressNotFound(),y(void 0),S(!0),d.findAddressButtonClicked(j)};return e.fetchAddressesByPostcode(k,!0).then(w).catch(L)},x=()=>{y(void 0),S(!1),m.reset()},R=()=>{const k=m.getValues();g&&k.nickname&&e.addCustomerAddress(k).then(j=>e.getHomeDeliveryDestinationIdByAddressId(j)).then(({addressId:j,deliveryDestinationId:w})=>{d.addAddressSuccess(),e.modalClose(),x(),t(j,w)})},O=()=>{const{nickname:k,notes:j}=m.getValues();d.saveAddressButtonClicked({missingMandatoryField:!k,addressNameFilled:!!k,isDeliveryInstructionsFilled:!!j}),m.handleSubmit(R)()},N=()=>{const k=m.getValues();return!g||!k.nickname};return s.jsxs(G,{isOpen:C,onRequestClose:()=>_("cross icon"),aria:{labelledby:Ev},children:[s.jsx(G.Header,{align:i?"left":"center",children:s.jsx(ne,{as:"h1",id:Ev,"data-test":Ev,children:s.jsx(v,{id:"settings.address.book.add.modal.title"})})}),s.jsxs(G.Body,{children:[s.jsx("div",{className:"salt-m-b--4","data-test":"lookup-form",children:s.jsx(U6,{initialValues:r?{}:{postcode:a},onChange:x,onSubmit:A,isErrorVisible:I,postCodeRegExp:new RegExp(l),sendAnalytics:d})}),I&&s.jsx("div",{className:"salt-p-b--4",children:s.jsx(P,{children:s.jsx(kJ,{id:"settings.address.book.add.modal.undeliverable"})})}),s.jsx($n,{...m,children:s.jsx(MXe,{addresses:f,handleSubmit:R,sendAnalytics:d})})]}),s.jsxs(G.Footer,{align:i?"left":"center",children:[s.jsx(b,{fill:!0,intent:"secondary","data-test":"addresses-cancel-button",onClick:()=>_("cancel button"),children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.button.cancel"})})}),s.jsx(b,{fill:!0,intent:"primary",disabled:N(),onClick:O,"data-test":"addresses-submit-button","aria-label":u.formatMessage("settings.address.book.add.modal.submit.aria.label"),className:"salt-m-l--2",children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.add.modal.submit"})})})]})]})};ek.propTypes=VDt;ek.defaultProps=YDt;const WDt=e=>({customerLastUpdated:ope(e),hasAddresses:mge(e),registrationPostcode:npe(e),modalLeftAlignEnabled:HDt(e),postCodeMask:qb(e)}),qDt=ot({addCustomerAddress:oI.addCustomerAddress,getHomeDeliveryDestinationIdByAddressId:lP.getHomeDeliveryDestinationIdByAddressId,modalClose:Z.closeModal,getCurrentCustomer:bs.getCurrentCustomer,fetchAddressesByPostcode:wn.fetchAddressesByPostcode}),KDt=ke(WDt,qDt)(ek),zDt=e=>(t="",n)=>t.length<=e?t:n,QDt=()=>{const e=M(),t=E(dp),n=E(r=>qe(r,"validation-address-client-name-max-chars")),o={detailsLabel:e.formatMessage("settings.address.book.add.modal.details.label"),detailsPlaceholder:e.formatMessage("settings.address.book.add.modal.details.placeholder"),restrictedCharsMessage:e.formatMessage("validation.form.restricted.chars")};return s.jsx(Jo,{validate:r=>dP(t,o.restrictedCharsMessage)(r),placeholder:o.detailsPlaceholder,name:"details","data-test":"addresses-details-input","data-pii":"true",autoComplete:"off",label:o.detailsLabel,normalize:zDt(n)})},XDt=({handleSubmit:e})=>{const t=!E(D("daddi")),n=$o();return s.jsxs("form",{onSubmit:n.handleSubmit(e),"data-test":"add-address-modal-international-details-form",children:[s.jsxs(h.Fragment,{children:[s.jsx("div",{className:"salt-m-t--4 salt-m-b--8",children:s.jsx(QDt,{})}),s.jsx(Zn,{}),s.jsxs("div",{className:"salt-m-t--4 salt-m-b--8",children:[s.jsx(uP,{}),t&&s.jsx(HC,{})]})]}),s.jsx("input",{type:"submit",hidden:!0})]})},ZDt={selectedAddress:p.shape({id:p.string.isRequired,formattedAddress:p.string,deliverable:p.bool}).isRequired,detailsFormRef:p.shape({current:p.shape()}),onDetailsFormSubmit:p.func.isRequired,onSearchAgain:p.func.isRequired,submitError:p.bool.isRequired,fetchError:p.bool.isRequired,detailsFormContext:p.shape({handleSubmit:p.func.isRequired}).isRequired,sendAnalytics:p.shape({}).isRequired},JDt={detailsFormRef:ie.createRef()},tk=({selectedAddress:e,onDetailsFormSubmit:t,onSearchAgain:n,submitError:o,detailsFormContext:r,fetchError:a,sendAnalytics:i})=>{const l=()=>s.jsx(se,{justify:"space-between",children:s.jsx(bn,{children:s.jsx(P,{bold:!0,children:s.jsx(v,{id:"common.address"})})})}),c=()=>s.jsxs(h.Fragment,{children:[s.jsx($n,{...r,children:s.jsx(XDt,{handleSubmit:r.handleSubmit(t),sendAnalytics:i})}),o&&s.jsx(Ce,{"data-test":"details-content-submission-error-alert",text:s.jsx(v,{id:"settings.address.book.add.modal.submit.error"})})]});return s.jsxs(h.Fragment,{children:[l(),a?s.jsx(Ce,{"data-test":"details-content-fetch-error-alert",text:s.jsx(v,{id:"settings.address.book.add.modal.fetch.error"})}):s.jsx("div",{className:"salt-m-y--2",children:s.jsx(P,{"data-pii":"true","data-test":"details-content-selected-address",children:e.formattedAddress})}),s.jsx("div",{className:"salt-m-y--2",children:s.jsx(b,{intent:"secondary","data-test":"details-content-search-again-link",onClick:n,children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.add.modal.search.again"})})})}),e.deliverable&&c(),!a&&!e.deliverable&&s.jsx("div",{className:"salt-m-t--8",children:s.jsx(Ce,{showIcon:!1,"data-test":"details-content-undeliverable-address-error-alert",text:s.jsx(v,{id:"settings.address.book.add.modal.undeliverable"})})})]})};tk.propTypes=ZDt;tk.defaultProps=JDt;const eOt=({addresses:e,onSelectHandler:t,onSubmitFetchAddresses:n,fetchError:o,onAddressSelectFocus:r})=>{const a=M(),[i,l]=h.useState(""),c=h.useMemo(()=>e?.map(({id:m,formattedAddress:g})=>({value:m,name:g}))??[],[e]),d=m=>{m.preventDefault(),l("");const g=new FormData(m.currentTarget).get("search-label")?.toString();n(g??"")},u={searchLabelText:a.formatMessage("settings.address.book.add.international.modal.search.label"),searchPlaceholderText:a.formatMessage("settings.address.book.add.international.modal.search.placeholder"),clearButtonAriaLabelText:a.formatMessage("salt.form.text-field.clear-button.a11y.label"),addAddressSelectLabelText:a.formatMessage("settings.address.book.add.modal.select.address.label"),addAddressSelectPlaceholderText:a.formatMessage("settings.address.book.add.modal.select.address.placeholder"),searchRequiredErrorMessage:a.formatMessage("validation.msg.required")};return s.jsxs(h.Fragment,{children:[s.jsxs(mt,{id:"modal-lookup-content-form",onSubmit:d,children:[s.jsx(mt.TextField,{name:"search-label",className:"salt-m-b--4",errorMessage:i,label:{text:u.searchLabelText},placeholder:u.searchPlaceholderText,"data-test":"add-address-modal-international-search-address-input",clearButton:{ariaLabel:u.clearButtonAriaLabelText}}),o&&s.jsx(Ce,{className:"salt-m-b--4",showIcon:!1,"data-test":"add-address-modal-international-no-addresses-lookup-error",text:e?s.jsx(v,{id:"settings.address.book.add.modal.search.no.addresses","data-test":"lookup-content-search-no-addresses-message"}):s.jsx(v,{id:"settings.address.book.add.modal.search.error","data-test":"lookup-content-search-error-message"})}),s.jsx(b,{fill:!0,type:"submit",intent:"primary",className:"salt-m-b--4","data-test":"add-address-modal-international-find-address-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.add.modal.find.button"})})})]}),!!e?.length&&s.jsxs(h.Fragment,{children:[s.jsx(mt.DropdownSelect,{className:"salt-m-b--4",onFocus:r,onOptionChange:t,options:c,name:"add-address-modal-international-address-select","data-test":"add-address-modal-international-address-select",label:{text:u.addAddressSelectLabelText},placeholder:u.addAddressSelectPlaceholderText}),s.jsx(se,{justify:"center",children:s.jsx(me,{name:"powered_by_google",height:18,width:144})})]})]})},tOt=D("m.la.h"),sOt={actions:p.shape({addCustomerAddress:p.func.isRequired,addCustomerAddressWithPostcodeUpdate:p.func.isRequired,getHomeDeliveryDestinationIdByAddressId:p.func.isRequired,modalClose:p.func.isRequired,analyticsEvent:p.func.isRequired,fetchAddressesBySearchTerm:p.func.isRequired,fetchDetailsForAddress:p.func.isRequired}).isRequired,onAddressSave:p.func.isRequired,onModalClose:p.func.isRequired,pagePath:p.string.isRequired,modalLeftAlignEnabled:p.bool,modalName:p.string},nOt={modalLeftAlignEnabled:!1,modalName:lr},sk=({actions:e,onAddressSave:t,onModalClose:n,modalLeftAlignEnabled:o,pagePath:r,modalName:a})=>{const i=Ls(),l=Gn({mode:"onBlur"}),c=E(Ue(a)),[d,u]=h.useState({addresses:void 0,selectedAddress:void 0,fetchError:!1,submitError:!1,saveAddressIsFetching:!1,failedSearches:[],postcodeUpdated:!1,isSubmitted:!1}),m=({value:j})=>{const w=d.addresses.filter(({id:L})=>L===j).pop();u({...d,selectedAddress:{...w,isFetching:!0}}),C(w)},g=(j,w)=>{w.preventDefault();const L=()=>{const{addCustomerAddress:B,addCustomerAddressWithPostcodeUpdate:W}=e;return d.postcodeUpdated?W:B};d.isSubmitted||(u({...d,saveAddressIsFetching:!0,isSubmitted:!0}),L()({...d.selectedAddress,...l.getValues()}).then(W=>e.getHomeDeliveryDestinationIdByAddressId(W)).then(({addressId:W,deliveryDestinationId:$})=>(u({...d,submitError:!1}),t(W,$))).then(()=>{i.addAddressSuccess(),_()}).catch(()=>{u({...d,submitError:!0,saveAddressIsFetching:!1,isSubmitted:!1})}))},f=()=>{A(),i.findAddressAgainButtonClicked()},y=j=>{if(j){S(j);return}const w={addressNotFound:!1,addressInvalidCharacters:!0};i.findAddressButtonClicked(w)},I=j=>{j.preventDefault()},S=j=>{const w={addressNotFound:!1,addressInvalidCharacters:!1},L=W=>{const $=W.payload.responseData;u(K=>({lastSearchString:j,fetchError:!1,addresses:$,failedSearches:$.length>0?K.failedSearches:K.failedSearches.concat(j)})),$.length===0?(i.addressLookupAddressNotFound(),w.addressNotFound=!0):i.addressLookupSuccess(),i.findAddressButtonClicked(w)},B=({statusCode:W})=>{u($=>({...d,lastSearchString:j,failedSearches:$.failedSearches.concat(j),fetchError:!0,addresses:W===404?[]:void 0})),W===500&&(w.addressInvalidCharacters=!0),W===404&&(i.addressLookupAddressNotFound(),w.addressNotFound=!0),i.findAddressButtonClicked(w)};return e.fetchAddressesBySearchTerm(j).then(L).catch(B)},C=j=>{const w=()=>{u({...d,fetchError:!0,selectedAddress:{...j,isFetching:!1},addresses:void 0})},L=W=>{const{lastSearchString:$,failedSearches:K}=d;if(W.deliverable){const X={type:xe.ADDRESS_LOOKUP_SELECTED,lastSearchString:dm($),failedSearches:K.map(dm).join(", ")};i.addressLookupSelected(X),i.addressLookupAddressSelected()}else{const X={addressDescription:dm(j.value)};i.addressLookupUndeliverable(X),i.addressLookupUndeliverableGA4()}const Q={};W.deliverable||(Q.addressNotDeliverable=!0),i.dropdownAddressSelected(Q),u({...d,fetchError:!1,selectedAddress:{...j,...W,isFetching:!1},failedSearches:[],lastSearchString:void 0})},B=!r.includes(Qb());return e.fetchDetailsForAddress(j.id,B).then(L).catch(w)},_=j=>{const{selectedAddress:w,fetchError:L,failedSearches:B,lastSearchString:W}=d;if(w===void 0||L||!w.deliverable){const $={lastSearchString:dm(W),failedSearches:B.map(dm).join(", ")};i.addressLookupAbandoned($),i.addressLookupAbandonedGA4()}A(),e.modalClose(),l.reset(),j&&i.cancelButtonClicked(j),n()},A=()=>{u({lastSearchString:void 0,failedSearches:[],selectedAddress:void 0,addresses:void 0,fetchError:!1,submitError:!1,saveAddressIsFetching:!1,postcodeUpdated:!1,isSubmitted:!1})},x=()=>{i.addressDropdownOpened()},R=()=>{const{addresses:j,selectedAddress:w,fetchError:L,submitError:B}=d;return w===void 0?s.jsx(eOt,{addresses:j,onSubmitFetchAddresses:y,onSubmitHandler:I,onSelectHandler:m,fetchError:L,onAddressSelectFocus:x}):w.isFetching?s.jsxs(h.Fragment,{children:[s.jsx("div",{className:"salt-m-t--8 salt-m-b--2",children:s.jsx(Pe,{className:"salt-m-b--2",height:"15px"})}),s.jsxs("div",{className:"salt-m-t--8 salt-m-b--2",children:[s.jsx(Pe,{className:"salt-m-b--2",height:"15px"}),s.jsx(Pe,{className:"salt-m-b--2",height:"15px"}),s.jsx(Pe,{className:"salt-m-b--2",height:"15px",width:"150px"})]})]}):s.jsx(tk,{selectedAddress:w,onDetailsFormSubmit:g,onSearchAgain:f,submitError:B,fetchError:L,detailsFormContext:l,sendAnalytics:i})},O=j=>{const w=l.getValues(),L={missingMandatoryField:!w.nickname,additionalDetailsFilled:!!w.details,addressNameFilled:!!w.nickname,isDeliveryInstructionsFilled:!!w.notes};return Object.values(l.formState.errors).some(W=>W.type.includes("validate"))&&(L.invalidCharacters=!0),i.saveAddressButtonClicked(L),l.handleSubmit(g)(j)},N=()=>{const{selectedAddress:j,saveAddressIsFetching:w}=d;return j?s.jsxs(G.Footer,{align:o?"left":"center",children:[s.jsx(b,{fill:!0,intent:"secondary","data-test":"intl-address-modal-cancel-button",onClick:()=>_("cancel button"),children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.button.cancel"})})}),j.deliverable&&j.isFetching===!1&&s.jsx(b,{className:"salt-m-l--2",fill:!0,intent:"primary",disabled:w,onClick:O,"data-test":"addresses-submit-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.add.modal.submit"})})})]}):null},k="add-address-modal-international-header";return s.jsxs(G,{isOpen:c,onRequestClose:()=>_("cross icon"),aria:{labelledby:k},viewHeight:d.selectedAddress?void 0:"auto",children:[s.jsx(G.Header,{align:o?"left":"center",children:s.jsx(ne,{as:"h2",id:k,"data-test":k,children:s.jsx(v,{id:"settings.address.book.add.modal.title"})})}),s.jsx(G.Body,{children:R()}),N()]})};sk.propTypes=sOt;sk.defaultProps=nOt;const oOt=e=>({pagePath:_p(e),modalLeftAlignEnabled:tOt(e),isOpen:Ue(lr)(e)}),rOt=ot({analyticsEvent:U.analyticsEvent,addCustomerAddress:oI.addCustomerAddress,addCustomerAddressWithPostcodeUpdate:oI.addCustomerAddressWithPostcodeUpdate,getHomeDeliveryDestinationIdByAddressId:lP.getHomeDeliveryDestinationIdByAddressId,modalClose:Z.closeModal,fetchAddressesBySearchTerm:wn.fetchAddressesBySearchTerm,fetchDetailsForAddress:Ju.fetchDetailsForAddress}),aOt=ke(oOt,rOt)(sk);T(b)`
    border-inline-start: none;
    border-start-start-radius: 0;
    border-end-start-radius: 0;
`;const iOt=T.div`
    display: flex;
    flex-direction: column;
    flex-basis: 100%;
    min-block-size: calc(var(--salt-spacing-1) * 50);
`,lOt=T.div`
    display: flex !important;
    flex-flow: column wrap !important;
    gap: var(--salt-spacing-1);
`,cOt=T(se)`
    flex-grow: 1;
`,dOt=T(b)`
    flex: 1 1 0;
`,uOt=({countryCode:e,actions:t,onSubmit:n})=>{const o=M(),r=Ls(),[a,i]=h.useState([]),[l,c]=h.useState(),[d,u]=h.useState(!1),[m,g]=h.useState(!1),[f,y]=h.useState(!1),I=h.useRef(null),S=h.useRef(""),[C,_]=h.useState(!1),[A,x]=h.useState(!1),R=o.formatMessage("addresses.address-search.input.placeholder"),O=o.formatMessage("addresses.address-search.continue"),N=E(Ege),k=E(fge),j=E(yge),w=E(dp),L=new RegExp(w),B=ye=>{const Ae=a[ye];_(!1),c(Ae),r.dropdownAddressSelected({position:ye})},W=ye=>{const Ae=ye.trim(),Je=3;if(S.current===Ae)return;if(S.current=Ae,x(!1),g(!1),u(!1),y(!1),i([]),Ae.length===0){u(!0);return}if(Ae.length<Je){x(!0);return}const Ie=L.test(Ae);if(!Ae){r.searchAddressPostcodeEndTyping(0,!1),u(!0);return}if(!Ie){r.searchAddressPostcodeEndTyping(0,!0,"invalid address"),y(!0);return}$(Ae)},$=ye=>{I.current=null,g(!1),i([]),ye&&t.addressLookupBySearchTerm(ye,e,void 0,N).then(Ae=>{I.current=Ae.metadata.nextPageToken;const Je=Ae.content.slice(0,j);i(Je),Ae.content.length===0?(g(!0),r.searchAddressPostcodeEndTyping(0,!0,"no results")):r.searchAddressPostcodeEndTyping(Ae.content.length,!0)}).catch(Ae=>{const Je=Ae.statusCode===400?"settings.addresses.alert.no.areas.found":"toast.notification.generic.error";z.error(Je),r.searchAddressPostcodeEndTyping(0,!0,Je)})},K=()=>{if(!l){S.current.length===0?(r.searchAddressContinueClicked(a.length,!1,"no address selected"),u(!0)):r.searchAddressContinueClicked(a.length,!0,"no address selected"),document.getElementById("address-search")?.focus();return}Q().then(({deliverability:ye})=>(ye==="DELIVERABLE"?(r.searchAddressContinueClicked(a.length,!0),n(l)):(r.searchAddressContinueClicked(a.length,!0,"address not deliverable"),_(!0)),ye)).catch(()=>{z.error("toast.notification.generic.error"),r.searchAddressContinueClicked(a.length,!0,"error")})},Q=()=>l?l.location?t.getDeliverability({postalCode:l.addressDetails.postalCode,latitude:l.location.latitude,longitude:l.location.longitude}):t.getDeliverabilityByAddressDetails(l.addressDetails,e):Promise.reject(),X=()=>I.current!==null&&j>a.length,re=()=>{const ye=a.length;return ye<=N&&!X()?ye:`${N}+`},ue=()=>a.length>=k,te=()=>s.jsxs(se,{direction:"column",gap:["sm"],children:[s.jsx(P,{bold:!0,children:s.jsx(v,{id:"addresses.address-search.results",values:{results:re()}})}),ue()&&s.jsx(P,{children:s.jsx(v,{id:"addresses.address-search.refine"})})]}),ce=(ye,Ae)=>s.jsxs(lOt,{"data-test":Ae,children:[s.jsxs(P,{children:[s.jsxs("b",{children:[s.jsx(v,{id:"addresses.address-search.address-type-new"}),":"]})," ",ye.formattedAddress]}),s.jsxs(P,{children:[s.jsxs("b",{children:[s.jsx(v,{id:"addresses.address-search.address-type-old"}),":"]})," ",ye.alternativeFormattedAddress]})]}),de=()=>{X()&&t.addressLookupBySearchTerm(S.current,e,I.current||void 0,N).then(ye=>{I.current=ye.metadata.nextPageToken;const Ae=[...a,...ye.content].slice(0,j);i(Ae)}).catch(ye=>{const Ae=ye.statusCode===400?"settings.addresses.alert.no.areas.found":"toast.notification.generic.error";z.error(Ae)})};return s.jsxs(se,{gap:["sm"],children:[s.jsx(rs,{title:"addresses.address-search.title"}),s.jsx(ne,{as:"h1",children:s.jsx(v,{id:"addresses.address-search.title"})}),s.jsx(JL,{id:"address-search",placeholderMessage:R,hasError:d||f||A,onChange:Jr(W,500),onItemSelected:B,onScrollEnd:de,info:te(),children:a.map(ye=>ce(ye,"address-search-item-dropdown"))}),s.jsxs(iOt,{children:[m&&s.jsx(P,{intent:"error",role:"alert",className:"salt-p-b--2",children:s.jsx("i",{children:s.jsx(v,{id:"addresses.address-search.no-results-found"})})}),f&&s.jsx(P,{intent:"error",role:"alert",className:"salt-p-b--2",children:s.jsx("i",{children:s.jsx(v,{id:"addresses.address-search.invalid-error"})})}),A&&s.jsx(P,{intent:"error",role:"alert",className:"salt-p-b--2",children:s.jsx("i",{children:s.jsx(v,{id:"addresses.address-search.min-characters-error"})})}),d&&s.jsx(P,{intent:"error",role:"alert",className:"salt-p-b--2",children:s.jsx("i",{children:s.jsx(v,{id:"addresses.address-search.required-error"})})}),l&&ce(l,"address-search-item-selected"),C&&s.jsx(P,{bold:!0,intent:"error",role:"alert",className:"salt-m-t--2",children:s.jsx("i",{children:s.jsx(Bh,{id:"addresses.address-search.address-not-deliverable"})})}),!l&&s.jsxs("div",{children:[s.jsx(ne,{as:"h2",className:"salt-p-b--2",children:s.jsx(v,{id:"addresses.address-search.instructions.title"})}),s.jsx(P,{children:s.jsx(Bh,{id:"addresses.address-search.instructions.text"})})]})]}),s.jsx(cOt,{gap:["sm"],direction:"column",directionSmUp:"row-reverse",children:s.jsx(dOt,{intent:"primary",onClick:K,"data-test":"continue-button",children:s.jsx(b.Text,{children:O})})})]})},pOt=({actions:e,onConfirm:t,onVisibleComponentChange:n})=>{const o=Ls(),r=E(D("addl.mai")),a=Ug(),[i,l]=h.useState("SEARCH"),[c,d]=h.useState(),{postCustomerAddresses:u}=e,m=E(cg),g=E(Vs),f=m[0];h.useEffect(()=>{n(i)},[i]);const y=(C,_)=>{const A=C.addressLine2,x={...c,addressName:C.nickname,deliveryInstructions:C.notes,formattedAddress:C.formattedAddress,language:g,countryCode:f,location:c.location,lookupId:c.lookupId};A&&A.length>0&&(x.additionalInformation=A),u(x).then(R=>a(R.addressId)).then(({addressId:R,deliveryDestinationId:O})=>{t&&t(R,O)}).catch(()=>{z.error("toast.notification.generic.error"),_()})},I=()=>{o.saveAddressModalClosed("back"),l("SEARCH")},S=C=>{d(C),l("CONFIRM")};switch(i){case"CONFIRM":return s.jsx(FT,{address:c,showWarningIfAddressLine2Empty:!1,showMap:!1,showDeliveryInstructions:!1,addressLine2Label:"addresses.address-search.floor-door-number",isAddressLine2Required:r,onSubmit:y,onBack:I});case"SEARCH":default:return s.jsx(uOt,{actions:e,onSubmit:S,countryCode:f})}},mOt=ot({addressLookupBySearchTerm:pP.addressLookupBySearchTerm,postCustomerAddresses:Ju.postCustomerAddresses,getDeliverability:wT,getDeliverabilityByAddressDetails:Ju.getDeliverabilityByAddressDetails}),hOt=ke(null,mOt)(pOt),gOt=({modalName:e=lr,visibleComponent:t,onModalClose:n,onAddressSave:o})=>{const r=F(),a=E(Ue(e)),i=Ls(),l=h.useRef(t||"FORM"),c=m=>{l.current=m},d=()=>{l.current==="SEARCH"&&i.searchAddressModalClosed(),n(),r(Z.closeModal())},u=(m,g)=>{o(m,g),r(Z.closeModal())};return s.jsx(G,{isOpen:a,onRequestClose:d,children:s.jsx(G.Body,{children:s.jsx(hOt,{onConfirm:u,onVisibleComponentChange:c})})})},MJ=({actions:e,onConfirm:t,onVisibleComponentChange:n,postcodeMask:o})=>{const r=Ls(),a=M(),i=Ug(),l=!E(D("daddi")),[c,d]=h.useState(!1),[u,m]=h.useState("POSTCODE"),[g,f]=h.useState(),[y,I]=h.useState(),[S]=h.useState(""),[C]=rP(S,"MANUAL_FORM_MAP"),{addressGeocoding:_,postCustomerAddresses:A,getDeliverability:x}=e,R=E(cg),O=E(Vs),N=R[0],k=a.formatMessage(`address.form.field.country.name.${N}`),j="toast.notification.generic.error";h.useEffect(()=>{n(u)},[u]),h.useEffect(()=>{r.searchAddressPostcodeModalDisplayed()},[]);const w=te=>{d(!1),I(te),m("CONFIRMATION_FORM")},L=()=>{r.enterAddressManuallyButtonClicked(),d(!0),m("FORM")},B=()=>{r.saveAddressModalClosed("editAddress"),m(c?"FORM":"POSTCODE")},W=te=>{const ce={...y,addressName:te.nickname,deliveryInstructions:te.notes,formattedAddress:te.formattedAddress,language:O,countryCode:N,addressDetails:{...y.addressDetails,addressLine2:te.addressLine2},location:y.location,lookupId:y.lookupId};A(ce).then(de=>i(de.addressId)).then(({addressId:de,deliveryDestinationId:ye})=>{t&&t(de,ye)}).catch(()=>{z.error(j)})},$=()=>{r.saveAddressModalClosed("back"),m(c?"CONFIRM_ADDRESS_MAP":"POSTCODE")},K=te=>{const ce={...te,country:k};f(ce),_(ce,N).then(de=>{I(de),m("CONFIRM_ADDRESS_MAP")}).catch(de=>{const ye=de.statusCode===404?"settings.address.book.add.modal.search.no.addresses":"toast.notification.generic.error";z.error(ye)})},Q=()=>{m("POSTCODE")},X=te=>{const ce={...y,location:te};I(ce),ue(ce).then(de=>{const ye=de==="DELIVERABLE",Ae=AJ(y.location,te);r.confirmAddressModalClosed("confirmAddress",Ae,ye)})},re=()=>{r.confirmAddressModalClosed("back"),m("FORM")},ue=te=>x({postalCode:te.addressDetails.postalCode,latitude:te.location.latitude,longitude:te.location.longitude}).then(({deliverability:ce})=>(ce==="DELIVERABLE"?m("CONFIRMATION_FORM"):z.error("settings.addresses.alert.nondeliverable"),ce)).catch(()=>{z.error(j)});switch(u){case"POSTCODE":return s.jsx($Dt,{countryCode:N,onSubmit:w,onEnterAddressManually:L,postCodeRegExp:new RegExp(o),actions:e});case"CONFIRM_ADDRESS_MAP":return s.jsx(OJ,{address:y,onSubmit:X,onBack:re});case"CONFIRMATION_FORM":return s.jsx(FT,{address:y,onEdit:B,onSubmit:W,onBack:$,showDeliveryInstructions:l,showAddressLine2:g!=null&&XL(g)});case"FORM":default:return s.jsx(oP,{formFields:C,onSubmit:K,onBack:Q})}};MJ.fetchData=({context:{store:e}})=>e.dispatch(Wc.fetchNewAddressFields(void 0,"MANUAL_FORM_MAP"));const EOt=ot({addressGeocoding:LJ.addressGeocoding,postCustomerAddresses:Ju.postCustomerAddresses,getDeliverability:wT,addressLookupByPostcode:pP.addressLookupByPostcode}),fOt=e=>({postcodeMask:qb(e)}),yOt=ke(fOt,EOt)(MJ),IOt=({modalName:e=lr,onModalClose:t,onAddressSave:n})=>{const o=Ls(),r=F(),a=E(Ue(e)),i=d=>{const u=bJ(d);o.searchAddressPostcodeModalClosed(u),t(),r(Z.closeModal())},l=(d,u)=>{n(d,u),r(Z.closeModal())},c=()=>{};return s.jsx(G,{isOpen:a,onRequestClose:i,children:s.jsx(G.Body,{children:s.jsx(yOt,{onConfirm:l,onVisibleComponentChange:c})})})},SOt=()=>s.jsxs("svg",{"data-test":"google-icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 69 29",width:"66",height:"26",children:[s.jsxs("g",{opacity:".6",fill:"#fff",stroke:"#fff",strokeWidth:"1.5",children:[s.jsx("path",{d:"M17.4706 7.33616L18.0118 6.79504 17.4599 6.26493C16.0963 4.95519 14.2582 3.94522 11.7008 3.94522c-4.613699999999999 0-8.50262 3.7551699999999997-8.50262 8.395779999999998C3.19818 16.9817 7.0871 20.7368 11.7008 20.7368 14.1712 20.7368 16.0773 19.918 17.574 18.3689 19.1435 16.796 19.5956 14.6326 19.5956 12.957 19.5956 12.4338 19.5516 11.9316 19.4661 11.5041L19.3455 10.9012H10.9508V14.4954H15.7809C15.6085 15.092 15.3488 15.524 15.0318 15.8415 14.403 16.4629 13.4495 17.1509 11.7008 17.1509 9.04835 17.1509 6.96482 15.0197 6.96482 12.341 6.96482 9.66239 9.04835 7.53119 11.7008 7.53119 13.137 7.53119 14.176 8.09189 14.9578 8.82348L15.4876 9.31922 16.0006 8.80619 17.4706 7.33616z"}),s.jsx("path",{d:"M24.8656 20.7286C27.9546 20.7286 30.4692 18.3094 30.4692 15.0594 30.4692 11.7913 27.953 9.39011 24.8656 9.39011 21.7783 9.39011 19.2621 11.7913 19.2621 15.0594c0 3.25 2.514499999999998 5.6692 5.6035 5.6692zM24.8656 12.8282C25.8796 12.8282 26.8422 13.6652 26.8422 15.0594 26.8422 16.4399 25.8769 17.2905 24.8656 17.2905 23.8557 17.2905 22.8891 16.4331 22.8891 15.0594 22.8891 13.672 23.853 12.8282 24.8656 12.8282z"}),s.jsx("path",{d:"M35.7511 17.2905v0H35.7469C34.737 17.2905 33.7703 16.4331 33.7703 15.0594 33.7703 13.672 34.7343 12.8282 35.7469 12.8282 36.7608 12.8282 37.7234 13.6652 37.7234 15.0594 37.7234 16.4439 36.7554 17.2962 35.7511 17.2905zM35.7387 20.7286C38.8277 20.7286 41.3422 18.3094 41.3422 15.0594 41.3422 11.7913 38.826 9.39011 35.7387 9.39011 32.6513 9.39011 30.1351 11.7913 30.1351 15.0594 30.1351 18.3102 32.6587 20.7286 35.7387 20.7286z"}),s.jsx("path",{d:"M51.953 10.4357V9.68573H48.3999V9.80826C47.8499 9.54648 47.1977 9.38187 46.4808 9.38187 43.5971 9.38187 41.0168 11.8998 41.0168 15.0758 41.0168 17.2027 42.1808 19.0237 43.8201 19.9895L43.7543 20.0168 41.8737 20.797 41.1808 21.0844 41.4684 21.7772C42.0912 23.2776 43.746 25.1469 46.5219 25.1469 47.9324 25.1469 49.3089 24.7324 50.3359 23.7376 51.3691 22.7367 51.953 21.2411 51.953 19.2723v-8.8366zm-7.2194 9.9844L44.7334 20.4196C45.2886 20.6201 45.878 20.7286 46.4808 20.7286 47.1616 20.7286 47.7866 20.5819 48.3218 20.3395 48.2342 20.7286 48.0801 21.0105 47.8966 21.2077 47.6154 21.5099 47.1764 21.7088 46.5219 21.7088 45.61 21.7088 45.0018 21.0612 44.7336 20.4201zM46.6697 12.8282C47.6419 12.8282 48.5477 13.6765 48.5477 15.084 48.5477 16.4636 47.6521 17.2987 46.6697 17.2987 45.6269 17.2987 44.6767 16.4249 44.6767 15.084 44.6767 13.7086 45.6362 12.8282 46.6697 12.8282zM55.7387 5.22083v-.75H52.0788V20.4412H55.7387V5.220829999999999z"}),s.jsx("path",{d:"M63.9128 16.0614L63.2945 15.6492 62.8766 16.2637C62.4204 16.9346 61.8664 17.3069 61.0741 17.3069 60.6435 17.3069 60.3146 17.2088 60.0544 17.0447 59.9844 17.0006 59.9161 16.9496 59.8498 16.8911L65.5497 14.5286 66.2322 14.2456 65.9596 13.5589 65.7406 13.0075C65.2878 11.8 63.8507 9.39832 60.8278 9.39832 57.8445 9.39832 55.5034 11.7619 55.5034 15.0676 55.5034 18.2151 57.8256 20.7369 61.0659 20.7369 63.6702 20.7369 65.177 19.1378 65.7942 18.2213L66.2152 17.5963 65.5882 17.1783 63.9128 16.0614zM61.3461 12.8511L59.4108 13.6526C59.7903 13.0783 60.4215 12.7954 60.9017 12.7954 61.067 12.7954 61.2153 12.8161 61.3461 12.8511z"})]}),s.jsx("path",{d:"M11.7008 19.9868C7.48776 19.9868 3.94818 16.554 3.94818 12.341 3.94818 8.12803 7.48776 4.69522 11.7008 4.69522 14.0331 4.69522 15.692 5.60681 16.9403 6.80583L15.4703 8.27586C14.5751 7.43819 13.3597 6.78119 11.7008 6.78119 8.62108 6.78119 6.21482 9.26135 6.21482 12.341 6.21482 15.4207 8.62108 17.9009 11.7008 17.9009 13.6964 17.9009 14.8297 17.0961 15.5606 16.3734 16.1601 15.7738 16.5461 14.9197 16.6939 13.7454h-4.9931V11.6512h7.0298C18.8045 12.0207 18.8456 12.4724 18.8456 12.957 18.8456 14.5255 18.4186 16.4637 17.0389 17.8434 15.692 19.2395 13.9838 19.9868 11.7008 19.9868z",fill:"#4285F4"}),s.jsx("path",{d:"M29.7192 15.0594C29.7192 17.8927 27.5429 19.9786 24.8656 19.9786 22.1884 19.9786 20.0121 17.8927 20.0121 15.0594 20.0121 12.2096 22.1884 10.1401 24.8656 10.1401 27.5429 10.1401 29.7192 12.2096 29.7192 15.0594zM27.5922 15.0594C27.5922 13.2855 26.3274 12.0782 24.8656 12.0782S22.1391 13.2937 22.1391 15.0594C22.1391 16.8086 23.4038 18.0405 24.8656 18.0405S27.5922 16.8168 27.5922 15.0594z",fill:"#E94235"}),s.jsx("path",{d:"M40.5922 15.0594C40.5922 17.8927 38.4159 19.9786 35.7387 19.9786 33.0696 19.9786 30.8851 17.8927 30.8851 15.0594 30.8851 12.2096 33.0614 10.1401 35.7387 10.1401 38.4159 10.1401 40.5922 12.2096 40.5922 15.0594zM38.4734 15.0594C38.4734 13.2855 37.2087 12.0782 35.7469 12.0782 34.2851 12.0782 33.0203 13.2937 33.0203 15.0594 33.0203 16.8086 34.2851 18.0405 35.7469 18.0405 37.2087 18.0487 38.4734 16.8168 38.4734 15.0594z",fill:"#FABB05"}),s.jsx("path",{d:"M51.203 10.4357v8.8366C51.203 22.9105 49.0595 24.3969 46.5219 24.3969 44.132 24.3969 42.7031 22.7955 42.161 21.4897L44.0417 20.7095C44.3784 21.5143 45.1997 22.4588 46.5219 22.4588 48.1479 22.4588 49.1499 21.4487 49.1499 19.568V18.8617H49.0759C48.5914 19.4612 47.6552 19.9786 46.4808 19.9786 44.0171 19.9786 41.7668 17.8352 41.7668 15.0758 41.7668 12.3 44.0253 10.1319 46.4808 10.1319 47.6552 10.1319 48.5914 10.6575 49.0759 11.2323H49.1499V10.4357H51.203zM49.2977 15.084C49.2977 13.3512 48.1397 12.0782 46.6697 12.0782 45.175 12.0782 43.9267 13.3429 43.9267 15.084 43.9267 16.8004 45.175 18.0487 46.6697 18.0487 48.1397 18.0487 49.2977 16.8004 49.2977 15.084z",fill:"#4285F4"}),s.jsx("path",{d:"M54.9887 5.22083V19.6912H52.8288V5.220829999999999H54.9887z",fill:"#34A853"}),s.jsx("path",{d:"M63.4968 16.6854L65.1722 17.8023C64.6301 18.6072 63.3244 19.9869 61.0659 19.9869 58.2655 19.9869 56.2534 17.827 56.2534 15.0676 56.2534 12.1439 58.2901 10.1483 60.8278 10.1483 63.3818 10.1483 64.6301 12.1768 65.0408 13.2773L65.2625 13.8357 58.6843 16.5623C59.1853 17.5478 59.9737 18.0569 61.0741 18.0569 62.1746 18.0569 62.9384 17.5067 63.4968 16.6854zM58.3312 14.9115L62.7331 13.0884C62.4867 12.4724 61.764 12.0454 60.9017 12.0454 59.8012 12.0454 58.2737 13.0145 58.3312 14.9115z",fill:"#E94235"})]}),fv=T.button`
    vertical-align: middle;
    background: var(--intent-contrast-100);
    block-size: 40px;
    inline-size: 40px;
    border-radius: var(--salt-radius-default);
    pointer-events: all;
`,COt=T(se)`
    inline-size: 100%;
    block-size: 100%;
    align-items: end;
    justify-content: space-between;
`,kU=({showGoogleIcon:e=!1,mapControlsRef:t})=>{const n=()=>{t?.current?.geolocate()},o=()=>{t?.current?.zoomIn()},r=()=>{t?.current?.zoomOut()};return s.jsxs(COt,{gap:["xs"],direction:"row",children:[s.jsx("div",{children:e&&s.jsx(SOt,{})}),s.jsxs(se,{gap:["xs"],direction:"column",children:[s.jsx(fv,{"data-test":"google-map-geolocate-button",type:"button",onClick:n,children:s.jsx(me,{verticalAlign:"middle",width:18,height:18,name:"map_location"})}),s.jsx(fv,{"data-test":"google-map-zoom-in-button",type:"button",onClick:o,children:s.jsx(me,{verticalAlign:"middle",width:18,height:18,name:"plus"})}),s.jsx(fv,{"data-test":"google-map-zoom-out-button",type:"button",onClick:r,children:s.jsx(me,{verticalAlign:"middle",width:18,height:18,name:"minus"})})]})]})},MU=T(b)`
    border-start-start-radius: 0;
    border-end-start-radius: 0;
`,TOt=({id:e,defaultValue:t="",placeholderMessage:n,hasError:o,onSubmit:r,onChange:a})=>{const[i,l]=h.useState(t),c=()=>{},d=m=>{l(m.target.value),a(m.target.value)},u=m=>{m.preventDefault(),r(i)};return s.jsx("form",{onSubmit:u,children:s.jsxs(KS,{children:[s.jsx(ii,{last:!0,hideLabel:!0,label:n,id:e,"data-test":`${e}-input`,name:"address_search",type:"text",placeholder:n,input:{onChange:d,onFocus:c},value:i,meta:{invalid:!1,touched:!1},hasError:o}),s.jsxs(MU,{intent:"secondary",fill:!1,type:"submit","data-test":"address-search-button",children:[s.jsx(Ee,{children:n}),s.jsx(MU.Icon,{name:"search"})]})]})})},_Ot=T.div`
    @media (min-width: ${Ke.sm}em) {
        padding-inline-end: 100px;
    }

    @media (min-width: ${Ke.lg}em) {
        inline-size: 550px;
        block-size: auto;
        position: relative;
        padding-inline-end: 0;
    }

    inline-size: 100%;
    block-size: calc(100vb - 80px);
    position: absolute;
    padding-inline-end: calc(var(--salt-spacing-4) * 2);
    z-index: 1;

    & > div {
        border-radius: var(--salt-radius-default);
    }
`,vOt=T.div`
    @media (min-width: ${Ke.lg}em) {
        padding: 0;
    }

    padding: var(--salt-spacing-2);
    z-index: 2;
`,AOt=T.div`
    @media (min-width: ${Ke.lg}em) {
        padding: 0;
    }

    padding: var(--salt-spacing-2);
    position: relative;
    z-index: 3;
`,bOt=T(se)`
    flex-grow: 1;
    justify-content: space-between;

    @media (min-width: ${Ke.lg}em) {
        block-size: 597px;
    }

    block-size: calc(100vb - 80px);
`,yv=T.div`
    flex: 1;
    overflow: hidden;

    @media (min-width: ${Ke.lg}em) {
        max-inline-size: 290px;
    }
`,xOt=T.div`
    flex: 1;
    z-index: 2;
    padding-inline: var(--salt-spacing-2);
    pointer-events: none;

    @media (min-width: ${Ke.lg}em) {
        display: none;
    }
`,ROt=T.div`
    inline-size: 100%;
    block-size: 100%;
    z-index: 1;
    padding-inline-end: var(--salt-spacing-2);
    padding-block-end: var(--salt-spacing-4);
    position: absolute;
    display: none;
    pointer-events: none;

    @media (min-width: ${Ke.lg}em) {
        display: block;
    }
`,fm=T(ve)`
    background-color: var(--background-color);
`,jJ=({title:e="addresses.map-lookup.title",onAddressConfirm:t=()=>{},searchComponent:n="AddressSearchDropdown"})=>{const o=M(),r=F(),a=E(up),i=h.useRef(null),[l,c]=h.useState(),[d,u]=h.useState(!1),[m,g]=h.useState(!1),[f,y]=h.useState(!1),[I,S]=h.useState(!1),[C,_]=h.useState(!1),[A,x]=h.useState(!1),[R,O]=h.useState(!1),[N,k]=h.useState(),[j,w]=h.useState([]),{geoLocation:L,geoLocationError:B,isGeoLocationRequested:W}=dDt(),K=E(cg)[0],Q=E(we=>new RegExp(qe(we,"validation-chars-allowed")||"")),X=E(we=>new RegExp(qe(we,"customer-addresses-address-details-postal-code-validation")||"")),re=E(D("dds.vp")),ue=E(D("dds.plus")),te=E(we=>Number(qe(we,"google-maps-default-lat"))),ce=E(we=>Number(qe(we,"google-maps-default-long"))),de=E(we=>Number(qe(we,"google-maps-default-zoom"))),[ye,Ae]=h.useState();h.useEffect(()=>{if(W)if(B){const we={lat:te,lng:ce};Ae(we),Se(we)}else L&&(Ae(L),Se(L))},[L,B,W,te,ce]);const Je=o.formatMessage("addresses.map-lookup.input-placeholder"),Ie=o.formatMessage("settings.address.book.add.modal.postcode.placeholder.aria.label"),je=()=>{z.info("delivery.collection.alert.location.permission.blocked")},Le=()=>{z.error("addresses.network-error")},Be=we=>!we||we.length===0?!1:re?X.test(we):!0,be=we=>{const Ut=we.trim();if(n==="AddressSearchWithButton"){if(!Be(Ut)){S(!0);return}S(!1)}if(n==="AddressSearchDropdown"){if(O(!1),y(!1),Ut.length<3){O(!0),w([]);return}if(!Q.test(Ut)){y(!0),w([]);return}ge(Ut)}},he=()=>{if(A){const we=document.getElementById("address-not-found-error");we&&we.focus();return}if(!l||!l.location){z.error("addresses.map-lookup.error-no-address");return}g(!1),u(!0),wT({latitude:l.location.latitude,longitude:l.location.longitude,postalCode:l.addressDetails.postalCode})(r).then(({deliverability:we})=>{u(!1),ue||we==="DELIVERABLE"?t(l):g(!0)}).catch(()=>{u(!1),z.error("toast.notification.generic.error")})},ge=we=>{const Ut=we.trim();if(_(!1),g(!1),n==="AddressSearchWithButton"){if(!Be(Ut)){S(!0);return}S(!1)}$7e(Ut)(r).then(ys=>{if(!ys||ys.length===0){_(!0);return}if(n==="AddressSearchWithButton"){const Xs=ys[0];if(!Xs)return;Xe(Xs)}else n==="AddressSearchDropdown"&&w(ys)}).catch(ys=>{if(!ys.statusCode||ys.statusCode===0){Le();return}if(ys.statusCode===404){_(!0),w([]);return}z.error("toast.notification.generic.error")})},Oe=we=>{const Ut=j[we];Ut&&Xe(Ut)},Xe=we=>{V7e(we.id)(r).then(Ut=>{const ys=SI({latitude:Ut.latitude,longitude:Ut.longitude});i.current?.setCenter(ys),dt(ys)}).catch(()=>{z.error("toast.notification.generic.error")})},Se=we=>{!we||!K||N&&N.lat===we.lat&&N.lng===we.lng||(k(we),g(!1),c(void 0),x(!1),O(!1),y(!1),YXe(YRt(we),K,a)(r).then(Ut=>{c(Ut)}).catch(Ut=>{if(Ut.statusCode===404){x(!0);return}if(Ut.statusCode===0||Ut.message==="Network Error"){Le();return}z.error("toast.notification.generic.error")}))},dt=Jr(Se,200),et=we=>s.jsx(yv,{"data-test":"address-search-item-dropdown",children:s.jsx(P,{children:we.formattedAddress})});return s.jsxs(se,{gap:["md"],direction:"column",children:[s.jsx(rs,{title:e}),s.jsx(ne,{as:"h1",children:s.jsx(v,{id:e})}),s.jsxs(se,{gap:["md"],direction:"row",wrap:"nowrap",children:[s.jsxs(bOt,{gap:["sm"],direction:"column",children:[s.jsx(AOt,{children:n==="AddressSearchDropdown"?s.jsxs(h.Fragment,{children:[s.jsx(JL,{id:"search",placeholderMessage:Je,hasError:!1,onChange:Jr(be,500),onItemSelected:Oe,children:j.map(we=>et(we))}),R&&s.jsx(fm,{className:"salt-m-t--2",children:s.jsx(P,{role:"alert",children:s.jsx(v,{id:"addresses.address-search.min-characters-error"})})}),f&&s.jsx(fm,{className:"salt-m-t--2",children:s.jsx(P,{role:"alert",children:s.jsx(v,{id:"addresses.address-search.invalid-error"})})}),C&&s.jsx(fm,{className:"salt-m-t--2",children:s.jsx(P,{role:"alert",children:s.jsx(v,{id:"addresses.address-search.no-results-found"})})})]}):s.jsxs(h.Fragment,{children:[s.jsx(TOt,{id:"search-button",placeholderMessage:Ie,hasError:I||C,onSubmit:ge,onChange:Jr(be,500)}),I&&s.jsx(fm,{className:"salt-m-t--2",children:s.jsx(P,{role:"alert",children:s.jsx(v,{id:"settings.address.book.add.modal.postcode.error"})})}),C&&s.jsx(fm,{className:"salt-m-t--2",children:s.jsx(P,{role:"alert",children:s.jsx(v,{id:"addresses.address-search.no-results-found"})})})]})}),s.jsx(xOt,{children:s.jsx(kU,{mapControlsRef:i,showGoogleIcon:!0})}),s.jsx(vOt,{children:s.jsx(ve,{children:s.jsx(se,{gap:["md"],direction:"column",children:s.jsxs(h.Fragment,{children:[s.jsxs(se,{gap:["sm"],direction:"column",children:[s.jsxs(yv,{children:[l&&s.jsxs(h.Fragment,{children:[s.jsx(P,{bold:!0,size:"m",className:"salt-m-r--1",children:s.jsx(v,{id:"addresses.map-lookup.deliver-to"})}),s.jsx(P,{size:"m",children:l.formattedAddress})]}),!l&&A&&s.jsxs(h.Fragment,{children:[s.jsx(P,{bold:!0,size:"m",className:"salt-m-r--1",children:s.jsx(v,{id:"addresses.map-lookup.deliver-to"})}),s.jsx(P,{size:"m",intent:"error",role:"alert",id:"address-not-found-error",children:s.jsx(v,{id:"addresses.address-search.no-results-found"})})]}),!l&&!A&&s.jsxs(se,{gap:["sm"],direction:"row","flex-wrap":"no-wrap",children:[s.jsx(P,{bold:!0,size:"m",children:s.jsx(v,{id:"addresses.map-lookup.deliver-to"})}),s.jsx(yv,{children:s.jsx(Pe,{height:"18px"})}),s.jsx(Pe,{className:"salt-m-b--2",height:"18px"})]})]}),m&&s.jsx(P,{intent:"error",role:"alert",className:"salt-m-t--4",children:s.jsx(Bh,{id:"addresses.address-search.address-not-deliverable"})})]}),(l||A)&&s.jsx(b,{onClick:he,intent:"primary",fill:!1,"data-test":"map-lookup-button",loading:d,children:s.jsx(b.Text,{children:s.jsx(v,{id:"addresses.map-lookup.confirm"})})}),!l&&!A&&s.jsx(Pe.Button,{fill:!0,"data-test":"map-lookup-skeleton-button"})]})})})})]}),s.jsxs(_Ot,{children:[s.jsx(ROt,{children:s.jsx(kU,{mapControlsRef:i})}),ye&&s.jsx(ZL,{ref:i,height:"100%",center:ye,zoom:de,onGeolocationError:je,onCenterChanged:dt,showZoomButtons:!1,showGeolocationButton:!1,showFixedMarker:!0,interactive:!0})]})]})]})},DOt=({onConfirm:e,onVisibleComponentChange:t})=>{const n=F(),[o,r]=h.useState("MAP_LOOKUP"),[a,i]=h.useState(),l=Ug(),d=E(cg)[0],u=E(Vs);h.useEffect(()=>{t(o)},[o]);const m=y=>{i(y),r("CONFIRM")},g=async(y,I)=>{if(!a)return;const S=y.addressLine2,C={...a,addressName:y.nickname,deliveryInstructions:y.notes,formattedAddress:y.formattedAddress,language:u,countryCode:d,location:a.location,lookupId:a.lookupId};S&&S.length>0&&(C.additionalInformation=S),v6(C)(n).then(_=>l(_.addressId)).then(({addressId:_,deliveryDestinationId:A})=>{e&&e(_,A)}).catch(()=>{z.error("toast.notification.generic.error"),I()})},f=()=>{r("MAP_LOOKUP")};switch(o){case"CONFIRM":return s.jsx(FT,{address:a,showWarningIfAddressLine2Empty:!1,showMap:!0,showDeliveryInstructions:!1,addressLine2Label:"addresses.address-search.floor-door-number",onSubmit:g,onBack:f});case"MAP_LOOKUP":default:return s.jsx(jJ,{onAddressConfirm:m})}},OOt=({modalName:e=lr,onModalClose:t,onAddressSave:n})=>{const o=F(),r=E(Ue(e)),{currentBreakpoint:a}=h.useContext(Pn),i=a==="lg"?"lg":"md",[l,c]=h.useState("MAP_LOOKUP"),[d,u]=h.useState(i),m=()=>{t(),o(Z.closeModal())},g=(y,I)=>{n(y,I),o(Z.closeModal())},f=y=>{c(y)};return h.useEffect(()=>{u(l==="CONFIRM"?"sm":i)},[l,a,i]),s.jsx(G,{isOpen:r,onRequestClose:m,maxWidth:d,children:s.jsx(G.Body,{children:s.jsx(DOt,{onConfirm:g,onVisibleComponentChange:f})})})},POt=({flow:e,modalName:t=lr,submitAddAddress:n=()=>{},onModalClose:o=()=>{}})=>{switch(e){case so.MANUAL_FORM:case so.MANUAL_FORM_POSTCODE:return s.jsx(VRt,{modalName:t,onAddressSave:n,onModalClose:o});case so.MANUAL_FORM_MAP:return s.jsx(bDt,{modalName:t,onAddressSave:n,onModalClose:o});case so.INTERNATIONAL:return s.jsx(aOt,{modalName:t,onAddressSave:n,onModalClose:o});case so.UK_POSTCODE_MAP_BACKUP:return s.jsx(IOt,{modalName:t,onAddressSave:n,onModalClose:o});case so.KOREAN_ROAD_NAME:return s.jsx(gOt,{modalName:t,onAddressSave:n,onModalClose:o});case so.MAP_LOOKUP:return s.jsx(OOt,{modalName:t,onAddressSave:n,onModalClose:o});case so.UK_POSTCODE:default:return s.jsx(KDt,{modalName:t,onAddressSave:n,onModalClose:o})}},NOt=e=>({flow:wg(e)}),BT=ke(NOt)(POt),LOt=(e,t)=>({type:_s.CHANGE_ADDRESS_BUTTON_CLICKED,payload:{existingDeliveryMethodChanged:e,deliveryMethod:t}}),kOt=e=>({type:_s.DELIVERY_DESTINATION_HEADER_CLICKED,payload:{deliveryMethod:e}}),MOt=e=>({type:_s.HOMEPAGE_DELIVERY_DESTINATION_CARD_CLICKED,payload:{deliveryMethod:e}}),jOt=()=>({type:_s.DELIVERY_DESTINATIONS_SELECTOR_SEARCH_FOCUS}),ui=e=>({type:_s.DELIVERY_DESTINATION_MODAL_CLOSED,payload:e}),wOt=e=>({type:_s.DELIVERY_OPTION_MODAL_TRIGGERED,payload:e}),FZt=e=>({type:_s.HOMEPAGE_BOX_DDS_IMPRESSION,payload:e}),wJ="DEFAULT_CONFIG",FJ="SIMPLIFIED_DELIVERY_CHANGE_CONFIG",jU={[wJ]:{titleId:"delivery.destination.changeConfirmation.header.title",withSlotWarningText:"delivery.destination.changeConfirmation.message.withSlot",withoutSlotWarningText:"delivery.destination.changeConfirmation.message.withoutSlot"},[FJ]:{titleId:"delivery.destination.simple.changeConfirmation.header.title",withSlotWarningText:"delivery.destination.simple.changeConfirmation.message.withSlot",withoutSlotWarningText:"delivery.destination.simple.changeConfirmation.message.withoutSlot"}},BJ=e=>e?jU[FJ]:jU[wJ],UJ=()=>E(e=>pg(e,[jt()])),FOt=()=>{const{formatMessage:e}=M(),t=UJ(),n=BJ(t),o=E(aS);return e(o?n.withSlotWarningText:n.withoutSlotWarningText)},BOt=()=>{const e=F(),t=UJ(),n=BJ(t),o=FOt(),{isOpen:r,options:a}=wt(eO),i=wt(a?.previous).open,l=()=>{i()},c=uc(),d=Bg(!0,t),u=()=>{if(a?.deliveryDestination){const m={deliveryDestinationId:a.deliveryDestination.deliveryDestinationId,deliveryDestinationChanged:!0,deliveryMethod:a.deliveryDestination.deliveryMethod,userAction:"Delivery method updated",newDeliveryDestinationAdded:!c||c&&!c.data};e(ui(m)),d({addressId:a.deliveryDestination.addressId,deliveryDestinationId:a.deliveryDestination.deliveryDestinationId,regionId:a.deliveryDestination.resolvedRegionId})}};return{isOpen:r,options:a,headerLabelId:n.titleId,deliveryDestinationChangeWarningText:o,confirmDeliveryDestinationChange:u,onBack:l}},nk=()=>{const e=F();return(t,n)=>e(sn.openChangeDeliveryDestinationConfirmationModal(t,n))},wU="delivery.type.select.breadcrumb",UOt=()=>{const e=F(),{formatMessage:t}=M(),{currentBreakpoint:n}=h.useContext(Pn),o=n==="lg"?"lg":"md",r=uc(),a=wt(ld),i=nk(),l=iP(),c=()=>{e(sn.invalidateCustomerCollectionDeliveryDestinations())},d=m=>{if(c(),l(m)){const g={deliveryDestinationId:m.deliveryDestinationId,deliveryDestinationChanged:!1,deliveryMethod:m.deliveryMethod,userAction:"Delivery destination already selected"};return e(ui(g)),a.close()}return i(ld,m)};return{...a,close:()=>{e(ui({deliveryDestinationChanged:!1,userAction:"Close"})),c(),a.close()},headerLabelId:wU,modalHeader:t(wU),isLoading:!1,modalSize:o,setSelectedDeliveryDestination:d,deliveryDestinationFromSession:r}},Iv={logInButtonText:"delivery.destination.visitor.loginButtonText",loginDescriptionText:"delivery.destination.visitor.loginDescriptionText"},GOt=()=>{const{formatMessage:e}=M(),t=F(),n=We();return{loginAction:()=>{n(mi()),t(ui({deliveryDestinationChanged:!1,userAction:"Log in or register"})),t(Z.closeModal())},logInButtonText:e(Iv.logInButtonText),loginDescriptionText:e(Iv.loginDescriptionText),loginButtonMessages:Iv}},$Ot=T.div`
    display: flex;
    gap: var(--salt-spacing-4);
    inline-size: 100%;
    align-self: flex-end;
    flex-direction: column;
`,HOt=()=>{const{logInButtonText:e,loginDescriptionText:t,loginAction:n}=GOt();return s.jsxs($Ot,{children:[s.jsx(Zn,{}),t,s.jsx(b,{intent:"secondary",onClick:n,children:s.jsx(b.Text,{children:e})})]})},GJ={alignItems:"start",justifyContent:"left",textAlign:"left"},$J={...GJ,marginBottom:"8px",lineHeight:"20px"},HJ={fontSize:"16px"},VJ={...GJ,marginBottom:"8px",padding:"0",fontSize:"16px",lineHeight:"20px"},VOt=({chooseButton:e=void 0,chooseDeliveryButtonAccessibilityText:t})=>e?s.jsx(He.Action.Footer,{children:s.jsx(b,{intent:"primary",id:"select-temporary-home-address","data-test":"select-temporary-home-address","data-synthetics":"select-temporary-home-address","aria-label":t,onClick:e.onClick,children:s.jsx(b.Text,{children:e.chooseDeliveryButtonText})})}):null,YOt=({text:e=void 0})=>e?s.jsx(Ce,{intent:"warning",text:e,showIcon:!1}):null,WOt=({temporaryDeliveryDestinationWarningText:e,chooseDeliveryButtonAccessibilityText:t})=>s.jsxs(He.Action.Body,{style:{...VJ,marginBottom:0},children:[t,s.jsx(YOt,{text:e})]}),qOt=({temporaryDeliveryDestination:e,temporaryDeliveryDestinationWarningText:t,chooseDeliveryButtonAccessibilityText:n,chooseButton:o})=>e?s.jsxs(He.Action,{as:"li",id:"temporaryDeliveryDestination","data-test":"temporaryDeliveryDestination",chip:void 0,innerRef:void 0,children:[s.jsxs(He.Action.Header,{style:$J,children:[s.jsx(me,{name:"home_delivery",height:20,width:20}),s.jsx(He.Action.HeaderText,{style:HJ,"data-test":"collection-location-name",as:"h4",children:e.name})]}),s.jsx(WOt,{temporaryDeliveryDestinationWarningText:t,chooseDeliveryButtonAccessibilityText:n}),s.jsx(VOt,{chooseButton:o,chooseDeliveryButtonAccessibilityText:n})]},"temporaryDeliveryDestination"):s.jsx("div",{}),KOt="postal_code",zOt="postal_code_prefix",Xd=({data:e})=>e.delivery.clickAndCollect.search,YJ=V(Xd,e=>({query:e.query,lastUpdated:e.lastUpdated})),WJ=V(Xd,e=>({error:e.error,result:e.result})),gb=e=>{const{long_name:t}=e?.address_components?.find(n=>n.types.includes(KOt)&&!n.types.includes(zOt))||{};return t},QOt=V(Xd,e=>gb(e.result)),XOt=e=>e.control.delivery.temporaryDeliveryDestination,ZOt=()=>{const[e]=fe(["homedel"]),{query:t}=E(YJ),{result:n}=E(WJ),o=E(QOt),{formatMessage:r}=M(),a=E(up),i=n?.geometry.location.lat(),l=n?.geometry.location.lng(),c=o||t,d=n?.formatted_address,u=F();h.useEffect(()=>{e&&i&&l&&c&&d&&WRt({name:r("delivery.destination.temporary.home.header"),formattedAddress:d,latitude:i,longitude:l,postalCode:c},u)},[d,c,i,l]);const m=E(XOt),g=m&&m.deliverability!=="NOT_DELIVERABLE"||!1,f=g?void 0:r("delivery.destination.temporary.home.alert.nondeliverable"),y=g&&m?r("accessibility.delivery.destination.temporary.home.button",{postalCode:m.postalCode,formatted_address:m.formattedAddress}):void 0,I=r("delivery.destination.visitor.address.list.collection.header"),S=m&&g?{chooseDeliveryButtonText:r("delivery.destination.temporary.home.chooseButton"),onClick:()=>KRt({...m.coordinates,...m,visitorId:a},u)}:void 0;return e?{temporaryDeliveryDestination:m,chooseButton:S,chooseDeliveryButtonAccessibilityText:y,temporaryDeliveryDestinationWarningText:f,collectionPointsHeader:I}:{temporaryDeliveryDestination:null}},JOt=({showCollectionPoints:e})=>{const{chooseButton:t,chooseDeliveryButtonAccessibilityText:n,temporaryDeliveryDestinationWarningText:o,temporaryDeliveryDestination:r,collectionPointsHeader:a}=ZOt();return r?s.jsxs(h.Fragment,{children:[s.jsx(qOt,{chooseButton:t,temporaryDeliveryDestination:r,temporaryDeliveryDestinationWarningText:o,chooseDeliveryButtonAccessibilityText:n}),e?s.jsx("div",{className:"salt-m-b--4",children:a}):null]}):null},Sv="ZERO_RESULTS",ePt=e=>({geocodeConnectionErrorTitle:e.formatMessage("delivery.collection.geocode.connection.error.title"),geocodeConnectionError:e.formatMessage("delivery.collection.geocode.connection.error.message"),geocodeResultsErrorTitle:e.formatMessage("delivery.collection.geocode.results.error.title"),geocodeResultsError:e.formatMessage("delivery.collection.geocode.results.error.message")});class tPt extends h.Component{formattedMessages;constructor(t){super(t);const{intl:n}=this.props;this.formattedMessages=ePt(n),this.renderGeocodeError=this.renderGeocodeError.bind(this)}componentDidUpdate(){const{geocode:t}=this.props;t.error&&t.error!==Sv&&Me.api.pushError(new Error(`Geocode error: ${t.error}`))}componentWillUnmount(){this.props.actions.clearGeocodeError()}renderGeocodeError(){const{geocode:t}=this.props,n=t.error===Sv?this.formattedMessages.geocodeResultsErrorTitle:this.formattedMessages.geocodeConnectionErrorTitle,o=t.error===Sv?this.formattedMessages.geocodeResultsError:this.formattedMessages.geocodeConnectionError,r=s.jsxs(P,{children:[s.jsx(P,{bold:!0,children:n})," ",o]}),a="error";return t.error&&s.jsx(Ce,{className:"salt-m-b--4","data-test":"geocode-error-alert","data-test-type":a,intent:a,text:r,title:n})}render(){return this.renderGeocodeError()||null}}const sPt=e=>({geocode:Xd(e)}),nPt=ot({clearGeocodeError:ms.clearGeocodeError}),oPt=Ct(Bt,ke(sPt,nPt))(tPt),rPt=({intl:e,filters:t,applyFilters:n})=>{const o=h.useRef(null),[r,a]=h.useState(new Map),[i,l]=h.useState(!1);h.useEffect(()=>{const g=f=>{o.current.contains(f.target)||l(!1)};return document.addEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)}},[]);const c=()=>{l(!i),a(new Map)},d=()=>{r.size>0&&n([...r.values()]),c()},u=g=>{const f=r.get(g.id);return f?f.selected:g.selected},m=g=>f=>{const y=new Map([[g.id,{...g,selected:f.target.checked}]]);a(new Map([...r,...y]))};return s.jsxs(Ot.Container,{ref:o,children:[s.jsx(Ot.TriggerDefaultButton,{isOpen:i,fill:!0,text:e.formatMessage("delivery.collection.filter.button.label"),onClick:c,"data-test":"collection-point-filter-dropdown-toggle"}),s.jsxs(Ot.Body,{"data-test":"collection-point-filter-dropdown",isOpen:i,children:[s.jsxs(Ot.Content,{children:[s.jsx("div",{className:"salt-m-b--2",children:s.jsx(P,{bold:!0,children:s.jsx(v,{id:"delivery.collection.filter.type.text"})})}),t.map(g=>s.jsx(mo,{bold:!0,label:e.formatMessage(g.labelId),input:{checked:u(g),onChange:m(g)},"data-test":`collection-point-filter-${g.id}`},g.id))]}),s.jsx(Ot.Footer,{children:s.jsx(b,{"data-test":"collection-point-filter-apply-button",onClick:d,intent:"primary",children:s.jsx(b.Text,{children:s.jsx(v,{id:"delivery.collection.filter.apply.button.label"})})})})]})]})},aPt=Bt(rPt),iPt=({filters:e,clearSingleFilter:t,clearAllFilters:n})=>{const o=()=>e.filter(a=>a.selected).map(a=>s.jsx("div",{className:"salt-d--inline-block salt-m-t--1 salt-m-r--1",children:s.jsx(gD,{"data-test":a.id,minSize:"md",onClick:()=>t(a),children:s.jsx(v,{id:a.labelId})},`filter-${a.id}`)},a.id)),r=()=>e.some(a=>a.selected)?s.jsx(b,{intent:"tertiary",fill:!1,"data-test":"collection-points-clear-all-filters",onClick:n,children:s.jsx(b.Text,{children:s.jsx(v,{id:"delivery.collection.filter.clearAll"})})}):null;return s.jsxs(ie.Fragment,{children:[o(),r()]})},gu={clearSingleCollectionPointFilter:ms.clearSingleCollectionPointFilter,clearAllCollectionPointFilters:ms.clearAllCollectionPointFilters,applyCollectionPointFilters:ms.applyCollectionPointFilters,clearGeocodeError:ms.clearGeocodeError,setGeocodeSearchQuery:ms.setGeocodeSearchQuery,setNearbyCollectionPointsFetching:ms.setNearbyCollectionPointsFetching},CI="slotbooking-basket-split-modal-header",qJ=e=>{const{addressId:t,closeModal:n,confirmAction:o,cancelAction:r,errorAction:a=()=>{}}=e,[i,l]=h.useState(!1),{basketChangedModalDisplayed:c,basketChangedModalConfirmButtonClicked:d,basketChangedModalCancelButtonClicked:u}=bo();h.useEffect(()=>{c({addressId:t})},[]);const m=()=>{u(),r().then(()=>n())},g=()=>{l(!0),d(),o().then(()=>{l(!1),n()}).catch(()=>{l(!1),a()})};return s.jsxs(h.Fragment,{children:[s.jsxs("div",{"aria-live":"polite",id:CI,children:[s.jsx(G.Header,{align:"left","aria-live":"polite",children:s.jsx(ne,{as:"h1",id:CI,children:s.jsx(v,{id:"slotbooking.address.change.affect.trolley.title"})})},"header"),s.jsxs(G.Body,{children:[s.jsx(Bo,{className:"salt-m-b--4",children:s.jsx(P,{className:"salt-d--block",children:s.jsx(v,{id:"slotbooking.address.change.affect.trolley.line1"})})}),s.jsx(P,{className:"salt-d--block",children:s.jsx(v,{id:"slotbooking.address.change.affect.trolley.line2"})})]},"body")]}),s.jsxs(G.Footer,{className:"salt-gap-x--2",align:"left",children:[s.jsx(b,{onClick:m,intent:"secondary",fill:!0,children:s.jsx(v,{id:"slotbooking.address.change.affect.trolley.cancel"})}),s.jsx(b,{onClick:g,intent:"primary",loading:i,fill:!0,children:s.jsx(v,{id:"slotbooking.address.change.affect.trolley.confirm"})})]},"footer")]})},Eb="addressChangedBasked",lPt=()=>{const e=F(),t=We(),n=cL(),o=()=>e(Z.closeModal()),r=E(y=>y.router.location.search),a=E(Ue(Eb)),i=E(xs),l=E(Qs).data,c=E(uo),d=E(Fa),u=Bg(),m=()=>e(sn.getSelectedDeliveryDestinationData(c)).then(y=>u({addressId:y.payload.responseData.addressId,deliveryDestinationId:y.payload.responseData.deliveryDestinationId,regionId:y.payload.responseData.resolvedRegionId})).then(()=>t(n)),g=async()=>{i!==l?.deliveryMethod&&t(mi({queryString:r})),e(r1.setSelectedDeliveryDestinationId(d))},f=()=>z.error("toast.notification.generic.error");return s.jsx(G,{showCloseIcon:!0,onRequestClose:()=>{g(),o()},isOpen:a,aria:{labelledby:CI},children:s.jsx(qJ,{addressId:c||"",closeModal:o,cancelAction:g,confirmAction:m,errorAction:f})})},cPt=(e,t,n)=>t&&Object.keys(t).length>0?e.map(({deliveryDestinationId:o,distance:r})=>({...t[o],distance:r})).filter(o=>!dPt(n)||n.filter(r=>r.selected).some(r=>r.supportedType===o.collectionPointType)):[],dPt=e=>e&&e.some(t=>t.selected),ok=V(e=>e.data.delivery.clickAndCollect.collectionPoints.nearbyCollectionPointsOrderWithDistance||[],e=>e.data.delivery.destinations.customerCollection.data,e=>e.data.delivery.clickAndCollect.collectionPoints.filters,cPt),uPt=({data:e})=>e.delivery.clickAndCollect.collectionPoints.nearbyCollectionPointsStatus,pPt=({data:e})=>e.delivery.destinations.customerCollection.didInvalidate,mPt=({data:e})=>e.delivery.clickAndCollect.collectionPoints.geocodeLookupComplete,hPt=()=>{const e=F();return t=>e(U.analyticsEvent({type:_s.DELIVERY_DESTINATIONS_SELECTOR_GEOLOCATION_EVENT,payload:t}))},BZt=()=>{const e=F();return t=>e(MOt(t?.deliveryMethod))},gPt=()=>{const e=F(),t=uL();return(n,o)=>{e(LOt(n,o)),e(U.analyticsEvent({type:_s.SELECT_DELIVERY_DESTINATION,deliveryMethod:o,groupId:t}));const r={event:"select_delivery_destination",method:o,group_id:t??""};J.sendEvent({GA:r,WA:null})}},FU="delivery.type.collect.point.modal.title",EPt=e=>{const t=F(),n=E(Jl),o=E(mPt),r=n.isFetching&&!o,{formatMessage:a}=M(),{currentBreakpoint:i}=h.useContext(Pn),l=i==="lg"?"lg":"md",c=a(FU),d=uc(),u=wt(e),m=nk(),g=iP(),f=E(Zl),y=wt(Fl).open,I=()=>{t(sn.invalidateCustomerCollectionDeliveryDestinations())};return{...u,open:()=>u.open(),close:()=>{t(ui({deliveryDestinationChanged:!1,userAction:"Close"})),I(),u.close()},modalHeader:c,headerLabelId:FU,isLoading:r,modalSize:l,setSelectedDeliveryDestinationDefault:_=>{if(f){u.close(),y({deliveryDestination:_});return}if(I(),g(_)){const A={deliveryDestinationId:_.deliveryDestinationId,deliveryDestinationChanged:!1,deliveryMethod:_.deliveryMethod,userAction:"Delivery destination already selected"};t(ui(A)),u.close();return}m(Lp,_)},deliveryDestinationFromSession:d}},KJ=()=>{const{formatMessage:e}=M(),t=fXe(),n=e("delivery.collection.toggle.button.view.list"),o=e("delivery.collection.toggle.button.view.map"),r=e("delivery.collection.map.header.accessibility"),a=e("delivery.destination.collection.changeAddress.button.nearMe"),i=E(ok),l=E(pPt),{buildLink:c,buildLinkParams:d,resetActiveAddressId:u}=ENt(),m=hPt();return{accessibilityMapHeader:r,listView:n,mapView:o,nearMeButtonText:a,customerCollections:l?[]:i,loadCustomerCollectionDestinations:t,buildLink:c,buildLinkParams:d,resetActiveAddressId:u,sendGeolocationEvent:m}},fPt=T(vq)`
    block-size: 100%;
`,TI=({show:e,children:t})=>s.jsx(fPt,{show:e,children:t}),UT=({data:e})=>e.delivery.clickAndCollect.collectionPoints.activeCustomerCollection,yPt=T.div`
    align-items: center;
    display: flex;

    > * {
        overflow: hidden;
        text-overflow: ellipsis;
    }

    &:last-child {
        padding-block-end: 0;
    }
`,Cv=T(yPt)`
    margin-inline-start: var(--salt-spacing-8);
`,IPt=T.li`
    border-block-end: var(--salt-border-1) solid var(--intent-secondary);
    display: flex;
    flex-direction: column;
    padding: var(--salt-spacing-2);
    position: relative;
    background-color: var(--intent-contrast);

    &:focus {
        outline-offset: -4px;
        background-color: var(--intent-primary-50);
    }

    &:last-child {
        border: none;
        margin: 0;
    }
`,rk=()=>s.jsxs(IPt,{children:[s.jsx(Cv,{children:s.jsx(Pe,{className:"salt-m-b--2",height:"15px"})}),s.jsx(Cv,{children:s.jsx(Pe,{className:"salt-m-b--2",height:"15px"})}),s.jsx(Cv,{children:s.jsx(Pe,{className:"salt-d--inline-block",height:"40px"})})]}),SPt=(e,t,n)=>{if(e===void 0)return;const a=e/(t?1609.344:1e3);return n.formatNumber(a,{minimumFractionDigits:1,maximumFractionDigits:1})},CPt=({retailerSettings:e})=>e["use-mile-as-distance-unit"],TPt=()=>E(V(CPt,e=>String(e).toLowerCase()==="true")),zJ=()=>{const e=TPt(),t=M();return{messageId:e?"delivery.collection.distance.format.miles":"delivery.collection.distance.format.kilometers",convertDistanceInMeters:o=>SPt(o,e,t)}},_Pt=()=>E(v5),vPt=T(P)`
    white-space: nowrap;
`,APt={className:""},QJ=({className:e,distanceInMeters:t})=>{const{messageId:n,convertDistanceInMeters:o}=zJ(),r=_Pt(),a=o(t);return r?s.jsx("div",{className:e,children:s.jsx(vPt,{size:"l",children:a&&s.jsx(v,{id:n,values:{distance:a}})})}):null};QJ.defaultProps=APt;function GT({html:e,as:t="div",...n}){return s.jsx(t,{...n,dangerouslySetInnerHTML:{__html:Bu(e)}})}const bPt={alignItems:"start",justifyContent:"left",textAlign:"left"},xPt={marginLeft:0},RPt={marginBottom:"16px"},DPt=()=>({borderStyle:"solid",borderWidth:"1px",borderColor:"var(--intent-primary)"}),OPt=T(He.Action.Header)`
    align-items: start;
    justify-content: left;
    text-align: start;
    margin-block-end: ${H(6)};
`,PPt=T(He.Action.HeaderText)`
    font-size: ${H(16)};
`,NPt={...bPt,marginBottom:"6px",padding:"0",fontSize:"16px"},LPt=T.div`
    align-items: start;
    justify-content: left;
    text-align: start;
    margin-block-end: var(--salt-spacing-2);
`,kPt=T(QJ)`
    margin-inline-start: auto;
    font-size: ${H(16)};
`,MPt=T(Fn)`
    position: absolute;
    inset-block-start: calc(var(--salt-spacing-2) * -1);
    inset-inline-start: calc(var(--salt-spacing-2) * -1);
`,XJ=({address:e,onPreviewClick:t=()=>{},onSelectClick:n,id:o,key:r,selected:a,innerRef:i,showPreviewButton:l,asListElement:c,infoWindowDataTestId:d})=>{const u=M(),[m,g]=fe(["cptb","cptlw"]),f=E(v5),y={...m?RPt:xPt,...a?DPt:void 0},I=zJ(),S=()=>{if(g&&Uu.LOCKER===e.collectionPointType)return s.jsx(LPt,{children:s.jsx(Ce,{intent:"warning",size:"s",text:u.formatMessage("delivery.collection.type.locker.warning.text")})})},C=()=>{switch(e.collectionPointType){case Uu.LOCKER:return u.formatMessage("delivery.collection.type.locker.text");case Uu.MOBILE:return u.formatMessage("delivery.collection.type.mobile.text");default:return u.formatMessage("delivery.collection.type.collectionPoint.text")}},_=()=>{const x=e.distance;return x?u.formatMessage(I.messageId,{distance:I.convertDistanceInMeters(x)}):""},A=()=>m?s.jsx(MPt,{intent:"secondary",text:C(),singleLine:!0}):void 0;return s.jsxs(He.Action,{as:c?"li":void 0,id:o,"data-test":o,chip:A(),style:y,innerRef:i,children:[s.jsxs(OPt,{children:[a&&s.jsx(me,{name:"map_marker_hollow",height:24,width:24,primary:!0}),s.jsx(PPt,{"data-test":"collection-location-name",as:"h4",children:e.name}),s.jsx(kPt,{distanceInMeters:e.distance})]}),s.jsx(He.Action.Body,{style:NPt,children:s.jsx(GT,{html:e.formattedAddress})}),s.jsxs(He.Action.Footer,{children:[S(),s.jsxs("div",{className:"salt-d--flex salt-gap--2",children:[s.jsx(b,{fill:!0,size:"s",intent:"secondary",id:`select-button-collection-location-id-${e.addressId}`,"data-test":`select-button-collection-location-id-${e.addressId}`,"data-testid":d||`select-button-collection-location-id-${e.name}`,"data-synthetics":"address-select-button","aria-label":f?u.formatMessage("delivery.collection.address.select.button.text.with.distance.accessibility",{addressNickname:e.name,address:e.formattedAddress,distance:_()}):u.formatMessage("delivery.collection.address.select.button.accessibility",{addressNickname:e.name,address:e.formattedAddress}),onClick:n,children:s.jsx(b.Text,{children:u.formatMessage("delivery.collection.address.select.button")})}),l&&s.jsx(b,{fill:!1,size:"s",intent:"secondary","aria-label":u.formatMessage("delivery.collection.address.preview.button.accessibility",{addressNickname:e.name}),onClick:t,"data-test":`preview-button-collection-location-id-${e.addressId}`,children:s.jsx(me,{name:"preview"})})]})]})]},r)},jPt=T.div`
    border: none;
    position: relative;
    overflow: hidden;
`,wPt=T.div`
    padding-block-end: var(--salt-spacing-2);

    &:last-child {
        padding-block-end: 0;
    }
`,FPt=T.ul`
    margin: 0;
    overflow-y: auto;
    scroll-behavior: smooth;
    padding: 0;
    ${oe.mdUp`
            max-height: ${H(500)};
        `};
`,BPt=({children:e})=>s.jsx(jPt,{children:s.jsx(wPt,{children:s.jsx(FPt,{children:e})})}),ZJ=({onDeliveryDestinationSelect:e,isLoading:t,customerCollections:n=[],topElement:o})=>{const r=E(Xd),a=F(),i=E(UT),l=f=>a(ms.toggleActiveCustomerCollection(f)),c={},d=(f,y)=>{y.addressId&&(c[y.addressId]=y)},u=f=>s.jsx(XJ,{address:f,onPreviewClick:()=>l(f),onSelectClick:()=>e(f),id:f.deliveryDestinationId,selected:i?.deliveryDestinationId===f.deliveryDestinationId,innerRef:y=>d(y,f),showPreviewButton:!0,asListElement:!0},f.deliveryDestinationId),m=t?Array.from(Array(3),(f,y)=>s.jsx(rk,{},y)):n.map(u),g=o?[o]:[];return r?.error?null:s.jsxs(h.Fragment,{children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h3",{children:s.jsx(v,{id:"delivery.collection.list.header.accessibility"})})}),s.jsx(BPt,{children:[...g,...m]})]})},UPt=({result:e,latLng:t,getGeocode:n=()=>Promise.resolve([])})=>async o=>{if(!gb(e))try{const i=(await n({location:t})).find(l=>gb(l));if(i)return await o(ms.setGeocode({geocode:i}))}catch{}return o(ms.setGeocode({geocode:e}))},GPt={saveResult:UPt},$Pt=T.button`
    cursor: pointer;
    user-select: none;
    border-radius: 2px;
    border: none;
    background: white;
    block-size: 40px;
    inline-size: 40px;
    margin-inline-end: 10px;
    padding: 0;
`,HPt=T(me)`
    vertical-align: middle;

    svg {
        fill: #666;
        block-size: 40px;
        inline-size: 40px;
        padding: 8px;
    }

    svg:hover {
        fill: #333;
    }
`,VPt=(e,t,n,o)=>{const a=document.createElement("div"),i=s.jsx(kb,{store:n,children:s.jsx($Pt,{onClick:t,"aria-label":o.formatMessage("delivery.collection.map.location.button.accessibility"),children:s.jsx(HPt,{name:"map_location"})})});Pb.createRoot(a).render(i),e.controls?.[9].push(a)},YPt=({height:e="100%",center:t,zoom:n=2,onLoad:o=()=>{},onBoundsChanged:r=()=>{},onCurrentLocationClick:a=()=>{},children:i})=>{const l=M(),c=Number(Cs("google-maps-default-zoom")??10),{isLoaded:d,reactMapId:u}=RJ(),m=lp(),g=f=>{f.setCenter?.(t),VPt(f,a,m,l),o(f)};return d?s.jsx(k$,{id:u,mapContainerStyle:{height:e},options:{streetViewControl:!1},zoom:n||c,onLoad:g,onBoundsChanged:r,children:i}):s.jsx(Pe,{height:e})},WPt=h.memo(YPt),qPt={minWidth:"300px",maxWidth:"300px"};class KPt extends h.Component{constructor(t){super(t),this.state={isMobileLayout:this.isMobileLayout()},this.addWindowResizeListener=this.addWindowResizeListener.bind(this),this.removeWindowResizeListener=this.removeWindowResizeListener.bind(this),this.refreshIsMobileLayoutState=this.refreshIsMobileLayoutState.bind(this),this.isMobileLayout=this.isMobileLayout.bind(this),this.addWindowResizeListener()}componentWillUnmount(){this.removeWindowResizeListener()}refreshIsMobileLayoutState(){this.setState({isMobileLayout:this.isMobileLayout()})}isMobileLayout(){return!uLe.isMdUp()}addWindowResizeListener(){window.addEventListener("resize",this.refreshIsMobileLayoutState)}removeWindowResizeListener(){window.removeEventListener("resize",this.refreshIsMobileLayoutState)}render(){const{address:t,activeCustomerCollection:n,position:o,actions:{toggleActiveCustomerCollection:r}}=this.props,{isMobileLayout:a}=this.state,i=new google.maps.MVCObject;i.set("position",o),i.set("anchorPoint",new google.maps.Point(11,-30));const l=t.deliveryDestinationId===n?.deliveryDestinationId;return a&&l?s.jsx(Lre,{anchor:i,options:qPt,onCloseClick:()=>r(t),children:s.jsx(P,{id:"collection-point-card-text",className:"salt-d--flex",children:s.jsx(XJ,{address:t,id:`info-window-collection-location-id-${t.addressId}`,onSelectClick:()=>this.props.onDeliveryDestinationSelect(t),infoWindowDataTestId:`info-window-select-button-collection-location-id-${t.name}`},`info-window-${t.addressId}`)})}):null}}const zPt=e=>({activeCustomerCollection:UT(e)}),QPt=ot({analyticsEvent:U.analyticsEvent,toggleActiveCustomerCollection:ms.toggleActiveCustomerCollection,setSelectedAddress:ea.setSelectedAddress}),XPt=Ct(Bt,ke(zPt,QPt))(KPt),BU={iconOffset:[7,20],labelOffset:[7,7]},UU=e=>e&&typeof e.lat=="number"&&typeof e.lng=="number",GU=(e={},t,n,o,r,a={},i,l,c,d,u,m)=>{const g=UU(e)&&t.maps&&!n&&s.jsx(_m,{icon:{path:t.maps.SymbolPath.CIRCLE,fillColor:d.location.fill,fillOpacity:d.location["fill-opacity"],strokeColor:d.location.stroke,strokeOpacity:d.location["stroke-opacity"],strokeWeight:d.location["stroke-weight"],scale:d.location.scale},position:{lat:e.lat,lng:e.lng}},e.lat+e.lng),f=UU(a)&&!n&&s.jsx(_m,{position:{lat:a.lat,lng:a.lng}},a.lat+a.lng),y=()=>{const C=u.map_marker_hollow.split("path d=")[1].split('"');return C&&C[1]};return I=>s.jsx(ie.Fragment,{children:o&&o.map(S=>s.jsx(_m,{clusterer:I,title:S.name,icon:{anchor:new google.maps.Point(...BU.iconOffset),path:y(),labelOrigin:new google.maps.Point(...BU.labelOffset),fillColor:c?.deliveryDestinationId===S.deliveryDestinationId?d.selectedIconFill:d.unselectedIconFill,strokeColor:d.stroke,fillOpacity:d["fill-opacity"],strokeWeight:d["stroke-weight"],scale:c?.deliveryDestinationId===S.deliveryDestinationId?d.selectedIconScale:d.unselectedIconScale},position:{lat:S.coordinates.latitude,lng:S.coordinates.longitude},onClick:()=>{r.analyticsEvent({type:_s.C_N_C_ADDRESS_PIN_CLICK,addressId:S.addressId}),r.toggleActiveCustomerCollection(S),document.getElementById(`select-button-collection-location-id-${S.addressId}`)?.focus()},zIndex:c?.deliveryDestinationId===S.deliveryDestinationId?google.maps.Marker.MAX_ZINDEX:void 0,children:s.jsx(XPt,{position:{lat:S.coordinates.latitude,lng:S.coordinates.longitude},address:S,buildLinkParams:l,buildLink:i,deliveryMethod:Et.clickAndCollect,onDeliveryDestinationSelect:m})},S.addressId)).concat([g,f])})},$U={map_marker_hollow:'<svg viewBox="0 0 24 24"><path d="M12 2C15.7855 2 18.8691 5.00478 18.9959 8.75935L19 9C19 12.3333 16.6667 16.6667 12 22C7.33333 16.6667 5 12.3333 5 9L5.00406 8.75935C5.1309 5.00478 8.21455 2 12 2ZM12 6C10.3431 6 9 7.34315 9 9C9 10.6569 10.3431 12 12 12C13.6569 12 15 10.6569 15 9C15 7.34315 13.6569 6 12 6Z"/></svg>'},ZPt=({user:e,mapProvider:t,error:n,nearbyCollectionPoints:o,actions:r,search:a,buildLink:i,buildLinkParams:l,activeCustomerCollection:c,onDeliveryDestinationSelect:d})=>c?s.jsx(h.Fragment,{children:GU(e,t,n,o,r,a,i,l,c,Ch,$U,d)(void 0)}):s.jsx(kre,{minimumClusterSize:4,children:GU(e,t,n,o,r,a,i,l,c,Ch,$U,d)}),JPt=e=>({nearbyCollectionPoints:ok(e),activeCustomerCollection:UT(e)}),eNt=ot({analyticsEvent:U.analyticsEvent,toggleActiveCustomerCollection:ms.toggleActiveCustomerCollection}),tNt=ke(JPt,eNt)(ZPt),sNt=T.div`
    border-radius: var(--salt-radius-default);
    overflow: hidden;

    .gm-style .gm-style-iw-c {
        inset-block-start: 30px;
        visibility: hidden;
    }

    .gm-style .gm-style-iw-t::after {
        visibility: hidden;
    }

    #collection-point-card-text {
        font-family: 'Source Sans Pro', sans-serif;
        visibility: visible;
        min-inline-size: 280px;
        max-inline-size: 280px;
        margin-block: 0;
        margin-inline: auto;
    }

    div.cluster img {
        inline-size: 0;
    }

    div.cluster div {
        background-color: 'var(--intent-primary)';
        border-radius: 50%;
        border-color: white;
        border-width: 2px;
        border-style: solid;
        font-size: 14px !important;
        color: white !important;
    }
`,nNt={buildLink:p.func.isRequired,buildLinkParams:p.func.isRequired,region:p.string.isRequired,visible:p.bool.isRequired,defaultLat:p.number.isRequired,defaultLong:p.number.isRequired,defaultZoom:p.number.isRequired,maxAddresses:p.number.isRequired,search:p.shape({error:p.string,query:p.string,lastUpdated:p.number,result:p.shape()}),activeCustomerCollection:p.shape({deliveryDestinationId:p.string,addressId:p.string}),collectionPoints:p.shape({data:p.shape({}),isFetching:p.bool,lastUpdated:p.number,didInvalidate:p.bool,fetchError:p.bool}).isRequired,nearbyCollectionPoints:p.shape({addresses:p.array,lastUpdated:p.number}).isRequired,actions:p.shape({performanceMark:p.func.isRequired,updateNearbyCollectionPoints:p.func.isRequired,setGeocode:p.func.isRequired,clearSearchResult:p.func.isRequired,setGeolocationLookupStatus:p.func.isRequired,setNearbyCollectionPointsFetchingError:p.func.isRequired,resetActiveCustomerCollection:p.func.isRequired}).isRequired,intl:p.any.isRequired,height:p.string,sendGeolocationAnalyticsEvent:p.func.isRequired,markersHidden:p.bool,onDeliveryDestinationSelect:p.func.isRequired},oNt={search:{},activeCustomerCollection:null,height:"557px",markersHidden:!1},Nl={},rNt=5*60*1e3,aNt=10*1e3,HU=13,iNt=15,Eu=e=>e&&e.lat&&e.lng,VU=e=>({lat:e.coordinates.latitude,lng:e.coordinates.longitude}),YU=e=>e.filter(t=>t.distance<=aNt),lNt=e=>{Nl.map.fitBounds(e);const{zoom:t}=Nl.map;typeof Nl.map.setZoom=="function"&&Nl.map.setZoom(t>=HU?HU:t)},cNt=e=>({latitude:e.lat,longitude:e.lng});let ak=class extends h.Component{constructor(t){super(t),this.defaultSettings={center:{lat:this.props.defaultLat,lng:this.props.defaultLong},zoom:this.props.defaultZoom},this.state={user:{},search:{},error:null,zoom:this.defaultSettings.zoom},this.formattedMessages={infoWindow:this.props.intl.formatMessage("delivery.collection.address.select.button")},this.onMapMounted=this.onMapMounted.bind(this),this.updateUserLocation=this.updateUserLocation.bind(this),this.handleNavigatorError=this.handleNavigatorError.bind(this),this.geocodeAddress=this.geocodeAddress.bind(this),this.mapProvider={},this.handleBoundsChange=this.handleBoundsChange.bind(this),this.tryToGetCurrentPosition=this.tryToGetCurrentPosition.bind(this),this.onCurrentLocationClick=this.onCurrentLocationClick.bind(this),this.zoomIntoActiveDeliveryDestination=this.zoomIntoActiveDeliveryDestination.bind(this),this.getGeocode=this.getGeocode.bind(this)}componentWillUnmount(){this.props.actions.clearSearchResult()}componentDidUpdate(t){this.props.collectionPoints.lastUpdated!==t.collectionPoints.lastUpdated&&this.updateAddressDistances(Eu(this.state.search)?this.state.search:this.state.user),this.props.nearbyCollectionPoints.lastUpdated!==t.nearbyCollectionPoints.lastUpdated&&setTimeout(()=>this.updateMapBounds(),0),this.props.search.query!==t.search.query&&this.props.search.query?(this.geocodeAddress(this.props.search.query),setTimeout(()=>this.updateMapBounds(),0)):this.props.search.lastUpdated!==t.search.lastUpdated&&setTimeout(()=>this.updateMapBounds(),0),this.props.visible!==t.visible&&setTimeout(()=>this.updateMapBounds(),0),this.props.activeCustomerCollection&&this.props.activeCustomerCollection.deliveryDestinationId!==t.activeCustomerCollection?.deliveryDestinationId&&this.zoomIntoActiveDeliveryDestination(this.props.activeCustomerCollection)}zoomIntoActiveDeliveryDestination(t){const{map:n}=Nl;t&&(n.setCenter(VU(t)),n.setZoom(iNt))}onMapMounted(t){Nl.map=t,this.mapProvider=google,this.props.actions.resetActiveCustomerCollection(),navigator.geolocation&&(this.updateAddressDistances(this.state.search),this.updateMapBounds()),Eu(this.state.search)||this.tryToGetCurrentPosition(),setTimeout(()=>this.props.actions.setGeolocationLookupStatus({complete:!0}),0),this.props.actions.performanceMark({name:OTe})}tryToGetCurrentPosition(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this.updateUserLocation,this.handleNavigatorError,{maximumAge:rNt}):this.handleNavigatorError(new Error("Navigator not supported by browser"))}getGeocode({address:t=null,location:n=null}){const o=new google.maps.Geocoder,{region:r}=this.props,a=Nl.map.getBounds();return new Promise((i,l)=>{o.geocode({address:t,location:n,region:r,bounds:a},(c,d)=>{d==="OK"&&c?.length>0?i(c):l(d)})})}async geocodeAddress(t){try{const[n]=await this.getGeocode({address:t});if(n){const o=n.geometry.location.lat(),r=n.geometry.location.lng();this.updateSearchLocation({lat:o,lng:r}),this.props.actions.setGeocodeResult({result:n,latLng:new google.maps.LatLng(o,r),getGeocode:this.getGeocode})}}catch(n){this.props.actions.setGeocode({error:n}),this.props.actions.setNearbyCollectionPointsFetchingError()}}updateMapBounds(){const{search:t,user:n}=this.state,{nearbyCollectionPoints:o}=this.props,r=Eu(t),a=Eu(n);if(!r&&!a&&o&&o.addresses.length===0)return;const i=new google.maps.LatLngBounds;r?i.extend(t):a&&i.extend(n),o&&o.addresses.length>0&&YU(o.addresses).forEach(c=>i.extend(VU(c))),(r||a||o&&YU(o.addresses).length>0)&&lNt(i)}shouldComponentUpdate(t,n){return this.props.collectionPoints.lastUpdated!==t.collectionPoints.lastUpdated||this.props.nearbyCollectionPoints.lastUpdated!==t.nearbyCollectionPoints.lastUpdated||this.props.search.query!==t.search.query&&t.search.query||this.props.search.lastUpdated!==t.search.lastUpdated||this.props.visible!==t.visible||this.props.activeCustomerCollection!==t.activeCustomerCollection||this.props.search.error!==t.search.error&&t.search.error!=="ZERO_RESULTS"&&t.search.result!==void 0?!0:this.state!==n}handleBoundsChange(){const{clientWidth:n}=window.document.body,o=Ke.md*16,a=n>o||this.props.visible;!this.mapPreviouslyShown&&a&&this.updateMapBounds(),this.mapPreviouslyShown=a}updateLocation(t){this.setState({error:null,zoom:this.defaultSettings.zoom},()=>{Nl.map.panTo(t),this.updateAddressDistances(t),this.updateMapBounds()})}updateSearchLocation(t){const n={lat:t.lat||t.coords.latitude,lng:t.lng||t.coords.longitude};this.setState(o=>({search:{...o.search,...n}})),this.updateLocation(n)}updateUserLocation(t){const{sendGeolocationAnalyticsEvent:n}=this.props,o={lat:t.lat||t.coords.latitude,lng:t.lng||t.coords.longitude},r=!this.props.search.query;this.setState(a=>({user:{...a.user,...o},search:r?{}:a.search})),r&&this.updateLocation(o),n({didLocationUpdate:!0,error:!1})}updateAddressDistances(t){const n=this.props.collectionPoints?.data?Object.values(this.props.collectionPoints.data):[];if(n&&n.length>0&&typeof google<"u"){const o=Eu(t)?t:this.defaultSettings.center;this.props.actions.updateNearbyCollectionPoints({addresses:n,location:cNt(o),nonDefaultLocationExists:Eu(t)!==void 0,limit:this.props.maxAddresses})}}handleNavigatorError(t){const{sendGeolocationAnalyticsEvent:n}=this.props;n({didLocationUpdate:!1,error:!0,errorMessage:t?t.message:"Navigation Error"}),this.setState({error:t.message,search:{},user:{}}),this.updateAddressDistances(),this.updateMapBounds(),t.code===GeolocationPositionError.PERMISSION_DENIED&&this.showGeolocationBlockedNotification()}showGeolocationBlockedNotification(){z.info("delivery.collection.alert.location.permission.blocked")}onCurrentLocationClick(){this.props.actions.clearSearchResult(),this.tryToGetCurrentPosition()}render(){const{buildLink:t,buildLinkParams:n,height:o="557px",markersHidden:r}=this.props,{user:a,search:i,error:l,zoom:c}=this.state;return s.jsx(sNt,{children:s.jsx(WPt,{height:o,zoom:c,center:this.defaultSettings.center,onLoad:this.onMapMounted,onBoundsChanged:this.handleBoundsChange,onCurrentLocationClick:this.onCurrentLocationClick,children:r?null:s.jsx(tNt,{user:a,search:i,mapProvider:this.mapProvider,buildLink:t,buildLinkParams:n,error:l,onDeliveryDestinationSelect:this.props.onDeliveryDestinationSelect})})})}};ak.propTypes=nNt;ak.defaultProps=oNt;const dNt=e=>({language:L2(e),region:k2(e),apiKey:qe(e,"google-maps-api-key"),defaultLat:Number(qe(e,"google-maps-default-lat")),defaultLong:Number(qe(e,"google-maps-default-long")),defaultZoom:Number(qe(e,"google-maps-default-zoom")),maxAddresses:Number(qe(e,"delivery-collection-address-display-limit")),collectionPoints:Jl(e),nearbyCollectionPoints:{...uPt(e),addresses:ok(e)},search:Xd(e),activeCustomerCollection:UT(e)}),uNt=ot({performanceMark:ks,setGeocode:ms.setGeocode,setGeocodeResult:GPt.saveResult,updateNearbyCollectionPoints:ms.updateNearbyCollectionPoints,clearSearchResult:ms.clearSearchResult,setGeolocationLookupStatus:ms.setGeolocationLookupStatus,setNearbyCollectionPointsFetchingError:ms.setNearbyCollectionPointsFetchingError,resetActiveCustomerCollection:ms.resetActiveCustomerCollection}),JJ=Ct(Bt,ke(dNt,uNt))(ak),pNt=({isLoading:e,onDeliveryDestinationSelect:t})=>{const{listView:n,mapView:o,accessibilityMapHeader:r,loadCustomerCollectionDestinations:a,customerCollections:i,buildLink:l,buildLinkParams:c,resetActiveAddressId:d,sendGeolocationEvent:u}=KJ(),[m,g]=h.useState(!1);h.useEffect(()=>{a()},[]);const f=i.length>0;return s.jsxs(Y,{flush:!0,"data-test":"customer-collection-change-modal",children:[s.jsxs(Y.Item,{colSpan:{xs:12,md:6},children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(nee,{areCustomerCollectionsShown:f})}),s.jsx(Y,{children:s.jsx(Y.Item,{colSpan:{xs:6},children:s.jsx(Kt,{breakpoint:"md-up",children:s.jsxs(b,{onClick:()=>g(!m),intent:"secondary",fill:!0,"data-test":"customer-collection-change-modal-toggle-map-button",children:[s.jsx(b.Icon,{name:m?"list":"map_marker_hollow"}),m?n:o]})})})}),s.jsx(Y.Item,{children:s.jsx(TI,{show:!m,children:s.jsx(ZJ,{onDeliveryDestinationSelect:t,customerCollections:i,isLoading:e})})})]}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsxs(TI,{show:m,children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h3",{children:r})}),s.jsx(JJ,{visible:m,buildLink:l,buildLinkParams:c,resetActiveAddressId:d,height:"606px",sendGeolocationAnalyticsEvent:u,markersHidden:!f,onDeliveryDestinationSelect:t})]})})]})},mNt=T(b)`
    position: absolute;
    inset-inline-start: var(--salt-spacing-2);

    @media (min-width: ${Ke.sm}em) {
        inset-inline-start: var(--salt-spacing-4);
    }
`,eee=({onDeliveryDestinationSelect:e,modalName:t,openChooseDeliveryMethodModal:n})=>{const{isOpen:o,close:r,isLoading:a,headerLabelId:i,modalHeader:l,modalSize:c,setSelectedDeliveryDestinationDefault:d}=EPt(t),u=E(Zl),m=I=>()=>{setTimeout(()=>{I()},50)},g=()=>{n&&n()},{Header:f,Body:y}=G;return s.jsxs(G,{isOpen:o,onRequestClose:r,isLoading:a,aria:{labelledby:i},maxWidth:c,"data-test":t,children:[s.jsx(f,{children:s.jsxs(se,{direction:"row",align:"center",children:[u&&s.jsx(mNt,{size:"s",intent:"tertiary",onClick:m(g),fill:!1,"data-test":"test-customer-collection-change-modal-back-button","aria-label":"Back",children:s.jsx(b.Icon,{name:"arrow_left"})}),s.jsx(ne,{as:"h1",className:u?"salt-p-l--2 sm:salt-p-l--0":"",id:i,children:l})]})}),s.jsx(y,{children:s.jsx(pNt,{onDeliveryDestinationSelect:e||d,isLoading:a})})]})},WU=({deliveryAddresses:e,deliveryDestinationId:t,addressId:n})=>e.find(o=>o.deliveryDestinationId===t||o.addressId===n),hNt=()=>{const e=F(),t=E(Wp),n=E($d),o=(i,l)=>{if(t)return;const c=WU({deliveryAddresses:n,addressId:l,deliveryDestinationId:i});c&&e(ea.setSelectedAddress(c))};return{submitAddAddress:async(i,l)=>{const c=WU({deliveryAddresses:n,addressId:i,deliveryDestinationId:l});if(c){e(ea.setSelectedAddress(c));return}const d=await e(N6(i));d&&e(ea.setSelectedAddress({deliveryDestinationId:d.deliveryDestinationId,addressId:i}))},onDeliveryDestinationSelect:({deliveryDestinationId:i,addressId:l})=>{o(i,l),e(Z.closeModal())}}},hc="slotBookingDeliveryDestinationSelector",gNt=()=>{const{submitAddAddress:e,onDeliveryDestinationSelect:t}=hNt();return s.jsxs(h.Fragment,{children:[s.jsx(BT,{submitAddAddress:e}),s.jsx(lPt,{}),s.jsx(eee,{modalName:hc,onDeliveryDestinationSelect:t})]})},tee=()=>E(pg),see=()=>{const e=F();return()=>{e(ms.resetActiveCustomerCollection())}},ENt=()=>{const e=tee(),t=`?${tt.stringify({deliveryMethod:"CUSTOMER_COLLECTION",...e&&{"in-checkout-walk":!0}})}`,o=`${Xb()}${Zae()}`,r=()=>({pathname:o,search:t}),a=()=>`${o}${t}`,i=see();return{buildLink:a,buildLinkParams:r,resetActiveAddressId:i}},fNt=()=>{const{formatMessage:e}=M(),t=e("delivery.collection.address.search"),n=e("accessibility.collection.points.search.button"),{query:o}=E(Xd),{error:r}=E(WJ),a=F(),{options:i}=wt(hc),l=i?.postalCode,c=E(D6e),d=h.useCallback(x=>a(gu.setGeocodeSearchQuery(x)),[a]),u=h.useCallback(()=>a(gu.setNearbyCollectionPointsFetching()),[a]),m=E(D("cptf")),g=E(T6e),f=x=>a(gu.clearSingleCollectionPointFilter(x)),y=()=>a(gu.clearAllCollectionPointFilters()),I=x=>a(gu.applyCollectionPointFilters(x)),S=see(),C=()=>{S(),a(jOt())},_=()=>{r!=null&&a(gu.clearGeocodeError())},A=h.useCallback(x=>{x!==""&&x!==o&&(u(),d(x))},[d,u,o]);return h.useEffect(()=>{l&&!o&&c&&A(l)},[l,A,c,o]),{search:A,addressSearchText:t,initialSearchQuery:l,collectionPointsFilters:g,addressSearchButtonText:n,collectionPointFiltersEnabled:m,onSearchFocus:C,clearGeoCodeError:_,applyCollectionPointFilters:I,clearAllCollectionPointFilters:y,clearSingleCollectionPointFilter:f}},nee=({areCustomerCollectionsShown:e})=>{const t=M(),{addressSearchText:n,initialSearchQuery:o,collectionPointsFilters:r,addressSearchButtonText:a,collectionPointFiltersEnabled:i,search:l,onSearchFocus:c,clearGeoCodeError:d,applyCollectionPointFilters:u,clearAllCollectionPointFilters:m,clearSingleCollectionPointFilter:g}=fNt(),f=t.formatMessage("salt.form.text-field.clear-button.a11y.label"),y="search-postcode-input",I=e||r.filter(S=>S.selected).length>0;return s.jsxs(h.Fragment,{children:[s.jsx(U9,{onSearch:l,name:"address_search",onFocus:c,onChange:d,placeholder:n,"data-test":y,label:{text:n},defaultValue:o??"",clearButton:{ariaLabel:f},searchButtonVisuallyConcealedText:a}),i&&I?s.jsxs(h.Fragment,{children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h3",{children:s.jsx(v,{id:"delivery.collection.filter.header.accessibility"})})}),s.jsx("div",{className:"salt-m-t--2",children:s.jsx(aPt,{filters:r,applyFilters:u})}),s.jsx(iPt,{filters:r,clearSingleFilter:g,clearAllFilters:m})]}):null,s.jsx("div",{className:"salt-m-b--2 salt-m-t--2",children:s.jsx(oPt,{})})]})},yNt=T.div`
    justify-content: space-between;
    display: flex;
    flex-direction: column;
    block-size: 100%;
`,INt=T(Y.Item)`
    display: flex;
    flex-direction: column;
`,SNt=({isLoading:e,setSelectedDeliveryDestination:t})=>{const{listView:n,mapView:o,accessibilityMapHeader:r,loadCustomerCollectionDestinations:a,customerCollections:i,buildLink:l,buildLinkParams:c,resetActiveAddressId:d,sendGeolocationEvent:u}=KJ(),{query:m}=E(YJ),[g,f]=h.useState(!1);h.useEffect(()=>{m&&a()},[m]);const y=i.length>0,I=s.jsx(JOt,{showCollectionPoints:y}),S=()=>y?null:s.jsx(HOt,{});return s.jsxs(Y,{className:"salt-m-t--4",children:[s.jsxs(INt,{colSpan:{xs:12,md:6},children:[s.jsx(nee,{areCustomerCollectionsShown:y}),s.jsx(Y,{flush:!0,className:"salt-p-r--2",children:s.jsx(Y.Item,{colSpan:{xs:6},children:s.jsx(Kt,{breakpoint:"md-up",children:s.jsxs(b,{className:g?"salt-m-b--2":"",intent:"secondary",fill:!0,onClick:()=>f(!g),children:[s.jsx(b.Icon,{name:g?"list":"map_marker_hollow"}),s.jsx(b.Text,{children:g?n:o})]})})})}),s.jsx(TI,{show:!g,children:s.jsxs(yNt,{children:[s.jsx(ZJ,{onDeliveryDestinationSelect:t,customerCollections:i,isLoading:e,topElement:I}),s.jsx(S,{})]})})]}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsxs(TI,{show:g,children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h3",{children:r})}),s.jsx(JJ,{visible:g,buildLink:l,buildLinkParams:c,resetActiveAddressId:d,height:"610px",sendGeolocationAnalyticsEvent:u,markersHidden:!y})]})})]})},CNt=()=>{const{isOpen:e,close:t,isLoading:n,headerLabelId:o,modalHeader:r,modalSize:a,setSelectedDeliveryDestination:i}=UOt(),{Header:l,Body:c}=G;return s.jsxs(G,{isOpen:e,onRequestClose:t,isLoading:n,aria:{labelledby:o},maxWidth:a,"data-test":ld,children:[s.jsx(l,{align:"left",children:s.jsx(ne,{as:"h1",id:o,children:r})}),s.jsx(c,{children:s.jsx(SNt,{isLoading:n,setSelectedDeliveryDestination:i})})]})},TNt=()=>{const e=F(),t=E(Ue(gC)),n=E(up),{currentBreakpoint:o}=h.useContext(Pn),r=o==="lg"?"lg":"md",a=wt(Fl).open,i=()=>{e(Z.closeModal())},l=async c=>{try{const{payload:{responseData:d}}=await zRt({latitude:c.location?.latitude||0,longitude:c.location?.longitude||0,postalCode:c.addressDetails.postalCode,formattedAddress:c.formattedAddress,visitorId:n},e);a({deliveryDestination:d})}catch{z.error("toast.notification.generic.error")}};return s.jsx(G,{isOpen:t,onRequestClose:i,maxWidth:r,children:s.jsx(G.Body,{children:s.jsx(jJ,{onAddressConfirm:l,searchComponent:"AddressSearchWithButton"})})})},{RadioIconOff:_Nt,RadioIconOn:vNt,RadioText:ANt}=ha,oee=T(Ve.Item)`
    margin-block: 0 var(--salt-spacing-4);
`,bNt=T.div`
    opacity: ${({isDisabled:e})=>e?"0.55":"1"};
`,ik=T(zs)`
    flex-flow: row;
`,xNt=T(ik)`
    cursor: ${({isDisabled:e})=>e?"default":"pointer"};
`,RNt=T(P)`
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
`,DNt=({destination:{icon:e,radioLabel:t,radioText:n,radioBtn:o,dataTest:r},isChecked:a,isDisabled:i,handleClick:l})=>s.jsx(oee,{children:s.jsxs(bNt,{isDisabled:i,children:[s.jsxs(xNt,{"data-test":r,tabIndex:i?void 0:0,role:"option","aria-selected":a,isDisabled:i,...!i&&{onClick:l},children:[a&&!i?s.jsx(vNt,{name:"radio_on"}):s.jsx(_Nt,{name:"radio_off"}),s.jsx(ANt,{children:s.jsxs(ik,{children:[s.jsx(me,{name:e,height:20,width:20}),s.jsx(P,{size:"l",bold:!0,className:"salt-m-l--2",children:t})]})})]}),(i||a)&&s.jsxs("div",{className:"salt-m-l--8","data-test":`${r}-content`,children:[n&&s.jsx(RNt,{size:i?"s":"m",className:"salt-d--block salt-m-t--2",children:n}),!i&&o&&s.jsx(b,{intent:"secondary",size:"s",fill:!1,"data-test":o?.dataTest??o.dataTest,onClick:o.action,className:"salt-m-t--2",children:s.jsx(b.Text,{children:o.text})})]})]})}),ONt=ie.memo(DNt);function PNt(e,t){return t&&e.match(t)&&e.match(t).index===0?e.split(t).pop():e}const NNt=()=>function(t,n){return function(r,a){return Promise.all([r(t3.updateAddAddressOrigin(PNt(n,Wt(a())))),t(_R)])}},ree={redirectToAddAddressForm:NNt()};function LNt(){return z.warning("addresses.add.max.toast.message")}function kNt(e){return Z.openModal(e)}function MNt(){const e=F(),t=E(Ze);h.useEffect(()=>{t&&e(wn.getCustomerAddresses())},[]);const n=E(pge);return{status:E(Wx)?"NOT_READY":"READY",value:n}}function jNt(e){return ree.redirectToAddAddressForm(e,window.location.pathname)}function wNt({maxReached:e,isManualFormFlow:t,isManualFormModalEnabled:n,actions:{showMaxAddressNotificationAction:o,sendAnalytics:r,redirectToAddAddressForm:a,openAddAddressModal:i}}){return()=>{r.addAddressButtonClicked(),e?o():t&&!n?a():i()}}function Zd({modalName:e=lr}={}){const{status:t,value:n}=MNt(),o=E(m=>qe(m,"address-maximum-addresses")),r=n>=o,a=E(ud),i=E(D("mfm")),l=Ls(),c=F(),d=We();return t==="NOT_READY"?{status:t,value:()=>{}}:{status:t,value:wNt({maxReached:r,isManualFormFlow:a,isManualFormModalEnabled:i,actions:{showMaxAddressNotificationAction:()=>LNt(),sendAnalytics:l,redirectToAddAddressForm:()=>c(jNt(d)),openAddAddressModal:()=>c(kNt(e))}})}}const FNt=()=>{const{formatMessage:e}=M(),t=E(aS);return e(t?{id:"delivery.destination.selector.plus.changeConfirmation.message.withSlot"}:{id:"delivery.destination.selector.plus.changeConfirmation.message.withoutSlot"})},qU={home:{title:"delivery.destination.selector.plus.scheduled.delivery.option.title",disabled:"delivery.destination.selector.plus.scheduled.delivery.option.unavailable.label",noAddress:"delivery.destination.selector.plus.delivery.option.description",changeAddressBtn:"delivery.destination.selector.plus.delivery.option.change.address.button.title",addAddressBtn:"delivery.destination.selector.plus.button.add.address"},fastHome:{title:"delivery.destination.selector.plus.ondemand.delivery.option.title",disabled:"delivery.destination.selector.plus.ondemand.delivery.option.unavailable.label",noAddress:"delivery.destination.selector.plus.delivery.option.description",changeAddressBtn:"delivery.destination.selector.plus.delivery.option.change.address.button.title",addAddressBtn:"delivery.destination.selector.plus.button.add.address"},collection:{title:"delivery.destination.selector.plus.scheduled.collection.option.title",disabled:"delivery.destination.selector.plus.scheduled.collection.option.unavailable.label",noAddress:"delivery.destination.selector.plus.scheduled.collection.option.description",changeAddressBtn:"delivery.destination.selector.plus.delivery.option.change.collection.point.button.title",addAddressBtn:"delivery.destination.selector.plus.button.choose.collection.point.title"},confirmBtn:"delivery.destination.selector.plus.button.confirm"},BNt=e=>{if(!e)return"";const{name:t,formattedAddress:n,addressId:o,postalCode:r}=e;return o?t?`${t} - ${n}`:n:r||""},UNt=(e,t,n,o,r,a)=>{const i=t?.deliveryMethod===Yi,l=t?.deliveryMethod===r;if(i&&!l&&n)return!n.propositions||n.propositions.length===0?"disabled":n.propositions.find(d=>d.propositionType===o)?"unchecked":"disabled";if(!t)return e&&e.isDefault?"checked":"unchecked";if(t.deliveryMethod!==r)return"unchecked";if(t.deliverability==="NOT_DELIVERABLE")return"disabled";if(t.deliveryMethod===la){if(!t.propositions||t.propositions.length===0)return"disabled";const c=t.propositions.find(d=>d.propositionType===o);if(!c)return"disabled";if(a&&c.regionId!==a)return"unchecked"}return"checked"},GNt=(e,t,n)=>e?e.some(o=>o.propositionType===t&&o.deliveryMethod===n):!1,Tv=e=>{const{formatMessage:t}=M(),n=E(Ele),o=aP(),r=E(l1).data,a=E(Ze),i=E(bd).data,{id:l,deliveryMethod:c,propositionType:d,icon:u,actions:m,dataTest:g,currentDeliveryDestination:f,forceDeliveryDestinationChange:y}=e;if(!GNt(r,d,c)||!r)return;const S=i.find(W=>W.isPrimary&&W.deliveryMethod===la),C=r.find(W=>W.propositionType===d&&W.deliveryMethod===c),_=UNt(C,f,S,d,c,o.regionId||void 0);let A,x;const R=f?.deliveryMethod===Yi,O=f?.deliveryMethod===c;O&&(A=f),R&&!O&&S&&(A=S),A&&(x=A.propositions?.find(W=>W.propositionType===d)?.regionId),R&&!x&&(x=A?.resolvedRegionId);const N=qU[l],k={id:l,icon:u,radioLabel:t(N.title),status:_,dataTest:g};if(_==="disabled")return n?void 0:{...k,radioText:t(N.disabled)};const j=BNt(A);if(!j)return l!=="collection"?{...k,radioText:t(N.noAddress),submitBtn:{text:t(N.addAddressBtn),action:m.addAddress}}:{...k,radioText:"",submitBtn:{text:t(N.addAddressBtn),action:m.addAddress}};const w=!A?.addressId,L=l==="collection"||a&&(!!f&&!w||w&&i.length),B=l!=="collection"&&a&&!!f&&w&&i.length===0;return{...k,radioText:j,...L&&{radioBtn:{text:t(N.changeAddressBtn),action:m.changeAddress}},...B&&{radioBtn:{text:t(N.addAddressBtn),action:m.addAddress}},submitBtn:{isConfirm:y||!aee(A,f,x,o.regionId||void 0),text:t(qU.confirmBtn),action:()=>m.confirm(y,A,f,x,o.regionId||void 0)}}},$Nt=e=>{const t=e.findIndex(r=>r.status==="checked"),n=e.findIndex(r=>r.status==="unchecked"),o=t!==-1?t:n;return o!==-1?o:0},aee=(e,t,n,o)=>!e||!n?!1:t?.deliveryDestinationId===e.deliveryDestinationId&&n===o,HNt=()=>{const e=F(),t=Ne(),n=wt(Fl),o=BC(),r=E(Ze),a=E(l1),i=t.pathname===pp(),l=t.pathname===yd(),c=t.pathname==="/",d=Bg(i||l||c),u=n.options?.deliveryDestination,m=u!=null,g=u||o.data,{value:f}=Zd({modalName:hg});h.useEffect(()=>{!a.lastUpdated&&!a.isFetching&&e(sn.getSupportedPropositions())},[e,a]);const y=wt(tO).open,I=wt(Lp).open,S=wt(gC).open,C=FNt(),_=()=>{I()},A=()=>!a.lastUpdated||a.isFetching,x=(N,k,j,w,L)=>{if(!(!k||!w)){if(!N&&aee(k,j,w,L)){n.close();return}d({deliveryDestinationId:k.deliveryDestinationId,regionId:w,addressId:k.addressId}).then(()=>{n.close()})}},R=[Tv({id:"home",deliveryMethod:la,propositionType:"SCHEDULED",icon:"home_delivery",dataTest:"delivery-destination-radio-home-delivery",actions:{changeAddress:y,addAddress:r?f:S,confirm:x},currentDeliveryDestination:g,forceDeliveryDestinationChange:m}),Tv({id:"fastHome",deliveryMethod:la,propositionType:"FAST",icon:"on_demand",dataTest:"delivery-destination-radio-fast-delivery",actions:{changeAddress:y,addAddress:r?f:S,confirm:x},currentDeliveryDestination:g,forceDeliveryDestinationChange:m}),Tv({id:"collection",deliveryMethod:Yi,propositionType:"SCHEDULED",icon:"click_collect",dataTest:"delivery-destination-radio-collection",actions:{changeAddress:_,addAddress:_,confirm:x},currentDeliveryDestination:g,forceDeliveryDestinationChange:m})].filter(Boolean),O=$Nt(R);return{currentAddress:g?.addressId?g.formattedAddress:g?.postalCode,deliveryDestinationRadios:R,isLoading:A(),isCustomerLoggedIn:r,deliveryDestinationChangeWarningText:C,initialSelectedIndex:O,onVisitorAddressClick:S}},{StyledFooter:VNt}=nW,YNt=T(G.Body)`
    flex-grow: 1;
    overflow: auto;
    padding: var(--salt-spacing-4);

    ${oe.smUp`
        padding-block: ${H(20)};
        padding-inline: ${H(50)};
    `};
`,WNt=T.div`
    inline-size: 100%;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
`,qNt=T(Pe.Typography)`
    inline-size: 90%;
`,_v=()=>s.jsx(oee,{children:s.jsxs(ik,{children:[s.jsx(Pe.Icon,{size:"l"}),s.jsxs(WNt,{className:"salt-m-l--2",children:[s.jsx(Pe.Typography,{variant:"textL",fill:100}),s.jsx(qNt,{variant:"textM",className:"salt-m-t--2"})]})]})}),KNt=()=>s.jsxs(ie.Fragment,{children:[s.jsx(iee,{}),s.jsxs(YNt,{"data-test":"skeleton-modal-content-body",children:[s.jsx(_v,{}),s.jsx(_v,{}),s.jsx(_v,{})]},"body"),s.jsx(VNt,{"data-test":"skeleton-modal-content-footer",children:s.jsx(Pe.Button,{size:"m",fill:!0})},"footer")]}),zNt=T.div`
    display: flex;
    gap: var(--salt-spacing-8);
    flex-direction: column;
`,QNt=T(b)`
    font-weight: 400;
    padding: var(--salt-spacing-2);
    justify-content: space-between;
`,XNt=T(b.Text)`
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
`,ZNt=T(ve)`
    padding: 0;
`,JNt=T(b.Text)`
    text-align: center;
`,eLt=T(G.Footer)`
    padding-block-start: ${({noPaddingTop:e})=>e?"0 !important":"20px"};
`,fb="delivery.destination.selector.plus.title",iee=()=>s.jsx(G.Header,{align:"left",children:s.jsx(ne,{as:"h1",id:fb,children:s.jsx(v,{id:fb})})}),tLt=()=>{const{isLoading:e,currentAddress:t,deliveryDestinationRadios:n,isCustomerLoggedIn:o,deliveryDestinationChangeWarningText:r,initialSelectedIndex:a,onVisitorAddressClick:i}=HNt(),[l,c]=h.useState(a);h.useEffect(()=>{c(a)},[a]);const d=g=>{c(g)},u=n[l],m=u?.submitBtn?.isConfirm;return e?s.jsx(KNt,{}):s.jsxs(ie.Fragment,{children:[s.jsx(iee,{}),s.jsx(G.Body,{children:s.jsxs(zNt,{children:[!o&&t&&s.jsx(ZNt,{children:s.jsxs(QNt,{intent:"tertiary",fill:!0,onClick:i,"data-test":"choose-delivery-method-address",children:[s.jsx(XNt,{className:"sm:salt-d--block",children:t}),s.jsx(b.Icon,{name:"edit"})]})}),s.jsx(ve,{children:s.jsx(Ve,{children:n.map((g,f)=>s.jsx(ONt,{destination:g,isChecked:l===f,isDisabled:g.status==="disabled",handleClick:()=>d(f)},g.id))})})]})}),s.jsx(eLt,{align:"left",noPaddingTop:m,children:s.jsxs(se,{direction:"column",gap:["md"],basis:"100%",children:[m&&s.jsx(P,{"data-test":"delivery-destination-change-warning",children:r}),u?.submitBtn&&s.jsx(b,{intent:"primary","data-test":"choose-delivery-method-submit",onClick:u.submitBtn.action,fill:!0,children:s.jsx(JNt,{children:u.submitBtn.text})})]})})]})},sLt=()=>{const e=F(),t=E(Ue(Fl)),n=()=>e(Z.closeModal());return s.jsx(G,{isOpen:t,onRequestClose:n,aria:{labelledby:fb},maxWidth:"sm","data-test":Fl,children:s.jsx(tLt,{})})},nLt=()=>{const e=F(),t=We(),n=E(Zl),{value:o}=Zd({modalName:hg});return{onClick:()=>{n||t(Na()),e(sn.invalidateHomeDeliveryDestinations()),e(ui({deliveryDestinationChanged:!1,userAction:"Add address"})),e(Z.closeModal()),n&&o()},textId:n?"slotbooking.address.select.add.new.address":"addresses.add.address"}},lee=()=>{const{onClick:e,textId:t}=nLt();return s.jsx(b,{fill:!0,intent:"secondary",onClick:e,"data-test":"dds-addresses-add-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:t})})})},oLt=T(ve)`
    border-radius: var(--salt-radius-default);
    background-color: var(--intent-contrast) !important;
`,rLt=T(Y)`
    inline-size: 100%;
`,aLt=({onConfirm:e})=>{const[t,n]=h.useState(),o=E(Ei),r=E(ma),a=E(mx),i=D6();h.useEffect(()=>{i()},[]),h.useEffect(()=>{const u=a.find(m=>m.deliveryDestinationId===r)||a[0];n(u)},[a,r]);const l=()=>{t&&e(t)},c=d=>{n(d)};return s.jsxs(h.Fragment,{children:[s.jsx(G.Body,{children:o.isFetching?Array.from(Array(3),(d,u)=>s.jsx(rk,{},u)):a.map(d=>{const u=t&&t?.deliveryDestinationId===d.deliveryDestinationId;return s.jsx(oLt,{className:"salt-m-b--0.5 salt-overflow-wrap--anywhere","aria-selected":u,children:s.jsx(ia,{checked:u,onClick:()=>c(d),label:d.name,value:d.deliveryDestinationId,children:d.formattedAddress})},d.deliveryDestinationId)})}),s.jsx(G.Footer,{children:s.jsxs(rLt,{flush:!0,className:"salt-gap--2",children:[s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{fill:!0,intent:"primary",onClick:l,children:s.jsx(b.Text,{children:s.jsx(v,{id:"slotbooking.address.select.confirm"})})})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(lee,{})})]})})]})},vv="delivery.destination.homeDelivery.changeAddress.header",iLt=T(b)`
    @media (min-width: ${Ke.sm}em) {
        position: absolute;
        inset-inline-start: var(--salt-spacing-4);
    }
`,lLt=()=>{const{isOpen:e,close:t}=wt(tO),n=wt(Fl).open,o=r=>{t(),n({deliveryDestination:r})};return s.jsxs(G,{isOpen:e,onRequestClose:t,aria:{labelledby:vv},children:[s.jsx(G.Header,{align:"left",children:s.jsxs(se,{direction:"row",align:"center",children:[s.jsx(iLt,{size:"s",intent:"tertiary",onClick:n,fill:!1,"aria-label":"Back",children:s.jsx(b.Icon,{name:"arrow_left"})}),s.jsx(ne,{as:"h1",id:vv,children:s.jsx(v,{id:vv})})]})}),s.jsx(aLt,{onConfirm:o})]})},cee=()=>{const e=F(),t=uc(),n=E(sg),o=E(Zl),r=!E(Ze),a=f=>{if(f.userAction==="HEADER_CLICKED"){const S=t.data?.deliveryMethod;e(kOt(S))}e(wOt(f));const y=jV[f.userAction];if(!y)return;const I={event:"select_navigation",name:"delivery-destination",location:y};J.sendEvent({GA:I,WA:null})},i=wt(hg).open,l=wt(kp).open,c=wt(ld).open,d=wt(gC).open,u=wt(Fl).open,m=!!t.data?.deliveryDestinationId;return{isDDSEnabled:n,isDDSPlusEnabled:o,isVisitor:r,openDDS:f=>{a(f),r?m?l():o?d():c():o?!m&&f.userAction==="LOGIN_NO_DD"?i():u():l()},openChooseDeliveryMethodModal:u}},Ra={customerCollectionActionHeader:"delivery.destination.selectedMethod.collection.header",customerCollectionChangeDeliveryTypeDescription:"delivery.destination.selectedMethod.collection.changeToHomeDescription",homeDeliveryActionHeader:"delivery.destination.selectedMethod.home.header",homeDeliveryActionChangeDeliveryTypeDescription:"delivery.destination.selectedMethod.home.changeToCollectionDescription",chooseHomeAddress:"delivery.destination.selectedMethod.home.chooseButtonText",chooseCollection:"delivery.destination.selectedMethod.collection.chooseButtonText",homeDeliveryChangeAddress:"delivery.destination.selectedMethod.home.changeButtonText",customerCollectionChangeAddress:"delivery.destination.selectedMethod.collection.changeButtonText",changeYourDeliveryMethod:"delivery.destinations.visitor.selectedMethod.changeButtonText"},cLt=(e,{homeDeliverySelection:t,collectionPointSelection:n,analyticsAction:o},r,a,i)=>{const l=r(Ra.customerCollectionChangeAddress),c=r(Ra.chooseHomeAddress),d=a&&i?{action:()=>{o(!0,"HOME_DELIVERY"),t()},message:c}:void 0;return{changeAddressButton:{action:()=>{o(!1,"CUSTOMER_COLLECTION"),n()},message:l},actionCardData:uee(r,e),changeDeliveryTypeButton:d,changeDeliveryTypeDescription:r(Ra.customerCollectionChangeDeliveryTypeDescription)}},dLt=(e,{homeDeliverySelection:t,collectionPointSelection:n,analyticsAction:o},r,a,i)=>{const l=r(Ra.homeDeliveryChangeAddress),c=r(Ra.chooseCollection),d=a&&i?{action:()=>{o(!0,"CUSTOMER_COLLECTION"),n()},message:c}:void 0;return{changeAddressButton:{action:()=>{o(!1,"HOME_DELIVERY"),t()},message:l},actionCardData:dee(r,e),changeDeliveryTypeButton:d,changeDeliveryTypeDescription:r(Ra.homeDeliveryActionChangeDeliveryTypeDescription)}},uLt=({homeDeliverySelection:e,collectionPointSelection:t,analyticsAction:n},o,r,a)=>{const i=o(Ra.chooseHomeAddress),l=o(Ra.chooseCollection),c={action:()=>{n(!0,"HOME_DELIVERY"),e()},message:i},d={action:()=>{n(!0,"CUSTOMER_COLLECTION"),t()},message:l};return{changeAddressButton:r?c:d,changeDeliveryTypeButton:r&&a?d:void 0,changeDeliveryTypeDescription:""}},dee=(e,t)=>({icon:"home_delivery",headerMessage:e(Ra.homeDeliveryActionHeader),text:`${t.name?`${t.name} - `:""}${t.formattedAddress}`}),uee=(e,t)=>({icon:"click_collect",headerMessage:e(Ra.customerCollectionActionHeader),text:`${t.name} - ${t.formattedAddress}`}),pLt=(e,t,n)=>{const o={action:t,message:n(Ra.changeYourDeliveryMethod)};switch(e.data?.deliveryMethod){case"HOME_DELIVERY":return{actionCardData:dee(n,e.data),changeAddressButton:o};case"CUSTOMER_COLLECTION":return{actionCardData:uee(n,e.data),changeAddressButton:o};default:return{changeAddressButton:o}}},mLt=(e,t,n,o,r,a)=>{switch(e.data?.deliveryMethod){case"CUSTOMER_COLLECTION":return cLt(e.data,t,n,o,a);case"HOME_DELIVERY":return dLt(e.data,t,n,r,a);default:return uLt(t,n,o,r)}},hLt=()=>{const e=F(),{formatMessage:t}=M(),n=BC(),o=wt(kp),r=wt(Ah).open,a=wt(Lp).open,i=wt(ld).open,l=wt(gC).open,c=O6(),d=P6(),u=yXe(),m=gPt(),g=E(Ze),f=E(Zl),y=mLt(n,{homeDeliverySelection:r,collectionPointSelection:a,analyticsAction:m},t,c,d,u),I=pLt(n,f?l:i,t),S=g?y:I,C=()=>{e(ui({deliveryDestinationChanged:!1,userAction:"Close"}))};return{...o,...S,selectedDeliveryDestination:n.data,isLoading:!1,sendAnalytics:C}},Av="delivery.destination.selectedMethod.header",gLt=T.div`
    display: flex;
    gap: var(--salt-spacing-4);
    flex-direction: column;
`,ELt=({changeDeliveryTypeButton:e,changeDeliveryTypeDescription:t})=>e?s.jsxs(ie.Fragment,{children:[s.jsx(Zn,{}),t,s.jsx(b,{intent:"secondary","data-test":"delivery-method-change-delivery-method-button-qwe",onClick:e.action,children:s.jsx(b.Text,{children:e.message})})]}):null,fLt=({actionCardData:e,selectedDeliveryDestination:t})=>s.jsx(ie.Fragment,{children:e&&t&&s.jsxs(He.Action,{id:t.deliveryDestinationId,"data-test":t.deliveryDestinationId,innerRef:void 0,chip:void 0,className:"salt-m--0",children:[s.jsxs(He.Action.Header,{style:$J,children:[s.jsx(me,{name:e.icon,height:20,width:20}),s.jsx(He.Action.HeaderText,{style:HJ,as:"h4",children:e.headerMessage})]}),s.jsx(He.Action.Body,{style:VJ,children:e.text})]},`your-address-selected-${t.deliveryDestinationId}`)}),KU=()=>{const{isOpen:e,close:t,isLoading:n,selectedDeliveryDestination:o,changeDeliveryTypeButton:r,changeDeliveryTypeDescription:a,changeAddressButton:i,actionCardData:l,sendAnalytics:c}=hLt(),{Header:d,Body:u}=G,m=()=>(c(),t());return s.jsxs(G,{isOpen:e,onRequestClose:m,isLoading:n,aria:{labelledby:Av},maxWidth:"sm","data-test":kp,children:[s.jsx(d,{align:"left",children:s.jsx(ne,{as:"h1",id:Av,children:s.jsx(_t,{id:Av})})}),s.jsx(u,{children:s.jsxs(gLt,{children:[s.jsx(fLt,{actionCardData:l,selectedDeliveryDestination:o}),s.jsx(b,{intent:"primary",className:"salt-m-t--4","data-test":"delivery-method-change-address-button",onClick:i.action,children:s.jsx(b.Text,{children:i.message})}),s.jsx(ELt,{changeDeliveryTypeButton:r,changeDeliveryTypeDescription:a})]})})]})},yLt={headerLabelId:"delivery.destination.homeDelivery.changeAddress.header",addAddressButtonTextId:"addresses.add.address"},ILt=()=>{const e=F(),{headerLabelId:t,addAddressButtonTextId:n}=yLt,o=E(Ei),r=E(mx),{formatMessage:a}=M(),i=D6(),l=wt(Ah),c=E(Zl),d=uc(),u=nk(),m=wt(Fl).open,g=iP(),f=()=>e(sn.invalidateHomeDeliveryDestinations()),y=S=>{if(c){l.close(),m({deliveryDestination:S});return}if(f(),g(S)){const C={deliveryDestinationId:S.deliveryDestinationId,deliveryDestinationChanged:!1,deliveryMethod:S.deliveryMethod,userAction:"Delivery destination already selected"};e(ui(C)),l.close();return}u(Ah,S)};return{...l,close:()=>{e(ui({deliveryDestinationChanged:!1,userAction:"Close"})),f(),l.close()},headerLabelId:t,modalHeader:a(t),addAddressButtonText:a(n),setSelectedDeliveryDestination:y,isFetching:o.isFetching,deliverableHomeAddresses:r,loadHomeDeliveryDestinations:i,deliveryDestinationFromSession:d}},zU=T.div`
    display: flex;
    gap: var(--salt-spacing-4);
    flex-direction: column;
`,SLt=({isFetching:e,deliverableHomeAddresses:t,setSelectedDeliveryDestination:n,loadHomeDeliveryDestinations:o})=>{h.useEffect(()=>{o()},[]);const r=e?Array.from(Array(3),(i,l)=>s.jsx(rk,{},l)):t.map(i=>s.jsx(xn,{"data-test":`choose-home-delivery-${i.deliveryDestinationId}`,title:{text:i.name,as:"h2"},description:i.formattedAddress,icon:"home_delivery",as:"button",onClick:l=>(l.preventDefault(),l.stopPropagation(),n(i))},i.deliveryDestinationId)),a=s.jsx(zU,{className:"salt-m--2",children:s.jsx(lee,{})});return s.jsx(zU,{children:[...r,a]})},CLt=({isOpen:e,close:t,modalHeader:n,headerLabelId:o,setSelectedDeliveryDestination:r,deliverableHomeAddresses:a,isFetching:i,loadHomeDeliveryDestinations:l})=>{const{Header:c,Body:d}=G;return s.jsxs(G,{isOpen:e,onRequestClose:t,isLoading:i,aria:{labelledby:o},maxWidth:"sm","data-test":Ah,children:[s.jsx(c,{align:"left",children:s.jsx(ne,{as:"h1",id:o,children:n})}),s.jsx(d,{children:s.jsx(SLt,{isFetching:i,deliverableHomeAddresses:a,setSelectedDeliveryDestination:r,loadHomeDeliveryDestinations:l})})]})},TLt=()=>{const e=ILt();return s.jsx(CLt,{...e})},QU=({openChooseDeliveryMethodModal:e})=>s.jsx(eee,{modalName:Lp,openChooseDeliveryMethodModal:e}),_Lt=()=>{const{headerLabelId:e,isOpen:t,deliveryDestinationChangeWarningText:n,confirmDeliveryDestinationChange:o,onBack:r}=BOt();return s.jsxs(G,{isOpen:t,onRequestClose:r,isLoading:!1,aria:{labelledby:e},maxWidth:"sm","data-test":eO,children:[s.jsx(G.Header,{align:"left",children:s.jsx(ne,{as:"h1",id:e,children:s.jsx(v,{id:e})})}),s.jsx(G.Body,{children:n}),s.jsx(G.Footer,{className:"salt-d--block",align:"left",children:s.jsxs(se,{direction:"column",directionSmUp:"row-reverse",wrap:"nowrap",gap:["sm"],children:[s.jsx(b,{id:"change-destination-confirmation-button",fill:!0,intent:"primary",onClick:o,children:s.jsx(b.Text,{children:s.jsx(v,{id:"delivery.destination.changeConfirmation.confirm.button"})})}),s.jsx(b,{fill:!0,intent:"secondary",onClick:r,children:s.jsx(b.Text,{children:s.jsx(v,{id:"delivery.destination.changeConfirmation.back.button"})})})]})})]})},XU={missingAddressLine1:"delivery.destination.selector.button.missing.address.line1",missingAddressLine2:"delivery.destination.selector.button.missing.address.line2"},vLt=()=>{const{formatMessage:e}=M(),t=E(Ze),o=uc().data,r=o?.deliveryMethod,a=o?.addressId===void 0;return!o||!r?{line1:e(XU.missingAddressLine1),line2:e(XU.missingAddressLine2)}:o.name&&(a||r==="CUSTOMER_COLLECTION"||t)?{line1:o.name}:{line1:o.formattedAddress}},ALt=(e,t)=>{const[n,o]=ip(),r=E(Qs);h.useEffect(()=>{n.get("showDDS")==="true"&&e&&!r.isFetching&&(t({userAction:"EXTERNAL_LINK"}),n.delete("showDDS"),o(n,{replace:!0}))},[r])},bLt=(e,t,n)=>{const o=E(Qs);h.useEffect(()=>{e||!t||o.isFetching||o.data?.deliveryDestinationId||n({userAction:"LOGIN_NO_DD"})},[o])},ZU=T.span`
    display: block;
    max-inline-size: ${H(120)};
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
`,xLt=T(b)`
    max-inline-size: 160px;
    ${oe.lgUp`
        min-inline-size: ${H(90)};
    `}
`,RLt=e=>{const t=F(),{isVisitor:n,isDDSPlusEnabled:o,openDDS:r,openChooseDeliveryMethodModal:a}=cee(),{line1:i,line2:l}=vLt();ALt(o,r),bLt(n,o,r);const c=(m,g)=>{t(FH()),g&&IXe(g)(t).then(f=>{a({deliveryDestination:f})})},d=()=>s.jsxs(ie.Fragment,{children:[s.jsx(KU,{}),n?s.jsx(CNt,{}):s.jsxs(ie.Fragment,{children:[s.jsx(QU,{}),s.jsx(TLt,{})]}),s.jsx(_Lt,{})]}),u=()=>s.jsxs(ie.Fragment,{children:[s.jsx(sLt,{}),s.jsx(QU,{openChooseDeliveryMethodModal:a}),n?s.jsxs(ie.Fragment,{children:[s.jsx(KU,{}),s.jsx(TNt,{})]}):s.jsxs(ie.Fragment,{children:[s.jsx(lLt,{}),s.jsx(BT,{modalName:hg,submitAddAddress:c})]})]});return s.jsxs("div",{...e,children:[s.jsxs(xLt,{fill:!0,intent:"secondary","data-test":"delivery-destination-selector-button","data-synthetics":"delivery-destination-selector-button","aria-describedby":"delivery-destination-selector-description","aria-label":`${i} ${l}`,onClick:()=>r({userAction:"HEADER_CLICKED"}),children:[s.jsx(b.Icon,{name:"map_marker_hollow"}),s.jsxs(b.Text,{className:"salt-d--none sm:salt-d--block",children:[s.jsx(ZU,{children:i}),s.jsx(ZU,{children:l})]})]}),o&&u(),!o&&d()]})},Js={RECIPES:"Recipes",MEAL_PLANNING:"Meal Planning",PROMOTIONS:"Promotions",COUPONS:"Coupons",FAVOURITES:"Favourites",LISTS:"Lists",INSTANT_SHOP:"Instant Shop",REGULARS:"Regulars",RECURRING_ORDERS_SIGN_UP:"Recurring Orders",DELIVERY_PASS:"Delivery Pass",SHOP_IN_SHOP:"SHOP_IN_SHOP_TEMPLATED"},pee=(e,t,n)=>({[Js.RECIPES]:{icon:"recipes",messageString:{lgUp:"navigation.recipes.link",xsUp:"navigation.recipes.link"},getLocation:o=>({...nn(Ya()),search:o}),availability:t.recipes,testId:"recipes-button",analytics:{type:"recipes",sendClickEvent:(o,r)=>{e({type:As.SELECT_NAVIGATION,name:"recipes",location:r??"menu"}),e({type:Nt.RECIPES_NAVIGATION_BAR_BUTTON_CLICKED,description:"User clicked on the recipes navigation bar button"});const a={event:"select_navigation",name:"recipes",location:r??"menu"};J.sendEvent({GA:a,WA:null})}}},[Js.PROMOTIONS]:{icon:"promotion",messageString:{lgUp:"promotions.button",xsUp:"promotions.button"},getLocation:o=>({...nn(lc()),search:o}),availability:t.promotions,testId:"promotions-button",analytics:{type:"offers",sendClickEvent:(o,r)=>{e({type:As.SELECT_NAVIGATION,name:"promotion",location:r??"menu"}),e({type:Nt.OFFERS_NAVIGATION_BAR_BUTTON_CLICKED,description:"User clicked on the offers navigation bar button"});const a={event:"select_navigation",name:"promotion",location:r??"menu"};J.sendEvent({GA:a,WA:null})}}},[Js.COUPONS]:{icon:"coupons",messageString:{lgUp:"coupons.button",xsUp:"coupons.button"},getLocation:o=>({...nn(iT()),search:o}),availability:t.coupons,count:n.coupons,testId:"coupons-button",analytics:{type:"coupons",sendClickEvent:(o,r)=>{e({type:As.SELECT_NAVIGATION,name:"coupons",location:r??"menu"}),e({type:Nt.COUPONS_NAVIGATION_BAR_BUTTON_CLICKED,description:"User clicked on the coupons navigation bar button"});const a={event:"select_navigation",name:"coupons",location:r??"menu"};J.sendEvent({GA:a,WA:null})}}},[Js.FAVOURITES]:{icon:"favourites",messageString:{lgUp:"favorites.button",xsUp:"navigation.favorites"},getLocation:o=>({...nn(Mg()),search:o}),availability:t.favorites,testId:"favourites-button",analytics:{type:"favorites",sendClickEvent:(o,r)=>{e({type:As.SELECT_NAVIGATION,name:"favourites",location:r??"menu"}),e({type:Nt.FAVORITES_NAVIGATION_BAR_BUTTON_CLICKED,description:"User clicked on the favorites navigation bar button"});const a={event:"select_navigation",name:"favourites",location:r??"menu"};J.sendEvent({GA:a,WA:null})}}},[Js.LISTS]:{icon:"list",messageString:{lgUp:"shopping.list.navigation.button",xsUp:"shopping.list.navigation.button"},getLocation:o=>({...nn(zN()),search:o}),availability:t.lists,testId:"shopping-list-button",analytics:{type:"lists",sendClickEvent:(o,r)=>{e({type:As.SELECT_NAVIGATION,name:"lists",location:r??"menu"}),e({type:Nt.LISTS_NAVIGATION_BAR_BUTTON_CLICKED,description:"User clicked on the lists navigation bar button"});const a={event:"select_navigation",name:"lists",location:r??"menu"};J.sendEvent({GA:a,WA:null})}}},[Js.INSTANT_SHOP]:{icon:"smart_cart",messageString:{lgUp:"instant.shop.navigation.button",xsUp:"instant.shop.navigation.button"},getLocation:o=>({...nn(KN()),search:o}),availability:t.instantShop,testId:"instant-shop-button",analytics:{type:"smartCart",sendClickEvent:(o,r)=>{e({type:As.SELECT_NAVIGATION,name:"instant-shop",location:r??"menu"}),e({type:Nt.SMART_CART_NAVIGATION_BAR_BUTTON_CLICKED,description:"User clicked on the smart cart navigation bar button"});const a={event:"select_navigation",name:"instant-shop",location:r??"menu"};J.sendEvent({GA:a,WA:null})}}},[Js.REGULARS]:{icon:"regulars",messageString:{lgUp:"regular.orders.navigation.button",xsUp:"regular.orders.navigation.button"},getLocation:o=>({...nn(Q7()),search:o}),availability:t.regularOrders,testId:"regular-orders-button",analytics:{type:"regularOrders",sendClickEvent:(o,r)=>{e({type:As.SELECT_NAVIGATION,name:"regulars",location:r??"menu"}),e({type:Nt.REGULARS_NAVIGATION_BAR_BUTTON_CLICKED,description:"User clicked on the regulars navigation bar button"});const a={event:"select_navigation",name:"regulars",location:r??"menu"};J.sendEvent({GA:a,WA:null})}}},[Js.RECURRING_ORDERS_SIGN_UP]:{icon:"recurring_order",messageString:{lgUp:"recurring.orders.navigation.button",xsUp:"recurring.orders.navigation.button"},getLocation:o=>({...nn(lo()),search:o}),availability:t.recurringOrders,testId:"recurring-orders-sign-up-button",analytics:{type:"recurringOrdersSingUp",sendClickEvent:(o,r)=>{e({type:As.SELECT_NAVIGATION,name:"recurring-orders",location:r??"menu"}),e({type:Nt.RECURRING_ORDERS_NAVIGATION_BAR_BUTTON_CLICKED,description:"User clicked on the recurring orders navigation bar button"});const a={event:"select_navigation",name:"recurring-orders",location:r??"menu"};J.sendEvent({GA:a,WA:null})}}},[Js.DELIVERY_PASS]:{icon:"delivery_pass",messageString:{lgUp:"delivery.pass",xsUp:"delivery.pass"},getLocation:o=>({...nn(Uo()),search:o}),availability:t.deliveryPass,testId:"delivery-pass-button",analytics:{type:"deliveryPass",sendClickEvent:(o,r)=>{e({type:As.SELECT_NAVIGATION,name:"delivery-pass",location:r??"menu"}),e({type:Nt.DELIVERY_PASS_NAVIGATION_BAR_BUTTON_CLICKED,description:"User clicked on the delivery pass navigation bar button"});const a={event:"select_navigation",name:"delivery-pass",location:r??"menu"};J.sendEvent({GA:a,WA:null})}}},[Js.SHOP_IN_SHOP]:{testId:"shop-in-shop-button",getLocation:(o,r)=>({...nn(xh(r)),search:o}),availability:t.shopInShop,analytics:{type:"shopInShop",sendClickEvent:o=>{e({type:Nt.SHOP_IN_SHOP_NAVIGATION_BAR_BUTTON_CLICKED,description:"User clicked on the shop in shop navigation bar button",pageEventAttributes:{destination:xh(o)}})}}},[Js.MEAL_PLANNING]:{icon:"meal_planning",messageString:{lgUp:"navigation.mealplanner.link",xsUp:"navigation.mealplanner.link"},getLocation:o=>({...nn(kN()),search:o}),availability:t.mealPlanning,testId:"meal-planning-button",analytics:{type:"mealPlanning",sendClickEvent:(o,r)=>{e({type:As.SELECT_NAVIGATION,name:"meal-planning",location:r??"menu"}),e({type:Nt.MEAL_NAVIGATION_BAR_BUTTON_CLICKED,description:"The user clicked the meal planning button on navigation bar."});const a={event:"select_navigation",name:"meal-planning",location:r??"menu"};J.sendEvent({GA:a,WA:null})}}}}),mee=[{type:Js.RECIPES},{type:Js.MEAL_PLANNING},{type:Js.PROMOTIONS},{type:Js.COUPONS},{type:Js.FAVOURITES},{type:Js.LISTS},{type:Js.INSTANT_SHOP},{type:Js.REGULARS},{type:Js.RECURRING_ORDERS_SIGN_UP},{type:Js.DELIVERY_PASS}],hee=e=>e.data.composableNavbar.items,DLt=()=>{const e=F(),{actions:t}=ot({analyticsEvent:U.analyticsEvent})(e);return t.analyticsEvent},OLt=T(al)`
    position: absolute;
    inset-inline-end: calc(var(--salt-spacing-2) * -1);
    inset-block-start: calc(var(--salt-spacing-2) * -1);
`,PLt=D("cmpnb"),NLt=({composableNavbarItemConfig:e,composableNavbarItemMetadata:t})=>{const n=h.useCallback(()=>e.analytics.sendClickEvent(t?.path,"header-navigation"),[e,t]),o=h.useMemo(()=>e.getLocation("?source=header%20button",t?.path),[e,t]);return s.jsx(cs,{breakpoint:"lg-up",display:"inline-block",children:s.jsx(b,{"data-test":t?.path?`${t?.path.split("?")[0]}-${e.testId}`:e.testId,intent:"tertiary",size:"s",asChild:!0,onClick:n,children:s.jsxs(Qe,{to:o,intent:"ghost",children:[t?.label??s.jsx(b.Text,{children:s.jsx(v,{id:e.messageString?.lgUp})}),!!e?.count&&s.jsx(OLt,{intent:"secondary",count:e.count})]})})})},LLt=(e,t)=>e?.availability?s.jsx(NLt,{composableNavbarItemConfig:e,composableNavbarItemMetadata:t}):null,kLt=h.memo(({composableNavbarItemsAvailability:e})=>{const t=E(PLt),n=E(hee),o=E(W5),r=E(Ze),a=DLt();h.useEffect(()=>{d()},[]);const i=t&&n?n:mee,l=h.useMemo(()=>({coupons:r?o:0}),[r,o]),c=h.useMemo(()=>pee(a,e,l),[e,l]),d=()=>{const m=["catalogue",...i.map(g=>c[g.type]).filter(g=>g?.availability).map(g=>g.analytics.type)].map((g,f)=>({BUTTON_TYPE:g,POSITION:f}));a({type:Nt.NAVIGATION_BAR_BUTTON_IMPRESSION,navigationBarButtonImpressions:m})};return s.jsx(ie.Fragment,{children:i.map(u=>LLt(c[u.type],u.metadata))})}),$T=(e,t)=>e.reduce((n,o)=>({...n,[o]:t.formatMessage(`language.${o}`)}),{}),EE=e=>{const t=window.location.search?"&":"?";window.location.href=`${window.location.href}${t}language=${e}`};class MLt extends h.Component{dropdownEl;formattedMessages;constructor(t){super(t),this.state={isOpen:!1},this.closeMenu=this.closeMenu.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.handleClickOutside=this.handleClickOutside.bind(this),this.onLanguageChange=this.onLanguageChange.bind(this),this.dropdownEl=ie.createRef(),this.formattedMessages={language:{...$T(t.languages,t.intl)},preferredLanguage:t.intl.formatMessage("accountSettings.language.selection.label")}}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)}componentDidUpdate(t,n){n.isOpen===!1&&this.state.isOpen&&document.addEventListener("mousedown",this.handleClickOutside),n.isOpen&&this.state.isOpen===!1&&document.removeEventListener("mousedown",this.handleClickOutside)}sendCloseEventCallback(){const{actions:t}=this.props;t.analyticsEvent({type:Nt.LOCALE_DROPDOWN_OPENED,userAction:"CLOSE"})}closeMenu(){this.state.isOpen&&this.setState({isOpen:!1},()=>this.sendCloseEventCallback())}toggleMenu(){this.setState(t=>({isOpen:!t.isOpen}),()=>{this.state.isOpen||this.sendCloseEventCallback()})}onLanguageChange(t){const{actions:n}=this.props;n.analyticsEvent({type:Nt.LOCALE_DROPDOWN_OPENED,userAction:"LOCALE SELECTED",localeSelected:t}),n.analyticsEvent({type:nr.LOCALE_CHANGED,locale:t});const o={event:"event",eventAction:"LOCALE_CHANGED",eventCategory:"Locale",eventLabel:t};J.sendEvent({GA:o,WA:null}),n.analyticsEvent({type:nr.LOCALE_CHANGED_GA4,locale:t});const r={event:"locale_changed",locale:t};J.sendEvent({GA:r,WA:null}),EE(t)}handleClickOutside(t){const{target:n}=t;this.dropdownEl&&this.dropdownEl.current&&!this.dropdownEl.current.contains(n)&&this.closeMenu()}render(){const{activeLanguage:t,languages:n}=this.props,{isOpen:o}=this.state;return n.length>1?s.jsxs(Ot.Container,{ref:this.dropdownEl,children:[s.jsx(bn,{visuallyConcealed:!0,htmlFor:"select-language-menu-button",children:`${this.formattedMessages.preferredLanguage} - ${this.formattedMessages.language[t]}`}),s.jsx(Ot.TriggerSaltButton,{intent:"secondary",size:"m",text:this.formattedMessages.language[t],"data-synthetics":"header-language-select","data-test":"header-language-dropdown",onClick:this.toggleMenu,isOpen:o,id:"select-language-menu-button","aria-controls":"select-language-menu","aria-expanded":o,"aria-haspopup":"true"}),s.jsx(Ot.Body,{isOpen:o,children:s.jsx(Ot.Content,{children:s.jsx(Ve,{"data-test":"select-language-menu",id:"select-language-menu",children:n.map(r=>s.jsx(Ve.Item,{children:s.jsx(Ot.ItemButton,{"data-test":`language-item-button-${this.formattedMessages.language[r]}`,lang:r,onClick:()=>this.onLanguageChange(r),children:this.formattedMessages.language[r]})},this.formattedMessages.language[r]))})})})]}):null}}const jLt=e=>({activeLanguage:Vs(e),languages:Ep(e)}),wLt=ot({analyticsEvent:U.analyticsEvent}),FLt=Ct(Bt,ke(jLt,wLt))(MLt),BLt=D("lng"),ULt=Wl.bind(gE),GLt={languageSelectionEnabled:p.bool.isRequired},gee=({languageSelectionEnabled:e})=>e?s.jsx("div",{className:ULt("header__item","salt-d--none","lg:salt-d--block"),children:s.jsx(FLt,{})}):null;gee.propTypes=GLt;const $Lt=e=>({languageSelectionEnabled:BLt(e)&&MD(e)}),HLt=ke($Lt)(gee),VLt=(e,t)=>{const n=e.length;return(t+1)%n},YLt=(e,t)=>{const n=e.length,o=t-1;return o<0?n-1:o},JU=e=>{if(!e||!`${e}`.trim())return[];const t=`${e}`.toLowerCase().trim().replace(/\s{2,}/g," ").split(" ");return[...new Set(t)]},WLt=(e,t)=>e.every(n=>t.some(o=>o.indexOf(n)===0)),qLt=(e,t,n)=>{const o=[],r=JU(t);let a=0;if(e.length===0)return o;do{const i=e[a];if(i){const l=JU(i);WLt(r,l)&&o.push(i)}a+=1}while(a<e.length&&o.length<n);return o},Eee=()=>{const e=E(r=>parseInt(qe(r,"search-term-search-suggestions-min-characters-for-search-suggestions"),10)),t=E(r=>parseInt(qe(r,"search-term-search-suggestions-max-search-suggestions"),10)),n=E(r=>parseInt(qe(r,"search-term-max-character-length"),10)),o=E(r=>Number(qe(r,"smart-search-suggestions-as-you-type-delay-millis")));return{minCharsToTriggerSearch:e,maxSearchStringLength:n,maxSuggestionsToDisplay:t,smartSearchDelay:o}},KLt=()=>{const e=E(L4),t=F(),n=E(hn);return{getRedirects:()=>{t(Cu.getSearchRedirects(n)).catch(a=>{Me.api.pushError(a)})},getSearchRedirectUrl:a=>{const i=e.find(l=>l.searchTerm.toLowerCase()===a.toLowerCase());return i?i.targetPath:null}}},zLt=()=>{const e=E(PO),{maxSuggestionsToDisplay:t}=Eee(),n=F(),o=E(hn);return{fetchSmartSearchSuggestions:async a=>{if(a!==e?.searchTermFromQueryParam)try{const i=encodeURIComponent(a),[l,c]=await Promise.all([n(Tr.getRefinedSuggestions(i,o,t)),n(Tr.getFollowOnSuggestions(i,o,t))]);if(l&&c){const d={searchTermFromQueryParam:decodeURIComponent(a),itemAddedToBasket:!1,refined:l.payload.responseData,followOn:c.payload.responseData};n(Tr.loadSmartSearchSuggestions(d))}}catch(i){Me.api.pushError(i instanceof Error?i:new Error(`fetchSmartSearchSuggestions error: ${JSON.stringify(i)}`))}},smartSearchSuggestions:e}},QLt=T(Qe)`
    white-space: nowrap;
`;function XLt({children:e,url:t,onClick:n,suggestion:o,state:r}){let a=t;const l=E(L4).find(({searchTerm:c=""}={})=>c.toLowerCase()===o.toLowerCase());if(l){const c=l.targetPath;if(!c.startsWith(window.location.origin))return s.jsx(rt,{href:c,onClick:n,children:e});a=c.slice(window.location.origin.length)}return s.jsx(QLt,{className:"salt-overflow--hidden salt-text-overflow--ellipsis",to:a,state:r,onClick:n,children:e})}const ZLt=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");function JLt(e,t){const n=new RegExp(`(${e.map(r=>ZLt(r)).join("|")})`,"ig");return t.split(n).filter(r=>r!=="").map(r=>({text:r,highlighted:!!r.match(n)}))}function ekt({searchWords:e=[],textToHighlight:t=""}){const n=e.filter(o=>typeof o=="string"&&o!=="");return n.length?s.jsx("span",{children:JLt(n,t).map(({text:o,highlighted:r},a)=>{const i=`suggestion-${t}-part-${a}`;return r?s.jsx("b",{className:"matchingTerm",children:o},i):s.jsx("span",{children:o},i)})}):s.jsx("span",{children:t})}const tkt=Wl.bind(gE);function skt({item:e,index:t,searchWords:n,isSEOReadableURLEnabled:o,onSearchSuggestionClicked:r,source:a}){const i=F(),l=e.trim().split(" ").map(m=>m.charAt(0).toUpperCase()+m.substring(1)).join(" "),c=li(o,{queryString:`q=${encodeURIComponent(l)}`}),{fetchSearchResultsPage:d}=ST(),u=()=>{r(t,l),d({term:l}).then(()=>{i(ft.setLastFetchedCatalogueLocation(void 0))})};return s.jsx(Vn.Item,{className:tkt("header__search-list-item"),"data-test":"search-suggestions-item",children:s.jsx(XLt,{url:c,onClick:u,suggestion:l,state:{source:a,isPrefetched:!0},children:s.jsx(ekt,{searchWords:n,textToHighlight:l})})},l)}const nkt=D("seo.rdbl"),okt=D("sss");function rkt({suggestionsToRender:e,searchTerm:t,onSuggestionClick:n,hideList:o,source:r}){const a=F(),i=h.useMemo(()=>t.split(" "),[t]),l=E(Vs),c=E(nkt),d=E(okt),u=(m,g)=>{a(U.analyticsEvent({type:d?hs.SEARCH_SUGGESTION_CLICKED:hs.SEARCH_SUGGESTION_CHOSEN,id:vt(),userInput:t,searchSuggestion:g,positionInSuggestionList:m,locale:l,...d&&{suggestionsCount:e.length,suggestionType:r,location:"SEARCH_BAR"}})),d&&a(U.analyticsEvent({type:hs.SELECT_SEARCH_SUGGESTION,searchSuggestion:g,suggestionIndex:m,suggestionType:r,location:"SEARCH_BAR"})),n&&n(g),o&&o()};return s.jsx(h.Fragment,{children:e.map((m,g)=>s.jsx(skt,{item:m,index:g,searchWords:i,isSEOReadableURLEnabled:c,onSearchSuggestionClicked:u,source:r},m.trim()))})}const akt=T(ii)`
    min-inline-size: 0;
    padding-inline-end: 30px;
    border: none;
    ${({headerColorScheme:e})=>e==="default"?"background-color: var(--background-color)":"background-color: var(--intent-contrast)"};
    color: var(--intent-content);

    &::placeholder {
        color: var(--intent-content);
    }
`,ikt=T(b)`
    border-start-start-radius: 0;
    border-end-start-radius: 0;
`,lkt=T(b)`
    margin-inline-start: -${H(30)};
`,ckt=T("div")`
    margin-block: auto;
    margin-inline: 0;
`,dkt=Wl.bind(gE),vc={type:"EMPTY",suggestions:[]},ukt=({className:e})=>{const{formatMessage:t}=M(),n=F(),o=We(),r=Ne(),a=E(hn),[i,l,c]=fe(["seo.rdbl","ss.ssm","sss"]),{minCharsToTriggerSearch:d,maxSearchStringLength:u,maxSuggestionsToDisplay:m,smartSearchDelay:g}=Eee(),f=h.useRef(null),y=h.useRef(null),I=h.useCallback(Jr(be=>{n(Tr.getPrimarySuggestions({searchTerm:be,limit:m,maxSuggestionsToDisplay:m,regionId:a}))},g),[m,g]),{correctedSearchTerm:S}=E(Sp),C=E(W1),{data:_,isFetching:A}=E(D4),x=E(Vs),R=E(On),O=ts(),{getRedirects:N,getSearchRedirectUrl:k}=KLt(),{fetchSmartSearchSuggestions:j,smartSearchSuggestions:w}=zLt(),[L,B]=h.useState(()=>new URLSearchParams(r.search).get("q")||""),{fetchSearchResultsPage:W}=ST(),[$,K]=h.useState(-1),[Q,X]=h.useState(vc),re={placeholder:t("search.placeholder"),clear:t("search.input.clear.text")},ue=Cs("theme-web-header-color-scheme")||"default";h.useEffect(()=>{const be=he=>{y.current&&!y.current.contains(he.target)&&(X(vc),K(-1))};return window.addEventListener("mousedown",be),N(),_.length||n(Tr.getPrimarySuggestions({searchTerm:"",limit:2e4,maxSuggestionsToDisplay:m,regionId:a})),()=>{window.removeEventListener("mousedown",be)}},[]),h.useEffect(()=>{const be=S||L.trim();be&&j(be)},[S,C]),h.useEffect(()=>{if(!A&&document.activeElement===f.current){if(l){X({type:"PRIMARY_SEARCH_SUGGESTION",suggestions:_.slice(0,m)});return}de()}A&&!l&&(X(vc),K(-1))},[A]);const te=()=>{B(""),K(-1),ye("")},ce=be=>{const{type:he,suggestions:ge}=be;K(-1),X(be),O({type:hs.SEARCH_SUGGESTION_IMPRESSION,pageViewId:R,searchSuggestionImpressions:ge.map((Oe,Xe)=>({searchTerm:Oe,sequence:Xe,location:"SEARCH_BAR",searchSuggestionType:he}))})},de=()=>{if(c&&w){const[be,he]=OA(w);if(he.length){ce({type:be,suggestions:he});return}}X({type:"PRIMARY_SEARCH_SUGGESTION",suggestions:_.slice(0,m)})},ye=be=>{const he=be.trim();if(K(-1),!he.length){de();return}if(he.length>=d){X({type:"AUTOCOMPLETE_SEARCH_SUGGESTION",suggestions:qLt(_,be,m)});return}X(vc)},Ae=be=>{const he=be.target.value;l&&I(he),B(he),ye(he)},Je=be=>{be.preventDefault();const he=Wle(L),ge=k(he);let Oe=encodeURIComponent(he);if(ge){const{origin:et}=new URL(ge);O({type:hs.SEARCH_REDIRECT,id:vt(),searchTerm:he,redirectURL:ge,locale:x});const we={event:"search_redirect",search_term:he,target:ge};if(J.sendEvent({GA:we,WA:null}),et!==window.location.origin){window.location.assign(ge);return}const Ut=ge.slice(et.length);o(Ut);return}if(he.length>=u){const et=he.lastIndexOf(" ");et>0&&(Oe=encodeURIComponent(he.slice(0,et)))}const Xe=li(i,{queryString:`q=${Oe}`}),Se=$<=-1?"TEXT_SEARCH":Q.type;if(W({term:L}).then(()=>{n(ft.setLastFetchedCatalogueLocation(void 0))}),o(Xe,{state:{source:Se,isPrefetched:!0}}),$>-1&&!c){const et={event:"event",eventCategory:"Search",eventAction:"SuggestionClicked",eventLabel:he};J.sendEvent({GA:et,WA:null})}const dt=$>-1?{type:c?hs.SEARCH_SUGGESTION_CLICKED:hs.SEARCH_SUGGESTION_CHOSEN,id:vt(),userInput:he,searchSuggestion:he,positionInSuggestionList:$,locale:x,pageViewId:R,...c&&{suggestionsCount:Q.suggestions.length,suggestionType:Q.type}}:{type:hs.SEARCH_FORM_SUBMISSION};O(dt),X(vc),K(-1),f.current?.blur()},Ie=()=>{A||de()},je=be=>{K(be);const he=Q.suggestions[be];he&&B(he)},Le=be=>{const{key:he}=be,ge=be.nativeEvent.isComposing;if(he==="ArrowDown"){const Oe=VLt(Q.suggestions,$);ge||je(Oe)}if(he==="ArrowUp"){be.preventDefault();const Oe=YLt(Q.suggestions,$);ge||je(Oe)}(he==="Tab"||he==="Escape")&&(X(vc),K(-1))},Be=be=>{w?.searchTermFromQueryParam.toLowerCase()===be.toLowerCase()&&B(be)};return s.jsxs("form",{className:e,role:"search","data-test":"search-form",autoComplete:"off",onSubmit:Je,onReset:()=>{te(),f.current?.focus()},ref:y,children:[s.jsxs(KS,{children:[s.jsx(akt,{hideLabel:!0,last:!0,ref:f,type:"text",name:"q",id:"search",value:L,placeholder:re.placeholder,maxLength:u,role:"combobox","aria-controls":"search-suggestions-list","aria-expanded":!!Q.suggestions.length,input:{onChange:Ae,onKeyDown:Le,onFocus:Ie},label:"",meta:{touched:!1,invalid:!1},headerColorScheme:ue}),L?s.jsx(ckt,{children:s.jsxs(lkt,{intent:"tertiary",fill:!1,size:"s",type:"reset",children:[s.jsx(Ee,{children:re.clear}),s.jsx(b.Icon,{name:"close_default"})]})}):null,s.jsxs(ikt,{fill:!1,intent:"secondary",type:"submit",children:[s.jsx(Ee,{children:re.placeholder}),s.jsx(b.Icon,{name:"search"})]})]}),!!Q.suggestions.length&&s.jsx(Vn,{className:dkt("header__search-list"),id:"search-suggestions-list",role:"listbox","data-test":"search-suggestions-list",children:s.jsx(rkt,{suggestionsToRender:Q.suggestions,searchTerm:L,onSuggestionClick:Be,hideList:()=>{X(vc),K(-1)},source:Q.type})})]})},pkt=T.div`
    position: sticky;
    inset-block-start: 0;
    z-index: ${Qt.headerWithOverlay};
    display: flex;
    align-items: center;
    gap: var(--salt-spacing-2);
    block-size: ${H(60)};
    padding-block: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-2);
    background: #f2f1f6;
    box-sizing: border-box;
`,mkt=T.img`
    object-fit: contain;
    block-size: 100%;
    border-radius: var(--salt-spacing-2);
`,hkt=T.div`
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;
    overflow: hidden;
`,gkt=T.div`
    font-size: var(--salt-text-m-font-size);
    font-weight: 400;
    color: #090b0a;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
`,Ekt=T.div`
    font-size: var(--salt-text-s-font-size);
    color: #89888d;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
`,fkt=T.a`
    flex: 0 0 auto;
    margin-inline-start: var(--salt-spacing-2);
    padding-block: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-2);
    font-size: var(--salt-text-m-font-size);
    text-decoration: none;
    color: #007aff;
    border: none;
`,ykt=T.button`
    color: #bab9be;
    background: none;
    border: none;
    inline-size: 16px;
`,Ikt=D("sm.bnnr"),fee=h.createContext({dismiss:()=>{},isSmartBannerVisible:!1}),yee=()=>{const e=h.useContext(fee);if(e===void 0)throw new Error("must be used within a SmartBannerProvider");return e},Iee=({children:e})=>{const{dismiss:t,isSmartBannerVisible:n}=aJe();return s.jsx(fee.Provider,{value:{dismiss:t,isSmartBannerVisible:n},children:e})},See=()=>{const{formatMessage:e}=M(),{appTitle:t,appAuthor:n,iosAppId:o,androidCustomScheme:r,iosCustomScheme:a,iosIconUrl:i,androidIconUrl:l}=zC(),{isSmartBannerVisible:c,dismiss:d}=yee(),u=E(Ikt),m=F(),g=c8(),f=g==="ios",y=f?a:r,I=f?i:l,S=nJe(g,y),{androidIntentUrl:C,iosAppStoreUrl:_}=oJe();if(h.useEffect(()=>{if(c&&u){m(U.analyticsEvent({type:ba.SMART_BANNER_IMPRESSION}));const O={event:"ga4_view_promotion",ecommerce:{creative_slot:"mobile_app_prompt",promotion_name:"Go to app",promotion_id:"go_to_app",link_type:"app",content_source:"config"}};J.sendEvent({GA:O,WA:null})}},[m,u,c]),!u)return null;if(!c)return s.jsx(_o,{children:s.jsx("meta",{name:"apple-itunes-app",content:`app-id=${o}`})});const A=()=>g==="other"?void 0:{ios:S?a&&`${a}://`:_,android:C}[g],x=()=>{d(),m(U.analyticsEvent({type:ba.SMART_BANNER_CLOSED}))},R=()=>{m(U.analyticsEvent({type:ba.SMART_BANNER_CLICKED}));const O={event:"ga4_select_promotion",ecommerce:{creative_slot:"mobile_app_prompt",promotion_name:"Go to app",promotion_id:"go_to_app",link_type:"app",content_source:"config"}};J.sendEvent({GA:O,WA:null})};return s.jsxs(ie.Fragment,{children:[s.jsx(_o,{children:s.jsx("meta",{name:"apple-itunes-app",content:`app-id=${o}`})}),s.jsxs(pkt,{children:[s.jsx(ykt,{"data-test":"close-smart-banner","aria-label":e({id:"smart.banner.close.ariaLabel"}),onClick:x,children:s.jsx(me,{name:"close_default",width:12})}),I&&s.jsx(mkt,{"data-test":"smar-banner-logo",src:I,alt:`${t} icon`}),s.jsxs(hkt,{children:[s.jsx(gkt,{"data-test":"smart-banner-app-title",children:t}),n&&s.jsx(Ekt,{"data-test":"smart-banner-app-description",children:n})]}),s.jsx(fkt,{"data-test":"smart-banner-action",onClick:R,href:A(),children:e({id:"smart.banner.open"})})]})]})},Skt=e=>({linkType:e.linkType,openInNewTab:e.openInNewTab,value:null,values:e.values??[],...e.encodedName?{encodedName:e.encodedName}:{}}),Ckt=(e,t=!1,n=[])=>n.flatMap(o=>{if(!o)return[];const{menuCampaignItemId:r,...a}=o,i=La.normalizeToLegacyTarget(a.target,t),l=La.calculateLegacyTargetUrl(i,{isSEOReadableURLEnabled:e});return{...a,id:r,targetUrl:l,target:Skt(i)}}),Tkt=(e,t)=>`${JS.MENU_CAMPAIGNS}-${e}-${t}`,_kt=(e,t)=>{const{label:n,iconUrl:o,name:r}=e;return{label:n,name:n,iconUrl:o,navContentType:JS.MENU_CAMPAIGNS,menuCampaignIndex:t,menuCampaignName:r}},vkt=(e,t,n=!1)=>e.map(({menuCampaignId:o,items:r,...a},i)=>({..._kt(a,i),id:Tkt(o,i),children:Ckt(t,n,r),menuCampaignId:o})),Akt=()=>{const[e=!1,t=!1]=fe(["seo.rdbl","seo.ra"]),[{data:n}]=GI({query:y6});return{isFetching:!1,campaigns:vkt(n?.menuCampaigns??[],e,t)}},bkt=()=>{const e=Cs("ujet-override-strings");return{getMessages:()=>{if(e)try{return JSON.parse(e)}catch(n){Me.api.pushError(n instanceof Error?n:new Error(`UJET support chat messages error: ${JSON.stringify(n)}`));return}}}},eG="#ujet-support-chat-widget",lk=()=>{const{ujet:e,unreadMessageCount:t}=h.useContext(T6),n=Cs("ujet-menu-key-web"),o=Cs("ujet-logo-url"),{getCustomDataToken:r}=C6(),{getMessages:a}=bkt(),[i,l]=h.useState(!0);return h.useEffect(()=>{l(!1)},[]),{ujet:e,loading:i,unreadMessageCount:t,launchChat:async()=>{if(!e){window.location.reload();return}const u=document.querySelector(eG);if(!u?.shadowRoot){l(!0);const{token:m}=await r();if(e.config({disableLauncher:!0,signedCustomData:m,messages:a(),menuKey:n,logo:o}),e.mount(eG),u?.shadowRoot?.mode==="open"){const f=document.createElement("style");f.textContent=`
                            a {
                                color: var(--typography-primary);
                                text-decoration: none;
                            }
                            a:hover {
                                text-decoration: underline;
                            }
                            .message-card-item, .messages .new-message {
                                background: var(--intent-primary-50);
                                color: var(--typography-primary);
                            }
                            .message-card-item:hover, .messages .new-message:hover {
                                background: var(--intent-primary-100);
                                color: var(--typography-primary);
                                opacity: 1;
                            }
                        `,u.shadowRoot.appendChild(f)}e?.show(),l(!1);return}e.visible?e?.hide():e?.show()},destroySession:()=>{e?.destroy()}}},xkt=T.span`
    display: flex;
    align-items: center;
`,Cee=()=>{const e=M(),t=E(Wt),n=E(ua),o=E(Va),r=E(wa),a=ts(),{destroySession:i}=lk(),[l]=fe(["ccai"]),c={logout:e.formatMessage("header.topbar.logout")},d=()=>{try{if(a({type:on.LOGOUT_ANALYTICS,retailerCustomerId:n}),n){const m={event:"event",eventAction:"LoginSuccess",eventLabel:"LoginSuccess",eventCategory:"Login",retailerCustomerId:n};J.sendEvent({GA:m,WA:null})}}catch{Me.api.pushError(new Error("Unable to send logout event"))}},u=m=>{m.preventDefault(),fetch(K$e({basePath:t}),{method:"POST",credentials:"same-origin",headers:{"client-route-id":r,"content-type":"application/json; charset=utf-8","X-CSRF-TOKEN":o}}).then(g=>g.json()).then(({logoutUrl:g})=>(l&&i(),d(),localStorage.removeItem(gh),window.location.assign(g)))};return s.jsx(rt,{standalone:!0,href:pn(),onClick:u,"data-test":"logout-button","data-synthetics":"logout-form",className:"salt-m-x--4 salt-m-y--2 lg:salt-m-x--0 lg:salt-m-y--0",children:s.jsxs(xkt,{children:[s.jsx(me,{name:"logout",height:20,className:"salt-m-r--2"}),s.jsx(P,{size:"m",children:c.logout})]})})},Rkt=D("ads"),bv=T.span`
    display: flex;
    align-items: center;
`,Dkt=({hasLoyalty:e,displayLoginDetails:t,closeMenu:n,dropdownEl:o})=>{const r=t?rd():ad(),a=i=>{const l=o;l&&l.current&&i.target instanceof HTMLElement&&!l.current.contains(i.target)&&n()};return h.useEffect(()=>(document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}),[]),s.jsx(Ot.Body,{isOpen:!0,children:s.jsx(Ot.Content,{className:"salt-p-x--2",children:s.jsxs(Ve,{inline:!1,id:"account-menu","aria-labelledby":"account-button",children:[e&&s.jsx(Ve.Item,{className:"salt-m-b--4",children:s.jsx(Qe,{standalone:!0,to:zu(),onClick:n,children:s.jsxs(bv,{children:[s.jsx(me,{name:"loyalty",height:20,className:"salt-m-r--2"}),s.jsx(P,{size:"m",children:s.jsx(v,{id:"header.topbar.points",values:{amount:s.jsx($u,{getQuantity:bh})}})})]})})}),s.jsx(Ve.Item,{className:"salt-m-b--4",children:s.jsx(Qe,{standalone:!0,to:"/orders","data-synthetics":"orders-list-menu-button",onClick:n,children:s.jsxs(bv,{children:[s.jsx(me,{name:"orders",height:20,className:"salt-m-r--2"}),s.jsx(P,{size:"m",children:s.jsx(v,{id:"header.topbar.orders"})})]})})}),s.jsx(Ve.Item,{className:"salt-m-b--4",children:s.jsx(Qe,{standalone:!0,to:r,"data-synthetics":"topbar-account-settings-link",onClick:n,children:s.jsxs(bv,{children:[s.jsx(me,{name:"settings",height:20,className:"salt-m-r--2"}),s.jsx(P,{size:"m",children:s.jsx(v,{id:"header.topbar.settings"})})]})})}),s.jsx(Ve.Item,{children:s.jsx(Cee,{})})]})})})},Okt=()=>{const e=M(),t=E(Rkt),n=E(kqe),[o,r]=h.useState(!1),a=h.useRef(null),i={accountDropdown:e.formatMessage("header.topbar.account.dropdown")},l=()=>r(!1),c=()=>r(!o);return s.jsxs(Ot.Container,{ref:a,children:[s.jsx(Ot.TriggerSaltButton,{intent:"secondary",size:"m",text:i.accountDropdown,iconName:"account","data-test":"account-dropdown-button","data-synthetics":"account-dropdown-button",isOpen:o,id:"account-button",onClick:c,"aria-haspopup":"true","aria-expanded":o?!0:void 0}),o&&s.jsx(Dkt,{hasLoyalty:n,displayLoginDetails:t,closeMenu:l,dropdownEl:a})]})},Pkt=T(b)`
    position: relative;
    ${oe.lgUp`
        max-inline-size: ${H(200)};
    `}
`,Nkt=T.div`
    position: absolute;
    inset-inline-end: calc(var(--salt-spacing-2) * -1);
    inset-block-start: calc(var(--salt-spacing-2) * -1);
`,Lkt=T.div`
    position: relative;
`,kkt=T(Qe)`
    text-decoration: none;
`,HT=({icon:e="",badge:t,buttonDataTestId:n="",a11yText:o="",children:r})=>{const a=ul(),i=F(),l=E(Cn),c=VP(),d=Cs("theme-web-header-color-scheme");let u="secondary";d==="default"&&(u=l?"secondary":"primary");const m=()=>{i(U.analyticsEvent({type:Te.REDIRECT_TO_SLOT_BOOKING,description:"User clicked link to be redirected to slot booking",pageEventAttributes:{componentLocation:"Header",componentType:"Header",linkType:"Button",userInteraction:"BUTTON_CLICKED"}})),i(U.analyticsEvent({type:_e.BEGIN_CHECKOUT})),a(),i(U.analyticsEvent({type:Kn.CHECKOUT_WALK}))},g=y=>i(ks({name:xS,event:y})),f=y=>{g(y),m(),z.close(Xu)};return s.jsxs(Lkt,{children:[s.jsx(Pkt,{"data-test":n,asChild:!0,intent:u,onClick:f,children:s.jsxs(kkt,{to:c,children:[s.jsx(Ee,{children:o}),s.jsx(b.Icon,{name:e}),s.jsx(b.Text,{className:"salt-d--none sm:salt-d--block",children:r})]})}),s.jsx(Nkt,{children:t&&s.jsx(me,{className:"salt-d--block sm:salt-d--none",name:"status_yes",success:!0})})]})},Mkt=()=>{const e=F(),t=E(Ze),{deliveryDestinationId:n,deliveryMethod:o}=E(Qs).data||{};h.useEffect(()=>{t&&n&&o&&e(xf.getDefaultShippingGroupType(o,n))},[t,n,o])},jkt=({slot:e})=>{const{utcStartTime:t,utcEndTime:n,timeZoneId:o}=e,r=M(),a=E(Jt),i=E(Vt),l=e?.deliveryType===Et.clickAndCollect.type,c=e?.deliveryType===Et.vanDelivery.type,d=Ge(t,Ge.ISO_8601).tz(o).format(),u=Ge(n,Ge.ISO_8601).tz(o).format(),m=()=>l?"click_collect":c?"home_delivery":"slot";return s.jsxs(HT,{badge:!0,icon:m(),buttonDataTestId:"delivery-slot-details-button",a11yText:r.formatMessage("header.delivery.reserved.a11y"),children:[s.jsx("span",{className:"salt-d--block",children:s.jsx(Fh,{dateIso:d,timeZoneId:o,dateFormat:a})}),s.jsx("span",{className:"salt-d--block",children:s.jsx(pE,{dateIsoFrom:d,dateIsoTo:u,timeZoneId:o,timeFormat:i})})]})},wkt=({slot:e})=>{const n=Md()(e?.deliveryTimeInMinutes),o=M();return s.jsx(HT,{badge:!0,icon:"express_collect",buttonDataTestId:"delivery-slot-details-button",a11yText:o.formatMessage("header.delivery.reserved.a11y"),children:s.jsx(v,{className:"salt-d--none sm:salt-d--block",id:"header.delivery.express.collection",values:{readyTimeSpan:n}})})},Fkt=({slot:e})=>{const t=M(),n=t.formatNumber(e?.deliveryTimeInMinutes||0,{style:"unit",unit:"minute",unitDisplay:"short"});return s.jsx(HT,{badge:!0,icon:"on_demand",buttonDataTestId:"delivery-slot-details-button",a11yText:t.formatMessage("header.delivery.reserved.a11y"),children:s.jsx("span",{children:n})})},Bkt=e=>{const[t]=fe(["bt.spl"]),n=E(Ql),o=M();Mkt();let r=jkt;return n?.deliveryMethod==="CUSTOMER_COLLECTION"&&n?.slotType==="ON_DEMAND"&&(r=wkt),n?.deliveryMethod==="HOME_DELIVERY"&&n?.slotType==="ON_DEMAND"&&(r=Fkt),s.jsxs("div",{...e,children:[n&&s.jsx(r,{slot:n}),!n&&s.jsx(HT,{icon:"slot",buttonDataTestId:"delivery-book-delivery-button",a11yText:o.formatMessage(t?"header.delivery.book.grocery":"header.delivery.book"),children:s.jsx(v,{id:t?"header.delivery.book.grocery":"header.delivery.book"})})]})},Ukt={TAB:9,ENTER:13,ESC:27,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40},Ac={missingAddress:"delivery.destination.selector.button.missing.address",delivery:"delivery.destination.selector.plus.scheduled.delivery.option.title",fastDelivery:"delivery.destination.selector.plus.ondemand.delivery.option.title",collection:"delivery.destination.selector.plus.scheduled.collection.option.title"},Gkt=()=>{const{formatMessage:e}=M(),t=uc(),{regionId:n}=aP(),o=t.data,r=o?.deliveryMethod;if(!o||!r)return e(Ac.missingAddress);let a="",i="";if(r==="CUSTOMER_COLLECTION")a=e(Ac.collection);else if(r==="JINN")a=e(Ac.delivery);else if(r==="HOME_DELIVERY"){const c=o.propositions;if(!c||c.length===0)return e(Ac.missingAddress);const d=c.find(m=>m.regionId==n);if(!d)return e(Ac.missingAddress);const u=d.propositionType;u==="FAST"?a=e(Ac.fastDelivery):u==="SCHEDULED"&&(a=e(Ac.delivery))}return o.addressId==null?i=o.postalCode:i=o.name||o.formattedAddress,`${a}: ${i}`},$kt=T(rt)``,Hkt=({linkElement:e,...t})=>{const{openDDS:n}=cee(),o=Gkt(),r=a=>{a.preventDefault(),a.stopPropagation(),n({userAction:"MORE_CLICKED"})};return s.jsx($kt,{standalone:!0,href:pn(),onClick:r,"data-test":"delivery-destination-selector-navigation-button",as:e,...t,children:s.jsxs(se,{align:"center",children:[s.jsx(me,{name:"map_marker_hollow",className:"salt-m-r--2"}),s.jsx(P,{size:"m",children:o})]})})},Vkt=()=>{const e=M(),t=F(),n=E(Ep),o=E(Vs);if(n.length<=1)return null;const r={language:{...$T(n,e)},selectALanguage:e.formatMessage("accountSettings.language.selection.label")},a=async({value:c})=>{t(U.analyticsEvent({type:nr.LOCALE_CHANGED,locale:c}));const d={event:"event",eventAction:"LOCALE_CHANGED",eventCategory:"Locale",eventLabel:c};J.sendEvent({GA:d,WA:null}),t(U.analyticsEvent({type:nr.LOCALE_CHANGED_GA4,locale:c}));const u={event:"locale_changed",locale:c};J.sendEvent({GA:u,WA:null}),EE(c)},i=()=>{if(r.language[o])return{value:o,name:r.language[o]}},l=n.flatMap(c=>{const d=r.language[c];return d!==void 0?[{name:d,value:c}]:[]});return s.jsx(mt.DropdownSelect,{value:i(),options:l,contrastBackground:!0,id:"select-language",name:"select-language",onOptionChange:a,"data-synthetics":"header-language-select",label:{text:r.selectALanguage,isVisuallyConcealed:!0}})},Ykt=D("lng"),Wkt=D("ads"),qkt=D("showpromopage"),Kkt=D("seo.rdbl"),zkt=D("cf.mc.on"),Qkt=D("cmpnb"),Xkt=D("seo.ra"),Zkt=D("cp"),fu="source=navigation",Jkt=()=>{const e=document.getElementById("global-block")?.offsetHeight||0,t=document.getElementById("top-tabs")?.offsetHeight||0;return e+t},tG=e=>e?e.substring(e.lastIndexOf("/")+1):"";class eMt extends h.Component{formattedMessages;menuCampaignsImpressionReported;loggedInEntryPoints;loggedOutEntryPoints;additionalBrowseShopLinks;constructor(t){super(t);const{actions:n,intl:o,hasLoyalty:r,isAllPromotionsPageEnabled:a,isCouponPageEnabled:i,isSEOReadableURLEnabled:l,isDeliveryDestinationSelectorEnabled:c,isComposableNavbarEnabled:d,composableNavbarItems:u,composableNavbarItemsAvailability:m,onBrowseClick:g,couponsCount:f,isLoggedIn:y}=this.props;this.state={overheadContentHeight:0},this.fetchFullCategories=this.fetchFullCategories.bind(this),this.onShowNavigation=this.onShowNavigation.bind(this),this.onHideNavigation=this.onHideNavigation.bind(this),this.setOverheadContentHeight=this.setOverheadContentHeight.bind(this),this.generateItemUrl=this.generateItemUrl.bind(this),this.formattedMessages={back:o.formatMessage("navigation.back"),title:o.formatMessage("navigation.title"),browse:o.formatMessage("navigation.browse"),attributeTitle:o.formatMessage("navigation.menu")};const I={coupons:y?f:0},S=pee(n.analyticsEvent,m,I),C={message:o.formatMessage("promotions.button"),href:lc(),onClick:S[Js.PROMOTIONS].analytics.sendClickEvent},_={message:o.formatMessage("coupons.button"),href:iT(),onClick:S[Js.COUPONS].analytics.sendClickEvent,count:I.coupons},A={message:o.formatMessage("navigation.products"),href:l?Zo(void 0,{queryString:fu}):jo({queryString:fu})};this.additionalBrowseShopLinks=[...a?[C]:[],...i?[_]:[],A];const x={icon:"home",message:o.formatMessage("navigation.home"),href:pn(),onClick:()=>{const ue={event:"select_navigation",name:"home",location:"menu"};return J.sendEvent({GA:ue,WA:null}),this.props.actions.analyticsEvent({type:As.SELECT_NAVIGATION,name:"home",location:"menu"})}},R={Component:Hkt,componentType:"link"},O=()=>{g(),this.dispatchMenuCampaignsImpression()},N={icon:"browse",message:this.formattedMessages.browse,children:this.props.rootCategories,onClick:O,href:l?Zo(void 0,{queryString:fu}):jo({queryString:fu})},k=d&&u?u:mee,j=(ue,te)=>ue?.availability?{icon:ue.icon,message:te?.label?te.label:o.formatMessage(ue.messageString?.xsUp??""),href:ue.getLocation("?source=header%20dropdown",te?.path),onClick:()=>ue.analytics.sendClickEvent(te?.path),...ue?.count&&{count:ue.count}}:void 0,w=k.map(ue=>j(S[ue.type],ue.metadata)).filter(ue=>!!ue),L={icon:"loyalty",message:s.jsx(v,{id:"header.topbar.points",values:{amount:s.jsx($u,{getQuantity:bh})}}),href:zu()},B={icon:"orders",message:o.formatMessage("header.topbar.orders"),href:lo(),onClick:()=>{const ue={event:"select_navigation",name:"orders",location:"menu"};return J.sendEvent({GA:ue,WA:null}),this.props.actions.analyticsEvent({type:As.SELECT_NAVIGATION,name:"orders",location:"menu"})}},W=this.props.displayLoginDetails?rd():ad(),$={icon:"settings",message:o.formatMessage("header.topbar.settings"),href:W},K={Component:Cee,componentType:"link"},Q={icon:"account",message:o.formatMessage("header.topbar.login"),href:Fr(),onClick:()=>{const ue={event:"select_navigation",name:"login",location:"menu"};return J.sendEvent({GA:ue,WA:null}),this.props.actions.analyticsEvent({type:As.SELECT_NAVIGATION,name:"login",location:"menu"})}},X={icon:"account_new",message:o.formatMessage("header.topbar.register"),href:VD(),onClick:()=>{const ue={event:"select_navigation",name:"register",location:"menu"};return J.sendEvent({GA:ue,WA:null}),this.props.actions.analyticsEvent({type:As.SELECT_NAVIGATION,name:"register",location:"menu"})}},re={Component:Vkt};this.loggedInEntryPoints=[x,N,...w,...r?[L]:[],B,$,...c?[R]:[],K],this.loggedOutEntryPoints=[Q,X,x,N,...w,...c?[R]:[],...t.isLanguageSelectEnabled?[re]:[]],this.menuCampaignsImpressionReported=!1}setOverheadContentHeight(){this.setState({overheadContentHeight:Jkt()})}generateItemUrl(t,n,o){const{isSEOReadableURLEnabled:r,categoryDictionary:a,isRegionAgnosticEnabled:i}=this.props,l=t&&!r?`${fu}&sublocationId=${n}`:`${fu}`;if(r&&a){if(t){const c=a[n];if(c&&c.fullURLPath){const d=c.fullURLPath.toLowerCase();return Ui(i?o:n,d,{queryString:l})}}return Zo(void 0,{queryString:l})}return jo({queryString:l})}onShowNavigation(){this.fetchFullCategories(),this.setOverheadContentHeight(),window.addEventListener("resize",this.setOverheadContentHeight)}onHideNavigation(){window.removeEventListener("resize",this.setOverheadContentHeight)}fetchFullCategories(){this.props.categoriesDepth!==4&&this.props.actions.fetchCategories({depth:4,isSEOReadableURLEnabled:this.props.isSEOReadableURLEnabled})}componentDidUpdate(t){const{location:n}=this.props;t.location.key!==n.key&&(this.menuCampaignsImpressionReported=!1)}dispatchMenuCampaignsImpression(){if(this.menuCampaignsImpressionReported)return;const{isMenuCampaignsEnabled:t,menuCampaigns:n,actions:o}=this.props;t&&n?.campaigns.length&&(n.campaigns.forEach((r,a)=>{const{menuCampaignId:i,menuCampaignName:l,iconUrl:c}=r;o.analyticsEvent({type:Nt.MENU_CAMPAIGN_IMPRESSION,menuCampaignId:i,menuCampaignName:l,fileName:tG(c),position:a.toString()});const d={ecommType:"enhanced",eventCategory:"E-commerce",event:"view_promotion",eventAction:"MENU_CAMPAIGN_IMPRESSION",ecommerce:{promoView:{promotions:[{promotionType:"Menu Campaign",id:i,name:l,creative:tG(c),position:`Menu ${a.toString()}`}]}}};J.sendEvent({GA:d,WA:null})}),this.menuCampaignsImpressionReported=!0)}render(){const{isLoggedIn:t,rootCategories:n,categoriesFetching:o,onBrowseClick:r,categoryDictionary:a,isMenuCampaignsEnabled:i,menuCampaigns:l,actions:c,headerColorScheme:d}=this.props,{overheadContentHeight:u}=this.state,m={categoriesDictionary:{categories:a,rootCategories:n},analyticsEvent:c.analyticsEvent,additionalBrowseShopLinks:this.additionalBrowseShopLinks,...i?{menuCampaigns:l.campaigns}:{},entryPointsInHeader:t?this.loggedInEntryPoints:this.loggedOutEntryPoints,messages:this.formattedMessages,onHideNavigation:this.onHideNavigation,onShowNavigation:this.onShowNavigation,"data-test":"header-shop-categories","data-loading":o||l.isFetching,linkElement:Qe,keyboard:Ukt,overheadContentHeight:u,headerColorScheme:d,generateItemUrl:this.generateItemUrl,actions:{onOpen:()=>{this.props.actions.performanceMark({name:Nj})},onOpenLgUp:()=>{r(),this.props.actions.performanceMark({name:Nj}),this.dispatchMenuCampaignsImpression()},onFirstPaneDisplayed:()=>{this.props.actions.performanceMark({name:qTe})},analyticsEvent:c.analyticsEvent}};return s.jsx(uN.Consumer,{children:({setIsOverlayVisible:g})=>s.jsx(zUe,{...m,onToggleDropdown:g})})}}const tMt=e=>({categoriesFetching:WPe(e),categoriesDepth:qPe(e),categoryDictionary:G2(e),rootCategories:$2(e),isAllPromotionsPageEnabled:qkt(e),isCouponPageEnabled:Zkt(e),isLanguageSelectEnabled:Ykt(e)&&MD(e),isLoggedIn:Ze(e),displayLoginDetails:Wkt(e),isSEOReadableURLEnabled:Kkt(e),isMenuCampaignsEnabled:zkt(e),isDeliveryDestinationSelectorEnabled:sg(e),location:bS(e),isComposableNavbarEnabled:Qkt(e),composableNavbarItems:hee(e),isRegionAgnosticEnabled:Xkt(e),couponsCount:W5(e)}),sMt=ot({fetchCategories:Cr.getCategories,performanceMark:ks,analyticsEvent:U.analyticsEvent}),nMt=Ct(Bt,ke(tMt,sMt))(eMt),oMt=(e,t)=>le(e.dates.deliveryEndDate)-le(t.dates.deliveryEndDate),rMt=(e=[])=>{const t=e.find(o=>o.editStatus==="UNDER_EDIT");if(t)return t;const n=e.filter(o=>o.editStatus==="EDITABLE").sort(oMt);return n.length>0?n[0]:null},aMt={pendingOrders:{orders:[]}},iMt=T.div`
    display: flex;
    padding-inline: var(--salt-spacing-2);
    padding-block: var(--salt-spacing-2);
    background-color: var(--intent-action-50);
    border-radius: var(--salt-radius-0);
`,Tee=e=>{h.useEffect(()=>{const{actions:S,isBasketUnderEdit:C}=e;C&&S.getPendingOrders()},[]);const t=M(),n=We(),o=iL(),r=gn(o),{pathname:a}=Ne(),[i]=fe(["thcu"]),{isBasketUnderEdit:l,descriptiveDateFormat:c,timeFormat:d,pendingOrders:u,actions:{onEdit:m}}=e;if(!l)return null;const g=rMt(u.orders),f=!!Or({path:r},a);if(g?.editStatus!=="UNDER_EDIT"||i&&f)return null;const y=s.jsx(El,{dateIso:g.dates.confirmOrderChangesBy,timeZoneId:g.dates.timeZoneId,local:!0,dateFormat:c,timeFormat:d}),I={edit:t.formatMessage("header.order.status.under.edit"),save:t.formatMessage("header.order.status.save.changes",{editUntil:y})};return s.jsxs(iMt,{"data-test":"order-editing-banner",children:[s.jsx(me,{width:20,height:20,className:"salt-m-r--2",name:"orders_edit"}),s.jsxs("div",{children:[s.jsx(P,{size:"l",className:"salt-m-r--1",children:I.edit}),s.jsx(Qe,{href:r,className:"salt-d--inline-block",onClick:()=>m(g.orderId,n),children:s.jsx(P,{size:"l",children:I.save})})]})]})};Tee.defaultProps=aMt;const lMt=e=>({descriptiveDateFormat:Jt(e),timeFormat:Vt(e),isBasketUnderEdit:Mr(e),pendingOrders:Xl(e)}),cMt=ot({onEdit:ci.editOrder,getPendingOrders:di.getPendingOrders}),dMt=Ct(ke(lMt,cMt))(Tee),uMt=({className:e})=>{const{formatMessage:t}=M(),n={superUser:t("header.topbar.superuser").toUpperCase()};return s.jsx(Ce,{className:e,intent:"info",text:s.jsxs(P,{bold:!0,children:[" ",n.superUser]})})},Jd=e=>{const t=F();return n=>{const o={event:"select_navigation",name:n,location:e};J.sendEvent({GA:o,WA:null}),t(U.analyticsEvent({type:As.SELECT_NAVIGATION,name:n,location:e}))}},sG=T.span`
    display: flex;
    align-items: center;
`;function pMt(e,t){const n=`destination=${encodeURIComponent(`${e}${t}`)}`;return Fr({queryString:n})}const mMt=({className:e})=>{const{formatMessage:t}=M(),n=Ne(),o=F(),r=h.useRef(null),[a,i]=h.useState(!1),l=Jd("header"),c=()=>{a&&i(!1)},d=()=>{i(m=>!m)};h.useEffect(()=>{const m=g=>{r?.current?.contains(g.target)||c()};return a?document.addEventListener("mousedown",m):document.removeEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[a]);const u=pMt(n.pathname,n.search);return s.jsxs(Ot.Container,{className:e,ref:r,children:[s.jsx(Ot.TriggerSaltButton,{intent:"secondary",size:"m",text:t("header.topbar.login.dropdown"),"data-test":"login-dropdown-button","data-synthetics":"login-dropdown-button",onClick:d,isOpen:a,id:"login-menu-button","aria-controls":"login-menu","aria-expanded":a,"aria-haspopup":"true"}),s.jsx(Ot.Body,{isOpen:a,children:s.jsx(Ot.Content,{children:s.jsxs(Ve,{id:"login-menu","aria-labelledby":"login-menu-button",children:[s.jsx(Ve.Item,{className:"salt-m-b--4",children:s.jsx(rt,{standalone:!0,href:u,"data-synthetics":"login-button","data-test":"login-button",onClick:()=>{l("login"),o(U.analyticsEvent({type:on.LOGIN_CLICKED,source:"loggedOutTopbar"})),c()},children:s.jsxs(sG,{children:[s.jsx(me,{name:"account",className:"salt-m-r--2"}),s.jsx(v,{id:"header.topbar.login"})]})})}),s.jsx(Ve.Item,{children:s.jsx(rt,{standalone:!0,href:VD(),"data-test":"register-button",onClick:()=>{l("register"),o(U.analyticsEvent({type:on.REGISTER_CLICKED,source:"loggedOutTopbar"})),c()},children:s.jsxs(sG,{children:[s.jsx(me,{name:"account_new",className:"salt-m-r--2"}),s.jsx(v,{id:"header.topbar.register"})]})})})]})})})]})},Er=Wl.bind(gE),hMt=D("loyalty"),gMt=D("showpromopage"),EMt=D(Ud),fMt=D("rec"),yMt=D(AN),IMt=D("ro.su"),SMt=D("hdp"),CMt=D("dp"),TMt=D("sis"),_Mt=D("cp"),vMt=()=>{const e=F(),t=M(),{isOverlayVisible:n}=o9(),o=E(OC),r=E(L=>Zt(L)),a=E(RC),i=E(Ze),l=E(hMt),c=E(gMt),d=E(EMt),u=E(fMt),m=E(yMt),g=E(sg),f=E(IMt),y=E(SMt),I=E(CMt),S=E(TMt),C=E(_Mt),_=E(L=>L.session.isSuperuser),{isSmartBannerVisible:A}=yee(),x=Akt(),R=Ne();h.useEffect(()=>{!r.lastUpdated&&!r.isFetching&&e(Ht.getBasket()),l&&i&&!o.isFetching&&!o.lastUpdated&&e(Fu.getCustomerLoyalty())},[]);const O=h.useCallback(()=>{e(U.analyticsEvent({type:Nt.CATALOGUE_NAVIGATION_BAR_BUTTON_CLICKED,description:"User clicked on the catalogue navigation bar button"}))},[]),N=h.useCallback(()=>{const L={event:"select_navigation",name:"home",location:"header"};return J.sendEvent({GA:L,WA:null}),e(U.analyticsEvent({type:As.SELECT_NAVIGATION,name:"home",location:"header"}))},[]),k=t.formatMessage("home.button"),j=h.useMemo(()=>({deliveryPass:I&&y,favorites:!0,instantShop:!!a,promotions:c,coupons:C,recipes:u,mealPlanning:m,lists:!0,recurringOrders:f,regularOrders:d,shopInShop:S}),[a]),w=Cs("theme-web-header-color-scheme")||"default";return s.jsxs(h.Fragment,{children:[s.jsxs("header",{className:Er({header:!0,"header--overlay-visible":n,"header--smart-banner":A,"header--alternate":w==="alternate"}),id:"main-header",children:[s.jsxs("div",{className:Er({header__row:!0,header__navbar:!0}),children:[s.jsxs(Qe,{className:Er("header__logo","header__logo--l"),href:"/",id:"main-header-logo",onClick:N,children:[s.jsx(Ee,{children:k}),s.jsx(SA,{title:k,type:"default","aria-hidden":"true"})]}),s.jsxs(Qe,{onClick:N,className:Er("header__logo","header__logo--s"),href:"/",children:[s.jsx(Ee,{children:k}),s.jsx(SA,{title:k,type:"small","aria-hidden":"true"})]}),s.jsx(ukt,{className:Er("header__item","header__search")},tt.parse(R.search).q?.toString()||R.pathname),i?s.jsxs(h.Fragment,{children:[_&&s.jsx("div",{className:Er("header__item","salt-d--none","lg:salt-d--block"),children:s.jsx(uMt,{})}),s.jsx("div",{className:Er("header__item","salt-d--none","lg:salt-d--block"),children:s.jsx(Okt,{})})]}):s.jsxs(h.Fragment,{children:[s.jsx(HLt,{}),s.jsx(mMt,{className:Er("header__item","salt-d--none","lg:salt-d--block")})]}),g&&s.jsx(RLt,{className:Er({header__item:!0,"salt-d--none":i,"sm:salt-d--block":i}),"data-test":"delivery-destination-header-button"}),(!g||i)&&s.jsx(Bkt,{className:Er("header__item"),"data-test":"delivery-header-button"}),s.jsx(HRt,{className:Er("header__item")})]}),s.jsxs(se,{className:Er("header__bottom","salt-gap--2","lg:salt-p--2"),children:[s.jsx("div",{className:Er("header__nav-button","salt-m-y--2","salt-m-l--2","lg:salt-m--0"),children:s.jsx(nMt,{menuCampaigns:x,hasLoyalty:o&&o.registered,onBrowseClick:O,isDeliveryDestinationSelectorEnabled:g,composableNavbarItemsAvailability:j,headerColorScheme:w})}),s.jsx(kLt,{composableNavbarItemsAvailability:j})]}),s.jsx(cq,{})]}),s.jsx(dMt,{})]})},_ee=()=>s.jsx(Tat,{children:s.jsx(vMt,{})}),AMt={userInputIgnoreDuration:p.number.isRequired,timerStarted:p.bool.isRequired,callbacks:p.arrayOf(p.func.isRequired).isRequired,children:p.func.isRequired},vee=({userInputIgnoreDuration:e,timerStarted:t,callbacks:n,children:o})=>{const[r,a]=h.useState(void 0);h.useEffect(()=>{t&&a(le())},[t]);const i=n.map(l=>(...c)=>{const d=le();if(r+e<d)return l.apply(l,c)});return o(i)};vee.propTypes=AMt;const bMt={isOpen:p.bool.isRequired,availableLanguages:p.arrayOf(p.string).isRequired,defaultLocale:p.string.isRequired,userInputIgnoreDuration:p.number,actions:p.shape({closeModal:p.func.isRequired,analyticsEvent:p.func.isRequired,setLanguageRequiresConfirmation:p.func.isRequired}).isRequired},xMt={userInputIgnoreDuration:500},ck=({availableLanguages:e,isOpen:t,defaultLocale:n,actions:o,userInputIgnoreDuration:r})=>{const a=d=>{o.setLanguageRequiresConfirmation(!1),o.analyticsEvent({type:nr.LOCALE_MODAL_DISPLAYED,userAction:"LOCALE SELECTED",localeSelected:d}),EE(d)},i=()=>{o.setLanguageRequiresConfirmation(!1),o.analyticsEvent({type:nr.LOCALE_MODAL_DISPLAYED,userAction:"CLOSE"}),o.closeModal()},l="language-preference-modal-header",c=[n,...e.filter(d=>d!==n)];return s.jsx(vee,{timerStarted:t,userInputIgnoreDuration:r,callbacks:[i,a],children:([d,u])=>s.jsx(G,{isOpen:t,aria:{labelledby:l},onRequestClose:d,showCloseIcon:!1,testId:"language-preference-modal",children:s.jsxs(G.Body,{children:[s.jsx(Ee,{asChild:!0,id:l,"data-test":l,children:s.jsx("h2",{children:s.jsx(_t,{id:"language.confirmation.modal.accessibility.heading"})})}),s.jsx(Ve,{children:c.map(m=>s.jsx(Ve.Item,{children:s.jsx(b,{intent:"secondary",fill:!0,onClick:()=>u(m),lang:m,"data-test":`language-preference-button-${m}`,children:s.jsx(b.Text,{children:s.jsx(v,{id:`language.confirmation.action.${m}`})})})},m))})]})})})},RMt=e=>({availableLanguages:Ep(e),isOpen:Ue("languagePreferenceModal")(e),defaultLocale:qe(e,"default-locale")}),DMt=ot({closeModal:Z.closeModal,analyticsEvent:U.analyticsEvent,setLanguageRequiresConfirmation:N2.setLanguageRequiresConfirmation});ck.propTypes=bMt;ck.defaultProps=xMt;const OMt=ke(RMt,DMt)(ck),PMt={languageRequiresConfirmation:p.bool.isRequired,actions:p.shape({openLanguagePreferenceModal:p.func}).isRequired},Aee=({languageRequiresConfirmation:e,actions:t})=>(h.useEffect(()=>{e===!0&&t.openLanguagePreferenceModal()},[e]),s.jsx(OMt,{})),NMt=e=>({languageRequiresConfirmation:Bbe(e)}),LMt=ot({openLanguagePreferenceModal:()=>Z.openModal("languagePreferenceModal")});Aee.propTypes=PMt;const bee=ke(NMt,LMt)(Aee),xee=e=>{const t=eo();h.useEffect(()=>{t({type:Io.ORDER_DISCOUNT_FORM_PROMOTION_IMPRESSION,promotionsFormImpression:[e]})},[])},kMt=()=>{const e=eo(),t=M(),n=E(Jt),r=E(Fpt).map(a=>{const i=Mp(t,a.validityTime,n);return{orderDiscountFormSection:a.orderDiscountFormSection,orderDiscountFormSectionSequence:a.orderDiscountFormSectionSequence,promotionId:a.promotionId,promotionIdText:a.promotionIdText,promotionIdExpiryText:`${i.label??""} ${i.tag??""}`,promotionIdIsSelected:a.promotionIdIsSelected,promotionIdSequence:a.promotionIdSequence}});h.useEffect(()=>{e({type:Io.ORDER_DISCOUNT_FORM_PROMOTION_IMPRESSION,promotionsFormImpression:r})},[e,r])},{CheckboxText:nG,CheckboxIconOff:MMt,CheckboxIconOn:jMt}=kS,wMt=({name:e,value:t,description:n,validityTime:o,disabled:r,alwaysChecked:a,ariaDescribedBy:i,analyticsDataForPromotions:l,dateFormat:c,intl:d,checked:u})=>{const m=$o(),g=td({control:m.control,name:e}),f=C=>(g||[]).includes(C)||a?s.jsx(jMt,{name:"checkbox_on"}):s.jsx(MMt,{name:"checkbox_off"}),y=C=>{r&&C.key===" "&&C.preventDefault()},I=C=>{r&&C.preventDefault()},S=Mp(d,o,c);return xee({orderDiscountFormSection:l?.[t]?.orderDiscountFormSection,orderDiscountFormSectionSequence:l?.[t]?.orderDiscountFormSectionSequence,promotionId:t,promotionIdText:n,promotionIdExpiryText:`${S.label??""} ${S.tag??""}`,promotionIdIsSelected:(g||[]).includes(t),promotionIdSequence:l?.[t]?.promotionIdSequence}),s.jsxs(Ree,{"data-test":"checkbox-input",disabled:r,onClick:I,children:[s.jsx("input",{...m.register(e,{disabled:r}),"aria-describedby":i,"aria-disabled":r,defaultChecked:u,type:"checkbox",value:t,onKeyDown:y})," ",f(t),s.jsxs(Dee,{children:[s.jsx(nG,{"data-test":"description",children:n}),!!S?.label&&s.jsx("span",{"data-test":"expires-label",children:s.jsx(nG,{children:S.label})})]}),!!S?.tag&&s.jsx(Oee,{intent:"secondary","data-test":"expires-today-tomorrow",text:S.tag,singleLine:!0})]})},Ree=T(bn)`
    ${e=>e.disabled&&De`
            background: var(--intent-secondary-100);
            color: var(--intent-content-300);
        `}
    align-items: center;
    inline-size: 100%;
    padding-block: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-4);
    margin: 0;
`,Dee=T.div`
    display: flex;
    flex-direction: column;
`,Oee=T(Fn)`
    margin-inline-start: auto;
`,FMt=Ct(Bt)(wMt),BMt=({data:e,intl:t,...n})=>{const o=t.formatMessage("toggleablepromotions.modal.inclusive.promotions.description");return s.jsxs(ie.Fragment,{children:[s.jsx(P,{asChild:!0,bold:!0,"data-test":"group-description",className:"salt-m-t--4 salt-m-b--2",children:s.jsx("h3",{children:o})}),s.jsx(aa,{fluid:!0,"data-test":"checkbox-group",children:e.map(r=>s.jsx(Pee,{"data-test":"list-item",disabled:!r.changeable,children:s.jsx(FMt,{value:r.promotionId,description:r.description,validityTime:r.validityTime,disabled:!r.changeable,alwaysChecked:r.selected&&!r.changeable,checked:r.selected,...n})},r.promotionId))})]})},Pee=T(aa.Row)`
    min-block-size: ${H(52)};
    padding: 0;
    align-items: stretch;
`,xv=Ct(Bt)(BMt),{RadioIconOff:UMt,RadioIconOn:GMt,RadioText:oG}=ha,$Mt=({name:e,value:t,description:n,validityTime:o,disabled:r,ariaDescribedBy:a,analyticsDataForPromotions:i,dateFormat:l,intl:c})=>{const d=$o(),u=td({control:d.control,name:e}),m=f=>u===f?s.jsx(GMt,{name:"radio_on"}):s.jsx(UMt,{name:"radio_off"}),g=Mp(c,o,l);return xee({orderDiscountFormSection:i?.[t]?.orderDiscountFormSection,orderDiscountFormSectionSequence:i?.[t]?.orderDiscountFormSectionSequence,promotionId:t,promotionIdText:n,promotionIdExpiryText:`${g.label??""} ${g.tag??""}`,promotionIdIsSelected:u===t,promotionIdSequence:i?.[t]?.promotionIdSequence}),s.jsxs(Ree,{disabled:r,children:[s.jsx(HMt,{...d.register(e),"aria-disabled":r,"aria-describedby":a,type:"radio","data-test":"radio-input",value:t,disabled:r})," ",m(t),s.jsxs(Dee,{children:[s.jsx(oG,{"data-test":"description",children:n}),!!g?.label&&s.jsx("span",{"data-test":"expires-label",children:s.jsx(oG,{children:g.label})})]}),!!g?.tag&&s.jsx(Oee,{intent:"secondary","data-test":"expires-today-tomorrow",text:g.tag,singleLine:!0})]})},HMt=T.input`
    :focus + span {
        outline: ${H(5)} auto Highlight;
        outline: ${H(5)} auto -webkit-focus-ring-color;
    }
`,VMt=Ct(Bt)($Mt),YMt=({data:e,intl:t,...n})=>{const o=t.formatMessage("toggleablepromotions.modal.exclusive.promotions.description"),r=t.formatMessage("toggleablepromotions.modal.exclusive.promotions.none.option.text");return s.jsxs(ie.Fragment,{children:[s.jsx(P,{asChild:!0,bold:!0,"data-test":"group-description",className:"salt-m-t--4 salt-m-b--2",children:s.jsx("h3",{children:o})}),s.jsx(aa,{fluid:!0,"data-test":"radio-group",children:e.map(a=>s.jsx(Pee,{"data-test":"list-item",disabled:!a.changeable,children:s.jsx(VMt,{value:a.promotionId,description:a.promotionId===wl?r:a.description,validityTime:a.validityTime,disabled:!a.changeable,...n})},a.promotionId))})]})},Rv=Ct(Bt)(YMt),WMt=D("m.la.h"),qMt=D("tp.np"),KMt=({initialValuesForToggleablePromotionsModal:e,promotionSelections:t,modalLeftAlignEnabled:n,toggleablePromotionsNoneOptionEnabled:o,toggleablePromotionsFormData:r,dataToDisplayListOfPreAppliedPromotions:a,headerLabelId:i,intl:l,analyticsDataForPromotions:c,exclusiveNotChangeablePromotionsData:d,dateFormat:u,actions:{submitPromotionSelections:m},handleClose:g})=>{const f=Gn({defaultValues:e}),y=Ne(),I=async L=>{const B=Object.values(L).flat().filter(Boolean),W=t.map(Q=>({...Q,selected:B.includes(Q.promotionId)})),$=$K(W,d),K=t.every(Q=>{const X=W.find(re=>re.promotionId===Q.promotionId);return Q.selected===X?.selected});await m(o?W.concat($):W),g({userAction:Hc.SAVE,hasSelectionChange:!K,selectedPromotionId:W.filter(({selected:Q})=>Q).map(({promotionId:Q})=>Q)})},S=l.formatMessage("toggleablepromotions.modal.description"),C=l.formatMessage("toggleablepromotions.modal.alternative.description"),_=l.formatMessage("toggleablepromotions.modal.subtitle.general"),A=l.formatMessage("toggleablepromotions.modal.subtitle.description.general"),x=l.formatMessage("toggleablepromotions.modal.subtitle.delivery"),R=l.formatMessage("toggleablepromotions.modal.subtitle.loyalty"),O=l.formatMessage("toggleablepromotions.modal.subtitle.description.loyalty"),N=l.formatMessage("toggleablepromotions.modal.subtitle.preapplied"),k=l.formatMessage("toggleablepromotions.modal.button.cancel"),j=l.formatMessage("toggleablepromotions.modal.button.save.changes"),w=l.formatMessage("toggleablepromotions.modal.title");return s.jsxs(ie.Fragment,{children:[s.jsx(G.Header,{align:n?"left":"center",children:s.jsx(ne,{as:"h1",id:i,"data-test":i,children:w})}),s.jsxs(G.Body,{children:[s.jsx($n,{...f,children:s.jsxs("form",{onSubmit:f.handleSubmit(I),children:[s.jsx(Ce,{intent:"info","data-test":"modal-description",showIcon:!1,text:y.pathname==="/"?C:S}),r.SAVING&&s.jsxs("div",{id:dn.SAVING,children:[s.jsx(P,{asChild:!0,size:"l",bold:!0,className:"salt-m-t--4 salt-m-b--1",children:s.jsx("h2",{children:_})}),s.jsx(rG,{children:A})]}),r.SAVING&&r.SAVING.map(L=>L.limitPerOrder?L.limitPerOrder===1?s.jsx(Rv,{ariaDescribedBy:dn.SAVING,"data-test":"radio-group",name:L.applicationGroupName,data:L.promotions,analyticsDataForPromotions:c,dateFormat:u},L.applicationGroupName):null:s.jsx(xv,{ariaDescribedBy:dn.SAVING,"data-test":"checkbox-group",name:L.applicationGroupName,data:L.promotions,analyticsDataForPromotions:c,dateFormat:u},L.applicationGroupName)),r.DELIVERY&&s.jsx(P,{id:dn.DELIVERY,asChild:!0,size:"l",bold:!0,className:"salt-m-t--4 salt-m-b--1",children:s.jsx("h2",{children:x})}),r.DELIVERY&&r.DELIVERY.map(L=>L.limitPerOrder?L.limitPerOrder===1?s.jsx(Rv,{ariaDescribedBy:dn.DELIVERY,"data-test":"radio-group",name:L.applicationGroupName,data:L.promotions,analyticsDataForPromotions:c,dateFormat:u},L.applicationGroupName):null:s.jsx(xv,{ariaDescribedBy:dn.DELIVERY,"data-test":"checkbox-group",name:L.applicationGroupName,data:L.promotions,analyticsDataForPromotions:c,dateFormat:u},L.applicationGroupName)),r.LOYALTY&&s.jsxs("div",{id:dn.LOYALTY,children:[s.jsx(P,{asChild:!0,size:"l",bold:!0,className:"salt-m-t--4 salt-m-b--1",children:s.jsx("h2",{children:R})}),s.jsx(rG,{children:O})]}),r.LOYALTY&&r.LOYALTY.map(L=>L.limitPerOrder?L.limitPerOrder===1?s.jsx(Rv,{ariaDescribedBy:dn.LOYALTY,"data-test":"radio-group",name:L.applicationGroupName,data:L.promotions,analyticsDataForPromotions:c,dateFormat:u},L.applicationGroupName):null:s.jsx(xv,{ariaDescribedBy:dn.LOYALTY,"data-test":"checkbox-group",name:L.applicationGroupName,data:L.promotions,analyticsDataForPromotions:c,dateFormat:u},L.applicationGroupName))]})}),!!Object.keys(a).length&&s.jsxs(ie.Fragment,{children:[s.jsx(P,{id:b$e,asChild:!0,size:"l",bold:!0,className:"salt-m-t--4 salt-m-b--1",children:s.jsx("h2",{children:N})}),s.jsx(L7,{dataToDisplayList:a})]})]}),s.jsxs(G.Footer,{children:[s.jsx(b,{className:"salt-m-r--2",intent:"secondary",fill:!0,"data-test":"cancel-discounts",onClick:()=>g({userAction:Hc.CANCEL,hasSelectionChange:!1}),children:s.jsx(b.Text,{children:k})}),s.jsx(b,{fill:!0,intent:"primary","data-test":"save-discounts-changes",onClick:f.handleSubmit(I),children:s.jsx(b.Text,{children:j})})]})]})},rG=T.div`
    font-size: var(--salt-text-m-font-size);
`,zMt=e=>({modalLeftAlignEnabled:WMt(e),toggleablePromotionsNoneOptionEnabled:qMt(e),initialValuesForToggleablePromotionsModal:b7(e),promotionSelections:D7(e),exclusiveNotChangeablePromotionsData:O7(e),analyticsDataForPromotions:wpt(e),dateFormat:Jt(e)}),QMt=ot({submitPromotionSelections:j1e}),XMt=Ct(Bt,ke(zMt,QMt))(KMt),ZMt=({isOpen:e,toggleablePromotionsFormData:t,dataToDisplayListOfPreAppliedPromotions:n,actions:{sendPromotionsAnalyticsPageEvent:o,close:r}})=>{if(!t)return null;const a="toggleable-promotions-v1-modal-header",i=({userAction:l,hasSelectionChange:c,selectedPromotionId:d})=>{o({type:Io.ORDER_DISCOUNT_FORM_MODAL_CLOSED,description:"Modal for order promotions is closed",userAction:l,hasSelectionChange:c,selectedPromotionId:d}),r()};return s.jsx(G,{"data-test":"promotions-modal",isOpen:e,onRequestClose:()=>i({userAction:Hc.RETURN,hasSelectionChange:!1}),aria:{labelledby:a},children:s.jsx(XMt,{toggleablePromotionsFormData:t,dataToDisplayListOfPreAppliedPromotions:n,headerLabelId:a,handleClose:i})})},JMt=e=>({isOpen:Ue("discountOnOrder")(e),toggleablePromotionsFormData:x7(e),dataToDisplayListOfPreAppliedPromotions:GN(e)}),ejt=ot({sendPromotionsAnalyticsPageEvent:wu,close:Z.closeModal}),Nee=Ct(ke(JMt,ejt))(ZMt),aG=new zi,tjt=!!(typeof window<"u"&&window.document?.createElement),Lee=()=>{const e=E(D("r.coo")),t=z.getNotifications(),n=M(),o=()=>{const a=QI(Z$(13,Ll()));aG.set($s.PRIVACY_ACCEPTED,"True",{expires:a,path:"/"})};if(e){const r="privacytoast",a=!!aG.get($s.PRIVACY_ACCEPTED),i=!!t.find(l=>l.id===r);tjt&&!a&&!i&&z.info("site.privacy.notification.text",{link:s.jsx(Vr,{label:n.formatMessage("site.privacy.notification.link.text"),to:n.formatMessage("site.privacy.notification.link.url")}),id:r,onClose:o})}return null},kee=()=>async(e,t)=>{const n=hn(t());return e(Wf.getSlotDisplayModes(n))},sjt=(e=!1)=>({type:"API",payload:{url:"/v3/content/content-blocks",...Vf},isSEOReadableURLEnabled:e}),op={getContentBlocks:sjt},Mee=3,_I=({isExternalLink:e,target:t,children:n,href:o,...r})=>e||V3(t?.linkType)?s.jsx(rt,{href:o,target:t?.openInNewTab?"_blank":void 0,...r,children:n}):s.jsx(Qe,{to:o,target:t?.openInNewTab?"_blank":void 0,...r,children:n}),njt=hN("IN_PAGE"),ojt=Kg("IN_PAGE"),rjt=D("seo.rdbl"),ajt={actions:p.shape({analyticsEvent:p.func.isRequired,fetchContentBlocks:p.func.isRequired}).isRequired,contentBlocksCommonData:p.shape({lastUpdated:p.number,fetchError:p.bool,isFetching:p.bool}).isRequired,contentBlocksInPage:p.shape({id:p.oneOfType([p.string,p.number]),type:p.oneOf(["HEADER","IN_PAGE"]),name:p.string.isRequired,backgroundType:p.string.isRequired,targetUrl:p.string,isExternalLink:p.bool,content:p.shape({images:p.string,solid:p.shape({backgroundSolidColor:p.string.isRequired,bodyText:p.string,callToActionColor:p.string,callToActionText:p.string,headline:p.string.isRequired,textColor:p.string.isRequired}).isRequired}).isRequired,target:p.shape({linkType:p.string.isRequired,value:p.string.isRequired,openInNewTab:p.bool}).isRequired}).isRequired,isContentBlockInPageEmpty:p.bool.isRequired,isSEOReadableURLEnabled:p.bool.isRequired,isBasketBeingEdited:p.bool.isRequired},ijt=T.div`
    display: flex;
    justify-content: space-between;
    align-items: center;
    inline-size: 100%;
    gap: ${H(5)};
    padding-block: ${H(6)};
    padding-inline: ${H(16)};
    min-block-size: ${H(52)};
    background-color: ${({backgroundColor:e})=>e};
    color: ${({color:e})=>e};

    ${oe.lgUp`
        padding: ${H(10)} ${H(16)};
        min-height: ${H(40)};
    `}
`,ljt=T(se)`
    flex: 1 1 auto;
    justify-content: flex-start;
    flex-direction: column;
    overflow: hidden;

    ${oe.lgUp`
        flex-direction: row;
        flex-wrap: nowrap;
        gap: ${H(10)}
    `}
`,iG=T(P)`
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: block-axis;
    overflow: hidden;
    text-overflow: ellipsis;
    color: ${({color:e})=>e};
`,cjt=T(P)`
    display: inline;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    color: ${({callToActionColor:e})=>e};

    &:hover {
        text-decoration: underline;
    }
`,djt={},dk=({actions:e,contentBlocksCommonData:t,contentBlocksInPage:n,isContentBlockInPageEmpty:o,isBasketBeingEdited:r,isSEOReadableURLEnabled:a})=>{const i=M(),l=Ne(),{fetchContentBlocks:c,analyticsEvent:d}=e,{lastUpdated:u,isFetching:m}=t,[g,f]=h.useState(0),[y,I]=h.useState(vt()),C=[pn(),jo(),lc(),vi(":productId",a?":retailerProductName":void 0),li(a),xh(":pageId"),zO(":pageId"),...a?[Zo(),Zo(":fullCataloguePath")]:[]].every(ue=>{const te=ue===Zo(":fullCataloguePath");return!Or({path:ue,end:!te},l.pathname)}),_=o||C||r;if(h.useEffect(()=>{_||I(()=>{const ue=vt();return d({type:Xr.CONTENT_BLOCK_IMPRESSION,contentBlockImpression:{entryId:A,contentBlockType:R,entryName:x,advertId:y}}),ue})},[l.key]),h.useEffect(()=>{g<Mee&&!u&&!m&&c(a).then(()=>{f(0)}).catch(()=>{f(g+1)})},[g,u,m]),_)return null;const{id:A,name:x,type:R,target:O,isExternalLink:N,targetUrl:k,content:{solid:{backgroundSolidColor:j,bodyText:w,callToActionColor:L,callToActionText:B,headline:W,textColor:$}}}=n,K=ue=>{const{target:te}=ue.nativeEvent;if(te){d({type:Xr.CONTENT_BLOCK_CLICKED,entryId:A,contentBlockType:R,entryName:x,linkType:O.linkType,targetUrl:k,applyDescriptionByType:"IN_PAGE",advertId:y});const ce={event:"content_block_navigation",name:x,id:String(A),link_type:O.linkType,target:k};J.sendEvent({GA:ce,WA:null})}},Q=()=>B?s.jsx(cjt,{bold:!0,callToActionColor:L,"data-test":"content-block-in-page-cta",children:B}):null,X=i.formatMessage("contentBlocks.inPage.aside.aria.label");return W&&j&&$?s.jsx("aside",{"aria-label":X,children:s.jsxs(ijt,{as:_I,onClick:K,onKeyDown:()=>{},standalone:!0,backgroundColor:j,color:$,"data-test":"content-block-in-page",isExternalLink:N,target:O,href:k,children:[s.jsxs(ljt,{children:[s.jsx(iG,{asChild:!0,bold:!0,color:$,"data-test":"content-block-in-page-headline",children:s.jsx("h4",{children:W})}),w&&s.jsx(iG,{color:$,"data-test":"content-block-in-page-body",children:w})]}),Q()]})}):null};dk.propTypes=ajt;dk.defaultProps=djt;const ujt=e=>({contentBlocksCommonData:mN(e),contentBlocksInPage:njt(e),isContentBlockInPageEmpty:ojt(e),isBasketBeingEdited:Mr(e),isSEOReadableURLEnabled:rjt(e)}),pjt=ot({analyticsEvent:U.analyticsEvent,fetchContentBlocks:op.getContentBlocks}),mjt=ke(ujt,pjt)(dk),hjt=hN("IN_PAGE"),gjt=Kg("IN_PAGE"),Ejt=D("seo.rdbl"),lG=1*60*1e3,fjt=T.aside`
    display: ${({isInitiallyHidden:e})=>e?"none":"flex"};
    overflow: hidden;
    inline-size: 100%;
    transition:
        max-block-size 0.5s ease-in-out,
        padding 0.5s ease-in-out;

    &:hover {
        text-decoration: none;
    }

    ${({isComponentClosed:e})=>e?De`
                  max-block-size: 0;
              `:De`
                  max-block-size: 30vb;
              `}
`,yjt=T(se)`
    flex-grow: 1;
    justify-content: space-between;
    flex-wrap: nowrap;
    align-items: center;
    inline-size: 100%;
    gap: ${H(5)};
    padding-block: ${H(6)};
    padding-inline: ${H(8)};
    min-block-size: ${H(52)};
    background-color: ${({backgroundColor:e})=>e};
    color: ${({color:e})=>e};

    ${oe.lgUp`
        justify-content: center;
        padding: ${H(10)} ${H(8)};
        min-height: ${H(40)};
    `}
`,Ijt=T(se)`
    align-items: center;
    flex-wrap: nowrap;
    justify-content: space-between;
    margin: 0;
    inline-size: 100%;
    ${oe.lgUp`
        margin: 0 auto;
        inline-size: auto;
    `}
`,Sjt=T.div`
    display: inline;
`,cG=T(P)`
    display: inline;
    color: ${({color:e})=>e};
    font-size: var(--salt-text-m-font-size);
    padding-block: ${H(2)} 0;
    ${oe.lgUp`
        padding-block: 0;
    `}
`,Cjt=T(P)`
    display: inline;
    white-space: nowrap;
    color: ${({callToActionColor:e})=>e};
    text-decoration: underline;
    margin-inline: ${H(16)};
`,Tjt=D("cf.cb.ip.cl"),_jt=D("cf.cb.ip.clk"),vjt=()=>{const e=E(Tjt),t=E(_jt),n=M(),o=Ne(),[r,a]=h.useState(0),[i,l]=h.useState(vt()),c=F(),d=E(ge=>mN(ge)),u=E(ge=>hjt(ge));function m(ge){return typeof ge=="number"&&ge>0}let g;typeof window<"u"&&(g=localStorage.getItem(String(u?.id)));const f=g?JSON.parse(g):null,[y,I]=h.useState(g?Number(f.whenToReopen)-le():0),[S,C]=h.useState(!0);h.useEffect(()=>{C(!!f)},[]);const _=()=>{localStorage.removeItem(String(u.id)),I(0),C(!1),l(()=>{const ge=vt();return c(U.analyticsEvent({type:Xr.CONTENT_BLOCK_IMPRESSION,contentBlockImpression:{entryId:L,contentBlockType:W,entryName:B,advertId:ge}})),ge})},A=E(ge=>gjt(ge)),x=E(ge=>Mr(ge)),R=E(ge=>Ejt(ge)),O=async()=>c(op.getContentBlocks(R)),{lastUpdated:N,isFetching:k}=d,j=A||x;h.useEffect(()=>{j||l(()=>{const ge=vt();return c(U.analyticsEvent({type:Xr.CONTENT_BLOCK_IMPRESSION,contentBlockImpression:{entryId:L,contentBlockType:W,entryName:B,advertId:ge}})),ge})},[o.key]),h.useEffect(()=>{r<Mee&&!N&&!k&&O().then(()=>{a(0)}).catch(()=>{a(r+1)})},[r,N,k]);const w=h.useRef(null);if(h.useEffect(()=>()=>{w.current&&clearTimeout(w.current)},[]),h.useEffect(()=>{f&&(f.publishedVersion!==u.publishedVersion&&_(),m(y)?w.current=setTimeout(()=>{_()},y):m(y)||_())},[u.publishedVersion]),j)return null;const{id:L,name:B,type:W,target:$,isExternalLink:K,targetUrl:Q,publishedVersion:X,minutesToReappear:re,content:{solid:{backgroundSolidColor:ue,bodyText:te,callToActionColor:ce,callToActionText:de,headline:ye,textColor:Ae}}}=u,Je=ge=>{ge.preventDefault(),c(U.analyticsEvent({type:Xr.CONTENT_BLOCK_CLOSE_BUTTON_CLICKED,entryId:L,entryName:B,advertId:i}));const Oe=lG*re,Xe=le()+lG*re;localStorage.setItem(String(L),JSON.stringify({publishedVersion:X,whenToReopen:Xe})),I(Oe),w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{_()},Oe)},Ie=ge=>{const{target:Oe}=ge.nativeEvent;if(Oe){c(U.analyticsEvent({type:Xr.CONTENT_BLOCK_CLICKED,entryId:L,contentBlockType:W,entryName:B,linkType:$.linkType,targetUrl:Q,applyDescriptionByType:"IN_PAGE",advertId:i}));const Xe={event:"content_block_navigation",name:B,id:String(L),link_type:$.linkType,target:Q};J.sendEvent({GA:Xe,WA:null})}},je=()=>de?s.jsx(Cjt,{as:_I,onClick:Ie,standalone:!0,bold:!0,callToActionColor:ce,"data-test":"content-block-in-page-cta",isExternalLink:K,target:$,href:Q,children:de}):null,Le=n.formatMessage("contentBlocks.inPage.aside.aria.label"),Be=n.formatMessage("contentBlocks.inPage.aside.close.button"),be=t&&!S?{as:_I,onClick:Ie,isExternalLink:K,target:$,href:Q,onKeyDown:()=>{},standalone:!0}:{};return ye&&ue&&Ae?s.jsx(fjt,{"aria-label":Le,isComponentClosed:m(y),isInitiallyHidden:S,...be,children:s.jsxs(yjt,{backgroundColor:ue,color:Ae,"data-test":"content-block-in-page",children:[s.jsxs(Ijt,{children:[s.jsxs(Sjt,{children:[s.jsx(cG,{asChild:!0,bold:!0,color:Ae,"data-test":"content-block-in-page-headline",children:s.jsx("h4",{className:"salt-m-r--2",children:ye})}),te&&s.jsx(cG,{color:Ae,"data-test":"content-block-in-page-body",children:te})]}),je()]}),e&&s.jsxs(b,{intent:"tertiary-contrast",size:"s",fill:!1,"data-test":"content-block-close-button",onClick:Je,children:[s.jsx(Ee,{children:Be}),s.jsx(b.Icon,{name:"close_default"})]})]})}):null},jee=({isSegmentable:e})=>e?s.jsx(vjt,{}):s.jsx(mjt,{}),Ajt=T(al)`
    position: absolute;
    inset-block-start: calc(var(--salt-spacing-2) * -1);
    inset-inline-end: calc(var(--salt-spacing-2) * -1);
`,bjt=T.div`
    position: fixed;
    inset-block-start: 72%;
    inset-inline-end: 0;
    z-index: ${Qt["nav-button"]};
    transform: rotate(270deg);
    transform-origin: right bottom;
`,xjt=()=>{const{formatMessage:e}=M(),{loading:t,launchChat:n,unreadMessageCount:o}=lk();return s.jsxs(bjt,{children:[s.jsx(b,{intent:"primary",fill:!1,loading:t,onClick:n,children:s.jsx(b.Text,{children:e("settings.chat.launcher")})}),o>0&&s.jsx(Ajt,{"data-test":"ujet-message-count",intent:"promotion",count:o})]})},wee=()=>{const e=Ne(),[t]=fe(["ccai"]);return!E(Yy).find(a=>!!e.pathname.match(a))&&t?s.jsx(xjt,{}):null},dG=e=>{const{list:t,descriptionText:n,type:o,ariaDescribedBy:r}=e,a=M(),i=E(Jt);return t.length?s.jsxs(zs,{direction:"column",gap:["sm"],"data-test":`${o}-group`,children:[s.jsx(P,{"data-test":"list-description",children:n}),s.jsx(ve,{children:s.jsx(zs,{direction:"column",gap:["lg"],children:t.map(({description:l,promotionId:c,validityTime:d})=>{const u=d?Mp(a,d,i):{};return s.jsxs(zs,{direction:"column",gap:["xs"],"aria-describedby":r,"data-test":"list-item",children:[s.jsx(P,{children:l}),!!u?.label&&s.jsx(P,{size:"s","data-test":"list-expire-info",children:u.label})]},c)})})})]}):null},Rjt=e=>{const{data:t,name:n,ariaDescribedBy:o}=e,r=M(),a=E(Jt);if(!t.length)return null;const i=r.formatMessage("toggleablepromotions.modal.inclusive.promotions.description"),l=t.map(d=>{const u=Mp(r,d.validityTime,a);return{name:n,value:d.promotionId,label:d.description,additionalText:u.label}}),c=(d,u)=>{const{element:m}=d,g=Array.isArray(u.value)?u.value:[],f=String(m.value),y=m.checked?[...g,f]:g.filter(I=>I!==f);u.onChange(y)};return s.jsxs(se,{direction:"column",gap:["sm"],"data-test":"checkbox-group",children:[s.jsx(P,{"data-test":"checkbox-group-description",children:i}),s.jsx(ve,{children:s.jsx(HI,{name:n,defaultValue:[],render:({field:d})=>{const u=l.map(m=>({...m,checked:d.value?.includes(m.value)||!1}));return s.jsx(mt.CheckboxList,{groupLabel:i,onChange:m=>c(m,d),options:u,"aria-describedby":o})}})})]})},Djt=e=>{const{data:t,name:n,ariaDescribedBy:o}=e,r=M(),a=E(Jt);if(!(u=>u.some(({promotionId:m})=>m!==wl))(t))return null;const l=r.formatMessage("toggleablepromotions.modal.exclusive.promotions.description"),c=r.formatMessage("toggleablepromotions.modal.exclusive.promotions.none.option.text"),d=t.map(u=>{const m=Mp(r,u.validityTime,a);return{value:u.promotionId,label:u.promotionId===wl?c:u.description,additionalText:m.label}});return s.jsxs(se,{direction:"column",gap:["sm"],"data-test":"radio-group",children:[s.jsx(P,{"data-test":"radio-group-description",children:l}),s.jsx(ve,{children:s.jsx(HI,{name:n,render:({field:u})=>s.jsx(mt.RadioGroup,{groupLabel:{text:l,isVisuallyConcealed:!0},name:n,value:u.value??"",onChange:m=>u.onChange(m),radios:d,"aria-describedby":o})})})]})},Ojt=e=>{const{availablePromotions:t,ariaDescribedBy:n}=e;return s.jsx(ie.Fragment,{children:t.map(o=>o.promotions.length?o.limitPerOrder?o.limitPerOrder===1?s.jsx(Djt,{ariaDescribedBy:n,name:o.applicationGroupName,data:o.promotions},o.applicationGroupName):null:s.jsx(Rjt,{ariaDescribedBy:n,name:o.applicationGroupName,data:o.promotions},o.applicationGroupName):null)})},Pjt=e=>{const{availablePromotions:t,unavailablePromotions:n,preAppliedPromotions:o}=e;return!!(o.length||n.length||t.some(r=>r.promotions.length))},Njt=e=>{const{promotionFormData:t,title:n,id:o,description:r}=e,a=M();if(!t||!Pjt(t))return null;const i=a.formatMessage("toggleablepromotions.modal.preselected.promotions.description"),l=a.formatMessage("toggleablepromotions.modal.unavailable.promotions.description"),{availablePromotions:c,unavailablePromotions:d,preAppliedPromotions:u}=t;return s.jsxs(ie.Fragment,{children:[s.jsxs(zs,{direction:"column",gap:["xs"],className:"salt-m-t--4 salt-m-b--4",children:[s.jsx(P,{size:"l",bold:!0,"data-test":"section-title",children:n}),r&&s.jsx(P,{"data-test":"section-description",children:r})]}),s.jsxs(zs,{direction:"column",gap:["md"],"data-test":`section-group-${o.toLowerCase()}`,children:[s.jsx(Ojt,{availablePromotions:c,ariaDescribedBy:o}),s.jsx(dG,{type:"preselected",list:u,descriptionText:i,ariaDescribedBy:o}),s.jsx(dG,{type:"unavailable",list:d,descriptionText:l,ariaDescribedBy:o})]})]})},Ljt=D("m.la.h"),kjt=D("tp.no"),Mjt=({toggleablePromotionsFormData:e,headerLabelId:t,handleClose:n})=>{const o=M(),r=E(b7),a=Gn({defaultValues:r}),i=Ne(),l=E(Ljt),c=E(kjt),d=E(D7),u=E(O7),m=F();kMt();const g=async j=>{const w=Object.values(j).flat().filter(Boolean),L=d.map(Q=>({...Q,selected:w.includes(Q.promotionId)})),B=$K(L,u),W=d.every(Q=>{const X=L.find(re=>re.promotionId===Q.promotionId);return Q.selected===X?.selected}),$=c?L.concat(B):L;if(!$.length){n({userAction:Hc.SAVE,hasSelectionChange:!1,selectedPromotionId:[]});return}const{isSuccessful:K}=await m(w1e($));K&&(m(F1e()),n({userAction:Hc.SAVE,hasSelectionChange:!W,selectedPromotionId:L.filter(({selected:Q})=>Q).map(({promotionId:Q})=>Q)}))},f=o.formatMessage("toggleablepromotions.modal.description"),y=o.formatMessage("toggleablepromotions.modal.note"),I=o.formatMessage("toggleablepromotions.modal.alternative.description"),S=o.formatMessage("toggleablepromotions.modal.subtitle.general"),C=o.formatMessage("toggleablepromotions.modal.subtitle.delivery"),_=o.formatMessage("toggleablepromotions.modal.subtitle.loyalty"),A=o.formatMessage("toggleablepromotions.modal.button.cancel"),x=o.formatMessage("toggleablepromotions.modal.button.apply.changes"),R=o.formatMessage("toggleablepromotions.modal.title"),O=o.formatMessage("toggleablepromotions.modal.delivery.promotions.description"),N=o.formatMessage("toggleablepromotions.modal.loyalty.promotions.description"),k=[{key:"SAVING",title:S},{key:"DELIVERY",title:C,description:O},{key:"LOYALTY",title:_,description:N}];return s.jsxs(ie.Fragment,{children:[s.jsx(G.Header,{align:l?"left":"center",children:s.jsx(ne,{as:"h1",id:t,"data-test":t,children:R})}),s.jsx(G.Body,{className:"salt-p-y--4",children:s.jsx($n,{...a,children:s.jsxs("form",{onSubmit:a.handleSubmit(g),children:[s.jsxs(zs,{direction:"column",gap:["md"],children:[s.jsx(P,{"data-test":"promotion-form-description",children:i.pathname==="/"?I:f}),s.jsx(P,{"data-test":"promotion-form-note",className:"salt-m-b--2",children:y})]}),k.map(({key:j,title:w,description:L})=>s.jsx(Njt,{id:dn[j],title:w,promotionFormData:e[j],description:L},j))]})})}),s.jsxs(G.Footer,{children:[s.jsx(b,{className:"salt-m-r--2",intent:"secondary",fill:!0,"data-test":"cancel-discounts",onClick:()=>n({userAction:Hc.CANCEL,hasSelectionChange:!1}),children:s.jsx(b.Text,{children:A})}),s.jsx(b,{fill:!0,intent:"primary","data-test":"save-discounts-changes",onClick:a.handleSubmit(g),children:s.jsx(b.Text,{children:x})})]})]})},jjt=e=>typeof e=="object"&&Object.values(e).some(t=>(t.availablePromotions?.some(n=>n.promotions?.length>0)??!1)||t.unavailablePromotions?.length>0||t.preAppliedPromotions?.length>0),wjt=()=>{const e=E(Ue("discountOnOrder")),t=E(R7),n=F();if(!jjt(t))return null;const o="toggleable-promotions-v2-modal-header",r=({userAction:a,hasSelectionChange:i,selectedPromotionId:l})=>{n(wu({type:Io.ORDER_DISCOUNT_FORM_MODAL_CLOSED,description:"Modal for order promotions is closed",userAction:a,hasSelectionChange:i,selectedPromotionId:l})),n(Z.closeModal())};return s.jsx(G,{"data-test":"promotions-modal",isOpen:e,onRequestClose:()=>r({userAction:Hc.RETURN,hasSelectionChange:!1}),aria:{labelledby:o},maxWidth:"md",children:s.jsx(Mjt,{toggleablePromotionsFormData:t,headerLabelId:o,handleClose:r})})},Fee=Fd(`
    query GetFooter {
        footer {
            contactUs {
                __typename
                shouldBeOpenedInNewTab
                ... on StaticPageTarget {
                    staticPage
                }
                ... on WebAddressTarget {
                    url
                }
            }
            columns {
                title
                links {
                    text
                    target {
                        __typename
                        shouldBeOpenedInNewTab
                        ... on StaticPageTarget {
                            staticPage
                        }
                        ... on WebAddressTarget {
                            url
                        }
                    }
                }
            }
            socialMedia {
                serviceId
                profileUrl
                tooltip
            }
            legalText {
                firstItem {
                    id
                    name
                    richText
                }
                secondItem {
                    id
                    name
                    richText
                }
            }
        }
    }
`),Fjt=(e=[])=>e.flatMap(t=>{if(!t)return[];const n=La.normalizeToLegacyTarget(t.target);return{text:t.text,...n}}),Bjt=e=>e?e.flatMap(t=>t?{title:t.title,links:Fjt(t.links)}:[]):[],Ujt=e=>e?e.filter(t=>!!t):[],Gjt=e=>e?{firstItem:e.firstItem,secondItem:e.secondItem}:null,$jt=({contactUs:e,columns:t,socialMedia:n,legalText:o})=>({contactLink:e?La.normalizeToLegacyTarget(e):{},sections:Bjt(t),socialMedia:Ujt(n),legalText:Gjt(o)}),Hjt=({links:e})=>({contactLink:e.contact,sections:e.sections,socialMedia:e.social,legalText:e.legalText}),Vjt=()=>{const[e=!1]=fe(["cf.ft.flx"]),[{data:t}]=GI({query:Fee}),n=E(({data:r})=>r.content.footer);return{isFetching:!1,footer:e?$jt(t?.footer??{}):Hjt(n??{})}},Yjt=()=>"/cookie-policy",Wjt=({contactLink:{value:e,linkType:t,openInNewTab:n}})=>{const o=M(),r=E(d=>aC(d)&&!!d.retailerSettings["cookies-onetrust-domain"]),a=QO(t,e),i=n?"_blank":void 0,l=n?s.jsx(Ee,{children:`(${o.formatMessage("accessibility.link.open.in.new.window")})`}):null,c=t===Dt.ABSOLUTE_WEB_ADDRESS||t===Dt.WEB_ADDRESS?rt:Qe;return e&&t?s.jsxs(In.Leading,{children:[t&&a&&s.jsx(b,{intent:"secondary",size:"s",fill:!1,asChild:!0,className:"salt-m-x--1",children:s.jsx(c,{intent:"ghost","data-test":"footer-contact-link",href:a,...i&&{target:i},children:s.jsxs(b.Text,{children:[o.formatMessage("footer.contact"),l&&l]})})}),r&&s.jsx(b,{intent:"secondary",size:"s",fill:!1,asChild:!0,className:"salt-m-x--1",children:s.jsx(Qe,{href:Yjt(),role:"link",intent:"ghost",children:s.jsx(b.Text,{children:o.formatMessage("footer.cookie.policy")})})})]}):null},qjt={mhra:p.node,retailerName:p.string,socialMedia:p.arrayOf(p.shape({serviceId:p.string.isRequired,profileUrl:p.string.isRequired,tooltip:p.string.isRequired})).isRequired};function Kjt(e,t){const n=e.serviceId.toLowerCase();return s.jsx("div",{className:"salt-m-l--2 salt-d--inline-block",children:s.jsxs(rt,{href:e.profileUrl,target:"_blank",children:[s.jsx(Ee,{children:e.tooltip}),s.jsx(me,{name:n,title:e.tooltip,height:20,width:20,"aria-hidden":"true"})]})},t)}const uk=({mhra:e,retailerName:t,socialMedia:n})=>{const r=M().formatMessage("footer.copyright",{name:t});return s.jsxs(In.Supplementary,{"data-test":"footer-supplementary",children:[s.jsxs(In.Row,{children:[r.trim()!==""&&s.jsxs(P,{className:"salt-m-r--4",children:["© ",r]}),s.jsx("div",{className:"salt-d--inline-block",children:n.map((a,i)=>Kjt(a,i))})]}),e&&s.jsx(Kt,{breakpoint:"lg-up",children:s.jsx(In.Row,{children:s.jsx(In.Image,{right:!0,children:e})})})]})};uk.defaultProps={mhra:null,retailerName:void 0};uk.propTypes=qjt;const Bee=()=>{const e=F(),t=h.useCallback(o=>{e({type:Py.FOOTER_LEGAL_TEXT_LINK_CLICKED,payload:o})},[e]),n=h.useCallback(()=>{e({type:Py.FOOTER_LEGAL_TEXT_IMPRESSION})},[e]);return{reportFooterLegalTextLinkClicked:t,reportFooterLegalTextImpression:n}},zjt=T.a`
    color: var(--intent-default);
`,Qjt=({node:e,children:t})=>{const n=Bee(),o=M(),r=()=>{n.reportFooterLegalTextLinkClicked({LINK_VALUE:e.data.uri})};return s.jsxs(zjt,{href:e.data.uri,target:"_blank",onClick:r,children:[t,s.jsx(Ee,{children:`(${o.formatMessage("accessibility.link.open.in.new.window")})`})]})},Xjt=()=>({renderNode:{[un.BLOCKS.HEADING_1]:(e,t)=>s.jsx(ne,{as:"h2",children:t}),[un.BLOCKS.HEADING_2]:(e,t)=>s.jsx(ne,{as:"h2",children:t}),[un.BLOCKS.PARAGRAPH]:(e,t)=>s.jsx(P,{size:"s",className:"salt-d--block salt-m-y--1",children:t}),[un.INLINES.HYPERLINK]:(e,t)=>s.jsx(Qjt,{node:e,children:t})}}),Uee=({data:e})=>{const t=h.useMemo(()=>Xjt(),[e]),n=h.useMemo(()=>Object.values(e).map(a=>({...a,richText:$I.documentToReactComponents(JSON.parse(a.richText),t)})),[e]),o=Bee(),r=Kd(()=>{o.reportFooterLegalTextImpression()});return s.jsx("div",{ref:r,children:s.jsx(Y,{"data-test":"legal-text",flush:!0,children:n.map((a,i)=>{const l=i*6+1;return s.jsx(Y.Item,{colStart:{md:l},colSpan:{xs:12,sm:6},children:a.richText},a.id)})})})},Zjt=D("cf.ft.flx"),Gee=e=>{const{linkType:t,value:n}=e,o={openInNewTab:e.openInNewTab,text:e.text,url:QO(t,n),type:t},r=o.openInNewTab?"_blank":void 0;return[Dt.ABSOLUTE_WEB_ADDRESS,Dt.WEB_ADDRESS].includes(o.type)?s.jsx(rt,{...r?{target:"_blank"}:{},href:o.url,children:o.text}):s.jsx(Qe,{...r?{target:"_blank"}:{},to:o.url,children:o.text})},Jjt=e=>e.map(t=>{const n=t.links.map(o=>s.jsx(Ve.Item,{"data-test":"footer-page-link",children:Gee(o)},o.text));return s.jsxs(In.List,{className:"salt-p-r--2",children:[s.jsx("div",{className:"salt-m-b--2",children:s.jsx(P,{bold:!0,asChild:!0,"data-test":"footer-links-column",children:s.jsx("h2",{children:t.title})})}),s.jsx(Ve,{children:n})]},t.title)}),ewt=(e,t)=>{const n=t.formatMessage("mhra.alternative");return e.companyId&&s.jsxs(rt,{href:`${e.baseUrl}${e.companyId}`,children:[s.jsx(Ee,{children:s.jsx(P,{children:n})}),s.jsx(me,{name:"mhra",title:n,height:93,width:112,"aria-hidden":"true"})]})},twt=(e,t)=>{const n=s.jsx(is.Title,{active:!0,children:t.formatMessage("footer.legal.accordion.section")}),o=s.jsx(is.Content,{active:!0,children:s.jsx(Uee,{data:e})});return[n,o]},swt=({sections:e,legalText:t,intl:n})=>{const o=a=>s.jsx(Ve,{children:a.map(i=>s.jsx(Ve.Item,{children:Gee(i)},i.text))}),r=e.map(a=>{const i=s.jsx(is.Title,{active:!1,children:a.title},a.title),l=s.jsx(is.Content,{active:!1,children:o(a.links)});return[i,l]});return t&&r.push(twt(t,n)),s.jsx(is,{children:r})},nwt=()=>{const e=M(),{footer:t}=Vjt(),{sections:n,contactLink:o,socialMedia:r,legalText:a}=t,i=F(),l=E(g=>({baseUrl:qe(g,"mhra-base-url"),companyId:qe(g,"mhra-company-id")})),{lastUpdated:c}=E(a5e),d=E(Zjt),u=E(_ce),m=ewt(l,e);return h.useEffect(()=>{!c&&!d&&i(H3())},[]),s.jsxs(In,{id:"footer",children:[s.jsx(Wjt,{contactLink:o}),s.jsxs(In.Body,{children:[s.jsx(In.Visible,{breakpoint:"sm-up",children:s.jsxs("div",{className:"salt-d--flex",children:[Jjt(n),l.companyId&&s.jsx(In.Image,{children:s.jsx(In.Visible,{breakpoint:"lg-up",children:m})})]})}),a&&s.jsx(In.Visible,{breakpoint:"sm-up",className:"salt-m-t--4",children:s.jsx(Uee,{data:a})}),s.jsx(Kt,{breakpoint:"sm-up",children:swt({sections:n,legalText:a,intl:e})})]}),s.jsx(uk,{mhra:m,socialMedia:r,retailerName:u.name})]})},vI=42,owt=T.div`
    display: flex;
    place-content: center center;
    inline-size: 100%;
    background-color: var(--top-tabs-background-color, var(--intent-secondary-100));
`,rwt=T.div`
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    overflow: hidden;
    flex: 1;
    padding: 0;
    margin: 0;
    block-size: ${H(vI)};
`,awt=T.nav`
    position: relative;
    display: block;
    block-size: ${H(vI)};
    z-index: ${Qt["top-tabs"]};

    &::before {
        content: ' ';
        block-size: ${H(1)};
        background: var(--top-tabs-border-color, var(--intent-secondary));
        position: absolute;
        inset-block-end: 0;
        inset-inline-start: 0;
        inline-size: 100%;
    }
`,iwt=De`
    display: inline-flex;
    align-items: center;
    position: relative;
    white-space: nowrap;
    text-decoration: none;
    flex-wrap: nowrap;
    min-block-size: ${H(vI)};
    max-block-size: ${H(vI)};
    padding-block: var(--salt-spacing-1);
    padding-inline: var(--salt-spacing-4);
    color: var(--intent-content);
    inline-size: 100%;
    outline-offset: -${H(5)};

    &::before {
        content: ' ';
        block-size: var(--salt-spacing-05);
        background: ${({active:e})=>e&&"var(--intent-primary-900)"};
        position: absolute;
        inset-block-end: 0;
        inset-inline-start: 0;
        inline-size: 100%;
    }

    &:hover {
        cursor: pointer;
    }

    &:hover::before {
        background: ${({active:e})=>!e&&"var(--intent-primary-300)"};
    }

    &:active::before {
        background: var(--intent-primary-900);
    }
`,$ee=T(P)`
    overflow: hidden;
    text-overflow: ellipsis;
    word-break: break-all;
    white-space: nowrap;
    text-align: ${({textAlign:e})=>e??"center"};

    &::after {
        display: block;
        content: '${({children:e})=>Mre(e)}';
        font-weight: bold;
        block-size: 0;
        overflow: hidden;
        visibility: hidden;
    }
`,Hee=T.img`
    margin-inline-end: ${({labelHidden:e})=>e?0:"var(--salt-spacing-1)"};
    block-size: ${H(18)};
    inline-size: ${H(18)};
`,Vee=h.forwardRef(({to:e,href:t,children:n,intent:o,...r},a)=>{const{bold:i,...l}=r;return e?s.jsx(Qe,{ref:a,to:e,...o==="ghost"?l:r,children:n}):s.jsx(rt,{ref:a,href:t,...o==="ghost"?l:r,children:n})}),lwt=T.div`
    overflow: hidden;
`,cwt=T(Vee).withConfig({shouldForwardProp:e=>!["active","fullWidth"].includes(e)})`
    ${iwt};
`,dwt=h.forwardRef((e,t)=>{const{active:n,iconUrl:o,label:r,labelHidden:a=!1,title:i,link:l}=e;return s.jsx(lwt,{ref:t,children:s.jsxs(cwt,{active:n,"aria-current":n?"page":void 0,...l,children:[o&&s.jsx(Hee,{src:o,alt:a?r:"",labelHidden:a}),i&&s.jsx($ee,{bold:n,children:i})]})})}),Xc={Header:owt,ImageIcon:Hee,Link:Vee,LinkTab:dwt,List:rwt,Navigation:awt,TabText:$ee},uwt=T(Xc.Link)`
    outline-offset: -${H(9)};
    display: flex;
`,Yee=({dispatchAnalyticsEvent:e,iconUrl:t,id:n,isExternalLink:o,isInDropdown:r,isMatchingCurrentURL:a,label:i,labelHidden:l,openInNewTab:c,tabRef:d,tabOffScreen:u,targetURL:m,linkType:g,closeDropdown:f})=>{const y=F(),I=t&&s.jsx(Xc.ImageIcon,{src:t,alt:l?i:"",labelHidden:l}),S=_=>{if(e({isInDropdown:r}),r&&f(),o){const A=new URL(m);A.searchParams.get("confirmRedirect")&&(_.preventDefault(),A.searchParams.delete("confirmRedirect"),y(Z.openModal("changeStore",{redirectUrl:A.href})))}};let C={href:m,onClick:S,target:c?"_blank":void 0};if(!o&&!V3(g)){const _=nn(m),A=tt.parse(_.search??"");C={onClick:S,target:c?"_blank":void 0,to:{..._,search:`?${tt.stringify({...A,source:"toptabs"})}`}}}if(r){const _=s.jsxs(h.Fragment,{children:[I,l?void 0:s.jsx(Xc.TabText,{bold:a,textAlign:"start",children:i})]});return s.jsx(Vn.Item,{selected:a,role:"none presentation",children:s.jsx(uwt,{...C,children:_})},n)}return s.jsx(Xc.LinkTab,{active:a,ref:d,title:l?void 0:i,label:i,iconUrl:t??void 0,link:{...C,tabIndex:u?-1:void 0}},n)},pwt=T(Ot.Container)`
    position: static;
    display: flex;
    align-items: center;
    visibility: ${({transparent:e})=>e?"hidden":"initial"};

    ${oe.smUp`
        position: relative;
    `};
`,mwt=T(Ot.Body)`
    z-index: ${Qt["top-tabs"]};
    inset-block-start: ${H(Ny)};
    inset-inline: var(--salt-spacing-2);
    inline-size: auto;
    min-inline-size: auto;

    ${oe.smUp`
        inset-inline-start: initial;
    `};
`,hwt=T(Ot.Content)`
    padding: 0;
    overflow: hidden auto;

    &::-webkit-scrollbar {
        appearance: none;
    }

    &::-webkit-scrollbar-thumb {
        border-radius: ${H(100)};
        border: ${H(2)} solid var(--intent-contrast);
        background-color: var(--intent-secondary-900);
    }

    ${oe.smUp`
        max-inline-size: ${H(400)};
        min-inline-size: ${H(100)};
    `};
`;class gwt extends h.Component{dropdownEl;dropdownContainer;formattedMessages;constructor(t){super(t),this.state={isOpen:!1,previouslyOpened:!1},this.formattedMessages={dropdownButton:t.intl.formatMessage("top.tabs.dropdown.button.label")??""},this.toggle=this.toggle.bind(this),this.close=this.close.bind(this),this.reset=this.reset.bind(this),this.handleClickOutside=this.handleClickOutside.bind(this),this.handleKeyPress=this.handleKeyPress.bind(this),this.dropdownEl=ie.createRef(),this.dropdownContainer=ie.createRef()}shouldComponentUpdate(t,n){const o=this.props.tabs.length!==t.tabs.length,r=n.isOpen!==this.state.isOpen;return o||r}componentDidUpdate(){this.props.tabs.length===0&&this.close()}componentWillUnmount(){window.removeEventListener("mousedown",this.handleClickOutside),window.removeEventListener("keydown",this.handleKeyPress)}toggle(){this.setState(t=>{const n=!t.isOpen;return n?(window.addEventListener("mousedown",this.handleClickOutside),window.addEventListener("keydown",this.handleKeyPress),this.props.dispatchDropdownOpenAnalytics(),t.previouslyOpened===!1&&this.props.dispatchTabImpressions({isInDropdown:!0})):(window.removeEventListener("mousedown",this.handleClickOutside),window.removeEventListener("keydown",this.handleKeyPress)),{isOpen:n,previouslyOpened:!0}})}close(){window.removeEventListener("mousedown",this.handleClickOutside),window.removeEventListener("keydown",this.handleKeyPress),this.setState(()=>({isOpen:!1}))}reset(){window.removeEventListener("mousedown",this.handleClickOutside),window.removeEventListener("keydown",this.handleKeyPress),this.setState(()=>({isOpen:!1,previouslyOpened:!1}))}handleClickOutside(t){const n=this.dropdownEl&&this.dropdownEl.current&&t.target instanceof HTMLElement&&!this.dropdownEl.current.contains(t.target),o=this.dropdownContainer&&this.dropdownContainer.current&&t.target instanceof HTMLElement&&!this.dropdownContainer.current.contains(t.target);n&&o&&this.close()}handleKeyPress(t){t.key==="Escape"&&this.close()}render(){const{tabs:t}=this.props,{isOpen:n}=this.state,o=t.length===0;let r={},a={},i={};return o||(r={"aria-haspopup":"true","aria-controls":"top-tabs-menu","aria-expanded":n,"aria-label":this.formattedMessages.dropdownButton},a={onClick:this.toggle},i={"aria-labelledby":"top-tabs-dropdown-button"}),s.jsxs(pwt,{transparent:o,ref:this.dropdownContainer,"data-test":"top-tabs-dropdown-container",children:[s.jsx(Ot.TriggerSaltButton,{size:"s",intent:"secondary",className:"salt-m-r--2",id:"top-tabs-dropdown-button","data-test":"top-tabs-dropdown-button",isOpen:n,disabled:o,...a,...r}),s.jsx(mwt,{align:"right",isOpen:n,ref:this.dropdownEl,fill:!0,children:s.jsx(hwt,{children:s.jsx(Vn,{id:"top-tabs-menu",...i,children:t.map(l=>s.jsx(Yee,{...l,closeDropdown:this.close,isInDropdown:!0},l.id))})})})]})}}const Ewt=Bt(gwt,{forwardRef:!0}),fwt=()=>({isFetching:!1,...E(({data:t})=>t.content.topTabs)}),ywt=()=>{const e=F(),t=h.useCallback(r=>{e({type:si.TOP_TAB_IMPRESSION,payload:r})},[e]),n=h.useCallback(()=>{e({type:si.TOP_TAB_DROPDOWN_OPENED,payload:{description:"The dropdown in the top tabs bar was opened"}})},[e]),o=h.useCallback(r=>{e({type:si.TOP_TAB_CLICKED,payload:r})},[e]);return{reportTopTabImpression:t,reportDropdownOpen:n,reportTopTabClicked:o}},Iwt=()=>{const[e,t]=h.useState(),n=h.useRef(e);return[n,r=>{n.current=r,t(r)}]},Swt=D("seo.rdbl"),Cwt=()=>{const[e,t]=Iwt(),n=F(),o=fwt(),r=h.useRef(),a=h.useRef(null),i=[],l=ywt(),c=Ne(),d=E(Swt),u=M();let m=null,g=null;h.useEffect(()=>(!o.isFetching&&!o.lastUpdated&&n(W3()),S(),()=>{I()}),[]),h.useEffect(()=>{f()?.reset(),I(),S()},[c.pathname]);const f=()=>r.current||null,y=()=>!!f(),I=()=>{m&&m.disconnect(),g&&g.disconnect()},S=()=>{if(!a.current)return;const j={root:a.current,rootMargin:"1px",threshold:1};m=new IntersectionObserver(A,j),g=new IntersectionObserver(x,{rootMargin:"1px",threshold:0}),g.observe(a.current),i.forEach(w=>w.current&&m?.observe(w.current))},C=({isInDropdown:j})=>{const w=TA.tabsAnalyticsTransformer({isInDropdown:j,numberOfVisibleTabs:e.current,tabs:o.data}),L={ecommType:"enhanced",event:"event",eventAction:"TOP_TAB_IMPRESSION",eventCategory:"E-commerce",ecommerce:{promoView:{promotions:w.map(B=>({promotionType:"Top Tab",id:B.id,name:B.label,creative:null,position:B.positionSeen,topTabIsInDropdown:B.isInDropdown}))}}};return J.sendEvent({GA:L,WA:null}),l.reportTopTabImpression({links:w})},_=()=>{const j={event:"event",eventAction:"TopTabDropdownOpened",eventCategory:"Top Tabs",eventLabel:"Not Set"};J.sendEvent({GA:j,WA:null}),l.reportDropdownOpen()},A=j=>{const w=e.current===void 0,L=e.current||0,B=j.reduce((W,$)=>$.intersectionRatio===1?W+1:w?W:W-1,L);t(B),w&&C({isInDropdown:!1})},x=j=>{const w=j.length>0&&j[0]&&j[0].boundingClientRect.bottom<0;y()&&w&&f()?.close()},R=()=>{const j=o.data,{pathname:w,search:L}=c,B=w+L,W=j.map(X=>{if(X.default)return B===pn();if(!X.isExternalLink){const re=TA.extractUniqueIdentifierFromURL(B,X.target.linkType,d);return re?X.encodedTargetValue.replace("?type=componentized","")===re.toLowerCase():!1}return typeof window<"u"?X.encodedTargetValue===window.location.href.toLowerCase():!1}),$=!W.some(X=>X),K=j.map((X,re)=>{const{isExternalLink:ue,targetURL:te,label:ce,target:{openInNewTab:de,linkType:ye},id:Ae,iconUrl:Je,labelHidden:Ie}=X,je=ie.createRef(),Le=re+1,Be=({isInDropdown:he})=>{const ge={event:"select_tab",name:ce,id:Ae,index:Le,location:he?"in-drop-down":"not-in-drop-down",target:te};J.sendEvent({GA:ge,WA:null});const Oe={ecommType:"enhanced",event:"event",eventAction:"TOP_TAB_CLICKED",eventCategory:"E-commerce",ecommerce:{promoClick:{promotions:[{creative:null,id:Ae,name:ce,position:Le,promotionType:"Top Tab",topTabIsInDropdown:he}]}}};return J.sendEvent({GA:Oe,WA:null}),l.reportTopTabClicked({id:Ae,label:ce,tabPosition:Le,isInDropdown:he,targetURL:te})},be={isExternalLink:ue,targetURL:te,id:Ae,isMatchingCurrentURL:W[re]||$&&X.default,openInNewTab:de,label:ce,labelHidden:Ie,iconUrl:Je,tabRef:je,linkType:ye,dispatchAnalyticsEvent:Be,tabOffScreen:!!e.current&&Le>e.current,closeDropdown:()=>{}};return i[re]=je,be});return{visibleTabsComponents:K.map(X=>s.jsx(Yee,{...X},X.id)),dropdownTabsComponents:e?K.slice(e.current):[]}},O=o.data.length,{visibleTabsComponents:N,dropdownTabsComponents:k}=R();return O>0?s.jsx(Xc.Navigation,{id:"top-tabs","data-test":"top-tabs","aria-label":u.formatMessage("accessibility.top-tabs.label"),children:s.jsxs(Xc.Header,{children:[s.jsx(Xc.List,{ref:a,children:N}),s.jsx(Ewt,{ref:r,tabs:k,dispatchTabImpressions:C,dispatchDropdownOpenAnalytics:_})]})}):null},Twt=D("m.la.h"),uG="login-promt-modal-header",_wt=()=>{const e=Ne(),t=F(),n=E(Ue("loginPrompt")),o=E(Twt),r=E(zae);h.useEffect(()=>{n&&t(U.analyticsEvent({type:on.LOGIN_REGISTER_MODAL_DISPLAYED}))},[n]);const a=()=>{t(U.analyticsEvent({type:on.LOGIN_REGISTER_MODAL_CLICKED,buttonClickedText:"CLOSE",buttonLocation:1}))},i=()=>{t(U.analyticsEvent({type:on.LOGIN_REGISTER_MODAL_CLICKED,buttonClickedText:"X"}))},l=()=>{t(U.analyticsEvent({type:on.LOGIN_REGISTER_MODAL_CLICKED,buttonClickedText:"LOG IN / REGISTER",buttonLocation:2}))},c=()=>{a(),t(Z.closeModal())},d=()=>{i(),t(Z.closeModal())},u=`${e.pathname}${e.search}`,m=`destination=${encodeURIComponent(u)}`,g=Fr({queryString:m}),f=r?VD():g;return s.jsxs(G,{isOpen:n,onRequestClose:d,aria:{labelledby:uG},children:[s.jsx(G.Header,{align:o?"left":"center",children:s.jsx(ne,{as:"h2",id:uG,children:s.jsx(v,{id:"basket.add.availability.reminder.modal.title"})})}),s.jsx(G.Body,{children:s.jsxs(P,{children:[s.jsx(v,{id:"basket.add.availability.reminder"})," ",s.jsx(v,{id:"basket.add.availability.reminder.login.or.register"})]})}),s.jsx(G.Footer,{align:o?"left":"center",children:s.jsxs(Y,{children:[s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{intent:"secondary",fill:!0,"data-test":"login-prompt-modal-cancel-button",onClick:c,children:s.jsx(v,{id:"basket.add.availability.reminder.modal.cancel"})})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{intent:"primary",fill:!0,asChild:!0,role:"link",className:"salt-m-t--4 md:salt-m--0","data-test":"login-prompt-modal-login-register-button",onClick:l,children:s.jsx(rt,{intent:"ghost",href:f,children:s.jsx(b.Text,{children:s.jsx(v,{id:"basket.add.availability.reminder.modal.button"})})})})})]})})]})},vwt=()=>{const e=F(),t=E(lmt),n=eo(),o=E(j7),r=E(ir);return h.useCallback(async()=>{let a=null;try{a=(await e(Ci({products:o?.map(({productId:u})=>({id:u}))||[],ignoreProductCache:!0})))?.payload?.product??null}catch{a=null}const i={...r,...a},l=o?.map(d=>({...i?.[d.productId],...d}));n({type:Te.MERGE_BASKET_CONFLICT,product:l});const c=q1e(l);J.sendEvent({GA:c,WA:null}),t&&l?.length&&n({type:Te.UNAVAILABLE_PRODUCTS,unavailableProducts:l?.map(d=>({PRODUCT_ID:d.productId,RETAILER_PRODUCT_ID:d?.retailerProductId,UNAVAILABLE_REASON:d.reason,QUANTITY_UNAVAILABLE:d.requestedAmount-d.addedAmount,PAGE_EVENT_ID:t}))})},[n,e,o,r,t])},Awt=()=>{const e=F(),t=eo(),n=pl();return h.useCallback(()=>{t({type:Te.UNAVAILABLE_ITEMS_MODAL_DISPLAYED,description:M7,pageEventAttributes:{userAction:"Close"}}),n(),e(vr.clearMergeResult())},[t,n,e])},bwt=()=>{const e=We(),t=F(),n=eo(),o=E(imt),r=pl();return h.useCallback(()=>{n({type:Te.UNAVAILABLE_ITEMS_MODAL_DISPLAYED,description:M7,pageEventAttributes:{userAction:"Continue"}}),o&&e(o),r(),t(vr.clearMergeResult())},[n,r,t,e,o])},xwt=()=>{const{formatMessage:e}=M(),t=Hg(fT),n=$g(),o=vwt(),r=Awt(),a=bwt();return s.jsxs(G,{isOpen:t,onAfterOpen:o,onRequestClose:r,aria:{labelledby:xB},children:[s.jsx(G.Header,{align:n?"left":"center",children:s.jsx(ne,{as:"h2",id:xB,children:e("basket.merge.conflict.modal.heading")})}),s.jsxs(G.Body,{children:[s.jsx(Ce,{className:"salt-m-b--4",intent:"error",text:e("basket.merge.conflict.modal.alert"),showIcon:!1}),s.jsx(w7,{})]}),s.jsx(G.Footer,{align:n?"left":"center",children:s.jsx(b,{intent:"primary",onClick:a,fill:!0,children:s.jsx(b.Text,{children:e("basket.merge.conflict.modal.ok")})})})]})},VT=()=>e=>e(wVe()).catch(()=>{}),Wee=e=>(t,n)=>{const{chatId:o}=n().data.recipes.chat.data;return o?t(UVe(o,Bu(e))).catch(()=>{}):null},Rwt=()=>(e,t)=>{const{chatId:n}=t().data.recipes.chat.data;return n?e(GVe(n)).catch(()=>{}):null},Dwt=T.div`
    padding: var(--salt-spacing-4);
    background: var(--intent-secondary-100);
`,Owt=({minimiseChat:e})=>{const t=ho(),n=ts(),{formatMessage:o}=M(),r=()=>{t(yO(!0)),n({type:dR,BUTTON_PLACEMENT:"TOP_BAR"})};return s.jsx(Dwt,{children:s.jsxs(zs,{justify:"space-between",children:[s.jsxs(zs,{align:"center",children:[s.jsx("div",{className:"salt-m-r--2","aria-hidden":"true",children:s.jsx(me,{name:"recipes"})}),s.jsx(P,{asChild:!0,size:"l",bold:!0,children:s.jsx("h2",{children:o("recipes.chat.recipeAssistant")})})]}),s.jsxs(zs,{align:"center",wrap:"nowrap",children:[s.jsxs(b,{intent:"secondary",type:"button",onClick:r,className:"salt-m-r--2",children:[s.jsx(b.Icon,{name:"refresh"}),s.jsx(Ee,{children:o("recipes.chat.header.refresh")})]}),s.jsxs(b,{intent:"secondary",onClick:e,className:"salt-m-r--2",children:[s.jsx(b.Icon,{name:"minus"}),s.jsx(Ee,{children:o("recipes.chat.header.minimise")})]})]})]})})},Pwt=T.div`
    display: flex;
    flex-direction: ${({$messageRole:e})=>e===qn.ASSISTANT?"row":"row-reverse"};
    align-items: center;
    gap: var(--salt-spacing-1);
`,Nwt=T.div`
    display: flex;
    align-items: center;
    justify-content: center;
    white-space: pre-wrap;
    padding: var(--salt-spacing-2);
    background: ${({$messageRole:e})=>e===qn.ASSISTANT?"var(--intent-primary-100)":"var(--intent-secondary-900)"};
    ${({$loading:e})=>e?`
                width: 67px;
                height: 30px;
            `:""}
    ${({$align:e})=>e==="left"?De`
                  border-radius: 16px;
                  border-end-start-radius: 0;
                  margin-inline-end: var(--salt-spacing-4);
              `:De`
                  border-radius: 16px;
                  border-end-end-radius: 0;
                  text-align: end;
                  margin-inline-start: var(--salt-spacing-4);
              `};
`,Lwt=T.div`
    display: flex;
    align-items: center;
    gap: var(--salt-spacing-1);
`,Dv=T.div`
    animation: 2s loading 0s infinite step-end;
    background: var(--intent-content-200);
    border-radius: 50%;
    inline-size: 6px;
    block-size: 6px;

    @keyframes loading {
        0% {
            background: var(--intent-contrast);
            inline-size: 8px;
            block-size: 8px;
        }

        33% {
            background: var(--intent-content-200);
            inline-size: 6px;
            block-size: 6px;
        }

        100% {
            background: var(--intent-content-200);
            inline-size: 6px;
            block-size: 6px;
        }
    }
`,kwt=()=>{const{formatMessage:e}=M();return s.jsxs(Lwt,{role:"status","aria-label":e("recipes.chat.speechBubble.loadingIndicator"),children:[s.jsx(Dv,{}),s.jsx(Dv,{style:{animationDelay:"0.66s"}}),s.jsx(Dv,{style:{animationDelay:"1.32s"}})]})},Mi=({messageRole:e=qn.ASSISTANT,align:t=e===qn.ASSISTANT?"left":"right",children:n,loading:o,error:r})=>s.jsxs(Pwt,{"data-test":"recipe-chat-message",$messageRole:e,"aria-busy":o,children:[r&&s.jsx(me,{name:"info_default",warning:!0}),s.jsx(Nwt,{$align:t,$messageRole:e,$loading:o,children:o?s.jsx(kwt,{}):n})]}),Tu=T.div.attrs({className:"salt-m-t--1"})`
    display: flex;
    align-items: center;
    justify-content: ${({$alignToRight:e})=>e?"end":"start"};
    gap: var(--salt-spacing-2);
`,Oc=({children:e,onClick:t})=>s.jsx(b,{intent:"secondary",size:"s",onClick:t,children:e}),Ov=({errorType:e,children:t})=>{const n=ho(),o=$e(kC),r=ts();h.useEffect(()=>{r({type:_V,CHAT_ID:o})},[]);const a=c=>{n(Wee(c)),r({type:vV})},i=()=>{n(yO(!0)),r({type:dR,BUTTON_PLACEMENT:"IN_CHAT"})},{formatMessage:l}=M();switch(e){case"GET_CHAT_HISTORY_ERROR":return s.jsxs("div",{children:[s.jsx(Mi,{messageRole:qn.ASSISTANT,error:!0,children:l("recipes.chat.error.historyLoadError")}),s.jsx(Tu,{children:s.jsx(Oc,{onClick:()=>n(i),children:l("recipes.chat.error.restartButton")})})]});case"SEND_MESSAGE_ERROR_FATAL":return s.jsxs("div",{children:[s.jsx(Mi,{messageRole:qn.ASSISTANT,error:!0,children:l("recipes.chat.error.failedToRespond")}),s.jsx(Tu,{children:s.jsx(Oc,{onClick:()=>n(i),children:l("recipes.chat.error.restartButton")})})]});case"CREATE_CHAT_ERROR":return s.jsxs("div",{children:[s.jsx(Mi,{messageRole:qn.ASSISTANT,error:!0,children:l("recipes.chat.error.failedToRespond")}),s.jsx(Tu,{children:s.jsx(Oc,{onClick:()=>n(i),children:l("recipes.chat.error.restartButton")})})]});case"SEND_MESSAGE_ERROR_RETRY":return s.jsxs("div",{children:[s.jsx(Mi,{messageRole:qn.ASSISTANT,error:!0,children:l("recipes.chat.error.retryOrRestart")}),s.jsx(Tu,{children:s.jsx(Oc,{onClick:()=>n(i),children:l("recipes.chat.error.restartButton")})})]});case"SEND_MESSAGE_ERROR":return s.jsxs("div",{children:[s.jsx(Mi,{messageRole:qn.USER,error:!0,children:t}),s.jsxs(Tu,{$alignToRight:!0,children:[l("recipes.chat.error.failedToSend"),s.jsx(Oc,{onClick:()=>a(t),children:l("recipes.chat.error.retryButton")})]})]});default:return null}},Mwt=T.div`
    display: flex;
    flex-direction: column;
    gap: var(--salt-spacing-2);
`,jwt=({message:{message:e,role:t,results:n},chatId:o,sequence:r,hasLatestResults:a})=>{const[i]=Qp(),{formatMessage:l}=M(),c=l("recipes.chat.message.chatbotPrefix"),d=l("recipes.chat.message.userPrefix");return s.jsxs(Mwt,{children:[s.jsx(Ee,{children:t===qn.ASSISTANT?c:d}),s.jsx(Mi,{messageRole:t,children:e},`${o}-${r}`),!!n?.length&&s.jsx(Y,{asChild:!0,flush:!0,className:"salt-gap--1",children:s.jsx("ul",{"aria-label":"List of recipe results",role:"presentation",children:n.map((u,m)=>s.jsx(Y.Item,{asChild:!0,colSpan:{xs:6},children:s.jsx("li",{children:s.jsx(hl,{list:mh.RECIPE_ASSISTANT,groupName:"Recommended",groupType:mh.RECIPE_ASSISTANT,sequence:m,responsiveImageHeight:!1,onQueueRecipeImpression:i,skipLinkId:a&&m===0?"recipe-assistant-results":void 0,...u},u.recipeId)})},u.recipeId))})})]})},qee=(e,t)=>{const n=$e(F3),o=$e(G3e);h.useEffect(()=>{if(Object.values(n).find(Boolean))return e(n);if(typeof o>"u")return t();const r=setTimeout(t,o);return()=>clearTimeout(r)},[n,o])},wwt=()=>{const e=ho(),t=$e(Ue("recipesChatModal")),n=$e(B3e);h.useEffect(()=>{if(!n)return;const o=setTimeout(()=>e(t?VT():BVe()),Math.max(0,le(n)-le()));return()=>clearTimeout(o)},[t,n])},Fwt=()=>{const e=$e(kC),{CREATE_CHAT:t}=$e(F3),n=$e(VO);return!!e||t||n==="CREATE_CHAT_ERROR"},Bwt=()=>{const e=ho(),t=$e(Ue("recipesChatModal")),n=$e(kC);h.useEffect(()=>{if(n)return;const o=_z();o&&(e(FVe(o.chatId)),e(Rwt()),o.isOpen&&!t&&e(Z.openModal("recipesChatModal")))},[]),h.useEffect(()=>{!n&&t&&e(VT())},[t])},Uwt=e=>{h.useEffect(()=>{if(!e)return;const t=new MutationObserver(n=>{const o=n.every(r=>!r.addedNodes.length);!e?.lastElementChild||o||e.scrollTo(0,e.scrollHeight-e.lastElementChild.clientHeight-parseInt(getComputedStyle(e).paddingBottom,10)-4)});return t.observe(e,{childList:!0}),()=>t.disconnect()},[e])},Gwt=e=>{const t=h.useRef();return{setContainerToStoredScrollPosition:h.useCallback(r=>{t.current&&r?.scrollTo(0,t.current)},[t.current]),updateStoredScrollPosition:()=>{t.current=e?.scrollTop}}},$wt=()=>{const[e,t]=h.useState(null),{setContainerToStoredScrollPosition:n,updateStoredScrollPosition:o}=Gwt(e);return Uwt(e),{scrollContainerRefCallback:h.useCallback(a=>{t(a),n(a)},[]),updateStoredScrollPosition:o}},Hwt=()=>{const e=ho(),t=ts(),n=()=>{e(yO(!1)),t({type:CV})},o=()=>{e(VT()),t({type:TV})},{formatMessage:r}=M();return s.jsxs("div",{children:[s.jsx(Mi,{messageRole:qn.ASSISTANT,children:r("recipes.chat.refresh.confirmRestart")}),s.jsxs(Tu,{children:[s.jsxs(Oc,{onClick:n,children:[s.jsx(b.Text,{"aria-hidden":"true",children:r("recipes.chat.refresh.cancelRestartButton")}),s.jsx(Ee,{asChild:!0,children:s.jsx(b.Text,{children:r("recipes.chat.refresh.cancelAccessibility")})})]}),s.jsxs(Oc,{onClick:o,children:[s.jsx(b.Text,{"aria-hidden":"true",children:r("recipes.chat.refresh.restartButton")}),s.jsx(Ee,{asChild:!0,children:s.jsx(b.Text,{children:r("recipes.chat.refresh.restartAccessibility")})})]})]})]})},Vwt=T.div`
    block-size: 100%;
    overflow: auto;
    background-color: var(--background-color);
    display: flex;
    flex-direction: column;
    gap: var(--salt-spacing-2);
`,Ywt=()=>{const e=$e(B3),t=$e(VO),[n,o]=h.useState({loading:!1,error:t}),r=h.useRef(e);return qee(a=>{(a.SEND_MESSAGE||a.CREATE_CHAT)&&o({error:t,loading:!0}),(t==="SEND_MESSAGE_ERROR"||t==="GET_CHAT_HISTORY_ERROR")&&o({error:t,loading:!1})},()=>o({error:t,loading:!1})),!n.loading&&r.current.length!==e.length&&(r.current=e),{...n,messageHistory:r.current}},Wwt=({chatContentRef:e,onScroll:t})=>{const n=$e(U3),{messageHistory:o,loading:r,error:a}=Ywt(),i=$e(kC),l=$e(G3),c=(d,u)=>u===o.length-1&&a==="SEND_MESSAGE_ERROR"?s.jsx(Ov,{errorType:a,children:d.message},a):i?s.jsx(jwt,{chatId:i,message:d,sequence:u,hasLatestResults:l===u},`${i}-${u}`):null;return s.jsxs(Vwt,{className:"salt-p--4",ref:e,"aria-live":"polite","aria-busy":r,role:"log",onScroll:t,children:[a==="GET_CHAT_HISTORY_ERROR"||a==="CREATE_CHAT_ERROR"?s.jsx(Ov,{errorType:a},a):s.jsxs(ie.Fragment,{children:[o.map(c),r&&s.jsx(Mi,{messageRole:qn.ASSISTANT,loading:!0},"loading")]}),(a==="SEND_MESSAGE_ERROR_RETRY"||a==="SEND_MESSAGE_ERROR_FATAL")&&s.jsx(Ov,{errorType:a},a),n&&s.jsx(Hwt,{})]})},qwt=T.form`
    display: grid;
    grid-template-columns: 1fr auto;
    gap: var(--salt-spacing-1);
    padding: var(--salt-spacing-1);
    background: var(--intent-primary-50);
    border-radius: var(--salt-radius-default);
`,Kwt=T(UR)`
    field-sizing: content;
    block-size: auto;
    min-block-size: revert;
    resize: block;
    overflow: hidden;

    &::placeholder {
        font-style: italic;
    }

    &::-webkit-scrollbar {
        display: none;
    }
`,zwt=T(b)`
    max-block-size: ${H(40)};
`,Qwt=()=>{const e=ho();return t=>{e(Wee(t))}},Xwt=e=>{const[t,n]=h.useState(),[o,r]=h.useState({lineHeight:0,paddingHeight:0});return h.useEffect(()=>{if(!e.current||CSS.supports("field-sizing","content"))return;const a=getComputedStyle(e.current);r({lineHeight:parseInt(a.lineHeight,10),paddingHeight:parseInt(a.padding,10)*2})},[e.current]),h.useLayoutEffect(()=>{if(!e.current||CSS.supports("field-sizing","content"))return;e.current.style.setProperty("height","0px");const a=e.current.scrollHeight-o.paddingHeight;n(Math.round(a/o.lineHeight)),e.current.removeAttribute("style")},[e.current?.value]),t},Zwt=()=>{const e=h.useRef(null),t=Xwt(e),[n,o]=h.useState(""),[r,a]=h.useState(!1),[i,l]=h.useState(!1),c=Qwt(),d=$e(U3),u=$e(VO);h.useEffect(()=>{a(d)},[d]),qee(()=>a(!0),()=>{u&&u!=="SEND_MESSAGE_ERROR_RETRY"||a(!1)}),h.useEffect(()=>{r||e.current?.focus()},[r]);const m=({target:S})=>{o(S.value),l(S.value.length===301)},g=({nativeEvent:S,currentTarget:C})=>{S instanceof KeyboardEvent&&S.key==="Enter"&&(S.preventDefault(),n&&C.form?.requestSubmit())},f=S=>{S.preventDefault(),!(r||i)&&(a(!0),c(n),o(""))},{formatMessage:y}=M(),I=$e(G3);return s.jsxs(qwt,{onSubmit:f,children:[s.jsx(QY,{visuallyConcealed:!0,htmlFor:"chat_input",children:y("recipes.chat.input.accessibilityLabel")}),s.jsx(Kwt,{as:"textarea",maxLength:301,rows:t,placeholder:y("recipes.chat.input.placeholder"),ref:e,id:"chat_input",name:"recipe-chat",onChange:m,onKeyDown:g,value:n,hasError:i,"aria-invalid":i,"aria-errormessage":"chat_input_error",enterKeyHint:"send"}),s.jsx(zwt,{type:"submit","aria-label":y("recipes.chat.input.submitButton.ariaLabel"),"data-test":"llm-chat-send-button",intent:"primary",disabled:r||i,children:s.jsx(b.Icon,{name:"arrow_right"})}),i&&s.jsx(P,{id:"chat_input_error",intent:"error",children:y("recipes.chat.input.error")}),I!==-1&&s.jsx(yg,{location:"#recipe-assistant-results",testId:"recipe-assistant-results-skip-link",text:y("skip.assistant.results")})]})},Jwt=T.div`
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: var(--salt-spacing-1);
    opacity: 0;
    transform: translate(200px, 200px) scale(0);
    transform-origin: bottom;
    transition: all 0.35s;

    ${({$displayCallOut:e})=>e&&`
        opacity: 1;
        transform: translate(0, 0) scale(1);
    `}
`,eFt=T.div`
    ${({$displayCallOut:e})=>e?`
        max-height: 200px;
    `:`
        max-height: 0;
        max-width: 0;
        transition: all 0s 0.35s;
    `}
`,tFt=({onClose:e,willDisplayCallOut:t})=>{const{formatMessage:n}=M(),[o,r]=h.useState(!1);h.useEffect(()=>{if(!t)return;const i=setTimeout(()=>{r(!0)},3e3);return()=>clearTimeout(i)},[t]),h.useEffect(()=>{!t&&o&&r(!1)},[t]);const a=()=>{r(!1),e()};return s.jsx(eFt,{$displayCallOut:o,children:s.jsxs(Jwt,{$displayCallOut:o,children:[s.jsx(b,{intent:"secondary",size:"s",fill:!1,onClick:a,"aria-label":n("recipes.chat.callout.close"),children:s.jsx(b.Icon,{name:"close_default"})}),s.jsx(Mi,{messageRole:qn.ASSISTANT,align:"right",children:n("recipes.chat.callout.message")})]})})},sFt=T.div`
    display: ${({$hideButton:e})=>e?"none":"flex"};
    flex-direction: column;
    align-items: flex-end;
    gap: var(--salt-spacing-1);
    position: fixed;
    inset-block-end: var(--salt-spacing-4);
    inset-inline-end: var(--salt-spacing-4);
    z-index: ${Qt["collapsible-box"]};
`,nFt=T(b)`
    box-shadow: var(--salt-elevation-shadow-3);
`,oFt=T(b.Text)`
    margin-inline-start: var(--salt-spacing-2);
    max-inline-size: 200px;
    transition:
        margin-inline-start 0.35s,
        max-inline-size 0.35s;

    ${({$hideButtonLabel:e})=>e&&`
            opacity: 0;
            max-width: 0;
            margin-inline-start: 0;
            height: 0;
    `}
`,rFt=T.div`
    z-index: ${Qt["collapsible-box"]};
    inline-size: 100%;
    block-size: 100%;
    ${({$availableHeight:e})=>e&&`max-height: ${e}px;`}
    position: fixed;
    background: white;
    opacity: 1;
    border-radius: var(--salt-radius-default);
    box-shadow: var(--salt-elevation-shadow-3);
    display: flex;
    flex-direction: column;
    inset-inline-end: 0;
    inset-block-end: 0;

    ${oe.smUp`
        margin-inline-end: var(--salt-spacing-4);
        margin-block-end: var(--salt-spacing-4);
        width: 432px;
        height: 576px;
    `};
`,aFt=()=>{const[e,t]=h.useState();return h.useEffect(()=>{window.visualViewport?.addEventListener("resize",()=>{t(window.visualViewport?.height)})},[]),e},iFt=()=>{const e=ho(),{formatMessage:t}=M(),n=ts(),{scrollContainerRefCallback:o,updateStoredScrollPosition:r}=$wt(),a=aFt(),i=Fwt(),l=u7(),c=$e(U3e),d=ps({breakpoint:"sm-up"}),u=$e(Ue("recipesChatModal")),m=$e(D("rec.fo"));Bwt(),wwt();const g=()=>{if(u){e(Z.closeModal()),n({type:uR});const I={event:"minimize_recipe_assistant"};J.sendEvent({GA:I,WA:null})}else{e(Z.openModal("recipesChatModal")),n({type:pR});const I={event:"reopen_recipe_assistant"};J.sendEvent({GA:I,WA:null})}},f=()=>{e(Z.openModal("recipesChatModal")),e(VT()),n({type:cR}),e($w());const I={event:"open_recipe_assistant"};J.sendEvent({GA:I,WA:null})},y=()=>{n({type:SV}),e($w())};return l?s.jsxs("div",{children:[s.jsxs(sFt,{$hideButton:u,children:[m&&s.jsx(tFt,{willDisplayCallOut:!c&&!i,onClose:y}),s.jsxs(nFt,{intent:"primary",fill:!1,"data-test":"recipe-assistant-button",onClick:i?g:f,id:"recipe-assistant-chat",className:"salt-gap--0",children:[s.jsx(b.Icon,{name:"recipes"}),m&&!i&&s.jsx(Ee,{children:t("recipes.chat.callout.message")}),s.jsx(oFt,{"data-test":"recipe-assistant-button-text",$hideButtonLabel:c||i,children:t("recipes.chat.recipeAssistant")}),s.jsx(Ee,{children:t(i?"recipes.chat.modal.resumeChat":"recipes.home.recipeAssistantAccessibility")})]})]}),s.jsxs(sh,{isOpen:u,className:"_",overlayClassName:"_",onRequestClose:g,bodyOpenClassName:d?"ReactModal__Body--open":null,contentElement:(I,S)=>s.jsx(rFt,{$availableHeight:a,...I,children:S}),children:[s.jsx(Owt,{minimiseChat:g}),s.jsx(Wwt,{chatContentRef:o,onScroll:r}),s.jsx(Zwt,{})]})]}):null},lFt=D("di"),cFt=(e,t,n)=>(o,r)=>{const a=r(),i=io(a)??[];return o(Pi.getAlternativesV2(t,n)).then(l=>{if(l){const{responseData:c}=l.payload;o(Pi.setActiveAlternatives(e));const d=c.alternatives.reduce((m,g)=>({...m,[g.productId]:tl(g,i,lFt(a))}),{});o(Ft.setProducts({product:d}));const u=c.missedPromotions||{};u?.length&&o(Ao.addMissedPromotions(u))}}).catch(()=>!1)},dFt=D("m.la.h"),uFt="alternativesModal",pFt=()=>E(Ue(Zu))?s.jsx(mFt,{}):null,mFt=()=>{const e=E(Ue(Zu)),t=F(),n=E(S=>dFt(S)),o=E(Vo(Zu)),r=h.useRef();h.useRef();const a=o?.productId,i=o?.productName,l=o?.retailerProductId,c=o?.type,d=o?.pageEventId,u=E(S=>t0e(S)),m=E(S=>s0e(S)),g=E(S=>hz(S));E(S=>ir(S));const f=()=>t(Z.closeModal()),y=h.useMemo(()=>{const S=l===g.active,C=g.data&&g.data.alternatives&&g.data.alternatives.length>0;return S&&C},[g,l]),I=h.useMemo(()=>y&&g.data.alternatives?g.data.alternatives.map(S=>S&&S.productId):[],[g,y]);return h.useEffect(()=>{!g.isFetching&&a&&l&&t(cFt(l,c==="slotbooking"?{slotId:u,slotRegionId:m}:void 0,a))},[a,l,u,m,c]),e&&g.fetchError?s.jsx(G,{isOpen:e,onRequestClose:f,aria:{labelledby:P_},children:s.jsx(jL,{actions:{onButtonClick:f}})}):e?s.jsx(G,{isOpen:e,onRequestClose:f,aria:{labelledby:P_},children:s.jsxs(ie.Fragment,{children:[s.jsx(G.Header,{"aria-live":"polite","data-test":"alternatives-modal-header",align:n?"left":"center",children:s.jsx(ne,{as:"h2",id:P_,children:s.jsx(v,{id:"alternative.products.modal.heading",values:{product:i}})})}),s.jsx(G.Body,{"data-test":"alternatives-modal-body",bodyElRef:r,children:s.jsx(se,{direction:"column",gap:["sm"],children:I.map(S=>s.jsx(ka,{page:uFt,group:{section:MVe,products:I,type:"cluster"},type:c,pageEventId:d,productId:S,displayLandscapeLayout:!0,withoutHeader:!0,sendFopImpression:!0,loading:g.isFetching||!y},S))})}),s.jsx(G.Footer,{align:n?"left":"center",children:s.jsx(b,{intent:"primary",fill:!0,onClick:f,"data-test":"alternatives-modal-footer-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"alternative.products.modal.footer.button"})})})})]})}):null};T.aside`
    display: flex;
    block-size: ${H(52)};

    ${oe.lgUp`
        height: ${H(40)};
    `}
`;const hFt=T.aside`
    display: flex;
    block-size: ${H(52)};
    position: relative;
    z-index: ${Qt["content-block-header"]};
`,gFt=T.img`
    display: block;
    inline-size: 100%;
    block-size: 100%;
    object-fit: cover;
`,EFt=T.div`
    min-inline-size: ${H(80)};
    max-inline-size: ${H(80)};

    ${oe.lgUp`
        min-width: ${H(60)};
        max-width: ${H(60)};
    `}
`,fFt=T.div`
    flex: 1 1 auto;
`,yFt=hN("HEADER"),IFt=Kg("HEADER"),SFt=Aat("HEADER"),CFt=D("seo.rdbl"),TFt=Object.values(E0e).map(e=>e()),_Ft={actions:p.shape({analyticsEvent:p.func.isRequired,fetchContentBlocks:p.func.isRequired}).isRequired,contentBlocksCommonData:p.shape({lastUpdated:p.number,fetchError:p.bool,isFetching:p.bool}).isRequired,contentBlockHeader:p.shape({id:p.oneOfType([p.string,p.number]),type:p.oneOf(["HEADER","IN_PAGE"]),name:p.string,content:p.shape({solid:p.string,images:p.arrayOf(p.shape({url:p.string.isRequired,width:p.number.isRequired,height:p.number.isRequired,imageAlignment:p.string.isRequired,altText:p.string.isRequired})).isRequired}).isRequired,targetUrl:p.string,isExternalLink:p.bool,target:p.shape({linkType:p.string.isRequired,value:p.string,openInNewTab:p.bool})}).isRequired,isContentBlockHeaderEmpty:p.bool.isRequired,isContentBlockHeaderImagesEmpty:p.bool.isRequired,isSEOReadableURLEnabled:p.bool.isRequired},Kee=({actions:e,contentBlocksCommonData:t,contentBlockHeader:n,isContentBlockHeaderEmpty:o,isContentBlockHeaderImagesEmpty:r,isSEOReadableURLEnabled:a})=>{const i=M(),l=Ne(),{fetchContentBlocks:c,analyticsEvent:d}=e,{lastUpdated:u,isFetching:m}=t,[g,f]=h.useState(0),[y,I]=h.useState(vt()),S=3,C=TFt.some($=>Or({path:$},l.pathname));if(h.useEffect(()=>{g<S&&!u&&!m&&c(a).then(()=>{f(0)}).catch(()=>{f(g+1)})},[g,u,m]),h.useEffect(()=>{o||C||r||I(()=>{const $=vt();return d({type:Xr.CONTENT_BLOCK_IMPRESSION,contentBlockImpression:{entryId:_,contentBlockType:x,entryName:A,advertId:y}}),$})},[l.key]),o||C)return null;const{id:_,name:A,type:x,target:R,isExternalLink:O,targetUrl:N,content:{images:k}}=n,j=$=>{const{target:K}=$.nativeEvent;K&&d({type:Xr.CONTENT_BLOCK_CLICKED,entryId:_,contentBlockType:x,entryName:A,linkType:R.linkType,targetUrl:N,applyDescriptionByType:"HEADER",advertId:y})},w={style:{display:"flex",height:"100%",width:"100%"}},L=$=>{const K=k.find(X=>X.imageAlignment===$);if(!K)return null;const Q=$==="CENTER"?fFt:EFt;return s.jsx(Q,{children:s.jsx(gFt,{"data-test":`content-block-header-image-${$.toLowerCase()}`,src:K.url,alt:K.altText})})},B=L("CENTER"),W=()=>{const $={"data-test":"content-block-header-content",...w},K=s.jsxs(h.Fragment,{children:[L("LEFT"),B,L("RIGHT")]});return N?s.jsx(_I,{...$,isExternalLink:O,target:R,href:N,children:K}):s.jsx("div",{...$,children:K})};return B?s.jsx(hFt,{"aria-label":i.formatMessage("contentBlocks.header.aside.aria.label"),onClick:N?j:void 0,onKeyPress:()=>{},"data-test":"content-block-header",id:"global-block",children:W()}):null};Kee.propTypes=_Ft;const vFt=e=>({contentBlocksCommonData:mN(e),contentBlockHeader:yFt(e),isContentBlockHeaderEmpty:IFt(e),isContentBlockHeaderImagesEmpty:SFt(e),isSEOReadableURLEnabled:CFt(e)}),AFt=ot({analyticsEvent:U.analyticsEvent,fetchContentBlocks:op.getContentBlocks}),bFt=ke(vFt,AFt)(Kee),zee=({data:e})=>e.content.staticContentPage,pk=e=>e.type.endsWith("_SUCCESS"),xFt=ee("CREATE_MEAL"),RFt=ee("EDIT_MEAL"),DFt=ee("DELETE_MEAL"),OFt=e=>({type:"API",payload:{url:"/v1/meals",options:{method:"POST",body:e},...xFt,...kg}}),PFt=(e,t)=>({type:"API",payload:{url:`/v1/meals/${e}`,options:{method:"PUT",body:t},...RFt,...kg}}),NFt=e=>({type:"API",payload:{url:`/v1/meals/${e}`,options:{method:"DELETE"},...DFt,...kg}}),Qee=({mealTitle:e,mealIngredients:t,mealNotes:n})=>({title:Bu(e),ingredients:t.reduce((o,{ingredient:r})=>r?o.concat([Bu(r)]):o,[]),notes:n?Bu(n):void 0}),LFt=e=>async(t,n)=>{try{const o=await t(OFt(Qee(e)));if(pk(o)){const{id:r,ingredients:a,notes:i}=o.payload.responseData,l=WO(n());t(U.analyticsEvent({type:mR,MEAL_ID:r,NUMBER_OF_INGREDIENTS:a.length,...i&&{LENGTH_OF_NOTES:i?.length}})),t(YO(l));const c={event:"meal_plan_create_meal",id:r};J.sendEvent({GA:c,WA:null})}return o}catch{return z.error("meals.newMeal.create.error"),null}},kFt=(e,t)=>async(n,o)=>{try{const r=await n(PFt(e,Qee(t)));if(pk(r)){const{id:a,ingredients:i,notes:l}=r.payload.responseData,c=WO(o());n(U.analyticsEvent({type:hR,MEAL_ID:a,NUMBER_OF_INGREDIENTS:i.length,...l&&{LENGTH_OF_NOTES:l?.length}})),n(YO(c));const d={event:"meal_plan_edit_meal",id:a};J.sendEvent({GA:d,WA:null})}return r}catch{return z.error("toast.notification.generic.error"),null}},MFt=e=>async(t,n)=>{try{const o=await t(NFt(e)),r=WO(n());if(pk(o)){t(U.analyticsEvent({type:gR,MEAL_ID:e})),t(YO(r));const a={event:"meal_plan_delete_meal",id:e};J.sendEvent({GA:a,WA:null})}}catch{z.error("toast.notification.generic.error")}},Xee={createMeal:LFt,editMeal:kFt,deleteMeal:MFt},jFt=101,Zee=({name:e,className:t})=>{const n=M(),o=n.formatMessage("meals.newMeal.name.title"),r={placeholder:n.formatMessage("meals.newMeal.name.placeholder"),required:{value:!0,message:n.formatMessage("meals.newMeal.missingTitle.error")},maxLength:jFt};return s.jsx("div",{className:t,children:s.jsx(Jo,{type:"text",validate:a=>$C(n.formatMessage("validation.msg.required"))(a),label:o,name:e,hasRequiredSymbol:!1,"data-test":"meal-name-input","data-pii":"true",...r})})},wFt=500,Jee=({name:e,className:t})=>{const n=M(),o=n.formatMessage("mealplanning.new-meal.notes.title"),r={placeholder:n.formatMessage("mealplanning.new-meal.notes.placeholder"),maxLength:wFt};return s.jsx("div",{className:t,children:s.jsx(Jo,{type:"text",label:o,name:e,"data-pii":"true",...r})})},FFt=T.fieldset`
    padding: 0;
    border: none;
`,BFt=T.div`
    border-radius: var(--salt-radius-default);

    &:focus-within {
        outline: 5px auto Highlight;
        outline: 5px auto -webkit-focus-ring-color;
    }
`,UFt=T.div`
    position: relative;

    &:first-of-type input {
        border-start-start-radius: var(--salt-radius-default);
        border-start-end-radius: var(--salt-radius-default);
    }

    &:last-of-type input {
        border-end-start-radius: var(--salt-radius-default);
        border-end-end-radius: var(--salt-radius-default);
    }

    &:not(:first-of-type) input {
        border-block-start: 0;
    }

    &:has(input[disabled]):not(:first-of-type)::after {
        content: '';
        background: var(--intent-secondary-300);
        position: absolute;
        inset-inline: var(--salt-spacing-2);
        block-size: var(--salt-border-1);
    }
`,GFt=T(jS)`
    outline: 0;
    border-radius: var(--salt-radius-0);

    &:focus::placeholder {
        color: transparent;
    }
`,Uh=({className:e,children:t})=>{const{formatMessage:n}=M();return s.jsxs(FFt,{className:e,children:[s.jsx(bn,{as:"legend",children:n("mealplanning.new-meal.ingredients.title")}),s.jsx(BFt,{children:ie.Children.map(t,o=>s.jsx(UFt,{children:o}))})]})};Uh.Input=GFt;const $Ft=T(Ua)`
    color: var(--salt-text-color);
`,Pv=25,HFt=500,ete=({className:e,mealId:t})=>{const{formatMessage:n}=M(),o=ho(),[r,a]=h.useState(),{register:i,setFocus:l,watch:c}=$o(),d=c("mealIngredients"),u=d.at(-1)?.ingredient,{fields:m,append:g,remove:f,replace:y}=jre({name:"mealIngredients"});return h.useLayoutEffect(()=>{u&&d.length<Pv&&g({ingredient:""},{shouldFocus:!1})},[u,d.length]),h.useEffect(()=>{r&&l(`mealIngredients.${r}.ingredient`)},[r]),s.jsxs("div",{className:e,children:[s.jsx(Uh,{children:m.map((I,S)=>{const{onBlur:C,..._}=i(`mealIngredients.${S}.ingredient`),A=S===m.length-1,x=R=>{const O=R.clipboardData.getData("text").split(/\r?\n/);if(O.length<=1)return;R.preventDefault();const N=d.filter(L=>L.ingredient),k=Pv-N.length,j=O.reduce((L,B)=>{const W=B.replace("•","").trim();return W?[...L,{ingredient:W}]:L},[]),w=j.slice(0,k);y(N.toSpliced(S,0,...w)),w.length<j.length&&z.warning("mealplanning.new-meal.maximum-ingredients-exceeded.notification"),a(S+w.length-1),o(U.analyticsEvent({type:RV,...t&&{MEAL_ID:t},NUMBER_OF_INGREDIENTS:w.length}))};return s.jsx(Uh.Input,{maxLength:HFt,"data-test":`meal-ingredients-input-${S}`,placeholder:n("mealplanning.new-meal.ingredients.placeholder"),"data-pii":"true",onPasteCapture:x,onKeyDown:R=>{R.code==="Enter"&&(R.preventDefault(),l(`mealIngredients.${S+1}.ingredient`))},onBlur:R=>{C(R),!R.currentTarget.value.length&&!A&&f(S)},..._},I.id)})}),m.length===Pv&&!!u&&s.jsx($Ft,{className:"salt-m-t--2",children:n("mealplanning.new-meal.maximum-ingredients-reached")})]})},VFt=T.form`
    inline-size: 100%;
`,YFt=({closeModal:e})=>{const t=ho(),[n,o]=h.useState(!1),{formatMessage:r}=M(),a={cancelButton:r("meals.newMeal.cancelButton"),submitCreateButton:r("meals.newMeal.createButton")},i=async d=>{d.mealTitle&&(o(!0),await t(Xee.createMeal(d)),e(),o(!1))},l=$o(),c=()=>{e()};return s.jsx(se,{children:s.jsxs(VFt,{id:"new-meal-form",onSubmit:l.handleSubmit(i),children:[s.jsx(Zee,{name:"mealTitle",className:"salt-m-b--4"}),s.jsx(ete,{className:"salt-m-b--4"}),s.jsx(Jee,{name:"mealNotes",className:"salt-m-b--4"}),s.jsxs(se,{justify:"center",wrap:"nowrap",children:[s.jsx(b,{className:"salt-d--none sm:salt-d--flex salt-m-r--2 salt-m-y--0",intent:"secondary",onClick:c,fill:!0,children:s.jsx(b.Text,{children:a.cancelButton})}),s.jsx(b,{intent:"primary",loading:n,fill:!0,type:"submit",children:s.jsx(b.Text,{children:a.submitCreateButton})})]})]})})},WFt=()=>{const e=F(),{formatMessage:t}=M(),n=$e(Ue("newMealModal")),o=Gn({mode:"onChange",defaultValues:{mealTitle:"",mealIngredients:[{ingredient:""}]}}),r=()=>{e(Z.closeModal()),o.reset()};return s.jsx($n,{...o,children:s.jsxs(G,{isOpen:n,onRequestClose:r,maxWidth:"lg",closeMessage:t("mealplanning.new-meal.close.accessibility"),asBottomSheet:!0,children:[s.jsx(G.Header,{align:"left",children:s.jsx(ne,{as:"h1",children:s.jsx(v,{id:"meals.newMeal.title"})})}),s.jsx(G.Body,{children:s.jsx(YFt,{closeModal:r})})]})})},qFt=T.form`
    inline-size: 100%;
`,KFt=({onSubmit:e,mealId:t})=>s.jsxs(qFt,{id:"new-meal-form",onSubmit:e,children:[s.jsx(Zee,{name:"mealTitle",className:"salt-m-b--4"}),s.jsx(ete,{mealId:t,className:"salt-m-b--4"}),s.jsx(Jee,{name:"mealNotes",className:"salt-m-b--4"})]}),zFt=({meal:e,closeModal:t})=>{const n=ho(),{formatMessage:o}=M(),[r,a]=h.useState(!1),i=async d=>{d.mealTitle&&(a(!0),await n(Xee.editMeal(e.id,d)),t())},l=Gn({mode:"onChange",defaultValues:{mealTitle:e.title,mealIngredients:e.ingredients.length?e.ingredients.map(d=>({ingredient:d})):[{ingredient:""}],mealNotes:e.notes}}),c=()=>{n(Z.openModal("deleteMeal",{meal:e,onConfirm:t,onCancel:()=>{n(Z.openModal("mealDetails",e))}})),n(U.analyticsEvent({type:NV,MEAL_ID:e.id}))};return s.jsxs(h.Fragment,{children:[s.jsx(G.Body,{className:"salt-p--0",children:s.jsx(se,{className:"salt-p--4",children:s.jsx($n,{...l,children:s.jsx(KFt,{mealId:e.id,onSubmit:l.handleSubmit(i)})})})}),s.jsx(G.Footer,{className:"salt-p--0",children:s.jsxs(se,{direction:"column",additionalCss:"flex: 1;",className:"salt-p--4 salt-gap--2",children:[s.jsx(b,{fill:!0,loading:r,intent:"primary",onClick:l.handleSubmit(i),"data-test":"save-meal-button",children:s.jsx(b.Text,{children:o("meals.editMeal.saveButton")})}),s.jsx(b,{fill:!0,intent:"secondary",onClick:c,"data-test":"delete-meal-button",children:s.jsx(b.Text,{children:o("meals.editMeal.deleteButton")})})]})})]})},QFt=T.img`
    flex: 1;
    object-fit: cover;
    object-position: 50% 50%;
    inline-size: 100%;
    min-block-size: 0;
    max-block-size: ${H(124)};
`,pG=T(b)`
    position: absolute;
    inset-block-start: var(--salt-spacing-2);
    ${({$alignLeft:e})=>e?"inset-inline-start: var(--salt-spacing-2)":"inset-inline-end: var(--salt-spacing-2)"};
    z-index: ${Qt.overlay};
`,XFt=T(ne)`
    word-break: break-all;
`,ZFt=T(b)`
    flex-shrink: 0;
    align-self: center;
`,JFt=()=>{const e=F(),{formatMessage:t}=M(),[n,o]=h.useState(!1),r=$e(Ue("mealDetails")),a=$e(Vo("mealDetails")),i=()=>{o(!1),e(Z.closeModal())},l=()=>{o(!0),e(U.analyticsEvent({type:DV,MEAL_ID:a?.id}))},c=()=>{e(Z.openModal("cancelEditMealModal",{onConfirm:()=>{o(!1),e(Z.openModal("mealDetails",a)),e(U.analyticsEvent({type:PV,MEAL_ID:a?.id}))},onCancel:()=>{e(Z.openModal("mealDetails",a))}})),e(U.analyticsEvent({type:OV,MEAL_ID:a?.id}))};return!r||!a?null:s.jsxs(G,{onRequestClose:i,isOpen:r,showCloseIcon:!1,condensed:!0,context:"drawer",children:[s.jsxs(G.Header,{align:"left",className:"salt-p--0",children:[s.jsx(QFt,{src:a.image.url,alt:a.image.altText}),n?s.jsxs(pG,{intent:"secondary",onClick:c,$alignLeft:!0,fill:!1,children:[s.jsx(b.Icon,{name:"arrow_left"}),s.jsx(b.Text,{children:t("mealplanning.edit-meal.back-button")})]}):s.jsx(pG,{intent:"secondary",onClick:i,fill:!1,children:s.jsx(b.Icon,{name:"close_default"})})]}),n?s.jsx(zFt,{meal:a,closeModal:i}):s.jsx(G.Body,{className:"salt-p--0",children:s.jsx("div",{"data-test":"meal-details-content",children:s.jsxs(se,{direction:"column",gap:["md"],className:"salt-m--4",children:[s.jsxs(se,{justify:"space-between",wrap:"nowrap",direction:"row",gap:["md"],basis:"100%",children:[s.jsx(XFt,{forwardedAs:"h1",size:"s",children:a.title}),s.jsx(ZFt,{intent:"secondary",size:"s",fill:!1,onClick:l,"data-test":"edit-meal-button",children:s.jsx(b.Text,{children:t("meals.mealDetails.editButton")})})]}),a.ingredients.length?s.jsx(Uh,{children:a.ingredients.map(d=>s.jsx(Uh.Input,{value:d,disabled:!0,readOnly:!0},d))}):s.jsxs("div",{children:[s.jsx(se,{justify:"center",margin:[null,null,"md"],children:s.jsx(me,{name:"no_ingredients",height:250,width:250})}),s.jsx(P,{asChild:!0,className:"salt-m-b--4",children:s.jsx("div",{children:t("meals.mealDetails.noIngredients.message")})}),s.jsx(b,{className:"salt-m-r--2 salt-m-y--0",intent:"secondary",fill:!0,"data-test":"add-ingredients-button",onClick:l,children:s.jsx(b.Text,{children:t("meals.mealDetails.addIngredientsButton")})})]}),a.notes&&s.jsx(A6,{id:"notes",label:t("mealplanning.new-meal.notes.title"),inputOptions:{disabled:!0,value:a.notes,readOnly:!0}})]})})})]})},eBt=e=>e.data.popupBanner,tBt=e=>e.data.popupBanner.vrTestingMeta,sBt=e=>{const t=F(),{lastUpdated:n,data:o}=E(eBt);return h.useEffect(()=>{!n&&e&&t(a9e())},[n,e]),o},nBt=[["/products/search","SEARCH",!0],["/products","CATEGORY",!0],["/search","SEARCH",!0],["/categories","CATEGORY",!1],["/favorites","FAVORITES",!0],["/regulars","REGULARS",!0],["/lists","LISTS",!0],["/promotions","PROMOTIONS",!0],["/coupons","COUPONS",!0],["/content","CONTENT_PAGE",!1]],oBt=(e="",t=!1)=>{if(e==="/")return t?"LIHP":"LOHP";let n;return nBt.forEach(([o,r,a])=>{e.startsWith(o)&&(a||(n=r),e===o&&(n=r))}),n},rBt=()=>{const{pathname:e}=Ne(),t=E(Ze),[n,o]=h.useState(void 0);return h.useEffect(()=>{o(oBt(e,t))},[e,t]),n},tte=e=>{const t=[];for(let n=0;n<localStorage.length;n++){const o=localStorage.key(n);o?.startsWith(e)&&t.push(o)}return t},ste=e=>{const t=`${e}-`,n=tte(t);return!n.length||n.length>1?void 0:n[0]},aBt=(e,t)=>{if(!t)return;tte(e).forEach(o=>{o.endsWith(t)||localStorage.removeItem(o)})},iBt=3e3,Wm="current-pop-up-banner-page-count-to-reset",lBt=(e,t)=>typeof e=="number"&&e>0&&t!==void 0,cBt=(e,t)=>{const n=ste(Wm);if(n){const o=localStorage.getItem(n);o!==null&&Number(o)>0&&e(Number(o));return}t&&(localStorage.setItem(`${Wm}-${t}`,"0"),aBt(Wm,t))},dBt=e=>{e(t=>{const n=ste(Wm);if(!lBt(t,n))return t;const o=t-1;return localStorage.setItem(n,`${o}`),o})},uBt=({hasPageCollision:e,isRouteWhiteListed:t,popUpVisible:n,pageCount:o,setPopUpVisible:r,showPopup:a})=>{let i;const l=()=>i&&clearTimeout(i);return(e||!t)&&n?(r(!1),l):(!n&&o===0&&t&&!e&&(i=a()),l)},pBt=({isRouteWhiteListed:e,hasPageCollision:t=!1,disableDelay:n=!1,popUpId:o})=>{const r=Ne(),[a,i]=h.useState(!1),[l,c]=h.useState(0),d=E(Eae),u=h.useCallback(()=>setTimeout(()=>i(!0),n?0:iBt),[n]);h.useEffect(()=>{cBt(c,o)},[o]),h.useEffect(()=>uBt({hasPageCollision:t,isRouteWhiteListed:e,popUpVisible:a,pageCount:l,setPopUpVisible:i,showPopup:u}),[r.pathname,e,t,l,a,u]),h.useEffect(()=>{dBt(c)},[r.pathname]);const m=h.useCallback(()=>{const g=Number(d);i(!1),c(g),localStorage.setItem(`${Wm}-${o}`,`${g}`)},[d,o]);return{popUpVisible:a,handleClose:m}},nte={POPUP_BANNER:{click:"POPUP_BANNER_CLICKED",impression:"POPUP_BANNER_IMPRESSION",close:"POPUP_BANNER_CLOSE"}},mG=(e,t,n)=>{const o=F(),r=nte[t][e];return h.useCallback(({id:a,advertId:i,name:l,altText:c,targetUrl:d,linkType:u,segments:m,imageUrl:g})=>{const f={id:a,...i&&{advertId:i},name:l,altText:c,targetUrl:d,linkType:u,segments:m,imageUrl:g,location:n,contentSource:"CONTENTFUL",placement:"POP-UP"};if(o(U.analyticsEvent({type:r,...f})),e==="click"){const y=Upe(f);J.sendEvent({GA:y,WA:null});const I=Hpe(f);J.sendEvent({GA:I,WA:null})}if(e==="impression"){const y=Gpe(f);J.sendEvent({GA:y,WA:null});const I=Ype(f);J.sendEvent({GA:I,WA:null})}},[n])},mBt=e=>{const t=F(),n=nte.POPUP_BANNER.close;return h.useCallback(({id:o,advertId:r,name:a,linkType:i,targetUrl:l,altText:c})=>{const d={id:o,advertId:r,name:a,linkType:i,location:e,targetUrl:l,altText:c,contentSource:"CONTENTFUL",placement:"POP-UP"};t(U.analyticsEvent({type:n,...d}));const u=$pe(d);J.sendEvent({GA:u,WA:null});const m=Vpe(d);J.sendEvent({GA:m,WA:null})},[e])},hBt=e=>{const t=mG("click","POPUP_BANNER",e),n=mG("impression","POPUP_BANNER",e),o=mBt(e);return{reportPopUpBannerClick:t,reportPopUpBannerImpression:n,reportPopupBannerClose:o}},gBt=["/favorites"],EBt=e=>{const{pathname:t}=Ne(),[n,o]=h.useState("");return h.useEffect(()=>{const r=`/${t.split("/")[1]}`;o(r==="/"?"homepage":r)},[t]),gBt.includes(n)&&(e==="/"?n==="homepage":e.startsWith(n))},fBt={LARGE:[960,960],SMALL:[960,240]},yBt=e=>{const[t,n]=h.useState(!1);return h.useEffect(()=>{window&&n(window.matchMedia(e).matches)},[e]),t},IBt=T.div`
    line-height: 0;
    position: fixed;
    z-index: ${Qt.popup};
    inline-size: 100%;
    inset-block-end: -100%;
    box-shadow: var(--salt-elevation-shadow-3);
    border-start-start-radius: var(--salt-radius-default);
    border-start-end-radius: var(--salt-radius-default);
    aspect-ratio: 4/1;
    justify-content: flex-end;
    align-items: flex-start;

    &.without-animation {
        animation: unset;
        inset-block-end: 0;

        ${oe.mdUp`
            inset-inline-start: 24px;
            inset-block-end: 24px;
        `};

        @media (width <= 62em) and (orientation: landscape) {
            inset-block-end: 0;
        }
    }

    .popup-banner-close-button {
        position: absolute;
        inset-block-start: var(--salt-spacing-1);
        inset-inline-end: var(--salt-spacing-1);
        inline-size: auto;
    }

    @keyframes slide-in {
        0% {
            opacity: 0;
            inset-block-end: -100%;
        }

        40% {
            opacity: 0;
        }

        100% {
            opacity: 1;
            inset-block-end: 0;
        }
    }

    ${({isPopUpVisible:e})=>e?`
            animation: slide-in 0.3s ease-in-out forwards;
            inset-block-end: 0;
            display: flex;
        `:`
            inset-block-end: -100%;
            display: none;
        `};

    ${oe.mdUp`
        height: 360px;
        width: 360px;
        inset-inline-start: -360px;
        inset-block-end: 24px;
        border-radius: var(--salt-radius-default);
        box-shadow: var(--salt-elevation-shadow-3);
        aspect-ratio: 1/1;

        @keyframes slide-in {
            0% {
                opacity: 0;
                transform: translateX(-360px);
            }

            40% {
                opacity: 0;
            }

            100% {
                opacity: 1;
                transform: translateX(384px);
            }
        }
    `};

    @media (width <= 62em) and (orientation: landscape) and (device-width <= 62em) {
        inline-size: 360px;
        block-size: 90px;
        inset-block-end: var(--salt-spacing-2);
        inset-inline-start: 50%;
        transform: translateX(-50%);
        aspect-ratio: 4/1;
        @keyframes slide-in {
            0% {
                opacity: 0;
                inset-block-end: -100%;
            }

            40% {
                opacity: 0;
            }

            100% {
                opacity: 1;
                inset-block-end: 0;
            }
        }
    }
`,SBt=T.img`
    block-size: 100%;
    inline-size: 100%;
    border-start-start-radius: var(--salt-radius-default);
    border-start-end-radius: var(--salt-radius-default);
    overflow: hidden;
    ${oe.mdUp`
        border-radius: var(--salt-radius-default);
    `};
`,CBt=e=>{if(!e)return"";const t=La.calculateLegacyTargetUrl(e),n=e.linkType==="ABSOLUTE_WEB_ADDRESS"?new URL(t):null;return n?n.href:t},TBt=()=>{const{formatMessage:e}=M(),[t]=fe(["pop.uid"]),n=rBt(),{reportPopUpBannerClick:o,reportPopUpBannerImpression:r,reportPopupBannerClose:a}=hBt(n),{disableAnimation:i,disableDelay:l}=E(tBt),c=sBt(!!n),d=ll(),u=ps({breakpoint:"md-up"}),m=yBt("(width <= 62em) and (orientation: landscape) and (max-device-width: 62em)"),g=h.useMemo(()=>{const O=u||m?"SMALL":"LARGE",[N,k]=fBt[O],{images:j}=c??{images:[]};return j.find(w=>w.width===N&&w.height===k)},[c,d,m]),f=e("popupBanner.accessibility.close"),y=e("popupBanner.accessibility.image",{alt:g?.altText}),I=CBt(c?.target),S=EBt(I),{popUpVisible:C,handleClose:_}=pBt({isRouteWhiteListed:!!n,hasPageCollision:S,disableDelay:l,popUpId:t?c?.campaignId:c?.id}),A=c?.target.openInNewTab?"_blank":void 0;h.useEffect(()=>{c&&C&&r({id:t?c?.campaignId:c?.id,...t&&{advertId:c?.id},name:c.name,altText:y,targetUrl:I,linkType:c.target.linkType,segments:c.segments,imageUrl:g?.url,location:n})},[C]);const x=()=>{c&&(o({id:t?c?.campaignId:c?.id,...t&&{advertId:c?.id},name:c.name,altText:y,targetUrl:I,linkType:c.target.linkType,segments:c.segments,imageUrl:g?.url,location:n}),_())},R=()=>{c&&(a({id:t?c?.campaignId:c?.id,...t&&{advertId:c?.id},name:c.name,linkType:c.target.linkType,targetUrl:I,altText:y}),_())};return g&&n?s.jsxs(IBt,{"data-test":"pop-up-banner",className:i?"without-animation":"",isPopUpVisible:C,role:"status","aria-live":"polite","aria-label":y,children:[s.jsx(rt,{"data-test":"pop-up-banner-link",intent:"ghost",href:I,title:y,target:A,onClick:x,children:s.jsx(SBt,{"data-test":"pop-up-banner-image",src:g.url,alt:y})}),s.jsxs(b,{intent:"tertiary-contrast",onClick:R,"data-test":"popup-banner-close-button",className:"popup-banner-close-button",size:"s",children:[s.jsx(Ee,{children:f}),s.jsx(b.Icon,{name:"close_default"})]})]}):null},_Bt=D("m.la.h"),vBt={isOpen:p.bool,actions:p.shape({closeModal:p.func.isRequired}).isRequired,modalOptions:p.shape({messages:p.shape({title:p.string,message:p.string,cancel:p.string,confirm:p.string}),redirectUrl:p.string,cancelRedirectUrl:p.string}),modalLeftAlignEnabled:p.bool},ABt={isOpen:!1,modalOptions:{},modalLeftAlignEnabled:!1},mk=({isOpen:e,actions:t,modalOptions:n,modalLeftAlignEnabled:o})=>{if(!e)return null;const r=()=>window.location.assign(n.redirectUrl),a="change-store-modal-header",i=()=>{t.closeModal();const{cancelRedirectUrl:l}=n;l&&window.location.assign(l)};return s.jsxs(G,{isOpen:e,onRequestClose:t.closeModal,aria:{labelledby:a},children:[s.jsx(G.Header,{align:o?"left":"center",children:s.jsx(ne,{as:"h2",id:a,children:s.jsx(v,{id:n.messages&&n.messages.title||"change.store.modal.title","data-test":"change.store.modal.title"})})}),s.jsx(G.Body,{children:s.jsx(v,{id:n.messages&&n.messages.message||"change.store.modal.message","data-test":"change.store.modal.message"})}),s.jsxs(G.Footer,{align:o?"left":"center",className:"salt-gap--2",children:[s.jsx(b,{intent:"secondary",onClick:i,fill:!0,children:s.jsx(b.Text,{children:s.jsx(v,{id:n.messages&&n.messages.cancel||"change.store.modal.cancel","data-test":"change.store.modal.cancel"})})}),s.jsx(b,{intent:"primary",onClick:r,fill:!0,children:s.jsx(b.Text,{children:s.jsx(v,{id:n.messages&&n.messages.confirm||"change.store.modal.confirm","data-test":"change.store.modal.confirm"})})})]})]})};mk.propTypes=vBt;mk.defaultProps=ABt;const yb="changeStore",bBt=e=>({isOpen:Ue(yb)(e),modalOptions:Vo(yb)(e),modalLeftAlignEnabled:_Bt(e)}),xBt=ot({closeModal:Z.closeModal}),RBt=ke(bBt,xBt)(mk),Fi={LAYOUT:"LAYOUT",CHECKOUT_WALK:"CHECKOUT_WALK",CHECKOUT_SUMMARY:"CHECKOUT_SUMMARY",RECIPES:"RECIPES"},DBt={[Fi.LAYOUT]:[["#main","skip.main"],["#search","skip.search"],["#footer","skip.footer"]],[Fi.CHECKOUT_WALK]:[["#main","skip.main"],["#search","skip.search"],["#checkout-progress","skip.checkout.progress"]],[Fi.CHECKOUT_SUMMARY]:[["#main","skip.main"],["#search","skip.search"],["#summary-box","skip.checkout.summary"]],[Fi.RECIPES]:[["#main","skip.main"],["#search","skip.search"],["#footer","skip.footer"],["#recipe-assistant-chat","skip.recipe.assistant"]]},ote=({variant:e=Fi.LAYOUT})=>{const t=M();return s.jsx(ie.Fragment,{children:DBt[e].map(([n,o])=>s.jsx(yg,{location:n,text:t.formatMessage(o)},n))})},OBt=D("m.la.h"),PBt={isOpen:p.bool.isRequired,actions:p.shape({closeModal:p.func.isRequired,cancelOrderEditExpired:p.func.isRequired}).isRequired,orderId:p.string.isRequired,modalLeftAlignEnabled:p.bool},NBt={modalLeftAlignEnabled:!1},LBt="CURRENT_PAGE",kBt="SHOW_ORDER_DETAILS",hk=({isOpen:e,actions:t,orderId:n,modalLeftAlignEnabled:o})=>{const r=We(),a=()=>{t.cancelOrderEditExpired(LBt,n,r)},i=()=>{t.cancelOrderEditExpired(kBt,n,r)},l="order-edit-expired-modal-header";return s.jsxs(G,{isOpen:e,aria:{labelledby:l},children:[s.jsx(G.Header,{align:o?"left":"center",children:s.jsx(ne,{as:"h2",id:l,children:s.jsx(v,{id:"order.edit.expired.modal.title"})})},"header"),s.jsxs(G.Body,{children:[s.jsx(P,{className:"salt-d--block",children:s.jsx(v,{id:"order.edit.expired.modal.body.sorry"})}),s.jsx(P,{className:"salt-d--block",children:s.jsx(v,{id:"order.edit.expired.modal.body"})})]}),s.jsxs(G.Footer,{align:o?"left":"center",className:"salt-gap--2",children:[s.jsx(b,{intent:"secondary",onClick:a,"data-test":"order-edit-expired-cancel-button",fill:!0,children:s.jsx(b.Text,{children:s.jsx(v,{id:"order.edit.expired.modal.close"})})}),s.jsx(b,{intent:"primary",onClick:i,"data-test":"order-edit-expired-view-order",fill:!0,children:s.jsx(b.Text,{children:s.jsx(v,{id:"order.edit.expired.modal.view.order"})})})]})]})};hk.propTypes=PBt;hk.defaultProps=NBt;const MBt=(e,t)=>({isOpen:Ue(`orderEditExpired${t.orderId}`)(e),modalLeftAlignEnabled:OBt(e)}),jBt=ot({closeModal:Z.closeModal,cancelOrderEditExpired:ci.cancelOrderEditExpired}),wBt=ke(MBt,jBt)(hk),FBt={actions:p.shape({openOrderEditExpiredModal:p.func}).isRequired,isBasketUnderEdit:p.bool.isRequired,orderId:p.string,remainingTimeToEditInMillis:p.number},BBt={orderId:null,remainingTimeToEditInMillis:null},gk=({actions:e,isBasketUnderEdit:t,orderId:n,remainingTimeToEditInMillis:o})=>(h.useEffect(()=>{let r;if(t&&n){const i=Math.max(o,0),l=i<6048e5?i:6048e5;r=setTimeout(()=>e.openOrderEditExpiredModal(n),l)}return()=>clearTimeout(r)},[t,n,o]),s.jsx(wBt,{orderId:n}));gk.propTypes=FBt;gk.defaultProps=BBt;const UBt=e=>({remainingTimeToEditInMillis:kie(e),isBasketUnderEdit:Mr(e),orderId:At(e)}),GBt=ot({openOrderEditExpiredModal:e=>Z.openModal(`orderEditExpired${e}`)}),$Bt=ke(UBt,GBt)(gk),rte=()=>s.jsxs(h.Fragment,{children:[s.jsx("div",{id:"StickyCollapsibleSummary"}),s.jsx("div",{id:"StickyBopButton"}),s.jsx("div",{id:"StickyPromotionOptionsAchieved"})]}),HBt=(e,t)=>t.some(n=>e.includes(n)),VBt=["categories","offers","promotions","products"],YBt=(e,t)=>`${e}?sublocationId=${t}`,WBt=e=>{const t=e.substring(0,e.lastIndexOf("/")+1),n=t.toLowerCase();return e.replace(t,n)},qBt=()=>{const[e]=fe(["seo.rdbl"]),t=Ne(),{sublocationId:n}=us.parse(t.search),o=E(Wt),a=`https://${E(nS)}${o??""}`,i=o&&t.pathname==="/"?"":t.pathname;return{canonicalHrefValue:(()=>{if(n&&typeof n=="string"&&!e)return`${a}${YBt(i,n)}`;if(HBt(i,VBt)&&e){const c=WBt(i);return`${a}${c}`}return`${a}${i}`})()}},KBt=()=>s.jsx(_o,{children:s.jsx("meta",{name:"robots",content:"noindex,nofollow"})}),ate=T.main`
    margin-block: 0;
    margin-inline: auto;
    max-inline-size: ${H(1920)};
`,zBt=({canonicalHref:e})=>s.jsx(_o,{children:s.jsx("link",{rel:"canonical",href:e})}),QBt=["basket"],XBt=({outlet:e,isSearchEngineCrawlsBlockedFF:t,isLoggedIn:n,unblockedCrawlerPathNames:o="",fetchError:r})=>{const a=Ne(),l=!new RegExp(o,"g").test(a?.pathname),c=tt.parse(a.search),d=!!(c.q||c.searchTerm);h.useEffect(()=>{if(!e){const f=new Error(`empty content alert triggered when trying to access ${a.pathname}.`);Me.api.pushError(f)}},[a]);const u=()=>{if(n||r)return!1;if(t)return!l&&!!o&&!d;const f=QBt.some(y=>a?.pathname.includes(y));return!d&&!f},m=qBt(),g=t&&(!o||l);return s.jsxs(h.Fragment,{children:[g&&s.jsx(KBt,{}),u()&&s.jsx(zBt,{canonicalHref:m?.canonicalHrefValue}),s.jsx(ate,{id:"main",className:"salt-m-b--8",children:e})]})};function ZBt(){const e=E(ua),t=E(up),n=E(Mae),o=E(jae),r=F(),a=()=>{if(r(U.analyticsEvent({type:on.REGISTER_SUCCESS_ANALYTICS,retailerCustomerId:e,visitorId:t})),e){const l={event:"event",eventAction:"RegistrationSuccess",eventLabel:"RegistrationSuccess",eventCategory:"Registration",retailerCustomerId:e,visitorId:t};J.sendEvent({GA:l,WA:null})}if(r(U.analyticsEvent({type:on.REGISTER_SUCCESS_ANALYTICS_GA4,retailerCustomerId:e})),e){const l={event:"sign_up",customer_id:e};J.sendEvent({GA:l,WA:null})}},i=()=>{if(r(U.analyticsEvent({type:on.LOGIN_SUCCESS_ANALYTICS,retailerCustomerId:e,visitorId:t})),e){const l={event:"event",eventAction:"LoginSuccess",eventLabel:"LoginSuccess",eventCategory:"Login",retailerCustomerId:e,visitorId:t};J.sendEvent({GA:l,WA:null})}if(r(U.analyticsEvent({type:on.LOGIN_SUCCESS_ANALYTICS_GA4,retailerCustomerId:e})),e){const l={event:"login",customer_id:e};J.sendEvent({GA:l,WA:null})}};return h.useEffect(()=>{n&&(o&&a(),i(),localStorage.removeItem(gh),r(Rae()))},[n]),null}const Ib=D("cf.cb.ip"),JBt=D("cf.cb.ip.seg"),ite=D("cf.cb.hd"),eUt=D("loyalty"),lte=D("co.bl"),cte=D("gl.bl"),tUt=D("seo.rdbl"),sUt=D("tp"),nUt=D("tp.new"),oUt=D("ald.m"),rUt=D("seo.bsec"),aUt=D("rec.llm"),iUt=D("mp"),lUt=D("cmpnb"),cUt=D("cp"),dUt=D("sl.c"),uUt=D("cf.ft.flx"),dte=({children:e})=>s.jsx("div",{className:"site--content",children:e}),ute=()=>{const e=M$(),t=Ne(),n=u7(),o=E(_0),r=E(lte),a=E(cte),i=E(oUt),l=E(Ib),c=E(JBt),d=E(ite),u=E(sUt),m=E(nUt),g=E(Ze),f=E(rUt),y=Cs("search-engine-non-blocked-pages"),I=E(Nve),S=E(ilt),C=E(zee),_=E(aUt),A=E(iUt),[x]=fe(["popup"]);xK();const R=I||S||C.fetchError;return s.jsxs(Iee,{children:[s.jsx(rs,{}),s.jsx(ote,{variant:n?Fi.RECIPES:Fi.LAYOUT}),x&&s.jsx(os,{type:"PopUpBanner::route",fallback:null,children:s.jsx(TBt,{})}),s.jsxs(dte,{children:[typeof window=="object"&&s.jsx(See,{}),r&&a&&d&&s.jsx(bFt,{}),s.jsx(Cwt,{}),s.jsx(_ee,{}),r&&l&&s.jsx(jee,{isSegmentable:c}),s.jsx(tP,{location:t,type:"main",children:s.jsx(XBt,{outlet:e,isSearchEngineCrawlsBlockedFF:f,isLoggedIn:g,unblockedCrawlerPathNames:y,fetchError:!!R})}),s.jsx(wee,{})]}),s.jsx(nwt,{}),s.jsx(RBt,{}),o&&s.jsx(_wt,{}),i&&s.jsx(bee,{}),s.jsx(pFt,{}),s.jsx(xwt,{}),_&&s.jsx(iFt,{}),A&&s.jsx(WFt,{}),A&&s.jsx(JFt,{}),s.jsx(Lee,{}),s.jsx(rte,{}),s.jsx($Bt,{}),s.jsx(ZBt,{}),(u||m)&&g&&s.jsx(Nee,{}),s.jsx(Xq,{})]})},pUt=async({store:e,cookies:t})=>{if(t.get($s.SSO_LOGIN_COMPLETE)){t.delete($s.SSO_LOGIN_COMPLETE,{secure:!0,httpOnly:!0});const n=!!t.get($s.SSO_REGISTRATION_COMPLETE);e.dispatch(xae(n)),n&&t.delete($s.SSO_REGISTRATION_COMPLETE,{secure:!0,httpOnly:!0});const{visitorId:o}=e.getState().session.metadata;return await e.dispatch(HN.mergeCartWithVisitorCart(o)),Promise.all([e.dispatch(Ht.getBasket()),e.dispatch(nc())])}return e.dispatch(Ht.getBasket())},mUt=async({store:e,cartToken:t})=>t?(await e.dispatch(HN.mergeBasketViaCartToken({cartToken:t})),Promise.all([e.dispatch(Ht.getBasket()),e.dispatch(nc())])):Promise.resolve();ute.fetchData=async({context:e})=>{const{store:t}=e,n=t.getState(),{cartToken:o}=us.parse(n?.router?.location?.search),r=tUt(n),a=[t.dispatch(W3(Wt(n),r))];if(a.push(uUt(n)?e.urqlClient.query(Fee,{}):t.dispatch(H3())),Ze(n)){a.push(pUt(e));const i=rr(n);a.push(t.dispatch(h0(i))),eUt(n)&&a.push(t.dispatch(Fu.getCustomerLoyalty())),o4(n)&&a.push(t.dispatch(SP.fetchFailedOrderPayments())),cUt(n)&&a.push(t.dispatch(Um.getCouponsCount())),a.push(xP.fetchInstantShopAvailability()(t.dispatch,t.getState)),dUt(n)&&a.push(t.dispatch(kee())),a.push(t.dispatch(bs.getCurrentCustomer()))}else a.push(t.dispatch(Ht.getBasket()));return a.push(mUt({store:t,cartToken:o})),lte(n)&&(Ib(n)&&a.push(t.dispatch(op.getContentBlocks(r))),cte(n)&&ite(n)&&!Ib(n)&&a.push(t.dispatch(op.getContentBlocks(r)))),lUt(n)&&a.push(t.dispatch(Bm.getComposableNavbar())),Promise.all(a)};const hUt=D("ald.m"),gUt=D("tp"),EUt=D("tp.new"),fUt=D("cmpnb"),yUt=D("sl.c"),pte=D("cf.cb.ip"),IUt=D("cf.cb.ip.seg"),SUt=D("seo.rdbl"),CUt=D("cp"),mte=()=>{const e=M$(),t=E(Ze),n=E(gUt),o=E(EUt),r=E(hUt),a=E(pte),i=E(IUt),l=Ne();xK(),h.useEffect(()=>{if(!e){const d=new Error(`empty content alert triggered when trying to access ${l.pathname}.`);Me.api.pushError(d)}},[l]);const c=l.pathname==="/checkout/summary"?Fi.CHECKOUT_SUMMARY:Fi.CHECKOUT_WALK;return s.jsxs(Iee,{children:[typeof window=="object"&&s.jsx(See,{}),s.jsx(rs,{}),s.jsx(ote,{variant:c}),s.jsxs(dte,{children:[s.jsx(_ee,{}),a&&s.jsx(jee,{isSegmentable:i}),s.jsx(tP,{location:l,type:"checkout-main",children:s.jsx(TUt,{outlet:e})}),s.jsx(wee,{}),s.jsx(Lee,{})]}),s.jsx(rte,{}),r&&s.jsx(bee,{}),n&&t&&s.jsx(Nee,{}),o&&!n&&t&&s.jsx(wjt,{}),s.jsx(Xq,{})]})};mte.fetchData=({context:{store:e,url:t}})=>{const n=e.getState(),o=SUt(n),r=[e.dispatch(Ent(t)),e.dispatch(vf.getPendingOrders()),xP.fetchInstantShopAvailability()(e.dispatch),e.dispatch(nc()),e.dispatch(bs.getCurrentCustomer())],a=rr(n);return a&&(r.push(e.dispatch(h0(a))),yUt(n)&&r.push(e.dispatch(kee()))),fUt(n)&&r.push(e.dispatch(Bm.getComposableNavbar())),pte(n)&&r.push(e.dispatch(op.getContentBlocks(o))),CUt(n)&&r.push(e.dispatch(Um.getCouponsCount())),Promise.all(r)};const TUt=({outlet:e})=>s.jsx(ate,{id:"main",className:"salt-m-b--8",children:e}),_Ut=e=>[{path:"/cookie-policy",Component:e.Main,children:[{index:!0,lazy:async()=>{const{CookiePolicy:t}=await Rn(async()=>{const{CookiePolicy:n}=await import("./cookie-policy-CDyQUtyi.js");return{CookiePolicy:n}},__vite__mapDeps([5,1,2,3]));return{Component:Xt(n=>aC(n)&&!!n.retailerSettings["cookies-onetrust-domain"],t,lt)}}}]}],hG=D("cp"),vUt=e=>[{path:"/coupons",Component:e.Main,children:[{index:!0,lazy:async()=>{const{CouponsPage:t}=await Rn(async()=>{const{CouponsPage:n}=await import("./coupons-page-CzHhDXRe.js");return{CouponsPage:n}},__vite__mapDeps([6,1,2,3]));return{Component:ws(Ze,Xt(hG,t,lt))}}},{path:"/coupons/:couponDescription/:couponId",lazy:async()=>{const{CouponDetails:t}=await Rn(async()=>{const{CouponDetails:n}=await import("./coupon-details-CKpzxpog.js");return{CouponDetails:n}},__vite__mapDeps([7,1,2,3]));return{Component:ws(Ze,Xt(hG,t,lt))}}}]}],Sb=e=>s.jsxs("option",{"data-test":"address-dropdown-element",value:e.deliveryDestinationId,disabled:!el(e),children:[e.name," - ",e.formattedAddress]},e.deliveryDestinationId),AUt=(e,t)=>e.find(n=>n.deliveryDestinationId===t?.deliveryDestinationId),bUt=(e,t)=>e.find(n=>n.deliveryDestinationId===t?.deliveryDestinationId),xUt=e=>e.filter(t=>el(t)),hte=e=>e.data?.coordinates,gte=(e,t)=>t?e.sort((n,o)=>LA(n.coordinates,t)-LA(o.coordinates,t)):e,RUt=ee("GET_SLOT_BOOKING_PAGE_ADVERTS"),DUt=()=>({type:"API",payload:{url:"/v1/content?page=SLOT_BOOKING",...RUt}}),Ete=({data:e})=>e.delivery.charges.smallOrderChargeThresholds,OUt=D("sl.cut"),fte=({latestUpdateTime:e,className:t})=>{const n=E(Jt),o=E(bg),r=E(Vt);if(!E(OUt))return null;const i=s.jsx(El,{dateIso:e,timeZoneId:o,timeFormat:r,dateFormat:n,local:!0});return s.jsx(Ce,{intent:"info",showIcon:!1,className:t,text:e?s.jsx(v,{id:"order.details.heading.future.edit.until",values:{editUntilDate:i}}):s.jsx(v,{id:"slotbooking.booked.slot.no.cutoff"})})},PUt=({slotbookingLocation:e,orderId:t,slotBookedQuery:n})=>{switch(e){case Tn.CHECKOUT_WALK:return kr({queryString:n});case Tn.EDIT_ORDER:return gn(t,n);case Tn.BASKET_SPLIT_TRIGGERED:return jt();default:return pn({queryString:n})}},yte=(e,t)=>async(n,o)=>{const{slotbookingLocation:r,slotBookedQuery:a,orderId:i}=e,l=o(),c=Qst(l),d=D("mins")(l),u=XD(l),m=ox(l),g=c?CD:"",f=new URLSearchParams(a||g);if(d&&u&&f.append("min-spend-changed","true"),r===Tn.EDIT_ORDER){if(m){f.append("error","below-minimum-spend");const{shippingGroupType:y}=l.data.basket.checkout;y&&f.append("errorShippingGroupType",y)}return t(gn(i,f.toString()),{state:{fromSlotBooking:!0}})}if(r===Tn.CHECKOUT_WALK){const{canCheckout:y,redirect:I}=await n(Wg());if(!y)return t(I)}return t(PUt({...e,slotBookedQuery:f.toString()}),{state:{fromSlotBooking:!0}})},NUt=(e,t,n)=>async(o,r)=>{const a=r(),i=At(a),l=zD(a),c=Dp(a),d=uo(a),u=hn(a);try{await o(uO.confirmSlot({draftBasketId:l,shippingGroupType:c,deliveryDestinationId:d,regionId:u})),await o(Ht.getBasket()),await o(yte({slotbookingLocation:t,orderId:i,slotBookedQuery:n},e))}catch(m){throw z.error("request.error.title"),m}},rp={handleCheckoutRedirect:yte,confirmSlot:NUt},AI="slotbooking-confirm-modal-header";class LUt extends h.Component{formattedMessages;constructor(t){super(t);const{intl:n,basketThresholdForSelectedSlot:o,currencyFormat:r}=t;this.confirm=this.confirm.bind(this);const a=mC(n);this.formattedMessages={title:n.formatMessage("logged.in.home.page.book.slot.card.title.slot.booked"),onDemandSlotInfo:n.formatMessage("slotbooking.modal.confirm.express.collection.slot.description"),deliveryTimeInMinutes:a(this.props.slotDeliveryTimeInMinutes),collectionTimeInMinutes:a(this.props.slotCollectionTimeInMinutes),changeSlot:n.formatMessage("slotbooking.modal.confirm.change.slot.link"),confirmButton:n.formatMessage("slotbooking.modal.confirm.button"),confirmButtonCompleteText:n.formatMessage("slotbooking.modal.confirm.button.complete.text"),checkoutButton:n.formatMessage("slotbooking.modal.checkout.button"),minimum:n.formatMessage("slotbooking.modal.confirm.reserved.minimum.order",{amount:o?$a(n.formatNumber,o,r):""})}}componentDidMount(){const{actions:t}=this.props;t.performanceMark({name:m2}),t.sendAnalyticsEvent({type:Fe.SLOT_BOOKING_MODAL_DISPLAYED,hasOutOfStock:!1})}confirm(){const{slotbookingLocation:t,actions:n,orderId:o}=this.props;t===Tn.CHECKOUT_WALK&&n.sendAnalyticsEvent({type:Kn.CHECKOUT_WALK}),n.closeModal(),n.handleCheckoutRedirect({slotbookingLocation:t,orderId:o},this.props.navigate)}isOnDemandSlot(){const{slotType:t,startTime:n,endTime:o,deliveryMethod:r}=this.props;return t==="ON_DEMAND"?!0:hp({slotType:t,deliveryMethod:r,start:n,end:o})}getIconName(){return this.isOnDemandSlot()?"express_collect":this.props.deliveryType===Et.clickAndCollect.type?"click_collect":"home_delivery"}getStandardSlotTimeInfo(){const{dateFormat:t,startTime:n,endTime:o,timeZoneId:r,timeFormat:a}=this.props;return s.jsx(P,{bold:!0,size:"l",className:"salt-m-b--1",children:s.jsx(go,{dateIsoFrom:n,dateIsoTo:o,timeZoneId:r,dateFormat:t,timeFormat:a})})}getExpressCollectionSlotTimeInfo(){return s.jsx(P,{bold:!0,size:"l",className:"salt-m-b--1",children:s.jsx(v,{id:"slotbooking.modal.confirm.express.collection.slot.description",values:{readyTimeSpan:this.formattedMessages.deliveryTimeInMinutes,maxTimeSpan:this.formattedMessages.collectionTimeInMinutes}})})}getSlotTimeInfo(){return this.props.slotType==="ON_DEMAND"?this.getExpressCollectionSlotTimeInfo():this.getStandardSlotTimeInfo()}render(){const{onCloseModal:t,timeZoneId:n,slotbookingLocation:o,selectedAddress:r,timeFormat:a,expiryDate:i,latestUpdateTime:l}=this.props,{formattedMessages:c}=this,d=o===Tn.CHECKOUT_WALK,u=s.jsx(tE,{dateIso:i,timeZoneId:n,timeFormat:a,local:!0});return s.jsxs(h.Fragment,{children:[s.jsx(G.Header,{align:"left","aria-live":"polite",children:s.jsx(ne,{as:"h1",id:AI,children:c.title})},"header"),s.jsxs(G.Body,{children:[s.jsxs(P,{className:"salt-m-b--4",size:"l","data-pii":"true",children:[s.jsxs(se,{gap:["sm"],wrap:"nowrap",children:[s.jsx(me,{name:this.getIconName()}),this.getSlotTimeInfo()]}),r&&s.jsxs(h.Fragment,{children:[r.nickname," - ",r.address,r.additionalInformation&&s.jsx(P,{"data-pii":"true",children:r.additionalInformation})]})]}),s.jsx(Ce,{intent:"warning",showIcon:!1,className:"salt-m-t--2",text:s.jsxs(h.Fragment,{children:[s.jsx(v,{id:"logged.in.home.page.book.slot.card.slot.booked.alert.text",values:{expiryTime:u}})," ",`(${c.minimum})`]})}),s.jsx(fte,{className:"salt-m-t--2",latestUpdateTime:l})]},"body"),s.jsxs(G.Footer,{align:"left",children:[s.jsx(b,{className:"salt-m-r--1",onClick:t,intent:"secondary",fill:!0,children:s.jsx(b.Text,{children:c.changeSlot})}),s.jsx(b,{className:"salt-m-l--1",onClick:this.confirm,intent:"primary",fill:!0,"data-synthetics":"confirm-slot","aria-label":d?c.checkoutButton:c.confirmButtonCompleteText,children:s.jsx(b.Text,{children:d?c.checkoutButton:c.confirmButton})})]},"footer")]})}}const kUt=e=>({dateFormat:Jt(e),deliveryType:X$e(e),deliveryMethod:e0e(e),basketThresholdForSelectedSlot:dC(e),expiryDate:iK(e),selectedAddress:QD(e),slotType:WD(e),slotDeliveryTimeInMinutes:rK(e),slotCollectionTimeInMinutes:aK(e),startTime:YD(e),endTime:qD(e),timeZoneId:bg(e),timeFormat:Vt(e),orderId:At(e),latestUpdateTime:KD(e),currencyFormat:pi(e)}),MUt=ot({closeModal:Z.closeModal,getCheckoutWalk:YP,performanceMark:ks,sendAnalyticsEvent:U.analyticsEvent,handleCheckoutRedirect:rp.handleCheckoutRedirect}),jUt=Ct(Bt,ke(kUt,MUt))(LUt),Ek=()=>{const{formatMessage:e}=M();return s.jsx(Ce,{showIcon:!1,intent:"warning",text:e("settings.delivery.pass.region.no-delivery-pass-offer"),"data-test":"non-deliverable-alert"})};function wUt(){const e=F();return{customerAddresses:E(bd),fetchCustomerAddresses:()=>e(wn.getCustomerAddresses())}}function FUt(e){return{withCustomerAddresses:t=>{const n=t.filter(o=>o.deliverability==="DELIVERABLE").map(o=>o.addressId);return e.map(o=>({...o,addresses:o.addresses.filter(r=>n.includes(r.addressId))})).filter(o=>o.addresses.length>0)}}}function BUt(e){return{withCustomerAddresses:t=>{const n=t.filter(o=>o.deliverability==="DELIVERABLE").map(o=>o.addressId);return e.filter(o=>o.deliveryAddresses.some(r=>n.includes(r.addressId)))}}}function UUt(){const{isSubscriptionEnabled:e}=po(),t=Pr.client.useHooks().getComputedState(),n=Pr.client.useHooks().fetch,o=Nr.client.useHooks().getComputedState(),r=Nr.client.useHooks().fetch,{customerAddresses:a,fetchCustomerAddresses:i}=wUt();if(h.useEffect(()=>{e&&(t.lastUpdated===null&&!t.isFetching&&n(),o.lastUpdated===null&&!o.isFetching&&r(),a.lastUpdated===null&&!a.isFetching&&i())},[e,o,a,t]),!(!e||!t.lastUpdated||!a.lastUpdated||!o.lastUpdated||t.fetchError||a.fetchError||o.fetchError||a.isFetching||t.isFetching||o.isFetching))return{customerSubscriptionsInTheCurrentStore:BUt(t.data??[]).withCustomerAddresses(a.data),benefitGroupAddressesInTheCurrentStore:FUt(o.data).withCustomerAddresses(a.data)}}function GUt(e,{selectedDeliveryAddressId:t,selectedDeliveryAddress:n}){return e.find(o=>o.addresses?.find(({addressId:r})=>r===(t??n?.addressId)))}const $Ut=()=>{const e=F();return t=>e(Rd.getDeliveryPassBenefits({benefitGroupId:t}))};function HUt({benefitGroupAddressesInTheCurrentStore:e,selectedDeliveryAddressInfo:t}){const n=$Ut(),o=En.client.useHooks().getComputedState(),r=t.selectedDeliveryAddress||t.selectedDeliveryAddressId;return h.useEffect(()=>{if(e&&e.length>0&&!o.data&&!o.isFetching)if(e.length===1)n(e[0].benefitGroupId);else if(r){const a=GUt(e,t);a?.benefitGroupId&&n(a?.benefitGroupId)}else n(e[0].benefitGroupId)},[e,r,o,t,n]),o}const fE=V(xs,Jl,Ei,(e,t,n)=>e===Et.clickAndCollect.method?t?.data:n?.data);function VUt(){const t=((o,r)=>{if(r!==void 0)return Object.values(o).find(a=>a.deliveryDestinationId===r)})(E(fE),E(uo)),n=E(d5);return{selectedDeliveryAddress:t,selectedDeliveryAddressId:n}}function YUt(e){return{filterWithSelectedDeliveryAddress:({selectedDeliveryAddress:t,selectedDeliveryAddressId:n})=>{if(e.length===0)return;const o=e.find(r=>r.deliveryAddresses.find(a=>a.addressId===n||a.addressId===t?.addressId));if(o)return o;if(e.length>0)return e[0]}}}function gG(e){return`${ic()}?benefitGroupId=${e}`}function WUt(e){return!(e.isFetching||e.fetchError||e.error)}function fk(){const{isSubscriptionEnabled:e,isFreeTrialEnabled:t}=po(),n=UUt(),{benefitGroupAddressesInTheCurrentStore:o=[],customerSubscriptionsInTheCurrentStore:r=[]}=n??{},a=VUt(),i=HUt({benefitGroupAddressesInTheCurrentStore:o,selectedDeliveryAddressInfo:a});if(!e||!n||!WUt(i))return;const l=r.length>0,c=YUt(r).filterWithSelectedDeliveryAddress(a);return{customerSubscriptionsInTheCurrentStore:r,isUserSubscribedInTheStore:l,youAreEnjoying:c?{...c,path:gG(c.customerSubscription.benefitGroup.benefitGroupId)}:void 0,tryDeliveryPass:i.data?{path:gG(i.data.benefitGroupId),message:i.data.advertisementMessage,benefitGroup:{...i.data,canFreeTrial:t&&i.metadata.isFreeTrial&&!l}}:void 0}}const qUt=e=>t=>e(U.analyticsEvent({type:Mn.DELIVERY_PASS_SUBSCRIBED_PLAN_MODAL_DISPLAYED,userAction:t})),KUt=e=>({pageEventId:t,benefitGroupId:n})=>{e(U.analyticsEvent({type:Es.BENEFIT_GROUP_SELECTED,description:"User selected benefit group to display available subscriptions",pageEventId:t,pageEventAttributes:{type:"benefitGroupId",value:n}}))},zUt=e=>t=>e(U.analyticsEvent({type:Es.SELECTED_DELIVERY_PASS_PLAN_MODAL_DISPLAYED,userAction:t})),QUt=e=>({isFreeTrialEligible:t,isManageDeliveryPass:n})=>e(U.analyticsEvent({type:Es.DELIVERY_PASS_BUTTON_CLICKED,isFreeTrialEligible:t,isManageDeliveryPass:n})),XUt=e=>t=>{e(U.analyticsEvent({type:Es.ADD_DELIVERY_ADDRESS_SELECTED,description:"User clicked add another address",pageEventId:t}))},ZUt=e=>({plan:t,benefitGroupId:n})=>e(U.analyticsEvent({type:Es.DELIVERY_PASS_SUBSCRIPTION_STARTED,plan:t,deliveryPassBenefitGroupId:n})),JUt=e=>()=>e(U.analyticsEvent({type:Es.DELIVERY_PASS_TERMS_CONDITIONS_CLICKED})),eGt=e=>({plan:t,deliveryPassBenefitGroupId:n,analyticsEvent:o})=>{const r=o??U.analyticsEvent;e(r({type:Es.DELIVERY_PASS_PLAN_SEEN,plan:t,deliveryPassBenefitGroupId:n}))},tGt=e=>t=>{e({type:Es.DELIVERY_PASS_SIGN_UP,payload:t});const n={event:"delivery_pass_sign_up",id:t.retailerSubscriptionPlanId,price:t.price,currency:t.currency};J.sendEvent({GA:n,WA:null})},sGt=e=>t=>{e({type:Es.DELIVERY_PASS_CANCEL_AUTO_RENEW,payload:t});const n={event:"delivery_pass_cancel_auto_renew",id:t.retailerSubscriptionPlanId,price:t.price,currency:t.currency};J.sendEvent({GA:n,WA:null})},nGt=e=>t=>{e({type:Es.DELIVERY_PASS_ENABLE_AUTO_RENEW,payload:t});const n={event:"delivery_pass_enable_auto_renew",id:t.retailerSubscriptionPlanId,price:t.price,currency:t.currency};J.sendEvent({GA:n,WA:null})},oGt=e=>({subscriptionId:t,retailerSubscriptionPlanId:n,buttonLabel:o})=>e(U.analyticsEvent({type:Es.FREE_TRIAL_BUTTON_CLICKED,buttonName:"Free trial",subscriptionId:t,retailerSubscriptionPlanId:n,buttonLabel:o}));function fa(){const e=F();return h.useMemo(()=>({deliveryPassButtonClicked:QUt(e),addAddressClicked:XUt(e),selectBenefitGroupClicked:KUt(e),deliveryPassSubscriptionStarted:ZUt(e),selectedDeliveryPassPlanModalDisplayedEvent:zUt(e),termsAndConditionsClicked:JUt(e),deliveryPassPlanSeen:eGt(e),deliveryPassSignUp:tGt(e),deliveryPassCancelAutoRenew:sGt(e),deliveryPassEnableAutoRenew:nGt(e),freeTrialButtonClicked:oGt(e),deliveryPassSubscribedPlanModalDisplayed:qUt(e)}),[e])}const rGt=({benefit:e,onClick:t,date:n})=>s.jsx(Ce,{className:"salt-m-b--2",intent:"success","data-test":"autorenewal-enabled-alert",text:s.jsx(v,{id:"subscription.delivery.pass.auto.renew.on.message",values:{pass:`${e.name} - ${e.description}`,expiryDate:n}}),link:s.jsx(Ce.Link,{"data-test":"message-renew-on",onClick:t,to:Uo(),children:s.jsx(v,{id:"delivery.pass.settings.link.label"})})}),aGt=({onClick:e,type:t,benefit:n,date:o})=>s.jsx(Ce,{className:"salt-m-b--2",intent:t,"data-test":`autorenewal-disabled-alert-${t}`,text:s.jsx(v,{id:"subscription.delivery.pass.auto.renew.off.message",values:{pass:`${n.name} - ${n.description}`,expiryDate:o}}),link:s.jsx(Ce.Link,{to:Uo(),onClick:e,"data-test":"message-renew-off",children:s.jsx(v,{id:"delivery.pass.settings.link.label"})})}),iGt=({date:e,benefit:t})=>s.jsx(Ce,{className:"salt-m-b--2",intent:"warning","data-test":"autorenewal-enabled-alert",text:s.jsx(v,{id:"settings.delivery.pass.auto.switch.on.message",values:{passName:`${t.name} - ${t.description}`,transitioningDate:e}}),link:s.jsx(Ce.Link,{to:Uo(),children:s.jsx(v,{id:"settings.delivery.pass.auto.switch.on.link.label"})})}),lGt=()=>s.jsx(Ce,{className:"salt-m-b--2",intent:"warning",text:s.jsx(v,{id:"subscription.alert.deliverypass.pending.message"})}),cGt="subscription-messages";function dGt({status:e,autoRenewalStatus:t,nextRenewal:n},o){return e==="PENDING"?"PENDING":e==="ACTIVE"?t?o&&n.planIsTransitioning?"SWITCH_ON":"RENEW_ON":"RENEW_OFF":"NA"}function uGt({deliveryPassAnalyticsEvent:e,subscription:t,benefit:n,dateFormat:o,isSubscriptionPlanTransitionEnabled:r}){const{subscriptionId:a}=t,i=()=>yt(t.expiry,o);switch(dGt(t,r)){case"PENDING":return s.jsx(lGt,{},a);case"SWITCH_ON":return s.jsx(iGt,{benefit:n,date:i()},a);case"RENEW_ON":return s.jsx(rGt,{onClick:()=>e({isManageDeliveryPass:!0}),date:i(),benefit:n},a);case"RENEW_OFF":return s.jsx(aGt,{onClick:()=>e({isManageDeliveryPass:!0}),date:i(),benefit:n,type:r?"error":"warning"},a);case"NA":default:return null}}function pGt({dateFormat:e,isSubscriptionPlanTransitionEnabled:t,deliveryPassAnalyticsEvent:n,subscriptions:o}){const r=o.map(({subscription:a,benefit:i})=>uGt({deliveryPassAnalyticsEvent:n,subscription:a,benefit:i,dateFormat:e,isSubscriptionPlanTransitionEnabled:t})).filter(a=>a!==null);return r.length?s.jsx("div",{"data-test":cGt,children:r}):null}function mGt({subscriptions:e}){const t=E(da),n=En.client.useHooks().getComputedState().metadata.isFreeTrial,{isSubscriptionPlanTransitionEnabled:o}=po(),{deliveryPassButtonClicked:r}=fa(),a=({isManageDeliveryPass:i})=>{r({isFreeTrialEligible:n,isManageDeliveryPass:i})};return s.jsx(pGt,{deliveryPassAnalyticsEvent:a,dateFormat:t,isSubscriptionPlanTransitionEnabled:o,subscriptions:e})}function Ite(){const e=F(),t=En.client.useHooks().getComputedState().metadata.isFreeTrial;return()=>{e(U.analyticsEvent({type:Es.DELIVERY_PASS_BUTTON_CLICKED,isFreeTrialEligible:t,isManageDeliveryPass:!1}))}}const hGt=({message:e,to:t,onClick:n})=>s.jsx(Ce,{className:"salt-m-b--2",intent:"action",text:e,link:s.jsx(Ce.Link,{"data-test":"subscription-link",to:t,onClick:n,children:s.jsx(v,{id:"subscription.alert.deliverypass.available.link"})})});function gGt(){const e=fk(),t=Ite();if(e){if(e.isUserSubscribedInTheStore)return s.jsx(mGt,{subscriptions:e.customerSubscriptionsInTheCurrentStore.map(n=>n.customerSubscription)});if(e.tryDeliveryPass)return s.jsx(hGt,{onClick:t,message:e.tryDeliveryPass.message,to:e.tryDeliveryPass.path})}return null}function EGt({title:e,description:t,to:n}){const o=Ite();return s.jsx("div",{children:s.jsx(xn,{"data-testid":"delivery_pass_card",onClick:o,className:"salt-m-t--4",icon:"delivery_pass",title:{as:"h3",text:e},description:s.jsx(P,{children:t}),to:n})})}function fGt({isUserSubscribedInTheStore:e,tryDeliveryPassBenefitGroup:t}){return e?"HAS_SUBSCRIPTION_IN_THE_CURRENT_STORE":t?t.canFreeTrial?"ELIGIBLE_FOR_FREE_TRIAL":"NOT_ELIGIBLE_FOR_FREE_TRIAL":"ERROR_NO_DELIVERY_PASS_IN_THE_CURRENT_STORE"}function yGt({subscriptionMessageType:e,youAreEnjoyingBenefit:t,to:n}){const o=r=>s.jsx(EGt,{...r});switch(e){case"HAS_SUBSCRIPTION_IN_THE_CURRENT_STORE":return o({title:s.jsx(v,{id:"delivery.pass.card.title.active",values:{name:t?.name??""}}),description:t?.description??"",to:n});case"ELIGIBLE_FOR_FREE_TRIAL":return o({title:s.jsx(v,{id:"delivery-pass.not-active.card-title"}),description:s.jsx(v,{id:"delivery.pass.card.subtitle.not.active.trial.eligible"}),to:n});case"NOT_ELIGIBLE_FOR_FREE_TRIAL":return o({title:s.jsx(v,{id:"delivery-pass.not-active.card-title"}),description:s.jsx(v,{id:"delivery.pass.card.subtitle.not.active"}),to:n});case"ERROR_NO_DELIVERY_PASS_IN_THE_CURRENT_STORE":default:return null}}const yk=()=>{const e=fk();if(!e)return null;const t=fGt({isUserSubscribedInTheStore:e.isUserSubscribedInTheStore,tryDeliveryPassBenefitGroup:e.tryDeliveryPass?.benefitGroup});return yGt({subscriptionMessageType:t,youAreEnjoyingBenefit:e.youAreEnjoying?.customerSubscription?.benefit,to:t==="HAS_SUBSCRIPTION_IN_THE_CURRENT_STORE"?e.youAreEnjoying?.path:e.tryDeliveryPass?.path})};yk.usePreloadData=fk;const IGt=()=>{const e=E(XD),t=E(dC),n=E(D("misbc")),o=E(D("mins")),r=lL();return e&&n&&o&&t?r(t):null},SGt=()=>{const e=IGt();return e?s.jsx(v,{id:"minimum.order.amount.on.slot.booking",values:{amount:e}}):null},CGt=()=>{const e=E(YD),t=E(qD),n=E(bg),o=E(Vt),r=E(Jt);return s.jsx(go,{dateIsoFrom:e,dateIsoTo:t,timeZoneId:n,dateFormat:r,timeFormat:o})},TGt=()=>{const e=E(QD);return s.jsx(v,{id:"logged.in.home.page.book.slot.card.subtitle.slot.and.address.format",values:{interval:s.jsx(CGt,{}),address:e?.nickname}})},_Gt=()=>{const e=E(WD),t=E(QD);return e==="ON_DEMAND"?t?.nickname:s.jsx(TGt,{})},vGt=()=>{const e=E(iK),t=E(bg),n=E(Vt);return s.jsx(v,{id:"logged.in.home.page.book.slot.card.slot.booked.alert.text",values:{expiryTime:s.jsx(tE,{dateIso:e,timeZoneId:t,timeFormat:n,local:!0})}})},AGt=()=>{const e=ze(),t=E(Z$e),o=E(J$e)?s.jsx(me,{name:"eco_slot",success:!0}):null;return t?s.jsxs(se,{gap:["sm"],wrap:"nowrap",justify:"space-between",align:"center",children:[s.jsxs(P,{size:"l",children:[" ",e(t)," "]}),o]}):null},bGt=D("sl.cut"),xGt=()=>{const e=E(KD),t=E(Jt),n=E(bg),o=E(Vt);if(!E(bGt))return null;const a=s.jsx(El,{dateIso:e,timeZoneId:n,timeFormat:o,dateFormat:t,local:!0});return e?s.jsx(v,{id:"order.details.heading.future.edit.until",values:{editUntilDate:a}}):s.jsx(v,{id:"slotbooking.booked.slot.no.cutoff"})},RGt=()=>{const e=Md(),t=E(WD),n=E(rK),o=E(aK);return t==="ON_DEMAND"?s.jsx("div",{className:"salt-p-t--4",children:s.jsx(P,{children:s.jsx(v,{id:"slotbooking.modal.confirm.express.collection.slot.description",values:{readyTimeSpan:e(n),maxTimeSpan:e(o)}})})}):null},DGt=({onClose:e,className:t=""})=>s.jsx(b,{className:t,onClick:e,intent:"secondary",fill:!0,children:s.jsx(b.Text,{children:s.jsx(v,{id:"slotbooking.modal.confirm.change.slot.link"})})}),OGt=({navigate:e,className:t=""})=>{const n=F(),o=E(tT),r=E(Y8),a=E(At),i=o===Tn.CHECKOUT_WALK,l=i&&!r,c=l?"slotbooking.modal.checkout.button":"slotbooking.modal.confirm.button",d=l?"action":"primary",u=()=>{i&&n(U.analyticsEvent({type:Kn.CHECKOUT_WALK})),n(Z.closeModal()),n(rp.handleCheckoutRedirect({slotbookingLocation:o,orderId:a},e))};return s.jsx(b,{className:t,onClick:u,intent:d,"data-synthetics":"confirm-slot",fill:!0,children:s.jsx(b.Text,{children:s.jsx(v,{id:c})})})},PGt=()=>{const e=F();h.useEffect(()=>{e(ks({name:m2}))},[])},NGt=({className:e=""})=>s.jsxs(se,{align:"center",className:e,children:[s.jsx(me,{name:"status_yes",success:!0,width:24,height:24}),s.jsx(ne,{as:"h2",id:AI,className:"salt-m-l--2",children:s.jsx(v,{id:"slot.booking.confirmation-modal.title"})})]}),LGt=()=>{const e=E(Ete),n=E(xs)==="HOME_DELIVERY";return s.jsxs(h.Fragment,{children:[s.jsxs(se,{gap:["sm"],wrap:"nowrap",justify:"space-between",align:"flex-start",children:[s.jsx(P,{className:"salt-overflow-wrap--anywhere salt-p-b--0.5",bold:!0,size:"l",children:s.jsx(_Gt,{})}),s.jsx(AGt,{})]}),s.jsx("div",{children:s.jsx(P,{children:s.jsx(vGt,{})})}),s.jsx("div",{children:s.jsx(P,{children:s.jsx(xGt,{})})}),s.jsx("div",{children:s.jsx(P,{children:s.jsx(SGt,{})})}),s.jsx(RGt,{}),n&&s.jsx(yk,{}),s.jsx(pd,{thresholds:e,isWithIcon:!1,isWithLink:!0,className:"salt-m-t--4",page:"slot-booking"})]})},kGt=({onClose:e,navigate:t})=>(PGt(),s.jsxs(h.Fragment,{children:[s.jsx(G.Header,{align:"left","aria-live":"polite",children:s.jsx(NGt,{})},"header"),s.jsx(G.Body,{children:s.jsx(LGt,{})},"body"),s.jsxs(G.Footer,{align:"left",children:[s.jsx(DGt,{onClose:e,className:"salt-m-r--1"}),s.jsx(OGt,{navigate:t,className:"salt-m-l--1"})]},"footer")]})),Cb="slotbooking-error-modal-header",EG=({closeModal:e,slotSelectionHandler:t,errorMessage:n="request.error.message"})=>{const o=F(),r=E(D("m.la.h")),{formatMessage:a}=M();return h.useEffect(()=>{o(ks({name:NTe}))},[]),s.jsxs(h.Fragment,{children:[s.jsx(G.Header,{align:r?"left":"center",children:s.jsx(ne,{as:"h2",id:Cb,children:a("request.error.title")})}),s.jsx(G.Body,{children:s.jsx(Ce,{intent:"warning",showIcon:!1,text:a(n),className:"salt-m-b--4"})}),s.jsxs(G.Footer,{align:r?"left":"center",children:[s.jsx(b,{onClick:e,intent:"secondary",fill:!0,children:a("request.error.cancel.button")}),s.jsx(b,{onClick:t,intent:"action",fill:!0,children:a("request.error.action.button")})]})]})},Ste=ee("CANCEL_SLOT"),MGt=e=>({type:"API",payload:{pathPrefix:{client:"/api/ecomslots",server:"/core-api"},service:"ecomslots",url:"/v1/slots/cancel",options:{body:e,method:"PUT"},...Ste}}),jGt={cancelSlot:MGt,types:{CANCEL_SLOT:Ste}},wGt=()=>async(e,t)=>{const n=t(),o=zD(n),r=Dp(n),a=uo(n),i=hn(n);await e(jGt.cancelSlot({draftBasketId:o,shippingGroupType:r,deliveryDestinationId:a,regionId:i})),await e(yo.cancelSelectedSlot())},Cte={cancelSlot:wGt},FGt=D("m.la.h"),BGt={actions:p.shape({confirmSlot:p.func.isRequired,cancelSlot:p.func.isRequired,performanceMark:p.func.isRequired,sendAnalyticsEvent:p.func.isRequired,closeModal:p.func.isRequired}).isRequired,onCloseModal:p.func.isRequired,intl:p.any.isRequired,invalidVouchers:p.arrayOf(p.shape({voucherId:p.string,validationErrorCode:p.string})),limitedProducts:p.arrayOf(ml),startTime:p.string.isRequired,endTime:p.string.isRequired,hasRegionChanged:p.bool.isRequired,hasPriceChanged:p.bool.isRequired,itemPriceAfterPromos:Ye,slotbookingLocation:Kst.isRequired,dateFormat:p.string.isRequired,timeFormat:p.string.isRequired,modalLeftAlignEnabled:p.bool,isDefaultShippingGroup:p.bool.isRequired,latestUpdateTime:p.string,navigate:p.func.isRequired,currencyFormat:p.string.isRequired},UGt={itemPriceAfterPromos:void 0,invalidVouchers:[],limitedProducts:[],modalLeftAlignEnabled:!1,latestUpdateTime:null},Tte="slotbooking-out-of-stock-modal-header";class Ik extends h.Component{constructor(t){super();const{intl:n,startTime:o,endTime:r,dateFormat:a,timeFormat:i}=t;this.state={isSubmitting:!1},this.formattedMessages={title:n.formatMessage("slotbooking.modal.oos.title",{expiryTime:`${yt(o,a)} ${Wh(o,r,i)}`}),continueButton:n.formatMessage("slotbooking.modal.oos.continue.button"),checkoutButton:n.formatMessage("slotbooking.modal.oos.checkout.button"),changeSlotButton:n.formatMessage("slotbooking.modal.oos.slot.button"),vouchersGroup:n.formatMessage("slotbooking.modal.oos.vouchers.title"),productsGroup:n.formatMessage("slotbooking.modal.oos.products.title"),action:n.formatMessage("slotbooking.unavailableItems.info.action"),priceChange:n.formatMessage("slotbooking.modal.oos.price.changed"),unavailable:n.formatMessage("slotbooking.modal.oos.items.unavailable"),addVoucherGeneralError:n.formatMessage("voucher.modal.voucher.add.error")},this.confirm=this.confirm.bind(this),this.cancel=this.cancel.bind(this),this.getVoucherErrorMessage=this.getVoucherErrorMessage.bind(this)}componentDidMount(){const{actions:t}=this.props;t.performanceMark({name:PTe}),t.sendAnalyticsEvent({type:Fe.SLOT_BOOKING_MODAL_DISPLAYED,hasOutOfStock:!0})}confirm(){const{actions:t,slotbookingLocation:n,isDefaultShippingGroup:o}=this.props,r=n===Tn.CHECKOUT_WALK,a=n===Tn.EDIT_ORDER,i=!r&&!a&&o;n===Tn.CHECKOUT_WALK&&t.sendAnalyticsEvent({type:Kn.CHECKOUT_WALK}),this.setState({isSubmitting:!0},()=>t.confirmSlot(this.props.navigate,n,i?CD:"").then(()=>t.closeModal()).catch(()=>this.setState({isSubmitting:!1})))}cancel(){const{actions:t,onCloseModal:n}=this.props;t.cancelSlot().then(()=>n())}getVoucherErrorMessage(t){const{intl:n}=this.props,o=iy(t);return n.formatMessage(o)||this.formattedMessages.addVoucherGeneralError}render(){const{intl:t,limitedProducts:n,invalidVouchers:o,hasRegionChanged:r,hasPriceChanged:a,itemPriceAfterPromos:i,modalLeftAlignEnabled:l,slotbookingLocation:c,latestUpdateTime:d,currencyFormat:u}=this.props,{isSubmitting:m}=this.state;return s.jsxs(h.Fragment,{children:[s.jsx(G.Header,{align:l?"left":"center","aria-live":"polite",children:s.jsx(ne,{as:"h2",id:Tte,children:this.formattedMessages.title})},"header"),s.jsxs(G.Body,{children:[s.jsxs("div",{className:"salt-m-b--8",children:[s.jsx(fte,{className:"salt-m-t--2 salt-m-b--2",latestUpdateTime:d}),n.length>0&&s.jsx(Ce,{className:"salt-m-b--2",text:this.formattedMessages.unavailable,showIcon:!1}),r&&a&&s.jsx(Ce,{className:"salt-m-b--2",text:this.formattedMessages.priceChange,showIcon:!1}),o.length>0&&s.jsx(Ve,{className:"salt-m-b--2",children:o.map(g=>s.jsx(Ce,{className:"salt-m-b--2",text:s.jsxs(P,{children:[s.jsx(P,{bold:!0,children:`${g.voucherId} `}),this.getVoucherErrorMessage(g.validationErrorCode)]}),showIcon:!1},g.voucherId))}),r&&a&&i&&s.jsx(Ce,{intent:"warning",className:"salt-m-b--2",showIcon:!1,text:t.formatMessage("slotbooking.modal.oos.final.price",{amount:$a(t.formatNumber,i,u)})})]}),n.length>0?s.jsx(Ve,{children:n.map(g=>s.jsx(Ve.Item,{children:s.jsx(ve,{condensed:!0,children:s.jsx(sE,{product:g,messages:aZ(g,t)})})},g.productId))}):null]},"body"),s.jsxs(G.Footer,{align:l?"left":"center",children:[s.jsx(b,{intent:"secondary",className:"salt-m-r--2",onClick:this.cancel,fill:!0,children:s.jsx(b.Text,{children:this.formattedMessages.changeSlotButton})}),s.jsx(b,{fill:!0,intent:"primary",loading:m,onClick:this.confirm,"data-synthetics":"confirm-slot",children:s.jsx(b.Text,{children:c===Tn.CHECKOUT_WALK?this.formattedMessages.checkoutButton:this.formattedMessages.continueButton})})]},"footer")]})}}Ik.propTypes=BGt;Ik.defaultProps=UGt;const GGt=e=>({invalidVouchers:n0e(e),limitedProducts:i0e(e),hasPriceChanged:r0e(e),itemPriceAfterPromos:a0e(e),hasRegionChanged:o0e(e),startTime:YD(e),endTime:qD(e),dateFormat:Jt(e),timeFormat:Vt(e),modalLeftAlignEnabled:FGt(e),isDefaultShippingGroup:Op(e),latestUpdateTime:KD(e),currencyFormat:pi(e)}),$Gt=ot({confirmSlot:rp.confirmSlot,closeModal:Z.closeModal,confirmChanges:rp.confirmSlot,cancelSlot:Cte.cancelSlot,performanceMark:ks,sendAnalyticsEvent:U.analyticsEvent}),HGt=Bt(ke(GGt,$Gt,null,{forwardRef:!0})(Ik),{forwardRef:!0}),VGt=CI,YGt=e=>{const{closeModal:t}=e,n=E(uo),o=F(),r=We(),a=()=>o(Cte.cancelSlot()),i=()=>o(rp.confirmSlot(r,Tn.BASKET_SPLIT_TRIGGERED));return s.jsx(qJ,{addressId:n||"",closeModal:t,confirmAction:i,cancelAction:a})},Tb="slotbooking-items-unavailable-header",WGt=e=>{const{closeModal:t}=e;return s.jsxs(h.Fragment,{children:[s.jsxs("div",{"aria-live":"polite",id:Tb,children:[s.jsx(G.Header,{align:"left","aria-live":"polite",children:s.jsx(ne,{as:"h1",id:Tb,children:s.jsx(v,{id:"slotbooking.items.unavailable.title"})})},"header"),s.jsx(G.Body,{children:s.jsx(P,{className:"salt-m-b--2",children:s.jsx(v,{id:"slotbooking.items.unavailable.content"})})},"body")]}),s.jsxs(G.Footer,{align:"left",children:[s.jsx(b,{asChild:!0,className:"salt-m-r--1",intent:"secondary",fill:!0,role:"link",children:s.jsx(Qe,{intent:"ghost",href:jt(),children:s.jsx(b.Text,{children:s.jsx(v,{id:"slotbooking.items.unavailable.confirm"})})})}),s.jsx(b,{onClick:t,intent:"primary",fill:!0,className:"salt-m-l--1",children:s.jsx(b.Text,{children:s.jsx(v,{id:"slotbooking.items.unavailable.cancel"})})})]},"footer")]})},qGt="72",_te="21",KGt=D("bt.spl"),zGt=D("sl.rd"),QGt=({hasFetchError:e,closeModal:t,selectedSlot:n,slotSelectionHandler:o})=>{const r=We(),a=E(pC),i=E(lK),l=E(KGt),c=E(zGt),d=E(l0e),u=E(tT),m=ps({breakpoint:"sm-up"});return e?i?.code===qGt?[()=>s.jsx(WGt,{closeModal:t}),Tb]:i?.code===_te?[()=>s.jsx(EG,{closeModal:t,slotSelectionHandler:()=>window.location.reload(),errorMessage:"slotbooking.slot.select.expired"}),Cb]:[()=>s.jsx(EG,{closeModal:t,slotSelectionHandler:()=>o(n)}),Cb]:l&&d?[()=>s.jsx(YGt,{closeModal:t}),VGt]:a?[()=>s.jsx(HGt,{onCloseModal:t,slotbookingLocation:u,navigate:r}),Tte,!1]:c?[()=>s.jsx(kGt,{onClose:t,navigate:r}),AI,m]:[()=>s.jsx(jUt,{onCloseModal:t,navigate:r,slotbookingLocation:u}),AI]},Sk="selectSlot",Zc=({selectedSlot:e,slotSelectionHandler:t,fetchSlots:n})=>{const o=F(),r=E(Ue(Sk)),a=E(oK),i=E(ZD),l=!a,c=()=>{o(Z.closeModal()),o(yo.clearSelectedSlot()),n({isFetchTriggeredBySelectSlotModal:!0})},[d,u,m]=QGt({hasFetchError:i,closeModal:c,selectedSlot:e,slotSelectionHandler:t});return s.jsx(G,{showCloseIcon:!0,onRequestClose:c,isOpen:r,aria:{labelledby:u},isLoading:l&&!i,asBottomSheet:m,children:s.jsx(d,{})})},eu=({action:e,buttonText:t="request.error.action.button",title:n="request.error.title",titleAs:o="h3",titleIcon:r="info_default",description:a="request.error.message"})=>s.jsx(Y,{flush:!0,className:"salt-m-y--4",children:s.jsx(Y.Item,{colStart:{sm:2,md:4,lg:5},colSpan:{xs:12,sm:8,md:6,lg:4},children:s.jsx(ln,{title:n,description:a,titleAs:o,titleIcon:r,primaryButton:{text:t,onClick:e}})})}),Ck=e=>e.data.delivery.slotbooking?.data?.deliveryPriceModificationLevels,XGt=e=>{const t=Ck(e);return!!(t&&(t.halfPrice||t.free))},fG=e=>e&&e.reached||!1,ZGt=e=>{const t=Ck(e);if(t){const{halfPrice:n,free:o}=t;return fG(n)||fG(o)}return!1},JGt=()=>{const e=M(),t=ze(),n=F(),o=E(ZGt),r=E(Ck),a=S8(r,t),i=a&&e.formatMessage(a.id,a.substitutions);return h.useEffect(()=>{a&&n(U.analyticsEvent({type:Fe.ALERT_IMPRESSION,alertImpression:{ALERT_TYPE:"deliveryChargeBySpendAlert",ALERT_MESSAGE_ID:a.id,ALERT_MESSAGE:i}}))},[a]),a?s.jsx(Ce,{intent:o?"success":"action","data-test":"delivery-price-modification-alert",text:i}):null},e$t=({slot:e})=>{const t=M(),o=Md()(e.deliveryTimeInMinutes),r=s.jsx(P,{bold:!0,children:t.formatMessage("slotbooking.express.collection.delivery.booked.alert.info",{readyTimeSpan:o})});return s.jsx(Ce,{showIcon:!1,intent:"success",text:t.formatMessage("slotbooking.express.collection.delivery.booked.alert",{timeInfo:r})})},t$t=({slot:e})=>{const t=M();return s.jsx(Ce,{intent:"success",showIcon:!1,text:t.formatMessage("slotbooking.confirm.alert.for.collection",{dateAndTime:s.jsx(xA,{basketSlot:e}),addressName:e.nickname})})},s$t=e=>{const[t,n]=h.useState(!1);return h.useEffect(()=>{n(e?hp(e):!1)},[e]),t},n$t=({dateFormat:e,intl:t,slot:n,timeFormat:o})=>{const{formatMessage:r}=t,a="success";return s.jsx(Ce,{intent:a,showIcon:!1,"data-test":"delivery-booked-alert","data-test-type":a,text:s.jsxs(h.Fragment,{children:[r("delivery.booked.alert")," ",s.jsx(Fh,{dateIso:n.start,timeZoneId:n.timeZoneId,dateFormat:e})," ",s.jsx(P,{bold:!0,children:s.jsx(pE,{dateIsoFrom:n.start,dateIsoTo:n.end,timeZoneId:n.timeZoneId,timeFormat:o})})]})})},o$t=()=>{const e=M(),t=E(Jt),n=E(H0),o=E(ix),r=E(Vt),a=s$t(n);return o?a?s.jsx(t$t,{slot:n}):n?.slotType==="ON_DEMAND"?s.jsx(e$t,{slot:n}):s.jsx(n$t,{intl:e,slot:n,timeFormat:r,dateFormat:t}):null},bI=({isAddressSelectionPage:e=!1,expand:t,slotBooked:n,"data-gtm-target":o})=>{const r=E(D("dcbbs")),a=E(XGt),i=r&&!e&&a;return s.jsxs("div",{...!r&&{"data-gtm-target":o,"data-test":"slot-booking-page-delivery-booked-alerts-wrapper"},...!t&&{className:"salt-p-x--2"},children:[n&&s.jsx("div",{className:r?"salt-m-b--2":"salt-p-b--2",children:s.jsx(o$t,{})}),s.jsx(gGt,{}),i&&s.jsx("div",{className:"salt-m-b--2",children:s.jsx(JGt,{})})]})},r$t=T(se)`
    min-inline-size: max-content;
`,a$t=()=>E(xs)==="HOME_DELIVERY"?"slot.booking.card.fast.delivery.booked.label":"slot.booking.card.reserved.express.collection.booked.label",yG=({slot:e,className:t="",onReserve:n,dateFormat:o,timeFormat:r,isBooked:a=!1})=>{const[i,l]=fe(["excol.adj","sl.rd"]),c=s.jsx(vte,{slot:e});return l?s.jsx(ve,{className:`salt-m-b--2 ${t}`,tabIndex:0,children:s.jsxs(se,{gap:["sm"],justify:"space-between",align:"center",wrap:"nowrap",children:[s.jsxs(se,{gap:["sm"],wrap:"wrap",align:"center",children:[s.jsx(xI,{slot:e,price:c,isBooked:a}),s.jsx(RI,{slot:e,dateFormat:o,timeFormat:r})]}),s.jsx(r$t,{align:"center",children:s.jsx(DI,{booked:a,onClick:n,fullWidth:!1})})]})}):s.jsx(ve,{className:`salt-p-y--2 salt-p-x--0 salt-m-b--2 ${t}`,tabIndex:"0",children:s.jsxs(Y,{children:[s.jsx(l$t,{colSpan:{xs:9},children:s.jsxs(se,{gap:["sm"],wrap:"wrap",align:"center",children:[s.jsx(xI,{slot:e,isBooked:a,...i&&{price:c}}),s.jsx(RI,{slot:e,dateFormat:o,timeFormat:r})]})}),s.jsx(Y.Item,{colSpan:{xs:3},children:s.jsxs(se,{justify:"flex-end",gap:["sm"],align:"center",children:[!i&&s.jsx(P,{size:"s",children:c}),s.jsx(DI,{booked:a,onClick:n,fullWidth:!1})]})})]})})},hf=({slot:e,onReserve:t,dateFormat:n,timeFormat:o,className:r,isBooked:a=!1})=>{const[i,l]=fe(["excol.adj","sl.rd"]),c=s.jsx(vte,{slot:e});return l?s.jsxs(ve,{className:`salt-m-b--2 ${r}`,tabIndex:0,children:[s.jsx(xI,{slot:e,price:c,isBooked:a}),s.jsx("div",{className:"salt-m-y--4",children:s.jsx(RI,{slot:e,dateFormat:n,timeFormat:o})}),s.jsx(DI,{booked:a,onClick:t})]}):s.jsxs(He.Action,{xs:1,sm:1,md:1,className:`salt-m-y--0 ${r}`,tabIndex:"0",children:[s.jsxs(c$t,{children:[s.jsx(xI,{asTitle:!0,slot:e,isBooked:a,...i&&{price:c}}),!i&&s.jsx(P,{size:"l",children:c})]}),s.jsx(u$t,{children:s.jsx(RI,{slot:e,dateFormat:n,timeFormat:o})}),s.jsx(He.Action.Footer,{children:s.jsx(DI,{booked:a,onClick:t})})]})},xI=({asTitle:e,price:t,slot:n,isBooked:o})=>{const r=M(),a=$q(n)?n.onDemandProperties.deliveryTimeInMinutes:0,i=r.formatNumber(a,{style:"unit",unit:"minute",unitDisplay:"short"}),l=E(xs),c=o?s.jsx(v,{id:"slot.confirmation.fast.delivery.title",values:{duration:i}}):s.jsx(v,{id:"slot.booking.card.fast.delivery.title",values:{duration:i,amount:t}}),d=o?s.jsx(v,{id:"slotbooking.express.collection.slot.list.item.title"}):s.jsx(v,{id:"slotbooking.express.collection.slot.list.item.title.with.price",values:{price:t}}),u=s.jsx(h.Fragment,{children:l==="HOME_DELIVERY"?c:d});return s.jsxs(d$t,{children:[l==="CUSTOMER_COLLECTION"&&s.jsx(me,{name:"express_collect",height:24,width:24}),e?s.jsx(ne,{className:"salt-p-r--2",as:"h2",children:u}):s.jsx(P,{className:l==="CUSTOMER_COLLECTION"?"salt-p-x--2":"",bold:!0,children:u})]})},RI=({slot:e,dateFormat:t,timeFormat:n})=>{const o=Md(),r=E(xs);if($q(e)){const{onDemandProperties:i}=e,{deliveryTimeInMinutes:l,collectionTimeInMinutes:c}=i,d=o(c),u=o(l),m=r==="HOME_DELIVERY"?"slot.booking.card.fast.delivery.static.subtitle":"slotbooking.express.collection.slot.list.item.description",g={readyTimeSpan:u,maxTimeSpan:d};return s.jsx(P,{children:s.jsx(v,{id:m,values:g})})}const a=s.jsx(go,{dateIsoFrom:e.slotDateTimeISO,dateIsoTo:e.endTimeISO,timeZoneId:e.timeZoneId,dateFormat:t,timeFormat:n});return s.jsx(P,{children:s.jsx(v,{id:"slot.booking.slots.list.item.multidays.subtitle",values:{dateAndTime:a}})})},vte=({slot:e})=>{const t=ze();return parseFloat(e.deliveryPrice.amount)===0?s.jsx(v,{id:"slotbooking.table.price.free"}):t(e.deliveryPrice)},i$t=T(b)`
    ${({bigger:e})=>e?De`
                  padding-inline: 32px;
              `:""}
`,DI=({booked:e,onClick:t=Promise.resolve,fullWidth:n=!0})=>{const[o,r]=h.useState(!1),[a=!1,i]=fe(["excol.adj","sl.rd"]),c=E(xs)==="HOME_DELIVERY"?"order.slot.bookSlot.reminder.book.link":"slotbooking.express.collection.slot.list.item.reserve",d=a&&!i,u=async()=>{r(!0);try{await t()}catch{r(!1)}},m=a$t();return e?s.jsx(Ce,{intent:"success",text:s.jsx(v,{id:m})}):s.jsx(i$t,{size:d?"m":"s",intent:"primary",fill:n,onClick:u,loading:o,bigger:d,children:s.jsx(v,{id:c})})},l$t=T(Y.Item)`
    display: flex;
    align-items: center;
`,c$t=T(He.Action.Header)`
    display: flex;
    justify-content: space-between;
`,d$t=T.div`
    display: flex;
    align-items: center;
`,u$t=T(He.Action.Body)`
    text-align: start;
`,Ate=({onReserve:e=Promise.resolve,sendImpression:t,shouldSendMultiDayImpression:n,classNameForBanner:o="salt-p-b--2",classNameForCard:r="salt-p-y--2",className:a=""})=>{const i=E(xs),l=E(ma),c=E(ND),d=E(Jt),u=E(Vt),[m]=fe(["sl.rd"]),g=i==="CUSTOMER_COLLECTION"||i==="HOME_DELIVERY",f=E(Ql),y=g&&f?.slotType==="ON_DEMAND"&&f.deliveryMethod===i&&f.deliveryDestinationId===l;if(h.useEffect(()=>{c?.length&&c.forEach((C,_)=>{if("onDemandProperties"in C){const{deliveryPrice:{amount:A,currency:x},onDemandProperties:{deliveryTimeInMinutes:R,collectionTimeInMinutes:O}}=C;t({PRICE_DISPLAYED:A,PRICE_CURRENCY:x,DELIVERY_TIME_IN_MINUTES:`${R}`,...O&&{COLLECTION_TIME_IN_MINUTES:`${O}`},SLOT_TYPE:Pa,SEQUENCE:`${_}`})}else n&&t({...wq(C),SEQUENCE:`${_}`})})},[c,t]),!(c?.length||y))return null;const I=C=>({slot:C,key:C.slotId,onReserve:()=>e(C),dateFormat:d,timeFormat:u}),S=C=>({slot:{slotId:C.slotId,onDemandProperties:{deliveryTimeInMinutes:C?.deliveryTimeInMinutes||0,collectionTimeInMinutes:C?.collectionTimeInMinutes||0},expiryTime:C.expiryTime,attributes:[],deliveryPrice:{currency:"GBP",amount:"0.00"},carrierId:C.carrierId||"",minimumOrder:{currency:"GPB",amount:"0.00"}},key:C.slotId,onReserve:Promise.resolve,dateFormat:d,timeFormat:u,isBooked:!0});return s.jsxs("div",{className:a,children:[s.jsxs(cs,{breakpoint:"md-up",remainInDom:!1,children:[y&&s.jsx(yG,{...S(f),className:o}),c.map(C=>s.jsx(yG,{...I(C),className:o}))]}),s.jsx(Kt,{breakpoint:"md-up",remainInDom:!1,children:m?s.jsxs(ie.Fragment,{children:[y&&s.jsx(hf,{...S(f),className:r}),c.map(C=>s.jsx(hf,{...I(C),className:r}))]}):s.jsxs(He.Collection,{className:"salt-gap-y--2",children:[y&&s.jsx(hf,{...S(f),className:r}),c.map(C=>s.jsx(hf,{...I(C),className:r}))]})})]})},p$t=({deliveryOptions:e,featureFlags:t})=>{const{dropOff:n,entryInstructions:o,deliveryAsset:r,additionalInformation:a}=e||{},{isDropOffRequired:i,isDeliveryAssetRequired:l,isAdditionalInfoRequired:c}=t,d=n?.selectedId,u=o?.selectedId,m=r?.selectedId,g=d&&n?.options.find(_=>_.id===d)?.entryInstructionsRequired||!1,f=c?u&&o?.options.find(_=>_.id===u)?.additionalInformationRequired:!1,y=i?!!d:!0,I=l?!!m:!0,S=g?!!u:!0,C=f?!!a?.value:!0;return{isDropOffValid:y,isDeliveryAssetValid:I,isEntryInstructionValid:S,isAdditionalInformationValid:C}},bte=e=>{const t=p$t(e);return Object.values(t).every(Boolean)},m$t=(e,t)=>({limitedProducts:t,invalidVouchers:e.invalidVouchers||[],draftBasketId:e.draftBasketId,totalChanged:e.totalChanged,itemPriceAfterPromos:e.itemPriceAfterPromos,regionChanged:e.regionChanged,slotRegionId:e.slotRegionId,otherCheckoutGroupsChanged:e.otherCheckoutGroupsChanged}),h$t=(e,t)=>{const n=e.confirmationData?m$t(e.confirmationData,t):void 0,o=e.slot.latestEditableTime?kc(e.slot.latestEditableTime,e.slot.timeZoneId):void 0;return{slot:{address:e.slot.address,expiryTime:kc(e.slot.expiryTime,e.slot.timeZoneId),latestUpdateTime:o,startTime:kc(e.slot.slotWindow?.startTime,e.slot.timeZoneId),endTime:kc(e.slot.slotWindow?.endTime,e.slot.timeZoneId),timeZoneId:e.slot.timeZoneId,slotId:e.slot.slotId,deliveryMethod:e.slot.deliveryMethod,type:e.slot.type,deliveryTimeInMinutes:e.slot.onDemandProperties?.deliveryTimeInMinutes,collectionTimeInMinutes:e.slot.onDemandProperties?.collectionTimeInMinutes,carrierId:e.slot.carrierId,...e.slot.externalAddress?{externalAddress:e.slot.externalAddress}:{},...typeof e.minimumCheckoutThresholdData?.minimumCheckoutThresholdChanged=="boolean"&&{minimumCheckoutThresholdChanged:e.minimumCheckoutThresholdData?.minimumCheckoutThresholdChanged},...e.minimumCheckoutThresholdData?.minimumCheckoutThreshold&&{minimumCheckoutThreshold:e.minimumCheckoutThresholdData.minimumCheckoutThreshold},...e.minimumCheckoutThresholdData?.originalMinimumCheckoutThreshold&&{originalMinimumCheckoutThreshold:e.minimumCheckoutThresholdData.originalMinimumCheckoutThreshold}},...n&&{confirmationData:n}}},Tk=D("oosa"),g$t=D("sl.cut"),E$t=D("bt.spl"),xte=D("sl.rd"),f$t=()=>Z.openModal(Sk),y$t=()=>Ht.getBasket(),I$t=(e,t)=>{const n=Tk(e),o=g$t(e),r=Kq(e),a=pC(e),i=xte(e),l=!r&&t.deliveryMethod==="HOME_DELIVERY"&&t.type==="ON_DEMAND";return!n&&!(r||l)||i&&!a&&!(r||l)||i&&a&&!n||!a&&n&&o&&!(r||l)||a&&(r||l)&&!n},S$t=async(e,t,n,o)=>{try{return await e(yo.selectSlot({...t,regionId:n}))}catch(r){const a={event:"event",ecommType:"enhanced",eventCategory:"Checkout Funnel",eventLabel:t.slotId,eventValue:parseFloat(t.deliveryPrice.amount),eventAction:"SelectSlotError",ecommerce:{checkout:{actionField:{step:2,option:t.deliveryType===Et.clickAndCollect.type?"click&collect":"homeDelivery"},products:o}}};throw J.sendEvent({GA:a,WA:null}),r}},C$t=e=>async(t,n)=>{const o=n(),r=Jn(o).map(C=>Ys(C)),a=hn(o),i=await S$t(t,e,a,r),l=i?.payload?.responseData,c=l?.slot?.slotId,d=l?.confirmationData?.slotRegionId,u=l?.confirmationData?.limitedProducts||[];let m=[];c&&d&&u?.length&&(m=(await t(yo.getSlotBookingLimitedProducts({slotId:c,slotRegionId:d,limitedProducts:u})))?.payload?.responseData);const g=h$t(l,m),{type:f,payload:y,...I}=i;await t(yo.setSelectedSlot({selectSlotData:g,params:I}));const S={event:"event",ecommType:"enhanced",eventCategory:"Checkout Funnel",eventLabel:`${g.slot.startTime} - ${g.slot.endTime}`,eventValue:parseFloat(I.deliveryPrice.amount),eventAction:"SlotBooked",ecommerce:{checkout:{actionField:{step:2,option:I.deliveryType===Et.clickAndCollect.type?"click&collect":"homeDelivery"},products:r}}};return J.sendEvent({GA:S,WA:null}),g},T$t=(e,t)=>async(n,o)=>{const r=o(),a=Tk(r),i=At(r),l={...e,orderId:i};try{const d=(await n(C$t(l)))?.confirmationData?.limitedProducts,u=I$t(o(),e);if(a&&d?.length){const m=d.reduce((g,f)=>({...g,[f.productId]:f}),{});await n(Ft.setProducts({product:m}))}u&&n(f$t()),await n(y$t()),u||await n(_$t(t))}catch{const d=o();if(lK(d)?.code===_te)if(e?.isFakeAvailable){const m=new URL(window.location.href);m.searchParams.set(AA,"true"),window.location.href=m.toString()}else z.error("slotbooking.slot.select.expired",{button:s.jsx($Be,{onClick:()=>window.location.reload(),children:s.jsx(v,{id:"common.page.refresh"})})});else z.error("toast.notification.generic.error")}},_$t=e=>(t,n)=>{const o=n(),r=cK(o),a=tT(o),i=At(o),l=c0e(o),c=uC(o),d=pC(o),u=v$t(o),m=r,g=d;if(m)return a===Tn.CHECKOUT_WALK&&t(U.analyticsEvent({type:Kn.CHECKOUT_WALK})),t(rp.handleCheckoutRedirect({slotbookingLocation:a,orderId:i,slotBookedQuery:A$t(o)},e));if(g&&!l&&!c){t(yo.invalidateSlotsConfirmationData());const f=`${Y2()}?${u}`;return e(f)}return null},v$t=e=>{const t=xs(e),n=V8(e),o=xte(e),r=uo(e),a=new URLSearchParams;return a.set("deliveryMethod",t),o&&a.set("deliveryDestinationId",r||""),n&&a.set("in-checkout-walk","true"),a.toString()},A$t=e=>{const t=E$t(e),n=iS(e),o=Jb(e),r=Tk(e),i=!Kq(e)&&r;return t&&n===o?CD:i?SD:""},_k={selectSlot:T$t},b$t=(e,t)=>{const n=t===Et.vanDelivery.method,o=e.attributes?.includes("GREEN")||!1,r=e.attributes?.includes("AVAILABLE")||!1;return n&&o&&r},x$t=T(Pd)`
    /* hide long addresses to avoid horizontal scroll */
    overflow-x: hidden;
`,IG=({addresses:e,disabled:t,primaryDeliveryDestination:n,selectedAddress:o,onSelectAddress:r,onChooseDifferentCollectionPoint:a,onClick:i})=>{const l=M(),c="choose-different-collection-point-value",d=C=>C[0],u=l.formatMessage("delivery.collection.select.title",{name:n?.data?.name??d(e)?.name}),m=l.formatMessage("delivery.collection.select.different.collection.point"),g=hte(n)??d(e)?.coordinates,f=gte(e,g).slice(0,5),y=bUt(e,o),I=()=>!AUt(f,o)&&y&&Sb(y),S=h.useCallback(({target:{value:C}})=>{C===c?a():r(C)},[r,a]);return s.jsxs(x$t,{id:OI,"data-test":"address-dropdown",onChange:S,value:o?.deliveryDestinationId,disabled:t,onClick:i,children:[I(),s.jsx("optgroup",{"data-test":"closest-collection-points-label",label:u,children:f.map(Sb)}),s.jsx("option",{value:c,"data-test":c,children:m})]})},R$t=T(Pd)`
    /* hide long addresses to avoid horizontal scroll */
    overflow-x: hidden;
`,SG=({addresses:e,disabled:t,selectedAddress:n,onSelectAddress:o,onClick:r})=>{const a=M(),i=Zd(),l=({target:{value:u}})=>{u===c?i.value():o(u)},c="add-address-option-value",d=a.formatMessage("addresses.add.address");return s.jsxs(R$t,{id:OI,"data-test":"address-dropdown",onChange:l,value:n?.deliveryDestinationId,disabled:t,onClick:r,children:[e.map(Sb),i.status==="READY"&&s.jsxs("option",{value:c,children:[" ",d," "]})]})},vk=()=>{const e=F(),t=E(xs),n=t===Et.vanDelivery.method;return{emitOnDropdownClickEvent:()=>e(U.analyticsEvent({type:Fe.ADDRESS_SELECTION_DROP_DOWN_CLICKED,description:xr[Fe.ADDRESS_SELECTION_DROP_DOWN_CLICKED],deliveryMethod:t})),emitOnAddressChangeEvent:o=>{const r=n?Fe.ADDRESS_FROM_DROP_DOWN_SELECTED:Fe.COLLECTION_POINT_FROM_DROP_DOWN_SELECTED;e(U.analyticsEvent({type:r,description:xr[r],deliveryMethod:t,deliveryDestinationId:o})),e(U.analyticsEvent({type:Fe.SELECT_FULFILLMENT_LOCATION,deliveryMethod:t,deliveryDestinationId:o}));const a={event:"select_fulfillment_location",method:hh[t],fulfillment_location_id:o};J.sendEvent({GA:a,WA:null})},emitOnCollectionPointMapOpenEvent:()=>e(U.analyticsEvent({type:Fe.CHOOSE_DIFFERENT_COLLECTION_POINT_BUTTON_CLICKED,description:xr[Fe.CHOOSE_DIFFERENT_COLLECTION_POINT_BUTTON_CLICKED],deliveryMethod:t}))}},OI="address-dropdown",D$t=T.div`
    position: relative;
`,O$t=T.span`
    position: absolute;
    z-index: 1;
    font-size: 16px;
    inset-inline-start: 9px;
    inset-block-start: 9px;
    font-weight: 500;
`,tu=({disabled:e=!1,deliveryMethod:t,deliveryAddresses:n,selectedAddress:o,onSelectAddress:r,onChooseDifferentCollectionPoint:a})=>{const{emitOnDropdownClickEvent:i,emitOnAddressChangeEvent:l,emitOnCollectionPointMapOpenEvent:c}=vk(),d=E(Qs),u=t===Et.vanDelivery.method,m=xUt(n),g=I=>(ks({name:kTe}),l(I),r(I)),f=()=>(c(),a());return E(D("sl.rd"))?s.jsxs(D$t,{children:[o?.name&&s.jsx(O$t,{"aria-hidden":!0,children:o?.name}),u?s.jsx(SG,{onClick:i,disabled:e,addresses:m,selectedAddress:o,onSelectAddress:g}):s.jsx(IG,{onClick:i,disabled:e,addresses:m,primaryDeliveryDestination:d,selectedAddress:o,onSelectAddress:g,onChooseDifferentCollectionPoint:f})]}):u?s.jsx(SG,{onClick:i,disabled:e,addresses:m,selectedAddress:o,onSelectAddress:g}):s.jsx(IG,{onClick:i,disabled:e,addresses:m,primaryDeliveryDestination:d,selectedAddress:o,onSelectAddress:g,onChooseDifferentCollectionPoint:f})},P$t=()=>{const t=M().formatMessage("common.address");return E(D("sl.rd"))?s.jsx(Ee,{children:s.jsx(bn,{htmlFor:OI,children:t})}):s.jsx(bn,{htmlFor:OI,children:t})};tu.Title=P$t;const{Row:CG,Item:TG,EmptyButton:Nv,HighlightedItem:Rte,ItemColumnTitle:N$t,Container:L$t,DatePickerContainer:k$t,DatePickerTable:M$t,MonthContainer:j$t,MonthArrow:_G,Month:w$t,Footer:F$t}=Tke,B$t=T(Rte)`
    border-start-start-radius: ${({firstSelected:e})=>e?"var(--salt-radius-default)":0};
    border-end-start-radius: ${({firstSelected:e})=>e?"var(--salt-radius-default)":0};
    border-inline-start: ${({firstSelected:e})=>e?`${H(1)} solid var(--intent-primary)`:0};
`,Ak=({selected:e,onDaySelect:t,dateTime:n,availableDays:o,controlledSelected:r,messages:a,buttonClassName:i,text:l,isNewButton:c=!1,containerStyle:d={},highlightedEnd:u="",highlightedStart:m="",amountHighlighted:g=3})=>{const f=h.useRef(null),[y,I]=h.useState(e),[S,C]=h.useState(e),[_,A]=h.useState(!1),x=eo();h.useEffect(()=>(Q(),window.addEventListener("mousedown",R),()=>window.removeEventListener("mousedown",R)),[]),h.useEffect(()=>{C(e)},[e]);const R=Ie=>{L(Ie.target)&&A(!1)},O=Ie=>{w(),C(Ie),t(Ie),x({type:Fe.CALENDAR_DATE_SELECTED_EVENT})},N=()=>{const{subtractMonths:Ie,DATE_FORMAT_SHORT_ISO:je,formatDateWithFixedTimezone:Le}=n,Be=Ie(1,y);I(Le(Be,je))},k=()=>{const{addMonths:Ie,DATE_FORMAT_SHORT_ISO:je,formatDateWithFixedTimezone:Le}=n,Be=Ie(1,y);I(Le(Be,je))},j=()=>{const{addDays:Ie,genDayRange:je}=n;if(m&&u)return je(m,u);const Le=Ie(1,S),Be=Ie(g,S);return je(Le,Be)},w=()=>{_||x({type:Fe.CALENDAR_CLICKED_EVENT}),A(!_)},L=Ie=>f.current&&Ie instanceof Node&&!f.current.contains(Ie),B=Ie=>{const{areDaysTheSame:je}=n;return o&&!o.filter(Le=>je(Le,Ie)).length},W=Ie=>{const{areDaysTheSame:je}=n;return je(S,Ie)},$=Ie=>{const je=j(),{areDaysTheSame:Le}=n;return{isHighlighted:!!je.filter(Be=>Le(Be,Ie)).pop(),isLastHighlight:Le(je.pop(),Ie),isFirstHighlight:Le(je[0],Ie)}},K=()=>{const{addDays:Ie,DATE_FORMAT_SHORT_ISO:je,getFirstDayOfWeekCrossingBeginningOfMonth:Le,getLastDayOfWeekCrossingEndOfMonth:Be,genWeekRange:be,formatDateWithFixedTimezone:he}=n,ge=Le(y),Oe=Be(y),Xe=be(ge,Oe);return Xe==="Invalid date"?[]:Xe.reduce((Se,dt)=>{const et=Array.from(Array(6)).map((Ut,ys)=>he(Ie(ys+1,dt),je)),we=[he(dt,je),...et];return[...Se,we]},[])},Q=()=>{const{DATE_FORMAT_DAY_WITH_LEADING_ZEROS:Ie,DATE_FORMAT_LOCALE_DEPENDENT:je,formatDateWithFixedTimezone:Le}=n;return K().map(Be=>s.jsx(CG,{children:Be.map(be=>{const he=W(be),ge=B(be),Oe=$(be),Xe={muted:ge,selected:he,onClick:()=>O(be)},Se=Le(be,Ie),dt=Le(be,je),et=ge?s.jsx(TG,{"data-test":"date-picker-item","aria-disabled":"true",...Xe,children:Se},be):s.jsx(TG,{"data-test":"date-picker-item",...Xe,children:s.jsxs(Nv,{type:"button","aria-pressed":he,fillSpace:!0,children:[s.jsx("span",{"aria-hidden":"true",children:Se}),s.jsx(Ee,{children:dt})]})},be),we=ge?s.jsx(Rte,{"data-test":"date-picker-highlighted-item",...Xe,last:Oe.isLastHighlight,"aria-disabled":"true",children:Se},be):s.jsx(B$t,{...Xe,last:Oe.isLastHighlight,firstSelected:Oe.isFirstHighlight&&r,children:s.jsxs(Nv,{type:"button","aria-pressed":he,fillSpace:!0,children:[s.jsx("span",{"aria-hidden":"true",children:Se}),s.jsx(Ee,{children:dt})]})},be);return Oe.isHighlighted?we:et})},Be[0]))},X=Ie=>{const{getFirstDayOfWeekIndex:je}=n,Le=je();return[...Array(7).keys()].map(Be=>s.jsx(N$t,{"data-test":"date-picker-item-column-title",scope:"col",children:[...Object.values(a.weekDays)][(Le+Be)%7]},`${Ie}-${Be}`))},{DATE_FORMAT_MONTH_YEAR_LABEL:re,DATE_FORMAT_MONTH_INDEX:ue,formatDateWithFixedTimezone:te,addMonths:ce,subtractMonths:de}=n,ye=Ie=>te(Ie,re),Ae=ye(y),Je=te(y,ue);return e&&s.jsxs(L$t,{ref:f,children:[c?s.jsxs(b,{intent:"tertiary",size:"s",fill:!1,"aria-label":a.datePickerAlternative,"aria-expanded":_,"aria-haspopup":!0,onClick:w,"data-test":"date-picker-button",className:i||"",children:[s.jsx(b.Icon,{name:"calendar",size:"s"}),l?s.jsx(b.Text,{children:l}):void 0]}):s.jsxs(b,{intent:"secondary","data-test":"date-picker-button",fill:!0,"aria-label":a.datePickerAlternative,"aria-expanded":_,"aria-haspopup":!0,onClick:w,children:[s.jsx(b.Icon,{name:"calendar"}),s.jsx(b.Text,{className:"salt-d--none md:salt-d--block",children:a.calendar})]}),_&&s.jsxs(k$t,{style:d,children:[s.jsxs(j$t,{children:[s.jsxs(_G,{"data-test":"date-picker-arrow-button",type:"button",onClick:()=>N(),onKeyPress:({key:Ie})=>Ie==="enter"&&N(),children:[s.jsx(Ee,{children:a.previousMonth(ye(de(1,y)))}),s.jsx(me,{"aria-hidden":"true",height:20,width:20,name:"arrow_left"})]}),s.jsxs(w$t,{id:"current-month","aria-live":"polite",children:[s.jsx("span",{"aria-hidden":"true",children:Ae}),s.jsx(Ee,{children:a.currentMonth(Ae)})]}),s.jsxs(_G,{"data-test":"date-picker-arrow-button",type:"button",onClick:()=>k(),onKeyPress:({key:Ie})=>Ie==="enter"&&k(),children:[s.jsx(Ee,{children:a.nextMonth(ye(ce(1,y)))}),s.jsx(me,{"aria-hidden":"true",height:20,width:20,name:"arrow_right"})]})]}),s.jsxs(M$t,{"aria-labelledby":"current-month","data-test":"date-picker-table",children:[s.jsx("thead",{"data-test":"DatePicker-heading",children:s.jsx(CG,{children:X(Je)})}),s.jsx("tbody",{children:Q()})]}),s.jsx(F$t,{children:s.jsx(Nv,{type:"button",underline:!0,onClick:w,"data-test":"DatePicker-Cancel",children:a.cancel})})]})]})};Ak.displayName="DatePicker";const vG=T(b)`
    flex: 1;
`,U$t=T.div`
    flex: 1;
`,G$t=({labels:e,daysOffset:t,dateTime:n,onPrevBtnClick:o,onNextBtnClick:r,days:a,numberOfDisplayedDays:i,firstDisplayedDay:l,onDaySelect:c,dateFormat:d})=>{const m=ll()==="xs",{formatDateWithFixedTimezone:g,DATE_FORMAT_SHORT_ISO:f}=n,y=a.filter(I=>I.hasAnyAvailableSlot).map(I=>I.iso);return s.jsxs(h.Fragment,{children:[s.jsxs(vG,{intent:"secondary",disabled:t===0,onClick:o,"data-synthetics":"select-previous","aria-label":e.previousCompleteText,fill:m,className:"salt-p-x--0",children:[s.jsx(b.Icon,{name:"arrow_left"}),s.jsx(b.Text,{className:"xs:max-sm:salt-vc",children:e.previous})]}),s.jsx(U$t,{className:"salt-m-x--1",children:s.jsx(Ak,{selected:l&&l.iso||g(f,d),onDaySelect:c,amountHighlighted:i-1,availableDays:y,messages:e,"data-synthetics":"date-picker",dateTime:n})}),s.jsxs(vG,{intent:"secondary",disabled:t>=a.length-2*i+1,onClick:r,"data-synthetics":"select-next","aria-label":e.next,fill:m,className:"salt-p-x--0",children:[s.jsx(b.Text,{className:"xs:max-sm:salt-vc",children:e.next}),s.jsx(b.Icon,{name:"arrow_right"})]})]})},$$t=(e,t)=>{const[,n]=t?.start?.split("T")||[],[,o]=t?.end?.split("T")||[];return{start:`${e?.iso}T${n}`,end:`${e?.iso}T${o}`}},H$t=({displayedGridDays:e,partOfDays:t,activeRawStandardSlotIdsMap:n})=>{const o=[];return e.forEach(({dayId:r})=>{t.forEach(({intervals:a,partId:i})=>{a.forEach(({intervalId:l})=>{const c=n[`${r}|${i}|${l}`];c&&o.push(c)})})}),o},V$t=()=>{const{formatMessage:e}=M(),t=E(aE),n=E(om);return h.useMemo(()=>{const o=s.jsx(P,{size:"m",bold:!0,children:n?.displayValue});return n?t?.value?{ariaLabel:e("slot.booking.delivery.drop-off-option-with-value.accessibility",{option:n?.displayValue,info:t?.value}),buttonText:s.jsx(v,{id:"slot.booking.delivery.drop-off-option-with-value",values:{label:o,value:s.jsx(P,{size:"m",children:t.value})}})}:{ariaLabel:e("slot.booking.delivery.drop-off-option.accessibility",{option:n?.displayValue}),buttonText:o}:{ariaLabel:e("slot.booking.delivery.select-drop-off-option"),buttonText:s.jsx(P,{size:"l",bold:!0,children:s.jsx(v,{id:"slot.booking.delivery.select-drop-off-option"})})}},[t?.value,n?.displayValue])},Dte=T(ve)`
    align-items: center;
    cursor: pointer;
    display: flex;
    block-size: ${H(40)};
    gap: var(--salt-spacing-2);

    &:hover {
        box-shadow: var(--salt-elevation-shadow-1);
    }
`,Y$t=T.span`
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
`,yE=({onDeliveryDetailsSaved:e,handleModalClose:t,hasUnconfirmedSlot:n})=>{const[o]=fe(["nfuad"]),r=F(),{ariaLabel:a,buttonText:i}=V$t(),l=E(uo),c=E(Fa),d=l||c,u=n?Dy.DELIVERY_OPTIONS_INCOMPLETE:Dy.DELIVERY_OPTIONS_CLICKED,m=()=>{r(Z.openModal(lE))};return s.jsxs(h.Fragment,{children:[s.jsx(Dte,{asChild:!0,condensed:!0,"data-test":"delivery-details-selector","aria-label":a,onClick:m,children:s.jsxs("button",{type:"button",children:[s.jsx(Y$t,{children:i}),s.jsx(me,{name:"edit"})]})}),o?s.jsx(FZ,{handleModalClose:t,trigger:u,deliveryDestinationId:d,onDeliveryDetailsSaved:e}):s.jsx(bZ,{handleModalClose:t,trigger:u,deliveryDestinationId:d,onDeliveryDetailsSaved:e})]})},W$t=()=>s.jsx(Dte,{children:null});yE.Skeleton=W$t;const q$t=T(Fn)`
    position: absolute;
    inset-block-start: -10px;
    inset-inline-start: -5px;
`,AG=e=>e.length>Ow?`${e.slice(0,Ow)}...`:e,Ote=()=>{const{formatMessage:e}=M(),t=E(D("sv.sl.bdg")),n=e("saver-slots-badge.title"),[o]=fe(["sl.rd"]);return t?o?s.jsx(Fn,{intent:"primary","data-test":"saver-slots-button-badge",text:AG(n),singleLine:!0}):s.jsx(q$t,{intent:"primary","data-test":"saver-slots-button-badge",text:AG(n),singleLine:!0}):null},K$t={slotId:p.string,onClick:p.func,dataSynthetics:p.string,children:p.oneOfType([p.string,p.element,p.array]),available:p.bool,highlight:p.bool,select:p.bool,dateTimeMessage:p.string},z$t={slotId:void 0,onClick:void 0,dataSynthetics:void 0,children:void 0,available:!1,highlight:!1,select:!1,dateTimeMessage:""},Pte={available:p.bool,highlight:p.bool,select:p.bool},Nte={available:!1,highlight:!1,select:!1},Lte={highlight:p.bool,fontSize:p.string,fontWeight:p.number},kte={highlight:!1,fontSize:"14px",fontWeight:700},bk=({select:e,highlight:t,available:n})=>{let o="var(--intent-contrast)";return e?o="var(--intent-primary-100)":t?o="var(--intent-primary-50)":n||(o="var(--intent-secondary-100)"),o},ap=T.td.attrs(({colspan:e})=>({colSpan:e||1}))`
    position: relative;
    background-color: ${bk};
    ${({select:e})=>e&&"font-weight: 600"};
    border: var(--salt-border-1) solid var(--intent-secondary-900);
    padding: 0;
    text-align: center;

    &:hover {
        ${({available:e})=>e&&"cursor: pointer"};
        ${({available:e})=>e&&`
            background-color: var(--intent-primary-100);
        `};
    }
`;ap.propTypes=Pte;ap.defaultProps=Nte;ap.displayName="Td";const IE=T.button`
    position: absolute;
    inset-block-start: 0;
    inset-inline-start: 0;
    inline-size: 100%;
    block-size: 100%;
    background-color: ${bk};
    ${({select:e})=>e&&"font-weight: 600"};
    border: 0;
    padding: 0;
    display: flex;
    justify-content: space-between;
    align-items: center;

    &:hover {
        ${({available:e})=>e&&"cursor: pointer"};
        ${({available:e})=>e&&`
            background-color: var(--intent-primary-100);
        `};
    }
`;IE.propTypes=Pte;IE.defaultProps=Nte;IE.displayName="TdButton";const Gi=T.th.attrs(({as:e})=>!e&&{scope:"col"})`
    background-color: ${({highlight:e})=>e?"var(--intent-primary)":"var(--intent-contrast)"};
    ${({noBorder:e})=>e?"background: transparent;":""}
    border: ${({noBorder:e})=>e?"0":"var(--salt-border-1) solid var(--intent-secondary-900)"};
    border-block-end: 0;
    color: ${({highlight:e})=>e?"var(--intent-primary-contrast)":"var(--intent-content)"};
    padding-block: var(--salt-spacing-4);
    padding-inline: var(--salt-spacing-1);
`;Gi.propTypes=Lte;Gi.defaultProps=kte;Gi.displayName="HeaderCell";const rm=T.th.attrs({scope:"row"})`
    background-color: ${({highlight:e})=>e?"var(--intent-primary)":"var(--intent-secondary-100)"};
    border: var(--salt-border-1) solid var(--intent-secondary-900);
    color: ${({highlight:e})=>e?"var(--intent-primary-contrast);":"var(--intent-content)"};
    padding-block: var(--salt-spacing-4);
    padding-inline: var(--salt-spacing-1);
    text-align: center;
    ${oe.xs`
        ${({fontWeight:e})=>e&&`font-weight: ${e};`}
        ${({fontSize:e})=>e&&`font-size: ${e};`}
    `}
`;rm.propTypes=Lte;rm.defaultProps=kte;rm.displayName="HeaderRowCell";const Gh=T.th.attrs(({as:e})=>!e&&{scope:"row"})`
    background: var(--intent-secondary);
    border: var(--salt-border-1) solid var(--intent-secondary-900);
    padding-inline: var(--salt-spacing-1);
    padding-block: 0;
    text-align: center;
    white-space: nowrap;
`;Gh.displayName="HeadingCell";const er=ie.forwardRef(({dateTimeMessage:e,slotId:t,onClick:n,available:o,highlight:r,select:a,dataSynthetics:i,children:l},c)=>n?s.jsx(ap,{slotId:t,children:s.jsx(IE,{"aria-label":e,type:"button",onClick:n,available:o,highlight:r,select:a,ref:c,"data-synthetics":i,children:l})}):s.jsx(ap,{slotId:t,available:o,highlight:r,select:a,ref:c,"data-synthetics":i,children:l}));er.propTypes=K$t;er.defaultProps=z$t;er.displayName="Cell";er.getBackgroundColor=bk;er.Td=ap;er.TdButton=IE;er.HeaderCell=Gi;er.HeaderRowCell=rm;er.HeadingCell=Gh;const Mte=(e,t,n)=>Object.values(e).find(o=>o.deliveryDestinationId===t||o.addressId===n),Q$t=(e,t,n)=>{const o=Mte(e,t,n);return o||{deliveryDestinationId:t}},X$t=()=>{const e=F(),t=E(fE);return{selectAddress:h.useCallback((o,r)=>{const a=Q$t(t,o,r);e(ea.setSelectedAddress(a))},[e,t])}},Z$t=()=>{const e=F(),t=E(fE),n=E(Pp),o=E(xs),r=E(uo),a=Mte(t,r),i=h.useCallback(()=>e(Z.openModal(hc)),[e]),{selectAddress:l}=X$t();return{anySlotListingRequestPending:n,deliveryMethod:o,selectedAddress:a,onChangeCollectionPoint:i,selectAddress:l,deliveryAddresses:t}},SE=()=>{const{anySlotListingRequestPending:e,deliveryMethod:t,selectedAddress:n,onChangeCollectionPoint:o,selectAddress:r,deliveryAddresses:a}=Z$t();return s.jsx(tu,{disabled:e,deliveryMethod:t,deliveryAddresses:Object.values(a),selectedAddress:n,onSelectAddress:r,onChooseDifferentCollectionPoint:o})},jte=p.shape({partId:p.string.isRequired,name:p.string.isRequired,intervals:p.arrayOf(p.shape({intervalId:p.string.isRequired,end:p.string.isRequired,name:p.string.isRequired,order:p.number.isRequired,start:p.string.isRequired}))}),wte=p.shape({slotId:p.string.isRequired,slotDateTimeISO:p.string.isRequired,available:p.bool.isRequired,price:p.string.isRequired,ecoSlot:p.bool.isRequired}),Fte=p.shape({slotId:p.string.isRequired,slotDateTimeISO:p.string.isRequired,slotDayId:p.string.isRequired,slotIntervalId:p.string.isRequired,slotPartId:p.string.isRequired,available:p.bool.isRequired,deliveryPrice:p.shape({currency:p.string.isRequired,amount:p.string.isRequired}).isRequired}),Bte=p.shape({dayId:p.string.isRequired,dayName:p.string.isRequired,order:p.number.isRequired,iso:p.string,hasAnyAvailableSlot:p.bool}),J$t=p.shape({previous:p.string.isRequired,next:p.string.isRequired,alert:p.shape({title:p.string.isRequired,viewSlot:p.string.isRequired}).isRequired,slotAriaViewSlot:p.string.isRequired,slotAriaDate:p.string.isRequired,slotAriaTime:p.string.isRequired,slotAriaCost:p.string.isRequired,nextMonth:p.func.isRequired,currentMonth:p.func.isRequired,previousMonth:p.func.isRequired,datePickerAlternative:p.string.isRequired,fillerText:p.string.isRequired,previousCompleteText:p.string.isRequired,calendar:p.string.isRequired}),e0t={startDayIso:p.string,dateTime:p.objectOf(p.oneOfType([p.func,p.string])).isRequired,dateFormat:p.string.isRequired,timeFormat:p.string.isRequired,days:p.arrayOf(Bte).isRequired,firstSlot:Fte.isRequired,labels:J$t.isRequired,numberOfDisplayedDays:p.number,partsOfDay:p.arrayOf(jte).isRequired,slots:p.objectOf(p.objectOf(p.objectOf(wte).isRequired).isRequired).isRequired,activeRawStandardSlotIdsMap:p.objectOf(p.string).isRequired,slotSelectionHandler:p.func.isRequired,impression:p.func,sendSlotbookingPageAttributes:p.func,sendQueuedImpressions:p.func,slotBookedSuccessfully:p.bool,isSlotFetching:p.bool.isRequired,hasSelectedSlotFetchError:p.bool.isRequired,shouldRenderDeliveryDetailsSelector:p.bool.isRequired,onDemandSlotsAvailable:p.bool.isRequired,onDemandSlotsComponent:p.node,timeZoneId:p.string.isRequired,isSaverSlotsVCEnabled:p.bool.isRequired,selectedSlotGroup:p.string,sendStandardSlotsButtonClickedEvent:p.func.isRequired,sendSaverSlotsButtonClickedEvent:p.func.isRequired,formatMessage:p.func.isRequired,timeRangeStyles:p.objectOf(p.shape({fontWeight:p.number,fontSize:p.string})),sendSeenSlots:p.func,carrierId:p.string,onDeliveryDetailsSaved:p.func.isRequired,cancelSlotSelection:p.func.isRequired,hasUnconfirmedSlot:p.bool.isRequired},t0t={numberOfDisplayedDays:3,impression:()=>{},sendSlotbookingPageAttributes:()=>{},sendQueuedImpressions:()=>{},slotBookedSuccessfully:!1,shouldRenderDeliveryDetailsSelector:!1,startDayIso:null,selectedSlotGroup:"standard",timeRangeStyles:{fontSize:"14px",fontWeight:600},sendSeenSlots:()=>{},carrierId:void 0},s0t=D$`
  html {
    scroll-behavior: smooth;
  }
`,xk=T.table`
    border-collapse: collapse;
    border-spacing: 0;
    table-layout: fixed;
    inline-size: 100%;
`,Rk=T.thead``,Dk=T.tbody``,Jc=T.tr``,n0t=T.span`
    display: block;
    font-weight: normal;
`,$h=T.div`
    display: flex;
    justify-content: space-between;
`,_b="23rem",o0t="21rem",Ute=T($h)`
    gap: var(--salt-spacing-2);
    min-inline-size: ${_b};
    inline-size: 100%;
    order: 1;
    ${oe[or["md-up"].mediaQueryKey]`
         width: auto;
         max-width: ${o0t};
         order: unset;
    `}
`,r0t=T($h)`
    gap: var(--salt-spacing-2);
    ${oe[or["md-up"].mediaQueryKey]`
        width: 23rem;
    `}
`,Gte=T.div`
    display: flex;
    justify-content: flex-end;
    flex-wrap: wrap;
    gap: var(--salt-spacing-2);
`,PI=T.div`
    inline-size: 100%;

    ${({shouldUseThreeColumnLayout:e})=>oe[or["md-up"].mediaQueryKey]`
        max-width: ${e?`calc(50% - (${_b} / 2) - var(--salt-spacing-2))`:`calc(100% - ${_b} - var(--salt-spacing-2))`};
    `}
`,a0t=T.div`
    inline-size: 100%;
    order: 0;
    ${oe[or["md-up"].mediaQueryKey]`
       order: unset;
    `}
`,i0t=T(Rs)`
    transform: scale(0.4);
    margin-inline-end: 0;
`,bG=T.span`
    flex-grow: 1;
    flex-basis: 0;
`,l0t=T.div`
    margin-inline-end: var(--salt-spacing-4);
    display: flex;
    place-content: center flex-end;
`,xG=T(b)`
    && {
        position: relative;
        border: ${H(1)} solid transparent;

        ${({intent:e})=>e==="secondary"&&De`
                border-color: var(--intent-primary-100);
            `};
    }
`;let qo=class uy extends h.Component{static getImpressionData({day:t,interval:n,slot:o,slotPartId:r,timeZoneId:a}){const{start:i,end:l}=$$t(t,n),c=uy.isSlotAvailable(o)&&!t.filler;return{intervalStart:i,intervalEnd:l,intervalStartDate:t.iso,intervalTimeZoneId:a,slotDayId:t.dayId,slotPartId:r,slotIntervalId:n.intervalId,isAvailable:c===void 0?!1:c,slotType:fD}}static isSlotAvailable(t){return t&&t.available&&t.price&&t.slotDateTimeISO}FIRST_AVAILABLE_SLOT_ID="first-available-slot";constructor(t){super(t),this.state={selectedSlot:{},selectedDay:{},selectedInterval:{},daysOffset:0,firstDisplayedDay:t.days[0],firstAvailableSlotAlertVisible:!1,displaySaverSlots:t.selectedSlotGroup==="saver",sendDataFeedOnce:!0},this.handlePreviousDays=this.handlePreviousDays.bind(this),this.handleNextDays=this.handleNextDays.bind(this),this.handleStandardSlotsButtonClick=this.handleStandardSlotsButtonClick.bind(this),this.handleSaverSlotsButtonClick=this.handleSaverSlotsButtonClick.bind(this),this.updateDisplayedDays=this.updateDisplayedDays.bind(this),this.days=this.props.days.slice(0),this.viewFirstAvailableSlot=this.viewFirstAvailableSlot.bind(this),this.shouldSendDataFeedAnalytics=this.shouldSendDataFeedAnalytics.bind(this),this.resetSlotSelection=this.resetSlotSelection.bind(this),this.firstAvailableSlotElement=ie.createRef(),this.getFirstAvailableSlotTime(),this.getFirstAvailableDay(),this.pushFillerDays(),this.impressionSent={},this.pageAttributesSent=!1}componentDidMount(){this.shouldShowFirstAvailableSlotAlertOnRender(),this.sendAnalyticsForPage(),this.shouldSendDataFeedAnalytics()&&this.handleDataFeedAnalytics(),this.props.startDayIso&&this.updateDisplayedDays(this.props.startDayIso)}componentDidUpdate(t,n){this.sendAnalyticsForPage(),this.shouldSendDataFeedAnalytics(n)&&this.handleDataFeedAnalytics(),this.checkForInvalidSlot(t)}isSlotSelected(){return this.state.selectedSlot.slotId}checkForInvalidSlot(t){t?.isSlotFetching&&!this.props.isSlotFetching&&this.props.hasSelectedSlotFetchError&&this.isSlotSelected()&&this.setState({selectedSlot:{},selectedDay:{},selectedInterval:{}})}handleNextDays(){const{daysOffset:t}=this.state;this.setState({daysOffset:Math.min(this.props.days.length-this.props.numberOfDisplayedDays,t+1),firstDisplayedDay:this.updateSelectedDay(1)})}handlePreviousDays(){const{daysOffset:t}=this.state;this.setState({daysOffset:Math.max(0,t-1),firstDisplayedDay:this.updateSelectedDay(-1)})}handleStandardSlotsButtonClick(){this.setState({displaySaverSlots:!1}),this.props.sendStandardSlotsButtonClickedEvent()}handleSaverSlotsButtonClick(){this.setState({displaySaverSlots:!0}),this.props.sendSaverSlotsButtonClickedEvent()}shouldSplitSlots(){if(!this.props.isSaverSlotsVCEnabled)return!1;const{partsOfDay:t}=this.props,n=t.filter(({partId:r})=>r!==Ar).some(({intervals:r})=>r.length),o=t.find(({partId:r})=>r===Ar)?.intervals.length>0;return n&&o}getPartsOfDay(){const{partsOfDay:t}=this.props;if(!this.shouldSplitSlots())return t;const{displaySaverSlots:n}=this.state;return t.filter(({partId:o})=>o===Ar?n:!n)}displayPartsOfDayHeadings(){const{partsOfDay:t,isSaverSlotsVCEnabled:n}=this.props;return t.find(({partId:a})=>a===Ar)?n?!this.state.displaySaverSlots:t.filter(({partId:a})=>a!==Ar).some(({intervals:a})=>a.length):!0}getDisplayedDays(){const{numberOfDisplayedDays:t}=this.props,{daysOffset:n}=this.state,{days:o}=this;return o.filter((r,a)=>a>=n&&a<n+t)}getFirstAvailableDay(){const t=this.props.firstSlot.slotDayId,{days:n}=this.props;return n.filter(r=>r.dayId===t).pop()}getFirstAvailableSlotTime(){const{partsOfDay:t,firstSlot:n}=this.props,o=n.slotIntervalId,r=n.slotPartId;return t.filter(l=>l.partId===r).pop().intervals.filter(l=>l.intervalId===o).pop()}impressionsForShownSlots(){const{slots:t,timeZoneId:n}=this.props;this.getPartsOfDay().forEach(({partId:o,intervals:r})=>{r.forEach(a=>{this.getDisplayedDays().forEach(i=>{const l=`${i.dayId}-${o}-${a.intervalId}`,c=wo(t,`${i.dayId}.${o}.${a.intervalId}`);this.impression(uy.getImpressionData({day:i,interval:a,slot:c,slotPartId:o,timeZoneId:n}),l)})})}),this.sendQueuedImpressions()}shouldSendDataFeedAnalytics(t){const n=t&&t?.daysOffset!==this.state.daysOffset,o=t&&t?.displaySaverSlots!==this.state.displaySaverSlots;return n||o||this.state.sendDataFeedOnce}handleDataFeedAnalytics(){const t=H$t({displayedGridDays:this.getDisplayedDays(),partOfDays:this.getPartsOfDay(),activeRawStandardSlotIdsMap:this.props.activeRawStandardSlotIdsMap});this.setState({sendDataFeedOnce:!1}),this.props.sendSeenSlots(t)}sendAnalyticsForPage(){const{partsOfDay:t,numberOfDisplayedDays:n}=this.props,a=t.map(i=>i.intervals.length).reduce((i,l)=>i+l)*n;this.sendSlotbookingPageAttributesIfNotSentYet(a),this.impressionsForShownSlots()}viewFirstAvailableSlot(){const t=this.getFirstAvailableDay().iso;this.updateDisplayedDays(t),requestAnimationFrame(()=>this.firstAvailableSlotElement.current?.focus())}isSelectedSlotDisplayed(){const{selectedDay:t,daysOffset:n}=this.state,{numberOfDisplayedDays:o}=this.props;return t.order>=n&&t.order<n+o}isHighlighted(t,n){const{selectedInterval:o,selectedDay:r}=this.state;return this.isSelectedSlotDisplayed()&&(t===o.order&&n<r.order||t<o.order&&n===r.order)}pushFillerDays(){const{numberOfDisplayedDays:t}=this.props,n=this.days[this.days.length-1],o=Array.from(Array(t-1)).map((r,a)=>({filler:!0,dayId:`filler-${a}`,iso:Ks(oa,zI(a+1,n?.dayId))}));this.days.push(...o)}isHeaderRowCellHighlighted(t){const{selectedInterval:n}=this.state;return this.isSelectedSlotDisplayed()&&n.intervalId===t}updateSelectedDay(t){const n=this.state.firstDisplayedDay.order+t;return this.days.filter(o=>o.order===n).pop()}impression(t,n){n!==void 0&&!this.impressionSent[n]&&(this.props.impression(t),this.impressionSent[n]=!0)}sendQueuedImpressions(){this.props.sendQueuedImpressions()}sendSlotbookingPageAttributesIfNotSentYet(t){this.pageAttributesSent||(this.props.sendSlotbookingPageAttributes(t),this.pageAttributesSent=!0)}selectSlot(t,n,o){this.isSlotSelected()||(this.props.slotSelectionHandler(t),this.setState({selectedSlot:t,selectedDay:n,selectedInterval:o}))}updateDisplayedDays(t){const n=this.days.find(o=>o.iso===t);n&&this.setState({firstDisplayedDay:n,daysOffset:n.order})}shouldShowFirstAvailableSlotAlertOnRender(){const{days:t,numberOfDisplayedDays:n,firstSlot:o}=this.props,r=t.filter(({dayId:a})=>a===o.slotDayId).pop();r&&(l=>l+1)(r.order)>n&&this.setState({firstAvailableSlotAlertVisible:!0})}renderCellIcon(t){const n=t===this.state.selectedSlot.slotId;return n&&this.props.slotBookedSuccessfully?s.jsx(l0t,{children:s.jsx(me,{name:"status_yes",height:20})}):n&&this.props.isSlotFetching?s.jsx(i0t,{"data-test":"slot-spinner"}):null}renderCells(t,n,o){const{dateFormat:r,labels:a,slots:i,timeFormat:l,firstSlot:c,dateTime:d}=this.props,{formatDateWithFixedTimezone:u}=d,{selectedSlot:m}=this.state,g=wo(i,`${t.dayId}.${o}.${n.intervalId}`),f=this.isHighlighted(n.order,t.order);if(uy.isSlotAvailable(g)){const y=u(g.slotDateTimeISO,r),I=u(n.start,l),S=u(n.end,l),C=[`${a.slotAriaDate}, ${y}`,`${a.slotAriaTime}, ${I} - ${S}`,`${a.slotAriaCost}, ${g.price}`,...g.ecoSlot?[this.props.formatMessage("accessibility.eco.slot.label")]:[]].join(", "),_=g.slotId===c.slotId;return s.jsxs(er,{dateTimeMessage:C,slotId:g.slotId,select:g.slotId===m.slotId,highlight:f,available:g.available,onClick:()=>this.selectSlot(g,t,n),dataSynthetics:"selectable-slot",ref:_?this.firstAvailableSlotElement:null,children:[s.jsx(bG,{children:this.renderCellIcon(g.slotId)}),s.jsx("span",{"data-test":f?"highlighted-slot":"selectable-slot",id:_?this.FIRST_AVAILABLE_SLOT_ID:void 0,children:g.price}),g.ecoSlot&&s.jsx(me,{"data-test":"eco-slot-icon",className:"salt-m-l--2",name:"eco_slot",success:!0}),s.jsx(bG,{})]},g.slotId)}return t.filler?s.jsx(er,{highlight:!1,available:!1},t.dayId):s.jsx(er,{highlight:f,available:!1,children:"—"},`${t.dayId}${o}${n.intervalId}`)}renderButtonRow(t=$h){const{numberOfDisplayedDays:n,labels:o,dateTime:r,dateFormat:a}=this.props,{daysOffset:i,firstDisplayedDay:l}=this.state,{days:c}=this,u=`salt-m-b--2 ${t===$h?"salt-m-t--2 md:salt-m-t--0 md:salt-m-b--4":"md:salt-m-b--2"}`;return s.jsx(t,{className:u,children:s.jsx(G$t,{labels:o,daysOffset:i,dateTime:r,onPrevBtnClick:this.handlePreviousDays,onNextBtnClick:this.handleNextDays,days:c,numberOfDisplayedDays:n,firstDisplayedDay:l,onDaySelect:this.updateDisplayedDays,dateFormat:a})})}renderOnDemandSlots(t=ie.Fragment){return s.jsx(t,{children:this.props.onDemandSlotsComponent})}resetSlotSelection(){this.setState({selectedSlot:{},selectedDay:{},selectedInterval:{}}),this.props.cancelSlotSelection()}renderSelectorsAndButtonRow(t){const{shouldRenderDeliveryDetailsSelector:n,onDeliveryDetailsSaved:o,hasUnconfirmedSlot:r}=this.props,a=!!n;return s.jsxs(h.Fragment,{children:[s.jsx(tu.Title,{}),s.jsxs(Gte,{children:[s.jsx(PI,{shouldUseThreeColumnLayout:a,children:s.jsx(SE,{})}),n&&s.jsx(PI,{shouldUseThreeColumnLayout:a,children:s.jsx(yE,{onDeliveryDetailsSaved:o,handleModalClose:this.resetSlotSelection,hasUnconfirmedSlot:r})}),this.renderButtonRow(Ute),t&&this.renderOnDemandSlots(a0t)]})]})}renderFirstAvailableSlotAlert(){const{labels:t,onDemandSlotsAvailable:n}=this.props;return this.state.firstAvailableSlotAlertVisible&&!n?s.jsx(Ce,{intent:"success",className:"salt-m-b--4",showIcon:!1,text:s.jsxs(P,{children:[s.jsx(P,{bold:!0,children:`${t.alert.title} `}),`${this.getFirstAvailableDay().dayName} ${this.getFirstAvailableSlotTime().name} `]}),link:s.jsx(rt,{decorated:!0,onClick:this.viewFirstAvailableSlot,"aria-label":t.slotAriaViewSlot,href:`#${this.FIRST_AVAILABLE_SLOT_ID}`,children:t.alert.viewSlot})}):null}renderSaverSlotButtons(){if(!this.shouldSplitSlots())return null;const{displaySaverSlots:t}=this.state;return s.jsxs(r0t,{className:"salt-m-b--2 sm:salt-m-b--2 md:salt-m-b--4 salt-m-t--2",children:[s.jsx(xG,{fill:!0,intent:t?"tertiary-contrast":"secondary",onClick:this.handleStandardSlotsButtonClick,"aria-pressed":!t,children:s.jsx(v,{id:"slotbooking.standard.slots.button"})}),s.jsxs(xG,{fill:!0,intent:t?"secondary":"tertiary-contrast",onClick:this.handleSaverSlotsButtonClick,"aria-pressed":t,"data-test":"saver-slots-button",children:[s.jsx(v,{id:"slotbooking.saver.slots.button"}),s.jsx(Ote,{})]})]})}render(){const{labels:t,timeRangeStyles:n}=this.props,{selectedDay:o}=this.state,r=this.props.onDemandSlotsAvailable,a=this.getPartsOfDay(),i=this.displayPartsOfDayHeadings();return s.jsxs("div",{children:[s.jsx(s0t,{}),this.renderSelectorsAndButtonRow(r),this.renderFirstAvailableSlotAlert(),this.renderSaverSlotButtons(),s.jsxs(xk,{children:[s.jsx(Rk,{children:s.jsxs(Jc,{"data-test":"slot-booking-header-row",children:[s.jsx(Gi,{as:"td",noBorder:!0}),(()=>{let l=!1;return this.getDisplayedDays().map(({filler:c,dayId:d,dayName:u})=>c?l?null:(l=!0,s.jsx(Gi,{colSpan:this.props.numberOfDisplayedDays-(this.props.days.length-this.state.daysOffset),children:t.fillerText},d)):s.jsx(Gi,{highlight:o.dayId===d,children:u},d))})()]})}),a.map(({partId:l,name:c,intervals:d})=>s.jsxs(Dk,{children:[i&&d.length>0?s.jsxs(Jc,{children:[s.jsx(Gh,{children:c}),s.jsx(Gh,{colSpan:this.props.numberOfDisplayedDays,as:"td"})]}):null,d.map(u=>s.jsxs(Jc,{children:[s.jsx(rm,{fontWeight:n?.fontWeight,fontSize:n?.fontSize,highlight:this.isHeaderRowCellHighlighted(u.intervalId),children:u.name}),this.getDisplayedDays().map(m=>this.renderCells(m,u,l))]},u.intervalId))]},l))]})]})}};qo.propTypes=e0t;qo.defaultProps=t0t;qo.displayName="Slotbooking";qo.formattedPartOfDayPropType=jte;qo.formattedSlotPropType=wte;qo.slotPropType=Fte;qo.formattedDayPropType=Bte;qo.Table=xk;qo.Header=Rk;qo.Body=Dk;qo.Row=Jc;qo.Day=n0t;qo.ButtonRow=$h;qo.Cell=er;const Lv=T(b)`
    ${oe.smUp`
        width: auto;
    `}
    flex: 1;
`,c0t=({prevBtnLabel:e,nextBtnLabel:t,calendarBtnLabel:n})=>s.jsxs(h.Fragment,{children:[s.jsxs(Lv,{className:"salt-p-x--0",intent:"secondary",disabled:!0,fill:!0,children:[s.jsx(b.Icon,{name:"arrow_left"}),s.jsx(b.Text,{className:"xs:max-sm:salt-vc",children:e})]}),s.jsxs(Lv,{className:"salt-p-x--0 salt-m-x--1",intent:"secondary",disabled:!0,children:[s.jsx(b.Icon,{name:"calendar"}),s.jsx(b.Text,{className:"xs:max-sm:salt-vc",children:n})]}),s.jsxs(Lv,{className:"salt-p-x--0",intent:"secondary",disabled:!0,fill:!0,children:[s.jsx(b.Text,{className:"xs:max-sm:salt-vc",children:t}),s.jsx(b.Icon,{name:"arrow_right"})]})]}),d0t=({showDeliveryDetailsPlaceholder:e,labels:t})=>{const n=s.jsx(c0t,{prevBtnLabel:t.previous,nextBtnLabel:t.next,calendarBtnLabel:t.calendar}),o=s.jsxs("div",{className:"salt-m-b--2",children:[s.jsx(tu.Title,{}),s.jsxs(Gte,{children:[s.jsx(PI,{shouldUseThreeColumnLayout:e,children:s.jsx(SE,{})}),e&&s.jsx(PI,{shouldUseThreeColumnLayout:!0,children:s.jsx(yE.Skeleton,{})}),s.jsxs(Ute,{children:[" ",n," "]})]})]});return s.jsxs("div",{"data-test":"slot-grid-skeleton",children:[o,s.jsxs(xk,{children:[s.jsx(Rk,{children:s.jsxs(Jc,{children:[s.jsx(Gi,{}),["day1","day2","day3"].map(r=>s.jsxs(Gi,{children:[s.jsx(Pe,{width:"40px",height:"15px",className:"salt-d--inline-block"}),s.jsx("div",{children:s.jsx(Pe,{width:"60px",height:"15px",className:"salt-d--inline-block"})})]},r))]})}),["part1","part2","part3"].map(r=>s.jsxs(Dk,{children:[s.jsx(Jc,{children:s.jsx(Gh,{colSpan:4,children:s.jsx(Pe,{width:"0px",height:"15px"})})}),["time1","time2","time3","time4","time5"].map(a=>s.jsxs(Jc,{children:[s.jsx(rm,{children:s.jsx(Pe,{width:"50px",height:"15px"})}),["slot1","slot2","slot3"].map(i=>s.jsx(er,{children:s.jsx(Pe,{width:"30px",height:"15px",className:"salt-d--inline-block"})},i))]},a))]},r))]})]})},RG=({className:e="",shouldRenderDeliveryDetailsSelector:t,onDeliveryDetailsSaved:n,cancelSlotSelection:o,hasUnconfirmedSlot:r})=>s.jsx("div",{className:"salt-p-b--2",children:s.jsxs("div",{className:`salt-m-b--2 ${e}`,children:[s.jsx(tu.Title,{}),s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12,lg:t?6:12},children:s.jsx(SE,{})}),t&&s.jsx(Y.Item,{colSpan:{xs:12,lg:6},children:s.jsx(yE,{onDeliveryDetailsSaved:n,handleModalClose:o,hasUnconfirmedSlot:r})})]})]})}),u0t=D("mtz"),p0t=D("mtzsb"),m0t=D("sv.sl"),h0t=D("sv.sl.vb"),g0t=D("sl.rng.cf"),E0t=T.div`
    display: flex;
    align-items: center;
`,f0t={days:[],isSlotbookingDataPending:!1,slotBookedSuccessfully:!1,partsOfDay:[],slots:[],timeZoneId:null,selectedDeliveryDestinationId:null,isBasketDeliveryDestinationDeliverable:!1};let y0t=class extends h.Component{static defaultProps=f0t;queuedImpressions=[];labels;footerMessage;constructor(t){super(t),this.slotSelectionHandler=this.slotSelectionHandler.bind(this),this.queueImpression=this.queueImpression.bind(this),this.sendStandardSlotsButtonClickedEvent=this.sendStandardSlotsButtonClickedEvent.bind(this),this.sendSaverSlotsButtonClickedEvent=this.sendSaverSlotsButtonClickedEvent.bind(this),this.sendOnDemandSlotsImpression=this.sendOnDemandSlotsImpression.bind(this),this.sendSeenSlots=this.sendSeenSlots.bind(this),this.sendSeenSlotsForOnDemandSlotsOnly=this.sendSeenSlotsForOnDemandSlotsOnly.bind(this),this.sendPerformanceMark=this.sendPerformanceMark.bind(this),this.onDeliveryDetailsSaved=this.onDeliveryDetailsSaved.bind(this),this.cancelSlotSelection=this.cancelSlotSelection.bind(this),this.queuedImpressions=[],this.state={selectedSlot:null,unconfirmedSlot:null},this.labels={alert:{title:t.intl.formatMessage("slotbooking.alert.first.available.slot"),viewSlot:t.intl.formatMessage("slotbooking.alert.first.available.slot.view")},next:t.intl.formatMessage("slotbooking.table.next.days"),previous:t.intl.formatMessage("slotbooking.table.previous.days"),previousCompleteText:t.intl.formatMessage("slotbooking.table.previous.days.complete.text"),fillerText:t.intl.formatMessage("slotbooking.table.filler.text"),weekDays:{sun:t.intl.formatMessage("slotbooking.table.week.days.sun"),mon:t.intl.formatMessage("slotbooking.table.week.days.mon"),tue:t.intl.formatMessage("slotbooking.table.week.days.tue"),wed:t.intl.formatMessage("slotbooking.table.week.days.wed"),thu:t.intl.formatMessage("slotbooking.table.week.days.thu"),fri:t.intl.formatMessage("slotbooking.table.week.days.fri"),sat:t.intl.formatMessage("slotbooking.table.week.days.sat")},calendar:t.intl.formatMessage("slotbooking.table.calendar.header"),cancel:t.intl.formatMessage("slotbooking.table.calendar.cancel.link"),slotAriaViewSlot:t.intl.formatMessage("slotbooking.aria.view.first.slot"),slotAriaDate:t.intl.formatMessage("slotbooking.table.cell.aria.date"),slotAriaTime:t.intl.formatMessage("slotbooking.table.cell.aria.time"),slotAriaCost:t.intl.formatMessage("slotbooking.table.cell.aria.price"),nextMonth:n=>t.intl.formatMessage("calendar.next.month",{month:n}),currentMonth:n=>t.intl.formatMessage("calendar.current.month",{month:n}),previousMonth:n=>t.intl.formatMessage("calendar.previous.month",{month:n}),datePickerAlternative:t.intl.formatMessage("calendar.alternative"),slotsUnavailable:{body:t.intl.formatMessage("slotbooking.slot.unavailable.body")}},this.footerMessage=t.intl.formatMessage("slotbooking.table.footer")}componentDidMount(){this.sendImpressions()}componentDidUpdate(t){const n=t.isSlotbookingDataPending&&!this.props.isSlotbookingDataPending,{actions:o}=this.props;n&&o.performanceMark({name:h2}),this.sendImpressions()}getDeliveryPriceInfo({slotDayId:t,slotPartId:n,slotIntervalId:o}){return this.props.slots.filter(r=>r.slotDayId===t).filter(r=>r.slotPartId===n).filter(r=>r.slotIntervalId===o).map(r=>r&&r.deliveryPrice?{DELIVERY_PRICE_AMOUNT:r.deliveryPrice.amount,DELIVERY_PRICE_CURRENCY:r.deliveryPrice.currency}:{})[0]||{}}getTimeZoneMessage(){const{timeZoneId:t,defaultTimeZoneId:n,multiTimeZoneEnabled:o,multiTimeZoneSlotBookingEnabled:r,serverRendered:a}=this.props,i=this.props.deliveryMethod===Et.clickAndCollect.method?"slotbooking.delivery.cnc.timezone.alert":"slotbooking.delivery.home.timezone.alert";return!a&&o&&r&&t&&t!==ih(n)&&s.jsx(Ce,{intent:"info",text:s.jsx(v,{id:i}),className:"salt-m-y--4","data-test":"timezone-message"})||null}findSlot(t){const{slots:n,onDemandSlots:o=[]}=this.props;return[...o,...n].find(a=>a.slotId===t?.slotId)}getTimeRangeStyles(){const{slotTimeRangeConfigurationEnabled:t,timeRangeStyles:n}=this.props;return t?n:null}onDeliveryDetailsSaved(t){this.state.unconfirmedSlot&&(this.slotSelectionHandler(this.state.unconfirmedSlot,()=>{},()=>{},t),this.setState({unconfirmedSlot:null}))}cancelSlotSelection(){this.setState({unconfirmedSlot:null,selectedSlot:null})}slotSelectionHandler(t,n=()=>{},o=()=>{},r){const{actions:a,deliveryType:i,deliveryMethod:l,selectedDeliveryDestinationId:c,isDeliveryAdditionalInfoFeatureEnabled:d,deliveryDetailsOptions:u,isDeliveryDetailsFeatureEnabled:m,isDeliveryAssetsFeatureEnabled:g,shouldPrepareDeliveryDetails:f}=this.props;this.setState({selectedSlot:t},()=>{const y=this.findSlot(t);if(!y)return;if(f&&!bte({deliveryOptions:r??u,featureFlags:{isDropOffRequired:m,isDeliveryAssetRequired:g,isAdditionalInfoRequired:d}})){a.openModal(lE),this.setState({unconfirmedSlot:y});return}const{deliveryPrice:I,minimumOrder:S,slotId:C}=y;this.sendPerformanceMark(),a.selectSlot({slotId:C,deliveryPrice:I,minimumOrder:S,deliveryType:i,deliveryMethod:l,deliveryDestinationId:c},this.props.navigate).then(n).catch(o)})}formatDays(){const{dateFormat:t,days:n}=this.props,{formatDateWithFixedTimezone:o}=vm;return n?.map(r=>({dayId:r.dayId,dayName:o(r.date,t),order:r.order,iso:r.date,hasAnyAvailableSlot:r.hasAnyAvailableSlot}))||[]}formatIntervalFromConfig(t,n){const{slotTimeRangeConfigurationEnabled:o,intl:r,timeFormat:a}=this.props,{formatInterval:i,getFormattedIntervalDates:l}=vm;if(!o)return i(t,n,a);const{timeRangeFormat:{startFormat:c,endFormat:d}}=this.props,{fromDate:u,toDate:m}=l(t,n,c,d);return r.formatMessage("slotbooking.table.time.range.format",{startTime:u,endTime:m})}formatPartsOfDay(){return this.props.partsOfDay?.map(({partId:t,intervals:n})=>({partId:t,name:this.props.intl.formatMessage(`slotbooking.table.part.of.day.${t}`),intervals:n.map(({intervalId:o,start:r,end:a,order:i})=>({intervalId:o,name:this.formatIntervalFromConfig(r,a),order:i,start:r,end:a}))}),{})||[]}formatDeliveryPrice(t){return t?parseFloat(t.amount)===0?this.props.intl.formatMessage("slotbooking.table.price.free"):$a(this.props.intl.formatNumber,t,this.props.currencyFormat):null}formatSlots(){return this.props.slots?.reduce((t,n)=>{const{slotDateTimeISO:o,slotDayId:r,slotPartId:a,slotIntervalId:i,slotId:l,deliveryPrice:c,minimumOrder:d,attributes:u}=n;if(a){const m=b$t(n,this.props.deliveryMethod);t[r]=t[r]||{},t[r][a]=t[r][a]||{},t[r][a][i]={slotId:l,available:u.includes("AVAILABLE"),price:this.formatDeliveryPrice(c),minimumOrder:d,slotDateTimeISO:o,ecoSlot:m}}return t},{})}sendImpressions(){if(this.queuedImpressions.length>0){const t=this.queuedImpressions;this.props.actions.analyticsEvent({type:Fe.SLOT_IMPRESSION,impressions:t}),this.queuedImpressions=[]}this.sendSeenSlotsForOnDemandSlotsOnly()}queueImpression(t){const n={INTERVAL_START:t.intervalStart,INTERVAL_END:t.intervalEnd,INTERVAL_START_DATE:t.intervalStartDate,INTERVAL_TIME_ZONE_ID:t.intervalTimeZoneId,IS_AVAILABLE:t.isAvailable,SLOT_TYPE:t.slotType,...this.getDeliveryPriceInfo(t)};this.queuedImpressions.push(n)}sendOnDemandSlotsImpression(t){this.props.actions.analyticsEvent({type:Fe.SLOT_IMPRESSION,impressions:[t]})}sendPerformanceMark(){this.props.actions.performanceMark({name:g2,attributes:{deliveryType:this.props.deliveryType,deliveryMethod:this.props.deliveryMethod}})}sendSlotbookingPageAttributes(t){this.props.actions.analyticsEvent({type:As.PAGE_ATTRIBUTES_MULTIPLE,attributes:{SLOTBOOKING_MAX_SLOTS:t,SLOTBOOKING_ADDRESS_ID:this.props.selectedAddressId,SLOTBOOKING_DELIVERY_DESTINATION_ID:this.props.selectedDeliveryDestinationId,DEFAULT_DELIVERY_DESTINATION_ID_AVAILABLE:this.props.isBasketDeliveryDestinationDeliverable}})}sendStandardSlotsButtonClickedEvent(){this.props.actions.analyticsEvent({type:Fe.STANDARD_SLOTS_BUTTON_CLICKED,description:xr[Fe.STANDARD_SLOTS_BUTTON_CLICKED]}),this.props.setSearchParams(t=>(t.set("slotGroup","standard"),t))}sendSaverSlotsButtonClickedEvent(){this.props.actions.analyticsEvent({type:Fe.SAVER_SLOTS_BUTTON_CLICKED,description:xr[Fe.SAVER_SLOTS_BUTTON_CLICKED]}),this.props.setSearchParams(t=>(t.set("slotGroup","saver"),t))}slotSelectionHandlerPromise(){return t=>new Promise((n,o)=>{this.slotSelectionHandler(t,n,o)})}getCarrierIdForAnalytics(){return this.props.slots[0]?.carrierId}sendSeenSlots(t){const{onDemandSlots:n}=this.props,o=n.map(r=>r.slotId);this.props.actions.sendSeenSlots({seenSlots:[...o,...t]})}sendSeenSlotsForOnDemandSlotsOnly(){!this.props.slots.length&&this.props.onDemandSlotsAvailable&&this.sendSeenSlots([])}renderOnDemandSlots(){return s.jsx(Ate,{onReserve:this.slotSelectionHandlerPromise(),sendImpression:this.sendOnDemandSlotsImpression,className:"salt-p-y--2 md:salt-m-t--0",classNameForCard:"salt-m-l--2"})}renderSelectSlotModal(){const{selectedSlot:t}=this.state;return s.jsx(Zc,{selectedSlot:t,slotSelectionHandler:()=>this.slotSelectionHandler(t),fetchSlots:this.props.fetchSlots})}render(){const{slots:t,activeRawStandardSlotIdsMap:n,isSlotbookingDataPending:o,shouldPrepareDeliveryDetails:r,selectedDeliveryDestinationId:a,areAddressesFetching:i,dropOffOptions:l,onDemandSlotsAvailable:c}=this.props,d=!t.length&&i,u=!!t.length||c,m=r&&u&&!!l.length;if(o||!a||d)return s.jsxs(h.Fragment,{children:[this.renderSelectSlotModal(),s.jsx(d0t,{showDeliveryDetailsPlaceholder:r,labels:this.labels})]});if(!u)return s.jsxs("div",{className:"salt-p-b--2",children:[s.jsx(RG,{className:"salt-m-y--0",shouldRenderDeliveryDetailsSelector:m,onDeliveryDetailsSaved:this.onDeliveryDetailsSaved,cancelSlotSelection:this.cancelSlotSelection,hasUnconfirmedSlot:!!this.state.unconfirmedSlot}),s.jsx(Ce,{className:"salt-m-b--2","data-synthetics":"no-slots-warning",intent:"error",showIcon:!1,text:this.labels.slotsUnavailable.body})]});if(t.length){const g=this.formatSlots(),f=Object.values(g).some(y=>Object.values(y).some(I=>Object.values(I).some(S=>S.ecoSlot)));return s.jsxs(h.Fragment,{children:[this.getTimeZoneMessage(),s.jsx(qo,{startDayIso:this.props.startDayIsoFromUrlParams,shouldRenderDeliveryDetailsSelector:m,onDemandSlotsAvailable:c,onDemandSlotsComponent:this.renderOnDemandSlots(),dateFormat:this.props.dateFormat,days:this.formatDays(),firstSlot:this.props.slots[0],dateTime:vm,labels:this.labels,partsOfDay:this.formatPartsOfDay(),slots:g,activeRawStandardSlotIdsMap:n,slotSelectionHandler:this.slotSelectionHandler,timeRangeStyles:this.getTimeRangeStyles(),timeFormat:this.props.timeFormat,timeZoneId:this.props.timeZoneId,impression:y=>{this.queueImpression(y)},sendSlotbookingPageAttributes:y=>{this.sendSlotbookingPageAttributes(y)},sendQueuedImpressions:()=>this.sendImpressions(),slotBookedSuccessfully:this.props.slotBookedSuccessfully,isSlotFetching:this.props.isSlotFetching,hasSelectedSlotFetchError:this.props.hasSelectedSlotFetchError,selectedSlotGroup:this.props.selectedSlotGroup,isSaverSlotsVCEnabled:this.props.saverSlotsEnabled&&!this.props.saverSlotsVBEnabled,sendStandardSlotsButtonClickedEvent:this.sendStandardSlotsButtonClickedEvent,sendSaverSlotsButtonClickedEvent:this.sendSaverSlotsButtonClickedEvent,formatMessage:this.props.intl.formatMessage,carrierId:this.getCarrierIdForAnalytics(),sendSeenSlots:this.sendSeenSlots,onDeliveryDetailsSaved:this.onDeliveryDetailsSaved,cancelSlotSelection:this.cancelSlotSelection,hasUnconfirmedSlot:!!this.state.unconfirmedSlot}),this.footerMessage?.length>0&&s.jsx("div",{className:"salt-m-y--4",children:s.jsx(P,{children:this.footerMessage})}),f&&s.jsxs(E0t,{className:"salt-m-y--4",children:[s.jsx(me,{className:"salt-m-r--2 salt--r--2",name:"eco_slot",success:!0}),s.jsx(P,{children:this.props.intl.formatMessage("slots_grid_green_van_footer_message")})]}),this.renderSelectSlotModal()]})}return s.jsxs("div",{className:"salt-m-b--2",children:[s.jsx(RG,{shouldRenderDeliveryDetailsSelector:m,onDeliveryDetailsSaved:this.onDeliveryDetailsSaved,cancelSlotSelection:this.cancelSlotSelection,hasUnconfirmedSlot:!!this.state.unconfirmedSlot}),this.renderOnDemandSlots(),this.renderSelectSlotModal()]})}};const I0t=e=>({partsOfDay:Ld(e),days:_D(e),slots:DD(e),activeRawStandardSlotIdsMap:zq(e),onDemandSlots:ND(e),selectedAddressId:d5(e)??Qs(e).data?.addressId,selectedDeliveryDestinationId:uo(e)??Qs(e).data?.deliveryDestinationId,isBasketDeliveryDestinationDeliverable:pS(e),isSlotbookingDataPending:_g(e),hasSelectedSlotFetchError:ZD(e),slotBookedSuccessfully:cK(e),dateFormat:Jt(e),timeFormat:Vt(e),timeRangeStyles:pae(e),timeRangeFormat:Wb(e),defaultTimeZoneId:Ed(e),timeZoneId:a$e(e),multiTimeZoneEnabled:u0t(e),multiTimeZoneSlotBookingEnabled:p0t(e),onDemandSlotsAvailable:o$e(e),serverRendered:Yt(e),isSlotFetching:uC(e),startDayIsoFromUrlParams:WP(e),saverSlotsEnabled:m0t(e),saverSlotsVBEnabled:h0t(e),selectedSlotGroup:Rp(e),slotTimeRangeConfigurationEnabled:g0t(e),seasonalSlotPeriods:OD(e),dropOffOptions:nm(e),deliveryDetailsOptions:xi(e),isDeliveryDetailsFeatureEnabled:D("dede")(e),isDeliveryAssetsFeatureEnabled:D("dass")(e),isDeliveryAdditionalInfoFeatureEnabled:D("daddi")(e),currencyFormat:pi(e)}),S0t=ot({selectSlot:_k.selectSlot,analyticsEvent:U.analyticsEvent,performanceMark:ks,sendSeenSlots:vA.seenSlots,openModal:Z.openModal}),C0t=Ct(Bt,ke(I0t,S0t))(y0t),T0t=({data:e})=>e.adverts.slotBookingPage,$te=()=>{const{placement:e,isFetching:t,settings:n}=E(T0t),o=E(RD),r="advertising-banner-below-slot-booking",a=e.belowGrid||[],i=!!a.length,l=E(xs),c=l==="CUSTOMER_COLLECTION"||l==="HOME_DELIVERY",d=E(ma),u=E(Ql),m=c&&u?.slotType==="ON_DEMAND"&&u.deliveryMethod===l&&u.deliveryDestinationId===d,f=i&&(o||m)&&!t;return s.jsx(UJe,{children:f?s.jsx(IP,{"data-test":r,adverts:a,advertDimensionsMap:d8,page:"slot-booking",pageKey:void 0,placement:"BELOW_GRID",randomInitialIndex:n.randomizeInitialHorizontalAdvert,sizes:["LARGE","MEDIUM","SMALL"]}):null})},_0t=({onRetry:e=()=>{}})=>s.jsx(Y,{children:s.jsx(Y.Item,{colSpan:{xs:10,sm:8,md:6,lg:4},colStart:{xs:2,sm:3,md:4,lg:5},children:s.jsx(ln,{title:"carriers-slot-booking.geowidget.empty.title",titleIcon:"status_no",description:"carriers-slot-booking.geowidget.empty.text",primaryButton:{text:"carriers-slot-booking.geowidget.empty.button.text",onClick:e}})})}),DG="geowidget",kv="onSelectInPostPoint",v0t=e=>!!e.detail?.api,A0t=({onPointSelected:e,onApiLoaded:t,onError:n=()=>{},language:o="pl",config:r="parcelCollect"})=>{const a=E(i=>qe(i,"inpost-geowidget-token"));return h.useEffect(()=>{const i=document.getElementById(DG);i?.addEventListener("inpost.geowidget.init",u=>{v0t(u)&&(t(u.detail.api),i.style.display="initial")});const l=document.createElement("link"),c=document.createElement("script"),d=document.getElementsByTagName("body")[0];return l.id="inpost-stylesheet",l.rel="stylesheet",l.href="https://geowidget.inpost.pl/inpost-geowidget.css",l.type="text/css",c.id="inpost-script",c.defer=!0,c.src="https://geowidget.inpost.pl/inpost-geowidget.js",c.addEventListener("error",()=>n()),d?.appendChild(l),d?.appendChild(c),()=>{d?.removeChild(l),d?.removeChild(c)}},[]),h.useEffect(()=>(window[kv]=e,()=>{delete window[kv]}),[e]),ie.createElement("inpost-geowidget",{style:{display:"none"},id:DG,token:a,onPoint:kv,language:o,config:r,"data-test":"inpost-geowidget-component"})},b0t=T(se)`
    inline-size: calc(100% - 30px);
    gap: var(--salt-spacing-1);
`,Hte=({iconName:e,title:t,subTitle:n,bodyText:o,className:r})=>s.jsx(ve,{className:r,children:s.jsxs(se,{children:[s.jsx(me,{name:e,className:"salt-m-r--2",height:21,width:21}),s.jsxs(b0t,{direction:"column",children:[s.jsx(P,{size:"l",bold:!0,children:t}),s.jsx(ne,{as:"span",children:n}),s.jsxs(P,{children:[" ",o," "]})]})]})}),Vte="560px",x0t=T.div`
    block-size: 70vb;
    min-block-size: ${Vte};
`,R0t=(e,t)=>t?.attributes.includes("REPRICEABLE")?e.formatMessage("carriers-slot-booking.slot-info",{info:e.formatMessage("slot.repriceable.text"),additionalInfo:e.formatMessage("carriers-slot-booking.geowidget.additional.info")}):e.formatMessage("carriers-slot-booking.geowidget.additional.info"),Yte=({slot:e,carrier:t,onContinueCheckout:n,className:o=""})=>{const r=M(),a=Ig(t),[i,l]=h.useState(!1),[c,d]=h.useState(!1),{data:u}=E(Qs),{courierSlotImpression:m}=bo(),g=Mq(t.slotTimesDisplayMode,e,t.title,r),f=y=>{d(!0),u?.coordinates&&y.changePosition({latitude:u.coordinates.latitude,longitude:u.coordinates.longitude})};return h.useEffect(()=>{m(e)},[e]),s.jsxs("div",{className:o,children:[s.jsx(Hte,{className:"salt-m-b--4",iconName:"third_party_shipping",title:g,subTitle:a,bodyText:R0t(r,e)}),i?s.jsx(_0t,{onRetry:()=>l(!1)}):s.jsxs(x0t,{className:"salt-m-y--2",children:[!c&&s.jsx(Pe,{"data-test":"in-post-map-skeleton",height:Vte}),s.jsx(A0t,{onApiLoaded:f,onPointSelected:n,onError:()=>l(!0)})]})]})},D0t=({loading:e=!1,onContinueCheckout:t=()=>{}})=>{const n=M();return s.jsx(b,{intent:"action",onClick:e?void 0:t,className:"salt-m-y--2",loading:e,disabled:e,children:s.jsx(b.Text,{children:n.formatMessage("carriers-slot-booking.continue.checkout-button")})})},Wte=T.div`
    display: flex;
    position: relative;
    justify-content: center;
    inline-size: 100%;
    padding-block-end: var(--salt-spacing-4);
`,Ok=T(Y)`
    inline-size: 100%;
`,O0t=T.table`
    border-collapse: separate;
    border-spacing: 0;
    table-layout: fixed;
    inline-size: calc(100% + var(--salt-spacing-1));

    & tbody:first-of-type tr:first-child td {
        padding-block-start: var(--salt-spacing-2);
    }
`,P0t=T.thead`
    position: sticky;
    inset-block-start: ${({top:e})=>e};
    z-index: 1;
    background-color: var(--background-color);
`,N0t=T.div`
    position: relative;
    inline-size: 100%;
    block-size: 100%;
    display: flex;
    align-items: center;
`,Pk=T.td`
    block-size: 32px;
    text-align: center;
    align-content: center;
    border-radius: var(--salt-radius-default);
    padding: ${({isMobile:e})=>e?"calc(var(--salt-spacing-1) * 0.5)":"var(--salt-spacing-1)"};
`,L0t=T.div`
    inline-size: ${({width:e})=>e||"100%"};
`,k0t=T(Pk)`
    text-align: start;
`,M0t=T.div`
    position: absolute;
    block-size: 32px;
    border-end-start-radius: var(--salt-radius-default);
    border-start-start-radius: var(--salt-radius-default);
    background-image: linear-gradient(to right, rgba(255 255 255 / 80%), rgba(255 255 255 / 10%));
    inline-size: 12px;
    inset-inline-end: -14px;
`,j0t=T.th`
    block-size: 100%;
    inset-inline-end: -8px;
    position: absolute;
    background-color: var(--background-color);
    inline-size: 8px;
    inset-block-start: 0;
`,qte=T.th`
    padding-block: var(--salt-spacing-2);
`,w0t=T.th`
    padding: 0;
`,F0t=T(qte)`
    block-size: var(--salt-spacing-4);
    text-align: center;
    font-weight: 600;
`,B0t=T(qte)`
    text-align: start;

    button {
        padding: 0;
    }
`,U0t=T.div`
    display: flex;
    align-items: center;
`,G0t=T.div`
    display: flex;
    gap: 5px;
    block-size: 32px;
`,OG=T(Pk)`
    block-size: 16px;
    font-weight: bold;
    text-align: start;
    z-index: -1; /* TODO refactor z-indexes, -1 fixes overflow with calendar */
`,$0t=Yl`
    0% { opacity: 0; }
    100% { opacity: 1; }
`,H0t=T(Pk)`
    animation: ${$0t};
    animation-duration: 1s;
    position: relative;
`,V0t=T(ve)`
    align-items: center;
    cursor: pointer;
    display: flex;
    block-size: ${H(40)};
    gap: var(--salt-spacing-2);

    &:hover {
        box-shadow: var(--salt-elevation-shadow-1);
    }
`,Y0t=T.span`
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
`,W0t=({onConfirm:e})=>{const t=F(),{status:n,value:o}=Zd(),r=()=>{t(Z.closeModal()),setTimeout(o,0)};return s.jsxs(Ok,{flush:!0,className:"salt-gap--2",children:[s.jsx(Y.Item,{colSpan:{xs:6},children:s.jsx(b,{fill:!0,intent:"secondary",disabled:n!=="READY",onClick:r,children:s.jsx(b.Text,{children:s.jsx(v,{id:"slotbooking.address.select.add.new.address"})})})}),s.jsx(Y.Item,{colSpan:{xs:6},children:s.jsx(b,{fill:!0,intent:"primary",onClick:e,children:s.jsx(b.Text,{children:s.jsx(v,{id:"slotbooking.address.select.confirm"})})})})]})},q0t=T(ve)`
    border-radius: var(--salt-radius-default);
    background-color: var(--intent-contrast) !important;
`,K0t=({onAddressSelect:e,selectedAddress:t,deliveryAddresses:n})=>{const[o]=fe(["nfslt"]),{formatMessage:r}=M();return n.length===0?null:o?s.jsx(ve,{className:"salt-overflow-wrap--anywhere",children:s.jsx(mt.RadioGroup,{groupLabel:{text:r("slotbooking.address.select.title"),isVisuallyConcealed:!0},name:"addressSelect",value:t?.deliveryDestinationId,onChange:a=>{const i=n.find(l=>l.deliveryDestinationId===a);i&&e(i)},radios:n.map(a=>({value:a.deliveryDestinationId,label:a.name,additionalText:a.formattedAddress})),required:!0})}):s.jsx(ie.Fragment,{children:n.map(a=>s.jsx(q0t,{className:"salt-m-b--0.5 salt-overflow-wrap--anywhere",children:s.jsx(ia,{checked:t?.deliveryDestinationId===a.deliveryDestinationId,onClick:()=>e(a),label:a.name,value:a.deliveryDestinationId,children:a.formattedAddress})},a.deliveryDestinationId))})},Hh="ADDRESS_SELECT_MODAL",z0t=()=>s.jsx("span",{id:Hh,"data-test":Hh,"aria-live":"polite",children:s.jsx(v,{id:"slotbooking.address.select.title"})}),Q0t=()=>{const e=F(),{emitOnAddressChangeEvent:t}=vk(),n=E(ma),[o,r]=h.useState(void 0),{isOpen:a,close:i}=wt(Hh),l=E(mx),c=()=>i(),d=()=>{if(o){const{addressId:m,deliveryDestinationId:g}=o;n!==g&&(t(g),e(ea.setSelectedAddress({addressId:m,deliveryDestinationId:g})))}i()};h.useEffect(()=>{const m=l.find(g=>g.deliveryDestinationId===n);m&&r(m)},[l,n]);const u={onAddressSelect:r,selectedAddress:o,deliveryAddresses:l};return s.jsxs(G,{isOpen:a,onRequestClose:c,aria:{labelledby:Hh},asBottomSheet:!0,children:[s.jsx(G.Header,{align:"left",children:s.jsx(ne,{as:"h2",children:s.jsx(z0t,{})})}),s.jsx(G.Body,{children:s.jsx(K0t,{...u})}),s.jsx(G.Footer,{children:s.jsx(W0t,{onConfirm:d})})]})},Kte=(e,t,n)=>Object.values(e).find(o=>o.deliveryDestinationId===t||o.addressId===n),X0t=(e,t,n)=>{const o=Kte(e,t,n);return o||{deliveryDestinationId:t}},Z0t=()=>{const e=F(),t=E(fE);return{selectAddress:h.useCallback((o,r)=>{const a=X0t(t,o,r);e(ea.setSelectedAddress(a))},[e,t])}},J0t=()=>{const{formatMessage:e}=M(),{emitOnDropdownClickEvent:t,emitOnCollectionPointMapOpenEvent:n}=vk(),o=E(fE),r=E(Pp),a=E(xs),i=E(uo),l=E(Qs),c=Kte(o,i),{open:d}=wt(Hh),{open:u}=wt(hc),{selectAddress:m}=Z0t();return{anySlotListingRequestPending:r,deliveryMethod:a,selectedAddress:c,onChangeCollectionPoint:u,selectAddress:m,deliveryAddresses:o,getAriaLabel:()=>e("accessibility.delivery.selected.address",{delivery_method:e(a==="HOME_DELIVERY"?"delivery.type.name.van":"delivery.type.name.cnc"),address_name:c?.name,address:c?.formattedAddress}),openAddressSelectionModal:()=>{t(),a==="HOME_DELIVERY"&&d(),a==="CUSTOMER_COLLECTION"&&(n(),u({postalCode:l.data?.postalCode}))}}},Nk=({className:e=""})=>{const{getAriaLabel:t,selectedAddress:n,anySlotListingRequestPending:o,openAddressSelectionModal:r}=J0t(),a=n?s.jsxs("button",{onClick:r,type:"button",disabled:o,"aria-label":t(),className:e,"data-test":"address-select-button",children:[s.jsx(Y0t,{children:s.jsx(v,{id:"delivery.address.select.text",values:{addressName:s.jsx(P,{size:"m",bold:!0,children:n?.name}),address:s.jsx(P,{size:"m",children:n?.formattedAddress})}})}),s.jsx(me,{name:"edit"})]}):s.jsx(Pe.Button,{fill:!0,"data-test":"address-select-skeleton"});return s.jsxs(h.Fragment,{children:[s.jsx(V0t,{asChild:!0,condensed:!0,children:a}),s.jsx(Q0t,{})]})},e1t=T.div`
    inline-size: 100%;
`,zte=({withDropdown:e=!0,className:t="salt-m-x--2"})=>s.jsxs("div",{className:t,children:[e&&s.jsxs("div",{className:"salt-m-b--4",children:[s.jsx(tu.Title,{}),s.jsx(SE,{})]}),s.jsxs(ve,{className:"salt-d--flex salt-m-b--2",children:[s.jsx(me,{name:"calendar",height:21,width:21}),s.jsxs(e1t,{className:"salt-m-l--2",children:[s.jsx(Pe,{className:"salt-m-b--2",height:"28px",width:"40%"}),s.jsx(Pe,{height:"28px",width:"20%",className:"salt-m-b--2"}),s.jsx(Pe,{height:"28px",width:"60%",className:"salt-m-b--2"})]})]})]}),t1t=(e,t)=>t?.attributes.includes("REPRICEABLE")?e.formatMessage("slot.repriceable.text"):"",Qte=({slot:e,loading:t=!1,onContinueCheckout:n,carrier:o,className:r=""})=>{const a=M(),[i]=fe(["sl.rd"]),l=Ig(o),c=Mq(o.slotTimesDisplayMode,e,o.title,a),{continueCheckoutButtonClicked:d,courierSlotImpression:u}=bo(),m=()=>{n(),d()};return h.useEffect(()=>{u(e)},[e]),s.jsxs("div",{className:r,children:[s.jsx("div",{className:"salt-m-b--4",children:i?s.jsx(Nk,{}):s.jsxs(h.Fragment,{children:[s.jsx(tu.Title,{}),s.jsx(SE,{})]})}),s.jsx(Hte,{className:"salt-m-b--2",iconName:"calendar",title:c,subTitle:l,bodyText:t1t(a,e)}),s.jsx(D0t,{loading:t,onContinueCheckout:m})]})},s1t=e=>{if(e?.name&&e?.address_details.post_code&&e?.address.line1&&e?.address.line2)return{externalCollectionPointId:e?.name,addressDetails:{postalCode:e?.address_details.post_code,formattedAddress:`${e?.address.line1}, ${e?.address.line2}`,locationDescription:e?.location_description,openingHours:e?.opening_hours}}},n1t=async(e,t,n,o,r,a,i,l)=>{if(n&&r&&a&&o)try{await t(_k.selectSlot({slotId:n.slotId,deliveryPrice:n.deliveryPrice,minimumOrder:n.minimumOrder,deliveryType:r,deliveryMethod:a,deliveryDestinationId:o,externalAddress:i,carrierName:l},e))}catch{}return Promise.resolve()},Xte=()=>{const e=F(),t=We(),n=E(uo),o=E(e$e),r=E(hx),a=E(xs),[i,l]=h.useState(!1),c=E(cl)?.title,d=h.useCallback(async g=>{i||(l(!0),await n1t(t,e,o,n,r,a,g,c),l(!1))},[o,r,a,n,i,e,t]),u=h.useCallback(()=>{d()},[d]),m=h.useCallback(g=>{const f=s1t(g);d(f)},[d]);return{selectSlot:u,selectExternalAddressSlot:m,carrierSlot:o,selectSlotLoading:i}},Zte=({openCollectionPointModal:e})=>s.jsx("div",{className:"salt-p-t--8","aria-live":"polite","data-test":"select-cnc-view",children:s.jsx(Y,{children:s.jsx(Y.Item,{colSpan:{xs:10,sm:8,md:6,lg:4},colStart:{xs:2,sm:3,md:4,lg:5},children:s.jsx(ln,{titleIcon:"info_default",title:"slotbooking.select.cnc.title",description:"slotbooking.select.cnc.description",primaryButton:{text:"slotbooking.select.cnc.button",onClick:()=>e()}})})})}),o1t=()=>{const e=F(),n=E(Zl)?tO:Ah;return()=>e(Z.openModal(n))},Jte=()=>{const{status:e,value:t}=Zd(),n=o1t(),o={text:"addresses.add.address",onClick:()=>{e==="READY"&&t()}},r={text:"slotbooking.temporary.delivery.destination.choose.existing.address",onClick:n};return s.jsx("div",{className:"salt-p-t--8","aria-live":"polite","data-test":"temporary-delivery-destination-view",children:s.jsx(Y,{children:s.jsx(Y.Item,{colSpan:{xs:10,sm:8,md:6,lg:4},colStart:{xs:2,sm:3,md:4,lg:5},children:s.jsx(ln,{titleIcon:"info_default",title:"slotbooking.temporary.delivery.destination.title",titleAs:"h2",description:"slotbooking.temporary.delivery.destination.description",primaryButton:o,secondaryButton:r})})})})},ese=()=>{const{status:e,value:t}=Zd(),n=e==="READY"?{text:"addresses.add.address",onClick:t}:void 0;return s.jsx("div",{className:"salt-p-t--8","aria-live":"polite","data-test":"no-addresses-view",children:s.jsx(Y,{children:s.jsx(Y.Item,{colSpan:{xs:10,sm:8,md:6,lg:4},colStart:{xs:2,sm:3,md:4,lg:5},children:s.jsx(ln,{titleIcon:"info_default",title:"slotbooking.no.addresses.title",titleAs:"h2",description:"slotbooking.no.addresses.description",primaryButton:n})})})})},Lk="CUSTOMER_COLLECTION_SIMPLE",tse={titleId:"slotbooking.unavailable.delivery.title",detailsId:"slotbooking.unavailable.delivery.details"},r1t={[Et.vanDelivery.method]:tse,[Et.clickAndCollect.method]:{titleId:"slotbooking.unavailable.cnc.title",detailsId:"slotbooking.unavailable.delivery.details"},[Lk]:{titleId:"slotbooking.unavailable.cnc.simple.title",detailsId:"slotbooking.unavailable.cnc.simple.details"}},NI=({variant:e,primaryButton:t})=>{const n=r1t[e]||tse;return s.jsx("div",{className:"salt-p-t--8","aria-live":"polite","data-test":"unavailable-delivery-view",children:s.jsx(Y,{children:s.jsx(Y.Item,{colSpan:{xs:10,sm:8,md:6,lg:4},colStart:{xs:2,sm:3,md:4,lg:5},children:s.jsx(ln,{titleIcon:"info_default",title:n.titleId,titleAs:"h2",description:n.detailsId,primaryButton:t})})})})},a1t=({slotBooked:e,deliveryMethod:t,fetchSlots:n,deliveryType:o,inCheckoutWalk:r,noDefaultCncAddress:a})=>{const[i,l]=h.useState(void 0),c=F(),d=We(),[u,m]=ip(),g=E(Qq),f=E(Gd),y=E(Wp),I=E(Q8),[S,C,_]=fe(["dcbbs","dds","dede"]),A=E(_i),x=E(cl),R=E(_g),{selectPickUpPointButtonClicked:O,selectExternalCollectionPointClicked:N}=bo(),{open:k}=wt(hc),j=E(uo),w=E(Fa),L=j||w,B=E(q8),W=!!(_&&t!==Et.clickAndCollect.method&&!A);h.useEffect(()=>{W&&c(TL({deliveryDestinationId:L}))},[W,L]);const $=()=>{if(C)return{text:"slotbooking.open.dds",onClick:()=>c(Z.openModal(kp))}},K=()=>{if(C)return{text:"slotbooking.open.simple.dds",onClick:()=>{c(Z.openModal(Lp)),O()}}},{selectSlot:Q,selectExternalAddressSlot:X,carrierSlot:re,selectSlotLoading:ue}=Xte(),te=de=>{de&&N(de),l(de),X(de)},ce=()=>{X(i)};return A&&R?s.jsx(zte,{}):A&&x?.type===Yi?s.jsx(NI,{variant:Lk,primaryButton:K()}):A&&x?.view===Dq?s.jsxs(h.Fragment,{children:[s.jsx(Qte,{className:"salt-m-x--2",slot:re,loading:ue,carrier:x,onContinueCheckout:Q}),s.jsx(Zc,{selectedSlot:re,slotSelectionHandler:Q,fetchSlots:n})]}):A&&x?.view===Rq?s.jsxs(h.Fragment,{children:[s.jsx(Yte,{className:"salt-m-x--2",slot:re,carrier:x,onContinueCheckout:te}),s.jsx(Zc,{selectedSlot:re,slotSelectionHandler:ce,fetchSlots:n})]}):y?s.jsx(NI,{variant:t,primaryButton:$()}):I?s.jsx(ese,{}):a?s.jsx(Zte,{openCollectionPointModal:k}):B?s.jsx(Jte,{}):s.jsxs(Bo,{className:"salt-m-x--2",children:[S&&s.jsx(bI,{slotBooked:e,expand:!0}),g?s.jsx(eu,{titleAs:"h2",action:n}):s.jsxs(Bo,{className:"salt-m-t--4",children:[s.jsx(C0t,{goBack:()=>d(-1),deliveryType:o,deliveryMethod:t,inCheckoutWalk:r,fetchSlots:n,shouldPrepareDeliveryDetails:W,areAddressesFetching:f.isFetching,setSearchParams:m,navigate:d}),s.jsx(Bd,{targetName:Ul.CGVB}),s.jsx($te,{})]})]})},i1t=({deliveryMethod:e,search:t,orderRoot:n})=>{const o=e===Et.clickAndCollect.method?pp():yd();return`${n||""}${o}${t}`},kk=(e,t)=>t.filter(el).find(n=>n.deliveryDestinationId===e),sse=e=>{const t=e.filter(el);return t.find(({primary:o})=>o)||t[0]},l1t=(e,t)=>t&&t.find(({deliveryDestinationId:n})=>n===e),Mk=()=>{const e=h.useRef(!0);return h.useEffect(()=>{e.current=!1},[]),e.current},c1t=(e,t=!1)=>{const n=p1(e),o=D("sv.sl")(e),r=u$e(e),a=p$e(e),l=o&&n==="HOME_DELIVERY"?[{partId:Ar,start:"",end:""},...a]:a,c=(f,y)=>Ge(f,Mt.ISO_8601).tz(y).format(),d=f=>{if(!f||!f.length)return[];const{slotDays:y,availableDays:I}=f.reduce((C,_)=>{const A=Mt.parseZone(Sn(_.localizedStartTime)),x=_.attributes.includes(_h);return C.slotDays.push({day:A,available:x}),x&&C.availableDays.add(Bi(A)),C},{slotDays:[],availableDays:new Set}),S=y.sort((C,_)=>C.day.valueOf()-_.day.valueOf());return PGe(S[0]?.day,S[S.length-1]?.day).map((C,_)=>{const A=Bi(C);return{date:Bq(C),dayId:A,order:_,hasAnyAvailableSlot:I.has(A)}})},u=({pricedSlots:f,partsOfDay:y,timeZoneId:I})=>f.sort(NGe).reduce((S,C)=>{const _=Sg(C.localizedStartTime,C.localizedEndTime),A=Uq(C.localizedStartTime,C.localizedEndTime,y);return A||bA(C.localizedStartTime,C.localizedEndTime)?S.concat([{slotId:C.slotId,slotDayId:Bi(Sn(C.localizedStartTime)),slotDateTimeISO:Sn(C.localizedStartTime),slotEndDateTimeISO:Sn(C.localizedEndTime),slotIntervalId:_,slotPartId:A,deliveryPrice:C.deliveryPrice,minimumOrder:C.minimumOrder,timeZoneId:I,carrierId:C.carrierId,attributes:C.attributes,...C.isFakeAvailable!==void 0&&{isFakeAvailable:C.isFakeAvailable}}]):S},[]),m=({standardSlots:f,minimumOrderValue:y,timeZoneId:I})=>{let S,C;const _=Mt().tz(I),A=new Map,x=new Set;if(t){S=FGe(f,I),C=f.find(O=>O.deliveryPrice)?.deliveryPrice?.currency??"GBP";for(const O of f){if(!O.attributes.includes("AVAILABLE"))continue;const k=Mt.utc(O.slotWindow.startTime).tz(I).format("YYYY-MM-DD");x.add(k);const j=parseFloat(O.deliveryPrice?.amount)===0;A.has(k)?A.get(k)&&A.set(k,j):A.set(k,j)}}const R=x.size>0&&[...x].every(O=>A.get(O)===!0);return f.map(({slotWindow:O,deliveryPrice:N,attributes:k,...j})=>{const{startTime:w,endTime:L}=O,B=c(w,I),W=c(L,I),$=Mt.utc(w).tz(I),K=$.format("YYYY-MM-DD");let Q=!1;const X=$.clone().startOf("day").diff(_.clone().startOf("day"),"days");if(X>0){const ce=_.hour(),de=$.hour();ce<17?Q=X>=1:ce>=17&&ce<23?Q=X>=2||X===1&&de>=15:Q=X>=2}const re=t&&!k.includes("AVAILABLE")&&Q;let ue,te;if(re){ue=[...k,"AVAILABLE"];const ce=sd(B),de=BGe($,Mt.utc(L).tz(I),S,I);ce?de?.amount&&parseFloat(de.amount)===0?te=de:R||A.get(K)?te={currency:C,amount:"0.00"}:te={currency:C,amount:UGe(w,L,I,r).toFixed(2)}:te=de??(R||A.get(K)?{currency:C,amount:"0.00"}:{currency:C,amount:"5.00"})}else ue=k,te=N;return{startTime:w,endTime:L,localizedStartTime:B,localizedEndTime:W,slotDateTimeISO:Sn(B),endTimeISO:Sn(W),deliveryPrice:te,minimumOrder:y,timeZoneId:I,attributes:ue,...t&&{isFakeAvailable:re},...j}})},g=f=>{if(n==="CUSTOMER_COLLECTION"){const[I,S]=f.reduce((C,_)=>(bA(_.localizedStartTime,_.localizedEndTime)?C[0].push(_):C[1].push(_),C),[[],[]]);return{regularSlots:S,multiDaySlots:I}}return{regularSlots:f,multiDaySlots:[]}};return f=>{const{standardSlots:y,onDemandSlots:I,minimumOrderValue:S,checkoutGroupsChanged:C,slotListingId:_,carriers:A,timeZoneId:x,seasonalSlotPeriods:R}=f,O=m({standardSlots:y,minimumOrderValue:S,timeZoneId:x}),{regularSlots:N,multiDaySlots:k}=g(O),j=d(N),w=wGe(N,l,r),L=u({pricedSlots:N,partsOfDay:w,timeZoneId:x});return{days:j,partsOfDay:w,slots:L,onDemandSlots:[...I||[],...k].filter(({attributes:B})=>B?.includes(_h)).map(B=>({...B,minimumOrder:S})),checkoutGroupsChanged:!!C,carriers:A||[],..._?{slotListingId:_}:{},...R&&{seasonalSlotPeriods:[...R]}}}},d1t=({deliveryDestinationId:e,deliveryMethod:t,shippingGroupType:n})=>async(o,r)=>{const a=r(),i=zst(a),l=D("sl.fsa")(a),c=rr(a),d=PK(a),u=NK(a),m=On(a),g=hn(a),f=Kl(a),y=`${e}:${t}:${n}`,I=QGe();try{let S=!1;if(l&&c)if(d)S=!u;else try{S=(await o(Lr.getConciergeDelivery(c,!0)))?.payload?.responseData?.isLeftAtConcierge===!1}catch{S=!1}const C=c1t(a,S),_=await o(Yn.getSlots({deliveryDestinationId:e,shippingGroupType:n,viewingLocation:S?xGe:i,pageViewId:m,sessionId:f,regionId:g,requestStartTime:I}));o(Yn.setSlots({data:C(_.payload.responseData),requestStartTime:I,successRequestParams:y}))}catch(S){S?.statusCode===ai.BAD_REQUEST?o(Yn.setSlots({data:{days:[],partsOfDay:[],slots:[],onDemandSlots:[],checkoutGroupsChanged:!1,carriers:[]},requestStartTime:I,successRequestParams:y})):o(Yn.setSlotsError(S))}},u1t=/(?<orderRoot>^\/orders\/[^/]*)/,jk=()=>{const e=Ne(),{orderId:t}=co();if(!t)return"";const n=e.pathname.match(u1t)?.groups;return n?.orderRoot?n.orderRoot:""},nse=T.span.withConfig({shouldForwardProp:e=>!["isActive","isLoading"].includes(e)})`
    display: flex;
    align-items: center;
    padding-block: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-2);
    flex-wrap: nowrap;
    block-size: 48px;
    min-inline-size: 109px;
    align-content: center;
    border: var(--salt-border-1) solid transparent;
    border-radius: var(--salt-radius-default);
    box-shadow: ${e=>e.shadow?"var(--salt-box-box-shadow)":""};

    &:hover {
        ${e=>`
            ${e.isLoading?"":"background-color: var(--intent-secondary-500)"};
        `}
    }

    ${e=>`
        border-color: ${e.isActive?"var(--intent-primary-800)":"transparent"};
    `}

    ${oe.mdUp`
        width: 100%;
        max-width: 344px;
    `};
`,p1t=T(P)`
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: block-axis;
    overflow: hidden;
`,m1t=yd(),vb=3,h1t=({queryString:e})=>({carrierId:t})=>{const{carrierId:n,...o}=tt.parse(e||"")||{};return tt.stringifyUrl({url:m1t,query:{...o,...t&&{carrierId:t}}})},g1t=({selectedCarrier:e,carriers:t,isMobileLayout:n})=>{if(!n)return t;const o=t.slice(0,vb);return n&&o.find(r=>r?.id===e?.id)?o:[...e?[e]:[],...t.filter(r=>r?.id!==e?.id)].slice(0,vb)},wk=()=>{const e=Ne();return h1t({queryString:e.search})},E1t=()=>{const e=We(),t=E(Np),n=E(TD),o=E(qq),r=wk(),a=E(_g),i=oo(a);h.useEffect(()=>{t.length&&!n&&o&&i!==void 0&&i!==a&&!a&&e(r({deliveryMethod:o.type,carrierId:o.id}),{replace:!0})},[i,a])},f1t=()=>{const e=E(Np),t=E(cl),n=oo(t)??null,o=h.useRef({}),[r,a]=h.useState(!1),[i,l]=h.useState(t?.id??null);o.current=h.useMemo(()=>e.reduce((u,m)=>({...u,[m.id]:o.current[m.id]??h.createRef()}),o.current),[e]);const c=()=>{!r&&t?.id&&l(t?.id)},d=u=>{const m=e.findIndex(g=>g.id===i);switch(u.key){case"ArrowRight":{a(!0);const g=m+1>=e.length?0:m+1,f=e[g].id;o.current[f]?.current?.focus(),l(f);break}case"ArrowLeft":{a(!0);const g=m-1<0?e.length-1:m-1,f=e[g].id;o.current[f]?.current?.focus(),l(f);break}default:a(!1);break}};return h.useEffect(()=>{const u=t?.id;n?.id&&u&&(o.current[u]?.current?.focus(),l(u))},[t?.id]),{carrierCardsRefs:o,onTablistFocus:c,onTablistKeyDown:d}},y1t=T(me).attrs({name:"click_collect",width:28,height:28})`
    vertical-align: middle;

    svg {
        fill: var(--intent-content);
    }
`,ose=e=>{const{carrier:t}=e,{title:n,iconUrl:o,iconDescription:r,type:a}=t,c=(Ig(t)||n)===r?void 0:r;return a===la?s.jsx(Vd,{src:o,alt:c,height:28,width:28}):s.jsx(y1t,{})},I1t=T(Qe)`
    inline-size: 100%;
`,S1t=T.button`
    inline-size: 100%;
    background: none;
    color: inherit;
    border: none;
    padding: 0;
`,C1t=ie.forwardRef(({children:e,isActive:t,carrierId:n,deliveryMethod:o,onClick:r},a)=>{const i=wk();if(t)return s.jsx(S1t,{role:"tab","aria-selected":!0,ref:a,tabIndex:0,type:"button",children:e});const l=i({carrierId:n,deliveryMethod:o});return s.jsx(I1t,{role:"tab","aria-selected":!1,intent:"ghost",href:l,ref:a,tabIndex:-1,onClick:r,children:e})}),T1t=ie.forwardRef(({carrier:e,isActive:t=!1},n)=>{const{id:o,title:r,type:a}=e,l=Ig(e)||r,{carrierSelectionClicked:c}=bo(),d=()=>{c({item:e})};return s.jsx(se,{"data-test":"carrier-card",children:s.jsx(C1t,{isActive:t,carrierId:o,deliveryMethod:a,ref:n,onClick:d,children:s.jsxs(nse,{isActive:t,shadow:!t,children:[s.jsx(se,{as:"span",children:s.jsx(ose,{carrier:e})}),s.jsx(p1t,{className:"salt-m-l--1",size:"s",bold:!0,children:l})]})})})}),_1t=()=>s.jsxs(nse,{as:"div",isActive:!1,isLoading:!0,children:[s.jsx(se,{className:"salt-m-r--1",children:s.jsx(Pe,{height:"28px",width:"28px"})}),s.jsx(Bo,{children:s.jsx(Pe,{height:"28px",width:"100%"})})]}),v1t="carriers-select-placeholder",A1t=({className:e})=>s.jsx(Y,{flush:!0,className:e,"data-test":v1t,children:["carrier1","carrier2"].map(t=>s.jsx(Y.Item,{colSpan:{xs:4,lg:2},children:s.jsx(_1t,{})},t))}),{RadioIconOff:b1t,RadioIconOn:x1t}=ha,rse=`
    svg {
        height: 24px;
        width: 24px;
    }
`,R1t=T(b1t)`
    ${rse}
`,D1t=T(x1t)`
    ${rse}
`,O1t=T.div`
    display: flex;
    align-items: center;
    flex-wrap: nowrap;
    padding-block: var(--salt-spacing-2);
    padding-inline: var(--salt-spacing-2);
    cursor: pointer;
    block-size: 50px;
    min-inline-size: 109px;
    border: ${H(1)} solid var(--intent-secondary-900);
    border-radius: var(--salt-radius-default);

    &:hover {
        background-color: var(--intent-secondary-500);
    }
`,PG=T(P)`
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
    inline-size: 100%;
`,P1t=T(se)`
    overflow: hidden;
`,N1t=e=>{const t=M(),{carrier:n,isActive:o=!1,onSelect:r}=e,a=n.type==="CUSTOMER_COLLECTION"?t.formatMessage(n.title):n.title,i=Ig(n),{carrierSelectionClicked:l}=bo(),c=()=>{r(n),o||l({item:n})};return s.jsx(Ve.Item,{id:a,role:"option",onClick:c,"aria-selected":o,tabIndex:0,"data-test":e["data-test"],children:s.jsxs(O1t,{children:[o?s.jsx(D1t,{name:"radio_on"}):s.jsx(R1t,{name:"radio_off"}),s.jsx(se,{children:s.jsx(ose,{carrier:n})}),s.jsxs(P1t,{className:"salt-m-l--4",direction:"column",children:[s.jsx(PG,{size:"s",children:a}),i&&s.jsx(PG,{size:"s",bold:!0,children:i})]})]})})},L1t=T(Ve)`
    inline-size: 100%;
`,ase="carriers",k1t=()=>{const e=M(),t=We(),n=wk(),o=F(),r=E(Np),a=E(cl),[i,l]=h.useState(a),c=E(Ue(ase)),d=()=>{o(Z.closeModal())},u=()=>{i&&t(n({deliveryMethod:i.type,carrierId:i.id})),o(Z.closeModal())},m=g=>()=>l(g);return h.useEffect(()=>{l(a)},[a]),s.jsxs(G,{isOpen:c,isLoading:!1,onRequestClose:d,asBottomSheet:!0,children:[s.jsx(G.Header,{align:"left",children:s.jsx(P,{size:"l",bold:!0,children:e.formatMessage("carriers-selection-view.title")})}),s.jsx(G.Body,{children:s.jsxs(se,{className:"salt-gap--2",children:[s.jsx(L1t,{inline:!1,"data-test":"carriers-modal-list",children:r.map(g=>s.jsx(N1t,{"data-test":`carriers-modal-item-${g.id}`,onSelect:m(g),isActive:g.id===i?.id,carrier:g},g.id))}),s.jsx(b,{intent:"primary",fill:!0,onClick:u,"data-test":"carriers-modal-confirm-button",children:s.jsx(b.Text,{children:e.formatMessage("carriers-selection-view.confirm-button")})}),s.jsx(b,{intent:"secondary",fill:!0,onClick:d,"data-test":"carriers-modal-cancel-button",children:s.jsx(b.Text,{children:e.formatMessage("carriers-selection-view.cancel-button")})})]})})]})},M1t="carriers-select",ise=({className:e=""})=>{const{formatMessage:t}=M(),n=F(),o=E(Np),r=E(_g),a=E(cl),i=E(RD),l=ps({breakpoint:"lg-up"}),{chooseCarrierModalDisplayed:c,carrierSelectionCardImpression:d}=bo(),u=()=>{n(Z.openModal(ase)),c(),d({items:o})},m=g1t({isMobileLayout:l,carriers:o,selectedCarrier:a}),g=l&&o.length>vb,{carrierCardsRefs:f,onTablistFocus:y,onTablistKeyDown:I}=f1t();return E1t(),h.useEffect(()=>{a&&d({items:m})},[a?.id]),r?s.jsx(A1t,{className:e}):i?s.jsxs(Bo,{className:`salt-p-t--2 salt-m-b--4 ${e}`,"data-test":M1t,children:[s.jsx(Y,{role:"tablist",onFocus:y,onKeyDown:I,className:"salt-m-x--0",children:m.map(S=>s.jsx(Y.Item,{colSpan:{xs:4,lg:2},children:s.jsx(T1t,{ref:f.current[S.id],carrier:S,isActive:S.id===a?.id})},S.id))}),g&&s.jsxs(h.Fragment,{children:[s.jsx(Bo,{className:"salt-m-t--2",children:s.jsx(b,{intent:"secondary",fill:!0,onClick:u,children:s.jsx(b.Text,{children:t("carriers-selection.show.all-button")})})}),s.jsx(k1t,{})]})]}):null},lse=()=>{const[e]=ip(),t=E($d),n=e.get("deliveryDestinationId");return kk(n,t)},cse=()=>{const e=E(xs),t=E(qP),n=use(),o=lse();return n&&e==="CUSTOMER_COLLECTION"&&!t&&!o},dse=()=>{const e=F(),t=E(Wp),n=E($d);return(o,r)=>{if(!o||t)return;const a=n.find(i=>i.deliveryDestinationId===o||i.addressId===r)||{deliveryDestinationId:o};e(ea.setSelectedAddress(a))}},use=()=>{const e=E(xs),t=oo(e),n=E($d),o=E(uo),r=Mk();return(()=>{const i=t&&t!==e,l=kk(o,n);return i||r||!o||!l})()},j1t=()=>{const e=F(),t=E(xs),n=E($d),o=E(qP),r=E(Qs),a=E(Wp),i=dse(),{open:l,isOpen:c}=wt(hc),d=use(),u=cse(),m=lse(),g=t==="HOME_DELIVERY";return()=>{if(m&&d){i(m.deliveryDestinationId,m.addressId);return}if(o&&d){const{data:f}=r;i(f?.deliveryDestinationId,f?.addressId);return}if(g&&d){const f=sse(n);if(f){const{deliveryDestinationId:y,addressId:I}=f;i(y,I)}return}u&&!c&&!a&&(e(U.analyticsEvent({type:Fe.MAP_RENDERED_REASON})),l({postalCode:r.data?.postalCode}))}},w1t=yd(),F1t=pp(),B1t=({pathRoot:e="",onHomeDeliveryTabClick:t=()=>{}})=>{const n=F(),o=We(),[r]=fe(["sl.rd"]),a=E(xs),{search:i}=Ne(),l=Et.vanDelivery.method,c=Et.clickAndCollect.method,d=M(),u=d.formatMessage("delivery.type.name.van"),m=d.formatMessage("delivery.type.name.cnc"),g={homeDeliveryTab:{title:d.formatMessage("delivery.type.name.van"),description:d.formatMessage("delivery.type.message.van"),ariaLabel:d.formatMessage("accessibility.delivery.method.selector",{delivery_method:u})},clickAndCollectTab:{title:d.formatMessage("delivery.type.name.cnc"),description:d.formatMessage("delivery.type.message.cnc"),ariaLabel:d.formatMessage("accessibility.delivery.method.selector",{delivery_method:m})}},f=x=>`${e}${x}`,y=x=>x===l?w1t:F1t,I=x=>{const R=y(x);return`${f(R)}${i}`},S=x=>a===x,C=I(c),_=I(l),A=(x=()=>{})=>async R=>{r&&(R.preventDefault(),n(Yn.clearSlotGridData()),o(a==="HOME_DELIVERY"?C:_)),x()};return s.jsxs(xa,{className:"salt-m-b--2",highlightedId:a,children:[s.jsx(xa.Link,{"data-test":"HOME_DELIVERY_TAB","aria-label":g.homeDeliveryTab.ariaLabel,id:l,onClick:S(l)?void 0:A(t),to:S(l)?void 0:I(l),children:g.homeDeliveryTab.title}),s.jsx(xa.Link,{"data-test":"CUSTOMER_COLLECTION_TAB","aria-label":g.clickAndCollectTab.ariaLabel,id:c,onClick:S(c)?void 0:A(),to:S(c)?void 0:I(c),children:g.clickAndCollectTab.title})]})},U1t=D("dcbbs"),Cm=({className:e})=>{const t=jk(),n=E(U1t);return E(yle)>1?s.jsxs(Bo,{className:e,children:[s.jsx(B1t,{pathRoot:t}),!n&&s.jsx(Bd,{targetName:Ul.FJPY})]}):null},G1t=({enabled:e=!1})=>{const t=Ne(),n=We();h.useEffect(()=>{if(!e)return;const o=new URLSearchParams(t.search);o.get(AA)==="true"&&(z.warning("slotbooking.fake.slot.notification.updated"),o.delete(AA),n({search:o.toString()},{replace:!0}))},[e,t,n])},$1t=D("bt.spl"),H1t=D("sl.dt"),pse=()=>{const e=M(),t=E($1t),n=E(Op),o=E(_i),r=E(d1),a=E(H1t),i=r.length===1&&r[0]===la;return o?e.formatMessage("slotbooking.slot.select.heading.couriers"):a&&i?e.formatMessage("slot.booking.fast.delivery.screen.title"):t&&n?e.formatMessage("slotbooking.slot.select.heading.grocery"):e.formatMessage("slotbooking.slot.select.heading")},V1t=()=>s.jsxs(ie.Fragment,{children:[s.jsx(rs,{title:"slotbooking.page.title"}),s.jsx(An,{children:s.jsx(ne,{as:"h1",children:pse()})})]}),Y1t=T.div`
    inline-size: 100%;
`,mse=()=>{const e=M(),t=F(),[n,o]=h.useState(!1),r=E(Id),{currentBreakpoint:a}=h.useContext(Pn),i=ts(),l=()=>{i({type:n?Fe.ITEM_WINDOW_REDUCED:Fe.ITEM_WINDOW_EXPANDED}),o(!n)};if(E7({items:r}),h.useEffect(()=>{t(nc())},[r.length]),!r.length)return null;const c=e.formatMessage("checkout.summary.basket.overview.header.main"),u=["md","lg"].includes(a)?s.jsx(Yd,{buttonWidth:120,alertClassName:"salt-m-t--2"}):void 0;return s.jsx(Y1t,{className:"salt-m-b--4",children:s.jsxs(st,{expanded:n,onToggle:l,children:[s.jsx(Zg,{name:c,basketItems:r}),s.jsxs(st.ControlSection,{children:[s.jsx(Zp,{basketItems:r,name:c}),s.jsx(st.ToggleSwitch,{})]}),s.jsx(st.ContentExpanded,{children:s.jsx(oZ,{basketItems:r,blurOverlay:u})})]})})};mse.displayName="BasketProductsSimpleOverview";const W1t=()=>{const e=E(D("dcbbs")),t=E(D("bt.spl")),n=E(ix),o=E(Cd),r=tee(),a=E(_i),i=t&&(r||o),l=a?!1:n;return s.jsxs(h.Fragment,{children:[i&&s.jsx(se,{className:"salt-p-x--2 salt-p-b--4",children:s.jsx(mse,{})}),e?s.jsx(Bd,{targetName:Ul.FJPY}):s.jsx(bI,{slotBooked:l})]})},q1t=T(An)`
    padding-inline: ${({shrink:e})=>e?"0":"var(--salt-spacing-2)"};
`,K1t=({shrink:e=!1})=>s.jsxs(ie.Fragment,{children:[s.jsx(rs,{title:"slotbooking.page.title"}),s.jsx(q1t,{shrink:e,children:s.jsx(ne,{as:"h1",children:pse()})})]}),z1t=T(me)`
    svg {
        inline-size: 14px;
        block-size: 14px;
    }
`,hse=({size:e="m"})=>s.jsxs(se,{align:"center",wrap:"nowrap",children:[s.jsx(z1t,{className:"salt-m-r--2",name:"eco_slot",success:!0}),s.jsx(P,{size:e,children:s.jsx(v,{id:"slots.grid.green-van.footer.short-description"})})]}),Q1t=({size:e="m"})=>s.jsxs(se,{gap:["sm"],children:[s.jsx(hse,{size:e}),s.jsx(P,{size:e,children:s.jsx(v,{id:"green-van.description"})})]}),X1t=({className:e})=>s.jsx(ne,{as:"h2",className:e,children:s.jsx(v,{id:"green-van_title"})}),gse="ECO_SLOT_MODAL_NAME",Z1t="eco-icon-modal",J1t=()=>{const e=F(),t=E(Ue(gse)),n=()=>{e(Z.closeModal())};return s.jsxs(G,{isOpen:t,onRequestClose:n,asBottomSheet:!0,children:[s.jsx(G.Header,{align:"left",children:s.jsx(X1t,{})}),s.jsx(G.Body,{"data-test":Z1t,children:s.jsx(Q1t,{size:"l"})})]})},eHt=3,tHt=7,Vh=e=>e?eHt:tHt,sHt=e=>({alert:{title:e.formatMessage("slotbooking.alert.first.available.slot"),viewSlot:e.formatMessage("slotbooking.alert.first.available.slot.view")},next:e.formatMessage("slotbooking.table.next.days"),previous:e.formatMessage("slotbooking.table.previous.days"),previousCompleteText:e.formatMessage("slotbooking.table.previous.days.complete.text"),fillerText:e.formatMessage("slotbooking.table.filler.text"),weekDays:{sun:e.formatMessage("slotbooking.table.week.days.sun"),mon:e.formatMessage("slotbooking.table.week.days.mon"),tue:e.formatMessage("slotbooking.table.week.days.tue"),wed:e.formatMessage("slotbooking.table.week.days.wed"),thu:e.formatMessage("slotbooking.table.week.days.thu"),fri:e.formatMessage("slotbooking.table.week.days.fri"),sat:e.formatMessage("slotbooking.table.week.days.sat")},calendar:e.formatMessage("slotbooking.table.calendar.header"),cancel:e.formatMessage("slotbooking.table.calendar.cancel.link"),slotAriaViewSlot:e.formatMessage("slotbooking.aria.view.first.slot"),slotAriaDate:e.formatMessage("slotbooking.table.cell.aria.date"),slotAriaTime:e.formatMessage("slotbooking.table.cell.aria.time"),slotAriaCost:e.formatMessage("slotbooking.table.cell.aria.price"),nextMonth:t=>e.formatMessage("calendar.next.month",{month:t}),currentMonth:t=>e.formatMessage("calendar.current.month",{month:t}),previousMonth:t=>e.formatMessage("calendar.previous.month",{month:t}),datePickerAlternative:e.formatMessage("calendar.alternative")}),Ese=(e,t,n,o,r,a)=>{const{getFormattedIntervalDates:i}=vm;if(!a||!r){const{fromDate:m,toDate:g}=i(t,n,o,o);return e.formatMessage("slotbooking.table.time.range.format",{startTime:m,endTime:g})}const{startFormat:l,endFormat:c}=a,{fromDate:d,toDate:u}=i(t,n,l,c);return e.formatMessage("slotbooking.table.time.range.format",{startTime:d,endTime:u})},nHt=(e,t,n,o,r)=>r?.map(({partId:a,intervals:i})=>({partId:a,name:e.formatMessage(`slotbooking.table.part.of.day.${a}`),intervals:i.map(({intervalId:l,start:c,end:d,order:u})=>({intervalId:l,name:Ese(e,c,d,t,n,o),order:u,start:c,end:d}))}),{})||[],fse=(e,t,n)=>t?parseFloat(t.amount)===0?e.formatMessage("slotbooking.table.price.free"):n(t):null,oHt=(e,t,n,o,r,a)=>{if(!t.length)return{};let i=t?.reduce((l,c)=>{const{slotDateTimeISO:d,slotPartId:u,slotIntervalId:m,deliveryPrice:g,slotId:f}=c,y=d.split("T")[0];if(!y||!u)return l;const I=n.includes(f),S=u==="saverslots";return{...l,[y]:{...l[y]||{},[u]:{...l[y]?.[u]||{},[m]:{...c,price:fse(e,g,o),ecoSlot:I,isSaverSlot:S}}}}},{});if(a){const{slotDateTimeISO:l,slotPartId:c,slotIntervalId:d}=a,u=l.split("T")[0];!wo(i,`${u}.${c}.${d}`)&&u&&c&&d&&(i={...i,[u]:{...i[u]||{},[c]:{...i[u]?.[c]||{},[d]:{...a}}}})}return r?.length&&r.forEach(l=>{const{slotDateTimeISO:c,slotPartId:d,slotIntervalId:u}=l,m=c.split("T")[0];m&&d&&u&&(i={...i,[m]:{...i[m]||{},[d]:{...i[m]?.[d]||{},[u]:{...l}}}})}),i},rHt=(e,t)=>e?.map(n=>({dayId:n.dayId,dayName:yt(n.date,t),order:n.order,iso:n.date,hasAnyAvailableSlot:n.hasAnyAvailableSlot}))||[],aHt=(e,t,n,o="-")=>{const r=rHt(e,t),a=r.length%Vh(n),i=a?Vh(n)-a:0;let l=0;for(;l<i;){const c=r[r.length-1],d=c?.iso?zI(1,c.iso):"",u=s0(d);r.push({dayId:Bi(u),dayName:d?yt(d,t):o,order:(c?.order||0)+1,iso:Bq(u),hasAnyAvailableSlot:!1}),l+=1}return r},iHt=(e,t)=>{const n=[];for(let o=0;o<e.length;o+=t){const r=e.slice(o,o+t);n.push(r)}return n},lHt=e=>t=>e.findIndex(n=>n.findIndex(({iso:o})=>o===t)!==-1),cHt=e=>({start:e[0]?.iso,end:e[e.length-1]?.iso}),dHt=(e,t,n)=>e.length&&(n||e?.[0]?.iso)||yt(oa,t),uHt=(e,t,n)=>{const o=Bi(e),[,r]=t?.split("T")||[],[,a]=n?.split("T")||[];return{attributes:[],ecoSlot:!1,isFirstAvailableSlot:!1,isUpcomingOrder:!1,slotDateTimeISO:`${e}T${r}`,slotDayId:o,slotEndDateTimeISO:`${e}T${a}`}},pHt=(e,t,n)=>{const o=e?.[0]?.[0]?.iso;if(o)for(const r of t)for(const a of r.intervals){const i=n[o]?.[r.partId]?.[a.intervalId];if(i&&"attributes"in i&&i.attributes.includes(_h))return i}},Mv=(e,t)=>e.some(n=>t.some(({fromDate:o,toDate:r})=>n>=o&&n<=r)),NG=0,mHt=()=>{const[e,t]=h.useState(NG);return h.useEffect(()=>{const n=document.getElementById("main-header");t(n?.offsetHeight||NG)},[]),e},YT=()=>ps({breakpoint:"md-up"}),hHt=()=>{const e=M();return sHt(e)},gHt=()=>{const e=YT(),t=e?3:2,n=e?4:6;return s.jsx(Wte,{"data-test":"slot-grid-skeleton",children:s.jsx(Ok,{fixed:!0,className:"salt-m-x--1 salt-m-t--4",children:s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsxs(Y,{flush:!0,fixed:!0,className:"salt-m-x--1",children:[s.jsx(Y.Item,{colSpan:{xs:10},colStart:{xs:3},children:s.jsx(Pe,{height:"25px",width:"100%"})}),Array(10).fill(0).map((r,a)=>Array(n).fill(0).map((i,l)=>s.jsx(Y.Item,{colSpan:{xs:t},children:s.jsx(Pe,{height:"30px",width:"100%"})},`${a}_${l}`)))]})})})})},EHt=()=>s.jsx(Ce,{className:"salt-m-y--2","data-synthetics":"no-slots-warning",intent:"error",showIcon:!1,text:s.jsx(v,{id:"slotbooking.slot.unavailable.body"})}),fHt=()=>{const e=M(),t=F(),n=h.useCallback(()=>{t(Z.openModal(gse))},[]);return s.jsxs(se,{justify:"flex-start",wrap:"nowrap",gap:["sm"],className:"salt-p-x--1 salt-m-y--4",children:[s.jsx(hse,{}),s.jsx(se,{additionalCss:"min-inline-size: fit-content;",children:s.jsx(b,{"aria-label":e.formatMessage("accessibility.green-van.footer.description"),"data-test":"eco-slot-footer-button",intent:"tertiary",onClick:n,fill:!1,size:"s",children:s.jsx(b.Text,{children:s.jsx(v,{id:"slots.grid.green-van.footer.button"})})})})]})},yHt=({onDaySelect:e,pickerSelectedDate:t,datesForCurrentPage:n})=>{const o=E(Jt),r=E(XGe),a=hHt(),i=YT(),l=Vh(i),{start:c,end:d}=cHt(n),u=dHt(n,o,t),m=(r||[]).map(g=>g?.date);return s.jsx(B0t,{scope:"col",children:s.jsx(U0t,{children:s.jsx(Ak,{selected:u,onDaySelect:e,amountHighlighted:l-1,availableDays:m,messages:a,"data-synthetics":"date-picker",dateTime:vm,containerStyle:{left:0,zIndex:5},isNewButton:!0,highlightedStart:c,highlightedEnd:d,controlledSelected:!0,text:Ks(V$,u),buttonClassName:"salt-p-l--2 salt-p-r--2"})})})},LG=T(b)`
    position: absolute;
    z-index: 2;
    inset-inline-start: -18px;
`,IHt=({onClick:e})=>s.jsx(LG,{intent:"tertiary",size:"s",fill:!1,onClick:e,"data-synthetics":"select-previous","aria-label":M().formatMessage("slotbooking.table.previous.days.accessibility.text"),tabIndex:0,children:s.jsx(LG.Icon,{name:"arrow_left",size:"s"})}),SHt=T(b)`
    position: absolute;
    z-index: 2;
    inset-inline-end: 0;
`,CHt=({onClick:e})=>s.jsx(SHt,{onClick:e,intent:"tertiary",size:"s",fill:!1,"data-synthetics":"select-next","aria-label":M().formatMessage("slotbooking.table.next.days.accessibility.text"),tabIndex:0,children:s.jsx(b.Icon,{name:"arrow_right",size:"s"})}),THt=T(N0t)`
    position: ${({isLast:e})=>e?"static":"relative"};
`,_Ht=({datesForCurrentPage:e,isFirstPage:t,isLastPage:n,onPrevButtonClick:o,onNextButtonClick:r})=>e.map(({dayId:a,dayName:i,iso:l},c)=>{const d=c===0,u=c===e.length-1,m=!t&&d,g=!n&&u,f=Ks(w$,l);return s.jsx(F0t,{scope:"col",children:s.jsxs(THt,{isLast:u,children:[m&&s.jsx(IHt,{onClick:o}),s.jsx(L0t,{width:u?"80%":"100%",tabIndex:0,"aria-label":f,children:i}),g&&s.jsx(CHt,{onClick:r})]})},`day-${a}`)}),vHt=({pageCount:e,findPageIndex:t})=>{const n=E(WP),o=t(n||""),r=o>0?o:0,[a,i]=h.useState(r),[l,c]=h.useState();h.useEffect(()=>{n&&o===-1&&(z.warning("seasonal.slots.deeplink.error.message"),Me.api.pushError(new Error("Slot booking error: deep link date not found"),{context:{date:n}}))},[n,o]),h.useEffect(()=>{r!==a&&i(r)},[r,e]);const d=wre({onSwipedLeft:()=>{i(f=>f>=e?e:f+1)},onSwipedRight:()=>{i(f=>f<=0?0:f-1)}}),u=h.useCallback(f=>{const y=t(f);c(f),i(y)},[t]),m=h.useCallback(()=>{i(f=>f-1),c(void 0)},[]),g=h.useCallback(()=>{i(f=>f+1),c(void 0)},[]);return{currentPage:a,swipeHandlers:d,onDaySelect:u,onPrevButtonClick:m,onNextButtonClick:g,pickerSelectedDate:l}},kG=e=>["available","orderPlaced"].includes(e),AHt=T.div`
    position: relative;
    inline-size: 100%;
    block-size: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    background: ${({"data-status":e})=>e==="unavailable"?"var(--intent-secondary);":e==="reserved"?"var(--intent-success-50)":"var(--intent-contrast)"};
    border: none;
    border-radius: var(--salt-radius-default);
    cursor: ${({"data-status":e})=>kG(e)?"pointer":"default"};

    :hover {
        background: ${({"data-status":e})=>kG(e)?"var(--intent-primary-50)":"default"};
    }

    transition: background 0.2s ease-in-out;
`,bHt=T(Rs)`
    transform: scale(0.4);
`,xHt=({slot:e,booked:t,orderPlaced:n,isSlotBooking:o})=>t?"reserved":o?"reserving":n?"orderPlaced":e?.attributes?.includes("AVAILABLE")?"available":"unavailable",RHt=({booked:e,isSlotBooking:t,interval:n,onClick:o,orderPlaced:r,slot:a})=>{const i=M(),l=ze(),c=E(Vt),d=xHt({slot:a,booked:e,orderPlaced:r,isSlotBooking:t}),u=d==="available",m=d==="unavailable",g="deliveryPrice"in a?fse(i,a?.deliveryPrice,l):null,f=()=>{switch(d){case"reserved":return s.jsx(me,{"data-test":"slot-booked-icon",name:"status_yes",success:!0});case"available":return g;case"unavailable":return"-";case"reserving":return s.jsx(bHt,{"data-test":"grid-cell-spinner"});case"orderPlaced":return s.jsx(me,{"data-test":"order-placed-icon",name:"orders_placed"});default:return""}},I=(()=>{if(m)return;const A=yt(a.slotDateTimeISO,WI),x=Ks(Ma,a.slotDateTimeISO),R=yt(n.start,c),O=yt(n.end,c),N=`${R} - ${O}`;if(d==="orderPlaced")return`${i.formatMessage("accessibility.slot.type.order.placed")}. ${N}. ${x}. ${A}.`;if(d==="reserved")return`${i.formatMessage("accessibility.slot.type.booked")}. ${N}. ${x}. ${A}.`;if(u)return`${a?.ecoSlot&&`${i.formatMessage("accessibility.eco.slot.label")}.`||""} ${g}. ${N}. ${x}. ${A}.`})(),S=u||r||e?"button":void 0,C=u&&!t||r?()=>{o(a)}:void 0,_=u?{"data-synthetics":"selectable-slot","data-test":"selectable-slot"}:{};return s.jsxs(AHt,{"aria-label":I,"aria-hidden":m,as:S,"aria-disabled":t||e,"data-status":d,onClick:C,tabIndex:m?-1:0,type:S,..._,children:[f(),u&&a?.ecoSlot&&s.jsx(me,{name:"eco_slot",className:"salt-m-l--2",success:!0,height:"16px",width:"16px","data-test":"eco-slot-icon"})]})},gf=e=>{const t=e.match(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}/);return t?t[0]:e},DHt=()=>{const e=E(PD);if(!e)return()=>!1;const t=gf(e.slotDateTimeISO),n=gf(e.slotEndDateTimeISO);return o=>t===gf(o.slotDateTimeISO)&&n===gf(o.slotEndDateTimeISO)},OHt=T.div`
    padding-block: var(--salt-spacing-2);
`,PHt=T.div`
    display: flex;
    justify-content: space-between;
    gap: var(--salt-spacing-1);
    padding: var(--salt-spacing-1);
    background-color: var(--intent-secondary);
    border-radius: var(--salt-radius-default);
`,MG=T(b)`
    inline-size: 100%;
    border: none;
    border-radius: var(--salt-radius-default);

    && {
        ${({intent:e})=>e==="secondary"&&De`
                background-color: var(--intent-contrast) !important;
                color: var(--intent-content);

                &:hover {
                    background-color: var(--intent-secondary-900);
                    color: var(--intent-secondary-900-contrast);
                }
            `};
    }
`,NHt=T.div`
    padding-block: var(--salt-spacing-4);
    font-size: var(--salt-text-s-font-size);
    line-height: var(--salt-text-s-line-height);
    text-align: start;

    @media (max-width: ${Ke.md}em) {
        padding-block-end: 0;
    }
`,jG=e=>e?{fill:!0,intent:"secondary",disabled:!0}:{intent:"tertiary",fill:!1},wG=({bold:e=!1,id:t=""})=>s.jsx(P,{bold:e,size:"m",children:s.jsx(v,{id:t})}),yse=()=>{const{formatMessage:e}=M(),t=F(),n=E(Rp),[o,r]=ip(),a=n===Ku,i=h.useCallback(c=>{const d=c===Dm?Fe.STANDARD_SLOTS_BUTTON_CLICKED:Fe.SAVER_SLOTS_BUTTON_CLICKED,u=c===Dm?xr[Fe.STANDARD_SLOTS_BUTTON_CLICKED]:xr[Fe.SAVER_SLOTS_BUTTON_CLICKED];t(U.analyticsEvent({type:d,description:u})),r(m=>(m.set("slotGroup",c),m))},[]);return E(Wq)?s.jsxs(OHt,{children:[s.jsxs(PHt,{role:"tablist","aria-label":e("accessibility.slotbooking.saver.slots.section.title"),children:[s.jsx(MG,{...jG(!a),size:"s",onClick:()=>i(Dm),"aria-selected":!a,role:"tab","aria-label":e("accessibility.slotbooking.standard.slots.button"),children:s.jsx(wG,{id:"slotbooking.standard.slots.button",bold:!a})}),s.jsxs(MG,{...jG(a),size:"s",onClick:()=>i(Ku),"aria-selected":a,role:"tab","data-test":"saver-slots-button","aria-label":e("accessibility.slotbooking.saver.slots.button"),children:[s.jsx(Ote,{}),s.jsx(wG,{id:"slotbooking.saver.slots.button",bold:a})]})]}),a&&s.jsx(NHt,{children:s.jsx(P,{size:"s",children:s.jsx(v,{id:"saver-slots.button.description"})})})]}):null},LHt=T(b)`
    pointer-events: all;
    box-shadow: var(--salt-elevation-shadow-3);
`,kHt=T.div`
    position: fixed;
    inline-size: 100%;
    z-index: 2;
    inset-inline-start: 0;
    ${oe.smUp`
        inset-inline-start: max(0px, 50% - var(--salt-spacing-16) - var(--salt-spacing-4) - ${({gridWidth:e=""})=>e} * 0.5);
    `}
    inset-block-end: 0;
    pointer-events: none;
`,MHt=({nextAvailableSlotRef:e,slot:t})=>{const n=M(),o=E(Wb),[r]=fe(["sl.rng.cf"]),a=ll(),i=`${Ke[a||"xs"]}rem`,[l,c]=h.useState(!1),d=([f])=>{c(!f?.isIntersecting&&Number(f?.boundingClientRect.top)>0)},u=h.useCallback(()=>{e.current?.scrollIntoView({behavior:"smooth",block:"end"}),e.current?.focus()},[e]);if(h.useEffect(()=>{const f=e?.current;if(!!window.IntersectionObserver&&f){const I={threshold:0,root:null,rootMargin:"0%"},S=new IntersectionObserver(d,I);return S.observe(f),()=>S.disconnect()}return()=>{}}),!l)return null;const m=Ese(n,t?.slotDateTimeISO,t?.slotEndDateTimeISO,o.startFormat,r,o),g=n.formatMessage("accessibility.next.available.slot",{slot_time:m});return s.jsx(kHt,{gridWidth:i,className:"salt-m-l--2 salt-m-b--2",children:s.jsx(LHt,{intent:"tertiary-contrast",onClick:u,"data-synthetics":"next-available-slot","aria-label":g,size:"s",fill:!1,children:s.jsx(b.Text,{children:s.jsx(v,{id:"next.available.slot",values:{slot_time:m}})})})})},jHt=e=>e.filter(t=>!!t.content).map(t=>{const{content:n,...o}=t,{bannerImages:r,...a}=n,i={};return t.content?.bannerImages.forEach(l=>{const{width:c,height:d}=l.resolution;l.id==="ratio81"?(i.xs={url:l.url,width:c,height:d},i.sm={url:l.url,width:c,height:d},i.lg={url:l.url,width:c,height:d}):l.id==="ratio61"&&(i.md={url:l.url,width:c,height:d})}),{...a,...o,imagesBreakpoints:i}}),wHt=T(ve)`
    inline-size: calc(100% + var(--salt-spacing-1));
    ${oe.smUp`
        inline-size: 100%;
    `}
    display: flex;
    flex-flow: column;
    flex-basis: auto;
    justify-content: flex-end;
    align-items: stretch;
    padding: var(--salt-spacing-4);
    gap: var(--salt-spacing-2);
    ${oe.mdUp`
        flex-flow: row;
        align-items: center;
        padding: 0 var(--salt-spacing-2);
    `}
`,FHt=(e,t)=>{const n=T(se)`
        flex-grow: 1;

        ${oe.mdUp`
        padding-block: var(--salt-spacing-2);
    `}
    `;return s.jsxs(n,{gap:["xs"],direction:"row",wrap:"nowrap",align:"flex-start",justify:"flex-start",children:[s.jsx("img",{src:e.url,alt:"",height:18,width:18}),s.jsx(P,{className:"salt-p-x--2'",bold:!0,children:t})]})},BHt=({imagesBreakpoints:e,altText:t})=>{const n=T.img`
        display: block;
        inline-size: 100%;
        block-size: auto;
        border-radius: var(--salt-radius-default);

        @media (min-width: ${Ke.md}em) {
            inline-size: 264px;
            block-size: auto;
        }

        @media (min-width: ${Ke.lg}em) {
            inline-size: 352px;
            block-size: auto;
        }
    `,o=Object.entries(e).filter(([,r])=>r);return s.jsxs("picture",{children:[o.map(([r,a])=>s.jsx("source",{media:Hi[r],srcSet:a.url},`${r}-${a.url}`)),s.jsx(n,{src:e.xs?.url,alt:t})]})},UHt=T.div`
    min-inline-size: max-content;

    ${oe.mdUp`
        padding-block: var(--salt-spacing-2);
    `}
`,GHt=({onHandlePeriodChange:e,isInSeasonalPeriod:t,className:n=""})=>{const o=E(OD),r=jHt(o),a=M();if(r.length===0)return null;{const{iconImage:i,title:l,imagesBreakpoints:c,bannerAltText:d=a.formatMessage("seasonal.slot.default.banner.description"),defaultButtonTitle:u,alternativeButtonTitle:m}=r[0];return s.jsxs(wHt,{className:`salt-m-b--2 ${n}`,tabIndex:0,children:[FHt(i,l),s.jsx(BHt,{imagesBreakpoints:c,altText:d}),s.jsx(UHt,{children:s.jsx(b,{size:"s",intent:t?"secondary":"primary",fill:!0,onClick:e,children:t?m:u})})]})}},FG={SEASONAL_SLOTS:"SEASONAL_SLOTS",STANDARD_SLOTS:"STANDARD_SLOTS"},$Ht=(e,t,n,o)=>{const r=e[t]||[],a=e[0]||[],i=S=>S.map(C=>C.iso),l=Mv(i(r),n),c=Mv(i(a),n),d=E(Ql),u=E(ma),m=F(),g=eo(),f=!!(d&&d.deliveryDestinationId===u&&Mv([d.start],n)),y=n.length>0&&!f&&!c;h.useEffect(()=>{y&&n.forEach(({seasonalSlotPeriodId:S})=>{m(g({type:Fe.SEASONAL_SLOTS_BANNER_IMPRESSION,seasonalSlotPeriodId:S}))})},[y]);const I=h.useCallback(()=>{let S;if(l){const C=e[0];S=C&&C[0]&&C[0].iso}else{const _=n[0]?.fromDate;S=e.flat().map(x=>x.iso).includes(_||"")&&_}g({type:Fe.SEASONAL_SLOTS_BANNER_CLICKED,userAction:l?FG.STANDARD_SLOTS:FG.SEASONAL_SLOTS}),S&&o(S)},[l,n,e,o]);return{isSeasonalPeriod:l,shouldShowSeasonalBanner:y,onHandlePeriodChange:I}},BG=(e,t)=>e?HHt(t):[12.5,12.5,12.5,12.5,12.5,12.5,12.5,12.5],HHt=e=>e?[24.5,24.5,24.5,24.5,2]:[25,25,25,25],VHt=(e,t)=>n=>e&&!!t&&"slotId"in n&&t===n.slotId,YHt=({datesChunks:e,partsOfDayFormatted:t,slotsFormatted:n,onSelectSlot:o,firstAvailableSlot:r,activeBookingSlotId:a,isSaverSlotsAvailable:i})=>{const{currentPage:l,onNextButtonClick:c,onDaySelect:d,swipeHandlers:u,pickerSelectedDate:m,onPrevButtonClick:g}=vHt({pageCount:e.length-1,findPageIndex:lHt(e)}),{formatMessage:f}=M(),y=YT(),I=F(),{standardSlotsImpressionForGrid:S,dataFeedForGrid:C,defaultDeliveryDestinationIdAvailable:_}=bo(),A=mHt(),[x,R]=fe(["sl.prom","sl.fsa"]),O=E(rr),N=E(NK),k=E(PK),j=E(t$e),w=DHt(),L=Vh(y),B=ps({breakpoint:"sm-up"}),W=E(uC),$=VHt(W,a),K=E(zq),Q=E(Rp),re=E(oC)&&i,ue=E(Yq),te=E(OD),ce=h.useRef(null),de=e.length-1,ye=e[l]||[],Ae=l===0,Je=l===e.length-1,{shouldShowSeasonalBanner:Ie,isSeasonalPeriod:je,onHandlePeriodChange:Le}=$Ht(e,l,te,d),Be=[],be=h.useRef([]);return be.current=[],h.useEffect(()=>{_(),R&&k&&!N&&O&&(I(Lr.saveConciergeDelivery({slotId:O,isLeftAtConcierge:!0,orderId:O})),I(Lr.setConciergeDelivery(!0,!0)))},[]),h.useEffect(()=>{S(Be),C(be.current)},[l,ye.length,Q]),h.useEffect(()=>{je&&x&&z.info("promotions.seasonal.slot.booked.alert")},[je,x]),s.jsxs("div",{...u,children:[r&&Ae&&s.jsx(MHt,{nextAvailableSlotRef:ce,slot:r}),Ie&&s.jsx(GHt,{isInSeasonalPeriod:je,onHandlePeriodChange:Le}),s.jsxs(O0t,{"aria-label":f("accessibility.slotbooking.grid.title"),children:[s.jsx("colgroup",{children:BG(y,B).map((he,ge)=>s.jsx("col",{style:{width:`${he}%`}},`${ge}_${he}`))}),s.jsxs(P0t,{top:`${A}px`,children:[re&&ue&&s.jsx("tr",{children:s.jsx(w0t,{scope:"colgroup",colSpan:BG(y,B).length,children:s.jsx(yse,{})})}),s.jsxs("tr",{"data-test":"slot-booking-header-row",children:[s.jsx(yHt,{onDaySelect:d,pickerSelectedDate:m,datesForCurrentPage:ye}),s.jsx(_Ht,{datesForCurrentPage:ye,isFirstPage:Ae,isLastPage:Je,onPrevButtonClick:g,onNextButtonClick:c}),B&&s.jsx(j0t,{})]})]}),t.map(({intervals:he,partId:ge,name:Oe})=>s.jsxs("tbody",{children:[j&&he.length>0&&Oe?.trim()&&s.jsxs("tr",{children:[s.jsx(OG,{children:s.jsx("div",{className:"time-period-text",children:Oe})}),s.jsx(OG,{colSpan:L})]}),he.map(({intervalId:Xe,name:Se,start:dt,end:et})=>s.jsxs("tr",{children:[s.jsx(k0t,{className:"cell hour-cell",children:Se},`hour-${Xe}`),ye.map(({iso:we,dayId:Ut},ys)=>{const Xs={start:dt,end:et},as=wo(n,`${we}.${ge}.${Xe}`,void 0)||uHt(we,dt,et);Be.push(as);const Gr=K[`${Ut}|${ge}|${Xe}`];Gr&&be.current.push(Gr);const es=!!as?.isUpcomingOrder,pr=ys===ye.length-1&&l!==de;return s.jsx(ie.Fragment,{children:s.jsx(H0t,{className:`col${ys}`,ref:"slotId"in as&&as?.slotId===r?.slotId?ce:null,isMobile:y,children:s.jsxs(G0t,{children:[s.jsx(RHt,{isSlotBooking:$(as),booked:w(as),interval:Xs,onClick:o,orderPlaced:es,slot:as}),pr&&B&&s.jsx(M0t,{})]})})},`${we}.${ge}.${Xe}`)})]},`${ge}-${Xe}`))]},ge))]})]})},WHt=T.div`
    position: fixed;
    inset: 0;
    ${Nb("transform .2s linear opacity")}
    background-color: rgb(0 0 0 / 75%);
    block-size: 100%;
    opacity: 0.5;
    inline-size: 100%;
    z-index: ${Qt.overlay};
`,qHt=()=>s.jsx(WHt,{"data-test":"slot-booking-loading-overlay",children:s.jsx(se,{align:"center",additionalCss:"block-size: 100%;",children:s.jsx(Rs,{})})}),KHt=()=>{const e=F(),t=E(D("socsb")),n=E(hn),o=E(iS),r=E(At),a=E(uo),i=E(Ete),l=RP(i),{smallOrderChargeSlotImpression:c}=bo();return h.useEffect(()=>{t&&a&&e(qf.getSmallOrderCharge({regionId:n,shippingGroupType:o,deliveryDestinationId:a}))},[]),h.useEffect(()=>{l&&c(l)},[l]),t?s.jsx(pd,{thresholds:i,isWithIcon:!1,isWithButton:!0,orderId:r,page:"slot-booking",className:"salt-p-x--1 salt-m-y--4"}):null},zHt=(e,t)=>{const n=E(Xl),o=F(),r=E(Yt),[a]=fe(["sl.muo"]);h.useEffect(()=>{a&&!r&&!n.lastUpdated&&!n.isFetching&&o(di.getPendingOrders())},[o,a,r,n.lastUpdated,n.isFetching]);const i=a?n.orders?.filter(c=>c.status!=="CANCELLED"&&c.status!=="SCRATCHED"):[];return i?.length?i.map(c=>{const d=c?.dates?.deliveryStartDate,u=c?.dates?.deliveryEndDate,m=Sg(d,u),g=Uq(d,u,e||[]);if(!(t!==c.deliveryDestinationId||!c.slotId||!d||!u||!m||!g))return{slotId:c.slotId,slotDayId:Bi(Sn(d)),slotDateTimeISO:Sn(d),slotEndDateTimeISO:Sn(u),slotIntervalId:m,slotPartId:g,timeZoneId:c?.dates?.timeZoneId||"",carrierId:"",attributes:[],ecoSlot:!1,price:"0",deliveryPrice:{amount:"0",currency:""},isUpcomingOrder:!0,referenceOrder:c}}).filter(c=>c!==void 0):void 0},QHt=(e,t)=>{const n=E(PD),o=E(_D);if(!o)return[];const r=l=>{const c=!!e?.some(m=>m.slotDayId===l.dayId),d=l.dayId===n?.slotDayId&&n?.slotType!=="ON_DEMAND",u=t.some(m=>l.dayId===m.slotDayId);return c||d||u},a=o.findIndex(r),i=o.findLastIndex(r);return o.slice(a,i+1)},XHt=({standardSlots:e,selectedSlot:t,ecoSlotsIds:n})=>{const o=M(),r=ze(),a=Cs("slot-booking-grid-header-date-format-momentjs"),i=E(ma),l=E(Vt),c=YT(),[d]=fe(["sl.rng.cf"]),u=E(Wb),m=E(s$e),g=zHt(m,i),f=QHt(g,e),y=a||VI,I=nHt(o,l,d,u,m),S=h.useMemo(()=>oHt(o,e,n,r,g,t),[o,e,n,g?.length,t]),C=h.useMemo(()=>aHt(f||[],y,c),[f,y,c]),_=iHt(C,Vh(c));return{partsOfDayFormatted:I,slotsFormatted:S,datesChunks:_}},ZHt=({standardSlots:e,onDemandSlots:t,onDemandSlotSelectionHandler:n,onSelectSlot:o,ecoSlotsIds:r,activeBookingSlotId:a,selectedSlot:i,shouldRenderGreenVanBanner:l=!1})=>{const{partsOfDayFormatted:c,slotsFormatted:d,datesChunks:u}=XHt({standardSlots:e,ecoSlotsIds:r,selectedSlot:i}),m=e.findIndex(L=>L.slotPartId==="saverslots")>-1,g=pHt(u,c,d),f=ps({breakpoint:"sm-up"}),{formatMessage:y}=M(),I=E(uC),[S]=fe(["tx.nts"]),C=E(Yq),_=E(xs),A=E(ma),x=_==="CUSTOMER_COLLECTION"||_==="HOME_DELIVERY",R=E(Ql),O=x&&R?.slotType==="ON_DEMAND"&&R.deliveryMethod===_&&R.deliveryDestinationId===A,N=Object.keys(d).length>0,k=!O&&!N&&t?.length===0,{expressCollectionSlotImpression:j}=bo(),w=()=>S&&s.jsx("div",{className:"salt-p-x--1 salt-m-y--4",children:s.jsx(P,{children:y("orders.list.tax.inclusion.note")})});return s.jsxs(ie.Fragment,{children:[I&&s.jsx(qHt,{}),!C&&m&&s.jsx(yse,{}),s.jsx(Wte,{children:s.jsx(Ok,{flush:!0,fixed:!0,children:s.jsxs(Y.Item,{colSpan:{xs:12},children:[k&&s.jsx(EHt,{}),s.jsx(Ate,{onReserve:n,sendImpression:j,shouldSendMultiDayImpression:!0,classNameForBanner:"salt-p--2",classNameForCard:"salt-p--4",className:"salt-m-t--2"}),N&&s.jsxs("div",{className:f?"salt-m-r--1":"salt-m-r--0",children:[s.jsx(YHt,{datesChunks:u,onSelectSlot:o,partsOfDayFormatted:c,slotsFormatted:d,firstAvailableSlot:g,activeBookingSlotId:a,isSaverSlotsAvailable:m}),w(),l&&s.jsx(fHt,{})]}),!k&&s.jsx(KHt,{}),s.jsxs("div",{className:l?"":"salt-p-t--8",children:[s.jsx(Bd,{targetName:Ul.CGVB}),s.jsx($te,{})]})]})})})]})},JHt=({fetchSlots:e,gridView:t})=>{const n=F(),[o,r]=h.useState(void 0),a=E(cl),{selectPickUpPointButtonClicked:i,selectExternalCollectionPointClicked:l}=bo(),[c]=fe(["dds"]),{selectSlot:d,selectExternalAddressSlot:u,carrierSlot:m,selectSlotLoading:g}=Xte(),f=()=>{if(c)return{text:"slotbooking.open.simple.dds",onClick:()=>{n(Z.openModal(Lp)),i()}}},y=S=>{S&&l(S),r(S),u(S)},I=()=>{u(o)};return a?.type===Yi?s.jsx(NI,{variant:Lk,primaryButton:f()}):a?.view===Dq?s.jsxs(h.Fragment,{children:[s.jsx(Qte,{slot:m,loading:g,carrier:a,onContinueCheckout:d}),s.jsx(Zc,{selectedSlot:m,slotSelectionHandler:d,fetchSlots:e})]}):a?.view===Rq?s.jsxs(h.Fragment,{children:[s.jsx(Yte,{slot:m,carrier:a,onContinueCheckout:y}),s.jsx(Zc,{selectedSlot:m,slotSelectionHandler:I,fetchSlots:e})]}):s.jsxs(h.Fragment,{children:[s.jsx(Zc,{selectedSlot:m,slotSelectionHandler:d,fetchSlots:e}),s.jsx("div",{className:"salt-m-b--4",children:s.jsx(Nk,{})}),t]})},eVt=({isLoading:e,onDemandSlots:t,onDemandSlotSelectionHandler:n,onSelectSlot:o,selectedSlot:r,unconfirmedSlot:a,standardSlots:i,ecoSlotsIds:l,fetchSlots:c})=>{const d=E(Qq),u=E(_i),m=r?.slotId||a?.slotId;if(d)return s.jsx("div",{className:"salt-m-x--4","data-test":"slots-error-block",children:s.jsx(eu,{action:c,titleAs:"h2"})});if(e)return u?s.jsx(zte,{withDropdown:!1,className:"salt-m-t--2"}):s.jsx(gHt,{});const g=s.jsx(ZHt,{standardSlots:i,onDemandSlots:t,onDemandSlotSelectionHandler:n,onSelectSlot:o,ecoSlotsIds:l,activeBookingSlotId:m,selectedSlot:r,shouldRenderGreenVanBanner:!!l.length});return u?s.jsx("div",{className:"salt-m-t--2",children:s.jsx(JHt,{fetchSlots:c,gridView:g})}):g},tVt=()=>(e,t)=>e(jhe()).then(n=>n&&e(lg(n.payload.responseData.entities))).then(n=>VN.getDeliveryStatuses(n,e,t())),sVt={getOrders:tVt},nVt=D("seo.rdbl"),oVt=()=>{const e=F(),{formatMessage:t}=M(),[n,o]=h.useState(vt()),r=E(At),a=E(nVt),i=Jd("homepage-card");h.useEffect(()=>{e(U.analyticsEvent({type:Ss.HOME_CARD_IMPRESSION,data:{CARD_TYPE:"upcomingOrderCard",STATUS:"start shopping"}}))},[]);const l=()=>{e(U.analyticsEvent({type:Ss.HOMEPAGE_UPCOMING_ORDER_CARD_CLICKED,data:{STATUS:"start shopping",ORDER_ID:r,PAGE_EVENT_ID:n}})),o(vt()),i("start-shopping-card")},c=()=>{l()},d=a?Zo():jo();return s.jsx(xn,{"data-test":"start-shopping-card",title:{text:t("logged.in.home.page.order.card.start.shopping.title"),as:"h2"},description:t("logged.in.home.page.order.card.start.shopping.subtitle"),icon:"trolley",to:{...nn(d),search:`?source=${encodeURIComponent("homepage card")}&sourceEventId=${n}`},onClick:c})},ei={YOUR_UPCOMING_ORDER:"logged.in.home.page.order.card.undelivered.uneditable.title",WE_ARE_ON_THE_WAY:"logged.in.home.page.order.card.title.we.are.on.the.way",YOU_ARE_NEXT:"logged.in.home.page.order.card.title.you.are.next",WE_ARE_HERE:"logged.in.home.page.order.card.title.we.are.here"},qr={PLANNED_DELIVERY_WINDOW:{message:"orders.list.card.status.planned.delivery.window",type:"info"},DELIVERY_ON_THE_WAY:{message:"orders.list.card.status.delivery.on.our.way",type:"info"},DELIVERY_WE_ARE_HERE:{message:"orders.list.card.status.delivery.we.are.here",type:"info"},DELIVERY_ON_THE_WAY_WITH_TIME:{message:"orders.list.card.status.delivery.on.our.way.time",type:"info"},DELIVERY_ON_THE_WAY_WITH_TIME_WINDOW:{message:"orders.list.card.status.delivery.on.our.way.eta.window",type:"info"},DELIVERY_EARLIER:{message:"orders.list.card.status.delivery.earlier",type:"warning"},DELIVERY_EARLIER_WINDOW:{message:"orders.list.card.status.delivery.earlier.eta.window",type:"warning"},DELIVERY_ON_TIME:{message:"orders.list.card.status.delivery.ontime",type:"success"},DELIVERY_ON_TIME_WINDOW:{message:"orders.list.card.status.delivery.ontime.eta.window",type:"success"},DELIVERY_DELAYED:{message:"orders.list.card.status.delivery.delayed",type:"error"},DELIVERY_DELAYED_WINDOW:{message:"orders.list.card.status.delivery.delayed.eta.window",type:"error"},DELIVERY_UNKNOWN:{message:"orders.list.card.status.delivery.unknown",type:"info"}};function jv(e){return qr[e]}const LI=(e,t,n)=>s.jsx(tE,{dateIso:e,timeZoneId:t,timeFormat:n});function rVt(e){return e&&e.from&&e.to}const Ise=(e,t,n,o)=>{switch(e?.deliveryInfo?.currentState){case"PLANNED_DELIVERY":return aVt(e.deliveryInfo,t,e.dates.timeZoneId,o);case"WE_ARE_ON_THE_WAY":return iVt(e.deliveryInfo,t,e.dates.timeZoneId,n);case"WE_ARE_HERE":return lVt();case"YOU_ARE_NEXT":return cVt(e.deliveryInfo,t,e.dates.timeZoneId,n);default:return{type:"info",text:null,icon:"orders_placed",hasEta:!1,orderStatusText:()=>s.jsx(v,{id:ei.YOUR_UPCOMING_ORDER})}}},aVt=(e,t,n,o)=>{const{estimatedTimeWindowOfArrival:r}=e.deliveryState,a=!!r;return{type:qr.PLANNED_DELIVERY_WINDOW.type,text:o&&a?()=>s.jsx(v,{id:qr.PLANNED_DELIVERY_WINDOW.message,values:{from:LI(r.from,n,t),to:LI(r.to,n,t)}}):null,hasEta:a,icon:"orders_placed",orderStatusText:()=>s.jsx(v,{id:ei.YOUR_UPCOMING_ORDER})}},iVt=(e,t,n,o)=>{const{estimatedTimeArrival:r,estimatedTimeWindowOfArrival:a}=e.deliveryState;return e.deliveryState&&r?o&&a?{type:qr.DELIVERY_ON_THE_WAY_WITH_TIME_WINDOW.type,text:()=>s.jsx(v,{id:qr.DELIVERY_ON_THE_WAY_WITH_TIME_WINDOW.message,values:{timeInterval:s.jsx(pE,{dateIsoFrom:nh(a.from,n),dateIsoTo:nh(a.to,n),timeZoneId:n,timeFormat:t})}}),hasEta:!0,icon:"home_delivery",orderStatusText:()=>s.jsx(v,{id:ei.WE_ARE_ON_THE_WAY})}:{type:qr.DELIVERY_ON_THE_WAY_WITH_TIME.type,text:()=>s.jsx(v,{id:qr.DELIVERY_ON_THE_WAY_WITH_TIME.message,values:{time:LI(r,n,t)}}),hasEta:!0,icon:"home_delivery",orderStatusText:()=>s.jsx(v,{id:ei.WE_ARE_ON_THE_WAY})}:{type:qr.DELIVERY_ON_THE_WAY.type,text:()=>s.jsx(v,{id:qr.DELIVERY_ON_THE_WAY.message}),hasEta:!1,icon:"home_delivery",orderStatusText:()=>s.jsx(v,{id:ei.WE_ARE_ON_THE_WAY})}},lVt=()=>({type:qr.DELIVERY_WE_ARE_HERE.type,text:()=>s.jsx(v,{id:qr.DELIVERY_WE_ARE_HERE.message}),icon:"orders_placed",hasEta:!1,orderStatusText:()=>s.jsx(v,{id:ei.WE_ARE_HERE})}),cVt=(e,t,n,o)=>{const{estimatedTimeWindowOfArrival:r,estimatedTimeArrival:a,status:i}=e.deliveryState;let l="";if(i==="UNKNOWN"){l="DELIVERY_UNKNOWN";const{type:c,message:d}=jv(l);return{type:c,text:()=>s.jsx(v,{id:d}),icon:"account",hasEta:!1,orderStatusText:()=>s.jsx(v,{id:ei.YOU_ARE_NEXT})}}if(o&&i&&rVt(r)){l=`DELIVERY_${i}_WINDOW`;const{type:c,message:d}=jv(l);return{type:c,text:()=>s.jsx(v,{id:d,values:{timeInterval:s.jsx(pE,{dateIsoFrom:nh(r.from,n),dateIsoTo:nh(r.to,n),timeZoneId:n,timeFormat:t})}}),icon:"account",hasEta:!0,orderStatusText:()=>s.jsx(v,{id:ei.YOU_ARE_NEXT})}}if(a&&i){l=`DELIVERY_${i}`;const{type:c,message:d}=jv(l);return{type:c,text:()=>s.jsx(v,{id:d,values:{time:LI(a,n,t)}}),icon:"account",hasEta:!0,orderStatusText:()=>s.jsx(v,{id:ei.YOU_ARE_NEXT})}}return{type:"info",text:()=>s.jsx(v,{id:qr.DELIVERY_UNKNOWN.message}),icon:"account",hasEta:!1,orderStatusText:()=>s.jsx(v,{id:ei.YOU_ARE_NEXT})}},Sse=(e,t,n,o)=>e?.deliveryInfo?Ise(e,t,n,o):null,UG=e=>e.status==="FUTURE"||e.status==="PICKED",dVt=e=>e.editStatus==="UNDER_EDIT",uVt=({firstDate:e,secondDate:t,isFirstActive:n,isSecondActive:o})=>n&&!o?-1:!n&&o?1:Kh(e,t),pVt=(e,t)=>{const n=e.dates.deliveryStartDate,o=t.dates.deliveryStartDate,r=UG(e),a=UG(t);return oh(n)&&oh(o)||r||a?uVt({firstDate:n,secondDate:o,isFirstActive:r,isSecondActive:a}):Kh(o,n)},Cse=(e=[],{ignoreEditMode:t=!1}={})=>{const n=e,o=n.find(dVt);if(o&&!t)return[o];const r=n.filter(c=>c.dates.deliveryStartDate!==null&&c.status!=="CANCELLED").sort(pVt);let a=r;const i=r.findIndex(c=>c.status==="DELIVERED");if(i===0)return r.slice(0,i+1);i>0&&(a=r.slice(0,i));const l=a.filter(c=>c.status!=="SCRATCHED");return l.length>0?l:a.length>0?[a[0]]:null},Tse=()=>{const[e,t]=h.useState([]),n=E(d4);return h.useEffect(()=>{const r=n?.fetchSuccess&&n?.orderEntitiesLastUpdated?Cse(n.orders,{ignoreEditMode:!0}):[];t(r)},[n]),{relevantOrders:e}},mVt=({dates:e})=>{const{formatMessage:t}=M(),n=e.timeZoneId||"Europe/London",o=t("order.card.reserved.fast.delivery.title",{time:So(e.deliveryEndDate,n,vn)});return s.jsx(ie.Fragment,{children:o})},CE=({order:e,carrierType:t})=>{const n=ze(),o=E(Jt),r=E(Vt),{dates:a,addressNickName:i,externalAddress:l,orderTotals:c}=e,d=E(Tg(e.shippingGroupType)),u=e.deliveryMethod==="HOME_DELIVERY"&&e.slotType==="ON_DEMAND",m=d&&l?s.jsx(v,{id:"order.card.locker.name",values:{lockerName:l.externalCollectionPointId}}):i;let g=s.jsx(go,{dateIsoFrom:a.deliveryStartDate,dateIsoTo:a.deliveryEndDate,timeZoneId:a.timeZoneId||"",dateFormat:o,timeFormat:r});d?g=s.jsx(eE,{carrierType:t,dates:a,showAsCardTitle:!0}):u&&(g=s.jsx(mVt,{dates:a}));const f=c.totalPrice?n(c.totalPrice):"";return s.jsx(v,{id:"logged.in.home.page.order.card.order.description.format",values:{interval:g,address:m,price:s.jsx("span",{children:f})}})},hVt=({order:e,carrierType:t,noAnalytics:n})=>{const o=M(),r=F(),a=E(Vt),[i,l]=h.useState(vt()),c=E(D("del.win")),d=E(D("pln.win")),u=Jd("homepage-card"),[m]=fe(["apo.liuoc"]),{relevantOrders:g}=Tse(),f=E(Tg(e.shippingGroupType));h.useEffect(()=>{n||r(U.analyticsEvent({type:Ss.HOME_CARD_IMPRESSION,data:{CARD_TYPE:"upcomingOrderCard",IS_ORDER_EDITABLE:"false",STATUS:"upcoming order",ORDER_ID:e.orderId,EXTERNAL_COLLECTION_POINT_ID:e.externalAddress?.externalCollectionPointId}}))},[]);const y=()=>m&&g&&g.length>1?o.formatMessage("logged.in.home.page.order.card.next.order.title"):o.formatMessage("logged.in.home.page.order.card.undelivered.uneditable.title"),I=()=>s.jsx(CE,{order:e,carrierType:t}),S=()=>{const O=e.deliveryMethod==="HOME_DELIVERY"&&e.slotType==="ON_DEMAND"&&!f?{intent:"info",text:s.jsx(v,{id:"order.card.reserved.fast.delivery.alert"})}:void 0;return x?.hasEta&&x?.text?{intent:x.type,text:x.text()}:O},C=o.formatMessage("logged.in.home.page.order.card.undelivered.uneditable.accessibility.title.label").concat(" "),_=()=>{n||A()},A=()=>{r(U.analyticsEvent({type:Ss.HOMEPAGE_UPCOMING_ORDER_CARD_CLICKED,data:{STATUS:"upcoming order",IS_ORDER_EDITABLE:"false",ORDER_ID:e.orderId,PAGE_EVENT_ID:i,EXTERNAL_COLLECTION_POINT_ID:e.externalAddress?.externalCollectionPointId}})),l(vt()),u("undelivered-uneditable-order-card")},x=Sse(e,a,c,d);return s.jsx(xn,{"data-test":"undelivered-uneditable-order-card",title:{text:x?.orderStatusText?x?.orderStatusText():y(),as:"h2",a11yText:C},description:I(),icon:x?.icon||"orders_placed",alertBanner:S(),onClick:_,to:{...nn(gn(e.orderId)),search:`?source=${encodeURIComponent("homepage card")}&sourceEventId=${i}`}})},wv=({noAnalytics:e=!1})=>{const{formatMessage:t}=M(),n=F();return h.useEffect(()=>{e||n(U.analyticsEvent({type:Ss.HOME_CARD_IMPRESSION,data:{CARD_TYPE:"upcomingOrderCard",STATUS:"order details not available"}}))},[]),s.jsx(P$,{"data-test":"order-error-card-v2",title:{text:t("logged.in.home.page.order.card.error.title"),as:"h2"},description:t("logged.in.home.page.order.card.error.subtitle"),icon:"info_default"})},gVt=({order:e,carrierType:t,noAnalytics:n})=>{const o=M(),r=F(),a=E(Jt),i=E(Vt),[l,c]=h.useState(vt()),d=Jd("homepage-card"),[u]=fe(["apo.liuoc"]),{relevantOrders:m}=Tse();h.useEffect(()=>{n||r(U.analyticsEvent({type:Ss.HOME_CARD_IMPRESSION,data:{CARD_TYPE:"upcomingOrderCard",IS_ORDER_EDITABLE:"true",STATUS:"upcoming order",ORDER_ID:e.orderId,EXTERNAL_COLLECTION_POINT_ID:e.externalAddress?.externalCollectionPointId}}))},[]);const g=()=>u&&m&&m.length>1?s.jsx(v,{id:"logged.in.home.page.order.card.next.order.title"}):s.jsx(v,{id:"logged.in.home.page.order.card.undelivered.editable.title"}),f=()=>s.jsx(CE,{order:e,carrierType:t}),y=o.formatMessage("logged.in.home.page.order.card.undelivered.editable.accessibility.title.label").concat(" "),I=()=>s.jsxs(h.Fragment,{children:[s.jsx(v,{id:"logged.in.home.page.order.card.undelivered.editable.alert.text"})," ",s.jsx(El,{dateIso:e.dates.confirmOrderChangesBy,timeZoneId:e.dates.timeZoneId,local:!0,dateFormat:a,timeFormat:i})]}),S=()=>{n||C()},C=()=>{r(U.analyticsEvent({type:Ss.HOMEPAGE_UPCOMING_ORDER_CARD_CLICKED,data:{STATUS:"upcoming order",IS_ORDER_EDITABLE:"true",ORDER_ID:e.orderId,PAGE_EVENT_ID:l,EXTERNAL_COLLECTION_POINT_ID:e.externalAddress?.externalCollectionPointId}})),c(vt()),d("undelivered-editable-order-card")};return s.jsx(xn,{"data-test":"undelivered-editable-order-card",title:{text:g(),as:"h2",a11yText:y},description:f(),icon:"orders_placed",alertBanner:{intent:"action",text:I()},onClick:S,to:{...nn(gn(e.orderId)),search:`?source=${encodeURIComponent("homepage card")}&sourceEventId=${l}`}})},EVt=({order:e,carrierType:t,noAnalytics:n})=>{const o=M(),r=F(),a=E(Jt),i=E(Vt),[l]=fe(["csoei"]),[c,d]=h.useState(vt()),u=Jd("homepage-card");h.useEffect(()=>{n||r(U.analyticsEvent({type:Ss.HOME_CARD_IMPRESSION,data:{CARD_TYPE:"upcomingOrderCard",STATUS:"editing order",ORDER_ID:e.orderId,EXTERNAL_COLLECTION_POINT_ID:e.externalAddress?.externalCollectionPointId}}))},[]);const m=()=>s.jsx(v,{id:"logged.in.home.page.order.card.under.edit.title"}),g=()=>s.jsx(CE,{order:e,carrierType:t}),f=()=>s.jsxs(h.Fragment,{children:[s.jsx(v,{id:"logged.in.home.page.order.card.under.edit.subtitle"})," ",s.jsx(El,{dateIso:e.dates.confirmOrderChangesBy,timeZoneId:e.dates.timeZoneId,local:!0,dateFormat:a,timeFormat:i})]}),y=()=>s.jsx(v,{id:"logged.in.home.page.order.card.under.edit.alert.text"}),I=o.formatMessage("logged.in.home.page.order.card.under.edit.accessibility.title.label").concat(" "),S=()=>{r(U.analyticsEvent({type:Ss.HOMEPAGE_UPCOMING_ORDER_CARD_CLICKED,data:{STATUS:"editing order",ORDER_ID:e.orderId,PAGE_EVENT_ID:c,EXTERNAL_COLLECTION_POINT_ID:e.externalAddress?.externalCollectionPointId}})),d(vt()),u("order-under-edit-card")},C=()=>{n||S()};return s.jsx(xn,{"data-test":"order-under-edit-card",icon:"orders_edit",title:{text:m(),as:"h2",a11yText:I},description:l?f():g(),additionalInfo:l?null:f(),onClick:C,alertBanner:{intent:"warning",text:y()},to:{...nn(gn(e.orderId)),search:`?source=${encodeURIComponent("homepage card")}&sourceEventId=${c}`}})},fVt=({order:e,carrierType:t,noAnalytics:n})=>{const o=M(),r=F(),[a,i]=h.useState(vt()),l=Jd("homepage-card");h.useEffect(()=>{n||r(U.analyticsEvent({type:Ss.HOME_CARD_IMPRESSION,data:{CARD_TYPE:"upcomingOrderCard",STATUS:"order cancelled",ORDER_ID:e.orderId,EXTERNAL_COLLECTION_POINT_ID:e.externalAddress?.externalCollectionPointId}}))},[]);const c=()=>{r(U.analyticsEvent({type:Ss.HOMEPAGE_UPCOMING_ORDER_CARD_CLICKED,data:{STATUS:"order cancelled",ORDER_ID:e.orderId,PAGE_EVENT_ID:a,EXTERNAL_COLLECTION_POINT_ID:e.externalAddress?.externalCollectionPointId}})),i(vt()),l("order-scratched-card")},d=()=>{n||c()},u=()=>s.jsx(v,{id:"logged.in.home.page.order.card.order.scratched.title"}),m=()=>s.jsx(CE,{order:e,carrierType:t}),g=o.formatMessage("logged.in.home.page.order.card.order.scratched.accessibility.title.label").concat(" ");return s.jsx(xn,{"data-test":"order-scratched-card",icon:"info_default",title:{text:u(),as:"h2",a11yText:g},description:m(),to:{...nn(gn(e.orderId)),search:`?source=${encodeURIComponent("homepage card")}&sourceEventId=${a}`},onClick:d})},yVt=({order:e,carrierType:t,noAnalytics:n})=>{const o=M(),r=F(),[a,i]=h.useState(vt()),l=Jd("homepage-card"),{orderId:c,externalAddress:d}=e;h.useEffect(()=>{n||r(U.analyticsEvent({type:Ss.HOME_CARD_IMPRESSION,data:{CARD_TYPE:"upcomingOrderCard",STATUS:"last order",ORDER_ID:c,EXTERNAL_COLLECTION_POINT_ID:d?.externalCollectionPointId}}))},[]);const u=()=>{r(U.analyticsEvent({type:Ss.HOMEPAGE_UPCOMING_ORDER_CARD_CLICKED,data:{STATUS:"last order",ORDER_ID:c,PAGE_EVENT_ID:a,EXTERNAL_COLLECTION_POINT_ID:d?.externalCollectionPointId}})),i(vt()),l("previous-order")},m=()=>{n||u()},g=()=>s.jsx(v,{id:"logged.in.home.page.order.card.previous.order.title"}),f=()=>s.jsx(CE,{order:e,carrierType:t}),y=o.formatMessage("logged.in.home.page.order.card.previous.order.accessibility.title.label").concat(" ");return s.jsx(xn,{"data-test":"order-delivered-card",title:{text:g(),as:"h2",a11yText:y},description:f(),icon:"orders",to:{...nn(gn(e.orderId)),search:`?source=${encodeURIComponent("homepage card")}&sourceEventId=${a}`},onClick:m})},IVt=({alternativeOrder:e,noAnalytics:t=!1})=>{const n=F(),[o,r]=h.useState(!1),a=E(d4),i=E(Yt);h.useEffect(()=>(!e&&(!i||!a.lastUpdated&&!a.isFetching)&&l(),()=>{r(!1)}),[]);const l=()=>n(sVt.getOrders()).catch(()=>r(!0)),c=(y,I)=>{const S=I?.slotBookingComponent;if(["NOT_EDITABLE","EDIT_EXPIRED","PENDING_PAYMENT","OTHER_UNDER_EDIT"].includes(y.editStatus||""))switch(y.status){case"FUTURE":case"PICKED":return s.jsx(hVt,{order:y,carrierType:S,noAnalytics:t});case"SCRATCHED":return s.jsx(fVt,{order:y,carrierType:S,noAnalytics:t});case"DELIVERED":return s.jsx(yVt,{order:y,carrierType:S,noAnalytics:t});default:return Me.api.pushError(new Error("WebAnalytics: Failed to load order.status"),{context:{order:JSON.stringify(y)}}),s.jsx(wv,{noAnalytics:t})}return y.editStatus==="EDITABLE"?s.jsx(gVt,{order:y,carrierType:S,noAnalytics:t}):y.editStatus==="UNDER_EDIT"?s.jsx(EVt,{order:y,carrierType:S,noAnalytics:t}):(Me.api.pushError(new Error("WebAnalytics: Failed to load order"),{context:{order:JSON.stringify(y)}}),s.jsx(wv,{noAnalytics:t}))},d=e||a.fetchSuccess&&a.orderEntitiesLastUpdated,u=!e&&d?Cse(a.orders):[],m=e||(u?.[0]?u[0]:null),{isReady:g,carrierDetails:f}=Jg({carrierId:m?.carrierId,shippingGroupType:m?.shippingGroupType});return o?(Me.api.pushError(new Error("WebAnalytics: Failed to load order"),{context:{errorFetching:o.toString()}}),s.jsx(wv,{noAnalytics:t})):!d||!g?s.jsx(xn.Skeleton,{description:!0,"data-test":"order-card-skeleton"}):m?c(m,f):s.jsx(oVt,{})},SVt=()=>{const e=F(),t=E(Vo(Fk));return s.jsx(se,{gap:["sm"],onClick:()=>e(Z.closeModal()),children:s.jsx(IVt,{alternativeOrder:t?.referenceOrder,noAnalytics:!0})})},CVt=({className:e})=>s.jsx(ne,{as:"h2",className:e,children:s.jsx(v,{id:"slots.upcoming.order.card.title"})}),Fk="UPCOMING_ORDER_MODAL_NAME",TVt="upcoming-order-modal",_Vt=()=>{const e=F(),t=E(Ue(Fk)),n=()=>{e(Z.closeModal())};return s.jsxs(G,{isOpen:t,onRequestClose:n,asBottomSheet:!0,children:[s.jsx(G.Header,{align:"left",children:s.jsx(CVt,{})}),s.jsx(G.Body,{"data-test":TVt,children:s.jsx(SVt,{})})]})},vVt=({shouldRenderDeliveryDetailsPlaceholder:e,shouldRenderDeliveryDetailsSelector:t,onDeliveryDetailsSaved:n,cancelSlotSelection:o,hasUnconfirmedSlot:r})=>{const a=e||t?6:12;return s.jsxs(Y,{className:"salt-gap--2 salt-p-b--2",flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12,lg:a},children:s.jsx(Nk,{})}),s.jsx(ie.Fragment,{children:e?s.jsx(Y.Item,{colSpan:{xs:12,lg:6},children:s.jsx(Pe,{height:"40px"})}):s.jsx(ie.Fragment,{children:t&&s.jsx(Y.Item,{colSpan:{xs:12,lg:6},children:s.jsx(yE,{onDeliveryDetailsSaved:n,handleModalClose:o,hasUnconfirmedSlot:r})})})})]})},AVt=(e,t,n)=>{const o=We(),[r,a,i]=fe(["daddi","dede","dass"]),l=E(PD),[c,d]=h.useState(l),[u,m]=h.useState(null),g=F(),f=E(uo),y=E(xi);yk.usePreloadData();const I=!!(a&&e!==Et.clickAndCollect.method&&!n);h.useEffect(()=>{I&&g(TL({deliveryDestinationId:f}))},[I,f]),h.useEffect(()=>{!c&&l&&d(l)},[l,c]);const S=()=>{d(void 0),m(null)},C=h.useCallback(async(R,O)=>{if(!R||!t||!f)return Promise.reject();if(I&&!bte({deliveryOptions:O??y,featureFlags:{isDropOffRequired:!!a,isDeliveryAssetRequired:!!i,isAdditionalInfoRequired:!!r}}))return g(Z.openModal(lE)),m(R),Promise.reject();const{deliveryPrice:N,minimumOrder:k,slotId:j}=R,w="ecoSlot"in R?R.ecoSlot:void 0,L="onDemandProperties"in R;return g(ks({name:g2,attributes:{deliveryType:t,deliveryMethod:e}})),g(_k.selectSlot({slotId:j,deliveryPrice:N,minimumOrder:k,deliveryType:t,deliveryMethod:e,deliveryDestinationId:f,ecoSlot:w,type:L?"ON_DEMAND":"STANDARD",isFakeAvailable:"isFakeAvailable"in R?R?.isFakeAvailable:!1},o))},[t,e,f,y]),_=h.useCallback(async R=>{if(R&&c?.slotId!==R.slotId)if(R.isUpcomingOrder)g(Z.openModal(Fk,{referenceOrder:R.referenceOrder}));else{d(R);try{await C(R)}catch{d(l)}}},[c?.slotId,e,C]);return{selectedSlot:c,unconfirmedSlot:u,selectSlot:_,slotSelectionHandler:C,onDemandSlotSelectionHandler:R=>C(R,void 0),selectedDestinationDeliveryId:f,shouldPrepareDeliveryDetails:I,cancelSlotSelection:S,onDeliveryDetailsSaved:R=>{u&&C(u,R).finally(()=>m(null))}}},bVt=({fetchSlots:e,noDefaultCncAddress:t})=>{const n=F(),[o]=fe(["dds"]),{onDemandSlots:r}=E(rC),a=E(DD),i=E(c$e),l=E(_g),c=E(nm),d=E(Wp),u=E(xs),m=E(hx),g=E(Q8),f=eo(),y=E(_i),I=E(xIt),S=E(q8),{open:C}=wt(hc),_=ps({breakpoint:"sm-up"}),{selectedSlot:A,unconfirmedSlot:x,selectSlot:R,slotSelectionHandler:O,onDemandSlotSelectionHandler:N,selectedDestinationDeliveryId:k,shouldPrepareDeliveryDetails:j,cancelSlotSelection:w,onDeliveryDetailsSaved:L}=AVt(u,m,y),B=l||!k,W=!!(a.length||r.length),$=j&&I,K=j&&W&&!!c.length,Q=()=>{if(o)return{text:"slotbooking.open.dds",onClick:()=>n(Z.openModal(kp))}};h.useEffect(()=>{B||n(ks({name:h2}))},[B]),h.useEffect(()=>{g&&n(f({type:Fe.SLOTBOOKING_NO_SAVED_ADDRESS_DISPLAYED}))},[g]);const X=!y&&s.jsx(Cm,{className:_?"salt-m-b--4 salt-m-x--4":"salt-m-b--4"});if(d)return s.jsxs(h.Fragment,{children:[s.jsx(Cm,{className:_?"salt-m-b--4 salt-m-x--4":"salt-m-b--4"}),s.jsx(NI,{variant:u,primaryButton:Q()})]});if(S)return s.jsxs(h.Fragment,{children:[X,s.jsx(Jte,{})]});if(g)return s.jsxs(h.Fragment,{children:[X,s.jsx(ese,{})]});if(t)return s.jsxs(h.Fragment,{children:[s.jsx(Cm,{className:_?"salt-m-b--4 salt-m-x--4":"salt-m-b--4"}),s.jsx(Zte,{openCollectionPointModal:C})]});const re=!a.length&&!r.length&&!B;return s.jsx(Y,{flush:!0,fixed:!0,className:`salt-m-y--0 ${_?"salt-m-x--2":""}`,children:s.jsxs(Y.Item,{colSpan:{xs:12},children:[s.jsx(_Vt,{}),s.jsx(J1t,{}),!re&&!y&&s.jsx(Zc,{selectedSlot:A||null,slotSelectionHandler:()=>O(A||null),fetchSlots:e}),y?s.jsx(ise,{}):s.jsxs(h.Fragment,{children:[s.jsx(Cm,{className:"salt-m-b--4"}),s.jsx(vVt,{shouldRenderDeliveryDetailsPlaceholder:$,shouldRenderDeliveryDetailsSelector:K,onDeliveryDetailsSaved:L,cancelSlotSelection:w,hasUnconfirmedSlot:!!x})]}),s.jsx(eVt,{isLoading:B,onDemandSlots:r,onDemandSlotSelectionHandler:N,onSelectSlot:R,selectedSlot:A,unconfirmedSlot:x,standardSlots:a,ecoSlotsIds:i,fetchSlots:e})]})})},GG=({children:e,...t})=>s.jsx(Y,{flush:!0,fixed:!0,...t,children:s.jsx(Y.Item,{colSpan:{xs:12},children:e})}),xVt=()=>{const e=F(),t=Ne(),n=We(),o=E(_i),r=jk(),a=Mk(),[i,l,c]=fe(["bt.spl","sl.rd","sl.fsa"]),d=j1t(),u=dse(),m=ps({breakpoint:"md-up"}),{open:g,isOpen:f}=wt(hc),y=E(Wt),I=E(Gd),S=E($d),C=E(K8),_=E(z8),A=E(ix),x=E(cr),R=E(hx),O=E(xs),N=E(uo),k=E(Fa),j=E(qP),w=E(Qs),L=E(c1),B=E(Pp),W=E(r$e),$=E(Ue(Eb)),K=E(Ue(Sk)),Q=E(i$e),X=E(l$e),re=E(Dp),ue=E(G8),te=E($8),ce=E(Wp),de=E(Xst),ye=E(W8),Ae=E(Zst),Je=oo(N),Ie=oo(re),je=oo(I.isFetching),Le=oo(O),Be=cse(),he=!!l1t(N,S);G1t({enabled:c});const ge=()=>a&&X?(e(Yn.clearPersistedPreviouslySelectedAddress()),!1):a,Xe=(()=>{const Nn=Le&&Le!==O,Hr=ge();return Nn||Hr||!N||!he})()&&C,Se=O===Et.clickAndCollect.method,dt=()=>!!kk(k,S),et=l?Be:Xe&&Se&&!j&&!dt(),we=Nn=>{const Hr=ye,Ia=l&&Be,to=K&&i&&!Nn?.isFetchTriggeredBySelectSlotModal;!(ce||to||Hr||Ia||!Ae)&&O&&N&&e(d1t({deliveryDestinationId:N,deliveryMethod:O,shippingGroupType:re}))},Ut=h.useMemo(()=>Jr(we,DGe),[N,O,re,S,i,K]);h.useEffect(()=>($r(),l||e(Yn.invalidateSlots()),pr(),es(),e(DUt()),(i||de!==Q||x.didInvalidate)&&fc(),!L.lastUpdated&&!L.isFetching&&e(zc.getSupportedDeliveryMethods()),()=>{Ut.cancel(),l?(e(Yn.clearSlotGridData()),e(ea.setSelectedAddress({deliveryDestinationId:null,addressId:null}))):e(Yn.invalidateSlots())}),[]),h.useEffect(()=>{a||(Xs(),ys())},[t.pathname,t.search,W,B,w,S,re,N,k,O,$]),h.useEffect(()=>{if(!a){!C&&!I.fetchError&&pr(),es();const Nn=N&&Je!==N,Hr=Ie!==re,Ia=je&&!I.isFetching;(Nn||Hr||(l?!1:Ia))&&(l&&Ut.cancel(),fc())}return()=>{l||Ut.cancel()}},[t.pathname,t.search,W,w,S.length,re,N,k,O,$]);const ys=()=>{const Nn=!!w.data?.deliveryMethod,Hr=!w.data&&!w.isFetching,Ia=Nn||Hr||w.fetchError,to=t.pathname===mi(y);if(Ia&&to){const Eo=i1t({deliveryMethod:O,search:t.search,orderRoot:r});n(Eo,{replace:!0})}},Xs=()=>{as()&&Ur()&&de===Q&&n(jt()),as()&&!Ur()&&!$&&e(Z.openModal(Eb)),as()&&ce&&$&&e(Z.closeModal())},Ur=()=>N===k,as=()=>W&&!B,Gr=()=>{const{data:Nn}=w;j&&!N&&u(Nn?.deliveryDestinationId,Nn?.addressId)},es=()=>l?d():nu(),nu=()=>{Gr();const Nn=ue&&te&&dt();if(Xe&&Nn){const{deliveryDestinationId:to,addressId:Eo}=w.data;u(to,Eo);return}if(Xe&&(ue&&!te&&Se)){const{deliveryDestinationId:to,addressId:Eo}=gte(S,hte(w))[0]||{};u(to,Eo);return}if(et&&!f){e(U.analyticsEvent({type:Fe.MAP_RENDERED_REASON})),g();return}if(Xe&&(ue&&!te&&!Se||!ue||!dt())){const to=sse(S);if(to){const{deliveryDestinationId:Eo,addressId:Sc}=to;u(Eo,Sc),Me.api.pushError(new Error("Slot-booking page: Fallback address selected"),{context:{selectedDeliveryDestinationId:Eo,deliveryMethod:O,ddsDeliverability:w.data?.deliverability||"",ddsDeliveryDestinationId:w.data?.deliveryDestinationId||"",ddsDeliveryMethod:w.data?.deliveryMethod||""}})}}},pr=()=>{_||I.isFetching||ce||(O===Et.clickAndCollect.method?e(sn.getCustomerCollectionDeliveryDestinations()):e(sn.getHomeDeliveryDestinations()))},$r=()=>{O===Et.clickAndCollect.method?e(sn.invalidateCustomerCollectionDeliveryDestinations()):e(sn.invalidateHomeDeliveryDestinations())},fc=()=>{e(Yn.requestSlotsDebounced()),Ut()},yc=()=>us.parse(t.search)["in-checkout-walk"]==="true",ou=l?ie.Fragment:GG,Ic=l?GG:ie.Fragment;return s.jsxs(h.Fragment,{children:[s.jsx(gNt,{}),s.jsxs(ou,{children:[s.jsxs(Ic,{children:[l?s.jsx(K1t,{shrink:!m}):s.jsx(V1t,{}),!l&&s.jsxs(h.Fragment,{children:[s.jsx(W1t,{}),o?s.jsx(ise,{className:"salt-p-x--2"}):s.jsx(Cm,{className:"salt-m-x--2"})]})]}),l?s.jsx(bVt,{fetchSlots:we,noDefaultCncAddress:et}):s.jsx(a1t,{slotBooked:A,deliveryMethod:O,fetchSlots:we,deliveryType:R,inCheckoutWalk:yc(),noDefaultCncAddress:et})]})]})},Aa=()=>s.jsx(os,{type:"SlotBookingPage::route",children:s.jsx(xVt,{})});Aa.fetchData=({context:e})=>{const{dispatch:t}=e.store;return Promise.all([t(Ht.getBasket()).then(n=>n?.deliveryDestinationId?t(sn.getSelectedDeliveryDestinationData(n.deliveryDestinationId)):null),t(sn.getHomeDeliveryDestinations()),t(sn.getCustomerCollectionDeliveryDestinations()),t(zc.getSupportedDeliveryMethods())])};const RVt=()=>{const e=F(),t=E(gH),n=E(RO),o=!!E(vC),r=E(AC),a=!!E(a4),[i,l]=fe(["sb.pop","fppco"]);h.useEffect(()=>{a&&e(SP.fetchFailedOrderPayments()).catch(()=>!1),i||(!t.lastUpdated&&!t.isFetching||t.didInvalidate?e(bs.getRequiresAdditionalDetails()):t.required&&u()),o&&e(Z.openModal("failedPayment"))},[]),h.useEffect(()=>{i||t.required&&u()},[t]);const c=()=>l&&r&&r.orderId,d=()=>n.isFetching,u=()=>{e(Z.openModal("additionalDetails"))};return c()?d()?null:(e(Z.openModal("failedPayment")),s.jsx(VC,{hasRedirect:!0})):s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"delivery.page.title"}),t.required&&!i?s.jsxs(h.Fragment,{children:[s.jsx(Y,{className:"salt-m-t--16",children:s.jsx(Y.Item,{colSpan:{xs:12,sm:6,md:4},colStart:{xs:0,sm:4,md:5},children:s.jsx(ln,{description:"additional.details.page.message",primaryButton:{text:"additional.details.page.button",onClick:u}})})}),s.jsx(aJ,{})]}):s.jsx(jb,{})]})},DVt=e=>{const t=Zs.isSubscriptionEnabled;return t(e.getState())?e.dispatch(Rd.getCustomerSubscriptions()):null},Bk=()=>s.jsx(os,{type:"Delivery::route",children:s.jsx(RVt,{})});Bk.fetchData=({context:{store:e}})=>Promise.all([e.dispatch(bs.getRequiresAdditionalDetails()),DVt(e)]);const OVt=({icon:e,title:t,redirectUrl:n,message:o,selectButtonAltText:r,displayName:a,type:i,xs:l,sm:c,md:d,lg:u})=>{const{formatMessage:m}=M(),g=F(),f=We(),y=I=>(g(ks({name:DTe,event:I,attributes:{deliveryType:i}})),f(n));return s.jsxs(He.Action,{xs:l,sm:c,md:d,lg:u,chip:void 0,innerRef:void 0,children:[s.jsxs(He.Action.Header,{children:[s.jsx(me,{name:e,height:20}),s.jsx(He.Action.HeaderText,{as:"h3",children:t})]}),s.jsx(He.Action.Body,{children:o}),s.jsx(He.Action.Footer,{children:s.jsx(b,{intent:"secondary","aria-label":r,"data-synthetics":`delivery-method-${a}`,"data-test":`delivery-method-${a}`,onClick:y,children:s.jsx(b.Text,{children:m("delivery.type.select.button")})})})]})},PVt=()=>({homeDelivery:{type:Et.vanDelivery.type,displayName:"van",displayNameKey:"delivery.type.name.van",destination:yd(),icon:"home_delivery",messageKey:"delivery.type.message.van",selectButtonAltTextKey:"delivery.type.select.button.alternative.van"},customerCollection:{type:Et.clickAndCollect.type,displayName:"c&c",displayNameKey:"delivery.type.name.cnc",destination:pp(),icon:"click_collect",messageKey:"delivery.type.message.cnc",selectButtonAltTextKey:"delivery.type.select.button.alternative.cnc"}}),NVt=()=>{const{formatMessage:e}=M(),t=F(),n=Ne(),o=jk(),[r]=fe(["dcbbs"]),a=PVt(),i=E(dS),l=E(c1),c=E(Fa),d=E(Wie),u=E(Qs),m=E(u1),g={heading:e("delivery.type.select.breadcrumb"),sectionHeadingText:e("delivery.type.select.heading")};h.useEffect(()=>{!l.lastUpdated&&!l.isFetching&&t(zc.getSupportedDeliveryMethods())},[]);const f=()=>l.data.length>1,y=(N,k="")=>{const j=tt.parse(n.search);return delete j.sourceEventId,delete j.source,`${o||""}${N}${k}?${tt.stringify(j)}`},I=()=>m?m===Yi?a?.customerCollection?.destination:a?.homeDelivery?.destination:l.data?.some(k=>k===Yi)?a?.customerCollection?.destination:a?.homeDelivery?.destination,S=()=>{const N=I();return s.jsx(Qn,{to:y(N)})},C=()=>Object.values(a).map(({icon:N,displayNameKey:k,messageKey:j,selectButtonAltTextKey:w,displayName:L,type:B,destination:W})=>s.jsx(OVt,{displayName:L,icon:N,title:e(k),message:e(j),selectButtonAltText:e(w),redirectUrl:y(W),type:B},k)),_=()=>{const N=!c||!m;return f()&&N?C():S()},A=()=>s.jsx("div",{className:"salt-m-t--16",children:s.jsx(Rs,{size:"l"})}),x=l.lastUpdated,R=d&&(u.lastUpdated||!c),O=!!(x&&R);return s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"delivery.type.select.page.title"}),!O&&A(),O&&s.jsxs(h.Fragment,{children:[s.jsx(An,{children:s.jsx(ne,{as:"h1",children:g.heading})}),s.jsx(Y,{flush:!0,fixed:!0,children:s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsxs("div",{className:"salt-p-y--4",children:[r?s.jsx("div",{className:"salt-p-b--2",children:s.jsx(bI,{slotBooked:i})}):s.jsx(bI,{slotBooked:i}),s.jsx("div",{className:"salt-m-x--2",children:s.jsx(Ns,{title:g.sectionHeadingText,children:s.jsx("div",{className:"salt-m-t--4",children:s.jsx(He.Collection,{md:2,lg:2,children:_()})})})})]})})})]})]})},_se=()=>s.jsx(os,{type:"DeliveryLandingPage::route",children:s.jsx(NVt,{})});_se.fetchData=({context:{store:e}})=>e.dispatch(zc.getSupportedDeliveryMethods());const kI=D("homedel"),LVt=D("sl.dms"),MI=D("cncdel"),kVt=[{path:"/delivery",Component:ws(Ze,Bk),children:[{index:!0,Component:Xt(LVt,_se,Aa)},{path:"collection",Component:Xt(MI,Aa,lt)},{path:"collection/slots",Component:Xt(MI,Aa,lt)},{path:"home",Component:Xt(kI,Aa,lt)},{path:"home/slots",Component:Xt(kI,Aa,lt)},{path:"*",Component:lt}]}],MVt=[{path:"/orders/:orderId/delivery",Component:ws(Ze,Bk),children:[{index:!0,Component:Aa},{path:"collection",Component:Xt(MI,Aa,lt)},{path:"collection/slots",Component:Xt(MI,Aa,lt)},{path:"home",Component:Xt(kI,Aa,lt)},{path:"home/slots",Component:Xt(kI,Aa,lt)},{path:"*",Component:lt}]}],jVt=e=>[{path:"/delivery",Component:e.Main,children:kVt},{path:"/orders/:orderId/delivery",Component:e.Main,children:MVt}],vse=()=>s.jsxs(ie.Fragment,{children:[s.jsx(He.Action.Skeleton,{},"skeleton1"),s.jsx(He.Action.Skeleton,{},"skeleton2"),s.jsx(He.Action.Skeleton,{},"skeleton3")]}),bc={ERROR:"error",WARNING:"warning",SUCCESS:"success"},wVt=({linkMessage:e,alertMessage:t,selectedPlan:n,subscription:o,alertDataTest:r,values:a,type:i})=>{const l=F(),c=M();return s.jsx(Ce,{showIcon:!1,intent:i,"data-test":r,"data-test-type":i,text:s.jsxs(h.Fragment,{children:[s.jsx(v,{id:t,values:a})," ",e&&s.jsx(Qe,{onClick:()=>{(n?.subscription?.subscriptionId||o?.subscriptionId)&&l(U.analyticsEvent({type:Es.MANAGE_CURRENT_PLAN_BUTTON_CLICKED,buttonName:"Manage pass",subscriptionId:n?.subscription?.subscriptionId??o?.subscriptionId,retailerSubscriptionPlanId:n?.planId,buttonLabel:c.formatMessage(e)}))},to:Uo(),children:s.jsx(v,{id:e})})]})})};function FVt(e){const{status:t,autoRenewalStatus:n,nextRenewal:o,paymentInformation:r}=e,{isSubscriptionPlanTransitionEnabled:a,is3dsSubscriptionsFlowEnabled:i}=po(),l=a&&o?.planIsTransitioning;return o&&!o.planId?"error":t==="ACTIVE"?i&&r?.authRequired?"3ds-auth-required":l?n?"plan-transition-with-autorenewal":"plan-transition-without-auto-renewal":n?"auto-renewal":"no-auto-renewal":t==="PENDING"?"pending":"none"}function BVt({benefitGroupSubscription:e,selectedPlan:t}){const n=FVt(e),o=E(da),{benefitDescription:r,expiry:a,benefitName:i}=e;switch(n){case"error":return s.jsx(xc,{type:bc.ERROR,values:{pass:`${i} - ${r}`,expiryDate:yt(a,o)},alertMessage:"delivery.pass.plan.terminated.message",alertDataTest:"renewal-disabled-alert"});case"3ds-auth-required":return s.jsx(xc,{type:bc.ERROR,values:{pass:`${i} - ${r}`},alertDataTest:"subscription-reauth-required-alert",alertMessage:"settings.delivery.pass.reauth.message"});case"plan-transition-with-autorenewal":return s.jsx(xc,{type:bc.WARNING,selectedPlan:t,subscription:e,values:{passName:`${i} - ${r}`,transitioningDate:yt(a,o)},alertDataTest:"autorenewal-enabled-transitioning-plan-alert",alertMessage:"settings.delivery.pass.auto.switch.on.message",linkMessage:"settings.delivery.pass.auto.switch.on.link.label"});case"plan-transition-without-auto-renewal":return s.jsx(xc,{type:bc.ERROR,selectedPlan:t,subscription:e,values:{pass:`${i} - ${r}`,expiryDate:yt(a,o)},alertDataTest:"autorenewal-disabled-transitioning-plan-alert",alertMessage:"subscription.delivery.pass.ends.auto.renew.off.message",linkMessage:"delivery.pass.settings.link.label"});case"auto-renewal":return s.jsx(xc,{type:bc.SUCCESS,selectedPlan:t,subscription:e,values:{pass:`${i} - ${r}`},alertDataTest:"autorenewal-enabled-alert",alertMessage:"delivery.pass.auto.renew.on.message",linkMessage:"delivery.pass.settings.link.label"});case"no-auto-renewal":return s.jsx(xc,{type:bc.WARNING,selectedPlan:t,subscription:e,values:{pass:`${i} - ${r}`,expiryDate:yt(a,o)},alertDataTest:"autorenewal-disabled-alert",alertMessage:"delivery.pass.auto.renew.off.message",linkMessage:"delivery.pass.settings.link.label"});case"pending":return s.jsx(xc,{type:bc.WARNING,alertMessage:"settings.delivery.pass.pending.message"});case"none":default:return null}}function xc(e){return s.jsx("div",{className:"salt-m-l--2 salt-m-t--2 salt-m-b--2","data-test":"subscription-alert-simple-wrapper",children:s.jsx(wVt,{...e})})}const UVt=({modalTitle:e,headerLabelId:t})=>{const[n]=fe([gO]);return s.jsx(G.Header,{align:n?"left":"center",children:s.jsx(ne,{as:"h2",id:t,"data-test":"payment-buy-subscription-title",children:e})})},GVt=e=>E(Vo(e))??{},$Vt=({selectedPlan:e})=>{const t=E(D(SVe));return e?.freeTrial?.eligible&&t?s.jsx(Ce,{intent:"warning",text:s.jsx(v,{id:"settings.delivery.pass.free.trial.payment.method.selection.alert"}),className:"salt-m-b--2",showIcon:!1}):null},HVt=({buttonText:e,hideModalSubtitle:t,selectedPlan:n,disabled:o,selectedPaymentMethod:r,selectPaymentMethod:a,additionalDescription:i,confirmPayment:l})=>{const{preselectedWalletItem:c}=GVt(Uk),d=E(Pg),u=r===void 0||d.items.length===0;return s.jsxs(h.Fragment,{children:[!t&&s.jsx(P,{size:"l",bold:!0,className:"salt-m-b--4",children:s.jsx(v,{id:"payment.choose.payment.method"})}),s.jsx(uE,{initialFundingInstrumentId:c?.fundingInstrumentId,initialWalletItemId:c?.walletItemId,onSelectPaymentMethod:m=>a(m),additionalAlert:s.jsx($Vt,{selectedPlan:n}),selectedPayment:r,primaryButton:s.jsx(b,{intent:"action",fill:!0,disabled:u,loading:o,onClick:l,"data-test":"payment-buy-subscription-button",className:"salt-m-b--4",children:e}),additionalDescription:i,enablePayByCardOptionWhenNoMetadataAvailable:!0})]})},VVt={modalTitle:void 0},Ase=({modalTitle:e,isTaxGrossDisplayed:t,taxInfo:{taxGroups:n,taxTotal:o},headerLabelId:r,additionalDescription:a,disabled:i,hideModalSubtitle:l,selectedPlan:c,buttonText:d,confirmPayment:u,selectPaymentMethod:m,selectedPaymentMethod:g})=>s.jsxs(h.Fragment,{children:[e&&s.jsx(UVt,{modalTitle:e,headerLabelId:r}),s.jsxs(G.Body,{children:[s.jsx(mE,{isTaxGrossDisplayed:t,taxGroups:n,taxTotal:o}),s.jsx(HVt,{buttonText:d,hideModalSubtitle:l,selectedPlan:c,additionalDescription:a,disabled:i,confirmPayment:u,selectPaymentMethod:m,selectedPaymentMethod:g})]})]});Ase.defaultProps=VVt;const $G="select-payment-method-modal-header",bse=({disabled:e=!1,isFetching:t=!1,taxInfo:n={taxGroups:[],taxTotal:"",isError:!1},modalTitle:o,buttonText:r,additionalDescription:a,isTaxGrossDisplayed:i=!1,hideModalSubtitle:l=!1,selectedPlan:c,onClose:d=()=>{},onSelectPaymentMethod:u=()=>{},onConfirm:m=()=>Promise.resolve(),onAfterClose:g=()=>{},asBottomSheet:f=!1})=>{const y=E(_p),I=wt(Uk),[S,C]=h.useState(e),[_,A]=h.useState(void 0),x=F();h.useEffect(()=>{x(sm.getWalletItems())},[]);const R=()=>{x(U.analyticsEvent({type:xt.PAYMENT_METHOD_DETAILS_MODAL_DISPLAYED,userAction:"close"})),x(U.analyticsEvent({type:Es.SELECTED_DELIVERY_PASS_PLAN_MODAL_DISPLAYED,userAction:"close"}))},O=L=>{R(),L.preventDefault(),d?.(),I.close(),A(void 0),g?.()},N=L=>{A(L),x(U.analyticsEvent({type:xt.SELECT_WALLET_ITEM,description:"User selected payment method",pageEventAttributes:{page:y,walletItemId:L.walletItemId||"NOT_SAVED"}}));const B={event:"event",eventCategory:"Payment",eventAction:"SelectWalletItem",eventLabel:y,walletItemId:L.walletItemId||"NOT_SAVED"};J.sendEvent({GA:B,WA:null}),u?.(L)},k=async()=>{C(!0);try{await m?.(_)}finally{C(!1)}},j=()=>{I.open()},w=!t&&n?.isError;return s.jsxs(h.Fragment,{children:[s.jsx(G,{isOpen:I.isOpen,isLoading:t,onRequestClose:O,aria:{labelledby:$G},data:{test:"select-payment-method-modal"},asBottomSheet:f,children:w?s.jsx(jL,{actions:{onButtonClick:()=>{I.close()}}}):s.jsx(Ase,{modalTitle:o,isTaxGrossDisplayed:i,taxInfo:n,headerLabelId:$G,disabled:S,hideModalSubtitle:l,additionalDescription:a,selectedPlan:c,buttonText:r,confirmPayment:k,selectPaymentMethod:N,selectedPaymentMethod:_})}),s.jsx(kL,{close:j})]})},Uk="selectPaymentMethod",Gk=({modalsTitle:e="",confirmPaymentMethodText:t="",additionalDescription:n,preselectedWalletItem:o={},onInitiatePayment:r=()=>Promise.resolve(),selectedPlan:a,onAuthNotRequired:i=()=>Promise.resolve(),onAuthFailure:l=()=>{},onAuthCompleted:c=()=>Promise.resolve(),isTaxGrossDisplayed:d,taxInfo:u={taxGroups:[],taxTotal:"",isError:!1},onClosePaymentMethodPicker:m=()=>{},onCloseAuthorization:g=()=>{},asBottomSheet:f=!1})=>{const y=Ne(),I=F(),S=typeof window<"u",C=()=>(S?window.innerHeight:0)<750?450:650,[_,A]=h.useState(void 0),[x,R]=h.useState(void 0),[O,N]=h.useState(!1),[k,j]=h.useState(void 0),[w,L]=h.useState(!1),[B,W]=h.useState(C()),$=E(YVt),K=E(z2e);h.useEffect(()=>{if(S){const Ae=()=>{W(C())};return window.addEventListener("resize",Ae),()=>window.removeEventListener("resize",Ae)}},[S]),h.useEffect(()=>()=>{I(kt.finishPayment())},[]),h.useEffect(()=>{I(kt.setUnselectedPaymentWarning(!_))},[_]),h.useEffect(()=>{const{openPaymentModal:Ae,recoveryToken:Je}=us.parse(y.search);K?$?(I(Z.openModal("selectPaymentMethod",{preselectedWalletItem:o})),I(U.analyticsEvent({type:xt.PAYMENT_METHOD_DETAILS_MODAL_DISPLAYED,userAction:"open"}))):Q():Ae!==void 0?I(kt.initiatePayment()):Je&&Je!==k&&j(Je)},[K]),h.useEffect(()=>{K&&_&&Q()},[_]),h.useEffect(()=>{K&&O&&r(_).then(Ae=>{Ae?R(Ae):i(_).then(()=>I(kt.finishPayment()))}).catch(ce).finally(()=>{N(!1),L(!1)})},[K,O]),h.useEffect(()=>{k&&I(Z.openModal("paymentPsp"))},[k]);const Q=()=>{I(Z.openModal("paymentPsp")),N(!0),L(!0)},X=We(),re=()=>{j(void 0);const Ae=new URLSearchParams(y.search);Ae.delete("recoveryToken"),X({search:Ae.toString(),pathname:y.pathname},{replace:!0})},ue=()=>{R(void 0),re(),I(kt.finishPayment()),g?.()},te=()=>{m?.(),_||I(kt.finishPayment())},ce=Ae=>{l(Ae),ue()},de=({walletItemId:Ae})=>(A(Ae),Promise.resolve()),ye=Ae=>{_&&I(p3.updateDefaultWalletItem(_)),c({resultToken:Ae,selectedWalletItemId:_}).then(()=>I(kt.finishPayment())),re()};return s.jsxs(h.Fragment,{children:[$&&s.jsx(bse,{selectedPlan:a,modalTitle:e,additionalDescription:n,buttonText:t,disabled:w,onConfirm:de,onClose:te,isFetching:O,isTaxGrossDisplayed:d,taxInfo:u,asBottomSheet:f}),s.jsx(MT,{title:e,handleError:ce,handleSuccess:ye,isFetching:O,url:x,onClose:ue,taxInfo:u,isTaxGrossDisplayed:d,isRecoveringThreeDs:!!k,location:y,maxWidth:"md",threeDsHeight:B,asBottomSheet:f})]})},YVt=D("pay.ywlt"),WVt=D(UH),qVt=e=>`${window.location.origin}${od(e)}${ic()}`,KVt=()=>`${window.location.origin}${ic()}`;function zVt(){const e=E(WVt),t=E(ar)??"";return()=>e?qVt(t):KVt()}function $k(e){return TEe({basePath:Wt(e)??"",clientRouteId:wa(e),csrfToken:Va(e)})}function xse(e){return e.status===401||e.status===403}function Rse(e){const t=window.location.pathname;SO(),window.location.replace(Fr({basePath:e,queryString:`destination=${encodeURIComponent(t)}`}))}const QVt=2*1e3,XVt=async({subscriptionId:e,subscriptionPoller:t,updateSubscriptionStatus:n,setStatus:o,dispatch:r})=>{try{const a=await QH.server.fetch(r,e),{status:i}=a?.payload?.responseData??{};n.current?.(i)}catch(a){o("FAILED"),clearInterval(t.current),a&&Me.api.pushError(a instanceof Error?a:new Error(`fetchSelectedSubscription error: ${JSON.stringify(a)}`))}};function Hk(e){e.subscriptionPoller.current=setInterval(XVt,QVt,e)}function am(){const e=E(Ue(Ige)),t=F();return{open:()=>{t(Z.openModal("deliveryPassSubscription"))},isOpen:e,closeModal:()=>t(Z.closeModal())}}function WT(){const e=F(),{open:t}=am(),n=h.useCallback(()=>{e(Z.openModal("paymentPsp"))},[e]),o=h.useCallback(()=>{e(Z.closeModal())},[e]);return{openPaymentPsp:n,openDeliveryPassSubscription:t,close:o}}function ZVt(){const e=WT();return t=>{t&&Me.api.pushError(t),e.close(),z.error("toast.notification.generic.error")}}function JVt({planId:e,subscriptionPoller:t,updateSubscriptionStatus:n,setStatus:o,isFreeTrialEnabled:r,regionId:a}){const i=F(),l=WT();return c=>i((d,u)=>{const m=$k(u());return ZH({postFetchOptions:m,isFreeTrialEnabled:r,planId:e,walletItemId:c,regionId:a}).then(g=>{if(g.ok)return g.json();throw xse(g)&&Rse(m.basePath),new Error(g.statusText)}).then(({status:g,subscriptionId:f})=>{g!=="ACTIVE"&&Hk({subscriptionId:f,subscriptionPoller:t,updateSubscriptionStatus:n,setStatus:o,dispatch:i}),l.openDeliveryPassSubscription()})})}function e2t({subscriptionPoller:e,updateSubscriptionStatus:t,setStatus:n,cleanUpCookie:o}){const r=F(),a=zVt(),i=WT();return({planId:l,walletItemId:c,isFreeTrialEnabled:d,regionId:u})=>r((m,g)=>{const f=$k(g());return o(),i.openPaymentPsp(),n("PENDING"),ZH({postFetchOptions:f,isFreeTrialEnabled:d,planId:l,walletItemId:c,regionId:u,checkoutUrl:a()}).then(y=>{if(y.ok)return y.json();throw xse(y)&&Rse(f.basePath),new Error(y.statusText)}).then(({status:y,subscriptionId:I,url:S})=>{if(S)return S;y!=="ACTIVE"&&Hk({subscriptionId:I,subscriptionPoller:e,updateSubscriptionStatus:t,setStatus:n,dispatch:r}),i.openDeliveryPassSubscription()})})}function t2t(){const e=F(),t=WT(),{isFreeTrialEnabled:n}=po(),o=ZVt();return({resultToken:r,cleanUpCookie:a,setStatus:i,subscriptionPoller:l,updateSubscriptionStatus:c})=>e((d,u)=>r?(a(),i("PENDING"),CEe({postFetchOptions:$k(u()),isFreeTrialEnabled:n,resultToken:r}).then(m=>{if(m.ok)return m.json();throw new Error(m.statusText)}).then(({subscriptionId:m,status:g})=>{g!=="ACTIVE"&&Hk({subscriptionId:m,subscriptionPoller:l,updateSubscriptionStatus:c,setStatus:i,dispatch:e}),t.openDeliveryPassSubscription()}).catch(o)):Promise.resolve())}const s2t=e=>!!e?.cost.currency;function TE(){const e=M(),t=ze(),n=En.client.useHooks().getComputedState().data,o=n?.displayTaxInformationGross??!1,r=n?.displayTaxInformation??!1;return a=>{const i=Number(o?a?.planPricingInformation?.grossPrice:r&&!o?a?.planPricingInformation?.netPrice:a?.cost.amount);return Number.isNaN(i)&&Me.api.pushError(new Error("Free Trial Subscription Price NaN"),{context:{options:JSON.stringify(a)}}),{toStringWithCurrency:()=>s2t(a)?t({amount:i,currency:a.cost.currency}):e.formatNumber(i),toNumber:()=>i,toCost:()=>({amount:String(i),currency:a?.cost.currency??""})}}}const Dse=()=>{const{data:e}=QH.client.useHooks().getComputedState(),{metadata:{plans:t}}=En.client.useHooks().getComputedState(),n=e?.nextRenewal?.planId;return h.useMemo(()=>{if(n===void 0)return null;const o=t.find(r=>r.planId===n);return o===void 0?null:{...e,plan:o}},[n])},n2t=T(Fn)`
    position: absolute;

    ${({position:e})=>e==="inside"?`
      inset-block-start: var(--salt-spacing-4);
      inset-inline-end: var(--salt-spacing-4);
      margin-top: var(--salt-spacing-1);
    `:`
      inset-block-start: calc(var(--salt-spacing-2) * -1);
      inset-inline-start: calc(var(--salt-spacing-2) * -1);
    `}
`,o2t=T(Fn)`
    align-self: flex-start;
`,Ose=({message:e,position:t})=>s.jsx(n2t,{position:t,intent:t==="inside"?"secondary":"primary",text:t==="inside"?e:s.jsx(v,{id:e})}),r2t=({isSubscriptionPlanTransitioning:e})=>e?s.jsx(Ose,{position:"outside",message:"settings.delivery.pass.current.pass.label"}):null,a2t=()=>s.jsx(Ose,{position:"outside",message:"settings.delivery.pass.new.pass.label"}),i2t=({message:e})=>s.jsx(o2t,{intent:"secondary",text:e}),Ab={createCurrentPlan:r2t,createNextPlan:a2t,createFreeTrial:i2t},HG=({price:e,plan:{name:t,planId:n,subscriptionId:o},onClick:r,isDisabled:a})=>{const i=M(),l=F();return s.jsx(b,{intent:"secondary",fill:!0,"aria-label":i.formatMessage("delivery.pass.subscription.button.aria.label",{name:t,price:e}),"data-test":"subscription-buy-plan",onClick:()=>(l(U.analyticsEvent({type:Es.BUY_PLAN_BUTTON_CLICKED,buttonName:"Buy plan",subscriptionId:o,retailerSubscriptionPlanId:n,buttonLabel:i.formatMessage("delivery.pass.subscription.button")})),r()),disabled:a,children:s.jsx(b.Text,{children:s.jsx(v,{id:"delivery.pass.subscription.button"})})})},l2t=({subscriptionId:e,retailerSubscriptionPlanId:t,onClick:n})=>{const o=M(),r=fa();return s.jsx(b,{intent:"primary",fill:!0,"aria-label":o.formatMessage("settings.delivery.pass.free.trial.plan.start"),"data-test":"subscription-buy-plan",onClick:()=>(r.freeTrialButtonClicked({subscriptionId:e,retailerSubscriptionPlanId:t,buttonLabel:o.formatMessage("settings.delivery.pass.free.trial.plan.start")}),n()),children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.delivery.pass.free.trial.plan.start"})})})},im=(e,t,n)=>s.jsx(Ce,{"data-test-type":t.type,intent:t.type,size:"s","data-test":n,text:e}),c2t=({expiryDate:e,calendarDateFormat:t})=>im(s.jsx(v,{id:"delivery.pass.expires.on",values:{expiryDate:yt(e,t)}}),{type:"warning"},"expiryMessage"),d2t=()=>im(s.jsx(v,{id:"delivery.pass.pending"}),{type:"warning"},"pendingMessage"),u2t=({expiryDate:e,calendarDateFormat:t})=>im(s.jsx(v,{id:"delivery.pass.expires.on",values:{expiryDate:yt(e,t)}}),{type:"warning"},"expiryMessage"),p2t=({expiryDate:e,calendarDateFormat:t})=>im(s.jsx(v,{id:"delivery.pass.expires.off",values:{renewalDate:yt(e,t)}}),{type:"success"},"renewMessage"),m2t=({expiryDate:e,calendarDateFormat:t})=>s.jsxs(ie.Fragment,{children:[im(s.jsx(v,{id:"delivery.pass.expires.on",values:{expiryDate:yt(e,t)}}),{type:"error"},"endsMessage"),s.jsx("br",{}),Pse()]}),Pse=()=>im(s.jsxs(ie.Fragment,{children:[s.jsx(v,{id:"delivery.pass.plan.transitioning.message"})," ",s.jsx(Qe,{to:Uo(),children:s.jsx(v,{id:"delivery.pass.see.details.link.label"})})]}),{type:"warning"},"transitioningMessage");function h2t(){const e=E(da);return{createExpiryNotRenewableMessage:t=>c2t({expiryDate:t,calendarDateFormat:e}),createPendingMessage:d2t,createExpiryMessage:t=>u2t({expiryDate:t,calendarDateFormat:e}),createAutoRenewalActiveMessage:t=>p2t({expiryDate:t,calendarDateFormat:e}),createTransitioningMessage:()=>Pse(),createExpiringTransitioningMessage:t=>m2t({expiryDate:t,calendarDateFormat:e})}}const g2t=e=>({name:e.name,planId:e.planId,subscriptionId:e.subscription?.subscriptionId}),E2t=({plan:e,price:t,onClick:n,status:o})=>{const r=h2t(),a=e?.subscription?.expiry??"",i=()=>({onClick:n,plan:g2t(e),price:t});switch(o){case"transitioning":return r.createTransitioningMessage();case"expiring-transitioning":return r.createExpiringTransitioningMessage(a);case"not-renewable-expiring":return r.createExpiryNotRenewableMessage(a);case"pending":return r.createPendingMessage();case"auto-renewing":return r.createAutoRenewalActiveMessage(a);case"expiring":return r.createExpiryMessage(a);case"free-trial":return s.jsx(l2t,{onClick:n,subscriptionId:e.subscription?.subscriptionId,retailerSubscriptionPlanId:e.planId});case"cannot-buy":return s.jsx(HG,{...i(),isDisabled:!0});case"can-buy":default:return s.jsx(HG,{...i(),isDisabled:!1})}};function f2t({isSubscriptionPurchaseDisabled:e,isPlanEligible:t,customerHasSubscriptionInThisBenefitGroup:n,isSuperuser:o}){return!e&&t&&!n&&!o}function y2t({plan:e,isFreeTrialEnabled:t,isSubscriptionPlanRenewing:n,isPlanTransitioning:o,isSubscriptionPlanTransitionEnabled:r,canBuy:a}){return e.subscription?o&&r?e.subscription.autoRenewalStatus?"transitioning":"expiring-transitioning":n?e.subscription.status==="PENDING"?"pending":e.subscription.autoRenewalStatus?"auto-renewing":"expiring":"not-renewable-expiring":a?t&&e.freeTrial?.eligible?"free-trial":"can-buy":"cannot-buy"}function I2t(e){const t=E(Zs.isSubscriptionPlanTransitionEnabled),n=E(Zs.isFreeTrialEnabled),o=E(Zs.isSubscriptionPurchaseDisabled),r=E(c=>c.session.isSuperuser),{nextRenewal:a}=e??{},i=!!a?.planIsTransitioning,l=a?.planId!=null;return c=>y2t({plan:c,isFreeTrialEnabled:n,isSubscriptionPlanRenewing:l,isPlanTransitioning:i,isSubscriptionPlanTransitionEnabled:t,canBuy:f2t({isSuperuser:r,isSubscriptionPurchaseDisabled:o,customerHasSubscriptionInThisBenefitGroup:!!e,isPlanEligible:!!c.eligible})})}const S2t=T(He.Action.Header)`
    justify-content: start;
`,C2t=T(He.Action.HeaderText)`
    inline-size: 100%;
`,T2t=T.span`
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-flow: nowrap;
`,_2t=T.span`
    display: flex;
    align-items: flex-start;
`,v2t=({headerText:e,body:t,footer:n,extra:o})=>s.jsxs(He.Action,{"data-test":"subscription-card",...o,children:[s.jsxs(S2t,{children:[s.jsx(me,{name:"delivery_pass",height:24,width:24}),s.jsx(C2t,{"data-test":"subscription-plan-price",as:"h3",children:e})]}),s.jsx(He.Action.Body,{align:"left",children:t}),s.jsx(He.Action.Footer,{align:"left",children:n})]}),A2t=({text:e})=>e?s.jsxs(h.Fragment,{children:[s.jsx("br",{}),e]}):null;function Vk({plan:e,onSelectPlan:t,price:n,benefitGroupSubscription:o,withFooter:r=!0,...a}){const i=I2t(o),l=E(Zs.isFreeTrialEnabled),c=E(Zs.isFlexibleFreeTrialEnabled),d=i(e)==="free-trial",u=e.freeTrial?.translation?.chip,m=r?s.jsx(E2t,{plan:e,price:n,onClick:t,status:i(e)}):void 0;return s.jsx(v2t,{extra:a,headerText:s.jsxs(T2t,{children:[e.name," - ",n,c&&d&&u&&s.jsx(_2t,{children:Ab.createFreeTrial({message:u})})]}),body:s.jsxs(ie.Fragment,{children:[e.description,l&&s.jsx(A2t,{text:e?.freeTrial?.text}),s.jsx("br",{}),s.jsx(v,{id:"delivery.pass.subscription.card"})]}),footer:m})}const b2t=({subscription:e,texts:{price:t,expiry:n}})=>s.jsxs(ie.Fragment,{children:[s.jsx(Vk,{innerRef:null,benefitGroupSubscription:void 0,onSelectPlan:()=>{},price:t,withFooter:!1,plan:e.plan,className:"salt-m--0"}),s.jsx("div",{className:"salt-m-t--4",children:s.jsx(P,{children:n})})]}),x2t=({title:e})=>s.jsx(ne,{as:"span",id:"header-title",children:e}),R2t=({primaryButton:{text:e,onClick:t},secondaryButton:{text:n,onClick:o}})=>s.jsxs(se,{direction:"column",directionLgUp:"row",basis:"100%",gap:["sm"],wrapSmUp:"wrap",children:[s.jsx(Bo,{style:{flexBasis:"0"},children:s.jsx(b,{intent:"secondary",fill:!0,onClick:o,children:s.jsx(b.Text,{children:n})})}),s.jsx(Bo,{style:{flexBasis:"0"},children:s.jsx(b,{intent:"primary",fill:!0,onClick:t,children:s.jsx(b.Text,{children:e})})})]});function qT({header:e,body:t,footer:n,dataTest:o}){const r=o?{"data-test":o}:{};return s.jsxs(h.Fragment,{children:[s.jsx(G.Header,{align:Ml,...r,children:e},"header"),s.jsx(G.Body,{children:t},"body"),n?s.jsx(G.Footer,{align:Ml,children:n},"footer"):null]})}function Nse(){const e=We(),{closeModal:t}=am(),n=r=>e(r),o=fa();return()=>{o.deliveryPassSubscribedPlanModalDisplayed("close"),t(),n(mi())}}const D2t="delivery.pass.purchased.info.title",O2t="delivery.pass.subscription.success.modal.button.slot",P2t="delivery.pass.subscription.success.modal.button.close",N2t="delivery.pass.subscription.success.modal.summary.title",L2t="delivery.pass.subscription.expiry",k2t="payment.modal.price.inclusive.tax",M2t="delivery.pass.free_trial.success_modal.title",j2t="delivery.pass.free_trial.success_modal.subtitle",w2t="delivery.pass.free_trial.success.expiry",F2t="delivery.pass.free_trial.success_modal.offer";function B2t({formatMessage:e,dateFormat:t}){return{getTitle:()=>e(D2t),getFreeTrialTitle:()=>e(M2t),getFreeTrialSubTitle:()=>e(j2t),getFreeTrialOfferMessage:()=>e(F2t),getFreeTrialExpiry:n=>e(w2t,{expiryDate:yt(n,t)}),getBookSlot:()=>e(O2t),getClose:()=>e(P2t),getSummaryTitle:()=>e(N2t),getExpiry:n=>e(L2t,{date:yt(n,t)}),getInclusiveTaxPrice:n=>e(k2t,{amount:n})}}function Lse(){const{formatMessage:e}=M(),t=E(da);return B2t({formatMessage:e,dateFormat:t})}function U2t({subscription:e,price:t}){const n=Nse(),{closeModal:o}=am(),r=Lse(),a=fa(),i=E(ja);h.useEffect(()=>{a.deliveryPassSignUp({retailerSubscriptionPlanId:e.plan.retailerPlanId,price:t.toNumber(),currency:e.plan.cost.currency,bannerId:i})},[]);const l=!!e.plan.freeTrial,{expiry:c}=e;return s.jsx(qT,{header:s.jsx(x2t,{title:r.getFreeTrialTitle()}),body:s.jsx(b2t,{subscription:e,texts:{title:r.getFreeTrialSubTitle(),price:t.toStringWithCurrency(),name:e.plan.name,expiry:l?r.getFreeTrialExpiry(c):r.getExpiry(c),offer:l?r.getFreeTrialOfferMessage():""}}),footer:s.jsx(R2t,{primaryButton:{text:r.getBookSlot(),onClick:n},secondaryButton:{text:r.getClose(),onClick:o}})})}const kse="delivery-pass-success-modal-header",G2t=({children:e})=>s.jsx(ne,{as:"h2",id:kse,children:e}),$2t=({plan:e,title:t,price:n,list:{name:o,taxContent:r},taxesBreakdown:a,expiry:i})=>s.jsxs(h.Fragment,{children:[s.jsx(Vk,{benefitGroupSubscription:void 0,innerRef:null,price:n,plan:e,onSelectPlan:()=>{},withFooter:!1,className:"salt-m--0"}),s.jsxs(Ns,{children:[s.jsxs(se,{direction:"column",className:"salt-gap--2 salt-m-t--4 salt-m-b--2",children:[s.jsx(P,{size:"m",bold:!0,children:t}),s.jsx(pe,{children:s.jsxs(pe.Group,{children:[s.jsx(pe.Title,{children:o}),s.jsx(pe.Description,{children:r})]})})]}),a,s.jsx(P,{children:i})]})]}),H2t=({secondary:{onClick:e,text:t,dataTest:n},primary:{onClick:o,text:r,dataTest:a}})=>s.jsxs(h.Fragment,{children:[s.jsx(b,{intent:"secondary",onClick:e,fill:!0,"data-test":n,className:"salt-m-r--2",children:s.jsx(b.Text,{children:t})}),s.jsx(b,{intent:"primary",onClick:o,fill:!0,"data-test":a,children:s.jsx(b.Text,{children:r})})]}),V2t="close-button",Y2t="book-delivery-button",W2t="subscription-success-modal";function q2t({taxInfo:e,isTaxGrossDisplayed:t}){const{taxGroups:n,taxTotal:o}=e;return!n.length||!o?null:s.jsx(mE,{isTaxGrossDisplayed:t,taxGroups:n,taxTotal:o})}const K2t=({price:e,subscription:t,taxInfo:n})=>{const o=Lse(),r=ze(),{data:a}=En.client.useHooks().getComputedState(),i=a?.displayTaxInformationGross??!1,l=Nse(),{closeModal:c}=am(),d=fa();h.useEffect(()=>{d.deliveryPassSubscribedPlanModalDisplayed("open"),d.deliveryPassSignUp({retailerSubscriptionPlanId:t.plan.retailerPlanId,price:e,currency:t.plan.cost.currency})},[]);const u=r({amount:e,currency:t.plan.cost.currency}),m=f=>i?s.jsx(P,{children:o.getInclusiveTaxPrice(s.jsx(P,{bold:!0,className:"salt-d--inline-block",children:f}))}):f,g=()=>{c(),d.deliveryPassSubscribedPlanModalDisplayed("close")};return s.jsx(qT,{dataTest:W2t,header:s.jsx(G2t,{children:o.getTitle()}),body:s.jsx($2t,{title:String(o.getSummaryTitle()),plan:t.plan,price:u,list:{name:t.plan.name,taxContent:m(String(u))},taxesBreakdown:q2t({taxInfo:n,isTaxGrossDisplayed:i}),expiry:String(o.getExpiry(t.expiry))}),footer:s.jsx(H2t,{secondary:{onClick:g,dataTest:V2t,text:o.getClose()},primary:{onClick:l,dataTest:Y2t,text:o.getBookSlot()}})})},Mse="delivery-pass-pending-modal-header",z2t=()=>{const e=M();return{title:e.formatMessage("delivery.pass.subscription.pending.modal.title"),description:e.formatMessage("delivery.pass.subscription.pending.modal.description")}},Q2t=()=>{const{title:e,description:t}=z2t();return s.jsx(qT,{dataTest:"subscription-pending-modal",header:s.jsxs(h.Fragment,{children:[s.jsx(ne,{as:"h1",id:Mse,children:e}),s.jsx("br",{}),s.jsx(P,{asChild:!0,bold:!0,children:s.jsx("h4",{children:t})})]}),body:s.jsxs(h.Fragment,{children:[s.jsx("div",{className:"salt-m-t--8 salt-m-b--8",children:s.jsx(Rs,{"data-test":"payment-psp-modal-spinner"})}),s.jsx("div",{className:"salt-m-b--8",children:" "})]})})},VG=T.div`
    text-align: center;
`,jse="failure-modal-header",X2t=({onClick:e})=>s.jsx(qT,{header:s.jsx(ne,{as:"h2",id:jse,children:s.jsx(v,{id:"failure.modal.title"})}),body:s.jsxs(h.Fragment,{children:[s.jsx(VG,{className:"salt-m-b--8",children:s.jsx(me,{error:!0,name:"status_no",height:100,width:100})}),s.jsx(VG,{children:s.jsx(Ce,{showIcon:!1,text:s.jsx(v,{id:"failure.modal.body"})})})]}),footer:s.jsx(b,{fill:!0,intent:"primary","data-test":"failure-modal-button",onClick:e,children:s.jsx(b.Text,{children:s.jsx(v,{id:"failure.modal.button"})})}),dataTest:"failure-modal-header"}),Z2t=({status:e,modalCloseTimeout:t,onClose:n})=>{const{isOpen:o}=am(),r=Cs("delivery-pass-subscription-modal-timeout"),a=(Number(r)||0)*1e3;h.useEffect(()=>(o&&e==="PENDING"&&(t.current=setTimeout(()=>{n()},a)),()=>{t.current&&clearTimeout(t.current)}),[o,e,t,a,n])};function J2t({isOpen:e,status:t}){if(e)return{};let n=jse;return t==="PENDING"&&(n=Mse),(t==="ACTIVE"||t==="ACTIVE-FREE-TRIAL")&&(n=kse),{labelledby:n}}function eYt(e){const t=Dse(),{isFreeTrialEnabled:n}=po();return e==="PENDING"?"PENDING":t?.status==="ACTIVE"?n&&t?.plan.freeTrial?.eligible?"ACTIVE-FREE-TRIAL":"ACTIVE":"FAILED"}const tYt=({onClose:e,transactionStatus:t,taxInfo:n,modalCloseTimeout:o})=>{const{isOpen:r,closeModal:a}=am(),i=eYt(t),l=()=>{e(),a()};Z2t({status:t,modalCloseTimeout:o,onClose:l});const c=TE(),d=Dse(),u=()=>{const m=c(d?.plan);switch(i){case"PENDING":return s.jsx(Q2t,{});case"ACTIVE-FREE-TRIAL":return s.jsx(U2t,{subscription:d,price:m});case"ACTIVE":return s.jsx(K2t,{taxInfo:n,subscription:d,price:m.toNumber()});case"FAILED":default:return s.jsx(X2t,{onClick:l})}};return s.jsx(G,{isOpen:r,onRequestClose:l,aria:J2t({isOpen:r,status:i}),children:r?u():null})},sYt=({header:e,body:t})=>s.jsxs(h.Fragment,{children:[e,s.jsx("div",{className:"salt-m-t--8",children:s.jsx(se,{justify:"start",children:t})})]});function nYt(e,t){return t?.find(n=>!!n.plans.find(o=>o.planId===e))}function oYt({selectedPlan:e}){const{isFreeTrialEnabled:t}=po(),{data:n}=En.client.useHooks().getComputedState(),{name:o}=e,r=t&&!!e?.freeTrial?.eligible,a=nYt(e.planId,n?.benefits)?.name??"",{formatMessage:i}=M(),l=TE();return s.jsx(sYt,{header:a,body:s.jsxs(se,{direction:"column",basis:"100%",className:"salt-gap--2 w-100",children:[s.jsx(P,{size:"l",bold:!0,children:i("delivery.pass.free_trial.success_modal.subtitle")}),s.jsx(P,{size:"m",children:s.jsxs(se,{justify:"space-between",children:[o,r?s.jsx(_t,{id:"delivery.pass.free_trial.success_modal.offer"}):s.jsx("div",{children:l(e).toStringWithCurrency()})]})}),s.jsx(Zn,{}),s.jsx(P,{size:"m",bold:!0,children:s.jsxs(se,{justify:"space-between",children:[s.jsx(_t,{id:"settings.delivery.pass.due.today"}),r?s.jsx(_t,{id:"delivery.pass.free_trial.success_modal.offer"}):s.jsx("div",{children:l(e).toStringWithCurrency()})]})})]})})}const rYt=({isError:e})=>({taxGroups:[],taxTotal:"",isError:e}),aYt=()=>{const e=ze(),{fetchError:t}=En.client.useHooks().getComputedState();return n=>{if(!n)return rYt({isError:t});const o=n?.planPricingInformation?.grossPrice;return{taxGroups:(n?.planPricingInformation?.taxes??[]).map(a=>({...a,taxRate:n?.planPricingInformation?.rates[a.taxCode]})).map(a=>({...a,valueAndCurrency:e({amount:a.value,currency:n.cost.currency})})),taxTotal:o?e({amount:o,currency:n.cost.currency}):"",isError:t}}},iYt=V(bd,Nr.server.getComputedState,En.server.getComputedState,(e,t,{data:n})=>{if(!e?.data&&!t.data&&!n)return;const o=t.data?.find(a=>a.benefitGroupId===n?.benefitGroupId);return e.data?.find(a=>o?.addresses?.[0]?.addressId===a.id)?.regionId});function wse({cleanUpCookie:e,selectedPlan:t}){const n=F(),o=M(),r=Ne(),a=t?.planId??"",[i,l]=h.useState(),c=aYt(),{fetch:d,getComputedState:u}=En.client.useHooks(),{data:m}=u(),g=m?.displayTaxInformationGross??!1,{is3dsSubscriptionsFlowEnabled:f,isFreeTrialEnabled:y}=po(),I=E(iYt),S=t2t(),C=E(da),_=h.useRef(),A=h.useRef(),x=h.useRef(),R=E(D("pay.ywlt")),O=JVt({planId:a,subscriptionPoller:x,updateSubscriptionStatus:A,setStatus:l,isFreeTrialEnabled:y,regionId:I}),N=e2t({subscriptionPoller:x,updateSubscriptionStatus:A,setStatus:l,cleanUpCookie:e});h.useEffect(()=>()=>{clearTimeout(_.current),clearInterval(x.current)},[]);const k=()=>{n(Z.closeModal()),R&&z.error("toast.notification.generic.error")};A.current=$=>{i==="PENDING"&&!$&&(l("FAILED"),k(),clearInterval(x.current)),$==="ACTIVE"&&l("ACTIVE"),$!=="PENDING"&&(clearInterval(x.current),(()=>{const Q=us.parse(r.search);d({benefitGroupId:Q.benefitGroupId})})())};const j=$=>f?N({planId:a,walletItemId:$,isFreeTrialEnabled:y,regionId:I}):(e(),l("PENDING"),O($)),w=({resultToken:$})=>S({resultToken:$,cleanUpCookie:e,setStatus:l,subscriptionPoller:x,updateSubscriptionStatus:A}),L=c(t),B=()=>{if(!t?.freeTrial?.eligible)return;const $=cp(t.duration,"seconds",Mt().toISOString());return s.jsx(se,{className:"salt-m-b--4",children:o.formatMessage("delivery.pass.free_trial.before.payment",{expiryDate:yt($,C)})})},W=()=>t?.freeTrial?.eligible?o.formatMessage("settings.delivery.pass.free.trial.plan.start.with.name",{planName:t.name}):o.formatMessage("delivery.pass.subscription.modal.button");return s.jsxs(h.Fragment,{children:[s.jsx(Gk,{modalsTitle:t&&s.jsx(oYt,{selectedPlan:t}),selectedPlan:t,taxInfo:L,isTaxGrossDisplayed:g,additionalDescription:B(),confirmPaymentMethodText:W(),onInitiatePayment:j,onClosePaymentMethodPicker:e,onAuthFailure:k,onAuthCompleted:w}),s.jsx(tYt,{transactionStatus:i,modalCloseTimeout:_,taxInfo:L,onClose:e})]})}wse.fetchData=({context:{store:e}})=>En.server.fetch(e.dispatch);function lYt({dataTest:e,name:t,isTaxGrossDisplayed:n,description:o,renderedPlans:r}){return s.jsxs("div",{className:"salt-m-b--8","data-test":e,children:[s.jsxs("div",{className:"salt-m-b--4",children:[s.jsxs("div",{children:[s.jsx(ne,{as:"h2",children:t}),n&&s.jsx(P,{className:"salt-m-b--2 salt-m-t--2",asChild:!0,children:s.jsx("h2",{children:s.jsx(_t,{id:"delivery.pass.prices.tax.inclusive"})})})]}),s.jsx(P,{children:o})]}),s.jsx(He.Collection,{"data-test":"benefits-plans-cards",md:2,children:r})]})}const cYt=({addCardRef:e,benefitGroupSubscription:t,benefits:n,selectPlan:o,isTaxGrossDisplayed:r,createPlanPrice:a})=>s.jsx(h.Fragment,{children:n.map(i=>{const{name:l,description:c,marketingMessage:d,plans:u,benefitId:m}=i;return s.jsx(lYt,{dataTest:m,name:l,isTaxGrossDisplayed:r,description:`${c} ${d}`,renderedPlans:u.map(g=>s.jsx(Vk,{benefitGroupSubscription:t,innerRef:f=>e(f,i,g),plan:g,onSelectPlan:()=>o(g.planId,i),price:a(g).toStringWithCurrency()},g.planId))},m)})});function Fse({benefitGroupName:e}){const t=fa(),n=Cs("delivery-pass-tac-url");return s.jsxs(P,{"data-test":"terms-and-condition-message",children:[s.jsx(v,{id:"delivery.pass.subscription.termsAndConditions.message",values:{pass:e??s.jsx(Pe,{height:"15px"}),link:s.jsx(rt,{href:n,target:"_blank",onClick:()=>t.termsAndConditionsClicked(),"data-test":"subscription-tcs-link",className:"salt-d--block lg:salt-d--inline",children:s.jsx(v,{id:"delivery.pass.subscription.termsAndConditions.link.label"})})}}),s.jsx(P,{className:"salt-d--block salt-m-t--2",children:s.jsx(v,{id:"delivery.pass.subscription.terms.and.conditions.message.disclaimer"})})]})}function KT({texts:e}){return e?s.jsxs(P,{"data-test":KT.dataTestId,children:[e.terms,s.jsx("br",{}),e.cancellation]}):s.jsx(Pe,{height:"15px"})}KT.dataTestId="terms-and-cancellation";const dYt=T.div`
    display: flex;
    flex-direction: column;
    gap: 8px;
`;function uYt({benefitGroupSubscription:e,benefitGroup:t}){const n=!e||e?.autoRenewalStatus;return s.jsxs(dYt,{children:[n&&s.jsx(KT,{texts:t?{terms:t.terms,cancellation:t.cancellation}:void 0}),t&&s.jsx(Fse,{benefitGroupName:t.name})]})}const pYt=({top:e,bottom:t})=>s.jsxs("div",{"data-test":"subscription-page",className:"salt-m-t--4 salt-m-l--2 salt-m-r--2",children:[s.jsx("div",{className:"salt-m-t--4 salt-m-b--4 salt-m-r--sm",children:e}),s.jsx("div",{className:"salt-m-t--8 salt-m-b--4 salt-m-r--sm",children:t})]});function Bse(){const e=F();return h.useCallback(()=>e(kt.initiatePayment()),[])}const mYt=({addCardRef:e,selectPlan:t,benefitGroup:n,benefitGroupSubscription:o})=>{const r=TE(),a=n?.displayTaxInformationGross??!1,i=n?.benefits??[];return s.jsx(pYt,{top:n?s.jsx(cYt,{addCardRef:e,benefits:i,createPlanPrice:r,isTaxGrossDisplayed:a,selectPlan:t,benefitGroupSubscription:o}):s.jsx(vse,{}),bottom:s.jsx(uYt,{benefitGroupSubscription:o,benefitGroup:n})})};function hYt(e,t=window){const{top:n,bottom:o,left:r,right:a}=e,{innerWidth:i,innerHeight:l}=t;return n>=0&&r>=0&&a<=i&&o<=l}function gYt(e){const t=[],n=[];return e.forEach(o=>{hYt(o.ref.getBoundingClientRect())?t.push(o):n.push(o)}),{seenCards:t,nonSeenCards:n}}function EYt(){const e=h.useRef([]);function t(n,o,r){n&&!e.current.map(a=>a.ref).includes(n)&&e.current.push({ref:n,benefit:o,plan:r})}return[e,t]}function fYt(e,t=U.analyticsEvent){const[n,o]=EYt(),r=fa();return h.useEffect(()=>{function a(){const{seenCards:i,nonSeenCards:l}=gYt(n.current);i.forEach(c=>r.deliveryPassPlanSeen({plan:`${c.benefit.name}-${c.plan.name}`,deliveryPassBenefitGroupId:e,analyticsEvent:t})),n.current=l}return a(),window.addEventListener("scroll",a),()=>{window.removeEventListener("scroll",a)}},[]),{addCardRef:o}}function yYt({benefitGroup:e}){return s.jsx(An,{children:e?s.jsxs(h.Fragment,{children:[s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"settings.delivery.pass.page.title"})}),s.jsx(P,{children:s.jsx(v,{id:"settings.delivery.pass.page.subtitle"})})]}):s.jsx(Pe.Typography,{})})}const IYt=()=>QI(J$(1)),SYt=()=>QI(zI(1));function CYt(){const e=h.useRef(new zi),t=E(Wt);return{deleteSelectedPlanId:()=>e.current.remove($s.SELECTED_PLAN_ID,{expires:IYt(),path:pn({basePath:t})}),setSelectedPlanId:n=>{e.current.set($s.SELECTED_PLAN_ID,n,{expires:SYt(),path:pn({basePath:t})})},getSelectedPlanId:()=>e.current.get($s.SELECTED_PLAN_ID)}}function TYt({benefit:e,newPlanId:t,benefits:n}){return e?e.name:n.find(o=>o.plans.find(r=>r.planId===t))?.name}function _Yt(){const e=fa();return{subscriptionStarted:({benefit:t,newPlan:n,benefitGroup:o})=>{const r=TYt({benefit:t,newPlanId:n.planId,benefits:o?.benefits??[]});e.deliveryPassSubscriptionStarted({plan:`${r}-${n.name}`,benefitGroupId:o?.benefitGroupId}),e.selectedDeliveryPassPlanModalDisplayedEvent("open")}}}const vYt=({onlyMarks:e=!1})=>{const t={[un.BLOCKS.HEADING_1]:(n,o)=>s.jsx(ne,{as:"h2",children:o}),[un.BLOCKS.HEADING_2]:(n,o)=>s.jsx(ne,{as:"h2",children:o}),[un.BLOCKS.HEADING_3]:(n,o)=>s.jsx(P,{size:"l",bold:!0,className:"salt-m-b--2",children:o}),[un.BLOCKS.PARAGRAPH]:(n,o)=>!o||Array.isArray(o)&&o.every(a=>typeof a=="string"&&a.trim()==="")?s.jsx("br",{}):s.jsx(P,{size:"m",className:"salt-m-b--4",children:o}),[un.BLOCKS.UL_LIST]:(n,o)=>s.jsx("ul",{children:o}),[un.BLOCKS.OL_LIST]:(n,o)=>s.jsx("ol",{children:o}),[un.BLOCKS.LIST_ITEM]:(n,o)=>s.jsx("li",{className:"salt-m-b--2",children:o})};return e?{renderNode:{[un.BLOCKS.PARAGRAPH]:(n,o)=>!o||Array.isArray(o)&&o.every(a=>typeof a=="string"&&a.trim()==="")?s.jsx("br",{}):s.jsxs(ie.Fragment,{children:[s.jsx("br",{}),s.jsxs(P,{size:"s",className:"salt-m-b--4",children:[o,s.jsx("br",{})]})]})}}:{renderNode:t}},AYt=T.div`
    margin-block: 20px;
    margin-inline: 8px;
`,Fv=({contentfulData:e,onlyMarks:t=!1,testId:n})=>{const o=h.useMemo(()=>vYt({onlyMarks:t}),[]),r=e?$I.documentToReactComponents(e,o):null;return s.jsx(AYt,{"data-test":n,children:r})},YG=({bannerImages:e,testId:t})=>{if(!e)return null;const{imageUrl41webp:n,imageUrl21webp:o}=e,r=T.div`
        margin-inline: 8px;
    `;return s.jsx(r,{"data-test":t,children:s.jsxs("picture",{children:[s.jsx("source",{media:"(min-width: 600px)",srcSet:n}),s.jsx("source",{media:"(max-width: 600px)",srcSet:o}),s.jsx("img",{src:n,alt:"description",style:{maxWidth:"960px",width:"100%",height:"auto",objectFit:"cover",borderRadius:"var(--salt-radius-default)"}})]})})},bYt=()=>{const{data:e}=E(XH),t=e?.items[0],n=c=>{if(!c)return null;const d=c?.ratio41?.url,u=c?.ratio21?.url;return{imageUrl41webp:`${d}?fm=webp`,imageUrl21webp:`${u}?fm=webp`}},o=n(t?.bottomHorizontalHeroCollection?.items[0]),r=n(t?.topHorizontalHeroCollection?.items[0]),a=t?.topTextArea?.json,i=t?.bottomTextArea?.json,l=t?.termsAndConditions?.json;return{bottomBannerData:o,topBannerData:r,topTextAreaData:a,bottomTextAreaData:i,termsAndConditionsData:l}},xYt=T.div`
    max-inline-size: 960px;
    margin-block: auto;
    margin-inline: auto;
`,RYt=({children:e})=>{const{bottomBannerData:t,topBannerData:n,topTextAreaData:o,bottomTextAreaData:r,termsAndConditionsData:a}=bYt();return s.jsxs(xYt,{"data-test":"contentful-wrapper",children:[s.jsx(YG,{bannerImages:n,testId:"top-horizontal-banner"}),s.jsx(Fv,{contentfulData:o,testId:"top-text-area"}),e,s.jsx(Fv,{contentfulData:r,testId:"bottom-text-area"}),s.jsx(YG,{bannerImages:t,testId:"bottom-horizontal-banner"}),s.jsx(Fv,{contentfulData:a,onlyMarks:!0,testId:"terms-and-conditions"})]})},DYt=T.div`
    max-inline-size: 960px;
    margin-block: auto;
    margin-inline: auto;
`,Use=({children:e})=>s.jsx(DYt,{children:e});function OYt({selectedPlan:e,selectPlan:t,addCardRef:n,cleanUpCookie:o,allBenefitGroupData:r}){const a=r.metadata.benefitGroupSubscription,i=r.data,l=!!a,c=d=>l&&["ACTIVE","PENDING"].includes(d??"");return s.jsxs(h.Fragment,{children:[s.jsxs(Use,{children:[s.jsx(rs,{title:"delivery.pass.page.title"}),s.jsx(yYt,{benefitGroup:i})]}),s.jsxs(RYt,{children:[c(a?.status)?s.jsx(BVt,{selectedPlan:e,benefitGroupSubscription:a}):null,s.jsx(mYt,{addCardRef:n,selectPlan:t,benefitGroup:i,benefitGroupSubscription:a})]}),s.jsx(wse,{cleanUpCookie:o,selectedPlan:e})]})}const PYt=()=>{const[e,t]=h.useState(),n=Bse(),o=_Yt(),r=F(),a=En.client.useHooks().getComputedState(),{data:i,metadata:{plans:l}}=a,c=CYt(),{addCardRef:d}=fYt(i?.benefitGroupId||""),u=h.useCallback(g=>l.find(f=>f.planId===g),[i?.benefits]),m=(g,f)=>{const y=u(g);y&&(c.setSelectedPlanId(g),t(y),n(),o.subscriptionStarted({benefit:f,newPlan:y,benefitGroup:i}))};return h.useEffect(()=>{const g=c.getSelectedPlanId();g&&(m(g),c.deleteSelectedPlanId()),r(wn.getCustomerAddresses())},[]),s.jsx(OYt,{selectedPlan:e,selectPlan:m,addCardRef:d,cleanUpCookie:c.deleteSelectedPlanId,allBenefitGroupData:a})};function Gse(){const{search:e}=Ne();return{isBenefitGroupIdInQuerystring:!!e.match(/.*benefitGroupId=([0-9a-z-]+).*/),recoveryToken:us.parse(e).recoveryToken}}function NYt(){const{isRegionAwareEnabled:e,isDeliveryPassByStoreEnabled:t}=po(),n=E(Nae);return{isDeliveryPassByStoreEnabled:t,isRegionAwarenessEnabled:n&&e}}function LYt(){const e=Gse(),{isFetching:t,fetchError:n,data:o}=Nr.client.useHooks().getComputedState(),r=E(Wx),{isFetching:a,error:i}=IEe(),{isFetching:l,fetchError:c,error:d}=En.client.useHooks().getComputedState(),{isRegionAwarenessEnabled:u,isDeliveryPassByStoreEnabled:m}=NYt(),g=f=>f.length<=1?!1:f.filter(I=>I.addresses.length>0).length>1;return m&&!e.isBenefitGroupIdInQuerystring?"ADD_BENEFIT_GROUP_ID_TO_QUERY_STRING_AND_REDIRECT_TO_DELIVERY_PASS_SUBSCRIPTION":!u||e.isBenefitGroupIdInQuerystring?d?.statusCode===404?"DELIVERY_PASS_SUBSCRIPTION_HAS_NO_PLANS":"DELIVERY_PASS_SUBSCRIPTION":t||l||a||r?"LOADING":n||c||i?"ERROR":o.length?g(o)?"BENEFIT_GROUP_ADDRESS_SELECTION":"ADD_BENEFIT_GROUP_ID_TO_QUERY_STRING_AND_REDIRECT_TO_DELIVERY_PASS_SUBSCRIPTION":"ADD_ADDRESS"}function kYt(){const{search:e}=Ne(),t=E(Yt),n=F(),{getState:o}=lp();h.useEffect(()=>{if(!t){const r=us.parse(e),a=Nr.server.getComputedState(o()).metadata.benefitGroupIdFromDefaultAddress,i=r.benefitGroupId??a;Hse(i,{dispatch:n,getState:o})}},[])}const MYt=()=>{kYt();const e=Gse(),t=LYt(),{metadata:{benefitGroupIdFromDefaultAddress:n}}=Nr.client.useHooks().getComputedState();switch(t){case"DELIVERY_PASS_SUBSCRIPTION":return s.jsx(PYt,{});case"DELIVERY_PASS_SUBSCRIPTION_HAS_NO_PLANS":return s.jsx("div",{className:"salt-m-y--2 salt-m-x--2",children:s.jsx(Ek,{})});case"LOADING":return s.jsx(vse,{});case"ADD_ADDRESS":return s.jsx(Qn,{to:Uo(),unstable__customRedirectImplementation:!0});case"BENEFIT_GROUP_ADDRESS_SELECTION":return s.jsx(Qn,{to:gVe()});case"ADD_BENEFIT_GROUP_ID_TO_QUERY_STRING_AND_REDIRECT_TO_DELIVERY_PASS_SUBSCRIPTION":return s.jsx(Qn,{to:`${ic()}?${us.stringify({benefitGroupId:n??"",recoveryToken:e.recoveryToken})}`});case"ERROR":default:return s.jsx(ur,{})}},$se=()=>s.jsx(os,{type:"SubscriptionSelection::route",children:s.jsx(MYt,{})});function Hse(e,t){const n=Zs.isContentfulEnabled(t.getState());return Promise.all([Nr.server.fetch(t.dispatch),En.server.fetch(t.dispatch,{benefitGroupId:e}),n?t.dispatch(vEe.getDeliveryPassContentfulPage()):null,t.dispatch(wn.getCustomerAddresses())])}$se.fetchData=({context:{store:e,url:t}})=>{const n=t.searchParams.get("benefitGroupId")??"",o=CJe(n);return Hse(o,e)};const Vse="#d6d6d6",jYt=T(me)`
    svg {
        fill: ${Vse};
    }
`,wYt=({addresses:e,isDisabled:t})=>s.jsxs(ie.Fragment,{children:[s.jsx("div",{className:"salt-m-t--sm salt-m-b--4 salt-m-r--sm salt-m-l--sm",children:s.jsx(v,{id:"delivery.pass.region.select.address.scope.text"})}),s.jsx("div",{className:"salt-m-b--2 salt-m-r--sm",children:s.jsx(Ve,{children:e.map(n=>s.jsx(Ve.Item,{"data-test":"addresses-list-item",children:s.jsxs(se,{align:"flex-start",justify:"flex-start",children:[s.jsx("div",{className:"salt-m-r--2 salt-m-l--sm",children:t?s.jsx(jYt,{success:!0,name:"status_yes"}):s.jsx(me,{success:!0,name:"status_yes"})}),s.jsxs("div",{className:"salt-m-r--sm salt-m-l--sm",children:[s.jsxs(P,{bold:!0,children:[n.nickname,":"]}),s.jsx(P,{children:n.address})]})]})},n.addressId))})})]}),FYt=T(b)`
    pointer-events: ${({disabled:e})=>e?"none":"auto"};
`,BYt=T(He.Action)`
    color: ${({isDisabled:e})=>e?Vse:"inherit"};
`,UYt=({benefitGroupId:e,benefitGroupNumber:t,addresses:n,isDisabled:o,...r})=>{const{formatMessage:a}=M(),i=h.useRef(vt()),l=fa();return s.jsxs(BYt,{isDisabled:o,...r,children:[s.jsx(He.Action.Header,{children:s.jsx(He.Action.HeaderText,{as:"h3",singleLine:!0,children:s.jsx(ne,{as:"span",children:s.jsx(v,{id:"delivery.pass.benefit.group.select.region.title",values:{counter:t}})})})}),s.jsxs(He.Action.Body,{align:"left",children:[s.jsx(wYt,{addresses:n,isDisabled:o??!1}),o&&s.jsx(Ce,{showIcon:!1,intent:"warning",text:a("settings.delivery.pass.region.address.undeliverable"),"data-test":"non-deliverable-alert"})]}),s.jsx(He.Action.Footer,{children:s.jsx(FYt,{asChild:!0,intent:"secondary",fill:!0,disabled:o??!1,"data-test":"benefit-group-selection-button",onClick:()=>l.selectBenefitGroupClicked({pageEventId:i.current,benefitGroupId:e}),children:s.jsx(rt,{intent:"ghost",href:`${ic()}?source=select%20benefit%20group%20button&sourceEventId=${i.current}&benefitGroupId=${e}`,children:s.jsx(b.Text,{children:s.jsx(v,{id:"delivery.pass.region.see.passes.button.text"})})})})})]},e)},GYt=(e,t)=>e.length>0&&e.some(n=>t[n.addressId]);function $Yt(){const{isDeliveryPassByStoreEnabled:e}=po(),t=E(BH);return n=>e&&!GYt(n,t)}const WG=3,HYt=({benefitGroupsAddresses:e})=>{const t=$Yt(),n=e.length>WG?WG:e.length,o=!t(e.flatMap(({addresses:r})=>r));return s.jsx(ie.Fragment,{children:o?s.jsx(He.Collection,{md:n,lg:n,children:e.map(({benefitGroupId:r,addresses:a},i)=>s.jsx(UYt,{benefitGroupId:r,benefitGroupNumber:i+1,addresses:a,isDisabled:t(a)},r))}):s.jsx(Ek,{})})},VYt=T.div`
    max-inline-size: 960px;
    margin-block: auto;
    margin-inline: auto;
    padding-inline: 8px;
`;function YYt({body:e,footer:t}){const n=s.jsxs(h.Fragment,{children:[s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"delivery.pass.region.select.subtitle"})}),s.jsx(P,{className:"salt-d--inline",children:s.jsx(v,{id:"delivery.pass.region.select.validity.text"})})]});return s.jsxs("div",{"data-test":"benefit-group-selection",children:[s.jsxs(Use,{children:[s.jsx(rs,{title:"delivery.pass.page.title"}),s.jsxs(An,{children:[s.jsx(ne,{as:"h1",children:s.jsx(v,{id:"settings.delivery.pass.page.title"})}),s.jsx(P,{children:s.jsx(v,{id:"settings.delivery.pass.page.subtitle"})})]})]}),s.jsx(VYt,{children:s.jsxs("div",{className:"salt-m-t--8 salt-m-b--8",children:[s.jsx("div",{className:"salt-m-t--8 salt-m-b--4",children:n}),e,s.jsx("div",{className:"salt-m-t--4 salt-m-b--4",children:t})]})})]})}const WYt="add-address-button",Yse=async({context:{store:e}})=>await Promise.all([e.dispatch(wn.getCustomerAddresses()),Nr.server.fetch(e.dispatch)]);function qYt(){const e=fa(),t=h.useRef(vt());return s.jsx(b,{asChild:!0,intent:"secondary",fill:!1,"data-test":WYt,onClick:()=>e.addAddressClicked(t.current),children:s.jsx(rt,{intent:"ghost",href:`${Na()}?source=add%address%20button&sourceEventId=${t.current}`,children:s.jsx(b.Text,{children:s.jsx(v,{id:"delivery.pass.region.add.address.button.text"})})})})}const KYt=()=>{const e=F(),t=E(Yt),n=Nr.client.useHooks().getComputedState().data??[];return h.useEffect(()=>{t||Yse({context:{store:{dispatch:e}}})},[]),n.length?s.jsx(YYt,{body:s.jsx(HYt,{benefitGroupsAddresses:n}),footer:s.jsx(qYt,{})}):null},Wse=()=>s.jsx(os,{type:"BenefitGroupSelection::route",children:s.jsx(KYt,{})});Wse.fetchData=Yse;const zYt=e=>[{path:"/delivery-pass",Component:ws(Ze,e.Main),children:[{path:"subscription",Component:Xt(Zs.isSubscriptionEnabled,$se,lt)},{path:"benefit-group-selection",Component:Xt(Zs.canLoadBenefitGroupSelectionScene,Wse,lt)}]}],QYt=e=>[{path:"/",Component:e.Main,children:[{index:!0,lazy:async()=>{const[{LoggedOutHomepage:t},{LoggedInHomepage:n}]=await Promise.all([Rn(()=>import("./logged-out-homepage-B_iOlxqs.js"),__vite__mapDeps([8,1,2,3,9])),Rn(()=>import("./logged-in-homepage-iGgUS9qa.js"),__vite__mapDeps([10,1,2,3,9]))]);return{Component:Gl([{condition:Ze,failComponent:t}],n)}}}]}],XYt=e=>[{path:"/smart-shop",Component:e.Main,children:[{index:!0,lazy:async()=>{const{InstantShop:t}=await Rn(async()=>{const{InstantShop:n}=await import("./instant-shop-B5H1JdQL.js");return{InstantShop:n}},__vite__mapDeps([11,1,2,3]));return{Component:Gl([{condition:n=>RC(n),failComponent:lt}],ws(Ze,t))}}}]}],ZYt=e=>[{path:"/product-range",Component:e.Main,children:[{index:!0,lazy:async()=>{const{ListerPage:t}=await Rn(async()=>{const{ListerPage:n}=await import("./lister-page-DFU_k5wa.js");return{ListerPage:n}},__vite__mapDeps([12,1,2,3]));return{Component:t}}}]}],qG=D(AN),JYt=e=>[{path:kN(),Component:ws(Ze,e.Main),children:[{index:!0,lazy:async()=>{const{MealPlan:t}=await Rn(async()=>{const{MealPlan:n}=await import("./index-CC359V3C.js");return{MealPlan:n}},__vite__mapDeps([13,1,2,3,14]));return{Component:Xt(qG,t,lt)}}}]},{path:Lct(),Component:ws(Ze,e.Main),children:[{index:!0,lazy:async()=>{const{Meals:t}=await Rn(async()=>{const{Meals:n}=await import("./meals-DukPd3jg.js");return{Meals:n}},__vite__mapDeps([15,1,2,3,14]));return{Component:Xt(qG,t,lt)}}}]}],eWt=e=>[{path:"/offers/:offerName?/:offerId",Component:e.Main,children:[{index:!0,lazy:async()=>{const{PromotionDetails:t}=await Rn(async()=>{const{PromotionDetails:n}=await import("./promotion-details-D2I5VqxA.js");return{PromotionDetails:n}},__vite__mapDeps([16,1,2,3]));return{Component:t}}}]}],qse={cancelable:!0,appliedVouchers:[]},Go=p.shape({orderId:p.string,bannerId:p.string,orderReference:p.string,slotId:p.string,primarySellerId:p.string,primarySellerName:p.string,orderTotals:p.shape({retailPrice:Ye,finalPrice:Ye,promoSavings:Ye,totalSavings:Ye}),totalItems:p.number,items:p.array,dates:p.shape({deliveryStartDate:p.string.isRequired,deliveryEndDate:p.string.isRequired,confirmOrderChangesBy:p.string.isRequired,timeZoneId:p.string.isRequired}),charges:p.shape({delivery:Ye,carrierBag:Ye}),orderLevelPromotions:p.arrayOf(p.shape()),addressId:p.string,address:p.string,addressNickName:p.string,additionalInformation:p.string,status:p.string,cancelable:p.bool,editStatus:p.string,appliedVouchers:p.arrayOf(p.shape({id:p.string.isRequired,savings:Ye})),paymentInfo:p.shape({paymentMethod:p.string,cardType:p.string,lastFourDigits:p.string,nonSavedFundingInstrument:p.bool}),hasReceipt:p.bool,external:p.bool.isRequired,recurringShoppingDefinition:p.shape({name:p.string.isRequired,frequency:p.shape({unit:p.string.isRequired,value:p.number.isRequired}).isRequired,deliveryWindow:p.shape({to:p.string.isRequired,from:p.string.isRequired,day:p.string.isRequired,dayOfWeekIso:p.number.isRequired}).isRequired}),deliveryInfo:p.shape({currentState:p.string,deliveryState:p.shape({status:p.string,estimatedTimeArrival:p.string})}),billingAddressDetails:p.shape({billingAddressId:p.string,customerId:p.string,bannerId:p.string,status:p.string,customerDetails:p.shape({fullName:p.string,taxNumber:p.string}),addressDetails:p.shape({addressLine1:p.string,addressLine2:p.string,city:p.string,administrativeArea:p.string,postalCode:p.string}),createdTimestamp:p.string})}),Kse=ee("CART_BUY_AGAIN"),tWt=({orderId:e,emptyCart:t})=>({type:"API",payload:{url:tt.stringifyUrl({url:"/v1/carts/active/buy-again",query:{...t&&{emptyCart:t}}}),pathPrefix:{client:"/api/cart",server:"/core-api"},service:"web_basket_ws",options:{body:{orderId:e},method:"POST"},...Kse}}),sWt={buyAgain:tWt,types:{CART_BUY_AGAIN:Kse}},nWt=({buyAgainResult:e,emptyCart:t})=>async(n,o)=>{if(!e)return;const r=o(),a=qs(r),i=r?.data?.basket,l=t?i?.items:[];let c=[],d=[];const u=e?.addedItems||[],m=[...new Set([...l?.map(f=>({id:f?.productId}))||[],...u?.map(f=>({id:f?.productId}))||[]])];if(!m?.length)return;let g=null;try{g=(await n(Ci({products:m,ignoreProductCache:!0})))?.payload?.product??null}catch{g=null}if(g&&(c=l?.map(f=>({...g?.[f.productId],...f})),d=u?.map(f=>({...g?.[f.productId],...f})),d?.length||c?.length)){n(U.analyticsEvent({type:js.BUY_ALL_PRODUCTS,product:d,productsRemoved:c,basketFinalPrice:e?.cartFinalPrice,addedByFunction:"ORDERS_ADD_ALL",page:"order-details"}));const f=fC({products:d,addedByFunction:"ORDERS_ADD_ALL",page:"order-details",basket:i});J.sendEvent({GA:f,WA:null}),n(U.analyticsEvent({type:Te.ADD_TO_CART_GA4,basket:i,page:"ORDER_DETAILS",addedByFunction:"ORDERS_ADD_ALL",product:d,productListName:"order-details: other"})),yC({basket:i,page:"ORDER_DETAILS",addedByFunction:"ORDERS_ADD_ALL",products:d,productListName:"order-details: other",featuredProductCampaigns:a}).forEach(I=>{J.sendEvent({GA:I,WA:null})})}},oWt=({orderId:e,emptyCart:t,navigate:n})=>async o=>{let r=null;try{r=(await o(sWt.buyAgain({orderId:e,emptyCart:t})))?.payload?.responseData}catch(i){throw z.error("toast.notification.generic.error"),i}await o(nWt({buyAgainResult:r,emptyCart:t}));const a=r?.limitedItems||[];return a?.length?(await o(Ht.getBasket()),o(vr.setMergeResult({limitedItems:a,destination:jt()})),o(Z.closeModal()),o(Z.openModal(fT))):(o(Z.closeModal()),n(jt())),r},zse={buyAgain:oWt},Yk="buyAgain",rWt=D("m.la.h"),aWt={isOpen:p.bool.isRequired,isBasketUnderEdit:p.bool.isRequired,buyAgainAction:p.func.isRequired,order:Go.isRequired,actions:p.shape({prepareCheckout:p.func.isRequired,closeModal:p.func.isRequired}).isRequired,modalLeftAlignEnabled:p.bool},iWt={modalLeftAlignEnabled:!1},KG={basketUnderEdit:{header:"order.buy.again.under.edit.modal.title",body:"order.buy.again.under.edit.modal.text",cancelChanges:"order.buy.again.under.edit.modal.cancel",saveChanges:"order.buy.again.under.edit.modal.ok"},basketHasItems:{header:"order.buy.again.modal.title",body:"order.buy.again.modal.text",cancelChanges:"order.buy.again.modal.empty",saveChanges:"order.buy.again.modal.keep"}},Wk=({actions:e,isBasketUnderEdit:t,isOpen:n,order:o,buyAgainAction:r,modalLeftAlignEnabled:a})=>{const[i,l]=h.useState(!1),{orderId:c}=o,d="buy-again-modal-header",u=t?KG.basketUnderEdit:KG.basketHasItems,m=()=>(l(!0),r({orderId:c,emptyCart:!1}));return s.jsxs(G,{isOpen:n,onRequestClose:e.closeModal,aria:{labelledby:d},children:[s.jsx(G.Header,{align:a?"left":"center",children:s.jsx(ne,{as:"h2",id:d,children:s.jsx(_t,{id:u.header})})}),s.jsx(G.Body,{children:s.jsx(_t,{id:u.body})}),s.jsx(G.Footer,{className:"salt-d--block",align:a?"left":"center",children:s.jsxs(Y,{flush:!0,children:[t&&s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{className:"salt-m-t--4",fill:!0,intent:"secondary",onClick:e.closeModal,"data-test":"buy-again-modal-under-edit-dismiss",children:s.jsx(b.Text,{children:s.jsx(_t,{id:u.cancelChanges})})})}),!t&&s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{className:"salt-m-t--4",fill:!0,intent:"secondary",onClick:()=>r({orderId:c,emptyCart:!0}),"data-test":"buy-again-modal-dismiss",children:s.jsx(b.Text,{children:s.jsx(_t,{id:u.cancelChanges})})})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx(b,{className:"salt-m-t--4",fill:!0,intent:"primary",onClick:m,"data-test":"buy-again-modal-confirm",loading:i,children:s.jsx(b.Text,{children:s.jsx(_t,{id:u.saveChanges})})})})]})})]})};Wk.propTypes=aWt;Wk.defaultProps=iWt;const lWt=e=>({isOpen:Ue(Yk)(e),isBasketUnderEdit:Mr(e),modalLeftAlignEnabled:rWt(e)}),cWt=ot({prepareCheckout:Wg,closeModal:Z.closeModal}),Qse=ke(lWt,cWt)(Wk),dWt={order:Go.isRequired,itemsCount:p.number.isRequired},{openModal:uWt}=Z,Xse=({order:e,itemsCount:t})=>{const n=We(),{formatMessage:o}=M(),r=F(),a=E(gi),i=E(Qi),l=E(ar),c=E(GD),d=()=>{r(uWt(Yk))},u=({orderId:y,emptyCart:I})=>{r(zse.buyAgain({orderId:y,emptyCart:I,navigate:n}))},m=()=>a?d():u({orderId:e.orderId}),g=()=>i==="STORE"&&e.retailerRegionId!==l,f=()=>c?"order.details.rebook":"order.again.repeat.order.button.text";return s.jsx("div",{children:!g()&&s.jsxs(h.Fragment,{children:[s.jsx(b,{intent:"action",fill:!0,onClick:m,"data-test":"buy-again-button","aria-label":o("order.again.repeat.order.button.accessibility.text",{itemsCount:t}),children:s.jsx(b.Text,{children:s.jsx(_t,{id:f()})})}),s.jsx(Qse,{order:e,buyAgainAction:u})]})})};Xse.propTypes=dWt;const pWt=(e,t,n,o)=>{const r=new Map(t.filter(g=>g!==void 0).map(g=>[g.sellerId,g.sellerName])),a=g=>g.sellerId,i=e.products&&Tm(e.products,a,r,n)||new Map,l=e.substitutes&&Tm(e.substitutes,a,r,n)||new Map,c=e.missings&&Tm(e.missings,a,r,n)||new Map,d=e.returns&&Tm(e.returns,a,r,n)||new Map,u=[...new Set([Array.from(i.keys()),Array.from(l.keys()),Array.from(c.keys()),Array.from(d.keys())].flat())],m=new Map(u.map(g=>[g,{products:i.get(g)||[],substitutes:l.get(g)||[],missings:c.get(g)||[],returns:d.get(g)||[]}]));return nZ(m,n,o)},mWt=(e,t,n)=>{const o=i=>i.product.seller?.id,r=new Map(e.map(i=>i.product.seller).filter(i=>i!==void 0).map(i=>[i.id,i.name])),a=Tm(e,o,r,t);return nZ(a,t,n)},Tm=function(t,n,o,r){const a=new Map;return t.forEach(i=>{const[l,c]=hWt(i,n,o,r);let d=a.get(c.sellerName);d||(d=[]),d.push(l),a.set(c.sellerName,d)}),a},hWt=function(t,n,o,r){const a=n(t),i=a&&o.get(a);return!a||!i?[t,r]:[t,{sellerId:a,sellerName:i}]},gWt=T.div`
    inline-size: 100%;
    border: none;
    display: flex;
    align-items: flex-start;
    flex-direction: column;
    margin-block: 0 var(--salt-spacing-8);
    margin-inline: 0;
`,EWt=T.div`
    inline-size: 100%;
`,Zse=({sellerName:e,children:t})=>s.jsxs(gWt,{"data-test":`seller-group-${ri(e)}`,children:[s.jsx(bi,{groupName:e,className:"salt-d--block salt-m-y--2"}),s.jsx(EWt,{children:t})]}),fWt={order:p.shape({lastUpdated:p.number,isFetching:p.bool,error:p.shape({statusCode:p.number}),order:Go}).isRequired,items:p.arrayOf(p.shape({product:ml,sample:p.bool,quantity:p.number,isInCurrentCatalog:p.bool})),loading:p.bool,locale:p.string.isRequired},yWt={items:[],loading:!1},qk=e=>{const{order:t,items:n,loading:o,locale:r}=e,[a]=fe(["or.sg"]);E(D("ubd"));const i=()=>n?n.reduce((u,m)=>u+m.quantity,0):0,l=()=>{const u=i();return s.jsx(gs,{children:s.jsxs("div",{children:[s.jsx(se,{align:"left",children:s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"order.again.repeat.order.title",values:{itemsCount:u}})})}),s.jsx(ae.Buttons,{loading:o,children:s.jsx("div",{className:"salt-p-t--4",children:s.jsx(Xse,{order:t.order,itemsCount:u})})})]})})},c=u=>{const m=u&&u.length>0&&u.every(I=>I.product),g=()=>u.reduce((I,S)=>(S?.sample===!0?I.sampleProducts.push(S.product.productId):I.normalProducts.push(S.product.productId),I),{sampleProducts:[],normalProducts:[]}),f=()=>{const{sampleProducts:I,normalProducts:S}=g();return[...I,...S]},y=m?u.reduce((I,S)=>(S.product&&(I[S.product.productId]={...S.product,quantityInOrder:S.quantity,isInCurrentCatalog:S.isInCurrentCatalog}),I),{}):{};return s.jsx(Xp,{productGroups:[{products:f()}],productsByProductId:y,page:"order-again",type:"order",isFetching:t.isFetching,"data-test":"order-again-products-container"},m)},d=(u,m)=>mWt(u,m,r).map(({sellerName:f,products:y})=>s.jsx(Zse,{sellerName:f,children:c(y)}));return!t.error&&t.lastUpdated&&!t.isFetching?s.jsxs(Y,{className:"md:salt-m-x--4 md:salt-p-x--2 salt-m-x--0",children:[s.jsx(Y.Item,{colSpan:{xs:12,md:8},children:s.jsxs("div",{className:"salt-m-y--4",children:[s.jsx(Ee,{asChild:!0,children:s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"catalogue.products.heading"})})}),a&&t.order&&t.order.primarySellerId&&t.order.primarySellerName?d(n,{sellerId:t.order.primarySellerId,sellerName:t.order.primarySellerName}):c(n)]})}),s.jsx(Y.Item,{colSpan:{xs:12,md:4},children:s.jsx("div",{className:"salt-m-y--4",children:l()})})]}):null},IWt=e=>({locale:Vs(e),order:Ds(e),items:G$e(e)});qk.propTypes=fWt;qk.defaultProps=yWt;const SWt=Ct(Bt,ke(IWt))(qk),bb={DELIVERED:"DELIVERED",PICKED:"PICKED"},CWt=V(e=>e.data.orders.current,e=>e.refunds),zT=V(CWt,e=>e.createdRefundRequest),TWt=V(zT,e=>e.fetchError),Kk=V(zT,e=>e.requestedItems),_Wt=V(zT,e=>e.newRefundRequestCreationCutoff),vWt=V(zT,e=>e.anyItemAvailableForRefund),AWt=e=>`${lo()}/${e}/refund-request`,bWt=({creationCutoffInformation:e,refundButton:t,orderId:n})=>s.jsxs(ie.Fragment,{children:[s.jsx(P,{className:"salt-m-b--4 salt-d--inline-block","data-test":"refund-request-creation-cutoff",children:e}),s.jsx(b,{asChild:!0,intent:"secondary",fill:!0,children:s.jsx(rt,{"data-test":"refund-request-button",intent:"ghost",href:AWt(n),children:s.jsx(b.Text,{children:t})})})]}),xWt=e=>e.orderParams.isCutoffTimeExceeded?RWt(e):DWt(e),RWt=e=>s.jsx(Ce,{text:e.messages.cutoffTimeExceeded,intent:"info","data-test":"cutoff-time-exceeded"}),DWt=e=>e.orderParams.anyItemAvailableForRefund?s.jsx(bWt,{creationCutoffInformation:e.messages.creationCutoffInformation,refundButton:e.messages.refundButton,orderId:e.orderParams.orderId}):s.jsx(Ce,{"data-test":"refund-request-no-refundables-available",text:e.messages.noMoreRefundablesAvailable,intent:"info"}),OWt=({cutoffTime:e,orderTimeZone:t})=>{const n=E(Jt),o=E(Vt);return s.jsx(El,{dateIso:kc(e,t),dateFormat:n,timeFormat:o,timeZoneId:t,local:!0})},PWt=(e,t,n)=>({creationCutoffInformation:e.formatMessage("order.details.refund-request-card.cutoff-information",{date:OWt({cutoffTime:t,orderTimeZone:n})}),refundButton:e.formatMessage("order.details.refund-request-card.button"),refundRequestNotYetAvailable:e.formatMessage("order.details.requested-for-refund.not-yet-available"),noMoreRefundablesAvailable:e.formatMessage("order.details.refund-request-card.all-products-refunded-or-requested"),cutoffTimeExceeded:e.formatMessage("order.details.refund-request-card.cutoff-expired"),refundRequestUnavailable:e.formatMessage("order.details.refund-request-card.refund-request-unavailable")});p.string.isRequired,p.bool.isRequired,p.bool.isRequired,p.any.isRequired,p.string.isRequired,p.string.isRequired,p.string.isRequired,p.bool.isRequired;const NWt=({intl:e,refundRequestCreationCutoff:t,orderTimeZone:n,orderId:o,anyItemAvailableForRefund:r,isCutoffTimeExceeded:a,isFetchingRefundStatusFailed:i,orderStatus:l})=>{const c=PWt(e,t,n);return{refundRequestOnDeliveredParams:LWt(c,o,r,a),cardInformationParams:{isFetchingRefundStatusFailed:i,orderStatus:l,messages:c}}},LWt=(e,t,n,o)=>({messages:e,orderParams:{orderId:t,anyItemAvailableForRefund:n,isCutoffTimeExceeded:o}}),kWt=({isCutoffTimeExceeded:e,orderStatus:t,anyItemAvailableForRefund:n,intl:o,refundRequestCreationCutoff:r,orderTimeZone:a,orderId:i,isFetchingRefundStatusFailed:l})=>{const{refundRequestOnDeliveredParams:c,cardInformationParams:d}=NWt({intl:o,refundRequestCreationCutoff:r,orderTimeZone:a,orderId:i,anyItemAvailableForRefund:n,isCutoffTimeExceeded:e,isFetchingRefundStatusFailed:l,orderStatus:t});return MWt(d,c)},MWt=(e,t)=>e.isFetchingRefundStatusFailed?s.jsx(Ce,{text:e.messages.refundRequestUnavailable,intent:"info","data-test":"refund-request-unavailable"}):e.orderStatus===bb.DELIVERED?xWt(t):s.jsx(Ce,{className:"salt-m-t--2",intent:"info",text:e.messages.refundRequestNotYetAvailable,"data-test":"refund-request-creation-not-available-yet"}),jWt=()=>{const{formatMessage:e}=M();return s.jsxs(ve,{"data-test":"refund-request-card",className:"salt-m-b--4",children:[s.jsx(ne,{"data-test":"refund-request-card-header",as:"h2",children:e("order.details.refund-request-card.title")}),s.jsx(Ce,{text:e("order.details.refund-request-card.refund-request-unavailable"),intent:"info","data-test":"refund-request-unavailable"})]})},wWt={intl:p.any.isRequired,refundRequestCreationCutoff:p.string.isRequired,orderDeliveryStartDate:p.string.isRequired,orderId:p.string.isRequired,orderStatus:p.string.isRequired,isExternal:p.bool.isRequired,isFetchingRefundStatusFailed:p.bool.isRequired,orderTimeZone:p.string.isRequired,formattedMessages:p.shape({cardHeader:p.string,refundButton:p.string,cutoffTimeExceeded:p.string}),isAnyItemAvailableForRefund:p.bool.isRequired},FWt={formattedMessages:{}},zk=e=>{const{refundRequestCreationCutoff:t,orderDeliveryStartDate:n,orderId:o,orderStatus:r,isExternal:a,isFetchingRefundStatusFailed:i,formattedMessages:l,intl:c,isAnyItemAvailableForRefund:d,orderTimeZone:u}=e,m=Mt().isAfter(t),g={...l,cardHeader:c.formatMessage("order.details.refund-request-card.title"),refundButton:c.formatMessage("order.details.refund-request-card.button"),refundRequestNotYetAvailable:c.formatMessage("order.details.requested-for-refund.not-yet-available"),noMoreRefundablesAvailable:c.formatMessage("order.details.refund-request-card.all-products-refunded-or-requested")};return!(r===bb.DELIVERED||r===bb.PICKED&&Mt().isSameOrAfter(n))||a?null:s.jsxs(ve,{"data-test":"refund-request-card",className:"salt-m-y--4",children:[s.jsx(ne,{"data-test":"refund-request-card-header",as:"h2",children:g.cardHeader}),s.jsx(kWt,{orderStatus:r,anyItemAvailableForRefund:d,isFetchingRefundStatusFailed:i,intl:c,isCutoffTimeExceeded:m,refundRequestCreationCutoff:t,orderId:o,orderTimeZone:u})]})},BWt=e=>({refundRequestCreationCutoff:_Wt(e),isFetchingRefundStatusFailed:TWt(e),isExternal:Ag(e),isAnyItemAvailableForRefund:vWt(e)});zk.propTypes=wWt;zk.defaultProps=FWt;const Jse=Ct(ke(BWt),zS("refunds:refund-request-card",s.jsx(jWt,{})))(zk),ene=p.shape({itemId:p.string,productId:p.string,displayPrice:p.shape({amount:Ye,averageHint:p.bool}),availableQuantity:p.number,availableRefundables:p.arrayOf(p.shape({refundableId:p.string,refundableAmount:Ye}))}),tne=p.shape({itemId:p.string,productId:p.string,displayPrice:p.shape({amount:Ye,averageHint:p.bool}),requestedQuantity:p.number,requestedRefundableIds:p.arrayOf(p.string),refundReason:p.shape({categoryDescription:p.string,reasonDescription:p.string,reasonNote:p.string}),status:p.string,rejectionReasonNote:p.string}),UWt=D("seo.rdbl"),GWt=D("refunds.netgross"),$Wt={intl:p.any.isRequired,type:p.string.isRequired,orderId:p.number,actions:p.shape({analyticsEvent:p.func.isRequired,openRefundItemModal:p.func.isRequired,openRefundRequestItemDetailsModal:p.func.isRequired,setActiveBop:p.func.isRequired}).isRequired,product:ml,refundable:p.oneOfType([ene,tne]),selectedItemData:p.shape({itemId:p.string,selectedQuantity:p.number}),tileEnabled:p.bool,position:p.number,messages:p.shape({detailsButton:p.string,requestRefundButton:p.string,selectedButton:p.string,averagePriceMessage:p.string,acceptedRefund:p.string,rejectedRefund:p.string,pendingRefund:p.string}),isSEOReadableURLEnabled:p.bool,isRefundsNetGrossEnabled:p.bool,fopProps:p.shape({name:p.string,productId:p.string,active:p.bool,linkAction:p.func,linkElement:p.oneOfType([p.string,p.func,p.elementType]),bopLink:p.string,innerRef:p.func,controls:p.shape({type:p.string,navigation:p.shape({text:p.string})}),image:p.shape({description:p.string,src:p.string}),price:p.shape({original:p.string,current:p.string,gross:p.string,type:p.string}),isFavorite:p.boolean,topAttributes:p.arrayOf(p.shape({type:p.string,value:p.oneOf([p.string,p.shape({text:p.string,accessibility:p.string})])})),size:p.shape({subtext:p.string}),status:p.shape({alert:p.bool,type:p.string,message:p.string}),hideMoreOptions:p.bool,grossPriceEnabled:p.bool}),currencyFormat:p.string},HWt={orderId:void 0,product:void 0,refundable:void 0,selectedItemData:{},position:0,tileEnabled:!1,isSEOReadableURLEnabled:!1,isRefundsNetGrossEnabled:!1,fopProps:{active:!1},messages:{}};class Qk extends h.Component{formatPrice(t){return t?$a(this.props.intl.formatNumber,t,this.props.currencyFormat):""}formatMessages(){const{messages:t,selectedItemData:n,intl:o}=this.props;t.detailsButton=o.formatMessage("order.details.refund-request-items.fop.button.details"),t.requestRefundButton=o.formatMessage("refunds.fop.non-selected.button"),t.selectedButton=o.formatMessage("refunds.fop.selected.button",{selectedQuantity:n?n.selectedQuantity:0}),t.averagePriceMessage=o.formatMessage("refunds.fop.label.average"),t.acceptedRefund=o.formatMessage("order.details.refund-request-items.status.approved"),t.rejectedRefund=o.formatMessage("order.details.refund-request-items.status.rejected"),t.pendingRefund=o.formatMessage("order.details.refund-request-items.status.pending")}formatStatusMessage(t,n){return`${t} ${n}`}prepareFopProps(){const{type:t,product:n,fopProps:o,isRefundsNetGrossEnabled:r}=this.props;o.name=n.name,o.productId=n.productId,o.image={alt:n.image.description,description:n.image.description,src:n.image.src},o.hideMoreOptions=!0,o.grossPriceEnabled=r,this.prepareProductLink(),this.prepareFopPriceProps(),this.prepareSizeProps(),t==="requested"?this.prepareRefundedProps():t==="new-request"&&this.prepareNewRequestRefundProps()}prepareSizeProps(){const{fopProps:t,refundable:n,messages:o,isRefundsNetGrossEnabled:r}=this.props,a=r?!1:n.displayPrice.averageHint;t.size=a?{subtext:o.averagePriceMessage}:null}prepareFopPriceProps(){const{fopProps:t,refundable:n,isRefundsNetGrossEnabled:o}=this.props;t.price=o?{original:"",current:this.formatPrice(n.price.net),gross:this.formatPrice(n.price.gross),type:"standard"}:{original:"",current:this.formatPrice(n.displayPrice.amount,n.displayPrice.averageHint),type:"standard"}}prepareRefundedProps(){const{fopProps:t,refundable:n,messages:o}=this.props,r=()=>{const a=vt();this.props.actions.openRefundRequestItemDetailsModal({sourceEventId:a,source:"REFUNDED_ITEM_BUTTON_CLICK",itemId:n.itemId})};t.controls={type:"action",action:{text:o.detailsButton,onClick:r,appearance:"secondary"}},n.status==="APPROVED"?t.status=o.acceptedRefund&&{message:this.formatStatusMessage(o.acceptedRefund,n.requestedQuantity),type:"success",alert:!0}:n.status==="PENDING"?t.status=o.pendingRefund&&{message:this.formatStatusMessage(o.pendingRefund,n.requestedQuantity),type:"warning",alert:!0}:n.status==="REJECTED"&&(t.status=o.rejectedRefund&&{message:this.formatStatusMessage(o.rejectedRefund,n.requestedQuantity),type:"error",alert:!0})}prepareNewRequestRefundProps(){const{actions:t,orderId:n,product:o,fopProps:r,refundable:a,messages:i}=this.props,l=()=>{t.analyticsEvent({type:vu.REQUEST_REFUND_BUTTON_CLICKED,orderId:n,productId:o.productId}),t.openRefundItemModal({itemId:a.itemId})};this.isSelected()?r.controls={type:"action",action:{text:i.selectedButton,onClick:l,appearance:"primary"}}:r.controls={type:"action",action:{text:i.requestRefundButton,onClick:l,appearance:"secondary"}},r.status=null}isSelected(){const{selectedItemData:t}=this.props;return t&&t.selectedQuantity>0}prepareProductLink(){const{fopProps:t,product:n,isSEOReadableURLEnabled:o}=this.props;t.linkAction=this.fopLinkAction,t.linkElement=n&&n.isInCurrentCatalog===!1?void 0:Qe,t.bopLink=n&&vi(n.retailerProductId,Gp(n.name,{isSEOReadableURLEnabled:o}))}fopLinkAction=()=>{const{product:t,actions:{setActiveBop:n}}=this.props;t&&(t.isInCurrentCatalog===!1?z.info("fop.not.in.current.catalog"):t.productId&&n(t.productId))};render(){const{tileEnabled:t,fopProps:n,refundable:o,selectedItemData:r}=this.props;return this.formatMessages(),this.prepareFopProps(),t?h.createElement(qp,{...n,ref:this.updateRef,key:r?r.selectedQuantity:0}):h.createElement(Ro,{...n,ref:this.updateRef,key:r?r.selectedQuantity:0,"data-test":`refund-fop-${o.itemId}`})}}const VWt=e=>({orderId:At(e),isSEOReadableURLEnabled:UWt(e),isRefundsNetGrossEnabled:GWt(e),currencyFormat:pi(e)}),YWt=ot({analyticsEvent:U.analyticsEvent,openRefundItemModal:e=>Z.openModal("refundItemRequestModal",e),openRefundRequestItemDetailsModal:e=>Z.openModal("refundRequestItemDetailsModal",e),setActiveBop:Ja.setActiveBop});Qk.propTypes=$Wt;Qk.defaultProps=HWt;const WWt=ke(VWt,YWt)(Qk),qWt={intl:p.any.isRequired,type:p.oneOf(["requested","new-request"]).isRequired,tileEnabled:p.bool,refundables:p.arrayOf(p.oneOfType([ene,tne])),selectedItems:p.arrayOf(p.shape({itemId:p.string,selectedQuantity:p.number})),productsByProductId:p.objectOf(ml).isRequired,actions:p.shape({batchAddToBasket:p.func,batchRemoveFromBasket:p.func,fetchFopData:p.func}).isRequired,hideTopBorder:p.bool,isFetching:p.bool.isRequired,"data-test":p.string},KWt={refundables:[],selectedItems:[],hideTopBorder:!1,tileEnabled:!1,"data-test":void 0},Xk=({intl:e,type:t,refundables:n,selectedItems:o,productsByProductId:r,tileEnabled:a,hideTopBorder:i,isFetching:l,"data-test":c})=>{const d=a?zp:Kp,u=()=>[...Array(25).keys()].map(f=>s.jsx(d,{"data-test":"fetching-skeleton"},`sk-${f}`)),m=f=>{const y=o?o.find(I=>I.itemId===f):null;return y?{itemId:y.itemId,selectedQuantity:y.selectedRefundables.length}:null},g=()=>s.jsx(h.Fragment,{children:n.map(f=>{const y=r[f.productId],I=m(f.itemId);return y?s.jsx(WWt,{intl:e,type:t,product:y,refundable:f,tileEnabled:a,selectedItemData:I},f.itemId):null})});return s.jsxs(no.Container,{hideTopBorder:i,"data-synthetics":"product-list","data-test":c,children:[l?u():s.jsx(h.Fragment,{children:g()}),s.jsx(no.Placeholder,{}),s.jsx(no.Placeholder,{}),s.jsx(no.Placeholder,{}),s.jsx(no.Placeholder,{}),s.jsx(no.Placeholder,{}),s.jsx(no.Placeholder,{}),s.jsx(no.Placeholder,{}),s.jsx(fN,{})]})};Xk.propTypes=qWt;Xk.defaultProps=KWt;const zWt=e=>({orderId:At(e)}),QWt=ot({batchAddToBasket:ca.createBatchAddToBasket(),batchRemoveFromBasket:ca.createBatchRemoveFromBasket()}),sne=Ct(Bt,ke(zWt,QWt))(Xk),XWt=({name:e,image:t,className:n})=>!e&&!t?null:s.jsx(ve,{condensed:!0,"data-test":"refund-item-info-card",className:n,children:s.jsxs(se,{align:"center",wrap:"nowrap",children:[s.jsx("picture",{children:s.jsx("img",{height:"30",width:"30",src:t.src,alt:""})}),s.jsx(P,{size:"l",className:"salt-d--inline-block salt-m-l--2",children:e})]})}),zG="refundRequestItemDetailsModal",ZWt=D("m.la.h"),JWt=e=>e.categoryDescription&&e.reasonDescription&&e.categoryDescription.trim().toLowerCase()===e.reasonDescription.trim().toLowerCase(),Ef=T(P)`
    word-break: break-word;
`,nne=()=>{const{formatMessage:e}=M(),t=ho(),n=$e(Ue(zG)),o=$e(Vo(zG)),r=$e(Kk),a=$e(Ts),i=$e(ZWt),l=()=>t(Z.closeModal()),c=o?.itemId&&r.find(g=>g.itemId===o.itemId),d=c&&a[c.productId],u=g=>{switch(g){case"REJECTED":return"error";case"APPROVED":return"success";default:return"warning"}},m=g=>{switch(g){case"REJECTED":return e("order.details.refund.request-items.details-modal.status.rejected");case"APPROVED":return e("order.details.refund.request-items.details-modal.status.approved");default:return e("order.details.refund.request-items.details-modal.status.pending")}};return!c||!d?null:s.jsxs(G,{isOpen:n,onRequestClose:l,"data-test":"refund-request-item-details-modal",children:[s.jsx(G.Header,{align:i?"left":"center",children:s.jsx(ne,{as:"h2",id:"refund-request-item-details-modal-header","data-test":"refund-request-item-details-modal-header",children:e("order.details.refund.request-items.details-modal.header")})}),s.jsx(G.Body,{children:s.jsxs(se,{gap:["md"],direction:"column",children:[s.jsx(XWt,{"data-test":"item-info",name:d.name,image:d.image}),s.jsxs("div",{children:[s.jsx(P,{"data-test":"quantity-label",asChild:!0,size:"l",bold:!0,className:"salt-m-b--1",children:s.jsx("h3",{children:e("order.details.refund.request-items.details-modal.quantity")})}),s.jsx(P,{"data-test":"quantity",children:c.requestedQuantity})]}),s.jsxs("div",{children:[s.jsx(P,{"data-test":"category-label",asChild:!0,size:"l",bold:!0,className:"salt-m-b--1",children:s.jsx("h3",{children:e("order.details.refund.request-items.details-modal.reason")})}),s.jsx(Ef,{"data-test":"category",children:c.refundReason.categoryDescription})]}),!JWt(c.refundReason)&&s.jsxs("div",{className:"salt-m-b--2",children:[s.jsx(P,{"data-test":"reason-label",asChild:!0,size:"l",bold:!0,className:"salt-m-b--1",children:s.jsx("h3",{children:e("order.details.refund.request-items.details-modal.sub-reason.label")})}),s.jsx(Ef,{"data-test":"reason",children:c.refundReason.reasonDescription})]}),c.refundReason.reasonNote&&s.jsxs("div",{children:[s.jsx(P,{"data-test":"category-label",asChild:!0,size:"l",bold:!0,className:"salt-m-b--1",children:s.jsx("h3",{children:e("refunds.item-selection-modal.optional-comment.header")})}),s.jsx(Ef,{"data-test":"reason-note",children:c.refundReason.reasonNote})]}),s.jsxs("div",{children:[s.jsx(P,{"data-test":"status-label",asChild:!0,size:"l",bold:!0,className:"salt-m-b--1",children:s.jsx("h3",{children:e("order.details.refund.request-items.details-modal.status.label")})}),s.jsx("div",{className:"salt-m-b--1",children:s.jsx(Ce,{"data-test":"status",showIcon:!1,text:m(c.status),intent:u(c.status)})}),c.rejectionReasonNote&&s.jsx(Ef,{"data-test":"rejection-reason-note",children:c.rejectionReasonNote})]})]})}),s.jsx(G.Footer,{children:s.jsx(b,{intent:"primary",onClick:l,fill:!0,children:s.jsx(b.Text,{children:e("order.details.refund.request-items.details-modal.confirm")})})})]})},eqt=({orderBillingAddress:e,isFetching:t})=>{const[n,o]=h.useState(!1),{formatMessage:r}=M(),a=r("invoice.billing.address.management.box.title");return s.jsxs(st,{expanded:n,onToggle:()=>o(!n),aria:{expandedLabel:a,collapsedLabel:a},"data-test":"readonly-invoice-collapsible-box",name:"invoice-collapsible-box",children:[s.jsxs(st.ControlSection,{children:[s.jsx(ne,{"data-test":"invoice-billing-address-title",as:"h2",children:a}),s.jsx(st.ToggleSwitch,{})]}),s.jsx(st.ContentExpanded,{children:t?s.jsx(Rs,{}):s.jsx(DL,{orderBillingAddress:e,isReadOnly:!0,editOrderMode:!1,billingAddressRef:null,className:"salt-m-t--4"})})]})},tqt=()=>{const{formatMessage:e}=M(),t=E(zX),n=ps({breakpoint:"lg-up"}),[o]=fe(["ord.def.col"]),[r,a]=h.useState(!0);return h.useEffect(()=>{o&&n&&a(!1)},[n,o]),t.length?s.jsx("div",{className:"salt-m-y--4",children:s.jsxs(st,{expanded:r,onToggle:()=>{a(!r)},aria:{expandedLabel:e("order.online.receipt.payment.title"),collapsedLabel:e("order.online.receipt.payment.title")},name:"order-payment-card-collapsible-box",children:[s.jsxs(st.ControlSection,{children:[s.jsx(ne,{as:"h2",children:e("order.online.receipt.payment.title")}),s.jsx(st.ToggleSwitch,{})]}),s.jsxs(st.ContentExpanded,{children:[s.jsx(IJ,{className:"salt-m-y--4"}),s.jsx(yJ,{className:"salt-m-y--4"})]})]})}):null},sqt=({orderId:e})=>{const t=F(),n=E(Ue("orderFiscalInvoiceForm")),o=E(ZI),r=E(ua),a=()=>{t(Z.closeModal())},i=new URL(o);return i.searchParams.set("orderId",e),i.searchParams.set("customerId",r),s.jsx(G,{"data-test":"order-fiscal-invoice-request-modal",isOpen:n,onRequestClose:a,aria:{labelledby:IT},maxWidth:"md",children:s.jsx(G.Body,{children:s.jsx("iframe",{title:"order-fiscal-invoice-request-iframe","data-test":"order-fiscal-invoice-request-iframe",src:i.href,height:"700px",width:"100%"})})})},one=({orderStatus:e,orderId:t})=>{const n=E(ZI),o=E(ua),r=()=>e==="DELIVERED",a=()=>s.jsxs(se,{align:"flex-start","data-test":"fiscal-invoice-informational-text",children:[s.jsx(me,{className:"salt-m-r--2",name:"info_default",height:20,width:20}),s.jsx(v,{id:"order.online.receipt.invoice.not.generated.yet"})]}),i=()=>{const l=new URL(n);return l.searchParams.set("orderId",t),l.searchParams.set("customerId",o),s.jsxs(h.Fragment,{children:[s.jsx(b,{asChild:!0,size:"m",intent:"secondary",fill:!0,"data-test":"request-fiscal-invoice-button",children:s.jsx(rt,{intent:"ghost",href:l.toString(),target:"_blank",children:s.jsx(b.Text,{children:s.jsx(v,{id:"order.online.receipt.invoice.request.button"})})})}),s.jsx(sqt,{orderId:t})]})};return s.jsx("div",{className:"salt-m-y--4",children:s.jsx(ve,{"data-test":"order-fiscal-invoice-card",condensed:!0,children:s.jsx("div",{className:"salt-p--2",children:r()?i():a()})})})},Zk=({order:{orderId:e},handleEditOrderButtonClick:t=()=>{}})=>{const n=F(),o=We(),r=YN(),a=E(dJ),i=E(u2),l=()=>{n(Z.openModal("editOrder",{orderId:e}))},c=()=>{n(U.analyticsEvent({type:js.EDIT_ORDER_BUTTON_CLICKED,orderId:e}));const g={event:"event",ecommType:"enhanced",eventCategory:"E-commerce",eventLabel:"edit-order-clicked",eventAction:"EditOrderButtonClicked",ecommerce:{transactionId:e}};J.sendEvent({GA:g,WA:null})},d=uJ(e),u=async()=>{c(),t(),a?d():(await n(di.getPendingOrders()),await n(ci.editOrder(e,o,{redirectToDetails:!1}))),r()},m=()=>{i?u():l()};return s.jsx(b,{intent:"primary",fill:!0,onClick:m,"data-test":"edit-order-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"order.edit"})})})},qm="PENDING",Km="ACCEPTED",zm="REJECTED",nqt=p.shape({retailPrice:Ye,itemPriceAfterPromos:Ye,finalPrice:Ye,depositsPrice:Ye,environmentalHandlingPrice:Ye,promoSavings:Ye,totalSavings:Ye,totalPrice:Ye,vouchersSavingsPrice:Ye,taxesTotals:p.shape({taxes:p.shape({components:p.arrayOf(p.shape({displayName:p.string,taxRate:p.string,taxAmount:Ye}))})})}),rne=p.shape({productId:p.string.isRequired,retailerProductId:p.string.isRequired,name:p.string.isRequired,type:p.string.isRequired,isInCurrentCatalog:p.bool.isRequired,image:p.shape({src:p.string.isRequired,title:p.string.isRequired}),status:p.oneOf([Km,zm,qm]),quantity:p.number.isRequired,prices:p.shape({retail:Ye,offered:Ye,pricePerItem:Ye,pricePerUnit:p.shape({value:Ye,unit:p.string}),grossOffered:Ye,netOffered:Ye}),packInfo:p.shape({packSizeDescription:p.string,weight:p.string,typicalWeight:p.string}),promotions:p.arrayOf(p.shape({id:p.string,name:p.string,presentationMode:p.string})),isAlcohol:p.bool.isRequired,sellerId:p.string}),Nu=p.shape({productId:p.string.isRequired,retailerProductId:p.string.isRequired,name:p.string.isRequired,type:p.string.isRequired,isInCurrentCatalog:p.bool.isRequired,image:p.shape({src:p.string.isRequired,title:p.string.isRequired}),quantity:p.number.isRequired,prices:p.shape({retail:Ye,offered:Ye,pricePerItem:Ye,pricePerUnit:p.shape({value:Ye,unit:p.string}),grossOffered:Ye,netOffered:Ye}),packInfo:p.shape({packSizeDescription:p.string,weight:p.string,typicalWeight:p.string}),promotions:p.arrayOf(p.shape({id:p.string,name:p.string,presentationMode:p.string})),substitutes:p.arrayOf(rne),isAlcohol:p.bool.isRequired,sellerId:p.string,expirationDate:p.string,storageType:p.string}),_a={LIST_TYPE_REGULAR:"regular",LIST_TYPE_MISSING:"missing",LIST_TYPE_RETURNED:"returned",LIST_TYPE_SUBSTITUTE:"substitute"},oqt=vo(["loyalty","loyear"]),rqt=vo(["loyalty","loyred"]),aqt=Dn(["sumsub","bt.spl"]),iqt=D("loy.waon"),lqt={actions:p.shape({sendAnalyticsEvent:p.func.isRequired}).isRequired,order:p.shape({lastUpdated:p.number,isFetching:p.bool,error:p.shape({statusCode:p.number}),order:Go}).isRequired,getLoyaltySpent:p.func.isRequired,getLoyaltyEarned:p.func.isRequired,loading:p.bool,paymentSummary:p.shape({bags:p.shape({quantity:p.number,price:Ye}),carrierBag:Ye,delivery:Ye,deliveryPromotions:p.arrayOf(p.shape({promoDescription:p.string,promoSaving:Ye,promoId:p.string})),depositsPrice:Ye,environmentalHandlingPrice:Ye,finalPrice:Ye,itemsRetailPrice:Ye,invoice:Ye,retailPrice:Ye,orderLevelPromotions:p.arrayOf(p.shape({saving:Ye.isRequired,description:p.string.isRequired,promoId:p.string.isRequired})),paymentInfo:p.shape({paymentMethod:p.string,fundingInstrumentId:p.string,isFundingInstrumentUpdatable:p.bool,nonSavedFundingInstrument:p.bool,emailAddress:p.string,paymentAmountSplitPerMethods:p.shape({paymentMethod:p.string,total:Ye}),cardType:p.string,lastFourDigits:p.string,expiryMonth:p.string,expiryYear:p.string}).isRequired,preparation:Ye,smallOrder:Ye,savings:Ye,taxComponents:p.arrayOf(p.shape({displayName:p.string.isRequired,taxRate:p.string.isRequired,taxAmount:Ye.isRequired})),totalPrice:Ye,appliedVouchers:p.arrayOf(p.shape({id:p.string.isRequired,savings:Ye})),vouchersSavingsPrice:Ye,itemPriceAfterPromos:Ye}).isRequired,sellers:p.arrayOf(p.shape({sellerId:p.string,sellerName:p.string,totalItems:p.number,orderTotals:nqt})),quantity:p.number.isRequired,rebookable:p.bool.isRequired,isExternal:p.bool.isRequired,isLoyaltyRedeemEnabled:p.bool.isRequired,isLoyaltyEarningEnabled:p.bool.isRequired,isLoyaltyPaymentEnabled:p.bool.isRequired,isSummarySubtotalEnabled:p.bool.isRequired,intl:p.any.isRequired,handleEditOrderButtonClick:p.func,isOrderMultiPaymentsEnabled:p.bool.isRequired},cqt={loading:!1,handleEditOrderButtonClick:()=>{}},Jk=e=>{const{actions:t,order:n,getLoyaltySpent:o,getLoyaltyEarned:r,loading:a,paymentSummary:i,sellers:l,quantity:c,rebookable:d,isExternal:u,isLoyaltyRedeemEnabled:m,isLoyaltyEarningEnabled:g,isSummarySubtotalEnabled:f,isLoyaltyPaymentEnabled:y,intl:I,handleEditOrderButtonClick:S,isOrderMultiPaymentsEnabled:C}=e,[_,A,x,R,O]=fe(["or.sg","pay.check.show","tx.nts","or.ph","ord.def.col"]),N=ze(),{formatMessage:k}=M(),{primarySellerId:j,primarySellerName:w}=n.order,{currentBreakpoint:L}=h.useContext(Pn),B=L==="xs",W=ps({breakpoint:"lg-up"}),[$,K]=h.useState(!B),{paymentInfo:Q}=i||{},{paymentAmountSplitPerMethods:X}=Q||{},re=Se=>(X.find(dt=>dt.paymentMethod===Se)||{}).total,ue=()=>(X||[]).some(Se=>Number(Se?.total?.amount)),te=Se=>{const dt=Se?Wn.SUMMARY_COMPONENT_COLLAPSED:Wn.SUMMARY_COMPONENT_EXPANDED,et=Se?"User collapsed the summary component":"User expanded the summary component";t.sendAnalyticsEvent({type:dt,description:et})},[ce]=E(mL)||[],de=E(QX);h.useEffect(()=>{L&&O&&W&&K(!1)},[W,O,L]);const ye=Se=>{te($),Se.preventDefault(),K(dt=>!dt)},Ae=()=>n.order&&n.order.status==="FUTURE"&&n.order.editStatus==="EDITABLE"?s.jsx("div",{className:"salt-p-t--4 salt-m-y--2",children:s.jsx(Zk,{order:n.order,handleEditOrderButtonClick:S})}):null,Je=(Se,dt)=>{const et=dt?`-${dt}`:"";return s.jsx(ae.Items,{"data-test":`summary-items${et}`,itemsRetailPrice:Se.itemPriceAfterPromos,quantity:Se.totalItems,withTaxNote:x})},Ie=(Se,dt)=>{const et=dt?`-${dt}`:"";return s.jsxs(h.Fragment,{children:[s.jsx(ae.Items,{"data-test":`summary-items${et}`,itemsRetailPrice:Se.itemsRetailPrice||Se.retailPrice,quantity:Se.totalItems,withTaxNote:x}),s.jsx(ae.Savings,{"data-test":`summary-savings${et}`,savings:Se.savings}),s.jsx(ae.SavingsWithPaymentMethod,{savings:Se.paymentMethodSavingsPrice}),f&&!!Number(Se.savings?.amount)&&!!Se.itemPriceAfterPromos&&Se.itemPriceAfterPromos?.amount!==Se.finalPrice?.amount&&s.jsx(ae.Subtotal,{"data-test":`summary-subtotal${et}`,value:Se.itemPriceAfterPromos})]})},je=()=>g&&n&&n.order&&n.order.loyalty&&n.order.loyalty.earned&&n.order.loyalty.earned.units>0,Le=()=>y&&n?.order?.loyalty?.spent?.units>0&&!C,Be=()=>{const Se=EL(l,w);return l?.length>0&&s.jsx(h.Fragment,{children:Se.map(dt=>he(dt,dt.sellerId===j))})},be=(Se,dt,et)=>({...et?{isPrimarySeller:!0,paymentInfo:i.paymentInfo,appliedVouchers:i.appliedVouchers,bags:i.bags}:{appliedVouchers:[],isPrimarySeller:!1},sellerName:Se.sellerName,totalItems:Se.totalItems,savings:Se.orderTotals?.promoSavings,itemsRetailPrice:Se.orderTotals?.retailPrice,depositsPrice:Se.orderTotals?.depositsPrice,environmentalHandlingPrice:Se.orderTotals?.environmentalHandlingPrice,finalPrice:Se.orderTotals?.finalPrice,totalPrice:Se.orderTotals?.totalPrice,retailPrice:Se.orderTotals?.retailPrice,vouchersSavingsPrice:Se.orderTotals?.vouchersSavingsPrice,taxComponents:Se.orderTotals?.taxesTotals?.taxes?.components,itemPriceAfterPromos:Se.orderTotals?.itemPriceAfterPromos,carrierBag:Se.charges?.carrierBag,delivery:Se.charges?.delivery,deliveryPromotions:Se.charges?.deliveryPromotions||[],invoice:Se.charges?.invoice,orderLevelPromotions:Se.orderLevelPromotions,preparation:Se.charges?.preparation,smallOrder:Se.charges?.smallOrder,loyalty:Se.loyalty,paymentMethodSavingsPrice:Se.orderTotals?.paymentMethodPromoSavings}),he=(Se,dt)=>{const et=Se.sellerName.toLowerCase().replaceAll("_","-"),we=be(Se,i,dt);return!Number(C?de:we.totalPrice?.amount)&&!we.totalItems?null:s.jsxs(h.Fragment,{children:[s.jsx(bi,{groupName:we.sellerName,className:"salt-d--block salt-m-y--2"}),Oe(we,dt,et)]})},ge=Se=>()=>Se.loyalty?.spent,Oe=(Se,dt,et)=>{const we=et?`-${et}`:"";return s.jsxs(h.Fragment,{children:[s.jsxs(pe,{"data-test":`summary-content-description-list${we}`,children:[R?Je(Se,et):Ie(Se,et),s.jsx(ae.Promotions,{orderLevelPromotions:Se.orderLevelPromotions,"data-test":`summary-promotions${we}`}),s.jsx(ae.Vouchers,{"data-test":`summary-vouchers${we}`,appliedVouchers:Se.appliedVouchers,vouchersSavingsPrice:Se.vouchersSavingsPrice}),s.jsx(ae.Delivery,{"data-test":`summary-delivery${we}`,delivery:Se.delivery,withTaxNote:x}),s.jsx(ae.DeliveryPromotions,{"data-test":`summary-delivery-pass${we}`,isDeliveryPromotion:!!i?.deliveryPromotions?.[0]?.promoId,hideDeliveryPassInfo:!dt,deliveryPromotions:Se.deliveryPromotions}),s.jsx(ae.BagCharge,{"data-test":`summary-bag-charge${we}`,carrierBag:Se.carrierBag,withTaxNote:x}),s.jsx(ae.PreparationCost,{"data-test":`summary-preparation-cost${we}`,preparationCost:Se.preparation,withTaxNote:x}),s.jsx(ae.Invoice,{"data-test":`summary-invoice${we}`,invoice:Se.invoice,withTaxNote:x}),s.jsx(ae.EnvironmentalHandlingCharge,{"data-test":`summary-environmental-handling-charge${we}`,environmentalHandlingPrice:Se.environmentalHandlingPrice,withTaxNote:x}),Se.bags&&s.jsx(ae.Separator,{}),s.jsx(ae.BuyBacks,{bags:Se.bags,"data-test":`summary-buy-backs${we}`}),s.jsx(ae.Loyalty,{"data-test":`summary-loyalty${we}`,isLoyaltyRedeemEnabled:m,getLoyaltySpent:_?ge(Se):o}),s.jsx(ae.Deposit,{"data-test":`summary-deposit${we}`,depositsPrice:Se.depositsPrice,withTaxNote:x}),s.jsx(ae.SmallOrderCharge,{smallOrderPrice:Se.smallOrder,orderId:n.order.orderId,thresholds:Se.smallOrderChargeThresholds,withTaxNote:x,page:"order-details"})]}),s.jsxs(h.Fragment,{children:[s.jsx(ae.Taxes,{"data-test":`summary-taxes${we}`,finalPrice:Se.finalPrice,components:Se.taxComponents,withTaxNote:x}),dt&&A&&ue()&&s.jsxs(h.Fragment,{children:[s.jsx(ae.Separator,{}),s.jsx("div",{className:"salt-m-t--2",children:s.jsx(pe,{"data-test":`summary-payment-list${we}`,children:s.jsx(ae.PaymentChecks,{"data-test":`summary-payment-checks${we}`,paidByCheck:re("PAYMENT_CHECK"),paidByCard:re("CARDS"),paidByInvoice:re("INVOICE")})})})]})]}),Le()&&s.jsx(ae.WaonPoints,{withTaxNote:x,getLoyaltySpent:_?ge(Se):o,finalPrice:Se.finalPrice}),s.jsx(ae.Separator,{})]})},Xe=C?de:i.totalPrice;return s.jsxs(gs,{expanded:$,onToggle:ye,breakpoint:"sm-up",aria:{contentLabel:I.formatMessage("order.details.summary.title"),totalPrice:Xe&&N(Xe)},children:[s.jsxs(gs.ControlSection,{children:[$?s.jsx(ne,{as:"h2",children:k("order.details.summary.title")}):s.jsx(ae.TotalInline,{loading:!i,totalPrice:Xe,"data-test":"summary-control-section-total",withTaxNote:x}),s.jsx(gs.ToggleSwitch,{})]}),s.jsxs(gs.Content,{children:[!u&&(_&&j&&w?Be():Oe({...i,totalItems:c},!0)),s.jsx(ae.TotalSpaceBetween,{loading:!i,totalPrice:C?de:i.totalPrice,withTaxNote:x}),C&&ce&&s.jsx(pe,{children:s.jsx(jP,{amount:ce.total?.amount,currency:ce.total?.currency})})]}),je()&&s.jsx("div",{className:"salt-p-t--2","data-test":"loyalty-earnings-summary",children:s.jsx(Hd,{getQuantity:r,allowZero:!0})}),s.jsx(ae.Buttons,{loading:a,children:Ae()}),s.jsx(ae.RebookableDisclaimer,{rebookable:d})]})},dqt=e=>({order:Ds(e),getLoyaltySpent:UD,getLoyaltyEarned:id,paymentSummary:ac(e),sellers:cC(e),quantity:BD(e),rebookable:GD(e),isExternal:Ag(e),isLoyaltyRedeemEnabled:rqt(e),isLoyaltyEarningEnabled:oqt(e),isSummarySubtotalEnabled:aqt(e),isLoyaltyPaymentEnabled:iqt(e)}),uqt=ot({sendAnalyticsEvent:U.analyticsEvent});Jk.propTypes=lqt;Jk.defaultProps=cqt;const pqt=Ct(Bt,ke(dqt,uqt))(Jk),QG=({isExpanded:e=!1})=>{const{order:t}=E(Ds),[n,o]=h.useState(e),{formatMessage:r}=M(),a=ze(),i=E(D("loy.waon"));if(!t?.paymentInfo)return null;const{paymentInfo:l,loyalty:c}=t,d=()=>i&&c&&c?.spent?.units>0,u=()=>s.jsx(ve,{className:"salt-d--flex",children:s.jsx(Qd,{paymentInfo:l})}),m=()=>s.jsx(ve,{"data-test":"order-payment-waon-points-box",children:s.jsx(P,{className:"salt-d--flex",asChild:!0,"data-test":"order-payment-waon-points-label",children:s.jsx("strong",{children:`${r("summary.loyalty.units.name")}${` (${c&&a(c.spent?.money)})`}`})})});return s.jsx("div",{className:"salt-m-y--4",children:s.jsxs(st,{expanded:n,onToggle:()=>{o(!n)},aria:{expandedLabel:r("order.online.receipt.payment.title"),collapsedLabel:r("order.online.receipt.payment.title")},name:"order-payment-card-collapsible-box",children:[s.jsxs(st.ControlSection,{children:[s.jsx(ne,{as:"span",children:r("order.online.receipt.payment.title")}),s.jsx(st.ToggleSwitch,{})]}),d()&&s.jsx(st.ContentExpanded,{children:s.jsx("div",{className:"salt-p-t--4",children:m()})}),s.jsx(st.ContentExpanded,{children:s.jsx("div",{className:"salt-p-t--4",children:u()})})]})})},mqt={order:Go.isRequired},ane=({order:e})=>{const[t]=fe(["onre"]),n=C0(e.orderId),o=()=>t?"order.online.receipt.download.receipt.button":"order.details.receipt";return s.jsx(b,{intent:"secondary",fill:!0,"data-test":"order-receipt-button",asChild:!0,children:s.jsxs(rt,{href:n,target:"_blank",standalone:!0,bold:!0,children:[s.jsx(b.Icon,{name:"pdf","data-test":"icon__pdf"}),s.jsx(b.Text,{children:s.jsx(_t,{id:o()})})]})})};ane.propTypes=mqt;const hqt={order:p.shape({orderId:p.string}).isRequired,actions:p.shape({openCancelChangesModal:p.func.isRequired}).isRequired},ine=({order:e,actions:t})=>{const{orderId:n}=e;return s.jsxs(h.Fragment,{children:[s.jsx(b,{intent:"secondary",fill:!0,onClick:()=>t.openCancelChangesModal(n),"data-test":"cancel-changes-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"order.undo.changes"})})}),s.jsx(WN,{orderId:n,page:"order-details"})]})},gqt=ot({openCancelChangesModal:e=>Z.openModal(`cancelChanges${e}`)});ine.propTypes=hqt;const Eqt=ke(null,gqt)(ine),fqt={order:p.shape({orderId:p.string}).isRequired},py=({order:{orderId:e}})=>{const t=F(),n=()=>{t(Z.openModal(`cancelOrder${e}`))};return s.jsxs(h.Fragment,{children:[s.jsx(b,{intent:"secondary",fill:!0,onClick:n,"data-test":"cancel-order-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"order.cancel"})})}),s.jsx(qN,{orderId:e,page:"order-details"})]})};py.propTypes=fqt;const ff={UNDER_EDIT:{buttons:[{key:1,component:Eqt},{key:2,component:py}]},EDITABLE:{buttons:[{key:3,component:py}]},OTHER_UNDER_EDIT:{buttons:[{key:4,component:py}]},EDIT_EXPIRED:{buttons:[]},PENDING_PAYMENT:{buttons:[]},DELIVERED:{buttons:[]},PICKED:{buttons:[]},CANCELLED:{buttons:[]},SCRATCHED:{buttons:[]},DEFAULT:{buttons:[]},DELIVERED_WITH_RECEIPT:{buttons:[{key:5,component:ane}]}},yqt=e=>{const{status:t,editStatus:n,hasReceipt:o}=e;let r;return t==="FUTURE"?r=ff[n]:o&&t==="DELIVERED"?r=ff.DELIVERED_WITH_RECEIPT:r=ff[t],r||ff.DEFAULT},lne=({loading:e=!1})=>{const t=E(Ds);if(!t.order||!t.order.status||!t.order.editStatus)return null;const n=yqt(t.order);if(!n)return null;if(e)return s.jsx(b,{intent:"action",fill:!0,loading:!0,children:s.jsx(b.Text,{children:e})});let o=[];return n.buttons.length&&(o=n.buttons.map((r,a)=>{const i=r.component;return s.jsxs(h.Fragment,{children:[s.jsx(i,{order:t.order}),a<n.buttons.length-1&&s.jsx("div",{className:"salt-m-y--4"})]},r.key)})),o.length?s.jsx(ve,{className:"salt-m-y--4",children:o}):null};function Bv(e){return!!e.length&&e.length<13}function Iqt(e,t,n,o){const r=Zr(e),a=Zr(),i=r.isSame(a,"day"),l=Zr().add(7,"days").startOf("day"),c=!r.isBefore(a,"day")&&r.isBefore(l,"day"),d=r.isBefore(a,"day"),u={text:"",accessibilityText:""};return i&&(u.text=t("use.by.date.text.today"),u.accessibilityText=t("a11y.use.by.date.text.today")),!Bv(u.text)&&c&&(u.text=t("use.by.date.text.weekday",{shortDay:r.format(n)}),u.accessibilityText=t("a11y.use.by.date.text.weekday",{weekday:r.format(Ma)})),Bv(u.text)||(u.text=t("use.by.date.short.text.expiration.date",{date:r.format(o)}),u.accessibilityText=t("a11y.use.by.date.expiration.date",{date:r.format(Jv)})),d&&(u.text=t("use.by.date.text.expired"),u.accessibilityText=t("a11y.use.by.date.text.expired")),Bv(u.text)||(u.text=r.format(o),u.accessibilityText=t("a11y.use.by.date.text",{date:r.format(Jv)})),u}const Sqt=({expirationDate:e})=>{const{formatMessage:t}=M(),n=E(gae),o=E(hae);if(!e||!Zr(e,Zr.ISO_8601,!0).isValid())return null;const r=Iqt(e,t,n,o);return r.text.length?s.jsx(Fn,{intent:"tertiary-contrast",singleLine:!0,text:r.text,accessibilityText:r.accessibilityText,"data-test":"order-receipt-list-element-card-use-by-date-badge"}):null},Cqt=({productIndex:e,product:t})=>{const n=F(),o=E(qs),r=E(l=>t?.productId?sl(l,t.productId):null),a=()=>{z.info("fop.not.in.current.catalog")},i=()=>{if(t&&r){const l=r.price,{productId:c,retailerProductId:d,name:u,prices:m}=t,g={currency:m.offered?.currency||"",amount:m.offered?.amount||""},f={current:g,unit:{current:g,label:l?.unit?.label||""}},y=e+1;n(sp.productClickGAEvent({productName:u,productId:d,productPrice:g.amount,productListName:"order-details: other",productPosition:y,currencyCode:g.currency}));const I={eventLabel:d,ecommType:"enhanced",eventCategory:"E-commerce",eventAction:"product_click",event:"productClick",ecommerce:{currencyCode:g.currency,click:{actionField:{list:"order-details: other"},products:[{name:u,id:d,price:g.amount,position:y}]}}};J.sendEvent({GA:I,WA:null});const S={...r,price:f},C=Bn(S,o);n(sp.productClickGa4Event({product:S,position:y,productListName:"order-details: other",page:"order-details"}));const _={event:"select_item",ecommerce:{currency:g.currency,items:[ag({product:S,position:y,productListName:"order-details: other",page:"order-details",featuredProductCampaign:C})]}};J.sendEvent({GA:_,WA:null}),n(Ja.setActiveBop(c))}};return h.useCallback(()=>{if(t&&!t.isInCurrentCatalog){a();return}i()},[t])},Tqt=T(ne).attrs({size:"s",forwardedAs:"span"})`
    color: ${({promotional:e,presentationMode:t})=>e&&t!=="MUTE_STYLE"?"var(--typography-promotion, var(--intent-promotion))":"black"};
`,_qt=({shouldShowProductNetGrossPrices:e,shouldHideOnlineReceiptPromotions:t,isItemNotDelivered:n,isProductDiscounted:o,promotions:r,prices:a,formatPrice:i})=>{const{formatMessage:l}=M(),c=Number(a?.retail?.amount)===0&&Number(a?.offered?.amount)===0&&r.length>0,d=!t&&(o||c),u=()=>r?.length>0&&!r.some(f=>f.presentationMode!=="MUTE_STYLE")?"MUTE_STYLE":"DEFAULT",m=()=>a?l(o&&!t?"order.online.receipt.accessibility.item.price.discounted":"order.online.receipt.accessibility.item.price"):"",g=()=>a?i(e?a.netOffered:n?a.retail:a.offered):"";return s.jsxs(h.Fragment,{children:[s.jsx(Ee,{children:m()}),s.jsx(Tqt,{"data-test":"receipt-element-total-product-price",promotional:d,presentationMode:u(),children:g()})]})},vqt=T.s`
    font-size: var(--salt-text-m-font-size);
    font-weight: 400;
    margin-inline-start: var(--salt-spacing-1);
    line-height: 1em;
`,Aqt=({shouldShowProductNetGrossPrices:e,shouldHideOnlineReceiptPromotions:t,isProductDiscounted:n,prices:o,formatPrice:r})=>{const{formatMessage:a}=M(),i=r(o?.grossOffered);return e?s.jsxs(h.Fragment,{children:[s.jsx(Ee,{children:a("order.details.product.gross.price.accessibility.label",{price:i})}),s.jsx(P,{"data-test":"receipt-element-original-total-product-price",className:"salt-m-l--1",children:a("order.details.product.gross.price",{price:i})})]}):s.jsx(h.Fragment,{children:!t&&o&&n&&s.jsxs(h.Fragment,{children:[s.jsx(Ee,{children:a("order.online.receipt.accessibility.item.price.original")}),s.jsx(vqt,{"data-test":"receipt-element-original-total-product-price",children:r(o.retail)})]})})},bqt=T.div`
    display: flex;
    flex-grow: 1;
    flex-direction: column;
    align-items: flex-end;
    justify-content: flex-end;
`,xqt=T.div`
    display: flex;
    block-size: 100%;
    flex-direction: column;
    flex-grow: 1;
`,Rqt=({isItemNotDelivered:e,product:t})=>{const[n]=fe(["or.ph"]),o=ze(),{prices:r,promotions:a}=t,i=!!(r?.grossOffered&&r?.netOffered),l=d=>d?o(d):"",c=!!(r?.retail&&r?.offered&&r.retail.amount!==r.offered.amount&&!e);return s.jsx(xqt,{children:s.jsxs(bqt,{children:[s.jsx(Aqt,{shouldShowProductNetGrossPrices:i,shouldHideOnlineReceiptPromotions:!!n,isProductDiscounted:c,prices:r,formatPrice:l}),s.jsx(_qt,{shouldShowProductNetGrossPrices:i,shouldHideOnlineReceiptPromotions:!!n,isItemNotDelivered:e,isProductDiscounted:c,promotions:a,prices:r,formatPrice:l})]})})},Yh="regular",Qm="missing",Xm="returned",Zm="substituted",jI="substitute",wI="substitute-accepted",Jm="substitute-rejected",Dqt={itemType:p.oneOf([Yh,Qm,Xm,Zm,jI,wI,Jm]),product:p.oneOfType([Nu,rne]).isRequired,catchWeightSubtextPosition:p.string,messages:p.shape({catchWeight:p.string}),headingLevelOverride:p.oneOf(["h3","h4","h5"]),productIndex:p.number},Oqt={itemType:Yh,catchWeightSubtextPosition:"post",messages:{},headingLevelOverride:null},Pqt=T.div`
    display: flex;
    inline-size: 100%;
    flex-direction: column;
    margin-block-end: var(--salt-spacing-2);
`,Nqt=T.div`
    inline-size: 100%;
    margin-block: var(--salt-spacing-2) var(--salt-spacing-1);
`,Lqt=T.div`
    display: flex;
    inline-size: 100%;
    min-block-size: ${H(94)};
    flex-direction: row;
`,kqt=T.img`
    block-size: ${H(94)};
    inline-size: ${H(94)};
    align-self: center;
`,Mqt=T.div`
    display: flex;
    max-block-size: 100%;
    inline-size: ${H(94)};
    margin-inline-end: var(--salt-spacing-2);
    flex: 0 0 auto;
    align-items: flex-end;
`,jqt=T.div`
    display: flex;
    max-block-size: 100%;
    flex: 1 1 auto;
    flex-direction: column;
    align-items: flex-start;
`,wqt=T.div`
    display: flex;
    inline-size: 100%;
    margin-inline-end: var(--salt-spacing-2);
    flex: 1 0 auto;
    flex-direction: column;
    align-items: flex-start;
`,Fqt=T.div`
    display: flex;
    inline-size: 100%;
    margin-inline-end: var(--salt-spacing-2);
    flex: 1 1 auto;
    flex-direction: row;
    align-items: flex-start;
    color: var(--salt-text-color);
`,Bqt=T.div`
    display: flex;
    flex-grow: 1;
    flex-direction: column;
    align-items: flex-start;
    justify-content: flex-end;
`,Uqt=T.div`
    display: flex;
    block-size: 100%;
    flex-direction: column;
`,Gqt=T.div`
    display: flex;
    flex-direction: row;
    flex: 0 0 auto;
    margin-block-start: var(--salt-spacing-2);
`,$qt=T(P)`
    font-size: var(--salt-text-m-font-size);
    font-weight: 400;
    display: flex;
    flex: 0 0 auto;
    cursor: pointer;
    text-decoration: unset;

    &:hover {
        text-decoration: underline;
    }
`,Hqt=T.div`
    display: flex;
    align-items: flex-start;
    flex-direction: column;
    flex: 1 0 auto;
    margin-block-start: var(--salt-spacing-1);
`,Vqt=T.div`
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    color: ${({presentationMode:e})=>e==="MUTE_STYLE"?"black":"var(--typography-promotion, var(--intent-promotion))"};
    overflow: hidden;
`,Yqt=T(P)`
    font-size: var(--salt-text-m-font-size);
    font-weight: 400;
`,Wqt=T.div`
    display: flex;
    flex-direction: row;
    color: ${({presentationMode:e})=>e==="MUTE_STYLE"?"black":"var(--typography-promotion, var(--intent-promotion))"};
`,Uv=T(P)`
    color: ${({theme:e,branded:t})=>t?"var(--intent-primary)":"currentColor"};
    margin-inline-end: var(--salt-spacing-1);
    font-size: var(--salt-text-s-font-size);
`,XG=T.span`
    margin-inline: ${({post:e})=>e&&"var(--salt-spacing-1)"}
        ${({pre:e})=>e&&"var(--salt-spacing-1)"};
`,qqt=T.div`
    display: flex;
    flex-direction: row;
    flex: 0 0 auto;
`,Kqt=T(P)`
    font-weight: 400;
    font-size: var(--salt-text-m-font-size);
`,zqt=T(zs)`
    z-index: 1;
    min-block-size: ${H(20)};
    overflow: hidden;

    &:empty {
        display: none;
    }

    position: absolute;
`,kn=({itemType:e,product:t,catchWeightSubtextPosition:n,messages:o,headingLevelOverride:r,productIndex:a})=>{const i=M(),l=ze(),[c,d]=fe(["seo.rdbl","or.ph"]),u=E(D("ubd")),m=E(q$e(t.productId)),g=Cqt({product:t,productIndex:a}),f=$=>$?l($):"",y=()=>{const K=(Q=>{switch(Q){case Qm:return{type:"error",message:"order.online.receipt.list.element.status.missing"};case Xm:return{type:"success",message:"order.online.receipt.list.element.status.returned"};case Zm:return{type:"error",message:"order.online.receipt.list.element.status.missing"};case jI:return{type:"success",message:"order.online.receipt.list.element.status.substitute"};case wI:return{type:"success",message:"order.online.receipt.list.element.status.substitute.accepted"};case Jm:return{type:"error",message:"order.online.receipt.list.element.status.substitute.rejected"};default:return{type:"info",message:""}}})(e);return s.jsx(Ce,{intent:K.type,size:"s","data-test":"receipt-element-alert","data-test-type":K.type,"aria-hidden":!0,text:s.jsx(v,{id:K.message,values:{quantity:t.quantity}})})},I=()=>e===Qm||e===Zm||e===Xm||e===Jm,S=()=>s.jsxs(h.Fragment,{children:[s.jsx(Uqt,{children:C()}),s.jsx(Rqt,{isItemNotDelivered:I(),product:t})]}),C=()=>s.jsxs(Bqt,{children:[s.jsx(Gqt,{children:x()}),s.jsx(qqt,{children:!d&&t.prices&&t.prices.pricePerItem&&t.type!=="CATCHWEIGHT"?s.jsx(Kqt,{"data-test":"receipt-element-price-per-item-text",children:s.jsx(v,{id:"order.online.receipt.price.per.item",values:{price:f(t.prices.pricePerItem)}})}):null})]}),_=()=>{const $=t&&t.packInfo&&t.packInfo.typicalWeight&&o&&o.catchWeight;return t.packInfo.weight?s.jsx(h.Fragment,{children:t.packInfo.weight}):s.jsxs(h.Fragment,{children:[$&&n==="pre"&&s.jsx(XG,{pre:!0,children:$}),t.packInfo.typicalWeight,$&&n!=="pre"&&s.jsx(XG,{post:!0,children:$})]})},A=()=>{const $=i.formatMessage(m.label,{price:f(m.current)});return $?` (${$})`:""},x=()=>t.packInfo&&(t.packInfo.weight||t.packInfo.typicalWeight)?t.type==="CATCHWEIGHT"?s.jsxs(Uv,{className:"salt-d--inline-block","data-test":"receipt-element-product-size-details",children:[_(),m&&A()]}):s.jsx(h.Fragment,{children:t.packInfo.packSizeDescription&&s.jsx(Uv,{className:"salt-d--inline-block","data-test":"receipt-element-product-size-details",children:t.packInfo.packSizeDescription})}):s.jsxs(Uv,{className:"salt-d--inline-block","data-test":"receipt-element-product-size-details",children:[t?.size?.value,m&&A()]}),R=()=>t&&t.isInCurrentCatalog,O=()=>t&&t.isInCurrentCatalog?vi(t.retailerProductId,Gp(t.name,{isSEOReadableURLEnabled:c})):null,N=()=>{switch(e){case Yh:return i.formatMessage("order.online.receipt.accessibility.item.title",{productName:t.name,productQuantity:t.quantity});case Xm:return i.formatMessage("order.online.receipt.accessibility.item.returned.title",{productName:t.name,productQuantity:t.quantity});case Qm:return i.formatMessage("order.online.receipt.accessibility.item.missing.title",{productName:t.name,productQuantity:t.quantity});case Zm:return i.formatMessage("order.online.receipt.accessibility.item.missing.title",{productName:t.name,productQuantity:t.quantity});case jI:return i.formatMessage("order.online.receipt.accessibility.item.substitute.title",{productName:t.name,productQuantity:t.quantity});case wI:return i.formatMessage("order.online.receipt.accessibility.item.substitute.accepted.title",{productName:t.name,productQuantity:t.quantity});case Jm:return i.formatMessage("order.online.receipt.accessibility.item.substitute.rejected.title",{productName:t.name,productQuantity:t.quantity});default:return i.formatMessage("order.online.receipt.accessibility.item.title",{productName:t.name,productQuantity:t.quantity})}},k=r||"h3",j=()=>s.jsx(Hqt,{children:s.jsx(h.Fragment,{children:s.jsx(Vqt,{"data-test":"receipt-element-promotions-box",children:t.promotions.map(($,K)=>s.jsxs(Wqt,{"data-test":`receipt-element-promotion-line-${K}-${$.presentationMode}`,presentationMode:$.presentationMode,children:[s.jsx(Ee,{children:i.formatMessage("order.online.receipt.accessibility.item.promotion.title")}),s.jsx(Yqt,{intent:"promotion",children:$.name})]},`${$&&$.id||K}-promotion`))})})}),w=()=>s.jsxs(h.Fragment,{children:[s.jsx(P,{asChild:!0,children:s.jsx(k,{children:s.jsxs($qt,{"data-test":"receipt-element-product-name",children:[t.quantity,"x ",t.name]})})}),!d&&t.promotions?j():null]}),L=()=>s.jsxs(Lqt,{children:[s.jsxs(Mqt,{children:[t.image?s.jsx(kqt,{src:t.image.src,alt:t.image.title||t.name,title:t.image.title,"data-test":"receipt-element-product-image","aria-label":N()}):null,u&&s.jsx(zqt,{wrap:"nowrap",align:"center",gap:["xs"],direction:"column",children:s.jsx(Sqt,{expirationDate:t.expirationDate})})]}),s.jsxs(jqt,{"aria-hidden":!0,children:[s.jsx(wqt,{children:w()}),s.jsx(Fqt,{children:S()})]})]}),B=()=>s.jsx(ve,{condensed:!0,className:"salt-p-l--1",children:s.jsx(pc,{isActive:t.isAlcohol,overlay:s.jsx(Yd,{buttonWidth:120}),children:L()})}),W=()=>s.jsxs(Pqt,{"data-test":`receipt-element-product-wrapper:${t.productId}`,children:[e&&e!==Yh?s.jsx(Nqt,{"aria-hidden":!0,children:y()}):null,R()?s.jsx(Qe,{intent:"ghost",to:O(),"data-test":"receipt-element-product-link",onClick:g,children:B()}):B()]});return s.jsx(h.Fragment,{children:t?W():null})};kn.propTypes=Dqt;kn.defaultProps=Oqt;kn.ITEM_TYPE_REGULAR=Yh;kn.ITEM_TYPE_MISSING=Qm;kn.ITEM_TYPE_RETURNED=Xm;kn.ITEM_TYPE_SUBSTITUTED=Zm;kn.ITEM_TYPE_SUBSTITUTE=jI;kn.ITEM_TYPE_SUBSTITUTE_ACCEPTED=wI;kn.ITEM_TYPE_SUBSTITUTE_REJECTED=Jm;const FI=({listType:e=_a.LIST_TYPE_REGULAR,products:t,catchWeightSubtextPosition:n="post",elementsHeadingLevelOverride:o=null})=>{const r=M(),a=E(D("ubd")),i=e===_a.LIST_TYPE_SUBSTITUTE,l=u=>u?{catchWeight:r.formatMessage("fop.catchweight.unit")}:{},c=(u,m)=>{const g=y=>{switch(y){case qm:return kn.ITEM_TYPE_SUBSTITUTE;case Km:return kn.ITEM_TYPE_SUBSTITUTE_ACCEPTED;case zm:return kn.ITEM_TYPE_SUBSTITUTE_REJECTED;default:return kn.ITEM_TYPE_SUBSTITUTE}},f=(y,I)=>{switch(y){case _a.LIST_TYPE_REGULAR:return kn.ITEM_TYPE_REGULAR;case _a.LIST_TYPE_MISSING:return kn.ITEM_TYPE_MISSING;case _a.LIST_TYPE_RETURNED:return kn.ITEM_TYPE_RETURNED;case _a.LIST_TYPE_SUBSTITUTE:return"substitutes"in I?kn.ITEM_TYPE_SUBSTITUTED:g(I.status);default:return kn.ITEM_TYPE_REGULAR}};return s.jsx(kn,{product:u,catchWeightSubtextPosition:n,messages:l(u),itemType:f(e,u),headingLevelOverride:o,productIndex:m})},d=a?nU(t):t;return s.jsx("div",{"data-test":"receipt-list-box",children:d?.map((u,m)=>c(u,m))})},Qqt={substitutions:p.arrayOf(Nu).isRequired,elementsHeadingLevelOverride:p.oneOf(["h4","h5"])},Xqt={elementsHeadingLevelOverride:null},BI=({substitutions:e,elementsHeadingLevelOverride:t})=>{const n=M(),o=()=>{switch(t){case"h3":return"h4";case"h4":return"h5";case"h5":return"h6";default:return"h4"}},r=(a,i)=>{const l=d=>{switch(d){case qm:return n.formatMessage("order.online.receipt.list.substitution.heading.substitute");case Km:return n.formatMessage("order.online.receipt.list.substitution.heading.substitute.accepted");case zm:return n.formatMessage("order.online.receipt.list.substitution.heading.substitute.rejected");default:return null}},c=t||"h3";return s.jsxs(h.Fragment,{children:[s.jsx(Ee,{asChild:!0,children:s.jsx(c,{children:l(i)})}),s.jsx(FI,{products:a,listType:_a.LIST_TYPE_SUBSTITUTE,elementsHeadingLevelOverride:o()})]})};return s.jsx("div",{"data-test":"receipt-substitutions-list-wrapper",children:e.map((a,i)=>{const l={status:qm,list:a.substitutes.filter(u=>qm===u.status)},c={status:Km,list:a.substitutes.filter(u=>Km===u.status)},d={status:zm,list:a.substitutes.filter(u=>zm===u.status)};return s.jsxs("div",{children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h3",{children:n.formatMessage("order.online.receipt.list.substitution.heading.substituted")})}),s.jsx(FI,{products:[a],listType:_a.LIST_TYPE_SUBSTITUTE,elementsHeadingLevelOverride:"h4"}),[l,c,d].map(u=>u.list.length>0?r(u.list,u.status):null),i!==e.length-1?s.jsx("div",{className:"salt-m-y--4",children:s.jsx(Zn,{})}):null]},`${a&&a.productId||i}-substitution`)})})};BI.propTypes=Qqt;BI.defaultProps=Xqt;const Zqt="HH:mm",cne=({className:e,order:t,timeFormat:n,isDeliveryWindowEnabled:o,isPlannedDeliveryWindowEnabled:r})=>{const a=Sse(t,n,o,r);return a&&a.text?s.jsx(Ce,{className:e,intent:a.type,text:a.text(),showIcon:!1}):null},xb=({orderId:e,carrierDetails:t,delivery:n,isExpanded:o})=>{const r=E(D("daddi")),[a,i]=h.useState(o),{externalAddress:l}=n||{},{name:c,iconUrl:d,iconDescription:u}=t,m=l?s.jsx(mZ,{externalAddress:l}):s.jsx(xT,{delivery:n});return s.jsx("div",{className:"salt-m-t--sm salt-p-m--sm",children:s.jsxs(st,{expanded:a,onToggle:()=>{i(!a)},aria:{expandedLabel:c,collapsedLabel:c},"data-test":"order-delivery-card",name:"order-delivery-card-collapsible-box",children:[s.jsxs(st.ControlSection,{children:[s.jsxs(se,{align:"center",wrap:"nowrap",as:"span",className:"salt-m-b--2",children:[s.jsx(Vd,{className:"salt-m-r--2",src:d,alt:c!==u?u:void 0,height:24,width:24}),s.jsx(ne,{as:P,children:c})]}),s.jsx(st.ToggleSwitch,{})]}),s.jsxs(st.ContentExpanded,{children:[s.jsxs(se,{direction:"column",className:"salt-m-b--2",gap:["sm"],children:[s.jsx(P,{size:"l",bold:!0,children:s.jsx(eE,{dates:{deliveryStartDate:n?.deliveryStartDate,deliveryEndDate:n?.deliveryEndDate,deliveryTimeInMinutes:n?.deliveryTimeInMinutes,collectionTimeInMinutes:n?.collectionTimeInMinutes,timeZoneId:n?.timeZoneId},carrierType:t.slotBookingComponent})}),m]}),r?s.jsx(cE,{orderId:e}):s.jsx(yL,{delivery:n})]})]})})},Jqt=()=>s.jsx(Pe,{"data-test":"order-delivery-card-placeholder",height:"18px",className:"salt-m-y--8"});xb.Skeleton=Jqt;const eKt=e=>({start:e.dates.deliveryStartDate,end:e.dates.deliveryEndDate,timeZoneId:e.dates.timeZoneId,nickname:e.addressNickName,formattedAddress:e.address,externalAddress:e.externalAddress,additionalInformation:e.additionalInformation,deliveryMethod:e.deliveryMethod,slotType:e.slotType,carrierId:e.carrierId,shippingGroupType:e.shippingGroupType,addressNotes:e.addressNotes}),ZG=({isExpanded:e=!1})=>{const[t,n]=h.useState(e),{order:o}=E(Ds),r=E(D("daddi")),a=E(D("del.win")),i=E(D("pln.win")),l=M(),c=E(Jt),d=E(Vt),{isReady:u,carrierDetails:m}=Jg({carrierId:o?.carrierId,shippingGroupType:o?.shippingGroupType});if(!o?.dates)return null;const g=eKt(o),f=g.deliveryMethod==="CUSTOMER_COLLECTION",y=g.deliveryMethod==="HOME_DELIVERY",I=g.slotType==="ON_DEMAND",S=g.slotType==="STANDARD",C=g.start.slice(0,10)!==g.end.slice(0,10),_=f&&S&&C,A=B=>`${B.nickname} - ${B.formattedAddress}`;if(!u)return s.jsx(xb.Skeleton,{});if(m)return s.jsx(xb,{isExpanded:e,orderId:o.orderId,carrierDetails:m,delivery:{deliveryStartDate:g.start,deliveryEndDate:g.end,externalAddress:g.externalAddress,addressNotes:g.addressNotes,address:g.formattedAddress,addressNickName:g.nickname,timeZoneId:g.timeZoneId}});const x=B=>s.jsx(go,{dateIsoFrom:B.start,dateIsoTo:B.end,timeZoneId:B.timeZoneId,local:!0,dateFormat:c,timeFormat:d}),R=B=>y&&I?o.status==="DELIVERED"||o.status==="CANCELLED"||o.status==="SCRATCHED"?x(B):null:x(B),O=B=>B.additionalInformation?s.jsxs("div",{className:"salt-m-t--2",children:[s.jsx(P,{asChild:!0,size:"l",bold:!0,children:s.jsx("h3",{children:s.jsx(v,{id:"order.online.receipt.slot.delivery.instructions.title"})})}),s.jsx("div",{className:"salt-m-t--1","data-test":"order-delivery-card-special-delivery-instructions",children:s.jsx(P,{children:B.additionalInformation})})]}):null,N=B=>B.additionalInformation?s.jsx(Ce,{intent:"warning",size:"s",text:`${l.formatMessage("checkout.delivery.collection.point.label")} ${B.additionalInformation}`,"data-test":"order-delivery-card-special-collection-instructions",className:"salt-p-t--2"}):null,k=()=>o.status==="DELIVERED"||o.status==="SCRATCHED"||o.status==="CANCELLED"?null:s.jsx(Ce,{intent:"info",size:"s",text:l.formatMessage("order.card.reserved.fast.delivery.alert"),"data-test":"order-fast-delivery-card-special-instructions",className:"salt-p-t--2 salt-m-t--2"}),j=B=>{const W=y&&I&&(!o?.deliveryInfo||o?.deliveryInfo?.currentState==="NOT_APPLICABLE");return f?N(B):r?s.jsxs(ie.Fragment,{children:[s.jsx(cE,{orderId:o.orderId}),W&&k()]}):s.jsxs(ie.Fragment,{children:[O(B),W&&k()]})},w=()=>s.jsx(v,{id:"express.collection.delivery.card.title"}),L=()=>f?s.jsx(v,{id:"order.online.receipt.slot.collection.title"}):y&&I?o.status==="DELIVERED"||o.status==="CANCELLED"||o.status==="SCRATCHED"?l.formatMessage("order.details.fast.delivery.title"):l.formatMessage("order.card.reserved.fast.delivery.title",{time:So(o.dates.deliveryEndDate,o.dates.timeZoneId,Zqt)}):s.jsx(v,{id:"order.online.receipt.slot.delivery.title"});return s.jsx("div",{className:"salt-m-y--4",children:s.jsxs(st,{expanded:t,onToggle:()=>{n(!t)},aria:{expandedLabel:l.formatMessage("order.online.receipt.slot.delivery.title"),collapsedLabel:l.formatMessage("order.online.receipt.slot.delivery.title")},"data-test":"order-delivery-card",name:"order-delivery-card-collapsible-box",children:[s.jsxs(st.ControlSection,{children:[s.jsx(ne,{"data-test":"delivery-type-title",as:"span",children:I&&!y||_?w():L()}),s.jsx(st.ToggleSwitch,{})]}),s.jsx(st.ContentExpanded,{children:s.jsxs("div",{className:"salt-p-t--4",children:[s.jsx(P,{size:"l",bold:!0,"data-test":"order-delivery-slot-info",children:R(g)}),s.jsx("div",{className:"salt-m-t--1",children:s.jsx(P,{"data-test":"order-delivery-address-info",children:A(g)})}),j(g),s.jsx(cne,{className:"salt-m-t--2",order:o,timeFormat:d,isDeliveryWindowEnabled:a,isPlannedDeliveryWindowEnabled:i})]})})]})})},tKt=e=>D("invoifram")(e)&&ZI(e),sKt=(e,t)=>{switch(e){case"PENDING_PAYMENT":return{type:"warning",message:"order.details.pending.payment"};case"FAILED_PENDING_PAYMENT":return{type:"error",message:"order.details.pending.payment.failed"};case"EDIT_EXPIRED":return{type:"info",message:t?"order.online.receipt.alert.after.cut.off":"order.online.receipt.alert.after.cut.off.pdf.receipt.disabled"};case"PICKED":return{type:"info",message:t?"order.online.receipt.alert.after.cut.off":"order.online.receipt.alert.after.cut.off.pdf.receipt.disabled"};default:return null}},nKt=D("mpv"),oKt={intl:p.any.isRequired,actions:p.shape({sendAnalyticsEvent:p.func.isRequired,openChangeStoreModal:p.func.isRequired,fetchCreatedRefundRequest:p.func.isRequired}).isRequired,orderId:p.string,order:p.shape({lastUpdated:p.number,isFetching:p.bool,error:p.shape({statusCode:p.number}),order:Go}).isRequired,groupedProducts:p.shape({products:p.arrayOf(Nu),missings:p.arrayOf(Nu),returns:p.arrayOf(Nu),substitutes:p.arrayOf(Nu)}),sellers:p.arrayOf(p.shape({sellerId:p.string,sellerName:p.string})),requestedForRefundItems:p.arrayOf(p.shape({})),productsByProductId:p.objectOf(ml).isRequired,loading:p.bool,locale:p.string.isRequired,isExternal:p.bool.isRequired,isInvoiceRequestFormEnabled:p.bool.isRequired,failedPaymentsData:p.shape({orderId:p.string}),isOrderMultiPaymentsEnabled:p.bool.isRequired},rKt={orderId:void 0,loading:!1,groupedProducts:{products:[],missings:[],returns:[],substitutes:[]},sellers:[],requestedForRefundItems:[],failedPaymentsData:null,isOrderMultiPaymentsEnabled:!1},eM=e=>{const{intl:t,actions:n,orderId:o,order:r,groupedProducts:a,sellers:i,requestedForRefundItems:l,productsByProductId:c,locale:d,isExternal:u,isInvoiceRequestFormEnabled:m,failedPaymentsData:g,isOrderMultiPaymentsEnabled:f}=e,[y,I,S,C,_]=fe(["or.sg","slfsrv.refunds","rec.o","ord.pdf","bam"]);h.useEffect(()=>{I&&!u&&n.fetchCreatedRefundRequest(o,d)},[]);const[A,x]=h.useState(!1),R=()=>{x(!0)},O=()=>{const Ie=["EDITABLE","EDIT_EXPIRED","PENDING_PAYMENT"].filter(Be=>Be===r.order.editStatus).length>0?r.order.editStatus:null,je=g?"FAILED_PENDING_PAYMENT":Ie||r.order.status,Le=sKt(je,!!C);return Le?s.jsx(Ce,{className:"salt-m-t--2 salt-m-b--2 md:salt-m-t--4 md:salt-m-b--4",intent:Le.type,"data-test":"order-informative-alert",text:s.jsx(v,{id:Le.message})}):null},N=(Ie,je)=>{const Le=!!je?.length,Be=!!Ie?.products?.length,be=!!Ie?.substitutes?.length,he=!!Ie?.missings?.length,ge=!!Ie?.returns?.length,Oe=[Le,Be,be,he,ge].filter(Boolean).length>1;return{hasRefundRequests:Le,hasReceivedItems:Be,hasSubstitutedItems:be,hasMissingItems:he,hasReturnedItems:ge,hasMoreThanOneGroup:Oe}},k=()=>{if(r?.order&&a){const{primarySellerId:Ie,primarySellerName:je}=r.order,Be=pWt(a,i,{sellerId:Ie,sellerName:je},d),be=N(a,l).hasMoreThanOneGroup;return s.jsxs(h.Fragment,{children:[l?.length>0&&W(l),Be.map(({sellerName:he,products:ge})=>s.jsx(Zse,{sellerName:he,children:w(ge,[],be)}))]})}return null},j=(Ie,je)=>{const Le={};for(const Be in je){const be=je[Be];be&&be.productId!==void 0&&(Le[be.productId]=be)}return Ie.map(Be=>{const be=Le[Be.productId],he=be?{...Be,...be}:Be;return Be.substitutes&&(he.substitutes=Be.substitutes.map(ge=>{const Oe=Le[ge.productId];return Oe?{...ge,...Oe}:ge})),he})},w=(Ie,je,Le=!1)=>{if(!r.order)return null;const{hasMoreThanOneGroup:Be,hasRefundRequests:be,hasMissingItems:he,hasSubstitutedItems:ge,hasReceivedItems:Oe,hasReturnedItems:Xe}=N(Ie,je);if(Be||Le){const Se=[be&&W(je),he&&Q(j(Ie.missings,c)),ge&&K(j(Ie.substitutes,c)),Oe&&$(j(Ie.products,c)),Xe&&X(j(Ie.returns,c))].filter(Boolean);return s.jsx(h.Fragment,{children:Se})}else{if(Oe)return L(j(Ie.products,c),"products");if(ge)return B(j(Ie.substitutes,c));if(he)return L(j(Ie.missings,c),"missing");if(Xe)return L(j(Ie.returns,c),"returns")}return null},L=(Ie,je)=>s.jsxs(h.Fragment,{children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:t.formatMessage(`order.online.receipt.accessibility.list.${je}`)})}),s.jsx(FI,{products:Ie})]}),B=Ie=>s.jsx(BI,{substitutions:Ie}),W=Ie=>I&&!u?s.jsxs(is,{"data-test":"refund-request-items-accordion",children:[s.jsx(is.Title,{active:!0,"aria-label":t.formatMessage("order.online.receipt.accessibility.list.refunds"),children:s.jsx(P,{asChild:!0,children:s.jsx("h2",{children:s.jsx(v,{id:"order.details.requested-for-refund.items.title"})})})}),s.jsx(is.Content,{active:!0,className:"salt-p-l--0 salt-p-r--0",children:s.jsx(sne,{type:"requested",isFetching:r.isFetching,refundables:Ie,productsByProductId:c})})]}):null,$=Ie=>re(Ie,_a.LIST_TYPE_REGULAR,"order.details.products.title","received-items","products"),K=Ie=>s.jsxs(is,{"data-test":"substituted-items-accordion",children:[s.jsx(is.Title,{active:!0,"aria-label":t.formatMessage("order.online.receipt.accessibility.list.substitutions"),children:s.jsx(P,{asChild:!0,children:s.jsx("h2",{children:s.jsx(v,{id:"order.details.substituted.items.title","data-test":"order-online-receipt-substituted-items-accordion-title"})})})}),s.jsx(is.Content,{active:!0,className:"salt-p-l--0 salt-p-r--0",children:s.jsx(BI,{substitutions:Ie})})]}),Q=Ie=>re(Ie,_a.LIST_TYPE_MISSING,"order.details.missing.items.title","missing-items","missing"),X=Ie=>re(Ie,_a.LIST_TYPE_RETURNED,"order.details.returned.items.title","returned-items","returns"),re=(Ie,je,Le,Be,be)=>s.jsxs(is,{"data-test":`${Be}-accordion`,children:[s.jsx(is.Title,{active:!0,"aria-label":t.formatMessage(`order.online.receipt.accessibility.list.${be}`),children:s.jsx(P,{asChild:!0,children:s.jsx("h2",{children:s.jsx(v,{id:Le,"data-test":`order-online-receipt-${Be}-accordion-title`})})})}),s.jsx(is.Content,{active:!0,className:"salt-p-l--0 salt-p-r--0",children:s.jsx(FI,{products:Ie,listType:je})})]}),ue=()=>S&&r?.order?.recurringShoppingDefinition&&s.jsx(hE,{className:"salt-m-y--4",orderId:r.order.orderId,recurringShoppingDefinition:r.order.recurringShoppingDefinition}),te=()=>s.jsx("div",{className:"salt-m-y--4",children:s.jsx(pqt,{orderId:o,handleEditOrderButtonClick:R,isOrderMultiPaymentsEnabled:f})}),ce=()=>s.jsx(lne,{loading:e.loading}),de=()=>{if(I&&r&&r.order){const{order:{status:Ie,dates:je}}=r;return s.jsx(Jse,{orderStatus:Ie,orderDeliveryStartDate:je.deliveryStartDate,orderTimeZone:je.timeZoneId,orderId:o,intl:t})}return null},ye=()=>_?s.jsx(eqt,{orderBillingAddress:{...r?.order?.billingAddressDetails?.addressDetails,...r?.order?.billingAddressDetails?.customerDetails},isFetching:A}):null,Ae=()=>s.jsx(tqt,{}),Je=()=>r&&r.order&&r.order.status&&r.order.status!=="CANCELLED"&&r.order.status!=="SCRATCHED"?s.jsx(one,{orderId:r.order.orderId,orderStatus:r.order.status}):null;if(!r.error&&r.lastUpdated&&!r.isFetching){const{primarySellerId:Ie,primarySellerName:je}=r.order;return s.jsxs(h.Fragment,{children:[s.jsxs(Y,{"data-test":"order-online-receipt",className:"md:salt-m-x--4 md:salt-p-x--2 salt-m-x--0",children:[s.jsx(Kt,{remainInDom:!1,breakpoint:"sm-up",children:s.jsxs(Y.Item,{colSpan:{xs:12,md:0},children:[ue(),te(),s.jsx(ZG,{}),ye(),f?Ae():s.jsx(QG,{}),ce(),de(),m?Je():null]})}),s.jsxs(Y.Item,{colSpan:{xs:12,md:8},children:[r.order&&O(),s.jsx("div",{"data-test":"products-container",className:"salt-m-t--4",children:y&&Ie&&je?k():w(a,l)})]}),s.jsx(cs,{remainInDom:!1,breakpoint:"sm-up",children:s.jsxs(Y.Item,{colSpan:{sm:12,md:4},children:[ue(),te(),s.jsx(ZG,{}),ye(),f?Ae():s.jsx(QG,{}),ce(),de(),m?Je():null]})})]}),r?.order?.orderId&&s.jsxs(h.Fragment,{children:[s.jsx(QL,{orderId:r.order.orderId,sendPageView:!0}),s.jsx(zL,{})]}),c&&s.jsx(nne,{})]})}return null},aKt=(e,t)=>{const n=lC(e,t.orderId);return{order:Ds(e),groupedProducts:HD(e),sellers:cC(e),requestedForRefundItems:Kk(e),productsByProductId:ir(e),paymentSummary:ac(e),locale:Vs(e),isExternal:Ag(e),isOrderUnderEdit:n,isInvoiceRequestFormEnabled:tKt(e),failedPaymentsData:r4(e,t.orderId),isOrderMultiPaymentsEnabled:nKt(e)}},iKt=ot({sendAnalyticsEvent:U.analyticsEvent,openChangeStoreModal:e=>Z.openModal("changeStore",e),fetchCreatedRefundRequest:Nm.fetchCreatedRefundRequest});eM.propTypes=oKt;eM.defaultProps=rKt;const lKt=Ct(Bt,ke(aKt,iKt))(eM),cKt=D("rec.o"),dKt=D("roid"),uKt=D("mpv"),pKt=e=>e&&e.isBefore(Ge().utcOffset(e.format("Z")).add(2,"days").startOf("day")),Gv={EDITABLE:{heading:"order.details.heading.future.edit.until"},OTHER_UNDER_EDIT:{heading:"order.details.heading.future.edit.until"},UNDER_EDIT:{heading:"order.details.heading.future.edit.until"},EDIT_EXPIRED:{heading:"orders.list.card.status.future.edit.expired"},PENDING_PAYMENT:{heading:"order.details.heading.future.edit.pending.payment"},DELIVERED:{heading:"order.details.heading.delivered"},PICKED:{heading:"order.details.heading.picked"},CANCELLED:{heading:"order.details.heading.canceled"},SCRATCHED:{heading:"order.details.heading.scratched"},DEFAULT:{heading:"order.details.heading.future"}},mKt=(e,t,n)=>{if(e){const o=Ge(e).tz(n);return pKt(o)?o.calendar():o.format(t)}return null},JG=(e,t)=>{switch(e){case"YOU_ARE_NEXT":return{heading:"logged.in.home.page.order.card.title.you.are.next"};case"WE_ARE_ON_THE_WAY":return{heading:"logged.in.home.page.order.card.title.we.are.on.the.way"};case"WE_ARE_HERE":return{heading:"logged.in.home.page.order.card.title.we.are.here"};default:return{heading:t}}},hKt=(e,t,n)=>{if(!e)return null;const{status:o,editStatus:r,dates:a}=e;let i=Gv.DEFAULT;switch(o){case"FUTURE":i=r==="EDIT_EXPIRED"?JG(e?.deliveryInfo?.currentState,"orders.list.card.status.future.edit.expired"):Gv[r];break;case"PICKED":i=JG(e?.deliveryInfo?.currentState,"order.details.heading.picked");break;default:i=Gv[o]}return i?.heading?n.formatMessage(i.heading,{editUntilDate:mKt(a.confirmOrderChangesBy,t,a.timeZoneId)}):null},yu=T(me)`
    margin-inline-end: var(--salt-spacing-1);
`,e$="order-summary",t$="order-again",gKt=({match:e,initialTab:t})=>{const n=M(),o=F(),r=E(l0),a=E(Ds),{order:i}=a,l=E(Yt),c=E(aae),d=E(cKt),u=E(Qi),m=E(ar),g=E(dKt),f=E(uKt),y={getOrder:O=>o(Wo.getDecoratedOrderCall(O)),getRecurringShoppingDefinitions:()=>o(qa.getRecurringShoppingDefinitions()),openChangeStoreModal:O=>o(Z.openModal(yb,O)),getOrderMultiPayments:O=>o(Dr.getOrderMultiPayments(O))};h.useEffect(()=>{(_()||!l)&&(a.isFetching||(y.getOrder(e.params.orderId),d&&y.getRecurringShoppingDefinitions(),i&&!I()&&S(),f&&y.getOrderMultiPayments(e.params.orderId)))},[]);const I=()=>!(u==="STORE"&&i?.retailerRegionId!==m),S=()=>{const O=`${window.location.origin}${od(i?.retailerRegionId)}${gn(i?.orderId)}`,N=`${window.location.origin}${od(i?.retailerRegionId)}${lo()}`,k={title:"orders.list.change.store.modal.title",message:"orders.list.change.store.modal.message",cancel:"orders.list.change.store.modal.cancel",confirm:"orders.list.change.store.modal.confirm"};y.openChangeStoreModal({redirectUrl:O,cancelRedirectUrl:N,messages:k})},C=()=>!r,_=()=>i&&e.params.orderId===i.orderId,A=()=>{const O=i?.orderId??"",N=i?.orderReference;return g&&N&&N!==O?`${O} (${N})`:O},x=()=>{if(!i)return null;const{status:O,editStatus:N}=i;return O==="FUTURE"?N==="PENDING_PAYMENT"?null:N==="EDIT_EXPIRED"&&i?.deliveryInfo?.currentState?s.jsx(yu,{name:"home_delivery",height:30,width:30,"data-test":"order-details-heading-icon-home_delivery"}):s.jsx(yu,{name:"orders_placed",height:30,width:30,"data-test":"order-details-heading-icon-orders-placed"}):O==="CANCELLED"||O==="SCRATCHED"?s.jsx(yu,{error:!0,name:"status_no",height:30,width:30,"data-test":"order-details-heading-icon-cross"}):O==="PICKED"?s.jsx(yu,{name:"home_delivery",height:30,width:30,"data-test":"order-details-heading-icon-home-delivery"}):O==="DELIVERED"?s.jsx(yu,{success:!0,name:"status_yes",height:30,width:30,"data-test":"order-details-heading-icon-tick"}):s.jsx(yu,{name:"orders_placed",height:30,width:30,"data-test":"order-details-heading-icon-orders-placed"})},R=()=>s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"order.details.page.title",values:{orderId:i?.orderId??""}}),s.jsxs(An,{"data-test":"order-view-switch-bar",className:"md:salt-p-x--8",children:[s.jsxs("div",{className:"salt-d--flex",children:[x(),s.jsx(ne,{as:"h1","data-test":"order-details-heading-title",children:hKt(i,c,n)})]}),s.jsxs(P,{"data-test":"order-details-order-reference",children:[s.jsx(v,{id:"order.details.subheading.orderId"}),":"," ",A()]})]}),i?.external&&C()&&s.jsx(Ce,{className:"md:salt-m-x--8 salt-m-x--2",intent:"warning","data-test":"external-order-alert",showIcon:!1,text:s.jsx(v,{id:"order.details.external.message"})})]});return!a.error&&a.lastUpdated&&!a.isFetching&&I()?s.jsxs(h.Fragment,{children:[i&&R(),s.jsxs(ki,{selectedId:t,children:[s.jsxs(ki.TabList,{children:[s.jsx(ki.Tab,{id:e$,"data-test":"order-summary-tab-button",children:n.formatMessage("order.details.tab.order.summary.title")}),s.jsx(ki.Tab,{id:t$,"data-test":"order-again-tab-button",children:n.formatMessage("order.details.tab.order.again.title")})]}),s.jsx(ki.TabPanel,{id:e$,children:s.jsx(lKt,{orderId:e.params.orderId})}),s.jsx(ki.TabPanel,{id:t$,children:s.jsx(SWt,{})})]})]}):a.error?a.error.statusCode===404?s.jsx(lt,{}):s.jsx(ur,{}):null},$v={EDITABLE:{heading:"order.details.heading.future",headingMessage:"order.details.heading.message.editable"},OTHER_UNDER_EDIT:{heading:"order.details.heading.future"},UNDER_EDIT:{heading:"order.details.heading.future"},EDIT_EXPIRED:{heading:"order.details.heading.future",headingMessage:"order.details.heading.message.edit.expired"},DELIVERED:{heading:"order.details.heading.delivered"},PICKED:{heading:"order.details.heading.picked",headingMessage:"order.details.heading.message.edit.expired"},CANCELLED:{heading:"order.details.heading.canceled"},SCRATCHED:{heading:"order.details.heading.scratched"},DEFAULT:{heading:"order.details.heading.future"}},EKt=({order:e})=>{const t=E(Jt),n=E(Vt),o=M(),[r,a]=fe(["csoei","roid"]);if(!e)return null;const{dates:i,status:l,editStatus:c}=e,d=(l==="FUTURE"?$v[c]:$v[l])||$v.DEFAULT,u={heading:d.heading&&o.formatMessage(d.heading),headingMessage:d.headingMessage&&o.formatMessage(d.headingMessage)},m=()=>{const f=e?.orderId??"",y=e?.orderReference;return a&&y&&y!==f?`${f} (${y})`:f},g=()=>i?.deliveryStartDate&&i?.deliveryEndDate?s.jsxs(ne,{as:"h1",children:[u.heading,":"," ",s.jsx(go,{dateIsoFrom:i.deliveryStartDate,dateIsoTo:i.deliveryEndDate,timeZoneId:i.timeZoneId,dateFormat:t,timeFormat:n})]}):s.jsx(ne,{as:"h1",children:u.heading});return s.jsxs(h.Fragment,{children:[r&&e.editStatus==="UNDER_EDIT"?s.jsx(ne,{as:"h1",children:u.heading}):g(),s.jsxs(P,{"data-test":"order-details-heading-subheading",children:[s.jsx(v,{id:"order.details.subheading.orderId"}),": ",m()]}),u.headingMessage&&s.jsx(P,{"data-test":"order-details-heading-message",className:"salt-p-y--4 salt-p-x--1",children:u.headingMessage})]})},_l=({items:e=[],missing:t,substitute:n,returned:o,isFetching:r,"data-test":a,shouldRenderHeader:i=!0})=>{const l=E(ir),c=e?.length&&e.every(({product:g})=>g),d=e.flatMap(({product:g})=>g?.productId?[g.productId]:[]),u=c?e.reduce((g,f,y)=>{const I=f.product?.productId,S=I&&l&&l[I];return I&&(g[I]={...S,quantityInOrder:f.quantity,substitute:!!n,rejected:f.accepted===!1,accepted:!!f.accepted,missing:t||n&&y===0,returned:!!o,isInCurrentCatalog:f.isInCurrentCatalog}),g},{}):{},m=()=>t?Lt.MISSING:n?Lt.SUBSTITUTED:o?Lt.RETURNED:Lt.DELIVERED;return s.jsxs(h.Fragment,{children:[i&&s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:s.jsx(v,{id:"order.details.products.title"})})}),s.jsx(Xp,{productGroups:[{products:d,groupTitle:m(),section:m()}],productsByProductId:u,page:"order-details",type:"order",isFetching:r,"data-test":a},`${c}`)]})},dne=ee("CART_REBOOK"),fKt=e=>({type:"API",payload:{url:"/v1/carts/active/rebook",pathPrefix:{client:"/api/cart",server:"/core-api"},service:"web_basket_ws",options:{body:{orderId:e},method:"PUT"},...dne}}),yKt={rebook:fKt,types:{CART_REBOOK:dne}},IKt=(e,t)=>async n=>{let o=null;try{o=(await n(yKt.rebook(e)))?.payload?.responseData}catch(r){throw z.error("toast.notification.generic.error"),r}return n(Z.closeModal()),t(jt()),o},SKt={rebook:IKt},CKt=D("m.la.h"),TKt={isOpen:p.bool.isRequired,isBasketUnderEdit:p.bool.isRequired,order:Go.isRequired,rebookAction:p.func.isRequired,actions:p.shape({prepareCheckout:p.func.isRequired,closeModal:p.func.isRequired}).isRequired,modalLeftAlignEnabled:p.bool},_Kt={modalLeftAlignEnabled:!1},s$={basketUnderEdit:{header:"order.rebook.order.under.edit.modal.title",body:"order.rebook.order.under.edit.modal.text",saveChanges:"order.rebook.order.under.edit.saveChanges"},basketHasItems:{header:"order.rebook.modal.basket.has.items.modal.title",body:"order.rebook.basket.has.items.modal.text",cancelChanges:"order.rebook.basket.has.items.cancel",saveChanges:"order.rebook.basket.has.items.ok"}},tM=({actions:e,isBasketUnderEdit:t,isOpen:n,order:o,rebookAction:r,modalLeftAlignEnabled:a})=>{const i=We(),[l,c]=h.useState(!1),{orderId:d}=o,u="rebook-modal-header",m=t?s$.basketUnderEdit:s$.basketHasItems,g=()=>t?(c(!0),e.prepareCheckout().then(({canCheckout:f,redirect:y})=>(c(!1),i(f?kr():y))).catch(()=>{c(!1)})):r({orderId:d});return s.jsxs(G,{isOpen:n,onRequestClose:e.closeModal,aria:{labelledby:u},children:[s.jsx(G.Header,{align:a?"left":"center",children:s.jsx(ne,{as:"h2",id:u,"data-test":"rebook-modal",children:s.jsx(_t,{id:m.header})})}),s.jsx(G.Body,{children:s.jsx(_t,{id:m.body})}),s.jsx(G.Footer,{className:"salt-d--block",align:a?"left":"center",children:s.jsxs(Y,{flush:!0,children:[!t&&s.jsx(Y.Item,{colSpan:{xs:12,md:6},xs:12,md:6,children:s.jsx(b,{className:"salt-m-t--2 md:salt-m-t--4",fill:!0,intent:"secondary",onClick:e.closeModal,"data-test":"rebook-modal-under-edit-dismiss",children:s.jsx(b.Text,{children:s.jsx(_t,{id:m.cancelChanges})})})}),s.jsx(Y.Item,{colSpan:{xs:12,md:t?12:6},children:s.jsx(b,{className:"salt-m-t--2 md:salt-m-t--4",fill:!0,intent:"primary",onClick:g,"data-test":"rebook-modal-confirm",loading:l,children:s.jsx(b.Text,{children:s.jsx(_t,{id:m.saveChanges})})})})]})})]})};tM.propTypes=TKt;tM.defaultProps=_Kt;const vKt=e=>({isOpen:Ue("rebook")(e),isBasketUnderEdit:Mr(e),modalLeftAlignEnabled:CKt(e)}),AKt=ot({prepareCheckout:Wg,closeModal:Z.closeModal}),bKt=ke(vKt,AKt)(tM),xKt={order:Go.isRequired},{openModal:RKt}=Z,sM=({order:e})=>{const t=We(),n=E(gi),o=F(),r=()=>{o(RKt("rebook"))},a=({orderId:l})=>o(SKt.rebook(l,t)),i=()=>n?r():a({orderId:e.orderId});return s.jsxs(h.Fragment,{children:[s.jsx(b,{intent:"action",fill:!0,onClick:i,"data-test":"rebook-button",children:s.jsx(b.Text,{children:s.jsx(_t,{id:"order.details.rebook"})})}),s.jsx(bKt,{order:e,rebookAction:a})]})};sM.propTypes=xKt;const DKt=D("csoei");class OKt extends h.Component{constructor(t){super(t),this.state={isCheckoutLoading:!1},this.confirmCheckout=this.confirmCheckout.bind(this)}handleBasketBelowThreshold(){const{basketThreshold:t,intl:n,currencyFormat:o}=this.props,r=$a(n.formatNumber,t,o);return z.info({key:"basket.below.threshold.error",substitutions:{threshold:r}})}confirmCheckout(){const{actions:t,isBasketBelowThreshold:n,order:o}=this.props;t.analyticsEvent({type:Te.CHECKOUT_ORDER_BUTTON_CLICKED,orderId:o.orderId,minSpendReached:!n});const r={event:"cart_checkout",order_id:o.orderId};return J.sendEvent({GA:r,WA:null}),n?this.handleBasketBelowThreshold():(this.setState({isCheckoutLoading:!0}),t.prepareCheckout().then(({canCheckout:a,redirect:i})=>a?(t.extendSlot(),t.analyticsEvent({type:Kn.CHECKOUT_WALK}),this.props.navigate(kr())):this.props.navigate(i)).catch(()=>{this.setState({isCheckoutLoading:!1})}))}render(){const{isNewCheckoutButtonMessageEnabled:t}=this.props;return s.jsx(b,{intent:"action",fill:!0,onClick:this.confirmCheckout,"data-test":"save-edit-button","data-synthetics":"save-edit-button",loading:this.state.isCheckoutLoading,children:s.jsx(b.Text,{children:s.jsx(v,{id:t?"order.continue.checkout.to.save.changes":"order.continue.checkout"})})})}}const PKt=e=>({isBasketBelowThreshold:ox(e),dateFormat:Jt(e),timeFormat:Vt(e),basketThreshold:cS(e),isNewCheckoutButtonMessageEnabled:DKt(e),currencyFormat:pi(e)}),NKt=ot({analyticsEvent:U.analyticsEvent,prepareCheckout:Wg,extendSlot:nQ.extendSlot}),une=Ct(Bt,ke(PKt,NKt))(OKt),LKt={order:Go.isRequired,actions:p.shape({openCancelChangesModal:p.func.isRequired}).isRequired},pne=({order:e,actions:t})=>{const{orderId:n}=e;return s.jsxs(h.Fragment,{children:[s.jsx(b,{intent:"secondary",fill:!0,onClick:()=>t.openCancelChangesModal(n),"data-test":"cancel-changes-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"order.undo.changes"})})}),s.jsx(WN,{orderId:n,page:"order-details"})]})},kKt=ot({openCancelChangesModal:e=>Z.openModal(`cancelChanges${e}`)});pne.propTypes=LKt;const MKt=ke(null,kKt)(pne),jKt={order:Go.isRequired},my=({order:{orderId:e}})=>{const t=F(),n=()=>{t(Z.openModal(`cancelOrder${e}`))};return s.jsxs(h.Fragment,{children:[s.jsx(b,{intent:"secondary",fill:!0,onClick:n,"data-test":"cancel-order-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"order.cancel"})})}),s.jsx(qN,{orderId:e,page:"order-details"})]})};my.propTypes=jKt;const wKt={order:Go.isRequired},Po=({order:e})=>{const t=F(),n=We(),o=E(gi),r=E(Qi),a=E(ar),i=()=>{t(Z.openModal(Yk))},l=({orderId:u,emptyCart:m})=>{t(zse.buyAgain({orderId:u,emptyCart:m,navigate:n}))},c=()=>o?i():l({orderId:e.orderId}),d=()=>r==="STORE"&&e.retailerRegionId!==a;return s.jsx("div",{children:!d()&&s.jsxs(h.Fragment,{children:[s.jsx(b,{intent:"action",fill:!0,onClick:c,"data-test":"buy-again-button",children:s.jsx(b.Text,{children:s.jsx(_t,{id:"order.buy.again"})})}),s.jsx(Qse,{order:e,buyAgainAction:l})]})})};Po.propTypes=wKt;const FKt={order:Go.isRequired},mne=({order:e})=>{const t=C0(e.orderId);return s.jsxs(b,{intent:"secondary",fill:!0,"data-test":"order-receipt-button",children:[s.jsx(b.Icon,{name:"pdf"}),s.jsx(rt,{href:t,target:"_blank",standalone:!0,bold:!0,children:s.jsx(b.Text,{children:s.jsx(_t,{id:"order.details.receipt"})})})]})};mne.propTypes=FKt;const ym={UNDER_EDIT:{buttons:[une,MKt,my]},EDITABLE:{buttons:[Zk,my]},OTHER_UNDER_EDIT:{buttons:[my,Po]},EDIT_EXPIRED:{buttons:[Po]},DELIVERED:{buttons:[Po]},PICKED:{buttons:[Po]},CANCELLED:{buttons:[Po]},SCRATCHED:{buttons:[Po]},DEFAULT:{buttons:[Po]}},BKt=e=>{const{status:t,editStatus:n,hasReceipt:o}=e;let r;return t==="FUTURE"?r=ym[n]:o&&t==="DELIVERED"?r={...ym[t],buttons:[mne,...ym[t].buttons]}:t==="SCRATCHED"&&e.rebookable?r={buttons:[sM]}:r=ym[t],r||ym.DEFAULT},UKt=()=>{const e=E(Ds);if(!e.order||!e.order.status||!e.order.editStatus)return null;const t=BKt(e.order);if(!t)return null;const n=t.buttons.map(o=>s.jsxs(h.Fragment,{children:[s.jsx(o,{order:e.order}),s.jsx("div",{className:"salt-m-y--4"})]}));return s.jsx(h.Fragment,{children:n})},Hv={UNDER_EDIT:une,EDITABLE:Zk,OTHER_UNDER_EDIT:Po,EDIT_EXPIRED:Po,DELIVERED:Po,PICKED:Po,CANCELLED:Po,SCRATCHED:Po,DEFAULT:Po},GKt=e=>{let t=Hv[e.status];return e.status==="FUTURE"?t=Hv[e.editStatus]:e.status==="SCRATCHED"&&e.rebookable&&(t=sM),t||Hv.DEFAULT},$Kt=({order:e})=>{const t=GKt(e.order);return s.jsx(t,{order:e.order})},HKt=vo(["loyalty","loyear"]),VKt=D("loyear.csm"),YKt=vo(["loyalty","loyred"]),WKt=D("tp"),qKt=D("tp.new"),KKt=D("pay.check.show"),zKt=D("tx.nts"),QKt=Dn(["sumsub","bt.spl"]),XKt=D("cs.ps"),ZKt=D("prp"),JKt=D("sib"),ezt={...qse,missing:[],products:[],requestedForRefund:[],returned:[],substituted:[],loyaltyEarnings:null,externalWalletManagement:!1,locale:"",isTaxInclusionNoteEnabled:!1};class tzt extends h.Component{formattedMessages;static defaultProps=ezt;constructor(t){super(t),this.formattedMessages={summaryTitle:t.intl.formatMessage("order.details.summary.title")},this.hasOrderIdInUrlChanged=this.hasOrderIdInUrlChanged.bind(this),this.state={expanded:!1,loadedViewPortSize:!1},this.sendSummaryToggledAnalyticsEvent=this.sendSummaryToggledAnalyticsEvent.bind(this),this.setCollapsibleSummaryExpanded=this.setCollapsibleSummaryExpanded.bind(this),this.isMobileLayout=this.isMobileLayout.bind(this),this.getTotalPrice=this.getTotalPrice.bind(this)}componentDidMount(){this.setState({loadedViewPortSize:!0}),this.setCollapsibleSummaryExpanded()}setCollapsibleSummaryExpanded(){const t=typeof window<"u"&&window.matchMedia(`(min-width: ${Ke.sm}em)`).matches;t!==this.state.expanded&&this.setState({expanded:t})}componentDidUpdate(t){const{isOrderUnderEdit:n}=this.props;n!==t.isOrderUnderEdit&&this.setCollapsibleSummaryExpanded()}hasOrderIdInUrlChanged(t){const{orderEntity:n,match:o}=this.props;return!n.isFetching&&!!t.match.params.orderId&&!!o.params.orderId&&t.match.params.orderId!==o.params.orderId}isCurrentOrderTheActiveOne(){const{order:t}=this.props.orderEntity;return!!(t&&this.props.match.params.orderId===t.orderId)}isMobileLayout(){return!(typeof window<"u"&&window.matchMedia(`(min-width: ${Ke.lg}em)`).matches)}sendSummaryToggledAnalyticsEvent(t){const n=t?Wn.SUMMARY_COMPONENT_COLLAPSED:Wn.SUMMARY_COMPONENT_EXPANDED,o=t?"User collapsed the summary component":"User expanded the summary component";this.props.actions.sendAnalyticsEvent({type:n,description:o})}getTotalPrice(){const{paymentSummary:t,isOrderUnderEdit:n,isSummarySubtotalEnabled:o}=this.props;return n?o?t?.totals?.display?.itemPriceAfterPromos:t?.totals?.totalPrice:t?.totalPrice}render(){const{quantity:t,paymentSummary:n,getLoyaltySpent:o,getLoyaltyEarned:r,isLoyaltyRedeemEnabled:a,isLoyaltyEarningEnabled:i,loading:l,rebookable:c,orderEntity:d,isOrderUnderEdit:u,isShowPaymentChecksEnabled:m,isExternal:g,isTaxInclusionNoteEnabled:f,isSummarySubtotalEnabled:y,isPlusSignEnabled:I,isLoyaltyEarningMovedToSummaryEnabled:S,isToggleablePromotionsEnabled:C,isToggleablePromotionsV2Enabled:_,intl:A,isReferencePrice:x,isSavingsBanner:R}=this.props,{expanded:O}=this.state,{paymentInfo:N}=n,{paymentAmountSplitPerMethods:k}=N||{},j=re=>(k?.find(ue=>ue.paymentMethod===re)||{})?.total,w=re=>{this.sendSummaryToggledAnalyticsEvent(O),re.preventDefault(),this.setState(ue=>({expanded:!ue.expanded}))};if(!this.isCurrentOrderTheActiveOne()||!this.state.loadedViewPortSize)return s.jsxs(cs,{breakpoint:"sm-up","data-test":"summary",children:[s.jsx(Ns,{title:this.formattedMessages.summaryTitle,children:s.jsx(Ns.Skeleton,{})}),s.jsx(ae.Buttons,{loading:!0,children:s.jsx(UKt,{})})]});const L=I?"always":"auto",B=A.formatMessage(y&&u?"summary.subtotal":"summary.total"),W=y&&u?A.formatMessage("summary.subtotal.price.note"):void 0,$=this.getTotalPrice(),K=u?n?.totals?.itemsRetailPrice:n?.itemsRetailPrice,Q=u?n?.totals?.display?.itemPriceAfterPromos:n.itemPriceAfterPromos,X=!!Number(n?.savings?.amount);return s.jsxs("div",{className:"salt-m-y--4",children:[s.jsxs(gs,{expanded:O,onToggle:w,breakpoint:"sm-up",sticky:!0,aria:{contentLabel:A.formatMessage("order.details.summary.title"),totalPrice:$&&$a(A.formatNumber,$,"")},children:[s.jsxs(gs.ControlSection,{children:[O?s.jsx(ne,{as:"span",children:s.jsx(v,{id:"order.details.summary.title"})}):s.jsx(ae.TotalInline,{loading:!n,totalPrice:$,withTaxNote:f,title:B,note:W}),s.jsx(gs.ToggleSwitch,{})]}),s.jsxs(gs.Content,{children:[!g&&s.jsxs(h.Fragment,{children:[s.jsxs(pe,{children:[s.jsx(ae.Items,{itemsRetailPrice:K,quantity:t,withTaxNote:f}),s.jsx(ae.Savings,{savings:n?.savings}),R&&x&&X&&s.jsx(Ai,{isSummarySection:!0,className:"salt-m-b--2"}),s.jsx(ae.SavingsWithPaymentMethod,{savings:n?.paymentMethodSavingsPrice}),y&&!u&&X&&!!Q&&Q?.amount!==n?.finalPrice?.amount&&s.jsx(ae.Subtotal,{withTaxNote:f,value:Q}),!(y&&u)&&s.jsxs(h.Fragment,{children:[s.jsx(ae.Promotions,{orderLevelPromotions:n?.orderLevelPromotions}),s.jsx(ae.Vouchers,{appliedVouchers:n?.appliedVouchers||[],vouchersSavingsPrice:n?.vouchersSavingsPrice}),s.jsx(ae.Delivery,{delivery:n?.delivery,withTaxNote:f,signDisplay:L}),s.jsx(ae.DeliveryPromotions,{deliveryPromotions:n?.deliveryPromotions}),s.jsx(ae.BagCharge,{carrierBag:n?.carrierBag,withTaxNote:f,signDisplay:L}),s.jsx(ae.PreparationCost,{preparationCost:n.preparation,withTaxNote:f,signDisplay:L}),s.jsx(ae.Invoice,{invoice:n?.invoice,withTaxNote:f,signDisplay:L}),s.jsx(ae.EnvironmentalHandlingCharge,{environmentalHandlingPrice:n?.environmentalHandlingPrice,withTaxNote:f,signDisplay:L}),s.jsx(ae.Loyalty,{isLoyaltyRedeemEnabled:a,getLoyaltySpent:o}),s.jsx(ae.Deposit,{depositsPrice:n?.depositsPrice,withTaxNote:f,signDisplay:L}),s.jsx(ae.SmallOrderCharge,{smallOrderPrice:n.smallOrder,orderId:d.order?.orderId||"",thresholds:n?.smallOrderChargeThresholds,withTaxNote:f,signDisplay:L,page:"order-details"})]})]}),!u&&s.jsxs(h.Fragment,{children:[s.jsx(ae.Taxes,{"data-test":"summary-taxes",finalPrice:n?.finalPrice,components:n?.taxComponents,withTaxNote:f}),s.jsx(ae.Separator,{}),s.jsxs(pe,{"data-test":"summary-payment-list",children:[m&&k&&k.length>=1&&s.jsx(ae.PaymentChecks,{"data-test":"summary-payment-checks",paidByCheck:j("PAYMENT_CHECK"),paidByCard:j("CARDS"),paidByInvoice:j("INVOICE")}),s.jsx(ae.PaymentMethod,{paymentInfo:n?.paymentInfo})]})]}),s.jsx(ae.Separator,{})]}),s.jsx(ae.TotalSpaceBetween,{loading:!n,totalPrice:$,withTaxNote:f,title:B,note:W})]}),s.jsxs("div",{children:[i&&S&&s.jsx("div",{className:"salt-p-t--4","data-test":"loyalty-earnings-summary",children:s.jsx(Hd,{getQuantity:r,allowZero:!0})}),s.jsx(ae.Buttons,{loading:l,children:d.order&&s.jsx("div",{className:"salt-p-t--4",children:s.jsx($Kt,{order:{order:d.order}})})}),s.jsx(ae.RebookableDisclaimer,{rebookable:c})]})]}),u&&(C||_)&&s.jsx(XA,{})]})}}const szt=(e,t)=>{const n=lC(e,t.match.params.orderId);return{orderEntity:Ds(e),paymentSummary:n?U$e(e):ac(e),quantity:n?gp(e):BD(e),getLoyaltySpent:n?Xi:UD,getLoyaltyEarned:n?eg:id,isLoyaltyRedeemEnabled:YKt(e),isLoyaltyEarningEnabled:HKt(e),isLoyaltyEarningMovedToSummaryEnabled:VKt(e),isToggleablePromotionsEnabled:WKt(e),isToggleablePromotionsV2Enabled:qKt(e),isShowPaymentChecksEnabled:KKt(e),delivery:vg(e),rebookable:GD(e),isOrderUnderEdit:n,isExternal:Ag(e),isTaxInclusionNoteEnabled:zKt(e),isSummarySubtotalEnabled:QKt(e),isPlusSignEnabled:XKt(e),isReferencePrice:ZKt(e),isSavingsBanner:JKt(e)}},nzt=ot({getOrder:Wo.getDecoratedOrderCall,sendAnalyticsEvent:U.analyticsEvent}),ozt=Ct(Bt,ke(szt,nzt))(tzt),rzt=vo(["loyalty","loyear"]),azt=D("loyear.csm"),izt=D("rec.o"),lzt=D("slfsrv.refunds"),czt=D("csoei"),dzt=Dn(["sumsub","bt.spl"]),uzt=Dn(["bt.view.dd","bt.spl"]),pzt=e=>D("invoifram")(e)&&ZI(e),mzt=D("mpv"),hzt=D("del.win"),gzt=D("pln.win"),Ezt={...qse,missing:[],products:[],requestedForRefund:[],returned:[],substituted:[],loyaltyEarnings:null,externalWalletManagement:!1,locale:"",isTaxInclusionNoteEnabled:!1};class fzt extends h.Component{formattedMessages;dataTestValues;static defaultProps=Ezt;constructor(t){super(t),this.formattedMessages={productsTitle:t.intl.formatMessage("order.details.products.title"),missingItemsTitle:t.intl.formatMessage("order.details.missing.items.title"),substitutedItemsTitle:t.intl.formatMessage("order.details.substituted.items.title"),refundRequestsTitle:t.intl.formatMessage("order.details.requested-for-refund.items.title"),progressTitle:t.intl.formatMessage("edit.order.progress.title"),returnedItemsTitle:t.intl.formatMessage("order.details.returned.items.title")},this.dataTestValues={receivedItems:"received-items",substitutedItems:"substituted-items",missingItems:"missing-items",returnedItems:"returned-items",refundRequestItems:"refund-request-items"},this.hasOrderIdInUrlChanged=this.hasOrderIdInUrlChanged.bind(this),this.renderLoyaltyEarnings=this.renderLoyaltyEarnings.bind(this),this.renderOrderDetailsActionsBox=this.renderOrderDetailsActionsBox.bind(this),this.sendPageAttributesEvent=this.sendPageAttributesEvent.bind(this),this.shouldShowChangeStoreModal=this.shouldShowChangeStoreModal.bind(this),this.showChangeStoreModal=this.showChangeStoreModal.bind(this)}componentDidMount(){const{isServerRendered:t,order:n,actions:o,match:r,locale:a,isExternal:i,isOrderMultiPaymentsEnabled:l,isRecurringOrdersEnabled:c}=this.props;c&&o.getRecurringShoppingDefinitions(),this.props.isSelfServiceRefundEnabled&&!i&&this.props.actions.fetchCreatedRefundRequest(r.params.orderId,a),(this.isCurrentOrderTheActiveOne()||!t)&&(n.isFetching||(o.getOrder(r.params.orderId).then(()=>this.sendPageAttributesEvent()),l&&o.getOrderMultiPayments(r.params.orderId)))}componentDidUpdate(t){const{actions:n,match:o,isServerRendered:r,bannerBusinessModel:a,retailerRegionId:i,isOrderMultiPaymentsEnabled:l}=this.props,c=this.props.order&&this.props.order.order;c&&this.shouldShowChangeStoreModal(c,a,i)&&this.showChangeStoreModal(c,n.openChangeStoreModal),this.hasOrderIdInUrlChanged(t)&&!r&&(n.getOrder(o.params.orderId),l&&n.getOrderMultiPayments(o.params.orderId))}shouldShowChangeStoreModal(t,n,o){return n==="STORE"&&t.retailerRegionId!==o&&t.editStatus==="EDITABLE"}showChangeStoreModal(t,n){const o=`${window.location.origin}${od(t.retailerRegionId)}${gn(t.orderId)}`,r=`${window.location.origin}${od(t.retailerRegionId)}${lo()}`;n({redirectUrl:o,cancelRedirectUrl:r,messages:{title:"orders.list.change.store.modal.title",message:"orders.list.change.store.modal.message",cancel:"orders.list.change.store.modal.cancel",confirm:"orders.list.change.store.modal.confirm"}})}getData(){return this.isCurrentOrderTheActiveOne()?{orderData:this.props.order.order,productData:this.props.products,substituted:this.props.substituted,missing:this.props.missing,returned:this.props.returned,requestedForRefund:this.props.requestedForRefund}:{orderData:void 0,productData:void 0,substituted:void 0,missing:void 0,returned:void 0,requestedForRefund:void 0}}hasOrderIdInUrlChanged(t){const{order:n,match:o}=this.props;return!n.isFetching&&!!t.match.params.orderId&&!!o.params.orderId&&t.match.params.orderId!==o.params.orderId}isCurrentOrderTheActiveOne(){return!!(this.props.order.order&&this.props.match.params.orderId===this.props.order.order.orderId)}sendPageAttributesEvent(){const{actions:t,order:n}=this.props;t.sendAnalyticsEvent({type:As.PAGE_ATTRIBUTES_MULTIPLE,attributes:{ORDER_ORDER_ID:n&&n.order&&n.order.orderId,ORDER_ORDER_STATUS:n&&n.order&&n.order.status}})}renderSubstitutionProducts(t){const{order:n}=this.props;return t.map((o=[])=>{const{productId:r}=o[0]&&o[0].product||{};return s.jsx("div",{className:"salt-m-b--4",children:s.jsx(_l,{items:o,isFetching:!!n.isFetching,substitute:!0,"data-test":this.dataTestValues.substitutedItems,shouldRenderHeader:!1})},r)})}renderProductsAccordion(t){const{order:n}=this.props;return s.jsxs(ie.Fragment,{children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:this.formattedMessages.productsTitle})}),s.jsxs(is,{"data-test":`${this.dataTestValues.receivedItems}-accordion`,children:[s.jsx(is.Title,{active:!0,children:s.jsx(P,{size:"l",bold:!0,children:this.formattedMessages.productsTitle})}),s.jsx(is.Content,{active:!0,children:s.jsx(_l,{items:t,isFetching:!!n.isFetching,"data-test":this.dataTestValues.receivedItems,shouldRenderHeader:!1})})]})]})}renderSubstitutionAccordion(t){return s.jsxs(ie.Fragment,{children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:this.formattedMessages.substitutedItemsTitle})}),s.jsxs(is,{"data-test":`${this.dataTestValues.substitutedItems}-accordion`,children:[s.jsx(is.Title,{active:!0,children:s.jsx(P,{size:"l",bold:!0,children:this.formattedMessages.substitutedItemsTitle})}),s.jsx(is.Content,{active:!0,children:this.renderSubstitutionProducts(t)})]})]})}renderMissingAccordion(t){const{order:n}=this.props;return s.jsxs(ie.Fragment,{children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:this.formattedMessages.missingItemsTitle})}),s.jsxs(is,{"data-test":`${this.dataTestValues.missingItems}-accordion`,children:[s.jsx(is.Title,{active:!0,children:s.jsx(P,{size:"l",bold:!0,children:this.formattedMessages.missingItemsTitle})}),s.jsx(is.Content,{active:!0,children:s.jsx(_l,{items:t,isFetching:!!n.isFetching,missing:!0,"data-test":this.dataTestValues.missingItems,shouldRenderHeader:!1})})]})]})}renderReturnedAccordion(t){const{order:n}=this.props;return s.jsxs(is,{"data-test":`${this.dataTestValues.returnedItems}-accordion`,children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:this.formattedMessages.returnedItemsTitle})}),s.jsx(is.Title,{active:!0,children:s.jsx(P,{size:"l",bold:!0,children:this.formattedMessages.returnedItemsTitle})}),s.jsx(is.Content,{active:!0,children:s.jsx(_l,{items:t,isFetching:!!n.isFetching,returned:!0,"data-test":this.dataTestValues.returnedItems,shouldRenderHeader:!1})})]})}renderRefundRequestsAccordion(t){const{productsByProductId:n,order:{isFetching:o},isExternal:r}=this.props;return this.props.isSelfServiceRefundEnabled&&!r?s.jsxs(is,{"data-test":`${this.dataTestValues.refundRequestItems}-accordion`,children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:this.formattedMessages.refundRequestsTitle})}),s.jsx(is.Title,{active:!0,children:s.jsx(P,{size:"l",bold:!0,children:this.formattedMessages.refundRequestsTitle})}),s.jsx(is.Content,{active:!0,children:s.jsx(sne,{type:"requested",isFetching:o,refundables:t,productsByProductId:n})})]}):null}renderProducts(t,n,o,r,a){const{order:i}=this.props,l=a&&!!a.length,c=t&&!!t.length,d=n&&!!n.length,u=o&&!!o.length,m=r&&!!r.length;return[l,c,d,u,m].filter(f=>f===!0).length>1?s.jsxs(h.Fragment,{children:[l&&this.renderRefundRequestsAccordion(a),c&&this.renderProductsAccordion(t),m&&this.renderReturnedAccordion(r),d&&this.renderSubstitutionAccordion(n),u&&this.renderMissingAccordion(o)]}):c?s.jsx(_l,{"data-test":this.dataTestValues.receivedItems,items:t,isFetching:!!i.isFetching}):d?this.renderSubstitutionProducts(n):u?s.jsx(_l,{"data-test":this.dataTestValues.missingItems,items:o,missing:!0,isFetching:!!i.isFetching}):m?s.jsx(_l,{"data-test":this.dataTestValues.returnedItems,items:r,returned:!0,isFetching:!!i.isFetching}):s.jsx(_l,{isFetching:!!i.isFetching})}renderOrderDetailsActionsBox(){return s.jsx(lne,{loading:this.props.loading})}renderRefundRequestCard(){if(this.props.isSelfServiceRefundEnabled&&this.props.order&&this.props.order.order){const{order:{order:{orderId:t,status:n,dates:o}}}=this.props;return s.jsx(Jse,{orderStatus:n,orderDeliveryStartDate:o.deliveryStartDate,orderTimeZone:o.timeZoneId,orderId:t,intl:this.props.intl})}return null}renderLoyaltyEarnings(){return!this.props.isLoyaltyEarningMovedToSummaryEnabled&&this.props.isLoyaltyEarningEnabled&&this.props.loyaltyEarnings&&Number(this.props.loyaltyEarnings.units)!==0?s.jsx("div",{className:"salt-m-y--2",children:s.jsx(FL,{getQuantity:this.props.getLoyaltyEarned})}):null}isExternalOrderAlertEnabled(){const{hideExternalOrdersAlert:t}=this.props;return!t}renderFiscalInvoiceCard(){const{order:t}=this.props;if(t&&t.order&&t.order.status&&t.order.status!=="CANCELLED"&&t.order.status!=="SCRATCHED"){const{orderId:n,status:o}=t.order;return s.jsx(one,{orderId:n,orderStatus:o})}return null}render(){const{order:t,productsByProductId:n,isInvoiceRequestFormEnabled:o,isRecurringOrdersEnabled:r,isDeliveryWindowEnabled:a,isPlannedDeliveryWindowEnabled:i,timeFormat:l,match:c,loading:d}=this.props;if(!t.error&&t.lastUpdated&&!t.isFetching){const{orderData:u,productData:m,substituted:g,missing:f,returned:y,requestedForRefund:I}=this.getData();return s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"order.details.page.title",values:{orderId:t?.order?.orderId??""}}),s.jsx(An,{"data-test":"order-details-bar",children:s.jsx(EKt,{order:u})}),s.jsx(cne,{className:"salt-m--2",order:t.order,timeFormat:l,isDeliveryWindowEnabled:a,isPlannedDeliveryWindowEnabled:i}),u&&u.external&&this.isExternalOrderAlertEnabled()&&s.jsx("div",{className:"salt-m-t--2 salt-m-x--2",children:s.jsx(Ce,{intent:"warning","data-test":"external-order-alert",showIcon:!1,text:s.jsx(v,{id:"order.details.external.message"})})}),s.jsxs(Y,{children:[s.jsx(cs,{breakpoint:"sm-up",remainInDom:!1,children:s.jsx(Y.Item,{colSpan:{xs:12,md:8},children:s.jsx("div",{className:"salt-m-t--4",children:this.renderProducts(m,g,f,y,I)})})}),s.jsxs(Y.Item,{colSpan:{xs:12,md:4},children:[r&&t?.order?.recurringShoppingDefinition&&s.jsx(hE,{className:"salt-m-t--4",orderId:t.order.orderId,recurringShoppingDefinition:t.order.recurringShoppingDefinition}),s.jsx(ozt,{match:c,loading:d}),this.renderOrderDetailsActionsBox(),this.renderRefundRequestCard(),this.renderLoyaltyEarnings(),o?this.renderFiscalInvoiceCard():null]}),s.jsx(Kt,{breakpoint:"sm-up",remainInDom:!1,children:s.jsx(Y.Item,{colSpan:{xs:12,md:8},children:s.jsx("div",{className:"salt-m-t--4",children:this.renderProducts(m,g,f,y,I)})})})]}),t.order&&t.order.orderId&&s.jsxs(h.Fragment,{children:[s.jsx(QL,{orderId:t.order.orderId,sendPageView:!0}),s.jsx(zL,{})]}),n&&s.jsx(nne,{})]})}else if(t.error)return t.error.statusCode===404?s.jsx(lt,{}):s.jsx(ur,{});return null}}const yzt=e=>({basketProducts:Jn(e),areBasketProductsFetching:Vx(e),cartAdverts:e.data.adverts.cartPage,productsByProductId:ir(e),isServerRendered:Yt(e),order:Ds(e),products:$D(e),substituted:Y$e(e),missing:$$e(e),returned:H$e(e),requestedForRefund:Kk(e),paymentSummary:ac(e),getLoyaltyEarned:id,isLoyaltyEarningEnabled:rzt(e),isLoyaltyEarningMovedToSummaryEnabled:azt(e),isSelfServiceRefundEnabled:lzt(e),isRecurringOrdersEnabled:izt(e),loyaltyEarnings:id(e),bannerBusinessModel:Qi(e),retailerRegionId:ar(e),locale:Vs(e),showChangeSlotWhileEditing:czt(e),isExternal:Ag(e),hideExternalOrdersAlert:l0(e),isSummarySubtotalEnabled:dzt(e),isInvoiceRequestFormEnabled:pzt(e),isBasketViewDropdownEnabled:uzt(e),timeFormat:Vt(e),isOrderMultiPaymentsEnabled:mzt(e),isDeliveryWindowEnabled:hzt(e),isPlannedDeliveryWindowEnabled:gzt(e)}),Izt=ot({getBasketProducts:nc,getCartAdverts:I8,getOrder:Wo.getDecoratedOrderCall,fetchCreatedRefundRequest:Nm.fetchCreatedRefundRequest,sendAnalyticsEvent:U.analyticsEvent,openChangeStoreModal:e=>Z.openModal("changeStore",e),getRecurringShoppingDefinitions:qa.getRecurringShoppingDefinitions,getOrderMultiPayments:Dr.getOrderMultiPayments}),Szt=Ct(Bt,ke(yzt,Izt))(fzt),Czt="order-summary",n$="order-again",Tzt=e=>e.tab===n$?n$:Czt,_zt=()=>{const e=co(),t=E(Ds),[n,o]=fe(["mpv","rec.o"]),r=F(),a=Ne(),i=E(u=>lC(u,e.orderId)),[l]=fe(["onre"]);if(h.useEffect(()=>{t.order||r(Wo.getDecoratedOrderCall(e.orderId)),n&&r(Dr.getOrderMultiPayments(e.orderId)),o&&r(qa.getRecurringShoppingDefinitions())},[]),i)return s.jsx(z7,{});if(!l)return s.jsx(Szt,{match:{params:e}});const c=tt.parse(a.search),d=Tzt(c);return s.jsx(gKt,{match:{params:e},initialTab:d})},vzt=e=>s.jsx(os,{type:"OrderDetails::route",children:s.jsx(_zt,{...e})}),Azt=e=>[{path:"/orders/:orderId/details",Component:ws(Ze,e.Main),children:[{index:!0,Component:vzt}]}],bzt=()=>async e=>{try{await e(Yc.getRecurringShoppingPlaceholders())}catch{}},xzt=(e,t)=>n=>n(Yc.cancelRecurringOrderPlaceholder(e,t)),fl={cancelRecurringOrderPlaceholder:xzt,fetchRecurringShoppingPlaceholders:bzt},Rzt=T(se)`
    flex-grow: 1;
`,Dzt=T(b)`
    flex: 1 1 0;
`,Ozt=({children:e})=>{const t=ps({breakpoint:"sm-up"}),n=h.useMemo(()=>{const o=ie.Children.toArray(e);return t?o.reverse():o},[e,t]);return s.jsx(Rzt,{direction:"column",directionSmUp:"row",gap:["sm"],children:n})},na=Object.assign(Ozt,{Button:Dzt}),hne="cancelPlaceholderRecurringOrder",o$="cancel-recurring-order-placeholder-modal-header",Pzt=()=>{const e=We(),t=F(),n=wt(hne),{definitionId:o,referenceId:r,orderName:a}=n.options||{},[i,l]=h.useState(!1),c=async()=>{if(!(!o||!r)){l(!0);try{await t(Yc.cancelRecurringOrderPlaceholder(o,r)),await t(fl.fetchRecurringShoppingPlaceholders()),t(U.analyticsEvent({type:ht.PLACEHOLDER_RECURRING_ORDER_DETAILS_CANCEL_MODAL_EVENT,userAction:"Cancel",definitionID:o,referenceID:r})),n.close(),e(lo())}catch{z.error("orders.placeholder.recurring.order.cancel.error"),n.close()}l(!1)}},d=()=>{n.close(),t(U.analyticsEvent({type:ht.PLACEHOLDER_RECURRING_ORDER_DETAILS_CANCEL_MODAL_EVENT,userAction:"Close",definitionID:o,referenceID:r}))};return s.jsxs(G,{isOpen:n.isOpen,onRequestClose:d,aria:{labelledby:o$},asBottomSheet:!0,children:[s.jsx(G.Header,{align:"left",children:s.jsx(ne,{as:"h1",id:o$,children:s.jsx(_t,{id:"orders.placeholder.recurring.order.cancel.modal.title"})})}),s.jsx(G.Body,{children:s.jsx(Wa,{isLoading:i,children:a&&s.jsx(Ce,{intent:"info",text:s.jsx(v,{id:"orders.placeholder.recurring.order.cancel.modal.info",values:{orderName:a}})})})}),!i&&s.jsx(G.Footer,{children:s.jsxs(na,{children:[s.jsx(na.Button,{intent:"secondary",fill:!0,onClick:d,"data-test":"cancel-placeholder-recurring-order-modal-dismiss-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"orders.placeholder.recurring.order.cancel.modal.dismiss.button"})})}),s.jsx(na.Button,{fill:!0,intent:"primary","data-test":"cancel-placeholder-recurring-order-modal-confirm-button",onClick:c,children:s.jsx(b.Text,{children:s.jsx(v,{id:"orders.placeholder.recurring.order.cancel.modal.confirm.button"})})})]})})]})},Nzt=()=>{const e=F(),t=co(),n=E(u=>Jt(u)),o=E(u=>Vt(u)),r=E(u=>IWe(u,t.referenceId)),a=E(DO(t.definitionId));h.useEffect(()=>{r.isFetching||(e(fl.fetchRecurringShoppingPlaceholders()),e(qa.getRecurringShoppingDefinitions()))},[]);const i=u=>{const{orderAvailableAfter:m,timeZoneId:g}=u;return s.jsx(_t,{id:"order.details.upcoming.page.heading",values:{orderAvailableAfter:s.jsx(Fh,{dateIso:m,timeZoneId:g,dateFormat:n,timeFormat:o})}})},l=()=>r?s.jsxs(ne,{as:"h1",children:[s.jsx(me,{className:"salt-d--inline-block salt-m-r--2 salt-m-b--1 salt-m-l--1",name:"recurring_order",verticalAlign:"middle",width:38,height:38}),i(r.order?.dates)]}):null,c=()=>s.jsx(Y,{fixed:!0,children:s.jsx(Y.Item,{colStart:{md:4},colSpan:{xs:12,md:6},children:s.jsx(ln,{titleIcon:"orders",title:"order.details.upcoming.page.order.not.created.heading",description:"order.details.upcoming.page.order.not.created.body"})})}),d=r.order&&r.order.cancelable;return!r.error&&r.lastUpdated&&!r.isFetching?s.jsxs(h.Fragment,{children:[s.jsx(An,{children:l()}),s.jsxs(Y,{children:[s.jsx(cs,{breakpoint:"sm-up",remainInDom:!1,children:s.jsx(Y.Item,{className:"salt-m-t--16",colSpan:{xs:12,md:8},children:c()})}),s.jsx(Y.Item,{colSpan:{xs:12,md:4},children:s.jsxs("div",{children:[a&&s.jsx(hE,{className:"salt-m-t--4",orderId:a.definitionId,recurringShoppingDefinition:a}),s.jsx("div",{className:"salt-m-t--4",children:d&&s.jsx(ve,{children:s.jsx(b,{fill:!0,intent:"secondary","data-test":"recurring-order-placeholder-cancel-button",onClick:()=>e(Z.openModal(hne,{definitionId:r.order?.definitionId,referenceId:r.order?.referenceId,orderName:r.order?.definitionName})),children:s.jsx(b.Text,{children:s.jsx(v,{id:"recurring.order.cancel"})})})})})]})}),s.jsx(Kt,{breakpoint:"sm-up",remainInDom:!1,children:s.jsx(Y.Item,{className:"salt-m-t--16",colSpan:{xs:12,md:8},children:c()})})]}),d&&s.jsx(Pzt,{})]}):r.error?r.error.statusCode===404?s.jsx(lt,{}):s.jsx(ur,{}):null},gne=e=>s.jsx(os,{type:"PlaceholderRecurringOrderDetails::route",children:s.jsx(Nzt,{...e})});gne.fetchData=({context:{store:e}})=>{const t=e.getState();return Ze(t)?Promise.all([fl.fetchRecurringShoppingPlaceholders(),qa.getRecurringShoppingDefinitions()]):Promise.resolve()};const Ene=p.shape({definitionId:p.string,name:p.string,addressName:p.string,dates:p.shape({deliveryStartDate:p.string.isRequired,deliveryEndDate:p.string.isRequired,timeZoneId:p.string.isRequired}),referenceId:p.string,cancelable:p.bool}),fne=e=>(t,n,o)=>{if(t[n]==null){if(e)throw new Error(`Prop ${n} supplied to ${o} is required.`)}else if(!/\d\d:\d\d/.test(t[n]))return new Error(`Invalid prop ${n} supplied to ${o}. Validation failed.`);return null},Rb=fne(!1);Rb.isRequired=fne(!0);const Lzt=p.shape({isFetching:p.bool,lastUpdated:p.number,definitions:p.arrayOf(p.shape({definitionId:p.string.isRequired,name:p.string.isRequired,frequency:p.shape({unit:p.oneOf(O2e).isRequired,value:p.number.isRequired}).isRequired,deliveryWindow:p.shape({day:p.string.isRequired,dayOfWeekIso:p.number.isRequired,from:Rb.isRequired,to:Rb.isRequired}),addressName:p.string,cancelable:p.bool}))}),kzt=()=>e=>e(Fhe()).then(t=>t&&e(xH(t.payload.responseData.entities))),Mzt=e=>t=>t(Bhe(e)).then(n=>n&&t(xH(n.payload.responseData.entities))),nM={getPastOrders:kzt,getPastOrdersPage:Mzt},jzt={retentionPeriod:p.string},wzt={retentionPeriod:void 0},oM=({retentionPeriod:e})=>e?s.jsx(v,{id:`orders.list.past.retention.${e}`}):null;oM.propTypes=jzt;oM.defaultProps=wzt;const Fzt=(e,t)=>({retentionPeriod:t.retentionPeriod||iWe(e)}),yne=Ct(Bt,ke(Fzt))(oM),Bzt=({order:e,type:t,alertBanner:n,additionalInfo:o,onClick:r,carrierType:a})=>{const i=ze(),l=e.externalAddress?s.jsx(v,{id:"order.card.locker.name",values:{lockerName:e.externalAddress.externalCollectionPointId}}):e.addressNickName,c=()=>s.jsx(eE,{carrierType:a,dates:e.dates,showAsCardTitle:!0}),d=()=>s.jsx(v,{id:"order.card.contentLine1",values:{addressDetails:l,price:i(e.orderTotals.totalPrice)}});return s.jsx(xn,{"data-test":`order-card-${t}`,title:{text:c(),as:"h3",a11yText:s.jsx(v,{id:"orders.list.card.accessibility.title.label"})},description:d(),additionalInfo:o,icon:"third_party_shipping",alertBanner:n,onClick:r,to:gn(e.orderId)},e.orderId)},zo={EDITABLE:{message:"orders.list.card.status.future.editable",type:"action"},EDITABLE_NO_DATE:{message:"orders.list.card.status.future.editable.no.date",type:"action"},UNDER_EDIT:{message:"orders.list.card.status.future.under.edit",type:"action"},OTHER_UNDER_EDIT:{message:"orders.list.card.status.future.other.under.edit",type:"action"},EDIT_EXPIRED:{message:"orders.list.card.status.future.edit.expired",type:"info"},PICKED:{message:"orders.list.card.status.picked",type:"info"},PENDING_PAYMENT:{message:"orders.list.card.status.future.pending.payment",type:"info"},UNDELIVERED_FAST_DELIVERED:{message:"order.card.reserved.fast.delivery.alert",type:"info"},FAILED_PENDING_PAYMENT:{message:"orders.list.card.status.future.pending.payment.failed",type:"error"},CANCELLED:{message:"orders.list.status.cancelled",type:"error"},DELIVERED:{message:"orders.list.status.delivered",type:"success"},COLLECTED:{message:"orders.list.status.collected",type:"success"},SCRATCHED:{message:"orders.list.status.scratched",type:"error"}},Uzt=(e,t)=>t?`${e.recurringShoppingDefinition?.name}, ${e.addressNickName}, `:`${e.addressNickName}, `,Gzt=e=>e.status==="DELIVERED",$zt=e=>e.deliveryMethod===Et.clickAndCollect.method?zo.COLLECTED.message:zo.DELIVERED.message,Hzt=({order:e,isRecurring:t,isMultidaySlotIcon:n})=>e.slotType===Pa&&e.deliveryMethod===Et.vanDelivery.method?"on_demand":e.slotType===Pa&&e.deliveryMethod===Et.clickAndCollect.method||n?"express_collect":e.deliveryMethod===Et.clickAndCollect.method?"click_collect":t?"recurring_order":"home_delivery",Vzt=(e,t,n,o,r=!1,a=!1)=>{const i=e.status==="UNKNOWN",l=e.status==="FUTURE",c=e.deliveryInfo!==void 0,d=e.status==="DELIVERED",u=e.status==="CANCELLED",m=e.status==="SCRATCHED";if(!(i||d)){if(!d&&!u&&!m&&e.deliveryMethod==="HOME_DELIVERY"&&e.slotType===Pa&&(!e?.deliveryInfo||e?.deliveryInfo?.currentState==="NOT_APPLICABLE"))return{type:zo.UNDELIVERED_FAST_DELIVERED.type,text:()=>s.jsx(v,{id:zo.UNDELIVERED_FAST_DELIVERED.message})};if(c&&e.deliveryInfo.currentState!=="NOT_APPLICABLE"){const g=Ise(e,n,r,a);if(g?.text)return g}if(l){const g=e.editStatus==="EDITABLE"||e.editStatus==="OTHER_UNDER_EDIT",f=!!e.dates.confirmOrderChangesBy;return o(e.orderId)?{type:zo.FAILED_PENDING_PAYMENT.type,text:()=>s.jsx(v,{id:zo.FAILED_PENDING_PAYMENT.message})}:g&&f?{type:zo[e.editStatus].type,text:()=>s.jsx(v,{id:zo[e.editStatus].message,values:{editUntil:s.jsx(El,{dateIso:e.dates.confirmOrderChangesBy,timeZoneId:e.dates.timeZoneId,local:!0,dateFormat:t,timeFormat:n})}})}:g&&!f?{type:zo.EDITABLE_NO_DATE.type,text:()=>s.jsx(v,{id:zo.EDITABLE_NO_DATE.message})}:{type:zo[e.editStatus].type,text:()=>s.jsx(v,{id:zo[e.editStatus].message})}}return{type:zo[e.status].type,text:()=>s.jsx(v,{id:zo[e.status].message})}}},Yzt=(e,t,n,o=!1)=>n==="STORE"&&e.retailerRegionId!==t&&(e.editStatus==="EDITABLE"||o),Wzt=(e,t,n)=>{t.preventDefault();const o=`${window.location.origin}${od(e.retailerRegionId)}${gn(e.orderId)}`;n({redirectUrl:o,messages:{title:"orders.list.change.store.modal.title",message:"orders.list.change.store.modal.message",cancel:"orders.list.change.store.modal.cancel",confirm:"orders.list.change.store.modal.confirm"}})},rM=e=>{const{order:t,dateFormat:n,timeFormat:o,type:r,bannerBusinessModel:a,retailerRegionId:i,isOnlineReceiptEnabled:l,isMultidaySlotIcon:c,isDeliveryWindowEnabled:d,isPlannedDeliveryWindowEnabled:u,getFailedOrderPaymentsForOrder:m=()=>{}}=e,{formatMessage:g}=M(),f=F(),y=w=>f(Z.openModal("changeStore",w)),I=ze(),S=!!t.recurringShoppingDefinition,C=Vzt(t,n,o,m,d,u),_=Gzt(t)?()=>s.jsx(v,{id:$zt(t)}):void 0,A=w=>Yzt(t,i,a,l)?Wzt(t,w,y):void 0,x=E(Tg(t.shippingGroupType)),{isReady:R,carrierDetails:O}=Jg({carrierId:t.carrierId,shippingGroupType:t.shippingGroupType});if(x)return R?s.jsx(Bzt,{order:t,type:r,alertBanner:C?{intent:C.type,text:C.text?C.text():""}:void 0,additionalInfo:_?_():void 0,onClick:A,carrierType:O?.slotBookingComponent}):s.jsx(xn.Skeleton,{alertBanner:!!C,"data-test":"order-card-skeleton"});const N=()=>s.jsx(go,{dateIsoFrom:t.dates.deliveryStartDate,dateIsoTo:t.dates.deliveryEndDate,timeZoneId:t.dates.timeZoneId,dateFormat:n,timeFormat:o}),k=()=>s.jsxs(h.Fragment,{children:[Uzt(t,S),I(t.orderTotals.totalPrice)]}),j=()=>{if(t.slotType===Pa&&t.deliveryMethod===Et.vanDelivery.method){let w=g("order.card.reserved.fast.delivery.title",{time:So(t.dates.deliveryEndDate,t.dates.timeZoneId,vn)});return["DELIVERED","CANCELLED","SCRATCHED"].some(L=>L===t.status)&&(w=Hb(t.dates.deliveryEndDate,t.dates.timeZoneId,Xo,vn,!0)),{text:w,as:r==="past"?"h4":"h3",a11yText:w}}return{text:N(),as:r==="past"?"h4":"h3",a11yText:g("order.list.card.accessibility.title.label")}};return s.jsx(xn,{"data-test":`order-card-${r}`,title:j(),description:k(),additionalInfo:_?_():void 0,icon:Hzt({order:t,isRecurring:S,isMultidaySlotIcon:c}),alertBanner:C?{intent:C.type,text:C.text?C.text():""}:void 0,onClick:A,to:gn(t.orderId)})},qzt={action:p.func.isRequired};function aM(e){const{action:t}=e,n=h.useRef(null),o=r=>{r[0].isIntersecting&&t()};return h.useEffect(()=>{const r={root:null,rootMargin:"20px",threshold:0},a=new IntersectionObserver(o,r);return n.current&&a.observe(n.current),()=>n.current&&a.unobserve(n.current)}),s.jsx(h.Fragment,{children:s.jsx("div",{ref:n,"data-test":"order-list-infinite-scroll-hook-marker"})})}aM.propTypes=qzt;const Kzt=D("tx.nts"),zzt=D("onre"),Qzt={actions:p.shape({getPastOrdersPage:p.func.isRequired}).isRequired,pastOrders:p.shape({isFetching:p.bool,lastUpdated:p.number,nextPageToken:p.string,orders:p.arrayOf(p.oneOfType([Go,Ene]))}),isTaxInclusionNoteEnabled:p.bool.isRequired,isOnlineReceiptEnabled:p.bool.isRequired,monthOfYearFormat:p.string.isRequired},Xzt={pastOrders:{orders:[],isFetching:!1,nextPageToken:null}};function iM(e){const{monthOfYearFormat:t,pastOrders:n,isOnlineReceiptEnabled:o}=e,r=E(ar),a=E(Qi),i=E(Vt),l=_=>_.map(A=>({monthOfYear:So(A.dates.deliveryEndDate,A.dates.timeZoneId,t,null),order:A})).reduce((A,x)=>{const R=A.find(O=>O.monthOfYear===x.monthOfYear);return R?R.orders.push(x.order):A.push({monthOfYear:x.monthOfYear,orders:[x.order]}),A},[]).sort((A,x)=>le(x.orders[0].dates.deliveryEndDate)-le(A.orders[0].dates.deliveryEndDate)),c=(_,A,x)=>{const R=hp({deliveryMethod:_.deliveryMethod,slotType:_.slotType,start:_.dates.deliveryStartDate,end:_.dates.deliveryEndDate}),O={order:_,dateFormat:A,timeFormat:i,type:x,bannerBusinessModel:a,retailerRegionId:r,isOnlineReceiptEnabled:o,isMultidaySlotIcon:R};return s.jsx(rM,{...O})},d=(_,A)=>s.jsxs(h.Fragment,{children:[s.jsx("div",{className:"salt-m-y--4",children:s.jsx(P,{asChild:!0,bold:!0,size:"l",children:s.jsx("h3",{children:A})})}),s.jsx(Y,{flush:!0,children:_.map(x=>s.jsx(Y.Item,{colSpan:{xs:12,sm:6,md:4,lg:3},children:c(x,WI,"past")},x.orderId||x.definitionId))})]},A),u=_=>s.jsx("div",{className:"salt-m-y--2","data-test":"past-orders-container",children:l(_).map(A=>d(A.orders,A.monthOfYear))}),m=()=>s.jsx("div",{className:"salt-m-t--4",children:s.jsx(Rs,{"data-test":"order-list-spinner"})}),g=()=>s.jsx("div",{className:"salt-m-t--8",children:s.jsx(P,{asChild:!0,bold:!0,"data-test":"order-list-no-more-orders-label",children:s.jsx("h2",{children:s.jsx(v,{id:"orders.list.past.no.more.orders"})})})}),f=()=>!!n.nextPageToken&&n.nextPageToken!=="null",y=()=>!n.isFetching&&f(),I=()=>s.jsxs(h.Fragment,{children:[n.isFetching?m():null,f()?null:g()]}),S=()=>{e.actions.getPastOrdersPage({nextPageToken:n.nextPageToken})},C=()=>e.isTaxInclusionNoteEnabled&&s.jsx("div",{className:"salt-m-t--1 salt-d--block",children:s.jsx(P,{asChild:!0,children:s.jsx("h3",{children:s.jsx(v,{id:"orders.list.tax.inclusion.note"})})})});return n.orders.length?s.jsxs(h.Fragment,{children:[s.jsxs(se,{align:"baseline",className:"salt-m-y--4",children:[s.jsx("div",{className:"salt-m-r--4",children:s.jsxs(ne,{as:"h2",children:[s.jsx(v,{id:"orders.list.past.title"})," ",s.jsx(yne,{})]})}),C()]}),u(n.orders),I(),y()?s.jsx(aM,{action:S}):null]}):null}iM.propTypes=Qzt;iM.defaultProps=Xzt;const Zzt=e=>({pastOrders:c4(e),isTaxInclusionNoteEnabled:Kzt(e),isOnlineReceiptEnabled:zzt(e),monthOfYearFormat:a0(e)}),Jzt=ot({getPastOrdersPage:nM.getPastOrdersPage}),e4t=ke(Zzt,Jzt)(iM),_E=e=>e.data.recurringOrdersSignUp.form,gc=V(_E,e=>e.dialogType),Ine=V(_E,e=>MA.indexOf(e.dialogType)+1),ya=V(_E,e=>e.data),t4t=V(_E,e=>e.orderComplete),s4t=V(_E,e=>e.paymentAuthUrl),n4t=e=>t=>{t(Hp.setState({dialogType:e}))},o4t=(e,t)=>{const n=t(),o=gc(n),a=MA.indexOf(o)-1;if(a<0)return;const i=MA[a];e(Hp.setState({dialogType:i}))},r4t=e=>t=>{t(Hp.setState({data:e}))},a4t=e=>t=>{t(Hp.setState({orderComplete:e}))},i4t=e=>t=>{t(Hp.setState({paymentAuthUrl:e}))},$t={setDialogType:n4t,onPrevStep:o4t,setFormData:r4t,setOrderCompleteData:a4t,setPaymentAuthUrl:i4t},l4t=({children:e,step:t})=>s.jsxs(ne,{as:"h2",children:[s.jsx("span",{"data-test":"ro-sign-up-progress-indicator-header",children:e}),s.jsx(Ee,{children:s.jsx(v,{id:"recurring.orders.sign.up.progress.indicator",values:{step:t,numberOfSteps:G5}})})]}),{getPercentageFromFractionString:c4t}=ga,d4t={[it.ADDRESS]:"recurring.orders.sign.up.step.title.address",[it.FREQUENCY]:"recurring.orders.sign.up.step.title.frequency",[it.SLOT_BOOKING]:"recurring.orders.sign.up.step.title.daytime",[it.SUMMARY]:"recurring.orders.sign.up.step.title.summary"},u4t=T.div`
    display: flex;
    align-items: center;
    gap: var(--salt-spacing-2);
`,QT=()=>{const e=E(Ine),t=E(gc),n=`${e} / ${G5}`,o=d4t[t];return s.jsxs(u4t,{className:"salt-m-b--4",children:[s.jsx("div",{"aria-hidden":"true",children:s.jsx(oc,{progressValue:c4t(n),autoProgress:!1,size:44,children:s.jsx(P,{bold:!0,children:n})})}),s.jsx(l4t,{step:e,children:s.jsx(_t,{id:o})})]})},r$={1:"WEEK",2:"WEEKS",3:"WEEKS",4:"WEEKS"},XT=()=>{const{formatMessage:e}=M();return t=>t.unit==="WEEKS"&&Object.keys(r$).includes(t.value.toString())?e(`orders.list.recurring.order.frequency.every.${t.value}.${t.unit.toLowerCase()}`):`${t.value} ${r$[t.value]}`},p4t=e=>E(px).find(o=>o.deliveryDestinationId===e)?.name||"",m4t=e=>{const t=E(ZZ),n=XT(),o=t.frequencies.find(({value:r})=>r===e.value);return o?n(o):""},h4t=e=>{const{slots:t}=E(HL),n=t.find(r=>r.slotId===e);return n?`${n.dayOfWeek[0]+n.dayOfWeek.substring(1).toLowerCase()} ${n.from} - ${n.to}`:""},g4t=T.ul`
    display: block;
    margin: 0;
    margin-block-end: 15px;
    padding: 0;
    list-style: none;
`,E4t=T.li`
    margin-block-end: 8px;
`,f4t=()=>{const{formatMessage:e}=M(),t=F(),n=E(ya),o=h4t(n.slotId),r=m4t(n.frequency),i=[{label:"recurring.orders.sign.up.summary.address",value:p4t(n.deliveryDestinationId)},{label:"recurring.orders.sign.up.summary.frequency",value:r},{label:"recurring.orders.sign.up.summary.daytime",value:o}],l=m=>{m.preventDefault();const g=new FormData(m.currentTarget).get("recurring-order-name")?.toString()??"";t($t.setFormData({...n,name:g})),t($t.setDialogType(it.PAYMENT))},c=e("salt.form.text-field.clear-button.a11y.label"),d=e("recurring.orders.sign.up.summary.name.field.placeholder"),u=e("recurring.orders.sign.up.summary.name.field.label");return s.jsxs(h.Fragment,{children:[s.jsxs(G.Body,{children:[s.jsx(QT,{}),s.jsx(g4t,{children:i.map(({label:m,value:g})=>s.jsx(E4t,{children:s.jsxs(P,{size:"l",children:[s.jsxs("span",{children:[s.jsx(v,{id:m}),":"]})," ",s.jsx("b",{children:g})]})},m))}),s.jsx(Ce,{intent:"info",text:s.jsx(v,{id:"recurring.orders.sign.up.summary.info"})}),s.jsx(Zn,{className:"salt-m-y--4"}),s.jsx(mt,{id:"ro-name-form",onSubmit:l,children:s.jsx(mt.TextField,{placeholder:d,name:"recurring-order-name",label:{text:u},clearButton:{ariaLabel:c}})})]}),s.jsx(G.Footer,{children:s.jsx(b,{fill:!0,type:"submit",intent:"primary",children:s.jsx(b.Text,{children:s.jsx(v,{id:"recurring.orders.sign.up.summary.payment.button"})})})})]})},vE=({children:e})=>s.jsx(G.Header,{align:"left",children:e}),y4t=T.span`
    vertical-align: middle;
`,I4t=({slotId:e})=>{const t=M(),n=F(),o=E(gc),a=E(Ine)>1,i=async()=>{o===it.SUMMARY&&e&&await n(ao.releaseSlot(e)),n($t.onPrevStep)},l=t.formatMessage("recurring.orders.sign.up.show.previous.step.aria.label");return s.jsxs(ne,{as:"h1",id:dc,children:[a&&s.jsx(b,{size:"s",fill:!1,intent:"tertiary","data-test":"icon__arrow_left",onClick:i,"aria-label":l,className:"salt-m-r--2",children:s.jsx(b.Icon,{name:"arrow_left"})}),s.jsx(y4t,{children:s.jsx(v,{id:"recurring.orders.sign.up.create.recurring.order"})})]})},a$=({children:e})=>{const t=E(ya);return s.jsxs(h.Fragment,{children:[s.jsx(vE,{children:s.jsx(I4t,{slotId:t?.slotId})}),e]})},S4t=T.div`
    display: flex;
    text-align: start;
`,C4t=()=>s.jsx(S4t,{children:s.jsx(ne,{as:"h1",id:dc,children:s.jsx(v,{id:"recurring.orders.sign.up.payment.header"})})}),T4t=({details:e})=>(t,n)=>{const o=n(),r=Wt(o),a={"client-route-id":wa(o),"X-CSRF-TOKEN":Va(o),"content-Type":"application/json"};return fetch(Ii({basePath:r,target:"/recurringshopping/v1/web/signup/complete"}),{credentials:"same-origin",method:"POST",headers:a,body:JSON.stringify({details:e})}).then(i=>i.json().then(l=>({response:i,data:l}))).then(({response:i,data:l})=>{if(i&&!i.ok){const c=new Error;return c.message=l.message,Promise.reject(c)}return l}).catch(i=>{const l=i.message&&mS(i.message)?i.message:"order.cow.3ds.error";z.error(l)})},Sne={complete3ds:T4t},_4t=()=>{const e=F(),t=M(),n=E(ya),o=E(s4t),{paymentOption:r,paymentType:a}=E(jp),i=E(Dg),{deliveryDestinationId:l,name:c,slotId:d,frequency:{unit:u,value:m},dayOfWeek:g}=n,f=new VL,y={deliveryDestinationId:l,redirectUrl:lo(),frequency:{unit:u,value:m},name:c||t.formatMessage("recurring.orders.definition.default.name",{dayOfWeek:g}),slotId:d,group:r,type:a||"UNKNOWN",toSave:[ct.PAY_NOW,ct.UNKNOWN].includes(r)&&i,walletItemId:null},I=()=>{z.error("toast.notification.generic.error"),e($t.setDialogType(void 0))},S=async x=>{try{const R=await e(ao.checkout(x)),{url:O}=R.payload.responseData;return f.initiatePaymentAuthentication({authenticationUrl:O})}catch{return I(),null}},C=x=>{switch(x.eventType){case an.PAYMENT_REQUESTED:e($t.setPaymentAuthUrl(void 0));break;case an.PAYMENT_CANCELLED:I();break;case an.INITIATE_AUTHENTICATION:e($t.setPaymentAuthUrl(x.payload.authenticationUrl));break}};h.useEffect(()=>(o||(S(y),f.subscribe(C)),()=>f.unsubscribe(C)),[]);const _=o&&{state:{pspweb:{url:o}}},A=async x=>{try{const R=await e(Sne.complete3ds({details:x}));return e($t.setOrderCompleteData(R)),e($t.setDialogType(it.ORDER_CONFIRMATION)),R}catch(R){throw z.error("toast.notification.generic.error"),R}};return s.jsx(Wa,{isLoading:!_,children:s.jsx(kT,{messageCallback:A,errorCallback:I,redirectUrlConfig:{url:lo(),text:t.formatMessage("recurring.orders.sign.up.payment.return.to.your.orders")},location:_,inModal:!0})})},v4t=()=>s.jsxs(h.Fragment,{children:[s.jsx(vE,{children:s.jsx(C4t,{})}),s.jsx(G.Body,{children:s.jsx(_4t,{})})]}),A4t=({date:e,address:t,price:n})=>s.jsxs(ve,{children:[s.jsx(P,{size:"l",bold:!0,children:e}),s.jsx("div",{className:"salt-m-t--4 salt-m-b--4",children:s.jsx(P,{size:"l",children:t})}),s.jsx(P,{size:"l",bold:!0,children:n}),s.jsxs(P,{size:"l",children:[" (",s.jsx(v,{id:"recurring.orders.sign.up.created.charge.info"}),")"]}),s.jsx(Ce,{intent:"warning",className:"salt-m-t--4",text:s.jsx(v,{id:"recurring.orders.sign.up.created.info"})})]}),ZT=(e,t)=>{const n=t();switch(gc(n)){case it.ADDRESS:e($t.setDialogType(it.ADDRESS_CLOSE));return;case it.ADDRESS_CLOSE:e($t.setDialogType(it.ADDRESS));break;case it.FREQUENCY:e($t.setDialogType(it.FREQUENCY_CLOSE));return;case it.FREQUENCY_CLOSE:e($t.setDialogType(it.FREQUENCY));break;case it.SLOT_BOOKING:e($t.setDialogType(it.SLOT_BOOKING_CLOSE));return;case it.SLOT_BOOKING_CLOSE:e($t.setDialogType(it.SLOT_BOOKING));break;case it.SUMMARY:e($t.setDialogType(it.SUMMARY_CLOSE));return;case it.SUMMARY_CLOSE:e($t.setDialogType(it.SUMMARY));break;case it.PAYMENT:e($t.setDialogType(it.PAYMENT_CLOSE));return;case it.PAYMENT_CLOSE:e($t.setDialogType(it.PAYMENT));break;case it.ORDER_CONFIRMATION:window.location.reload();break;default:e($t.setDialogType(void 0))}},b4t=T(xn)`
    block-size: unset !important;
`,x4t=({data:e})=>{const t=F(),n=ze(),o=XT(),r=E(px),{definition:{name:a,frequency:i,deliveryWindow:l},order:{deliveryAddress:c,deliveryWindow:d,price:u}}=e,m=o(i),g=D8e[l.day],f=gd(g,Ma),y=`${l.from} - ${l.to}`,I=`${m}, ${f} ${y}`,S=r.find(O=>O.addressId===c.addressId),C=`${c.nickname} - ${S?.formattedAddress}`,_=So(d.startDateTime||Ll(),d.timezone||"UTC",YI),A=$b(d.endDateTime||Ll(),d.timezone||"UTC",vn),x=`${_} - ${A}`,R=n(u.final);return s.jsxs(h.Fragment,{children:[s.jsx(b4t,{icon:"recurring_order",title:{text:a,as:"h3"},description:I,to:lo(),onClick:()=>t(ZT),className:"salt-m-b--2"}),s.jsx(P,{bold:!0,size:"l",children:s.jsx(v,{id:"recurring.orders.sign.up.created.upcoming.order"})}),s.jsx(A4t,{date:x,address:C,price:R})]})},R4t=({data:e})=>{const t=!!e?.definition?.name;return s.jsx(G.Body,{children:s.jsxs(se,{gap:["sm"],additionalCss:"inline-size: 100%;",children:[s.jsx(P,{bold:!0,size:"l",children:s.jsx(v,{id:"recurring.orders.sign.up.created.ro.header"})}),t?s.jsx(x4t,{data:e}):s.jsx(ve,{children:s.jsx(v,{id:"recurring.order.currently.not.visible"})})]})})},D4t=T.span`
    vertical-align: middle;
`,O4t=()=>s.jsx(vE,{children:s.jsxs(ne,{as:"h1",id:dc,children:[s.jsx(me,{name:"status_yes",height:24,width:24,success:!0,verticalAlign:"middle",className:"salt-m-r--2"}),s.jsx(D4t,{children:s.jsx(_t,{id:"recurring.orders.sign.up.created.title"})})]})}),P4t=()=>{const e=E(t4t),{definition:t}=e,n=F(),{isGA4EventSent:o,setIsGA4EventSent:r}=EJ();return h.useEffect(()=>{if(t&&!o){n(U.analyticsEvent({type:ht.RECURRING_ORDER_CREATED_GA4_EVENT,recurringShoppingDefinition:e.definition,recurringOrderType:Pl.SMART_SHOP}));const a={event:"recurring_order_creation",type:Pl.SMART_SHOP,frequency:_S(e.definition.frequency)??"",slot_day:vS(e.definition.deliveryWindow)??0,slot_start_time:e.definition.deliveryWindow?.from,slot_end_time:e.definition.deliveryWindow?.to};J.sendEvent({GA:a,WA:null}),r()}},[t,n,o,r]),s.jsxs(h.Fragment,{children:[s.jsx(O4t,{}),s.jsx(R4t,{data:e})]})},Cne=({onClick:e,children:t})=>s.jsx(b,{intent:"primary",onClick:e,fill:!0,children:s.jsx(b.Text,{children:t})}),N4t=()=>s.jsx(b,{asChild:!0,intent:"secondary",fill:!0,className:"salt-m-t--4",children:s.jsx(Qe,{intent:"ghost",href:Na(),children:s.jsx(b.Text,{children:s.jsx(v,{id:"recurring.orders.sign.up.add.new.address"})})})}),L4t=({addresses:e})=>{const t=F(),n=E(ya),{formatMessage:o}=M();h.useEffect(()=>{const c=e?.[0]?.deliveryDestinationId;!n.deliveryDestinationId&&c&&t($t.setFormData({...n,deliveryDestinationId:c}))},[e]);const r=e?.filter(el)??[];if(!r.length)return null;const a=r.map(c=>({value:c.deliveryDestinationId,label:c.name,additionalText:c.formattedAddress,disabled:!1})),i=n.deliveryDestinationId??"",l=c=>{t($t.setFormData({...n,deliveryDestinationId:c}))};return s.jsx(ve,{children:s.jsx(mt.RadioGroup,{groupLabel:{text:o("recurring.orders.sign.up.step.title.address"),isVisuallyConcealed:!0},name:"delivery-address",radios:a,value:i,onChange:l})})},k4t=()=>{const e=E(Ei),t=e.data?Object.values(e.data):[],n=LT(sn.getHomeDeliveryDestinations());return[t,n]},M4t=()=>{const e=F(),[t,n]=k4t();return s.jsxs(h.Fragment,{children:[s.jsxs(G.Body,{children:[s.jsx(QT,{}),s.jsxs(Wa,{isLoading:n,children:[s.jsx(L4t,{addresses:t}),s.jsx(N4t,{})]})]}),!n&&s.jsx(G.Footer,{children:s.jsx(Cne,{onClick:()=>e($t.setDialogType(it.FREQUENCY)),children:s.jsx(v,{id:"recurring.orders.sign.up.next.button"})})})]})},j4t=e=>{const t=E(HL),n=LT(ao.getSlots(e));return[t,n]},w4t=({recurringSlots:e})=>{const t=M(),n=E(ya),{slots:o}=e,r=o?.find(({slotId:c})=>n.slotId===c),a=h.useMemo(()=>{if(!r)return{intent:"info",message:t.formatMessage("recurring.orders.sign.up.slotbooking.order.info")};const c=s.jsx("strong",{children:So(r.slotStartDateTime,r.timeZoneId,YI)});return{intent:"info",message:t.formatMessage("recurring.orders.sign.up.slotbooking.delivery.date",{deliveryDate:c})}},[n.slotId,n.dayOfWeek,r]),{intent:i,message:l}=a;return i?s.jsx(Ce,{intent:i,text:l}):null},i$=["part1","part2","part3"],F4t=({slots:e,error:t,setFieldTouched:n})=>{const o=M(),r=F(),{signUpDays:a}=E(HL),i=E(ya),l=a.includes(i.dayOfWeek),c=o.formatMessage("recurring.orders.sign.up.slotbooking.time.label"),d=o.formatMessage("recurring.orders.sign.up.slotbooking.time.placeholder"),u=({value:S})=>{const C=e.find(({slotId:_})=>_===S);C&&r($t.setFormData({...i,slotId:C.slotId,from:C.from,to:C.to}))};h.useEffect(()=>{if(i.dayOfWeek&&i.from&&i.to){const S=e.find(({from:C,to:_,dayOfWeek:A})=>A===i.dayOfWeek&&C===i.from&&_===i.to);if(S){r($t.setFormData({...i,slotId:S.slotId}));return}}r($t.setFormData({...i,slotId:"",from:"",to:""}))},[]);const m=e?.filter(({dayOfWeek:S})=>S===i.dayOfWeek).reduce((S,C)=>({...S,[C.partOfDayId]:[...S[C.partOfDayId],C]}),{part1:[],part2:[],part3:[]}),g=()=>n(S=>({...S,slotId:!0})),f=S=>m[S].map(({slotId:C,from:_,to:A})=>({value:C,name:`${_} - ${A}`})),y=i$.map(S=>({section:o.formatMessage(`slotbooking.table.part.of.day.${S}`),options:f(S)})),I=i$.map(S=>f(S)).flat().find(({value:S})=>S===i.slotId);return l?s.jsx(mt.DropdownSelect,{error:t,name:"slot-time",options:y,onFocus:g,className:"salt-m-b--4",placeholder:d,onOptionChange:u,value:I??{name:"",value:""},label:{text:c,isVisuallyConcealed:!1}}):null},B4t=({recurringSlots:e,error:t,setFieldTouched:n})=>{const o=M(),r=F(),{signUpDays:a,slots:i}=e,l=E(ya),c=E(Vs),d=o.formatMessage("recurring.orders.sign.up.slotbooking.day.label"),u=o.formatMessage("recurring.orders.sign.up.slotbooking.day.placeholder"),m=({value:_})=>{r($t.setFormData({...l,dayOfWeek:_,slotId:""})),n(A=>({...A,slotId:!1}))},g=_=>_[0]+_.substring(1).toLowerCase(),f=_=>a.includes(_)&&i.filter(A=>A.dayOfWeek===_).length,I=[...Array(7).keys()].map(_=>Zr().locale(c||"en-GB").weekday(_).format("dddd").toUpperCase()).map(_=>({name:g(_),additionalInfo:f(_)?"":o.formatMessage("recurring.orders.sign.up.slotbooking.no.available.slots"),value:_,disabled:!f(_)})),S=I.find(_=>_.value===l.dayOfWeek),C=()=>{n(_=>({..._,dayOfWeek:!0}))};return s.jsx(mt.DropdownSelect,{id:"slot-day",error:t,name:"slot-day",options:I,onFocus:C,value:S,className:"salt-m-b--4",label:{text:d},placeholder:u,onOptionChange:m})},U4t=()=>{const e=M(),t=F(),n=E(ya),[o,r]=j4t(n.deliveryDestinationId),[a,i]=h.useState(!1),[l,c]=h.useState(()=>({dayOfWeek:"",slotId:""})),[d,u]=h.useState({dayOfWeek:!1,slotId:!1});h.useEffect(()=>{i(!1),c(I=>({...I,dayOfWeek:"",slotId:""}))},[d,n]);const m=()=>c(I=>({...I,[n.dayOfWeek?"slotId":"dayOfWeek"]:e.formatMessage(`recurring.orders.sign.up.slotbooking.${n.dayOfWeek?"time":"day"}.selector.error`)})),g=()=>(m(),!!n.dayOfWeek&&!!n.slotId),f=async I=>{if(I.preventDefault(),!!g()){i(!0);try{await t(ao.reserveSlot(n.deliveryDestinationId,n.slotId)),t($t.setDialogType(it.SUMMARY))}catch{z.error("toast.notification.generic.error")}i(!1)}},y=r||a;return s.jsxs(h.Fragment,{children:[s.jsxs(G.Body,{children:[s.jsx(QT,{}),s.jsxs(Wa,{isLoading:y,children:[s.jsxs(mt,{onSubmit:f,id:"ro-sign-up-slot-booking-form",noValidate:!0,children:[s.jsx(B4t,{recurringSlots:o,error:l.dayOfWeek,setFieldTouched:u}),s.jsx(F4t,{error:l.slotId,setFieldTouched:u,slots:o.slots})]}),s.jsx(w4t,{recurringSlots:o})]})]}),!y&&s.jsx(G.Footer,{children:s.jsx(b,{fill:!0,intent:"primary",type:"submit",form:"ro-sign-up-slot-booking-form",children:s.jsx(b.Text,{children:s.jsx(v,{id:"recurring.orders.sign.up.next.button"})})})})]})},G4t=({deliveryFrequency:e})=>{const t=F(),n=E(ya),o=XT(),{formatMessage:r}=M();if(h.useEffect(()=>{n.frequency.value==="-1"&&t($t.setFormData({...n,frequency:{value:e[0]?.value??"-1",unit:e[0]?.unit??""}}))},[e]),!e?.length)return null;const a=e.map(c=>({value:String(c.value),label:o(c)})),i=String(n.frequency.value),l=c=>{const d=e.find(u=>String(u.value)===c);d&&t($t.setFormData({...n,frequency:{value:d.value,unit:d.unit}}))};return s.jsx(ve,{children:s.jsx(mt.RadioGroup,{groupLabel:{text:r("recurring.orders.sign.up.step.title.frequency"),isVisuallyConcealed:!0},name:"delivery-frequency",radios:a,value:i,onChange:l})})},$4t=()=>{const e=F(),[t,n]=JZ();return s.jsxs(h.Fragment,{children:[s.jsxs(G.Body,{children:[s.jsx(QT,{}),s.jsx(Wa,{isLoading:n,children:s.jsx(G4t,{deliveryFrequency:t?.frequencies})})]}),!n&&s.jsx(G.Footer,{children:s.jsx(Cne,{onClick:()=>e($t.setDialogType(it.SLOT_BOOKING)),children:s.jsx(_t,{id:"recurring.orders.sign.up.next.button"})})})]})},H4t=()=>{const e=E(gc);return s.jsxs(h.Fragment,{children:[e===it.ADDRESS&&s.jsx(M4t,{}),e===it.FREQUENCY&&s.jsx($4t,{}),e===it.SLOT_BOOKING&&s.jsx(U4t,{})]})},V4t=()=>{const e=h.useRef(null);return h.useEffect(()=>{e.current&&e?.current?.nextSibling?.remove()},[e.current]),s.jsx(ne,{as:"h1",id:dc,ref:e,children:s.jsx(_t,{id:"recurring.orders.sign.up.closing.confirmation.title"})})},Y4t=()=>s.jsx(P,{children:s.jsx(_t,{id:"recurring.orders.sign.up.closing.confirmation.content"})}),W4t=({onConfirm:e})=>{const t=F();return s.jsxs(na,{children:[s.jsx(na.Button,{intent:"secondary",fill:!0,onClick:()=>t(ZT),children:s.jsx(b.Text,{children:s.jsx(_t,{id:"recurring.orders.sign.up.close.cancel"})})}),s.jsx(na.Button,{intent:"primary",fill:!0,onClick:()=>e(),children:s.jsx(b.Text,{children:s.jsx(_t,{id:"recurring.orders.sign.up.close.confirm"})})})]})},q4t=({type:e,closeConfirmed:t,slotId:n})=>{const o=F(),r=()=>{e===it.SUMMARY_CLOSE&&o(ao.releaseSlot(n)),t()};return s.jsxs(ie.Fragment,{children:[s.jsx(vE,{children:s.jsx(V4t,{})}),s.jsx(G.Body,{children:s.jsx(Y4t,{})}),s.jsx(G.Footer,{children:s.jsx(W4t,{onConfirm:r})})]})},K4t=T.span`
    vertical-align: middle;
`,z4t=()=>s.jsxs(ne,{as:"h1",id:dc,children:[s.jsx(me,{height:24,width:24,name:"recurring_order",verticalAlign:"middle",className:"salt-m-r--2"}),s.jsx(K4t,{children:s.jsx(_t,{id:"recurring.orders.sign.up.learn.more.header"})})]}),Q4t=()=>s.jsxs(zs,{gap:["xs"],additionalCss:"inline-size: 100%;",children:[s.jsx(P,{bold:!0,children:s.jsx(v,{id:"recurring.orders.sign.up.learn.more.slot.header"})}),s.jsx(P,{className:"salt-m-b--2",children:s.jsx(v,{id:"recurring.orders.sign.up.learn.more.slot.content"})}),s.jsx(P,{bold:!0,children:s.jsx(v,{id:"recurring.orders.sign.up.learn.more.smart.header"})}),s.jsx(P,{className:"salt-m-b--2",children:s.jsx(v,{id:"recurring.orders.sign.up.learn.more.smart.content"})}),s.jsx(P,{bold:!0,children:s.jsx(v,{id:"recurring.orders.sign.up.learn.more.control.header"})}),s.jsx(P,{children:s.jsx(v,{id:"recurring.orders.sign.up.learn.more.control.content"})})]}),X4t=()=>{const e=F();return E(XZ)?.smart?.eligible?s.jsx(G.Footer,{children:s.jsx(b,{intent:"primary",fill:!0,onClick:()=>e($t.setDialogType(it.ADDRESS)),children:s.jsx(b.Text,{children:s.jsx(_t,{id:"recurring.orders.sign.up.create.recurring.order"})})})}):null},Z4t=()=>s.jsxs(h.Fragment,{children:[s.jsx(vE,{children:s.jsx(z4t,{})}),s.jsx(G.Body,{children:s.jsx(Q4t,{})}),s.jsx(X4t,{})]}),J4t=[it.ADDRESS_CLOSE,it.FREQUENCY_CLOSE,it.SLOT_BOOKING_CLOSE,it.SUMMARY_CLOSE,it.PAYMENT_CLOSE],e3t=()=>{const e=E(gc),t=F(),n=E(ya),o=E(D("pay.ywlt"));return e===it.PAYMENT&&o||!e?null:J4t.includes(e)?s.jsx(q4t,{type:e,closeConfirmed:()=>{t($t.setDialogType(void 0)),t($t.setFormData($5)),t($t.setPaymentAuthUrl(void 0))},slotId:n.slotId}):e===it.LEARN_MORE?s.jsx(Z4t,{}):e===it.SUMMARY?s.jsx(a$,{children:s.jsx(f4t,{})}):e===it.PAYMENT?s.jsx(v4t,{}):e===it.ORDER_CONFIRMATION?s.jsx(P4t,{}):s.jsx(a$,{children:s.jsx(H4t,{})})},Tne=()=>{const e=Ne(),t=We();return h.useCallback(n=>{const o=new URLSearchParams(e.search);o.has(n)&&(o.delete(n),t({search:o.toString()},{replace:!0}))},[e,t])},t3t=()=>{const e=M(),t=F(),n=E(ya),{paymentOption:o,paymentType:r}=E(jp),a=E(Dg),i=Tne(),l=()=>{i("recoveryToken"),t(Z.closeModal()),t($t.setDialogType(void 0)),setTimeout(()=>t($t.setDialogType(it.PAYMENT)),0)},c=C=>{t($t.setOrderCompleteData(C)),t(Z.closeModal()),t($t.setDialogType(it.ORDER_CONFIRMATION))},{deliveryDestinationId:d,name:u,slotId:m,frequency:{unit:g,value:f},dayOfWeek:y}=n,I=async C=>{const _={deliveryDestinationId:d,redirectUrl:`${window.location.origin}${lo()}`,frequency:{unit:g,value:f},name:u||e.formatMessage("recurring.orders.definition.default.name",{dayOfWeek:y}),slotId:m,group:o,type:r||"UNKNOWN",toSave:[ct.PAY_NOW,ct.UNKNOWN].includes(o)&&a,walletItemId:C};try{const x=(await t(ao.checkout(_))).payload.responseData;if("url"in x)return x.url;c(x);return}catch(A){throw z.error("toast.notification.generic.error"),A}},S=async C=>t(Sne.complete3ds({details:C})).then(c).catch(_=>{throw z.error("toast.notification.generic.error"),_});return s.jsx(Gk,{modalsTitle:e.formatMessage("recurring.orders.sign.up.payment.header"),confirmPaymentMethodText:e.formatMessage("recurring.orders.sign.up.payment.confirm"),onInitiatePayment:I,onAuthFailure:l,onAuthCompleted:S,isTaxGrossDisplayed:!1,onClosePaymentMethodPicker:()=>t(ZT),asBottomSheet:!0})},s3t=()=>{const e=E(gc),t=E(D("pay.ywlt")),n=F(),o=!!e&&(!t||e!==it.PAYMENT),r=()=>{n(Z.openModal("recurring-orders-sign-up"))},a=()=>{n(ZT)};return h.useEffect(()=>{t&&e===it.PAYMENT&&n(kt.initiatePayment())},[e]),s.jsxs(h.Fragment,{children:[s.jsx(G,{asBottomSheet:!0,isOpen:o,onAfterOpen:r,onRequestClose:a,aria:{labelledby:dc},children:s.jsx(e3t,{})}),t&&e===it.PAYMENT&&s.jsx(t3t,{})]})},n3t=({hasRecurringShoppingDefinitions:e,isEligible:t})=>{const n=F(),o=M(),i=ll()==="xs"&&e;return s.jsxs("div",{className:i?"salt-d--flex":"",children:[t&&s.jsx(b,{fill:!0,intent:"primary",onClick:()=>n($t.setDialogType(it.ADDRESS)),className:"salt-m-y--1",children:s.jsx(b.Text,{children:o.formatMessage("recurring.orders.sign.up.create.recurring.order")})}),s.jsxs(b,{intent:"secondary",fill:!i,onClick:()=>n($t.setDialogType(it.LEARN_MORE)),className:`${i?"salt-m-l--2":""} salt-m-y--1`,children:[e&&s.jsx(b.Icon,{name:"info_default"}),s.jsxs(b.Text,{className:e?"xs:max-sm:salt-vc":"",children:[s.jsx(v,{id:"recurring.orders.sign.up.learn.more"}),s.jsx(Ee,{children:o.formatMessage("recurring.orders.sign.up.learn.more.about.recurring.orders")})]})]})]})},o3t=T(He.Action.Footer)`
    margin-block-start: ${({hasRecurringShoppingDefinitions:e})=>e&&0};
`,r3t=({isEligible:e,hasRecurringShoppingDefinitions:t,children:n})=>s.jsxs(He.Action,{xs:1,sm:2,md:3,lg:4,children:[n,s.jsx(o3t,{hasRecurringShoppingDefinitions:t,children:s.jsx(n3t,{hasRecurringShoppingDefinitions:t,isEligible:e})})]}),a3t=({hasRecurringShoppingDefinitions:e})=>s.jsx(Ce,{size:"s",text:s.jsx(v,{id:e?"recurring.orders.sign.up.unavailable.at.the.moment":"recurring.orders.sign.up.feature.unavailable"})}),i3t=(e,t,n,o)=>{const r=M();return h.useMemo(()=>e?t?{title:"",description:""}:{title:r.formatMessage("recurring.orders.sign.up.title"),description:s.jsx("p",{children:s.jsx(v,{id:"recurring.orders.sign.up.description"})})}:o?n?{title:r.formatMessage("recurring.orders.sign.up.title"),description:s.jsx("p",{children:s.jsx(v,{id:"recurring.orders.sign.up.after.next.order.description"})})}:{title:r.formatMessage("recurring.orders.sign.up.title"),description:s.jsx("p",{children:s.jsx(v,{id:"recurring.orders.sign.up.after.first.order.description"})})}:{title:r.formatMessage("recurring.orders.sign.up.title"),description:""},[e,o,t,n])},l3t=()=>{const e=E(XZ),t=LT(ao.getEligibility());return[e,t]},c3t=T(He.Action.Header)`
    justify-content: flex-start;
    text-align: initial;
`,d3t=T(He.Action.Body)`
    text-align: initial;
`,u3t=({headerSection:e})=>s.jsxs(ie.Fragment,{children:[e.title&&s.jsx(c3t,{singleLine:!0,children:s.jsx(He.Action.HeaderText,{as:"h2",children:s.jsx(ne,{as:"span",children:e.title})})}),e.description&&s.jsx(d3t,{children:s.jsx(P,{className:"salt-m-y--4",asChild:!0,size:"l",children:e.description})})]}),p3t=T(He.Action.Header)`
    justify-content: flex-start;
    text-align: initial;
`,m3t=T(He.Action)`
    justify-content: flex-start;
`,h3t=({hasRecurringShoppingDefinitions:e,hasPastOrders:t})=>{const[n,o]=l3t(),r=E(u=>u.session.isSuperuser),a=n?.smart?.eligible,i=n?.smart?.reason,l=i==="NO_ORDER_HISTORY",c=i3t(a,e,t,l);return o?s.jsx(He.Action.Skeleton,{xs:1,sm:2,md:3,lg:4}):!a&&l&&e||r?null:a||i==="NO_ORDER_HISTORY"?s.jsx(r3t,{isEligible:a,hasRecurringShoppingDefinitions:e,children:s.jsx(u3t,{headerSection:c})}):s.jsxs(m3t,{xs:1,sm:2,md:3,lg:4,children:[!e&&s.jsx("div",{className:"salt-m-b--4",children:s.jsx(p3t,{singleLine:!0,children:s.jsx(He.Action.HeaderText,{as:"h2",children:s.jsx(ne,{as:"span",children:c.title})})})}),s.jsx(He.Action.Body,{children:s.jsx(a3t,{hasRecurringShoppingDefinitions:e})})]})},Vv="RO_SIGN_UP_FORM_STATE",l$="recoveryToken",g3t=({hasRecurringShoppingDefinitions:e,hasPastOrders:t})=>{const n=F(),o=E(gc),r=oo(o),a=E(ya),i=d=>{n($t.setFormData(d))},l=Ne(),c=Tne();return h.useEffect(()=>{if(r!==o){if(o===it.PAYMENT){localStorage.setItem(Vv,JSON.stringify(a));return}r===it.PAYMENT&&(localStorage.removeItem(Vv),c(l$))}},[r,o]),h.useEffect(()=>{const d=localStorage.getItem(Vv),u=tt.parse(l.search)?.[l$];if(d&&u){try{const m=JSON.parse(d);i(m)}catch{}n($t.setDialogType(it.PAYMENT))}},[]),s.jsxs(ie.Fragment,{children:[s.jsx(h3t,{hasRecurringShoppingDefinitions:e,hasPastOrders:t}),s.jsx(s3t,{})]})},E3t=(e,t,n,o)=>{const r=`${e.definitionName||""}, ${e.addressName||""}`,a=()=>s.jsx(go,{dateIsoFrom:e.dates.deliveryStartDate,dateIsoTo:e.dates.deliveryEndDate,timeZoneId:e.dates.timeZoneId,dateFormat:o,timeFormat:n});return s.jsx(xn,{"data-test":"order-card-recurring-placeholder",title:{text:a(),as:"h3",a11yText:t.formatMessage("orders.list.card.accessibility.title.label")},description:r,icon:"recurring_order",to:Kae(e.definitionId,e.referenceId)},e.referenceId)},lM=async(e,t,n)=>{const o=Ii({basePath:e.basePath,target:t}),r={"client-route-id":e.clientRouteId,"content-type":"application/json; charset=utf-8","X-CSRF-TOKEN":e.csrfToken},a=await fetch(o,{method:n.method,credentials:"same-origin",headers:r,...n.body?{body:JSON.stringify(n.body)}:{}});if(!a.ok)throw new Error(a.statusText);return a},_ne=async(e,t,n,o,r)=>{const i={method:"POST",body:{checkoutUrl:n&&o?`${window.location.origin}${od(o)}${lo()}`:`${window.location.origin}${lo()}`,...r?{walletItemId:r}:{}}};return await(await lM(e,`/${Wi}/v1/web/definitions/${t}/reauth`,i)).json()},f3t=async(e,t,n,o)=>{const r={method:"POST",body:{token:n,...o?{walletItemId:o}:{}}};await lM(e,`/${Wi}/v1/web/definitions/${t}/reauth/validate`,r)},c$=({definitionName:e})=>s.jsxs(h.Fragment,{children:[s.jsx("div",{children:s.jsx(v,{id:"payment.choose.payment.method"})}),s.jsx("div",{className:"salt-m-t--2",children:s.jsxs(se,{align:"center",children:[s.jsx(me,{name:"recurring_order",height:24,width:24}),s.jsx(P,{size:"l",className:"salt-m-l--2",children:e})]})})]}),y3t=async(e,t,n,o)=>{const r={method:"PUT",body:{paymentId:n,walletItemId:o}};await lM(e,`/recurringshopping/v1/web/definitions/${t}/payment`,r)},I3t=({isFetchingPspWebUrl:e,definitionName:t,pspUrl:n,openChangePaymentModalForInternalWalletWithPsp:o,closePaymentsModal:r,showMessage:a,definitionId:i,recoveryToken:l,onAfterClose:c})=>{const d=E(Wt),u=E(wa),m=E(Va),[g,f]=h.useState(!1),[y,I]=h.useState(null),S=M(),C=Ne(),_={basePath:d,csrfToken:m,clientRouteId:u},A=k=>{Me.api.pushError(k),a("orders.list.recurring.order.editPayment.error","error")},x=async k=>{try{await f3t(_,i,k,y),a("orders.list.recurring.order.editPayment.success","success")}catch(j){A(j)}r()},R=async k=>{if(!("paymentId"in k)||!k.paymentId)throw new Error("PaymentId is not available for selected wallet item");await y3t(_,i,k.paymentId,y),r(),a("orders.list.recurring.order.editPayment.success","success")},O=async()=>{f(!0);try{const k=await _ne(_,i,void 0,void 0,y);"pspWebSessionUrl"in k&&k.pspWebSessionUrl?o(k.pspWebSessionUrl):await R(k)}catch(k){r(),A(k)}f(!1)},N=()=>{a("orders.list.recurring.order.editPayment.error","error"),r()};return s.jsxs(h.Fragment,{children:[s.jsx(MT,{isFetching:e,title:s.jsx(c$,{definitionName:t}),handleError:N,handleSuccess:x,url:n,onClose:r,onAfterClose:c,location:C,isRecoveringThreeDs:!!l,asBottomSheet:!0}),s.jsx(bse,{modalTitle:s.jsx(c$,{definitionName:t}),hideModalSubtitle:!0,buttonText:S.formatMessage("orders.list.recurring.order.editPayment.modal.confirm"),disabled:g,onConfirm:O,onSelectPaymentMethod:({walletItemId:k})=>I(k),onClose:r,onAfterClose:c,asBottomSheet:!0})]})},Db=(e,t)=>le(e?.dates?.deliveryStartDate)-le(t?.dates?.deliveryStartDate),JT=e=>e.data.orders.recurring?.editDefinition,Ec=V(JT,e=>e?.data),cM=e=>{const t=Ec(e);return DO(t?.definitionId)(e)??null},Ri=V(Ec,e=>e?.definitionDetails),S3t=V(JT,e=>e?.data?.addressDetails??null),vne=V(Ec,e=>e?.selectedOrders||[]),C3t=V(Ec,Xl,(e,t)=>(t?.orders??[])?.filter(o=>o?.recurringShoppingDefinition?.definitionId===e?.definitionId&&o.cancelable&&o.status!=="CANCELLED")??[]),T3t=V(Ec,e=>e?.definitionDetails?.upcomingOrders??[]),_3t=V(C3t,T3t,(e,t)=>[...e,...t].sort(Db)),dM=V(Ec,e=>e?.slotsOffering),su=V(Ec,e=>e?.nextSlot),AE=V(dM,su,(e,t)=>t?!!e?.slots?.find(n=>Number(n?.dayOfWeekIso)===Number(t?.dayOfWeekIso)&&n?.from===t?.from&&n?.to===t?.to):!0),Ane=V(dM,AE,su,(e,t,n)=>{const o=t?e?.slots??[]:[...e?.slots??[],n];return e?.signUpDays?.sort((r,a)=>Number(r.dayOfWeekIso)-Number(a.dayOfWeekIso))?.map(r=>{const a=o?.filter(l=>Number(l.dayOfWeekIso)===Number(r.dayOfWeekIso))?.sort((l,c)=>l.from.localeCompare(c.from))??[];return{...r,slots:a}})??[]}),v3t=V(Ri,su,(e,t)=>{const n=e?.deliveryWindow;return!n||!t?!1:Number(n?.dayOfWeekIso)!==Number(t?.dayOfWeekIso)||n?.from!==t?.from||n?.to!==t?.to}),A3t=()=>s.jsx(ne,{as:"h1",children:s.jsx(_t,{id:"orders.list.recurring.order.editOrder.button"})}),b3t=({deliveryStartDate:e,deliveryEndDate:t,timeZoneId:n})=>{const o=So(e,n,Xo),r=So(e,n,vn),a=So(t,n,vn);return`${o} ${r} - ${a}`},x3t=({orders:e})=>{const t=F(),n=E(cM),o=E(vne),r=M(),a=u=>o?.some(m=>Su(m)===Su(u)),i=(u,m)=>le(u.dates.deliveryStartDate)-le(m.dates.deliveryStartDate),l=u=>{t(U.analyticsEvent({type:ht.CHECKBOX_FOR_UPCOMING_RECURRING_ORDERS_CLICKED,description:"User selects several orders to cancel",definitionId:n?.definitionId}));const m=u.group.filter(g=>g.checked).map(g=>e.find(f=>Su(f)===g.value)).filter(g=>g!==void 0);t(Bs.setEditRecurringDefinitionData({selectedOrders:m}))},c=()=>{t(U.analyticsEvent({type:ht.CLEAR_SELECTED_BUTTON_CLICKED,description:"User clicks clear selected",pageEventAttributes:{definitionID:n?.definitionId}})),t(Bs.setEditRecurringDefinitionData({selectedOrders:[]}))},d=e.sort(i).map(u=>{const m=b3t(u.dates);return{label:m,value:Su(u),name:m,checked:a(u),id:Su(u)}});return s.jsxs(h.Fragment,{children:[s.jsx(ve,{children:s.jsx(mt.CheckboxList,{"data-test":"recurring-order-definition-orders-list",options:d,onChange:l,groupLabel:r.formatMessage("orders.list.future.title")})}),!!o?.length&&s.jsx(b,{intent:"secondary",onClick:c,fill:!0,className:"salt-m-t--2","data-test":"recurring-order-definition-clear-selected-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"filter.button.clear.selected"})})})]})},R3t=({text:e})=>s.jsx(Ce,{className:"salt-m-t--4",showIcon:!1,intent:"warning",text:e,"data-test":"manually-cancel-confirmed-recurring-order",size:"s"}),D3t=({recurringOrderDefinition:e})=>{const t=M();if(!e)return null;const{name:n,frequency:o,deliveryWindow:r}=e,a={recurringOrderCardTitleAccessibility:t.formatMessage("order.details.recurring.order.card.accessibility.title.label")},i=gd(r.dayOfWeekIso,Ma),l=r.from&&r.to?`${r.from} - ${r.to}`:"";return s.jsx(ve,{children:s.jsxs(se,{direction:"column",gap:["xs"],children:[s.jsxs(se,{direction:"row",align:"center",children:[s.jsx(me,{name:"recurring_order"}),s.jsx(P,{asChild:!0,size:"l",bold:!0,className:"salt-m-l--2",children:s.jsxs("h3",{children:[n,s.jsx(Ee,{children:a.recurringOrderCardTitleAccessibility})]})})]}),s.jsx(P,{children:`${i} ${l}`}),s.jsx(P,{children:s.jsx(v,{id:`order.details.recurring.order.frequency.every.${o.value}.${o.unit.toLowerCase()}`})})]})})},bne="cancelRecurringShoppingDefinition",d$="cancel-recurring-shopping-definition-modal-header",O3t=()=>{const e=E(cM),t=F(),[n]=fe(["ro.su"]),[o,r]=h.useState(!1),a=wt(bne),i=wt(yl),l=o||!e,c=async()=>{if(e?.definitionId){r(!0);try{await t(Pm.cancelRecurringShoppingDefinition(e?.definitionId)),await Promise.all([t(qa.getRecurringShoppingDefinitions()),t(fl.fetchRecurringShoppingPlaceholders())]),t(U.analyticsEvent({type:ht.RECURRING_ORDER_CANCEL_MODAL_EVENT,userAction:"Cancel",definitionID:e?.definitionId})),t(U.analyticsEvent({type:ht.RECURRING_ORDER_CANCELED_GA4_EVENT,recurringShoppingDefinition:e,recurringOrderType:n?Pl.SMART_SHOP:Pl.CUSTOMER_DEFINED}));const u={event:"recurring_order_cancellation",type:n?Pl.SMART_SHOP:Pl.CUSTOMER_DEFINED,frequency:_S(e.frequency)??"",slot_day:vS(e.deliveryWindow)??0,slot_start_time:e.deliveryWindow?.from,slot_end_time:e.deliveryWindow?.to};J.sendEvent({GA:u,WA:null}),a.close(),z.success("orders.list.recurring.order.cancel.success.notification")}catch{a.close(),z.error("orders.list.recurring.order.cancel.error")}r(!1)}},d=()=>{a.close(),t(U.analyticsEvent({type:ht.RECURRING_ORDER_CANCEL_MODAL_EVENT,userAction:"Close",definitionID:e?.definitionId})),i.open()};return s.jsxs(G,{isOpen:a.isOpen,onRequestClose:d,aria:{labelledby:d$},asBottomSheet:!0,children:[s.jsx(G.Header,{align:"left",children:s.jsx(ne,{as:"h1",id:d$,children:s.jsx(_t,{id:"orders.list.recurring.order.modal.text.cancel.definition.confirmation"})})}),s.jsx(G.Body,{children:s.jsxs(Wa,{isLoading:l,children:[s.jsx(D3t,{recurringOrderDefinition:e}),s.jsx(R3t,{text:s.jsx(_t,{id:"orders.list.recurring.order.modal.text.cancel.ro.definition.info"})})]})}),!l&&s.jsx(G.Footer,{children:s.jsxs(na,{children:[s.jsx(na.Button,{fill:!0,"data-test":"cancel-recurring-shopping-definition-dismiss-button",onClick:d,intent:"secondary",children:s.jsx(b.Text,{children:s.jsx(_t,{id:"orders.list.recurring.order.modal.text.cancel.selected.orders.rejection"})})}),s.jsx(na.Button,{fill:!0,"data-test":"cancel-recurring-shopping-definition-confirm-button",intent:"primary",disabled:o,onClick:c,children:s.jsx(b.Text,{children:s.jsx(_t,{id:"orders.list.recurring.order.modal.text.cancel.selected.orders.acceptance"})})})]})})]})},P3t=T.button`
    cursor: pointer;
`,N3t=({onClickEditPaymentButton:e})=>{const t=E(D("rocpm")),n=E(D("rocpm.d")),o=E(Ri);if(!o)return null;const r=o?.paymentInfo;return t&&n&&r&&r?.paymentMethodV2!==at.INVOICE?s.jsx(ve,{asChild:!0,className:"salt-m-b--2",children:s.jsx(P3t,{type:"button",onClick:e,"data-test":"recurring-order-change-payment-method-button",children:s.jsxs(se,{justify:"space-between",align:"center",additionalCss:"inline-size: 100%;",as:"span",wrap:"nowrap",gap:["sm"],children:[s.jsxs(se,{direction:"column",gap:["xs"],as:"span",additionalCss:"min-inline-size: 0;",children:[s.jsx(P,{size:"l",bold:!0,children:s.jsx(_t,{id:"orders.list.recurring.order.edit.payment"})}),s.jsx(Qd,{paymentInfo:r,inline:!0})]}),s.jsx(me,{name:"edit",verticalAlign:"middle"})]})})}):null},L3t=e=>async t=>{if(await t(Bs.setEditRecurringDefinitionData(null)),!!e){t(Bs.setEditRecurringDefinitionData({definitionId:e})),t(Bs.setEditRecurringDefinitionState({isFetching:!0})),t(Z.openModal(yl));try{const o=(await t(xne(e)))?.deliveryDestinationId;await t(Rne(o))}catch{t(Z.closeModal()),z.error("toast.notification.generic.error")}t(Bs.setEditRecurringDefinitionState({isFetching:!1}))}},xne=e=>async t=>{if(!e)return null;const o=(await t(Bs.fetchEditRecurringDefinitionDetails(e))).payload.responseData;return t(Bs.setEditRecurringDefinitionData({definitionDetails:o})),o},Rne=e=>async t=>{if(!e)return null;const o=(await t(Bs.fetchEditRecurringDefinitionAddressDetails(e)))?.payload?.responseData;return t(Bs.setEditRecurringDefinitionData({addressDetails:o})),o},k3t=e=>async t=>{if(e){t(Bs.setEditRecurringDefinitionState({isFetching:!0}));try{const o=(await t(Bs.fetchEditRecurringDefinitionSlotsOffering(e))).payload.responseData;t(Bs.setEditRecurringDefinitionData({slotsOffering:o,nextSlot:o?.currentSlot}))}catch{t(Z.openModal(yl)),z.error("toast.notification.generic.error")}t(Bs.setEditRecurringDefinitionState({isFetching:!1}))}},e_={editRecurringDefinition:L3t,fetchEditRecurringDefinitionDetails:xne,fetchEditRecurringDefinitionAddressDetails:Rne,fetchSlotsOffering:k3t},Dne=(e,t)=>!e||!t?!1:Number(e?.dayOfWeekIso)===Number(t?.dayOfWeekIso)&&e?.from===t?.from&&e?.to===t?.to,u$=e=>{if(!(!e?.from||!e?.to))return`${e.from}-${e.to}`},M3t=e=>{if(!e)return;const[t,n]=e.split("-");if(!(!t||!n))return{from:t,to:n}},j3t=({children:e})=>{const t=F(),n=E(Ri),o=n?.deliveryWindow,r=E(su),a=E(AE),i=wt(yl),l=()=>{t(Bs.setEditRecurringDefinitionData({nextSlot:void 0}))},c=async d=>{d.preventDefault();const u=n?.definitionId;if(!u||!r?.dayOfWeekIso||!r?.from||!r?.to||!r?.partOfDayId||!a)return;if(Dne(o,r)){i.open(),l();return}t(Bs.setEditRecurringDefinitionState({isFetching:!0}));const m=r?.dayOfWeekIso,g=r?.from,f=r?.to,y=r?.partOfDayId;try{const I=await t(Bs.updateRecurringDefinitionSlot({definitionId:u,dayOfWeekIso:m?.toString(),startTime:g,endTime:f}));await Promise.all([t(qa.getRecurringShoppingDefinitions()),t(fl.fetchRecurringShoppingPlaceholders()),t(e_.fetchEditRecurringDefinitionDetails(u))]);const S=I?.payload?.responseData;i.open({effectiveFrom:{value:S?.effectiveFrom,timeZoneId:S?.timeZoneId}}),l(),t(U.analyticsEvent({type:ht.RECURRING_ORDER_DAY_AND_TIME_SAVED,definitionId:u,dayOfWeekIso:Number(m),partOfDayId:y,startTime:g,endTime:f})),t(Bs.setEditRecurringDefinitionData({isFetchPlaceholdersOnClose:!0}))}catch{z.error("toast.notification.generic.error")}t(Bs.setEditRecurringDefinitionState({isFetching:!1}))};return s.jsx(mt,{id:"edit-recurring-order-day-time-form",onSubmit:c,children:e})},One=()=>{const e=E(S3t);return e?`${e?.name} - ${e?.formattedAddress}`:""},Pne=()=>{const e=E(Ri),t=XT(),n=e?.frequency;return n?t({value:n.value.toString(),unit:n.unit}):""},w3t=()=>{const e=E(Ri);return gd(e?.deliveryWindow?.dayOfWeekIso,Ma)},F3t=()=>{const t=E(Ri)?.deliveryWindow;return!t?.from||!t?.to?"":`${t.from} - ${t.to}`},B3t=e=>{switch(e){case Yw.RECURRING_ALREADY_EXISTS:return"orders.list.recurring.order.edit.slot.option.existing.order";case Yw.NO_SLOTS:return"orders.list.recurring.order.edit.slot.option.no.slots.available";default:return}},U3t=()=>{const e=M(),t=F(),n=E(Ri),o=E(su),r=E(Ane),i=r?.find(f=>f.dayOfWeekIso===o?.dayOfWeekIso)?.available??!1,c=!E(AE)&&!i?e.formatMessage("orders.list.recurring.order.edit.error"):void 0,d=f=>{const y=gd(f.dayOfWeekIso,Ma),I=B3t(f?.unavailabilityReason);return I?`${y} ${e.formatMessage(I)}`:y},u=({value:f})=>{const y=r?.find(S=>Number(S?.dayOfWeekIso)===Number(f));let I=y?.slots?.find(S=>S?.from===o?.from&&S?.to===o?.to);I||(I={...o,dayOfWeekIso:y?.dayOfWeekIso},t(U.analyticsEvent({type:ht.RECURRING_ORDER_TIME_REJECTED_FROM_DROPDOWN,definitionId:n?.definitionId,dayOfWeekIso:Number(y?.dayOfWeekIso),partOfDayId:I?.partOfDayId,startTime:I?.from,endTime:I?.to}))),t(Bs.setEditRecurringDefinitionData({nextSlot:I}))},m=r.map(f=>({name:d(f),value:f.dayOfWeekIso.toString(),disabled:!f?.available})),g=m.find(f=>f.value===o?.dayOfWeekIso?.toString());return s.jsx(mt.DropdownSelect,{options:m,value:g,className:"salt-m-b--4",id:"ro-edit-slot-day-selector",name:"ro-edit-slot-day-selector",error:c,onOptionChange:u,"data-test":"ro-edit-slot-day-selector",label:{text:e.formatMessage("orders.list.recurring.order.edit.slot.day")}})},G3t={MORNING:"part1",AFTERNOON:"part2",EVENING:"part3"},$3t=()=>{const e=M(),t=F(),n=E(AE),o=E(Ane),r=E(su),a=E(dM),i=o?.find(I=>I.dayOfWeekIso===r?.dayOfWeekIso),l=i?.slots??[],c=i?.available??!1,d=({value:I})=>{const S=r?.dayOfWeekIso,C=M3t(I),_=l?.find(O=>O?.from===C?.from&&O?.to===C?.to),A=_?.from,x=_?.to;if(!S||!A||!x)return;const R=a?.slots?.find(O=>Dne(O,{dayOfWeekIso:S,from:A,to:x}));R&&t(Bs.setEditRecurringDefinitionData({nextSlot:R}))},u=!n&&c?e.formatMessage("orders.list.recurring.order.edit.error"):void 0,m=({from:I,to:S})=>!n&&r?.from===I&&r?.to===S,g=({from:I,to:S})=>!n&&c&&m({from:I,to:S})?`${I} - ${S} ${e.formatMessage("orders.list.recurring.order.edit.slot.option.unavailable")}`:`${I} - ${S}`,f=Object.values(G3t).filter(I=>l?.some(S=>S?.partOfDayId===I))?.map(I=>({section:e.formatMessage(`slotbooking.table.part.of.day.${I}`),options:l?.filter(S=>S.partOfDayId===I).map(S=>({name:g(S),value:u$(S)??"",disabled:m(S)}))})),y=f?.map(I=>I.options).flat().find(I=>I.value===u$(r));return c?s.jsx(mt.DropdownSelect,{options:f,value:y,className:"salt-m-b--4",disabled:!c,id:"ro-edit-slot-time-selector",error:u,name:"ro-edit-slot-time-selector",onOptionChange:d,"data-test":"ro-edit-slot-time-selector",label:{text:e.formatMessage("orders.list.recurring.order.edit.slot.time")}}):null},H3t=()=>{const e=E(v3t),t=E(su),n=E(AE);if(!t?.effectiveFrom||!t?.timeZoneId||!e||!n)return null;const o=So(t?.effectiveFrom,t?.timeZoneId,Xo);return s.jsxs("span",{className:"salt-d--inline-block",children:[s.jsx(P,{children:s.jsx(_t,{id:"orders.list.recurring.order.edit.slot.changes.applied.info",values:{date:o}})}),s.jsx(P,{className:"salt-m-l--1",children:s.jsx(_t,{id:"orders.list.recurring.order.edit.slot.processed.info"})})]})},V3t=()=>{const e=E(Ri),t=One(),n=Pne();return s.jsxs(h.Fragment,{children:[s.jsxs(se,{direction:"column",className:"salt-p-b--2",children:[s.jsx("div",{className:"salt-p-y--1 salt-overflow-wrap--anywhere",children:s.jsxs(P,{bold:!0,children:[s.jsx(_t,{id:"orders.list.recurring.order.edit.header.name"}),s.jsx(P,{className:"salt-p-l--1",children:e?.name})]})}),s.jsx("div",{className:"salt-p-y--1 salt-overflow-wrap--anywhere",children:s.jsxs(P,{bold:!0,children:[s.jsx(_t,{id:"orders.list.recurring.order.edit.header.address"}),s.jsx(P,{className:"salt-p-l--1",children:t})]})}),s.jsx("div",{className:"salt-p-y--1 salt-overflow-wrap--anywhere",children:s.jsxs(P,{bold:!0,children:[s.jsx(_t,{id:"orders.list.recurring.order.edit.header.frequency"}),s.jsx(P,{className:"salt-p-l--1",children:n})]})})]}),s.jsx(U3t,{}),s.jsx($3t,{}),s.jsx(H3t,{})]})},Y3t=T.span`
    vertical-align: middle;
`,W3t=({onClick:e})=>{const{formatMessage:t}=M();return s.jsxs(ne,{as:"h1","data-test":"ro-edit-slot-header",children:[s.jsx(b,{size:"s",fill:!1,intent:"tertiary","aria-label":t("modal.close"),onClick:e,className:"salt-m-r--2",children:s.jsx(b.Icon,{name:"arrow_left",height:24,width:24})}),s.jsx(Y3t,{children:s.jsx(_t,{id:"orders.list.recurring.order.edit.header.edit"})})]})},q3t="edit-recurring-order-modal-header",K3t=({isOpen:e,onClose:t,isLoading:n})=>s.jsxs(G,{asBottomSheet:!0,isOpen:e,onRequestClose:t,aria:{labelledby:q3t},children:[s.jsx(G.Header,{align:"left",children:s.jsx(W3t,{onClick:t})}),s.jsx(G.Body,{children:s.jsx(Wa,{isLoading:n,children:s.jsx(j3t,{children:s.jsx(V3t,{})})})}),s.jsx(G.Footer,{children:s.jsx(b,{fill:!0,type:"submit",intent:"primary",loading:n,"data-test":"ro-edit-slot-confirm-button",form:"edit-recurring-order-day-time-form",children:s.jsx(v,{id:"orders.list.recurring.order.edit.slot.button.save"})})})]}),Nne="editRecurringSlotModal",z3t=()=>{const e=F(),t=wt(Nne),n=wt(yl),{isFetching:o}=E(JT),r=E(Ri),a=()=>{const i=r?.definitionId;i&&(n.open(),e(Bs.setEditRecurringDefinitionData({nextSlot:void 0})),e(U.analyticsEvent({type:ht.RECURRING_ORDER_DAY_AND_TIME_MODAL_CLOSED,definitionId:i})))};return s.jsx(K3t,{isOpen:t.isOpen,isLoading:o,onClose:a})},Q3t=()=>{const t=wt(yl).options?.effectiveFrom;return t?s.jsx(Ce,{"data-test":"ro-effective-from-alert-banner",size:"s",intent:"success",text:s.jsx(_t,{id:"orders.list.recurring.order.edit.slot.effective.from",values:{date:So(t?.value,t?.timeZoneId,Xo)}})}):null},X3t=T.button`
    cursor: pointer;
`,Yv=T(P)`
    display: block;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
    max-inline-size: 100%;
`,Z3t=()=>{const e=F(),t=E(Ri),n=wt(Nne),o=One(),r=Pne(),a=w3t(),i=F3t();if(!t)return null;const l=()=>{const c=t?.definitionId;c&&(n.open(),e(e_.fetchSlotsOffering(c)),e(U.analyticsEvent({type:ht.RECURRING_ORDER_DAY_AND_TIME_MODAL_DISPLAYED,definitionId:c})))};return s.jsx(ve,{asChild:!0,className:"salt-m-b--2",children:s.jsx(X3t,{type:"button",onClick:l,"data-test":"ro-edit-slot-button",children:s.jsxs(se,{justify:"space-between",align:"center",additionalCss:"inline-size: 100%;",as:"span",wrap:"nowrap",gap:["sm"],children:[s.jsxs(se,{direction:"column",gap:["xs"],as:"span",additionalCss:"min-inline-size: 0;",children:[s.jsx(Yv,{size:"l",bold:!0,children:t.name}),s.jsx(Yv,{size:"m",children:o}),s.jsxs(Yv,{size:"m",children:[r,", ",a," ",i]}),s.jsx(Q3t,{})]}),s.jsx(me,{name:"edit",verticalAlign:"middle"})]})})})},J3t=({onClickEditPaymentButton:e,orders:t,recurringDefinition:n})=>{const o=F();if(!n)return null;const r=!!t.length,a=()=>{o(U.analyticsEvent({type:ht.CANCEL_RECURRING_ORDER_BUTTON_CLICKED,description:"User clicks cancel recurring order in order page",definitionId:n.definitionId})),o(Z.openModal(bne))};return s.jsxs("div",{"data-test":"recurring-order-definition-edit-modal-body",children:[s.jsxs("div",{children:[s.jsx(Z3t,{}),s.jsx(N3t,{onClickEditPaymentButton:e}),s.jsx(b,{intent:"secondary",onClick:a,fill:!0,"data-test":"recurring-shopping-definition-card-cancel-button",children:s.jsx(v,{id:"orders.list.recurring.order.definition.cancel.button.ro.definition"})})]}),r&&s.jsxs(h.Fragment,{children:[s.jsx(Zn,{className:"salt-m-y--4"}),s.jsx(P,{bold:!0,size:"l",className:"salt-m-b--2 salt-d--block",children:s.jsx(v,{id:"orders.list.future.title"})})]}),r&&s.jsx(x3t,{orders:t})]})},e5t=({orders:e})=>{const t=n=>So(n.dates.deliveryStartDate,n.dates.timeZoneId,Xo);return s.jsx(Ve,{children:e?.map(n=>s.jsx(Ve.Item,{className:"salt-m-b--1",children:s.jsx(P,{children:t(n)})},Su(n)))})},t5t=({onCancel:e,onConfirm:t})=>{const{formatMessage:n}=M();return s.jsxs(na,{children:[s.jsx(na.Button,{intent:"secondary",onClick:e,fill:!0,"data-test":"recurring-order-definition-cancel-selected-cancel-button",children:s.jsx(b.Text,{children:n("orders.list.recurring.order.modal.text.cancel.selected.orders.rejection")})}),s.jsx(na.Button,{intent:"primary",onClick:t,fill:!0,"data-test":"recurring-order-definition-cancel-selected-confirm-button",children:s.jsx(b.Text,{children:n("orders.list.recurring.order.modal.text.cancel.selected.orders.acceptance")})})]})},Lne="cancelSelectedRecurringOrdersConfirmation",s5t=({recurringOrderDefinition:e,selectedOrders:t})=>{const{formatMessage:n}=M(),o=F(),r=We(),a="selected-orders-confirmation-modal-header",[i,l]=h.useState(!1),c=E(Ue(Lne));h.useEffect(()=>{c&&o(U.analyticsEvent({type:ht.CONFIRM_RECURRING_ORDER_CANCELLATION_MODAL_DISPLAYED,description:"A modal for confirm order cancellation or not",definitionId:e?.definitionId}))},[c]);const d=()=>{o(Z.openModal(yl))},u=async()=>{const y=e?.definitionId;if(!(!y||!t.length)){l(!0),o(U.analyticsEvent({type:ht.CONFIRMED_RECURRING_ORDER_CANCEL_MODAL,description:"User clicks yes in confirm order cancellation modal",definitionId:e?.definitionId,referenceIds:t.map(I=>"orderId"in I?I.orderId:I.referenceId.split("_")[0])}));try{const I=t.filter(A=>"orderId"in A),S=t.filter(A=>!("orderId"in A)),[C,_]=await Promise.all([m(I),g(S)]);(C||_)&&z.error("toast.notification.generic.error"),await Promise.all([o(fl.fetchRecurringShoppingPlaceholders()),o(di.getPendingOrders()),o(e_.fetchEditRecurringDefinitionDetails(y))])}catch{z.error("toast.notification.generic.error"),d()}o(Bs.setEditRecurringDefinitionData({selectedOrders:void 0})),l(!1),z.success("shopping.lists.modal.notification.future.orders.removed"),d()}},m=async y=>{let I=!1;for(const S of y)try{await o(ci.cancelOrder({orderId:S.orderId,navigate:r,redirectToDetails:!1}))}catch{I=!0}return I},g=async y=>{let I=!1;for(const S of y)try{await o(Yc.cancelRecurringOrderPlaceholder(S.definitionId,S.referenceId))}catch{I=!0}return y.length&&o(Bs.setEditRecurringDefinitionData({isFetchPlaceholdersOnClose:!0})),I},f=()=>{o(U.analyticsEvent({type:ht.NO_BUTTON_CLICKED,description:"User clicks no in confirm order cancellation modal",definitionID:e?.definitionId})),d()};return s.jsx(G,{isOpen:c,onRequestClose:d,aria:{labelledby:a},asBottomSheet:!0,children:s.jsxs(G.ModalForm,{children:[s.jsx(G.Header,{align:"left",children:s.jsx(ne,{as:"h1",id:dc,children:n("orders.list.recurring.order.modal.text.cancel.selected.orders.confirmation.question")})}),s.jsx(G.Body,{children:s.jsx(Wa,{isLoading:i,children:s.jsx(e5t,{orders:t})})}),!i&&s.jsx(G.Footer,{children:s.jsx(t5t,{onCancel:f,onConfirm:u})})]})})},n5t="edit-recurring-order-modal-header",yl="editRecurringOrder",o5t=({onClickEditPaymentButton:e})=>{const t=F(),o=E(Ec)?.isFetchPlaceholdersOnClose??!1,r=E(cM),a=E(vne)||[],i=E(_3t)||[],l=!!i.length,c=wt(yl),d=wt(Lne),u=E(JT),{isFetching:m}=u,g=m||!r,f=()=>{a.length===0?z.error("orders.list.recurring.order.no.orders.selected.notification"):(t(U.analyticsEvent({type:ht.CANCEL_SELECTED_RECURRING_ORDERS_BUTTON_CLICKED,description:"User clicks cancel selected orders in order page",definitionId:r?.definitionId})),d.open())},y=()=>{c.close(),t(Bs.setEditRecurringDefinitionData(null)),o&&t(fl.fetchRecurringShoppingPlaceholders())},I=()=>s.jsx(b,{intent:"secondary",onClick:f,fill:!0,"data-test":"recurring-order-definition-cancel-selected-button",children:s.jsx(v,{id:"orders.list.recurring.order.definition.cancel.selected.button"})});return s.jsxs(h.Fragment,{children:[s.jsx(G,{isOpen:c.isOpen,onRequestClose:y,showCloseIcon:!0,aria:{labelledby:n5t},asBottomSheet:!0,children:s.jsxs(G.ModalForm,{children:[s.jsx(G.Header,{align:"left",children:s.jsx(A3t,{})}),s.jsx(G.Body,{children:s.jsx(Wa,{isLoading:g,children:s.jsx(J3t,{recurringDefinition:r,onClickEditPaymentButton:()=>{r&&e(r)},orders:i})})}),!g&&l&&!!a?.length&&s.jsx(G.Footer,{children:I()})]})}),s.jsx(s5t,{recurringOrderDefinition:r,selectedOrders:a})]})},r5t=({recurringShoppingDefinition:e})=>{const t=F(),n=E(Vt),o=e.frequency&&e.frequency.unit&&e.frequency.value&&s.jsx(v,{id:`orders.list.recurring.order.frequency.every.${e.frequency.value}.${e.frequency.unit.toLowerCase()}`}),r=gd(e.deliveryWindow.dayOfWeekIso,Ma),a=(c,d)=>{const u=Mt(c,"HH:mm"),m=Mt(d,"HH:mm");return Wh(u.toISOString(!0),m.toISOString(!0),n)},i=()=>{const c=e?.definitionId;t(U.analyticsEvent({type:ht.MANAGE_RECURRING_ORDER_BUTTON_CLICKED,description:"User clicks manage recurring order button",definitionId:c})),t(e_.editRecurringDefinition(c))},l=a(e.deliveryWindow.from,e.deliveryWindow.to);return s.jsxs(He.Action,{"data-test":"recurring-shopping-definition-card",xs:1,sm:2,md:3,lg:4,children:[s.jsxs(He.Action.Header,{children:[s.jsx(me,{name:"recurring_order",height:24,width:24}),s.jsx(He.Action.HeaderText,{singleLine:!0,children:e.name})]}),s.jsx(He.Action.Body,{align:"left",children:s.jsxs(P,{children:[o,", ",r," ",l]})}),s.jsx(He.Action.Footer,{children:s.jsx(b,{intent:"secondary",onClick:i,fill:!0,"data-test":"recurring-shopping-definition-card-edit-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"orders.list.recurring.order.editOrder.button"})})})})]},e.definitionId)},a5t=D("pay.ew"),i5t=D("rocpm"),l5t=D("pay.ywlt"),Wv="lsEditedPaymentDefinitionId",c5t=({recurringShoppingDefinitions:e})=>{const t=E(Wt),n=E(Va),o=E(wa),r=E(a5t),a=E(i5t),i=E(l5t),[l,c]=h.useState(!1),[d,u]=h.useState(null),m=F(),g=Ne(),f=We(),[y,I]=h.useState(null),S=E(Lae),C=E(ar),{recoveryToken:_}=tt.parse(g.search||"");h.useEffect(()=>{_&&m(YL())},[_]),h.useEffect(()=>{if(!a)return;const w=localStorage.getItem(Wv);if(w){const L=e.data.find(B=>B.definitionId===w);L&&(_?(I(L),m(Z.openModal(dy))):k(L))}},[e,_]);const A=(w,L)=>{z[L](w)},x=()=>{if(localStorage.removeItem(Wv),u(null),I(null),_){const w=new URLSearchParams(g.search);w.delete("recoveryToken"),f({search:w.toString()},{replace:!0})}m(Z.closeModal())},R=()=>{m(Z.openModal(yl))},O=w=>{Me.api.pushError(w),x(),A("orders.list.recurring.order.editPayment.error","error"),R()},N=async w=>{c(!0),m(Z.openModal(dy));try{const L=await _ne({basePath:t,csrfToken:n,clientRouteId:o},w.definitionId,S,C);"pspWebSessionUrl"in L&&L.pspWebSessionUrl?u(L.pspWebSessionUrl):O(new Error("Response does not contain pspWebSessionUrl"))}catch(L){O(L)}c(!1)},k=async w=>{m(U.analyticsEvent({type:ht.EDIT_PAYMENT_BUTTON_CLICKED,description:"User clicks edit payment in order page",pageEventAttributes:{definitionID:w.definitionId}})),I(w),localStorage.setItem(Wv,w.definitionId),r&&!i?await N(w):m(Z.openModal(Uk,{...w.paymentInfo?.walletItemId?{initialWalletItemId:w.paymentInfo.walletItemId}:{}}))},j=w=>{u(w),m(Z.openModal(dy))};return s.jsxs(h.Fragment,{children:[e.data.map(w=>s.jsx(r5t,{recurringShoppingDefinition:w},w.definitionId)),s.jsx("div",{className:"salt-m-b--8"}),s.jsx(O3t,{}),y&&s.jsx(I3t,{definitionId:y.definitionId,definitionName:y.name,recoveryToken:_,isFetchingPspWebUrl:l,pspUrl:d,openChangePaymentModalForInternalWalletWithPsp:j,closePaymentsModal:x,onAfterClose:R,showMessage:A}),s.jsx(o5t,{onClickEditPaymentButton:k}),s.jsx(z3t,{})]})},d5t=(e,t)=>{const[n,o]=h.useState(void 0),[r,a]=h.useState(!1),[i,l]=h.useState([]),[c,d]=h.useState(),[{data:u,fetching:m}]=GI({query:e,requestPolicy:"network-only",variables:{first:20,after:n}});h.useEffect(()=>{u&&g(u)},[u]);const g=y=>{const I=t(y);if(I){const S=I.edges.filter(C=>C!=null).map(C=>({...C.node}))||[];l(C=>[...C,...S]),a(I.pageInfo.hasNextPage||!1),d((({edges:C,pageInfo:_,...A})=>A)(I))}};return{data:i,fetching:m,hasNext:r,attrs:c,fetchMore:()=>{if(u&&r){const y=t(u);o(y?.pageInfo.endCursor||void 0)}}}},u5t=e=>{const t=E(ar),n=E(Qi),o=E(Vt),[r]=fe(["onre"]),a=(i,l,c)=>{const d=hp({deliveryMethod:i.deliveryMethod,slotType:i.slotType,start:i.dates.deliveryStartDate,end:i.dates.deliveryEndDate}),u={order:i,dateFormat:l,timeFormat:o,type:c,bannerBusinessModel:n,retailerRegionId:t,isOnlineReceiptEnabled:r,isMultidaySlotIcon:d};return s.jsx(rM,{...u})};return s.jsxs(h.Fragment,{children:[s.jsx("div",{className:"salt-m-y--4",children:s.jsx(P,{asChild:!0,bold:!0,size:"l",children:s.jsx("h3",{children:e.sectionTitle})})}),s.jsx(Y,{flush:!0,children:e.ordersFromMonth.map(i=>s.jsx(Y.Item,{colSpan:{xs:12,sm:6,md:4,lg:3},children:a(i,WI,"past")},i.orderId))})]},e.sectionTitle)},p5t=e=>{const t=E(a0),n=o=>o.reduce((r,a)=>{const i=So(a.dates.deliveryEndDate,a.dates.timeZoneId,t,void 0),l=r.find(c=>c.monthOfYear===i);return l?l.orders.push(a):r.push({monthOfYear:i,orders:[a]}),r},[]).sort((r,a)=>le(a.orders[0]?.dates.deliveryEndDate)-le(r.orders[0]?.dates.deliveryEndDate));return s.jsx("div",{className:"salt-m-y--2","data-test":"completed-orders-container",children:n(e.orders).map((o,r)=>s.jsx(u5t,{ordersFromMonth:o.orders,sectionTitle:o.monthOfYear},`completed-orders-month-key-${r}`))})},m5t=Fd(`
    query GetCompletedOrders($first: Int!, $after: String) {
        completedOrders(first: $first, after: $after) {
            retentionPeriod
            pageInfo {
                endCursor
                hasNextPage
            }
            edges {
                node {
                    orderId
                    status
                    region {
                        retailerRegionId
                    }
                    prices {
                        total {
                            currency
                            amount
                        }
                    }
                    recurringOrderDefinition {
                        name
                    }
                    slot {
                        __typename
                        ... on InternalOrderSlot {
                            start
                            end
                            type
                            shippingGroupType
                            carrier {
                                carrierId
                            }
                            externalLocker {
                                externalLockerId
                            }
                            deliveryDestination {
                                deliveryMethod
                                name
                                address {
                                    timeZone
                                }
                            }
                        }
                        ... on ImportedOrderSlot {
                            start
                            end
                            name
                            timeZone
                        }
                    }
                }
            }
        }
    }
`),h5t=e=>{const t=n=>{const{__typename:o}=n.slot;if(o==="ImportedOrderSlot"){const r=n.slot;return{deliveryMethod:iF.HomeDelivery,addressNickname:r.name,slotType:w9e.Standard,timeZoneId:r.timeZone,start:r.start,end:r.end}}else{const r=n.slot;return{deliveryMethod:r.deliveryDestination.deliveryMethod===iF.Collection?Yi:la,addressNickname:r.deliveryDestination.name,slotType:r.type,timeZoneId:r.deliveryDestination.address.timeZone,start:r.start,end:r.end,shippingGroupType:r.shippingGroupType,carrierId:r.carrier?.carrierId,externalLockerId:r.externalLocker?.externalLockerId}}};return e.map(n=>{const o=t(n);return{orderId:n.orderId,status:n.status,retailerRegionId:n.region.retailerRegionId,orderTotals:{totalPrice:{amount:n.prices.total.amount,currency:n.prices.total.currency}},dates:{deliveryStartDate:n.slot.start,deliveryEndDate:n.slot.end,timeZoneId:o.timeZoneId},addressNickName:o.addressNickname,deliveryMethod:o.deliveryMethod,slotType:o.slotType,shippingGroupType:o.shippingGroupType,carrierId:o.carrierId,externalAddress:o.externalLockerId&&{externalCollectionPointId:o.externalLockerId},recurringShoppingDefinition:n.recurringOrderDefinition&&{name:n.recurringOrderDefinition.name}}})},g5t=()=>{const[e]=fe(["tx.nts"]),{setCompletedOrdersCount:t}=h.useContext(jne),{data:n,fetching:o,hasNext:r,attrs:a,fetchMore:i}=d5t(m5t,g=>g.completedOrders);h.useEffect(()=>{n&&!o&&t(n.length)},[n]);const l=()=>s.jsx("div",{className:"salt-m-t--4",children:s.jsx(Rs,{"data-test":"order-list-spinner"})}),c=()=>s.jsx("div",{className:"salt-m-t--8",children:s.jsx(P,{asChild:!0,bold:!0,"data-test":"order-list-no-more-orders-label",children:s.jsx("h2",{children:s.jsx(v,{id:"orders.list.past.no.more.orders"})})})}),d=()=>!o&&r,u=()=>s.jsxs(h.Fragment,{children:[o?l():null,r?null:c()]}),m=()=>e&&s.jsx("div",{className:"salt-m-t--1 salt-d--block",children:s.jsx(P,{asChild:!0,children:s.jsx("h3",{children:s.jsx(v,{id:"orders.list.tax.inclusion.note"})})})});return s.jsxs(h.Fragment,{children:[s.jsxs(se,{align:"baseline",className:"salt-m-y--4",children:[s.jsx("div",{className:"salt-m-r--4",children:s.jsx(P,{asChild:!0,bold:!0,size:"l",children:s.jsxs("h2",{children:[s.jsx(v,{id:"orders.list.past.title"})," ",s.jsx(yne,{retentionPeriod:a?.retentionPeriod})]})})}),m()]}),s.jsx(p5t,{orders:h5t(n)}),u(),d()?s.jsx(aM,{action:i}):null]})},E5t=D("rec.o"),f5t=D("tx.nts"),y5t=D("onre"),I5t=D("ro.su"),S5t=D("del.win"),C5t=D("pln.win"),T5t=D("cmpl.ords.graphql"),_5t=e=>"status"in e;class v5t extends h.Component{renderFutureOrderCard(t,n){const{timeFormat:o,intl:r,bannerBusinessModel:a,retailerRegionId:i,isOnlineReceiptEnabled:l,isDeliveryWindowEnabled:c,isPlannedDeliveryWindowEnabled:d,getFailedOrderPaymentsForOrder:u}=this.props;if(_5t(t)){const m=hp({deliveryMethod:t.deliveryMethod,slotType:t.slotType,start:t.dates.deliveryStartDate,end:t.dates.deliveryEndDate}),g={order:t,dateFormat:n,timeFormat:o,type:"upcoming",bannerBusinessModel:a,retailerRegionId:i,isOnlineReceiptEnabled:l,isMultidaySlotIcon:m,isDeliveryWindowEnabled:c,isPlannedDeliveryWindowEnabled:d,getFailedOrderPaymentsForOrder:u};return s.jsx(rM,{...g})}return E3t(t,r,o,n)}renderFutureOrders(){const{dateFormat:t,futureOrders:n,isTaxInclusionNoteEnabled:o}=this.props,r=()=>o&&s.jsx("div",{className:"salt-m-t--1 salt-d--block",children:s.jsx(P,{asChild:!0,children:s.jsx("h3",{children:s.jsx(v,{id:"orders.list.tax.inclusion.note"})})})});return s.jsxs(h.Fragment,{children:[s.jsxs(se,{align:"baseline",className:"salt-m-y--4",children:[s.jsx("div",{className:"salt-m-r--4",children:s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"orders.list.future.title"})})}),r()]}),s.jsx(Y,{flush:!0,children:n.map(a=>s.jsx(Y.Item,{colSpan:{xs:12,sm:6,md:4,lg:3},children:this.renderFutureOrderCard(a,t)},this.isOrder(a)?a.orderId:a.definitionId))}),s.jsx("div",{className:"salt-m-b--8"})]})}renderPastOrders(){return this.props.isCompletedOrdersFromGraphqlEnabled?s.jsx(g5t,{}):s.jsx(e4t,{})}renderRecurringShoppingDefinitions(){const{isRecurringOrdersEnabled:t,recurringShoppingDefinitions:n}=this.props;return t&&n&&n.data&&n.data.length>0?s.jsx(c5t,{recurringShoppingDefinitions:n}):null}renderRecurringOrderSignUp(){const{recurringShoppingDefinitions:t,pastOrders:n,isROSignUpEnabled:o}=this.props;return o?s.jsx(g3t,{hasRecurringShoppingDefinitions:!!t?.data.length,hasPastOrders:!!n?.orders.length}):null}renderScrollTopRow(){return s.jsx("div",{className:"salt-m-y--4",children:s.jsx(eX,{focusElement:"#orders-list-page-title"})})}isOrder(t){return t.orderId!==void 0}render(){const{futureOrders:t,isOrderListPageEmpty:n}=this.props;return s.jsx(Y,{"data-test":"orders-list-page",children:s.jsxs(Y.Item,{colSpan:{xs:12},children:[!!this.props.recurringShoppingDefinitions?.data.length&&s.jsx("div",{className:"salt-m-y--4",children:s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"orders.list.recurring.orders.section.title"})})}),s.jsxs(He.Collection,{children:[this.renderRecurringOrderSignUp(),this.renderRecurringShoppingDefinitions()]}),!!t.length&&this.renderFutureOrders(),this.renderPastOrders(),!n&&this.renderScrollTopRow()]})})}}const A5t=e=>({bannerBusinessModel:Qi(e),isRecurringOrdersEnabled:E5t(e),isTaxInclusionNoteEnabled:f5t(e),isOnlineReceiptEnabled:y5t(e),retailerRegionId:ar(e),isROSignUpEnabled:I5t(e),isDeliveryWindowEnabled:S5t(e),isPlannedDeliveryWindowEnabled:C5t(e),isCompletedOrdersFromGraphqlEnabled:T5t(e),getFailedOrderPaymentsForOrder:t=>r4(e,t)}),b5t=Ct(Bt,ke(A5t))(v5t),x5t=({icon:e="orders"})=>{const t=We(),n=ts(),[o]=fe(["seo.rdbl"]),r=()=>{n({type:M2.CONTINUE_SHOPPING_BUTTON_CLICKED});const a="source=navigation",i=o?Zo(void 0,{queryString:a}):jo({queryString:a});t(i)};return s.jsx(Y,{fixed:!0,className:"salt-m-y--16",children:s.jsx(Y.Item,{colStart:{xs:2,sm:3,md:4,lg:5},colSpan:{xs:10,sm:8,md:6,lg:4},children:s.jsx(ln,{titleIcon:e,title:"orders.list.no.results.title",titleAs:"h2",description:"orders.list.no.results.subtext",primaryButton:{text:"orders.list.no.results.browse",onClick:r}})})})},kne=D("rec.o"),Mne=D("cmpl.ords.graphql"),R5t={actions:p.shape({getPendingOrders:p.func.isRequired,getPastOrders:p.func.isRequired,getRecurringOrderPlaceholders:p.func.isRequired,getRecurringShoppingDefinitions:p.func.isRequired,sendAnalyticsEvent:p.func.isRequired}).isRequired,dateFormat:p.string.isRequired,isRecurringOrdersEnabled:p.bool.isRequired,timeFormat:p.string.isRequired,pendingOrders:p.shape({isFetching:p.bool,lastUpdated:p.number,orders:p.arrayOf(Go)}),pastOrders:p.shape({isFetching:p.bool,lastUpdated:p.number,nextPageToken:p.string,orders:p.arrayOf(Go)}),recurringOrderPlaceholders:p.shape({isFetching:p.bool,lastUpdated:p.number,data:p.arrayOf(Ene)}),recurringShoppingDefinitions:Lzt,isServerRendered:p.bool.isRequired},D5t={pendingOrders:{orders:[],isFetching:!1},pastOrders:{orders:[],isFetching:!1,nextPageToken:null},recurringOrderPlaceholders:null,recurringShoppingDefinitions:void 0},jne=h.createContext(),uM=({actions:e,isRecurringOrdersEnabled:t,isCompletedOrdersFromGraphqlEnabled:n,isServerRendered:o,pastOrders:r,pendingOrders:a,recurringShoppingDefinitions:i,recurringOrderPlaceholders:l,dateFormat:c,timeFormat:d})=>{const[u,m]=h.useState(-1),g=()=>{e.sendAnalyticsEvent({type:As.PAGE_ATTRIBUTES_MULTIPLE,attributes:{PENDING_ORDERS_TOTAL_COUNT:r?.orders?.length}})},f=()=>{e.sendAnalyticsEvent({type:As.PAGE_ATTRIBUTES_MULTIPLE,attributes:{PAST_ORDERS_TOTAL_COUNT:a?.orders?.length}})};h.useEffect(()=>{(!o||!r.lastUpdated&&!a.lastUpdated&&!r.isFetching&&!a.isFetching)&&(t&&e.getRecurringOrderPlaceholders(),e.getPendingOrders().then(()=>f()),n||e.getPastOrders().then(()=>g())),!o&&!i.isFetching&&t&&e.getRecurringShoppingDefinitions()},[]);const y=()=>t?[...a.orders,...l.data].sort(Db):a.orders.sort(Db),I=()=>r,S=()=>{const x=n?u===0:r.orders.length===0;return a.orders.length===0&&l.data.length===0&&x},C=()=>s.jsx("div",{className:"salt-m-t--16",children:s.jsx(Rs,{size:"l"})}),_=()=>s.jsxs(h.Fragment,{children:[S()&&s.jsx(x5t,{}),s.jsx(b5t,{futureOrders:y(),recurringShoppingDefinitions:i,pastOrders:I(),dateFormat:c,timeFormat:d,isOrderListPageEmpty:S()})]}),A=()=>a&&a.isFetching;return s.jsx(jne.Provider,{value:{completedOrdersCount:u,setCompletedOrdersCount:m},children:s.jsxs("div",{"data-synthetics":"orders-summary-view",children:[s.jsx(rs,{title:"orders.list.page.title"}),s.jsx(An,{id:"orders-list-page-title",children:s.jsxs(se,{justify:"start",align:"center",children:[s.jsx("div",{className:"salt-d--inline-block salt-p-r--4 sm:salt-p-r--8",children:s.jsx(ne,{as:"h1",children:s.jsx(v,{id:"orders.list.page.title"})})}),s.jsx(Bd,{targetName:Ul.FKSN})]})}),A()?C():_()]})})},O5t=e=>({pendingOrders:Xl(e),pastOrders:c4(e),dateFormat:Jt(e),timeFormat:Vt(e),isServerRendered:Yt(e),isRecurringOrdersEnabled:kne(e),isCompletedOrdersFromGraphqlEnabled:Mne(e),recurringShoppingDefinitions:xC(e),recurringOrderPlaceholders:m4(e)}),P5t=ot({getPendingOrders:di.getPendingOrders,getPastOrders:nM.getPastOrders,getRecurringOrderPlaceholders:fl.fetchRecurringShoppingPlaceholders,getRecurringShoppingDefinitions:qa.getRecurringShoppingDefinitions,sendAnalyticsEvent:U.analyticsEvent});uM.propTypes=R5t;uM.defaultProps=D5t;const wne=e=>s.jsx(os,{type:"OrderListWrapper::route",children:s.jsx(uM,{...e})});wne.fetchData=({context:{store:e}})=>{const t=e.getState(),n=Ze(t),o=[];return n?(o.push(e.dispatch(di.getPendingOrders())),Mne(t)||o.push(e.dispatch(nM.getPastOrders())),kne(t)&&(o.push(e.dispatch(fl.fetchRecurringShoppingPlaceholders())),o.push(e.dispatch(qa.getRecurringShoppingDefinitions()))),Promise.all(o)):Promise.resolve()};const N5t=ke(O5t,P5t)(wne),L5t=D("rec.o"),k5t=e=>[{path:"/orders/recurring-shopping/definitions/:definitionId/scheduled/:referenceId",Component:ws(Ze,e.Main),children:[{index:!0,Component:Xt(L5t,gne,lt)}]},{path:"/orders",Component:ws(Ze,e.Main),children:[{index:!0,Component:N5t}]}],M5t=D("oosa"),j5t=e=>[{path:"/out-of-stock",Component:e.Main,children:[{index:!0,lazy:async()=>{const{OutOfStockPage:t}=await Rn(async()=>{const{OutOfStockPage:n}=await import("./out-of-stock-page-BV5B2MFK.js");return{OutOfStockPage:n}},__vite__mapDeps([17,1,2,3]));return{Component:Xt(M5t,t,lt)}}}]}],w5t=()=>s.jsx(Y,{fixed:!0,className:"salt-p--2",children:s.jsx(Y.Item,{colSpan:{xs:12},className:"salt-p-y--4",children:s.jsxs(se,{align:"center",direction:"column",children:[s.jsx(me,{success:!0,name:"status_yes",height:42,width:42}),s.jsx(ne,{as:"h1","data-test":"add-card-complete-message",className:"salt-m-y--2",children:"Card was successfully added"})]})})}),F5t=()=>{z.error("settings.wallet.create.item.error")},B5t=e=>{const t={event:"event",eventCategory:"Payment",eventAction:"AddWalletItemError"};return J.sendEvent({GA:t,WA:null}),e({type:xt.ADD_WALLET_ITEM,event:"ERROR"})},U5t=(e,t)=>{const n={event:"event",eventCategory:"Payment",eventAction:"AddWalletItemSuccess",walletItemId:t?.responseData?.walletItemId};return J.sendEvent({GA:n,WA:null}),e({type:xt.ADD_WALLET_ITEM,event:"COMPLETE",walletItemId:t?.responseData?.walletItemId})},G5t=(e,t)=>e({type:xt.ADD_WALLET_ITEM_REQUEST,event:xt.ADD_WALLET_ITEM_REQUEST,resultToken:t}),$5t=({analyticsEvent:e})=>()=>{B5t(e),F5t()},H5t=({data:e,iframeRef:t})=>{try{const n=t.current?.contentWindow;if(n)n.postMessage(e,"*");else throw new Error}catch{throw new Error("Wrong iframeRef object shape")}},V5t=({iframeRef:e,tokenErrorHandler:t,resultTokenHandler:n,analyticsEvent:o,isSkipXssCheckEnabled:r})=>({data:a,origin:i})=>{if(!r&&!EO(i)){o({type:xt.UNAUTHORIZED_POST_MESSAGE_ATTEMPT,origin:i});return}H5t({data:a,iframeRef:e});const{type:l,resultToken:c}=a;switch(l){case"TOKENIZATION_ERROR":t();break;case"TOKENIZATION_RESULT_TOKEN":if(c===void 0)throw new Error("resultToken is undefined");n(c);break}};function Y5t({analyticsEvent:e,createWalletItem:t,iframeRef:n,isCardRecoveredEventEnabled:o,isSkipXssCheckEnabled:r},{createErrorMessageHandler:a=$5t,createMessageHandler:i=V5t,completeAnalyticsEvent:l=U5t,addWalletItemRequestAnalyticsEvent:c=G5t}={}){const[d,u]=h.useState(null),[m,g]=h.useState(!1);return h.useEffect(()=>{const f=a({analyticsEvent:e}),y=()=>{window.removeEventListener("message",I),f()},I=i({iframeRef:n,isSkipXssCheckEnabled:r,analyticsEvent:e,tokenErrorHandler:()=>{y(),g(!0)},resultTokenHandler:S=>(window.removeEventListener("message",I),o&&c(e,S),t(S).then(({payload:C})=>{l(e,C),u(S)}).catch(y).finally(()=>g(!0)))});return window.addEventListener("message",I),()=>{window.removeEventListener("message",I)}},[]),{resultToken:d,hasTokenActivity:m}}const W5t=(e,t)=>{const n=e.pspweb?.url;return!n||!t?"":`${n}?${us.stringify({recoveryToken:t})}`},q5t=e=>{const t=Ne(),{originLocation:n,recoveryToken:o}=us.parse(t.search),r=Array.isArray(n)?n[0]||"":n||"",a=Array.isArray(o)?o[0]||"":o,i=W5t(e,a);return{redirectUrl:r,pspWebRecoveryUrl:i}},K5t=3e3;function z5t(e,t=K5t){const[n,o]=h.useState(!1),r=h.useRef(null);return h.useEffect(()=>(e&&(r.current=setTimeout(()=>{o(!0)},t)),()=>{clearTimeout(r.current)}),[e]),{hasToRedirect:n}}const Q5t=D("pay.cre"),X5t=()=>{const e=h.useRef(null),t=F(),n=E(u6),o=E(Q5t),r=E(D("pay.skpxss"));h.useEffect(()=>{t(YL())},[]);const{redirectUrl:a,pspWebRecoveryUrl:i}=q5t(n),{resultToken:l,hasTokenActivity:c}=Y5t({createWalletItem:m=>t(dE.createWalletItem(m)),analyticsEvent:m=>t(U.analyticsEvent(m)),iframeRef:e,isCardRecoveredEventEnabled:o,isSkipXssCheckEnabled:r}),{hasToRedirect:d}=z5t(c),u=!c||!i;return d&&a?(window.location.replace(a),null):l?s.jsx(w5t,{}):s.jsxs(ie.Fragment,{children:[u&&s.jsx(Rs.WithContainer,{}),s.jsx("iframe",{sandbox:"allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox",src:i,title:"pspweb-add-card-recovered","data-synthetics":"psp-iframe","data-test":"psp-iframe",height:"100%",width:"100%",ref:e})]})},Fne=({orderId:e})=>{const t=F(),n=We();return{completeFailedPaymentAuthentication:({resultToken:a})=>t(JJe(a,e,n)),handleAuthenticationError:({errorParam:a})=>n(sc({orderId:e,queryString:a}))}},Z5t=()=>{const e=Ne(),{orderId:t}=co();if(!t)throw new Error("Failed to retrieve orderId from URL parameters");const{handleAuthenticationError:n,completeFailedPaymentAuthentication:o}=Fne({orderId:t}),r=a=>o(a);return jT(),s.jsx(kT,{messageCallback:r,errorCallback:n,location:e})},Bne=e=>s.jsx(os,{type:"FailedPayment3ds::route",children:s.jsx(Z5t,{...e})});Bne.fetchData=({context:{store:e},params:t})=>e.dispatch(Wo.getOrderWithRecurringNotification(t.orderId));const J5t=D("ag"),e6t=D("cdm"),t6t=({actions:e,dateFormat:t,intl:n,timeFormat:o,canChangeDelivery:r=!0,delivery:a=null,showDeliveryPass:i=!1,ageConfirmed:l=!1,isAgeConfirmationError:c=!1,onClickAgeConfirmation:d=()=>{},isAgeConfirmationEnabled:u=!1,isConciergeDeliveryMethodEnabled:m=!1,conciergeDelivery:g=!1,onChangeDeliveryButtonClick:f,deliveryCardImpression:y})=>{const I=ul(),{isCollection:S,standardTitle:C,expressCollectionTitle:_,expressCollectionDescription:A,shouldShowStandardDateForExpressCollection:x}=uZ(a),R=We(),O=E(Ho),[N]=fe(["nfchk"]);if(h.useEffect(()=>{a?.addressId&&y&&y(a?.addressId,a?.deliveryDestinationId)},[a?.addressId,a?.deliveryDestinationId,y]),!a)return s.jsx(Ns.Skeleton,{});const k={ageConfirmationError:n.formatMessage("checkout.summary.age.confirmation.error"),conciergeTermsAndConditionsLink:n.formatMessage("checkout.summary.concierge.termsandconditions.link.url")},j=S?"checkout.summary.collection.change.button":"checkout.summary.delivery.change.button",w=!!a.addressNotes;let L=null;a.ageRestriction||i&&a.hasDeliveryPass?L="2":r&&(L="4");const B=async()=>{f&&f();const K=await Yo.fetchAnalyticsMetadataByActiveCart(O);e.sendAnalyticsEvent({type:_e.BEGIN_CHECKOUT,meta:K}),I(K),R(sr({inCheckoutWalk:!0}))},W=s.jsx(P,{"data-test":"delivery-date",size:"l",bold:!0,children:s.jsx(go,{dateIsoFrom:a.deliveryStartDate,dateIsoTo:a.deliveryEndDate,dateFormat:t,timeZoneId:a.timeZoneId,timeFormat:o})}),$=C?s.jsxs(ie.Fragment,{children:[s.jsx(ne,{as:"h2",className:"salt-m-b--2",children:C}),W]}):s.jsx(ne,{as:"h2",className:"salt-p-b--2",children:_});return s.jsxs(ve,{children:[$,s.jsxs("div",{className:`salt-m-b--${L}`,children:[A&&s.jsx(P,{bold:!0,className:"salt-d--block",children:A}),x&&s.jsx(P,{bold:!0,className:"salt-d--block",children:W}),s.jsxs(P,{"data-pii":"true","data-test":"delivery-address-body",className:"salt-d--block",children:[a.addressNickName&&`${a.addressNickName} - `,a.address&&a.address]}),a.additionalInformation&&S&&s.jsx("div",{className:"salt-m-t--2",children:s.jsx(pZ,{message:a.additionalInformation})}),a.additionalInformation&&!S&&s.jsx(P,{"data-test":"delivery-address-additional-information","data-pii":"true",className:"salt-d--block",children:a.additionalInformation}),w&&s.jsxs("div",{className:"salt-m-t--2",children:[s.jsx(P,{size:"l",bold:!0,className:"salt-d--block",children:s.jsx(v,{id:"settings.address.book.add.modal.notes.label"})}),s.jsx(P,{"data-test":"delivery-address-notes",children:a.addressNotes})]})]}),i&&a.hasDeliveryPass?s.jsx(Ce,{intent:"success",showIcon:!1,text:s.jsx(v,{id:"checkout.complete.delivery.pass"}),link:s.jsx(Ce.Link,{to:JD(),children:s.jsx(v,{id:"checkout.complete.manage.delivery.pass"})})}):null,a.ageRestriction&&!u&&s.jsx(Ce,{className:r?"salt-m-b--2":"",intent:"warning","data-test":"summary-age-restriction-warning",text:s.jsx(v,{id:"checkout.summary.age.restriction.warning",values:{age:a.ageRestriction}}),showIcon:!1}),m&&r&&!S&&s.jsx(xL,{}),m&&!r&&g&&s.jsx(Ce,{className:"salt-m-t--4","data-test":"concierge-info",intent:"info",text:s.jsx(v,{id:"checkout.complete.concierge.info"})}),r?s.jsx(b,{intent:"secondary",fill:!0,onClick:B,"data-test":"change-delivery-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:j})})}):null,a.ageRestriction&&u&&s.jsxs("div",{className:"salt-m-t--2",children:[s.jsx(Ce,{intent:"warning",showIcon:!1,text:s.jsx(v,{id:"checkout.summary.age.confirmation.warning"})}),N?s.jsx(mt.Checkbox,{name:"summary-age-confirmation-checkbox",value:"summary-age-confirmation-checkbox",checked:l,onChange:d,error:c?k.ageConfirmationError:"",required:!0,label:s.jsx(v,{id:"checkout.summary.age.confirmation.label",values:{age:a.ageRestriction}}),"data-test":"summary-age-confirmation-checkbox",className:"salt-m-t--4"}):s.jsx(mo,{last:!0,input:{checked:l,onChange:d},bold:!1,meta:{error:c?k.ageConfirmationError:"",invalid:c,touched:c},label:s.jsx(v,{id:"checkout.summary.age.confirmation.label",values:{age:a.ageRestriction}}),"data-test":"summary-age-confirmation-checkbox",className:"salt-m-t--4"})]})]})},s6t=e=>({dateFormat:Jt(e),timeFormat:Vt(e),isAgeConfirmationEnabled:J5t(e),isConciergeDeliveryMethodEnabled:e6t(e),conciergeDelivery:xg(e)}),n6t=ot({onClickConciergeDelivery:Lr.setConciergeDelivery,sendAnalyticsEvent:U.analyticsEvent}),Une=Ct(Bt,ke(s6t,n6t))(t6t),o6t=({paymentInfo:e})=>{const{RadioIconDisabled:t}=ha;return s.jsxs(zs,{as:"span",direction:"row",wrap:"nowrap",children:[s.jsx(t,{error:!0,name:"status_no"}),s.jsx(Qd,{paymentInfo:e})]})},r6t=({paymentInfo:e})=>s.jsx(ve,{children:s.jsx(o6t,{paymentInfo:e})}),a6t=({paymentTitle:e,paymentInfo:t,onSelectPaymentMethod:n,fundingInstrumentId:o,updatePayerForRecurringOrder:r,showRecurringOrderCheckbox:a,payerForRecurringOrder:i,paymentSectionRef:l,showSavePaymentDetailsCheckbox:c,isYourWalletEnabled:d,isExternalWalletManagement:u})=>s.jsx(Y.Item,{colSpan:{xs:12,md:4},children:s.jsxs(ve,{className:"salt-m-b--4",children:[s.jsx(ne,{as:"h2",ref:l,className:"salt-m-b--2",children:e}),u&&s.jsx(r6t,{paymentInfo:t}),d&&s.jsx(uE,{isFailedPayment:!0,showRecurringOrderCheckbox:a,updatePayerForRecurringOrder:r,payerForRecurringOrder:i,"data-test":"payment-method-wallet",onSelectPaymentMethod:n,failedPaymentFundingInstrumentId:o,enablePayByCardOptionWhenNoMetadataAvailable:!0}),c&&s.jsx(ML,{})]})}),i6t=({buttonActions:e})=>s.jsx(b,{intent:"action",fill:!0,onClick:e[0],"data-test":"update-payment-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"payment.failed.update.payment.button"})})}),l6t=({cardWidth:e,basketSummary:t,confirmPayment:n})=>{const o=!t;return s.jsx(Y.Item,{colSpan:{xs:12,md:e},children:s.jsx("div",{className:"salt-m-b--4",children:s.jsx(gs,{children:o&&s.jsx(Ns.Skeleton,{})||s.jsxs(h.Fragment,{children:[s.jsx(se,{align:"left",children:s.jsx(ae.TotalInline,{loading:o,totalPrice:t.finalPrice})}),s.jsx(ae.Buttons,{children:s.jsx("div",{className:"salt-p-t--4",children:s.jsx(i6t,{buttonActions:[n]})})})]})})})})},c6t=404,d6t=({statusCode:e})=>e===c6t?s.jsx(lt,{}):s.jsx(ur,{showRefreshLink:!0}),u6t=({actions:e,paymentSession:t,orderId:n})=>{const[o,r]=h.useState(void 0),{completeFailedPaymentAuthentication:a}=Fne({orderId:n});h.useEffect(()=>{const d=({eventType:u,payload:m})=>{switch(u){case an.PAYMENT_REQUESTED:r(void 0),e.openPaymentAuthenticationModal();break;case an.PAYMENT_CANCELLED:e.closeModal();break;case an.INITIATE_AUTHENTICATION:r(m.authenticationUrl);break}};return t.subscribe(d),()=>{e.closeModal(),t.unsubscribe(d)}},[t]);const i=d=>a({resultToken:d}),l=()=>e.closeModal(),c=o&&{state:{pspweb:{url:o}}};return s.jsx(MT,{handleError:l,handleSuccess:i,url:o,location:c||{}})},p6t=ot({closeModal:Z.closeModal,openPaymentAuthenticationModal:()=>Z.openModal("paymentPsp")}),m6t=ke(null,p6t)(u6t),h6t=D("pay.ew"),g6t=D("pay.ywlt"),E6t=D("rocpm"),f6t=D("rocpm.fpf"),y6t=D("pay.pam"),I6t=()=>{const e=F(),t=M(),{orderId:n}=co(),{pathname:o}=Ne(),r=We(),a=E(ac),i=E(vg),l=E(Yt),c=E(Ds),d=E(Pg),u=E(h6t),m=E(g6t),g=E(E6t),f=E(f6t),y=E(y6t),[I,S]=h.useState(void 0),C=!u&&g&&f&&!!c.order?.recurringShoppingDefinition,_=OL();NZ();const[A,x]=h.useState(void 0),[R,O]=h.useState(!1),N=h.useRef(null),k=new VL,j=!!c.order?.recurringShoppingDefinition,w=E(Dg),{paymentOption:L,paymentType:B}=E(jp),W=E(Je=>Je.session.isSuperuser);h.useEffect(()=>{j&&(x(C?!1:void 0),e(kt.setToSavePaymentMethod(!0)))},[j]),h.useEffect(()=>(k.subscribeToEvent(an.PAYMENT_REQUESTED,te),k.subscribeToEvent(an.INITIATE_AUTHENTICATION,ye),()=>{k.unsubscribeToEvent(an.PAYMENT_REQUESTED,te),k.unsubscribeToEvent(an.INITIATE_AUTHENTICATION,ye)}),[k]),h.useEffect(()=>{!l&&!c.isFetching&&n&&e(Wo.getOrderWithRecurringNotification(n)).catch(Je=>{Me.api.pushError(new Error(`getOrder() call in FailedPaymentSummary component. ${Je.message}`))}),$(),Ae()},[]),jT();const $=()=>{R||(O(!0),e(U.analyticsEvent({type:xt.FAILED_PAYMENT,orderId:n})))},K=({walletItemId:Je})=>{S(Je),e(U.analyticsEvent({type:xt.SELECT_WALLET_ITEM,description:"User selected payment method",pageEventAttributes:{page:o,walletItemId:Je||"NOT_SAVED"}}));const Ie={event:"event",eventCategory:"Payment",eventAction:"SelectWalletItem",eventLabel:o,walletItemId:Je||"NOT_SAVED"};J.sendEvent({GA:Ie,WA:null}),Q(!1)},Q=(Je=!1)=>e(kt.setUnselectedPaymentWarning(Je)),X=()=>{const Je=a?.paymentInfo?.fundingInstrumentId;return Je&&d.items.some(({fundingInstrumentId:Ie,expired:je})=>Ie!==Je&&!je)},re=()=>{const Je=!!I;return u||X()&&Je},ue=()=>{!X()&&!W?e(dE.startAddWalletItem()):Q(!0)},te=()=>{re()?ce():ue()},ce=()=>{e(ZJe({orderId:n,paymentSession:k,payerForRecurringOrder:A,paymentMethod:de(),navigate:r}))},de=()=>({group:L,type:B||"UNKNOWN",toSave:w,walletItemId:I}),ye=Je=>{const{authenticationUrl:Ie}=Je.payload;y||r(p2(n),{state:{psp:null,datacash:null,braintree:null,pspweb:Ie&&{url:Ie}}})},Ae=()=>{N.current?.scrollIntoView({block:"center",behavior:"smooth"})};if(h.useEffect(()=>{m||e(kt.setPaymentOptionAndType({paymentOption:ct.PAY_NOW,paymentType:at.UNKNOWN}))},[e,m]),c.error)return s.jsx(d6t,{statusCode:c.error.statusCode});if(a?.paymentInfo?.isFundingInstrumentUpdatable===!1)return s.jsx(Qn,{to:"/?notification=failed-payment-not-updatable"});if(a?.paymentInfo?.isFundingInstrumentUpdatable){const Ie=_&&!j;return s.jsxs(h.Fragment,{children:[s.jsxs(An,{children:[s.jsx(ne,{as:"h1",children:s.jsx(v,{id:"payment.failed.heading"})}),s.jsxs(P,{"data-test":"order-reference",children:[s.jsx(v,{id:"payment.failed.order.reference"}),": ",n]})]}),s.jsx("div",{className:"salt-m-x--2 salt-m-b--2",children:s.jsxs(Y,{fixed:!0,flush:!0,"data-test":"summary-grid",children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Ce,{"data-test":"payment-method-warning",className:"salt-m-b--2 md:salt-m-b--0",text:s.jsx(v,{id:"payment.failed.declined.intro"}),showIcon:!1})}),s.jsxs(Y.Item,{colSpan:{xs:12,md:8},children:[s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx("div",{className:"salt-m-b--2 md:salt-m-b--4",children:s.jsx(Une,{delivery:i,canChangeDelivery:!1})})}),s.jsx(a6t,{paymentTitle:t.formatMessage("checkout.summary.payment.method.title"),paymentInfo:a?.paymentInfo,fundingInstrumentId:a?.paymentInfo?.fundingInstrumentId,onSelectPaymentMethod:K,updatePayerForRecurringOrder:x,showRecurringOrderCheckbox:C,payerForRecurringOrder:!!A,paymentSectionRef:N,showSavePaymentDetailsCheckbox:Ie,isYourWalletEnabled:m,isExternalWalletManagement:u})]}),s.jsx(l6t,{cardWidth:4,confirmPayment:()=>k.requestPayment(),basketSummary:a})]})}),s.jsx(tZ,{}),y&&n&&s.jsx(m6t,{orderId:n,paymentSession:k})]})}return null},Gne=e=>s.jsx(os,{type:"FailedPaymentSummary::route",children:s.jsx(I6t,{...e})});Gne.fetchData=({context:{store:e},params:t})=>e.dispatch(Wo.getOrderWithRecurringNotification(t.orderId));const S6t=({buttonAction:e})=>s.jsx(b,{intent:"action",fill:!0,onClick:e,"data-test":"back-to-shop-button",children:s.jsx(v,{id:"payment.failed.back.to.shop.button"})}),C6t=({paymentSummary:e,buttonAction:t})=>e?s.jsxs(h.Fragment,{children:[s.jsx(se,{align:"left",children:s.jsx(ae.TotalInline,{loading:!e,totalPrice:e.finalPrice})}),s.jsx(ae.Buttons,{children:s.jsx("div",{className:"salt-p-t--4",children:s.jsx(S6t,{buttonAction:t})})})]}):s.jsx(Ns.Skeleton,{}),T6t=({recurringOrderPaymentUpdateResult:e})=>{if(!e)return null;const{paymentMethodUpdated:t}=e;return t?s.jsx(Ce,{intent:"success",text:s.jsx(v,{id:"payment.failed.payment.method.updated"}),className:"salt-m--4",showIcon:!1}):s.jsx(Ce,{intent:"warning",text:s.jsx(v,{id:"payment.failed.payment.method.not.updated"}),className:"salt-m--4",showIcon:!1})},_6t=()=>{const e=F(),t=We(),{orderId:n}=co(),o=E(Ds),r=E(ac),a=E(Yt),i=E(vg),[{recurringOrderPaymentUpdateResult:l},c]=h.useState({}),d=()=>t(pn());return h.useEffect(()=>{!a&&!o.isFetching&&n&&e(Wo.getOrderWithRecurringNotification(n));const u=sessionStorage.getItem("paymentUpdate");c(u&&JSON.parse(u)||{})},[]),jT(),s.jsxs(h.Fragment,{children:[s.jsxs(An,{children:[s.jsx(ne,{as:"h1",children:s.jsx(v,{id:"payment.failed.thanks"})}),s.jsxs(P,{"data-test":"order-reference",children:[s.jsx(v,{id:"payment.failed.order.reference"}),": ",n]})]}),s.jsx(T6t,{recurringOrderPaymentUpdateResult:l}),s.jsx("div",{className:"salt-m-b--2 salt-m-x--2",children:s.jsxs(Y,{fixed:!0,flush:!0,"data-test":"complete-grid",children:[s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx("div",{className:"salt-m-b--4",children:s.jsx(Une,{delivery:i,canChangeDelivery:!1})})}),s.jsx(Y.Item,{colSpan:{xs:12,md:6},children:s.jsx("div",{className:"salt-m-b--2",children:s.jsx(gs,{children:s.jsx(C6t,{buttonAction:d,paymentSummary:r})})})})]})})]})},$ne=e=>s.jsx(os,{type:"FailedPaymentComplete::route",children:s.jsx(_6t,{...e})});$ne.fetchData=({context:{store:e},params:t})=>e.dispatch(Wo.getOrderWithRecurringNotification(t.orderId));const v6t=e=>[{path:"/failed-payment/:orderId",Component:ws(Ze,e.Main),children:[{index:!0,Component:Gne},{path:"3ds",Component:Bne},{path:"complete",Component:$ne}]},{path:"/complete-tokenization/continue",Component:ws(Ze,e.Main),children:[{index:!0,Component:X5t}]}],A6t=D("slfsrv.refunds"),b6t=e=>[{path:"/orders/:orderId/refund-request",Component:ws(Ze,e.Main),children:[{index:!0,lazy:async()=>{const{RefundRequestPage:t}=await Rn(async()=>{const{RefundRequestPage:n}=await import("./refund-request-page-TxTGNEMq.js");return{RefundRequestPage:n}},__vite__mapDeps([18,1,2,3]));return{Component:Xt(A6t,t,lt)}}}]}],x6t=D(Ud),R6t=(e,{isUserLoggedIn:t=Ze}={})=>[{path:"/regulars",Component:e.Main,children:[{index:!0,lazy:async()=>{const{Regulars:n}=await Rn(async()=>{const{Regulars:o}=await import("./regulars-D1N0L6Px.js");return{Regulars:o}},__vite__mapDeps([19,1,2,3]));return{Component:ws(t,Xt(x6t,n,lt))}}}]}],Hne=D("seo.rdbl"),D6t=D("rec"),O6t=D("bt.top"),P6t=()=>{const e=ho(),t=M(),n=Ne(),o=We(),r=Mb(),a=E(Sp,Lu),i=E(Vs),l=E(Vde),c=E(Rx),d=E(Px),u=JSON.stringify(E(Q1)),m=E(Dx),g=E(Ip),f=E(Clt,Lu),y=E(x3e,Lu),I=E(Y1),S=E(og),C=E(Hne),_=E(O6t),A=nE(),x=tt.parse(n.search).sublocationId||void 0,R=new zi,O={breadcrumbPreface:t.formatMessage("search.breadcrumb.preface"),noResultsSubtext:t.formatMessage("search.no.results.title.subtext")},N=tt.parse(n.search).q||void 0,{fetchSearchResultsPage:k}=ST(),j=()=>{const{searchTerm:re,correctedSearchTerm:ue}=a;return ue||re||N},w=()=>{e(ks({name:LTe,attributes:{searchTerm:N}}))},L=()=>{const re=c.find(te=>te.selected)?.id,{correctedSearchTerm:ue}=a;e(U.analyticsEvent({type:hs.SEARCH_PAGE_VIEWED,searchTerm:N,correctedSearchTerm:ue,locale:i,mlModelIds:l,sort:re,searchSuggestionType:n.state?.source}))},B=()=>{const{correctedSearchTerm:re,searchTerm:ue}=a;if(m){e(U.analyticsEvent({type:hs.SEARCH_EVENT,searchTerm:ue,correctedSearchTerm:re,locale:i,searchSuggestionType:n.state?.source}));const te={event:"search",corrected_search_term:re,locale:i,search_term:ue};J.sendEvent({GA:te,WA:null}),e(U.analyticsEvent({type:hs.GA_SHOW_SEARCH_PAGE,searchTerm:ue,correctedSearchTerm:re,locale:i}));const ce={event:"event",eventCategory:"Search",pagePartType:"SEARCH",eventAction:"GA_SHOW_SEARCH_PAGE",eventLabel:ue,searchTerm:ue,correctedSearchTerm:re,locale:i};J.sendEvent({GA:ce,WA:null})}};h.useEffect(()=>()=>{e(Tr.updateItemAddedToBasket(!1))},[]),h.useEffect(()=>{a.searchTerm&&(L(),B())},[a,d,u,x]);const W=({category:re=void 0,sortOption:ue=void 0,filters:te={}}={})=>li(C,{queryString:ES({category:re,filters:te,sortOption:ue,additional:{q:N}})}),$=re=>s.jsx(P,{bold:!0,className:"salt-d--inline",children:re}),K=()=>{const{searchTerm:re,correctedSearchTerm:ue}=a;return ue&&re!==ue?s.jsx(v,{id:"search.breadcrumb.subtitle",values:{searchTerm:$(re),correctedSearchTerm:$(ue)}}):null},Q=({category:re,nextPageToken:ue})=>e(QN({category:re,pageToken:ue,additional:{term:N},isRetailerCategoryId:!1,headers:XN(R)})).then(te=>{!S&&te&&te.nextPageToken&&te.productCount===0&&Q({category:re,nextPageToken:te.nextPageToken})}),X=j();return!N||typeof N!="string"||N.trim()===""?C?s.jsx(Qn,{to:Zo()}):s.jsx(Qn,{to:jo()}):s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"search.page.title",values:I?{searchTerm:N}:{searchTerm:X}}),s.jsx(CT,{navigate:o,fetchPage:k,fetchNextPage:Q,page:"search",getTargetUrl:re=>W(re),breadcrumbPreface:O.breadcrumbPreface,rootBreadcrumb:{name:X,url:W()},breadcrumbSubtitle:K(),location:n,navigationType:r,noProductsFilteredPage:({clearFilters:re})=>s.jsx(TT,{clearFilters:re,page:"search",term:X}),noProductsPage:()=>s.jsx(yX,{icon:"search",page:"search",subtext:O.noResultsSubtext,term:X}),onInitialFopLoad:w,pageError:g,showSortAndFilters:!0,withinGridProductCards:[...f,...y],shouldShowScrollToTopButton:_?!1:A}),_&&s.jsx(_T,{})]})},Ob=()=>s.jsx(os,{type:"Search::route",children:s.jsx(P6t,{})});Ob.fetchData=async({context:{store:e,url:t,cookies:n}})=>{const o=e.getState(),r=Wt(o),a=Hne(o),i=t.searchParams.get("q")??"",l=t.searchParams.get("sublocationId")??"",c=t.searchParams.get("sortBy")??"",d=t.searchParams.toString();if(typeof i=="string"&&i.length){const u=fp(tt.parse(t.search)),m=QN({category:l,filters:u,sortOption:c,additional:{term:i},isRetailerCategoryId:!1,headers:XN(n)}),g=`${t.pathname}${t.search}`,f=r?.length?g.replace(r,""):g,y=[e.dispatch(m).then(()=>{e.dispatch(ft.setLastFetchedCatalogueLocation(f))}),e.dispatch(nX(i)),...D6t(o)?[e.dispatch(sX(i))]:[]];await Promise.all(y)}if(a){const u=`${t.pathname}${t.search}`,m=li(a,{queryString:d,basePath:r});if(u.toLowerCase()!==m.toLowerCase())return L$(m,ai.MOVED_PERMANENTLY)}};const N6t=e=>[{path:"/products/search",Component:e.Main,key:"main",children:[{path:"/products/search",Component:Ob,key:"/products/search"}]},{path:"/search",Component:e.Main,key:"main",children:[{path:"/search",Component:Ob,key:"/search"}]}],L6t=()=>{const{formatMessage:e}=M(),t=E(bh),n=Cs("loyalty-scheme-url"),o=Yp({getQuantity:bh});return s.jsxs(h.Fragment,{children:[t&&t.units!==void 0?s.jsxs("div",{children:[s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"settings.loyalty.heading"})}),s.jsx(Ee,{children:s.jsx(P,{children:e("settings.loyalty.amount.description",{amount:o})})}),s.jsx(P,{size:"l","aria-hidden":!0,className:"salt-m-t--2 salt-m-b--8 salt-d--block",children:o})]}):null,s.jsx(b,{asChild:!0,intent:"primary","data-test":"loyalty-manage-button","aria-label":e("settings.loyalty.manage.alternative"),children:s.jsx(rt,{intent:"ghost",href:n,target:"_blank",children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.loyalty.manage"})})})})]})},k6t=()=>s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"settings.loyalty.page.title"}),s.jsx(L6t,{})]}),M6t=()=>{const e=M(),t=F(),n=E(Ep),o=E(hH),r=$T(n,e),a=(n||[]).map(d=>({value:d,label:r[d]})),i=d=>t(bs.updateCustomerLanguage(d))?.then(()=>{t(U.analyticsEvent({type:nr.LOCALE_CHANGED,locale:d}));const u={event:"event",eventAction:"LOCALE_CHANGED",eventCategory:"Locale",eventLabel:d};J.sendEvent({GA:u,WA:null}),t(U.analyticsEvent({type:nr.LOCALE_CHANGED_GA4,locale:d}));const m={event:"locale_changed",locale:d};J.sendEvent({GA:m,WA:null})}),l=d=>{d.preventDefault();const u=new FormData(d.currentTarget).get("language")?.toString();!u||o===u||i(u).then(()=>t(bs.getCurrentCustomer())).then(()=>{z.success("settings.account.details.update.success"),EE(u)}).catch(()=>{z.error("settings.account.details.update.error")})},c={text:e.formatMessage("accountSettings.language.selection.label"),isVisuallyConcealed:!0};return s.jsx(Y,{children:s.jsx(Y.Item,{colSpan:{xs:12,sm:11,md:8,lg:4},children:s.jsx(ve,{children:s.jsxs(mt,{onSubmit:l,children:[s.jsx(mt.RadioGroup,{name:"language",radios:a,groupLabel:c,defaultValue:o||n?.[0]||""}),s.jsx(b,{type:"submit",intent:"primary",className:"salt-m-t--4","data-test":"language-submit-button",children:s.jsx(b.Text,{children:e.formatMessage("settings.language.save")})})]})})})})},Vne=()=>{const e=F(),t=E(ec),n=E(Yt);return h.useEffect(()=>{(!n||!t?.lastUpdated)&&e(bs.getCurrentCustomer())},[]),s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"settings.language.page.title"}),s.jsx(Ee,{children:s.jsx(v,{id:"settings.language.heading"})}),s.jsx("div",{className:"salt-m-b--4",children:s.jsx(M6t,{})})]})};Vne.fetchData=({context:{store:e}})=>e.dispatch(bs.getCurrentCustomer());const j6t={message:p.oneOfType([p.string,p.object]).isRequired,testAttribute:p.string,type:p.string.isRequired},w6t={testAttribute:void 0},F6t=T.div`
    inline-size: 100%;

    ${oe.smUp`
        width: 100%;
    `}

    ${oe.mdUp`
        width: 33%;
    `};

    ${oe.lgUp`
        width: 33%;
    `}
`,pM=({message:e,testAttribute:t,type:n})=>s.jsx(F6t,{children:s.jsx(Ce,{intent:n,"data-test":t,text:e,className:"salt-p--2",showIcon:!1})});pM.defaultProps=w6t;pM.propTypes=j6t;const B6t=e=>async(t,n)=>{const o=rr(n());try{await t(ph.removeCustomerWalletItem(e,o));const r={event:"event",eventAction:"REMOVE_WALLET_ITEM_SUCCESS",eventCategory:"Settings",eventLabel:"Not Set"};J.sendEvent({GA:r,WA:null}),z.success("settings.wallet.remove.item.success"),t(Z.closeModal())}catch{const r={event:"event",eventAction:"REMOVE_WALLET_ITEM_ERROR",eventCategory:"Settings",eventLabel:"Not Set"};J.sendEvent({GA:r,WA:null}),z.error("settings.address.book.remove.modal.error")}},U6t={removeWalletItem:B6t},G6t=D("m.la.h"),$6t={actions:p.shape({closeModal:p.func.isRequired,removeWalletItem:p.func.isRequired}).isRequired,isOpen:p.bool,intl:p.any.isRequired,walletItem:p.shape({walletItemId:p.string,fundingInstrumentId:p.string,isDefault:p.bool,paymentMethod:p.string,details:p.shape()}),modalLeftAlignEnabled:p.bool},H6t={walletItem:{},isOpen:!1,modalLeftAlignEnabled:!1},mM=({actions:e,isOpen:t,intl:n,walletItem:o,modalLeftAlignEnabled:r})=>{const a={removeWalletItemModalTitle:n.formatMessage("settings.wallet.remove.item.modal.title"),cancelButtonModal:n.formatMessage("settings.wallet.remove.item.modal.cancel"),cancelButtonAriaLabel:n.formatMessage("settings.wallet.remove.item.modal.cancel.ariaLabel"),removeWalletItemModalSubmitButton:n.formatMessage("settings.wallet.remove.item.modal.submit"),removeWalletItemModalSubmitAriaLabel:n.formatMessage("settings.wallet.remove.item.modal.submit.ariaLabel")},i=()=>{e.closeModal()},l=()=>{i()},c=ed(()=>{e.removeWalletItem(o.walletItemId)},200),d="remove-wallet-item-modal-header",u=o.paymentMethod===at.CARDS||o.paymentMethod===at.PAYPAL;return s.jsxs(G,{isOpen:t,onRequestClose:i,aria:{labelledby:d},children:[s.jsx(G.Header,{align:r?"left":"center",children:s.jsx(ne,{as:"h2",id:d,"data-test":d,children:a.removeWalletItemModalTitle})}),u&&s.jsx(G.Body,{children:s.jsx(ve,{"data-test":"wallet-item-remove-modal-card-details",children:s.jsx(Qd,{paymentInfo:{paymentMethodV2:o.paymentMethod,...o.details}})})}),s.jsxs(G.Footer,{align:r?"left":"center",className:"salt-gap--2",children:[s.jsx(b,{onClick:l,intent:"secondary",fill:!0,"aria-label":a.cancelButtonAriaLabel,children:s.jsx(b.Text,{children:a.cancelButtonModal})}),s.jsx(b,{intent:"primary",fill:!0,onClick:c,"data-test":"wallet-item-remove-confirm-button","data-synthetics":"wallet-item-remove-confirm-button","aria-label":a.removeWalletItemModalSubmitAriaLabel,children:s.jsx(b.Text,{children:a.removeWalletItemModalSubmitButton})})]})]})};mM.defaultProps=H6t;mM.propTypes=$6t;const V6t=e=>({isOpen:Ue("removeWalletItem")(e),modalLeftAlignEnabled:G6t(e)}),Y6t=ot({closeModal:Z.closeModal,removeWalletItem:U6t.removeWalletItem}),W6t=Ct(Bt,ke(V6t,Y6t))(mM),q6t="PAYPAL",K6t="CARDS",z6t=D("pay.surm");class Q6t extends h.Component{formattedMessages;impressionSent;queuedImpressions;constructor(t){super(t),this.remove=this.remove.bind(this),this.formattedMessages={addItem:this.props.intl.formatMessage("settings.wallet.item.add"),addItemEmpty:this.props.intl.formatMessage("settings.wallet.item.add.empty.wallet"),makePrimary:this.props.intl.formatMessage("settings.wallet.item.button.make.primary"),removeItem:this.props.intl.formatMessage("settings.wallet.item.button.remove")},this.state={item:{}},this.impressionSent={},this.queuedImpressions=[]}componentDidMount(){(!this.props.isServerRendered||!this.props.wallet.lastUpdated)&&this.props.actions.getWalletItems(),this.sendImpressions()}componentDidUpdate(){this.sendImpressions()}getCardHeader(t){return s.jsx(wh,{paymentInfo:{paymentMethodV2:t.paymentMethod,...t.details}})}getCardBody(t){return s.jsx(Dh,{paymentInfo:{paymentMethodV2:t.paymentMethod,...t.details}})}getCardButtons(t){return s.jsx(b,{onClick:()=>this.remove(t),intent:"secondary","aria-label":this.generateRemoveAriaLabel(t),"data-synthetics":"wallet-item-remove-button","data-test":"wallet-item-remove-button",fill:!0,children:s.jsx(b.Text,{children:this.formattedMessages.removeItem})})}generateRemoveAriaLabel(t){const{paymentMethod:n,details:o}=t;if(n===q6t)return this.props.intl.formatMessage("settings.wallet.item.button.remove.aria.paypal",{emailAddress:o.emailAddress});if(n===K6t){const r=`${o.expiryMonth}/${o.expiryYear}`;return this.props.intl.formatMessage("settings.wallet.item.button.remove.aria.card",{cardType:o.cardTypeDisplayName,last4Digits:o.lastFourDigits,cardExpiryDate:r})}}remove(t){this.setState({item:t},()=>{this.props.actions.openRemoveItemModal()})}impression(t,n){n!==void 0&&!this.impressionSent[n]&&(this.queuedImpressions.push(t),this.impressionSent[n]=!0)}sendImpressions(){this.queuedImpressions.length>0&&(this.props.actions.analyticsEvent({type:xt.WALLET_ITEM_IMPRESSION,walletItemImpressions:this.queuedImpressions}),this.queuedImpressions=[])}buildItem(t){this.impression({IS_DEFAULT:t.isDefault,WALLET_ITEM_ID:t.walletItemId},t.walletItemId);const n=!this.props.isSuperuser||this.props.isSuperUserRemoveWalletItemEnabled;return s.jsxs(He.Action,{"data-test":"wallet-item-card","data-synthetics":"wallet-item-card",children:[s.jsx(He.Action.Header,{"data-pii":"true",children:this.getCardHeader(t)}),s.jsx(He.Action.Body,{"data-pii":"true","data-test":"wallet-item-id",children:this.getCardBody(t)}),n&&s.jsx(He.Action.Footer,{children:this.getCardButtons(t)})]},t.walletItemId)}buildAddItem(t){return s.jsx(He.Action,{"data-synthetics":"wallet-item-add-card",children:s.jsx(b,{onClick:this.props.actions.startAddWalletItem,intent:"secondary","data-test":"wallet-item-add-button","data-synthetics":"wallet-item-add-button",children:s.jsx(b.Text,{children:this.props.isTextButtonWalletItemAware&&this.props.wallet.items.length===0?this.formattedMessages.addItemEmpty:this.formattedMessages.addItem})})},t.walletItemId)}buildCard(t){return t.type==="PLACEHOLDER"?s.jsx(He.Action.Skeleton,{},t.walletItemId):t.type==="ADD_WALLET_ITEM"?this.props.isSuperuser?null:this.buildAddItem(t):this.buildItem(t)}getWalletTextBoxIndication(){return s.jsx(pM,{message:s.jsx(v,{id:"settings.wallet.page.textbox.indication"}),type:"info",testAttribute:"textIndication"})}render(){const{wallet:t,isTextboxWalletIndicationAllowed:n}=this.props,o=t.lastUpdated?[...t.items,{walletItemId:"99",type:"ADD_WALLET_ITEM"}]:Array.from(Array(3),(r,a)=>({walletItemId:`${a}`,type:"PLACEHOLDER"}));return t.fetchError?s.jsx(eu,{action:this.props.actions.getWalletItems}):s.jsxs(h.Fragment,{children:[s.jsx(Ee,{children:s.jsx(v,{id:"settings.wallet.heading"})}),s.jsx(He.Collection,{children:o.map(r=>this.buildCard(r))}),s.jsx(kL,{}),n&&this.getWalletTextBoxIndication(),s.jsx(W6t,{walletItem:this.state.item})]})}}const X6t=e=>({wallet:Pg(e),isSuperuser:e.session.isSuperuser,isServerRendered:Yt(e),isTextButtonWalletItemAware:qe(e,"textbox-visibility-management-add-wallet-item-button-text-is-wallet-items-aware")==="true",isTextboxWalletIndicationAllowed:qe(e,"textbox-visibility-management-wallet-textbox-message")==="true",isSuperUserRemoveWalletItemEnabled:z6t(e)}),Z6t=ot({getWalletItems:sm.getWalletItems,startAddWalletItem:dE.startAddWalletItem,openRemoveItemModal:()=>Z.openModal("removeWalletItem"),analyticsEvent:U.analyticsEvent}),J6t=Ct(Bt,ke(X6t,Z6t))(Q6t),Yne=()=>{const e=Ne();return h.useEffect(()=>{const t=tt.parse(e.search).error;if(t){const n=`add.wallet.item.failure.${t}`;Object.prototype.hasOwnProperty.call(n)&&z.error(n)}},[e]),s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"settings.wallet.page.title"}),s.jsx(J6t,{})]})};Yne.fetchData=({context:{store:e}})=>e.dispatch(sm.getWalletItems());function e8t({subscription:e,isFreeTrial:t=!1}){const n=E(da),o=TE(),{expiry:r,paymentInformation:a}=e.customerSubscription.subscription;if(!a)return null;const i=e.metadata.isPlanAutoRenewing?s.jsx(P,{"data-test":"renewalMessage",children:s.jsx(v,{id:"delivery.pass.expires.off",values:{renewalDate:yt(r,n)}})}):null;return s.jsxs(ve,{className:"salt-p-x--0 salt-p-y--0 ",children:[s.jsxs(se,{className:"salt-m-b--2",direction:"column",gap:["sm"],children:[s.jsxs(P,{bold:!0,size:"l",children:[s.jsx(v,{id:"delivery.pass.payment.details"}),":"]}),s.jsxs(se,{gap:["sm"],align:"flex-end",children:[t?s.jsx(P,{size:"l",bold:!0,intent:"promotion",children:o({cost:{amount:"0.00",currency:e.customerSubscription.plan.cost.currency}}).toStringWithCurrency()}):s.jsx(P,{size:"l",bold:!0,children:o(e.customerSubscription.plan).toStringWithCurrency()}),t&&s.jsx(P,{size:"s",bold:!0,strikethrough:!0,children:o(e.customerSubscription.plan).toStringWithCurrency()})]})]}),s.jsx(Qd,{paymentInfo:{nonSavedFundingInstrument:!1,paymentMethodV2:a.paymentMethodTypeV2,...a.details}}),i]})}const t8t=({addresses:e=[]})=>s.jsx(ie.Fragment,{children:e.length>0&&s.jsxs("div",{children:[s.jsx("div",{className:"salt-p-b--2",children:s.jsxs(P,{bold:!0,size:"l",children:[s.jsx(v,{id:"delivery.pass.list.valid.addresses.text"}),":"]})}),s.jsx(Ve,{children:e.map(t=>s.jsx(Ve.Item,{children:s.jsx(se,{align:"flex-start",justify:"flex-start",wrap:"nowrap",children:s.jsxs("div",{"data-test":"address-item",children:[s.jsxs(P,{size:"s",bold:!0,children:[t.nickname,":"]}),s.jsx(P,{size:"s",className:"salt-m-l--1",children:t.address})]})})},t.addressId))})]})}),Wne="BLANK_SPACE";function s8t(e){return Array.isArray(e)?s.jsx(h.Fragment,{children:e.map(t=>t.id===Wne?s.jsx("span",{children:" "}):s.jsx(v,{...t},t.id))}):s.jsx(v,{...e})}const n8t=T.div`
    text-align: start;
`;function o8t({message:e,testAttribute:t,type:n}){return s.jsx(n8t,{className:"salt-p-b--2",children:s.jsx(Ce,{intent:n,showIcon:!1,"data-test-type":n,"data-test":t,text:s8t(e)})})}function qv(e,t){return s.jsx(o8t,{...e,type:t})}const fr={success:e=>qv(e,"success"),error:e=>qv(e,"error"),warning:e=>qv(e,"warning")},yr={createTransitioningNewPlanMessage:e=>fr.success({message:{id:"settings.delivery.pass.auto.switch.new.plan.message",values:e},testAttribute:"renewalMessage"}),createExpiryMessage:e=>fr.warning({message:{id:"delivery.pass.expires.on",values:e},testAttribute:"expiryMessage"}),createPendingMessage:()=>fr.warning({message:{id:"subscription.alert.deliverypass.pending.message"},testAttribute:"pendingMessage"}),createTransitioningCurrentPlanMessage:e=>fr.warning({testAttribute:"renewalMessage",message:{id:"settings.delivery.pass.auto.switch.current.plan.message",values:e}}),createPlanWillTransitionMessage:({expiry:e,planDescription:t,planName:n})=>fr.warning({testAttribute:"autorenewal-enabled-transitioning-plan-alert",message:[{id:"settings.delivery.pass.auto.switch.on.message",values:{passName:`${n} - ${t}`,transitioningDate:e.expiryDate}},{id:Wne},{id:"settings.delivery.pass.auto.switch.on.link.label"}]}),createPlanTerminatedMessage:({expiry:e,planDescription:t,planName:n})=>fr.error({testAttribute:"renewal-disabled-alert",message:{id:"delivery.pass.plan.terminated.message",values:{pass:`${n} - ${t}`,...e}}}),createAutoRenewOffMessage:({expiry:e,planName:t,planDescription:n})=>fr.warning({testAttribute:"renewal-off-alert",message:{id:"settings.delivery.pass.auto.renew.off.message",values:{pass:`${t} - ${n}`,...e}}}),createAutoRenewOnMessage:({benefitName:e,expiry:t})=>fr.success({message:{id:"settings.delivery.pass.auto.renew.on.message",values:{pass:e,...t}},testAttribute:"autorenewal-enabled-alert"}),createFreeTrialAutoRenewOnMessage:({benefitName:e,expiry:t})=>fr.success({message:{id:"settings.delivery.pass.free.trial.auto.renew.on.message",values:{pass:e,...t}},testAttribute:"autorenewal-enabled-alert"}),createReauthRequiredMessage:({benefitName:e,benefitDescription:t})=>fr.error({message:{id:"settings.delivery.pass.reauth.message",values:{pass:`${e} - ${t}`}},testAttribute:"subscription-reauth-required-alert"}),createAutoRenewalHasNoWalletItemAlert:({expiry:e,planName:t,planDescription:n})=>fr.warning({message:{id:"settings.delivery.pass.auto.renew.no.wallet.item.message",values:{pass:`${t} - ${n}`,...e}},testAttribute:"autorenewal-no-wallet-item-alert"}),createAutoSwitchNewPlan:e=>fr.success({message:{id:"settings.delivery.pass.auto.switch.new.plan.message",values:e},testAttribute:"renewalMessage"}),createFreeTrialAutorenewOffMessage:({benefitName:e,expiry:t})=>fr.warning({message:{id:"settings.delivery.pass.free.trial.cancelled.auto.renew",values:{planName:e,...t}},testAttribute:"freetrial-autorenewal-disabled-alert"})},qne=e=>{function t(r){return{expiryDate:yt(r,e)}}function n({expiry:r,planDescription:a,planName:i}){return{expiry:t(r),planDescription:a,planName:i}}function o({benefitName:r,expiry:a}){return{expiry:t(a),benefitName:r}}return{createTransitioningNewPlanMessage:r=>yr.createTransitioningNewPlanMessage(t(r)),createExpiryMessage:r=>yr.createExpiryMessage(t(r)),createPendingMessage:()=>yr.createPendingMessage(),createTransitioningCurrentPlanMessage:r=>yr.createTransitioningCurrentPlanMessage(t(r)),createPlanWillTransitionMessage:r=>yr.createPlanWillTransitionMessage(n(r)),createPlanTerminatedMessage:r=>yr.createPlanTerminatedMessage(n(r)),createAutoRenewOffMessage:r=>yr.createAutoRenewOffMessage(n(r)),createAutoRenewOnMessage:r=>yr.createAutoRenewOnMessage(o(r)),createFreeTrialAutoRenewOnMessage:r=>yr.createFreeTrialAutoRenewOnMessage(o(r)),createFreeTrialAutorenewOffMessage:r=>yr.createFreeTrialAutorenewOffMessage(o(r)),createReauthRequiredMessage:r=>yr.createReauthRequiredMessage(r),createAutoRenewalHasNoWalletItemAlert:r=>yr.createAutoRenewalHasNoWalletItemAlert(n(r)),createAutoSwitchNewPlan:r=>yr.createAutoSwitchNewPlan(t(r))}},r8t=({calendarDateFormat:e,status:t,info:{expiry:n,benefit:{name:o,description:r},plan:{name:a,description:i}}})=>{const l=qne(e);switch(t){case"Free trial auto renew on":return l.createFreeTrialAutoRenewOnMessage({expiry:n,benefitName:o});case"Free trial auto renew off":return l.createFreeTrialAutorenewOffMessage({expiry:n,benefitName:o});case"Plan will transition":return l.createPlanWillTransitionMessage({expiry:n,planName:a,planDescription:i});case"Auto switch current plan":return l.createTransitioningCurrentPlanMessage(n);case"ReAuth required":return l.createReauthRequiredMessage({benefitDescription:r,benefitName:o});case"Plan terminated":return l.createPlanTerminatedMessage({expiry:n,planName:a,planDescription:i});case"Pending":return l.createPendingMessage();case"Auto renewal has no wallet item":return l.createAutoRenewalHasNoWalletItemAlert({expiry:n,planName:a,planDescription:i});case"Auto renewal off":return l.createAutoRenewOffMessage({expiry:n,planName:a,planDescription:i});case"Auto renewal on":return l.createAutoRenewOnMessage({expiry:n,benefitName:o});case"Expires":return l.createExpiryMessage(n);case"Error: non defined status":default:return null}},a8t=e=>{const{customerSubscription:{subscription:t},metadata:{isPlanRenewable:n,isPlanAutoRenewing:o,isPaymentMethodLinkedToPlan:r,isSubscriptionPlanTransitioning:a,isFreeTrialAvailable:i,isReauthRequired:l}}=e;return i?o?"Free trial auto renew on":"Free trial auto renew off":a?o?"Plan will transition":"Auto switch current plan":l?"ReAuth required":t.nextRenewal&&!t.nextRenewal.planId?"Plan terminated":t.status!=="ACTIVE"?"Pending":o&&!r?"Auto renewal has no wallet item":n?o?"Auto renewal on":"Auto renewal off":t.expiry?"Expires":"Error: non defined status"};function i8t(){return E(da)}function l8t(e){return{expiry:e.customerSubscription.subscription.expiry,benefit:{name:e.customerSubscription.benefit.name,description:e.customerSubscription.benefit.description},plan:{name:e.customerSubscription.plan.name,description:e.customerSubscription.plan.description}}}function c8t(){const e=i8t();return{messages:qne(e),getStatusMesssage:t=>r8t({calendarDateFormat:e,status:a8t(t),info:l8t(t)})}}function d8t({subscription:e,strategy:t}){const{customerSubscription:{subscription:{nextRenewal:n}},metadata:{isFreeTrialAvailable:o}}=e,{messages:r,getStatusMesssage:a}=c8t();switch(t){case"TRANSITION":return{description:n.description,status:r.createAutoSwitchNewPlan(e.customerSubscription.subscription.expiry)};case"DEFAULT":default:return{description:o?e.customerSubscription.plan?.freeTrial?.text??"":e.customerSubscription.plan.description,status:a(e)}}}function p$({subscription:e,showTransitioningInfo:t,isFreeTrial:n}){const{description:o,status:r}=d8t({subscription:e,strategy:t?"TRANSITION":"DEFAULT"});return s.jsxs(se,{direction:"column",className:"salt-gap--4",children:[o&&s.jsx("div",{"data-test":"transitionPlanDescription",children:o}),s.jsx("div",{children:s.jsx(v,{id:"settings.delivery.pass.subscription.card"})}),e.metadata.filteredAddresses.length>0&&s.jsx(t8t,{addresses:e.metadata.filteredAddresses}),s.jsx(e8t,{subscription:e,isFreeTrial:n}),r]})}const u8t=e=>{const t=Mt(),n=Mt(e).diff(t,"d");return String(n)};function Kne({date:e,name:t,translationKey:n}){return s.jsx(v,{id:n,values:{name:t,days:u8t(e)}})}const m$=T.div`
    color: #ddd;
`,p8t=T(se)`
    align-self: flex-start;
    text-align: start;
    inline-size: 100%;
    gap: var(--salt-spacing-4);
`,m8t=T(P)`
    display: flex;
`;function h8t({name:e,description:t,grey:n,chip:o}){return s.jsxs(p8t,{direction:"column",className:"salt-m-b--4",children:[s.jsxs(se,{wrap:"nowrap",justify:"space-between",children:[s.jsxs(m8t,{size:"l",bold:!0,className:"salt-gap--1",children:[s.jsx(me,{name:"delivery_pass",height:24,width:24}),n?s.jsx(m$,{children:e}):e]}),o]}),s.jsx(P,{className:"salt-d--block",children:n?s.jsx(m$,{children:t}):t})]})}function zne({benefit:e,disabled:t,headerChip:n}){return s.jsx(h8t,{name:e.name,description:e.description,grey:t??!1,chip:n})}function g8t({subscription:{customerSubscription:{benefit:e,subscription:t},metadata:{isFreeTrialAvailable:n,filteredAddresses:o}},headerChip:r}){return s.jsx(zne,{disabled:o.length===0,benefit:{name:n?s.jsx(Kne,{name:e.name,translationKey:"delivery.pass.plan.free.trial.name",date:t.expiry}):e.name,description:e.description},headerChip:r})}const E8t=({subscription:{customerSubscription:{benefit:e},metadata:{filteredAddresses:t}}})=>s.jsx(zne,{disabled:t.length===0,benefit:{name:e.name,description:e.description}}),f8t=({getPlanNameStrategy:e})=>({createCurrentPlan:t=>g8t({...t}),createNextPlan:t=>E8t({...t})});function y8t({name:e,amount:t,currency:n}){const o=ze();return s.jsxs(h.Fragment,{children:[e," -"," ",o({amount:t,currency:n})]})}function I8t(e){return t=>s.jsx(y8t,{...e(t),name:t.name})}function S8t({onClick:e,subscriptionId:t}){return s.jsx(b,{className:"salt-m-b--2",asChild:!0,onClick:e,intent:"secondary",fill:!0,size:"m","data-test":"view-receipt-button",children:s.jsx(rt,{intent:"ghost",href:EVe(t),target:"_blank",children:s.jsxs(b.Text,{children:[s.jsx(me,{className:"salt-d--inline-block salt-m-r--1",height:14,width:14,verticalAlign:"middle",name:"pdf"}),s.jsx(v,{id:"settings.delivery.pass.subscription.view.receipt.button"})]})})})}function C8t({subscription:e}){const t=F(),n=()=>{t(U.analyticsEvent({type:Mn.DELIVERY_PASS_RECEIPT_BUTTON_CLICKED}))},{hasReceipt:o,subscriptionId:r}=e.customerSubscription.subscription;return o?s.jsx(S8t,{subscriptionId:r,onClick:n}):null}function T8t({onClick:e,isDisabled:t}){return s.jsx("div",{className:"salt-m-b--2",children:s.jsx(b,{intent:"secondary",fill:!0,onClick:e,...t?{disabled:!0}:{},"data-test":"change-payment-method-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.delivery.pass.subscription.change.payment.method.open.button"})})})})}const _8t=()=>{const e=F();return()=>{e(U.analyticsEvent({type:Mn.EDIT_PAYMENT_DETAILS_BUTTON_CLICKED}))}};function v8t({subscription:e,onReEnableSubscription:t}){const n=_8t(),o=e.metadata.filteredAddresses.length===0;return e.metadata.canChangePaymentMethod?s.jsx(T8t,{isDisabled:o,onClick:()=>(n(),t())}):null}function t_(){const e=F(),t=E(n=>n.control.modal);return{isOpen:n=>t[n]?.isOpen??!1,getOptions:n=>t[n]?.options??void 0,closeModal:()=>e(Z.closeModal()),openFailureModal:()=>e(Z.openModal("deliveryPassSubscriptionFailure")),openPaymentPspModal:()=>e(Z.openModal("paymentPsp")),openSubscriptionEnableModal:n=>e(Z.openModal("deliveryPassSubscriptionEnable",n)),openModal:(n,o)=>e(Z.openModal(n,o))}}function A8t(){const e=fa();return t=>e.deliveryPassEnableAutoRenew(t)}function Qne(){const e=F(),t=A8t();return{logAutoRenewalButtonClicked:()=>{e(U.analyticsEvent({type:Mn.AUTO_RENEWAL_BUTTON_CLICKED,autoRenewalStatus:"enable"}))},logAutoRenewalModalDisplayed:()=>e(U.analyticsEvent({type:Mn.ENABLE_DELIVERY_PASS_AUTO_RENEWAL_MODAL_DISPLAYED,userAction:"open"})),logEnableAutoRenewAnalytics:t}}function b8t({onClick:e}){return s.jsx("div",{className:"salt-m-b--2",children:s.jsx(b,{intent:"secondary",fill:!0,onClick:e,"data-test":"autorenewal-enable-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.delivery.pass.subscription.auto.renew.enable"})})})})}function x8t({before:e,success:t}){const{logEnableAutoRenewAnalytics:n}=Qne(),{openFailureModal:o}=t_(),{enableAutoRenewal:r}=Pr.client.useHooks();return a=>(e(a.retailerSubscriptionPlanId),r(a.retailerSubscriptionPlanId).then(()=>{n(a),t(a.retailerSubscriptionPlanId)}).catch(o))}function R8t({subscription:e,onReEnableSubscription:t}){const n=Qne(),o=t_(),{customerSubscription:{subscription:{subscriptionId:r,expiry:a},benefit:{name:i,description:l},plan:{cost:c}},metadata:{isPlanRenewable:d,isPlanAutoRenewing:u,isFreeTrialAvailable:m}}=e,g=x8t(t);if(!(d&&!u))return null;const y={expireTime:a,benefitName:i,benefitDescription:l,isFreeTrialAvailable:m},I={retailerSubscriptionPlanId:r,price:Number(c.amount),currency:c.currency};return s.jsx(b8t,{onClick:()=>{n.logAutoRenewalButtonClicked(),m?(n.logAutoRenewalModalDisplayed(),o.openSubscriptionEnableModal({...y,reEnableSubscription:()=>g(I)})):(o.openSubscriptionEnableModal(y),g(I))}})}function D8t(e){const t=F();return()=>{t(U.analyticsEvent({type:Mn.AUTO_RENEWAL_BUTTON_CLICKED,autoRenewalStatus:"cancel"})),t(U.analyticsEvent({type:Mn.CANCEL_DELIVERY_PASS_AUTO_RENEWAL_MODAL_DISPLAYED,userAction:"open"})),t(Z.openModal("deliveryPassSubscriptionCancel",e))}}function O8t({onClick:e}){return s.jsx("div",{className:"salt-m-b--2",children:s.jsx(b,{intent:"secondary",fill:!0,onClick:e,"data-test":"autorenewal-disable-link",children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.delivery.pass.subscription.auto.renew.disable"})})})})}function h$({subscription:e}){const{customerSubscription:{subscription:{expiry:t,subscriptionId:n},benefit:{name:o},plan:{name:r,freeTrial:a}},metadata:{canCancelAutoRenewal:i}}=e,l=D8t({expiry:t,subscriptionId:n,planName:`${r} - ${o}`,isFreeTrial:!!a,retailerPlanId:e.customerSubscription.plan.retailerPlanId,cost:e.customerSubscription.plan.cost});return i?s.jsx(O8t,{onClick:l}):null}function g$({chip:e,options:t,header:n,body:o,footer:r}){return s.jsxs(He.Action,{chip:e,...t,children:[n,s.jsx(He.Action.Body,{align:"left",children:o}),s.jsx(He.Action.Footer,{align:"left",children:r})]})}const P8t=({onChangePaymentMethod:e,onReEnableSubscription:t,subscription:n,createPlanAmount:o,...r})=>{const{customerSubscription:{subscription:{nextRenewal:a},plan:{freeTrial:i}},metadata:{isSubscriptionPlanTransitioning:l}}=n,c=f8t({getPlanNameStrategy:I8t(o)}),d=i?.translation?.chip;return s.jsxs(h.Fragment,{children:[s.jsx(g$,{options:r,header:c.createCurrentPlan({subscription:n,headerChip:s.jsx(h.Fragment,{children:d&&Ab.createFreeTrial({message:d})})}),body:s.jsx(p$,{subscription:n,isFreeTrial:!!i}),footer:s.jsxs(h.Fragment,{children:[s.jsx(C8t,{subscription:n}),s.jsx(v8t,{subscription:n,onReEnableSubscription:e}),s.jsx(R8t,{subscription:n,onReEnableSubscription:t}),l?null:s.jsx(h$,{subscription:n})]})}),l&&s.jsx(g$,{chip:Ab.createNextPlan(),options:r,header:c.createNextPlan({subscription:n,subscriptionTransitioningPlan:a}),body:s.jsx(p$,{subscription:n,showTransitioningInfo:!0}),footer:s.jsx(h$,{subscription:n})})]})},{Header:N8t,Body:L8t,Footer:k8t}=G;function M8t({isOpen:e,onRequestClose:t,header:n=s.jsx("span",{}),footer:o=s.jsx("span",{}),body:r=s.jsx("span",{})}){return s.jsxs(G,{isOpen:e,showCloseIcon:!0,onRequestClose:t,aria:{labelledby:"subscription-cancel-modal-header"},children:[s.jsx(N8t,{align:Ml,children:n},"header"),s.jsx(L8t,{children:r},"body"),s.jsx(k8t,{align:Ml,children:o},"footer")]})}function Xne({closeTestId:e,confirmTestId:t,onClose:n,onConfirm:o}){return s.jsxs(se,{direction:"column-reverse",directionLgUp:"row",basis:"100%",gap:["sm"],wrapSmUp:"wrap",children:[s.jsx(Bo,{children:s.jsx(b,{fill:!0,onClick:n,intent:"secondary","data-test":e,children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.delivery.pass.subscription.auto.renew.modal.close.button"})})})}),s.jsx(Bo,{children:s.jsx(b,{fill:!0,onClick:o,intent:"primary","data-test":t,children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.delivery.pass.subscription.auto.renew.cancel.modal.button"})})})})]})}function j8t(){return s.jsx(ne,{as:"h2",id:"subscription-cancel-modal-header",children:s.jsx(v,{id:"settings.delivery.pass.subscription.auto.renew.cancel.modal.title"})})}function w8t({expiry:e,dateFormat:t}){return s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12},className:"salt-m-b--8",children:s.jsx(v,{id:"settings.delivery.pass.subscription.auto.renew.cancel.modal.info"})}),s.jsx(Y.Item,{colSpan:{xs:12},className:"salt-m-b--8",children:s.jsx(v,{id:"settings.delivery.pass.subscription.auto.renew.cancel.modal.expiry",values:{expireTime:yt(e,t)}})})]})}function F8t(){const e=h.useRef(null),[t,n]=h.useState(!1);return h.useLayoutEffect(()=>{const o=e.current?.textContent?.trim()??"";n(o.length>0)},[]),{hasText:t,ref:e}}function B8t({expiry:e,dateFormat:t,planName:n}){const{hasText:o,ref:r}=F8t(),a=s.jsx("div",{ref:r,children:s.jsx(Kne,{name:n,translationKey:"settings.delivery.pass.free.trial.cancel.auto.renew.alert",date:e})});return s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{colSpan:{xs:12},className:"salt-m-b--8",children:s.jsx(v,{id:"settings.delivery.pass.free.trial.cancel.auto.renew",values:{expiryDate:yt(e,t)}})}),s.jsx(Y.Item,{colSpan:{xs:12},className:"salt-m-b--4",children:s.jsx(v,{id:"settings.delivery.pass.free.trial.cancel.auto.renew.reminder"})}),o&&s.jsx(Y.Item,{colSpan:{xs:12},className:"salt-m-b--4",children:s.jsx(Ce,{intent:"success","data-test-type":"success","data-test":"cancelation-free-trial-alert",text:a})})]})}function U8t(){return s.jsx(Y,{className:"salt-m-b--8",flush:!0,children:s.jsx(Y.Item,{colStart:{sm:2,md:3,lg:5},colSpan:{xs:12,sm:10,md:8,lg:4},children:s.jsx(se,{justify:"center",children:s.jsx(me,{name:"delivery_pass",height:40,width:60})})})})}function G8t({bodyTemplate:e}){return s.jsxs(ie.Fragment,{children:[s.jsx(U8t,{}),e]})}function $8t(e){const{actions:t,dateFormat:n,isOpen:o,modalOptions:r,isFreeTrialPlan:a}=e,i=fa(),l=()=>a?s.jsx(B8t,{expiry:r?.expiry??"",dateFormat:n,planName:r?.planName??""}):s.jsx(w8t,{expiry:r?.expiry??"",dateFormat:n}),c=()=>{const{closeModal:u,analyticsCloseModal:m}=t;u(),m()},d=()=>{const{disableAutoRenewal:u,closeModal:m,openFailureModal:g}=t,{retailerPlanId:f,cost:y}=r;u(r?.subscriptionId).then(()=>{m(),z.success("settings.delivery.pass.subscription.auto.renew.cancel.success.toast"),i.deliveryPassCancelAutoRenew({retailerSubscriptionPlanId:f,price:Number(y.amount),currency:y.currency})}).catch(g)};return s.jsx(M8t,{isOpen:o,onRequestClose:c,header:s.jsx(j8t,{}),body:s.jsx(G8t,{bodyTemplate:l()}),footer:s.jsx(Xne,{closeTestId:"close-button",confirmTestId:"cancel-delivery-pass-button",onClose:c,onConfirm:d})})}function H8t(){const e="deliveryPassSubscriptionCancel",t=E(da),n=E(Ue(e)),o=E(Vo(e)),{isFreeTrialEnabled:r}=po(),a=F(),i=()=>a(Z.closeModal()),{disableAutoRenewal:l}=Pr.client.useHooks(),c=u=>a(Z.openModal("deliveryPassSubscriptionFailure",u)),d=()=>a(U.analyticsEvent({type:Mn.CANCEL_DELIVERY_PASS_AUTO_RENEWAL_MODAL_DISPLAYED,userAction:"close"}));return s.jsx($8t,{actions:{openFailureModal:c,analyticsCloseModal:d,closeModal:i,disableAutoRenewal:l},dateFormat:t,isOpen:n,modalOptions:o,isFreeTrialPlan:o?.isFreeTrial&&r})}function Zne(){const e=E(da);return{confirmationTitle:()=>s.jsx(v,{id:"settings.delivery.pass.subscription.auto.renew.modal.confirmation.title"}),freeTrialEnableAutoRenew:t=>s.jsx(Bh,{id:"settings.delivery.pass.free.trial.enable.auto.renew",values:{expiryDate:yt(t,e)}}),renewalConfirmationMessage:({expireTime:t,benefitName:n,benefitDescription:o})=>s.jsx(v,{id:"settings.delivery.pass.subscription.auto.renew.modal.confirmation.info",values:{expireTime:yt(t,e),planName:`${n} - ${o}`}}),modalClose:()=>s.jsx(v,{id:"settings.delivery.pass.subscription.auto.renew.modal.close.button"})}}const V8t="subscription-enable-modal-header";function Jne({title:e,topBody:t,bottomBody:n,footer:o,dataTestId:r=V8t}){return s.jsxs(h.Fragment,{children:[s.jsx(G.Header,{align:Ml,children:s.jsx(ne,{as:"h2","data-test":r,id:r,children:e})},"header"),s.jsxs(G.Body,{children:[t,s.jsx(Y,{flush:!0,className:"salt-m-b--4",children:s.jsx(Y.Item,{colSpan:{xs:12},children:n})})]},"body"),s.jsx(G.Footer,{align:Ml,children:o},"footer")]})}function Y8t({expireTime:e,onConfirm:t,onClose:n}){const o=Zne();return s.jsx(Jne,{dataTestId:"free-trial-layout",title:o.confirmationTitle(),topBody:null,bottomBody:o.freeTrialEnableAutoRenew(e),footer:s.jsx(Xne,{onConfirm:t,onClose:n,closeTestId:"close-button",confirmTestId:"confirm-enable-auto-renew-button"})})}function W8t({onClose:e,confirmationData:t}){const n=Zne();return s.jsx(Jne,{dataTestId:"default-layout",title:n.confirmationTitle(),topBody:s.jsx("div",{className:"salt-m-b--8",children:s.jsx(Y,{flush:!0,children:s.jsx(Y.Item,{colStart:{md:3,lg:4},colSpan:{xs:12,md:8,lg:6},children:s.jsx(se,{justify:"center",children:s.jsx(me,{success:!0,name:"status_yes",height:82,width:82})})})})}),bottomBody:n.renewalConfirmationMessage(t),footer:s.jsx(b,{onClick:e,intent:"primary","data-test":"close-button",children:s.jsx(b.Text,{children:n.modalClose()})})})}const q8t="subscription-enable-modal-header",E$="deliveryPassSubscriptionEnable",K8t=({subscriptionData:e,closeModal:t,onConfirm:n})=>e?s.jsx(ie.Fragment,{children:e.isFreeTrialAvailable?s.jsx(Y8t,{expireTime:e.expireTime,onConfirm:()=>{n?.(),t()},onClose:t}):s.jsx(W8t,{confirmationData:e,onClose:t})}):null,z8t=({closeModal:e,isFetching:t,isOpen:n=!1,subscriptionData:o,onConfirm:r})=>{const a=()=>{e()};return s.jsx(G,{isOpen:n,showCloseIcon:!0,onRequestClose:a,isLoading:t,aria:{labelledby:q8t},children:s.jsx(K8t,{onConfirm:r,closeModal:e,subscriptionData:o})})};function Q8t(){const e=F(),{isFetching:t}=Pr.client.useHooks().getComputedState(),{closeModal:n,isOpen:o,getOptions:r}=t_(),a=r(E$),i=()=>e({type:Mn.ENABLE_DELIVERY_PASS_AUTO_RENEWAL_MODAL_DISPLAYED,payload:{userAction:"close"}});return s.jsx(z8t,{closeModal:()=>{n(),i()},isFetching:t,isOpen:o(E$),onConfirm:a?.reEnableSubscription,subscriptionData:a})}const f$="subscription-failure-modal-header",X8t=({actions:e,isOpen:t=!1})=>s.jsxs(G,{isOpen:t,aria:{labelledby:f$},children:[s.jsx(G.Header,{align:Ml,"data-test":"cancel-delivery-pass-failure-header",children:s.jsx(ne,{as:"h2",id:f$,children:s.jsx(v,{id:"settings.delivery.pass.subscription.failure.modal.title"})})},"header"),s.jsx(G.Body,{children:s.jsxs(Y,{flush:!0,children:[s.jsx(Y.Item,{colStart:{xs:2,md:3,lg:4},colSpan:{xs:10,md:8,lg:6},className:"salt-m-b--8",children:s.jsx(se,{justify:"center",children:s.jsx(me,{error:!0,name:"status_no",height:100,width:100})})}),s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(Ce,{showIcon:!1,text:s.jsx(v,{id:"settings.delivery.pass.subscription.failure.modal.body"})})})]})},"body"),s.jsx(G.Footer,{align:Ml,children:s.jsx(b,{onClick:e.closeModal,intent:"primary","data-test":"close-button",fill:!0,children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.delivery.pass.subscription.failure.modal.close"})})})},"footer")]}),Z8t=e=>({isOpen:Ue("deliveryPassSubscriptionFailure")(e)}),J8t=e=>({actions:Ki({closeModal:Z.closeModal},e)}),eQt=ke(Z8t,J8t)(X8t),tQt=()=>{const e=E(ud),t=E(D("mfm")),n=F(),o=We();return()=>n(e&&!t?ree.redirectToAddAddressForm(o,window.location.pathname):Z.openModal("addAddress"))};function eoe(){E(t=>t);const e={dispatch:F()};return()=>toe({context:{store:e}})}function sQt(){const e=E(Yt),t=eoe();h.useEffect(()=>{e||t()},[])}function nQt(){const e=E(Wx),{isFetching:t}=Nr.client.useHooks().getComputedState(),{isFetching:n}=En.client.useHooks().getComputedState(),{isFetching:o}=Pr.client.useHooks().getComputedState();return t||n||o||e}async function toe({context:{store:{dispatch:e}}}){return Promise.all([Nr.server.fetch(e).then(t=>En.server.fetch(e,{benefitGroupId:t?.payload?.responseData?.[0]?.benefitGroupId})),e(wn.getCustomerAddresses()),Pr.server.fetch(e)])}const oQt="add-address-button",Kv={NO_ADDRESS_LABEL:"settings.delivery.pass.free.trial.no.address",NEW_ADDRESS_LABEL:"settings.delivery.pass.new.address.label",NEW_ADDRESS_BUTTON:"settings.delivery.pass.new.address.button.label"},rQt=()=>{const e=eoe(),{isFreeTrialEnabled:t}=po(),{isFreeTrial:n}=En.client.useHooks().getComputedState().metadata,o=t&&n,r=Ls(),a=tQt();return s.jsxs(h.Fragment,{children:[s.jsx(BT,{submitAddAddress:e}),s.jsx("div",{className:"salt-m-b--2",children:o?s.jsx(P,{bold:!0,children:s.jsx(v,{id:Kv.NO_ADDRESS_LABEL})}):s.jsx(P,{children:s.jsx(v,{id:Kv.NEW_ADDRESS_LABEL})})}),s.jsx(b,{"data-test":oQt,onClick:()=>{r.addAddressButtonClicked(),a()},intent:"primary",children:s.jsx(b.Text,{children:s.jsx(v,{id:Kv.NEW_ADDRESS_BUTTON})})})]})};function aQt(){const e=F(),t=We();return()=>{e(U.analyticsEvent({type:Es.VIEW_ALL_PLANS_BUTTON_CLICKED})),t(ic())}}const iQt="subscription-link-button";function lQt(){const e=aQt();return s.jsx(b,{onClick:e,intent:"primary","data-test":iQt,children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.delivery.pass.see.more"})})})}const cQt=()=>{const{isFetching:e,data:t}=En.client.useHooks().getComputedState(),{data:n,isFetching:o}=Nr.client.useHooks().getComputedState(),{isDeliveryPassByStoreEnabled:r}=po(),a=!!n.length,i=n.length>0&&(t?.benefits?.length??0)>0,l=(E(bd)?.data??[]).some(c=>c.deliverable);return o||e?"loading":r&&!l&&!i?"no-passes":a?i?"buy-passes":"no-passes":"add-address"};function dQt(){switch(cQt()){case"loading":return null;case"add-address":return s.jsx(rQt,{});case"buy-passes":return s.jsx(lQt,{});case"no-passes":default:return s.jsx(Ek,{})}}function uQt(){const{hasCustomerSubscriptions:e,isSubscriptionAutoRenewalEnabled:t}=Pr.client.useHooks().getComputedState().metadata,{data:n}=En.client.useHooks().getComputedState();return s.jsxs(ie.Fragment,{children:[t&&s.jsx(KT,{texts:n?{terms:n?.terms,cancellation:n?.cancellation}:void 0}),t&&e&&n&&s.jsx("br",{}),e&&n&&s.jsx(Fse,{benefitGroupName:n.name})]})}const pQt=()=>s.jsxs(h.Fragment,{children:[s.jsx("div",{children:s.jsx(_t,{id:"settings.delivery.pass.free.trial.subtitle.text.first.part"})}),s.jsx("br",{}),s.jsx("div",{children:s.jsx(_t,{id:"settings.delivery.pass.free.trial.subtitle.text.second.part"})})]});function mQt({isTaxGrossDisplayed:e,freeTrialMessage:t}){return s.jsxs(ie.Fragment,{children:[s.jsxs(Y,{flush:!0,className:"salt-m-b--2",children:[s.jsx(Y.Item,{colSpan:{xs:12},children:s.jsx(ne,{as:"h2",children:s.jsx(v,{id:"settings.delivery.pass.page.title"})})}),e&&s.jsx(Y.Item,{colSpan:{xs:12,sm:8},children:s.jsx(se,{align:"center",children:s.jsx(P,{size:"m",asChild:!0,children:s.jsx("h2",{children:s.jsx(_t,{id:"delivery.pass.prices.tax.inclusive"})})})})})]}),s.jsxs("div",{className:"salt-m-b--8",children:[!t&&s.jsx(v,{id:"settings.delivery.pass.page.subtitle"}),t]})]})}function hQt(){const{isFreeTrialEnabled:e}=po(),{data:t,metadata:{isFreeTrial:n,benefitGroupSubscription:o}}=En.client.useHooks().getComputedState(),r=!!t?.displayTaxInformationGross,a=n&&e&&!o;return s.jsx(mQt,{isTaxGrossDisplayed:r,freeTrialMessage:a?s.jsx(pQt,{}):null})}const gQt=({onChangePaymentMethod:e,onReEnableSubscription:t})=>{const{data:n,metadata:{hasCustomerSubscriptions:o}}=Pr.client.useHooks().getComputedState(),r=TE();return s.jsxs(h.Fragment,{children:[s.jsx(hQt,{}),s.jsx("div",{className:"salt-m-b--8",children:o&&s.jsx(He.Collection,{xs:1,sm:1,md:2,lg:3,children:(n??[]).map(a=>s.jsx(P8t,{createPlanAmount:i=>r(i).toCost(),subscription:a,onChangePaymentMethod:()=>e(a.customerSubscription.subscription),onReEnableSubscription:t},a.customerSubscription.subscription.subscriptionId))})}),s.jsx(dQt,{}),s.jsx("div",{className:"salt-m-y--8",children:s.jsx(uQt,{})}),o&&s.jsxs(h.Fragment,{children:[s.jsx(Q8t,{}),s.jsx(H8t,{}),s.jsx(eQt,{})]})]})};function EQt(){const e=M(),{formatMessage:t}=e;return{updatePaymentMethodTitle:t("checkout.summary.payment.method.title"),updatePaymentMethodButton:t("settings.delivery.pass.subscription.change.payment.method.modal.update.button")}}function hM(){const e=E(Wt),t=E(wa),n=E(Va);return{basePath:e??"",clientRouteId:t,csrfToken:n}}function fQt({basePath:e,subscriptionId:t}){return Ii({basePath:e,target:`/customer/v1/benefit-groups/delivery-pass/subscription/${t}/walletItemId`})}function yQt({walletItemId:e,subscriptionId:t,onFetchError:n,onFetchSuccess:o,onFetchFinally:r,fetchOptions:{basePath:a,clientRouteId:i,csrfToken:l}}){return fetch(fQt({basePath:a,subscriptionId:t}),Qu({method:"PUT",body:JSON.stringify({walletItemId:e}),clientRouteId:i,csrfToken:l,contentType:"application/json; charset=utf-8"})).then(c=>{c.ok?o():n()}).catch(()=>{n()}).finally(()=>{r()})}function IQt(){const e=hM();return t=>yQt({...t,fetchOptions:e})}function SQt({resultToken:e,onSuccess:t,onError:n,fetchOptions:o}){const{basePath:r,clientRouteId:a,csrfToken:i}=o,l=Ii({basePath:r,target:"/customer/v2/benefit-groups/delivery-pass/subscription/re-auth/validate"});return fetch(l,Qu({method:"POST",body:JSON.stringify({resultToken:e}),clientRouteId:a,csrfToken:i,contentType:"application/json; charset=utf-8"})).then(c=>{if(c.ok)t();else throw new Error(c.statusText)}).catch(n)}function CQt(){const e=hM();return t=>SQt({...t,fetchOptions:e})}function TQt(e){return Ii({basePath:e,target:"/customer/v2/benefit-groups/delivery-pass/subscription/reauth"})}function _Qt({subscriptionId:e,walletItemId:t,fetchOptions:{basePath:n,clientRouteId:o,csrfToken:r}}){return fetch(TQt(n),Qu({method:"POST",body:JSON.stringify({saleId:e,checkoutUrl:`${window.location.origin}${n}${Uo()}`,walletItemId:t,source:"web"}),clientRouteId:o,csrfToken:r,contentType:"application/json; charset=utf-8"})).then(a=>{if(a.ok)return a.json();throw new Error(a.statusText)})}function vQt(){const e=hM();return t=>_Qt({...t,fetchOptions:e})}function AQt(){const{is3dsSubscriptionsFlowEnabled:e}=po(),t=vQt(),n=IQt(),o=CQt(),{walletItemUpdated:r,fetch:a}=Pr.client.useHooks(),{closeModal:i}=t_(),l=c=>{z.success("settings.delivery.pass.update.payment.method.success.notification"),r(c),a()};return{updatePaymentMethod:c=>d=>e?t({subscriptionId:c,walletItemId:d}).then(({url:u,walletItemId:m})=>u||(l(m),i())):n({walletItemId:d,subscriptionId:c,onFetchSuccess:()=>l(d),onFetchError:()=>z.error("settings.delivery.pass.update.payment.method.failure.notification"),onFetchFinally:i}),onAuth:{completed:({onSuccess:c,onError:d})=>({resultToken:u})=>(i(),u?o({resultToken:u,onSuccess:()=>{c(),z.success("settings.delivery.pass.update.payment.method.success.notification"),a()},onError:()=>{d(),z.error("settings.delivery.pass.update.payment.method.failure.notification")}}):(z.error("settings.delivery.pass.update.payment.method.failure.notification"),Promise.resolve())),failure:c=>{c&&Me.api.pushError(c),i(),z.error("toast.notification.generic.error")}}}}const bQt=Vn.Item;function soe(){const e=F();return()=>{e(U.analyticsEvent({type:Mn.DELIVERY_PASS_SETTINGS_TAB_CLICKED}))}}function noe(){return M().formatMessage("settings.delivery.pass.heading")}function xQt({path:e}){const{isSubscriptionEnabled:t}=po(),n=noe(),o=soe();return t?s.jsx(bQt,{children:s.jsx(Qe,{bold:e===Uo(),onClick:o,to:Uo(),"data-test":"delivery-pass-link",children:n})}):null}function RQt(){const{isSubscriptionEnabled:e}=po(),t=noe(),n=soe();return{createOption:()=>e?s.jsx("option",{value:Uo(),children:t}):null,handleDeliveryPassChange:o=>{o.target.value===Uo()&&n()}}}function DQt(e){const{fundingInstrumentId:t,walletItem:n,walletItemId:o}=e;return{walletItemId:n?.walletItemId||o,fundingInstrumentId:t}}function ooe(){const{setSelectedSubscriptionCard:e,getComputedState:t}=Pr.client.useHooks(),{metadata:{hasCustomerSubscriptions:n}}=t(),{data:o}=Nr.client.useHooks().getComputedState(),r=!!o.length,a=Mk(),i=Bse();sQt();const l=nQt(),{updatePaymentMethod:c,onAuth:{completed:d,failure:u}}=AQt(),[m,g]=h.useState(!1),[f,y]=h.useState(!1),[I,S]=h.useState(void 0),[C,_]=h.useState({}),{data:A}=En.client.useHooks().getComputedState(),x=!!A?.displayTaxInformationGross,R=EQt(),O=l||f||m;return!O&&!n&&r&&!a?s.jsx(Qn,{to:ic()}):s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"settings.delivery.pass.page.title"}),O?s.jsx(He.Action.Skeleton,{"data-test":"settings-delivery-pass-skeleton"}):s.jsx(gQt,{onChangePaymentMethod:N=>{const{subscriptionId:k,paymentInformation:j}=N;S(k),_(DQt(N)),e(j),i()},onReEnableSubscription:{before:()=>g(!0),success:()=>g(!1)}}),s.jsx(Gk,{modalsTitle:R.updatePaymentMethodTitle,isTaxGrossDisplayed:x,confirmPaymentMethodText:R.updatePaymentMethodButton,onInitiatePayment:c(I),onAuthCompleted:d({onSuccess:()=>y(!1),onError:()=>y(!1)}),onAuthFailure:u,preselectedWalletItem:C})]})}ooe.fetchData=toe;const OQt="web_customer_preference_ws",roe="/v1/customer-preferences",aoe={service:OQt,pathPrefix:{client:"/api/customer-preferences",server:"/core-api"}},ioe=({actionType:e,url:t,options:n,service:o,pathPrefix:r})=>({type:"API",payload:{url:t,...!!n&&{options:n},...ee(e),...!!o&&{service:o},...!!r&&{pathPrefix:r}}}),PQt=({actionType:e,preferenceKey:t})=>n=>ioe({actionType:e,url:roe,...aoe,options:{body:{preferenceKey:t,preferenceValue:n},method:"PUT"}}),NQt=({actionType:e,preferenceKey:t})=>()=>ioe({actionType:e,url:`${roe}/${t}`,...aoe}),LQt=NQt({actionType:"GET_DELIVERY_PREFERENCES",preferenceKey:"raw-produce-segregation"}),kQt=PQt({actionType:"UPDATE_DELIVERY_PREFERENCES",preferenceKey:"raw-produce-segregation"}),loe={getDeliveryPreferences:LQt,updateDeliveryPreferences:kQt},MQt=async({context:{store:e}})=>e.dispatch(gM()),gM=()=>async e=>{try{await e(loe.getDeliveryPreferences())}catch(t){Me.api.pushError(t instanceof Error?t:new Error(`fetchDeliveryPreferencesService error: ${JSON.stringify(t)}`))}},jQt=()=>{const e=E(vKe),t=F();return{deliveryPreferences:e,onFetchDeliveryPreferences:h.useCallback(()=>t(gM()),[t])}},wQt=()=>{const e=F();return h.useCallback(t=>e(n=>n(loe.updateDeliveryPreferences(t["raw-produce-segregation"])).then(()=>{n(gM()),Promise.resolve()})),[e])},coe=()=>{const e=Gn(),t=E(Yt),{formatMessage:n}=M(),o=h.useMemo(()=>n("customer-preference.delivery.raw-produce-segregation.description").replace(/\n/g,"<br />"),[]),{deliveryPreferences:r,onFetchDeliveryPreferences:a}=jQt(),i=wQt(),{preferences:l,fetchError:c,lastUpdated:d}=r;h.useEffect(()=>{(!t||!d)&&a()},[]);const u=g=>{z[g](`settings.update.delivery.preferences.${g}`)},m=async g=>{try{await i(g),u(zw.SUCCESS)}catch{u(zw.ERROR)}};return s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"settings.delivery.preferences.page.title"}),c?s.jsx(eu,{action:a}):s.jsxs(ie.Fragment,{children:[s.jsx(ne,{as:"h2",className:"salt-m-b--4",children:s.jsx(v,{id:"settings.delivery.heading"})}),l&&Object.keys(l).length>0&&s.jsx($n,{...e,children:s.jsxs("form",{"data-test":"section-preferences",onSubmit:e.handleSubmit(m),children:[s.jsx(GT,{html:`<p>${o}</p>`}),Object.keys(l).map(g=>{const{preferenceKey:f,preferenceValue:y}=l[g];return s.jsx(HI,{control:e.control,name:f,defaultValue:y,render:({field:I})=>s.jsx(mo,{...I,"data-test":f,name:f,value:f,input:{checked:I.value},label:n("customer-preference.delivery.raw-produce-segregation.text"),bold:!0,last:!1,whiteSpace:"pre-wrap"})},f)}),s.jsx("div",{className:"salt-m-b--8",children:s.jsx(b,{intent:"primary",type:"submit","data-test":"preferences-save-button",fill:!1,disabled:!d,children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.delivery.preferences.save"})})})})]})})]})]})};coe.fetchData=MQt;const y$=()=>async e=>{try{await e(Gc.getAccessibilitySettings())}catch(t){Me.api.pushError(t instanceof Error?t:new Error(JSON.stringify(t)))}},FQt=({defaultNotificationDuration:e})=>{const{formatMessage:t}=M(),n=F(),o=({string:d,duration:u,displayAsNumberOfSeconds:m})=>t(d,m?{notificationDuration:u}:void 0),a={name:(()=>{const d=fw.find(u=>u.duration===e);return d?o(d):""})(),value:e},i=fw.map(d=>({name:o(d),value:d.duration})),l=d=>{z[d](`settings.accessibility.notification.update.${d}`)},c=async d=>{d.preventDefault();const u=d.currentTarget,m=new FormData(u),g=[{preferenceKey:QS,preferenceValue:m.get("notification")?.toString()??null}];try{await n(Gc.updateAccessibilitySettings(g)),await n(Gc.getAccessibilitySettings()),l("success")}catch{l("error")}};return s.jsxs(mt,{"data-test":"accessibility-settings-form",onSubmit:c,children:[s.jsx(mt.DropdownSelect,{options:i,name:"notification",label:{text:t("settings.accessibility.notification.heading"),isVisuallyConcealed:!0},defaultValue:a,"data-test":"notification-duration-select-test"}),s.jsx(b,{intent:"primary",type:"submit",fill:!1,className:"salt-m-t--2",children:s.jsx(b.Text,{children:t("settings.accessibility.update-details")})})]})},BQt=()=>{const e=E(Yt),t=F(),n=E(lq),{data:o,lastUpdated:r,fetchError:a}=n,i=o[QS]?.preferenceValue??Fy;return h.useEffect(()=>{(!e||!r)&&t(y$())},[]),s.jsx(Y,{children:s.jsxs(Y.Item,{colSpan:{xs:12,sm:11,md:8,lg:4},children:[s.jsx(rs,{title:"settings.accessibility.title"}),a?s.jsx(eu,{action:()=>t(y$())}):s.jsxs(ie.Fragment,{children:[s.jsx(P,{size:"l",bold:!0,className:"salt-m-b--2 salt-d--block",children:s.jsx(v,{id:"settings.accessibility.notification.heading"})}),s.jsx(P,{className:"salt-m-b--2 salt-d--block",children:s.jsx(v,{id:"settings.accessibility.notification.description"})}),s.jsx(FQt,{defaultNotificationDuration:i})]})]})})},UQt=()=>{const{launchChat:e,loading:t}=lk();return s.jsx(Y,{flush:!0,className:"salt-m-y--4",children:s.jsx(Y.Item,{colStart:{sm:2,md:3,lg:4},colSpan:{xs:12,sm:8,md:6,lg:4},children:s.jsx(ln,{title:"settings.chat.title",description:"settings.chat.description",titleIcon:"chat",primaryButton:{text:"settings.chat.button",onClick:e,loading:t}})})})},{Header:GQt,Body:$Qt,Footer:HQt}=G,VQt=({address:e,onClose:t,headerLabelId:n,onSubmit:o,modalLeftAlignEnabled:r})=>{const a=Gn({mode:"onChange",defaultValues:e}),i=c=>{c.preventDefault();const d=a.getValues();d.nickname.trim()&&o(d)},l=!E(D("daddi"));return s.jsx($n,{...a,children:s.jsxs("form",{"data-test":"edit-address-modal-form",onSubmit:i,children:[s.jsx(GQt,{align:r?"left":"center",children:s.jsx(ne,{as:"h2",id:n,"data-test":n,children:s.jsx(v,{id:"settings.address.book.edit.modal.title"})})}),s.jsxs($Qt,{children:[s.jsx(uP,{}),l&&s.jsx(HC,{})]}),s.jsxs(HQt,{align:r?"left":"center",children:[s.jsx(b,{fill:!0,intent:"secondary",onClick:t,"data-test":"edit-address-cancel-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.edit.modal.cancel"})})}),s.jsx(b,{className:"salt-m-l--2",fill:!0,type:"submit",intent:"primary","data-test":"edit-address-submit-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.edit.modal.complete"})})})]})]})})},YQt=({id:e,nickname:t,notes:n})=>async(o,r)=>{const i=bd(r()).data.find(c=>c.id===e);if(i?.notes!==n||i?.nickname!==t)try{try{await o(Sy.updateCustomerAddress({id:e,nickname:t,notes:n}));const c={event:"event",eventCategory:"Settings",eventAction:"UPDATE_CUSTOMER_ADDRESS_SUCCESS",eventLabel:"Not Set"};return J.sendEvent({GA:c,WA:null}),z.success("settings.address.book.edit.modal.update.success"),await o(wn.getCustomerAddresses())}catch{const c={event:"event",eventCategory:"Settings",eventAction:"UPDATE_CUSTOMER_ADDRESS_ERROR",eventLabel:"Not Set"};J.sendEvent({GA:c,WA:null}),z.error("settings.address.book.edit.modal.notes.error")}}finally{return await o(Z.closeModal())}return o(Z.closeModal())},WQt={updateCustomerAddress:YQt},qQt=D("m.la.h"),I$="edit-address-modal-header",KQt=({address:e})=>{const t=Ls(),n=F(),o=E(Ue("editAddress")),r=E(qQt),a=h.useCallback(l=>{t.updateAddress(),n(WQt.updateCustomerAddress(l))},[]),i=h.useCallback(()=>{n(Z.closeModal())},[]);return s.jsx(G,{isOpen:o,onRequestClose:i,aria:{labelledby:I$},children:s.jsx(VQt,{address:e,onClose:i,onSubmit:a,headerLabelId:I$,modalLeftAlignEnabled:r})})},zQt=e=>t=>t(Cy.removeCustomerAddress(e)).then(()=>{z.success("settings.address.book.remove.modal.success");const n={event:"event",eventCategory:"Settings",eventAction:"REMOVE_CUSTOMER_ADDRESS_SUCCESS",eventLabel:"Not Set"};J.sendEvent({GA:n,WA:null})}).catch(n=>{const o=n.message&&mS(n.message)?n.message:"settings.address.book.remove.modal.error";z.error(o);const r={event:"event",eventCategory:"Settings",eventAction:"REMOVE_CUSTOMER_ADDRESS_ERROR",eventLabel:"Not Set"};J.sendEvent({GA:r,WA:null})}),QQt={removeCustomerAddress:zQt},XQt=T.strong`
    display: flex;
    align-items: center;
    margin-block-end: 6px;
`,ZQt=T.span`
    display: block;
    margin-inline-start: 6px;
`,JQt=T.div`
    margin-block-end: 16px;
`,doe=({slot:e})=>{const t=E(Vt);return s.jsxs("div",{"data-test":"basket-slot-warning",children:[s.jsxs(XQt,{children:[s.jsx(me,{name:"info_default"}),s.jsx(ZQt,{children:s.jsx(v,{id:"settings.address.book.remove.modal.slot.warning.title"})})]}),s.jsxs(JQt,{children:[s.jsx(v,{id:"settings.address.book.remove.modal.slot.warning.description"})," ",s.jsx("span",{"data-test":"zone-date-time-interval",children:s.jsx(go,{dateIsoFrom:e.start,dateIsoTo:e.end,timeZoneId:e.timeZoneId,dateFormat:Xo,timeFormat:t})})]})]})};doe.propTypes={slot:p.shape({start:p.string.isRequired,end:p.string.isRequired,timeZoneId:p.string.isRequired}).isRequired};const e9t=(e,t)=>{const n=e?.id,o=t?.addressId,r=a=>typeof a=="string"&&a.length>0;return r(n)&&r(o)?n===o:!1},t9t=D("m.la.h"),s9t={isOpen:p.bool,actions:p.shape({closeModal:p.func.isRequired,removeCustomerAddress:p.func.isRequired,invalidateHomeDeliveryDestinations:p.func.isRequired}).isRequired,slot:p.shape({addressId:p.string.isRequired,displayAddress:p.string.isRequired,start:p.string.isRequired,end:p.string.isRequired,deliveryType:p.string.isRequired,nickname:p.string.isRequired,timeZoneId:p.string.isRequired,notes:p.string.isRequired,expiryTime:p.string.isRequired}),address:p.shape({id:p.string,addressLine:p.string,nickname:p.string,additionalInformation:p.string}),modalLeftAlignEnabled:p.bool,sendAnalytics:p.shape({removeAddress:p.func.isRequired}).isRequired},n9t={address:{},isOpen:!1,modalLeftAlignEnabled:!1,slot:{addressId:"",displayAddress:"",start:"",end:"",deliveryType:"",nickname:"",timeZoneId:"",notes:"",expiryTime:""}},EM=({actions:{removeCustomerAddress:e,closeModal:t,invalidateHomeDeliveryDestinations:n},isOpen:o,address:r,modalLeftAlignEnabled:a,slot:i,sendAnalytics:l})=>{const c=ed(()=>{e(r.id).then(n).then(()=>{l.removeAddress(),t()})},200),d="remove-address-modal-header",u=e9t(r,i);return s.jsxs(G,{isOpen:o,onRequestClose:t,aria:{labelledby:d},children:[s.jsx(G.Header,{align:a?"left":"center",children:s.jsx(ne,{as:"h2",id:d,"data-test":d,children:s.jsx(v,{id:"settings.address.book.remove.modal.title"})})}),s.jsxs(G.Body,{children:[u?s.jsx(doe,{slot:i}):null,s.jsxs(se,{direction:"column",gap:["sm"],children:[s.jsx(P,{"data-pii":"true",as:"strong",bold:!0,children:r.nickname}),s.jsx(P,{"data-pii":"true",children:r.addressLine}),r.additionalInformation&&s.jsx(P,{"data-pii":"true",children:r.additionalInformation})]})]}),s.jsx(G.Footer,{className:"salt-d--block",align:a?"left":"center",children:s.jsxs(se,{direction:"column-reverse",directionSmUp:"row",wrap:"nowrap",gap:["sm"],children:[s.jsx(b,{fill:!0,intent:"secondary",onClick:c,"data-test":"remove-address-remove-button",children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.remove.modal.confirm"})})}),s.jsx(b,{fill:!0,intent:"primary",onClick:t,children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.button.cancel"})})})]})})]})};EM.defaultProps=n9t;EM.propTypes=s9t;const o9t=e=>({isOpen:Ue("removeAddress")(e),modalLeftAlignEnabled:t9t(e),slot:Cn(e)}),r9t=ot({closeModal:Z.closeModal,removeCustomerAddress:QQt.removeCustomerAddress,invalidateHomeDeliveryDestinations:_K}),a9t=ke(o9t,r9t)(EM);function uoe({onClick:e}){return s.jsx(b,{intent:"secondary","data-test":"addresses-add-button",onClick:e,children:s.jsx(b.Text,{children:s.jsx(v,{id:"addresses.add.address"})})})}uoe.propTypes={onClick:p.func.isRequired};function i9t(){const{status:e,value:t}=Zd();return e==="NOT_READY"?null:s.jsx(uoe,{onClick:t})}poe.propTypes={address:p.shape({deliverable:p.bool,nickname:p.string,addressLine:p.string,additionalInformation:p.string}).isRequired,removable:p.bool.isRequired,handlers:p.shape({removeAddress:p.func,editAddress:p.func}).isRequired};const l9t=T.div`
    display: grid;
    align-items: center;
    grid-template-columns: 1fr;
    gap: var(--salt-spacing-2);

    ${oe.smUp`
    grid-template-columns: repeat(auto-fit, minmax(${H(100)}, 1fr));
    `}
`,c9t=T(He.Action.HeaderText)`
    overflow: hidden;
    text-overflow: ellipsis;
`;function poe({address:e,handlers:{removeAddress:t,editAddress:n},removable:o}){const r=M();return s.jsxs(ie.Fragment,{children:[s.jsx(He.Action.Header,{"data-pii":"true","data-test":"addresses-nickname-title",children:s.jsx(c9t,{as:"h3",children:e.nickname})}),s.jsxs(He.Action.Body,{children:[s.jsx(P,{"data-pii":"true",children:e.addressLine}),e.additionalInformation&&s.jsx(P,{"data-pii":"true",className:"salt-d--block",children:e.additionalInformation}),e.deliverable===!1&&s.jsx("div",{className:"salt-p-t--2",children:s.jsx(Ce,{intent:"warning",size:"s",text:s.jsx(v,{id:"settings.addresses.alert.nondeliverable"})})})]}),s.jsx(He.Action.Footer,{children:s.jsxs(l9t,{children:[o?s.jsxs(b,{intent:"secondary","aria-labelledby":r.formatMessage("settings.address.book.remove.address.alternative",{addressNickName:e.nickname}),onClick:()=>t(e),"data-test":"addresses-remove-button",children:[s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.remove.address"})}),s.jsx(Ee,{children:s.jsx(v,{id:"settings.address.book.remove.address.a11y",values:{addressNickName:e.nickname}})})]}):null,s.jsxs(b,{intent:"secondary","aria-labelledby":r.formatMessage("settings.address.book.edit.address.alternative",{addressNickName:e.nickname}),onClick:()=>n(e),"data-test":"addresses-edit-button",children:[s.jsx(b.Text,{children:s.jsx(v,{id:"settings.address.book.edit.address"})}),s.jsx(Ee,{children:s.jsx(v,{id:"settings.address.book.edit.address.a11y",values:{addressNickName:e.nickname}})})]})]})})]})}const d9t=({editAddress:e,removeAddress:t,address:n,removable:o,...r})=>{const a=()=>{switch(n.type){case"ADD_ADDRESS":return s.jsx(He.Action,{"data-test":"address-item-add-address",...r,children:s.jsx(i9t,{})});case"PLACEHOLDER":return s.jsx(He.Action.Skeleton,{"data-test":"address-item-placeholder"});default:return s.jsx(He.Action,{muted:n.deliverable===!1,"data-test":"addresses-address-card",...r,children:s.jsx(poe,{removable:o,address:n,handlers:{editAddress:e,removeAddress:t}})})}};return s.jsx(ie.Fragment,{children:a()})},u9t=(e=3)=>Array.from(Array(e),(t,n)=>({id:`${n}`,type:"PLACEHOLDER"})),p9t=()=>({id:"99",type:"ADD_ADDRESS"}),m9t=({editAddress:e,removeAddress:t,addresses:n,getCustomerAddresses:o,addressToEdit:r,addressToRemove:a,selectedDeliveryDestination:i,submitAddAddress:l})=>{const c=Ls(),d=n.lastUpdated?[...n.data,p9t()]:u9t();if(n.fetchError)return s.jsx(eu,{action:o});const u=m=>i?.data?.addressId!==m.id;return s.jsxs(He.Collection,{children:[s.jsx(rs,{title:"settings.addresses.page.title"}),d.map(m=>s.jsx(d9t,{removable:u(m),editAddress:e,removeAddress:t,address:m},m.id)),s.jsx(BT,{submitAddAddress:l}),s.jsx(KQt,{address:r}),s.jsx(a9t,{address:a,sendAnalytics:c})]})},moe=({addresses:e,actions:{getCustomerAddresses:t,openRemoveAddressModal:n,openEditAddressModal:o,getDeliveryDestination:r},isServerRendered:a,isManualFormFlow:i})=>{const l=We(),c=Ls(),[d,u]=h.useState({}),[m,g]=h.useState({}),f=Bg();XXe(e.data||[]),h.useEffect(()=>{(!a||!e.lastUpdated)&&t()},[]);const y=BC(),_={editAddress:A=>{i?l(z6.routes.createEditUrl(A.id)):(u(A),o()),c.editAddressButtonClicked(A.id)},removeAddress:A=>{const x=e.data.length===1;x?z.warning("addresses.remove.last.toast.message"):(g(A),n()),c.removeAddressButtonClicked(A.id,x)},addresses:e,getCustomerAddresses:t,addressToEdit:d,addressToRemove:m,selectedDeliveryDestination:y,submitAddAddress:(A,x)=>{t(),x&&r(x).then(R=>{f({addressId:A,deliveryDestinationId:R.payload.responseData.deliveryDestinationId,regionId:R.payload.responseData.resolvedRegionId})})}};return s.jsxs(h.Fragment,{children:[s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:s.jsx(v,{id:"settings.addresses.heading"})})}),s.jsx(m9t,{..._})]})},h9t=e=>({addresses:bd(e),isServerRendered:Yt(e),isManualFormFlow:ud(e)});moe.fetchData=({context:{store:e}})=>e.dispatch(wn.getCustomerAddresses());const g9t=ot({getCustomerAddresses:wn.getCustomerAddresses,openEditAddressModal:()=>Z.openModal("editAddress"),openRemoveAddressModal:()=>Z.openModal("removeAddress"),getDeliveryDestination:sn.getSelectedDeliveryDestinationData}),E9t=ke(h9t,g9t)(moe),S$=()=>{const t=E(D("ads"))?rd():ad();return s.jsx(Qn,{to:t})},f9t=({children:e,isAccountDetailsSplit:t})=>t?s.jsx(b,{intent:"primary",type:"submit","data-test":"change-credentials-open-button",children:s.jsx(b.Text,{children:e})}):s.jsx(b,{intent:"secondary",type:"submit","data-test":"change-credentials-open-button",children:s.jsx(b.Text,{children:e})}),y9t=D("ads"),hoe=()=>{const e=E(y9t),t=e?"settings.login.details.edit":"settings.user.details.change.credentials";return s.jsx("div",{"data-test":"change-credentials",children:s.jsx(f9t,{isAccountDetailsSplit:e,children:s.jsx(v,{id:t})})})},goe=()=>{const e=E(Wt),t=SEe({basePath:e});return n=>{n.preventDefault(),window.location.assign(`${t}`)}},I9t=({registerField:e})=>{const t=M(),n=goe(),o=E(rpe),r=E(l=>l.session.isSuperuser),a=l=>{const{name:c,label:d,placeholder:u,readOnly:m,required:g,type:f}=l,y={key:c,label:d,type:f,placeholder:u,readOnly:m,required:g,...e(l,!0)};return s.jsx(ii,{...y,"data-pii":"true"})},i=[{name:"email",label:t.formatMessage("user.contactDetails.email.title"),placeholder:t.formatMessage("user.contactDetails.email.placeholder"),value:o||"",readOnly:!0,required:!0,type:"text"},{name:"password",label:t.formatMessage("user.contactDetails.password.title"),placeholder:t.formatMessage("user.contactDetails.password.placeholder"),value:t.formatMessage("settings.login.details.password")||"",readOnly:!0,required:!0,type:"text"}];return s.jsxs("form",{onSubmit:n,"data-test":"login-details-form",children:[s.jsx("div",{className:"salt-m-b--4",children:i.map(a)}),r?null:s.jsx(hoe,{})]})},S9t=Ct(Bt,JW)(I9t),C9t=D("ads"),T9t=e=>{const{comp:t}=e;return s.jsx(t,{})},Eoe=()=>s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"settings.login.details.page.title"}),s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:s.jsx(v,{id:"settings.login.details.heading"})})}),s.jsx(T9t,{comp:S9t})]});Eoe.fetchData=({context:{store:e}})=>C9t(e.getState())?Promise.resolve():e.dispatch(bs.getCurrentCustomer());const _9t=D("homedel"),v9t=D("loyalty"),A9t=D("ads"),b9t=D("pay.ywlt"),x9t=D("hmpv"),R9t=D("dlvr.pref"),D9t=D("ccai"),O9t={messages:p.shape({loginDetails:p.string.isRequired,details:p.string.isRequired,language:p.string.isRequired,addresses:p.string.isRequired,wallet:p.string.isRequired,marketing:p.string.isRequired,deliveryPreferences:p.string.isRequired,accessibilitySettings:p.string.isRequired,loyalty:p.string.isRequired,helpCentre:p.string.isRequired}).isRequired,displayLoyalty:p.bool.isRequired,displayDeliveryPass:p.bool.isRequired,displayAddresses:p.bool.isRequired,displayLanguage:p.bool.isRequired,displayLoginDetails:p.bool.isRequired,displayWallet:p.bool.isRequired,displayAccessibilitySettings:p.bool.isRequired,displayMarketingPreferences:p.bool.isRequired,displayDeliveryPreferences:p.bool.isRequired,displayHelpCentre:p.bool.isRequired,intl:p.any.isRequired},foe=({messages:e,displayLoyalty:t,displayAddresses:n,displayLanguage:o,displayLoginDetails:r,displayWallet:a,displayMarketingPreferences:i,displayDeliveryPreferences:l,displayHelpCentre:c,intl:d})=>{const{pathname:u}=Ne();return s.jsx("nav",{id:"navigation-list","aria-label":d.formatMessage("settings.sidebar.title"),children:s.jsxs(Vn,{children:[r&&s.jsx(Vn.Item,{children:s.jsx(Qe,{bold:u===rd(),unstyled:!0,to:rd(),"data-test":"login-details-link",children:e.loginDetails})}),s.jsx(Vn.Item,{children:s.jsx(Qe,{bold:u===ad(),unstyled:!0,to:ad(),"data-test":"user-details-link",children:e.details})}),o&&s.jsx(Vn.Item,{children:s.jsx(Qe,{bold:u===Uy(),unstyled:!0,to:Uy(),"data-test":"language-link",children:e.language})}),t&&s.jsx(Vn.Item,{children:s.jsx(Qe,{bold:u===zu(),unstyled:!0,to:zu(),"data-test":"loyalty-link",children:e.loyalty})}),n&&s.jsx(Vn.Item,{children:s.jsx(Qe,{bold:u===Na(),unstyled:!0,to:Na(),"data-test":"addresses-link",children:e.addresses})}),s.jsx(xQt,{path:u}),a&&s.jsx(Vn.Item,{children:s.jsx(Qe,{bold:u===vh(),unstyled:!0,to:vh(),"data-synthetics":"settings-navigation-wallet",children:e.wallet})}),s.jsx(Vn.Item,{children:s.jsx(Qe,{bold:u===Gy(),unstyled:!0,to:Gy(),"data-test":"accessibility-settings-link",children:e.accessibilitySettings})}),i&&s.jsx(Vn.Item,{children:s.jsx(Qe,{bold:u===$y(),unstyled:!0,to:$y(),"data-test":"marketing-preferences-link",children:e.marketing})}),l&&s.jsx(Vn.Item,{children:s.jsx(Qe,{bold:u===Hy(),unstyled:!0,to:Hy(),"data-test":"delivery-preferences-link",children:e.deliveryPreferences})}),c&&s.jsx(Vn.Item,{children:s.jsx(Qe,{bold:u===Vy(),unstyled:!0,to:Vy(),"data-test":"help-centre-link",children:e.helpCentre})})]})})};foe.propTypes=O9t;const P9t=e=>({displayAddresses:_9t(e),displayLoyalty:v9t(e),displayLanguage:jx(e),displayLoginDetails:A9t(e),displayWallet:b9t(e),displayMarketingPreferences:!x9t(e),displayDeliveryPreferences:R9t(e),displayHelpCentre:D9t(e)}),N9t=Ct(Bt,ke(P9t))(foe),L9t=D("homedel"),k9t=D("loyalty"),M9t=D("ads"),j9t=D("pay.ywlt"),w9t=D("hmpv"),F9t=D("dlvr.pref"),B9t=D("ccai"),C$=({messages:e})=>{const t=We(),n=Ne(),o=E(L9t),r=E(k9t),a=E(jx),i=E(M9t),l=E(j9t),c=!E(w9t),d=E(F9t),u=E(B9t),[m,g]=h.useState(n.pathname),{createOption:f,handleDeliveryPassChange:y}=RQt(),I=S=>{y(S);const C=S.target.value;g(C),t(C)};return s.jsxs(Pd,{hideLabel:!0,label:e.menu,value:m,onChange:I,"data-test":"navigation-select",children:[i&&s.jsx("option",{value:rd(),children:e.loginDetails}),s.jsx("option",{value:ad(),children:e.details}),a&&s.jsx("option",{value:Uy(),children:e.language}),r&&s.jsx("option",{value:zu(),children:e.loyalty}),o&&s.jsx("option",{value:Na(),children:e.addresses}),f(),l&&s.jsx("option",{value:vh(),children:e.wallet}),s.jsx("option",{"data-test":"accessibility-settings-option",value:Gy(),children:e.accessibilitySettings}),c&&s.jsx("option",{"data-test":"marketing-preferences-option",value:$y(),children:e.marketing}),d&&s.jsx("option",{"data-test":"delivery-preferences-option",value:Hy(),children:e.deliveryPreferences}),u&&s.jsx("option",{"data-test":"help-centre-option",value:Vy(),children:e.helpCentre})]})},yoe=D("ads"),U9t=()=>{const e=M(),t=E(yoe),n=e.formatMessage("settings.accessibility.heading"),o={addresses:e.formatMessage("settings.addresses.heading"),deliveryPass:e.formatMessage("settings.delivery.pass.heading"),details:e.formatMessage("settings.details.heading"),language:e.formatMessage("settings.language.heading"),loginDetails:e.formatMessage("settings.login.details.heading"),loyalty:e.formatMessage("settings.sidebar.loyalty"),marketing:e.formatMessage("settings.marketing.heading"),deliveryPreferences:e.formatMessage("settings.delivery.heading"),accessibilitySettings:n,menu:e.formatMessage("settings.page.menu.title"),title:e.formatMessage("settings.page.title"),wallet:e.formatMessage("settings.wallet.heading"),helpCentre:e.formatMessage("settings.chat.link")};return s.jsxs(h.Fragment,{children:[s.jsx(An,{children:s.jsx(ne,{as:"h1","data-test":"account-settings-title",children:o.title})}),s.jsxs(Y,{children:[s.jsxs(Y.Item,{colSpan:{xs:12,sm:4,lg:3},children:[s.jsx(cs,{breakpoint:"sm-up",children:s.jsx(N9t,{messages:o})}),s.jsx(Kt,{breakpoint:"sm-up",children:t?s.jsxs(h.Fragment,{children:[s.jsx(ne,{as:"h2",className:"salt-m-y--2","data-test":"account-settings-menu-title",children:o.menu}),s.jsx(C$,{messages:o})]}):s.jsx(C$,{messages:o})})]}),s.jsx(Y.Item,{colSpan:{xs:12,sm:8,lg:8},colStart:{sm:5,lg:4},children:s.jsx("div",{className:"salt-p-y--4",children:s.jsx(jb,{})})})]})]})},Ioe=()=>s.jsx(os,{type:"Settings::route",children:s.jsx(U9t,{})});Ioe.fetchData=async({context:{store:e}})=>{if(yoe(e.getState()))return e.dispatch(bs.getCurrentCustomer())};const T$={ERROR:"error",SUCCESS:"success"},G9t=ie.memo(({preference:{id:e,checkboxText:t,descriptionText:n,isChecked:o}})=>{const r=$o();return s.jsx(HI,{control:r.control,name:e,defaultValue:o,render:({field:a})=>s.jsx(mo,{...a,"data-test":e,input:{checked:a.value},label:t,bold:!0,last:!1,whiteSpace:"pre-wrap",children:n})},e)}),$9t=ie.memo(({groups:e})=>s.jsx(h.Fragment,{children:e.map(({titleText:t,subtitleText:n="",preferences:o})=>s.jsxs("div",{className:"salt-m-b--4",children:[t&&s.jsx(ne,{as:"h3",className:"salt-m-t--8 salt-m-b--4",children:t}),n&&s.jsx(GT,{as:"p",className:"salt-m-b--4",html:n}),o.map(r=>r.checkboxText&&s.jsx(G9t,{preference:r},r.id))]},`${t}-${n}`))})),_$={RETAILER_REGION_ID_PLACEHOLDER:"{RETAILER_REGION_ID}",ACTIVE_LOCALE_PLACEHOLDER:"{0}"},H9t=e=>{const t=E(ar),n=E(Vs);let o=e;return o?(t&&(o=o.replace(_$.RETAILER_REGION_ID_PLACEHOLDER,t)),n&&(o=o.replace(_$.ACTIVE_LOCALE_PLACEHOLDER,n)),o):null},V9t=({externalManagementUrl:e=null})=>{const t=H9t(e);return t?s.jsx(b,{asChild:!0,intent:"primary",children:s.jsx(rt,{href:t,intent:"ghost",target:"_blank","data-test":"marketing-preferences-retailer-managed-anchor",children:s.jsx(b.Text,{"aria-hidden":!0,children:s.jsx(v,{id:"settings.marketing.preferences.retailer.managed.button"})})})}):null},Y9t=({isRetailerManaged:e,groups:t,externalManagementUrl:n})=>s.jsx(h.Fragment,{children:e?s.jsx(V9t,{externalManagementUrl:n}):s.jsx($9t,{groups:t})}),W9t=ie.memo(({section:{id:e,titleText:t,headerText:n,groups:o,footers:r,isRetailerManaged:a,externalManagementUrl:i=null},lastUpdated:l})=>s.jsxs("div",{className:"salt-m-b--8",children:[t&&s.jsx(ne,{as:"h2",className:"salt-m-b--4",children:t}),n&&s.jsx("p",{className:"salt-m-b--4",children:n}),l?s.jsx(Y9t,{groups:o,isRetailerManaged:a,externalManagementUrl:i}):null,r.length>0&&s.jsx("div",{className:"salt-m-t--8 salt-m-b--4",children:r.map(c=>{const{headerText:d="",descriptionText:u}=c;return s.jsxs("div",{className:"salt-m-b--4",children:[d&&s.jsx(ne,{as:"h3",className:"salt-m-b--4",children:d}),u&&s.jsx(GT,{as:"p",html:u})]},`${e}-footer-${d}`)})})]},e)),q9t=(e,t)=>!!e&&e===t.id,K9t=({sections:e,lastUpdated:t})=>{const n=e.filter(o=>!o.isRetailerManaged).pop()?.id;return s.jsx(h.Fragment,{children:e.map(o=>s.jsxs(h.Fragment,{children:[s.jsx(W9t,{section:o,lastUpdated:t},o.id),q9t(n,o)&&s.jsx("div",{className:"salt-m-b--8",children:s.jsx(b,{intent:"primary",type:"submit","data-test":"preferences-save-button",fill:!1,disabled:!t,children:s.jsx(b.Text,{children:s.jsx(v,{id:"settings.marketing.preferences.save"})})})})]},o.id))})},z9t=({marketingPreferences:e})=>{const t=Gn(),{lastUpdated:n,preferences:{sections:o}}=e,r=rJ(),a=l=>{z[l](`settings.update.marketing.preferences.${l}`)},i=async l=>{try{await r(l),a(T$.SUCCESS)}catch{a(T$.ERROR)}};return s.jsx($n,{...t,children:s.jsx("form",{"data-test":"section-preferences",onSubmit:t.handleSubmit(i),children:s.jsx(K9t,{"data-test":"section-preferences-list",sections:o,lastUpdated:n})})})},Q9t=({isFetchError:e,onFetchMarketingPreferences:t,marketingPreferences:n})=>e?s.jsx(eu,{action:t}):s.jsx(z9t,{marketingPreferences:n}),Soe=()=>{const e=E(Yt),{marketingPreferences:t,onFetchMarketingPreferences:n}=KL(),{fetchError:o,preferences:r}=t,a=!!r.sections.length,i=o&&!a;return h.useEffect(()=>{const{lastUpdated:l}=t;(!e||!l)&&n()},[]),s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"settings.marketing.preferences.page.title"}),s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:s.jsx(v,{id:"settings.marketing.heading"})})}),s.jsx(Q9t,{isFetchError:i,onFetchMarketingPreferences:n,marketingPreferences:t})]})};Soe.fetchData=Bbt;const X9t={availableLanguages:p.arrayOf(p.string).isRequired,customerLanguage:p.string,registerField:p.func.isRequired,intl:p.any.isRequired},Z9t={customerLanguage:""},fM=e=>{const t={label:e.intl.formatMessage("accountSettings.language.selection.label"),language:{...$T(e.availableLanguages,e.intl)}};return s.jsx(Pd,{label:t.label,...e.registerField({name:"language",type:"select",value:e.customerLanguage||e.availableLanguages[0]}),"data-synthetics":"language-select",children:e.availableLanguages.map(n=>s.jsx("option",{value:n,children:t.language[n]},n))})};fM.propTypes=X9t;fM.defaultProps=Z9t;const J9t={fields:p.arrayOf(p.shape({name:p.string.isRequired,label:p.string,placeholder:p.string,options:p.arrayOf(p.string),required:p.bool,type:p.string,validation:p.shape({messageKey:p.string,test:p.string}),readOnly:p.bool})).isRequired,intl:p.any.isRequired,isValid:p.func.isRequired,isReadOnly:p.bool.isRequired,registerField:p.func.isRequired,phoneNumberValidation:p.string.isRequired,areInitialValuesFetched:p.bool,values:p.objectOf(p.any)},e7t={values:{},areInitialValuesFetched:!0},t7t=T(ii)`
    html[dir='rtl'] & {
        text-align: end;
    }
`;class yM extends h.Component{constructor(t){super(t),this.generateField=this.generateField.bind(this)}getPhoneNumberValidation(){const{phoneNumberValidation:t}=this.props;return{test:n=>new RegExp(t).test(n),error:this.props.intl.formatMessage("accountSettings.contactDetails.mobilePhoneError")}}getTranslatedValidation({test:t,messageKey:n}={}){return t&&{test:t,error:this.props.intl.formatMessage(n)}}generateField(t){const n=this.transformField(t),{name:o,label:r,placeholder:a,type:i,options:l,required:c,readOnly:d,meta:u}=n,g={text:ii,tel:t7t,select:Pd,checkbox:mo}[i]||ii,f={key:o,label:r,placeholder:a,readOnly:d,required:c,type:i,meta:u,...this.props.registerField(n,this.props.areInitialValuesFetched)};if(i==="checkbox"){const{checked:y,onChange:I,...S}=f;return s.jsx(g,{bold:!1,input:{checked:y,onChange:I},label:r,"data-pii":"true",...S})}return i==="select"?s.jsx(g,{...f,"data-pii":"true",children:l.map(y=>s.jsx("option",{value:y,children:y},y))}):s.jsx(g,{...f,"data-pii":"true"})}transformField(t){const{intl:n,values:o,isReadOnly:r}=this.props,{label:a,placeholder:i,required:l,validation:c,options:d,type:u,...m}=t,g={meta:{touched:!1,invalid:!1},label:n.formatMessage(a),placeholder:n.formatMessage(i),value:o[t.name],...m};return r?{type:"text",readOnly:!0,...g}:{requiredMessage:l&&n.formatMessage("settings.user.details.required.field"),validation:u==="tel"?this.getPhoneNumberValidation():this.getTranslatedValidation(c),type:u,options:d,required:l,...g}}render(){const{fields:t}=this.props;return t.map(this.generateField)}}yM.propTypes=J9t;yM.defaultProps=e7t;const s7t=({handleSubmit:e,intl:t,fields:n,customer:o,registerField:r,phoneNumberValidation:a,isValid:i,isLanguageSelectionAvailable:l,isReadOnly:c,availableLanguages:d,customerLanguage:u})=>s.jsxs("form",{onSubmit:e,"data-test":"details-form",children:[s.jsx(yM,{intl:t,fields:n,values:o.data,registerField:r,phoneNumberValidation:a,isValid:i,isReadOnly:c,areInitialValuesFetched:!!o.lastUpdated}),l&&s.jsx(fM,{registerField:r,availableLanguages:d,customerLanguage:u,intl:t}),s.jsx(b,{className:c?"salt-d--none":void 0,disabled:c,intent:"primary",type:"submit","data-test":"details-submit-button",children:s.jsx(b.Text,{children:t.formatMessage("settings.user.details.save")})})]}),n7t={externalAccountManagementUrl:p.string,redirectUrl:p.string,children:p.node.isRequired},o7t={externalAccountManagementUrl:void 0,redirectUrl:void 0},IM=({externalAccountManagementUrl:e,redirectUrl:t,children:n})=>{const o=()=>{if(e){if(t){const r=`?redirect_uri=${t}`;return window.open(`${e}${r}`,"_self")}return window.open(`${e}`,"_self")}return z.error("toast.notification.generic.error")};return s.jsx(b,{intent:"primary","data-test":"change-details-button",onClick:o,children:s.jsx(b.Text,{children:n})})},r7t=e=>({externalAccountManagementUrl:dae(e),redirectUrl:cae(e)});IM.defaultProps=o7t;IM.propTypes=n7t;const a7t=ke(r7t)(IM),i7t=D("lng"),l7t=D("ads"),c7t=D("ecam"),d7t=({actions:e,customer:t,intl:n,fields:o,defaultMobilePhoneCountry:r,phoneNumberValidation:a,availableLanguages:i,customerLanguage:l,registerField:c,getFieldValues:d,updateForm:u,isValid:m,isFormReadOnly:g,isServerRendered:f,isSuperuser:y,isAccountDetailsSplit:I,isLanguageSelectEnabled:S})=>{const C=goe();let _=!1;const[A,x]=h.useState(!1),R=F(),O=()=>{const $=t.data,K=d(),Q=Object.keys(K).reduce((X,re)=>($[re]&&K[re]!==$[re]&&(X[re]=$[re]),X),{});return Object.keys(Q).length>0?u(Q):!1};h.useEffect(()=>{x(o.every($=>$.readOnly)&&!j()),(!f||!t.lastUpdated)&&e.getCurrentCustomer().then(O).catch($=>$)},[]);const N=$=>e.updateCustomerLanguage($).then(()=>{e.analyticsEvent({type:nr.LOCALE_CHANGED,locale:$});const K={event:"event",eventAction:"LOCALE_CHANGED",eventCategory:"Locale",eventLabel:$};J.sendEvent({GA:K,WA:null}),e.analyticsEvent({type:nr.LOCALE_CHANGED_GA4,locale:$});const Q={event:"locale_changed",locale:$};J.sendEvent({GA:Q,WA:null})}).then(()=>{_=!0}),k=$=>Wue($,r)(R),j=()=>!I&&S&&i.length>1,w=$=>j()&&l!==$,L=$=>!!Object.keys($).filter(K=>$[K]!==t.data[K]).length,B=()=>!I&&!y,W=$=>{if($.preventDefault(),m()){const{language:K,...Q}=d(),X={details:L(Q),language:w(K)};return!X.details&&!X.language?!1:Promise.resolve().then(()=>X.details?k(Q):Promise.resolve()).then(()=>X.language?N(K):Promise.resolve()).then(e.getCurrentCustomer).then(()=>{z.success("settings.account.details.update.success")}).then(()=>{_&&EE(K)}).catch(re=>{_=!1;const ue=re?.message==="Invalid phone number provided"?"accountSettings.contactDetails.mobilePhoneError":"settings.account.details.update.error";z.error(ue)})}return!1};return t.lastUpdated?s.jsxs(ie.Fragment,{children:[s.jsx("div",{className:"salt-m-b--4",children:s.jsx(s7t,{"data-test":"user-details-form",handleSubmit:W,intl:n,fields:o,customer:t,registerField:c,phoneNumberValidation:a,isValid:m,isLanguageSelectionAvailable:j(),isReadOnly:g||A,customerLanguage:l,availableLanguages:i})}),g&&!B()&&s.jsx(a7t,{"data-test":"details-edit-button",children:s.jsx(v,{id:"settings.user.details.edit"})}),B()?s.jsx("form",{onSubmit:C,children:s.jsx(hoe,{})}):null]}):s.jsx(Rs,{"data-test":"user-details-spinner"})},u7t=e=>({customer:ec(e),fields:iae(e),defaultMobilePhoneCountry:qe(e,"default-mobile-phone-number-default-country"),phoneNumberValidation:qe(e,"validation-mobile-phone-number-mask-frontend"),availableLanguages:Ep(e),customerLanguage:hH(e),isLanguageSelectEnabled:i7t(e)&&MD(e),isAccountDetailsSplit:l7t(e),isFormReadOnly:c7t(e),isServerRendered:Yt(e),isSuperuser:e.session.isSuperuser}),p7t=ot({analyticsEvent:U.analyticsEvent,getCurrentCustomer:bs.getCurrentCustomer,updateCustomerLanguage:bs.updateCustomerLanguage}),m7t=Ct(Bt,ke(u7t,p7t),JW)(d7t),h7t=D("ads"),Coe=()=>s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:"settings.details.page.title"}),s.jsx(Ee,{asChild:!0,children:s.jsx("h2",{children:s.jsx(v,{id:"settings.details.heading"})})}),s.jsx(m7t,{})]});Coe.fetchData=({context:{store:e}})=>h7t(e.getState())?Promise.resolve():e.dispatch(bs.getCurrentCustomer());const g7t=D("homedel"),E7t=Zs.isSubscriptionEnabled,f7t=D("loyalty"),y7t=D("ads"),I7t=D("pay.ywlt"),S7t=D("hmpv"),C7t=D("dlvr.pref"),T7t=D("ccai"),_7t=e=>[{path:"/settings",Component:e.Main,children:[{path:"/settings",Component:ws(Ze,Ioe),children:[{index:!0,Component:S$},{path:"customerDetails",Component:S$},{path:"login-details",Component:Gl([{condition:y7t,failComponent:lt}],Eoe)},{path:"user-details",Component:Coe},{path:"language",Component:Gl([{condition:jx,failComponent:lt}],Vne)},{path:"wallet",Component:Xt(I7t,Yne,lt)},{path:"addresses",Component:Xt(g7t,E9t,lt)},{path:"delivery-pass",Component:Xt(E7t,ooe,lt)},{path:"loyalty",Component:Xt(f7t,k6t,lt)},{path:"accessibility",Component:BQt},{path:"marketing",Component:Xt(S7t,lt,Soe)},{path:"delivery-preferences",Component:Xt(C7t,coe,lt)},{path:"help-centre",Component:Xt(T7t,UQt,lt)},{path:"*",Component:lt}]}]}],v7t=D("sis"),A7t=e=>[{path:"/shop-in-shop/:pageId",Component:e.Main,children:[{index:!0,lazy:async()=>{const{ShopInShop:t}=await Rn(async()=>{const{ShopInShop:n}=await import("./shop-in-shop-DWPo7uNb.js");return{ShopInShop:n}},__vite__mapDeps([20,1,2,3]));return{Component:Xt(v7t,t,lt)}}}]}],b7t=e=>[{path:"/lists",Component:e.Main,children:[{index:!0,lazy:async()=>{const{ShoppingLists:t}=await Rn(async()=>{const{ShoppingLists:n}=await import("./shopping-lists-CtmPMhdK.js");return{ShoppingLists:n}},__vite__mapDeps([21,1,2,3,22]));return{Component:ws(Ze,t)}}},{path:":listId",lazy:async()=>{const{ShoppingListDetails:t}=await Rn(async()=>{const{ShoppingListDetails:n}=await import("./shopping-list-details-BGrvRjef.js");return{ShoppingListDetails:n}},__vite__mapDeps([23,1,2,3,22]));return{Component:ws(Ze,t)}}}]}],x7t=({items:e=[],id:t="",name:n=""})=>s.jsx(AX,{id:t,items:e,name:n,meta:{PAGE_TYPE:null,PAGE_NAME:"static_page",BANNER_PLACEMENT:"HERO",LOCATION:"CONTENT_PAGE"}}),R7t=ie.memo(x7t,(e,t)=>e.id===t.id),D7t=()=>{const e=F(),[t]=fe(["cf.sp.comp"]),{pageId:n,content:o,pageTitle:r,componentItems:a,isFetching:i,fetchError:l}=E(zee),c=co();return h.useEffect(()=>{n!==c.pageId&&e(K3(c.pageId))},[c.pageId]),i?s.jsx("div",{className:"salt-m-t--32",children:s.jsx(Rs,{size:"m"})}):l?s.jsx(lt,{}):t&&a&&n?s.jsx("div",{"data-test":"static-page-componentized",className:"salt-m-t--4 salt-m-b--2 salt-m-x--2",children:s.jsx(R7t,{id:n,items:a,name:r})}):o?s.jsxs(h.Fragment,{children:[s.jsx(rs,{title:r,skipFormatTitle:!0}),s.jsx("div",{"data-test":"static-page",dangerouslySetInnerHTML:{__html:o}})]}):s.jsx(lt,{})},Toe=()=>s.jsx(os,{type:"FailedPaymentSummary::route",children:s.jsx(D7t,{})});Toe.fetchData=async({context:{store:e},params:t})=>e.dispatch(K3(t.pageId));const O7t=e=>[{path:"/content/:pageId",Component:e.Main,key:"main",children:[{index:!0,Component:Toe}]}],Os={Main:ute,Checkout:mte},P7t=[{path:"/",Component:_6,children:[...nZe(Os),...Vmt(Os),...XYt(Os),...v6t(Os),...tRt(Os),..._Ut(Os),...Azt(Os),...b6t(Os),...k5t(Os),...eWt(Os),..._7t(Os),...jVt(Os),...zYt(Os),...QYt(Os),...N6t(Os),...qmt(Os),...hyt(Os),...R6t(Os),...b7t(Os),...rZe(),...O7t(Os),...j5t(Os),...A7t(Os),...cut(Os),...JYt(Os),...ZYt(Os),...Kmt(Os),...vUt(Os),{path:"*",Component:Os.Main,key:"main",children:[{path:"*",Component:lt}]}]}],v$=P7t;Mt.updateLocale("ar-sa",{preparse:e=>e,postformat:e=>e});async function N7t(){const e=D("faro")(Y_.getState()),t=Wt(Y_.getState());await Promise.all((A$(v$,window.location,t)??[]).map(async a=>{if(typeof a.route.lazy=="function"){const i=await a.route.lazy();Object.assign(a.route,{...i,lazy:void 0})}}));const n={},o=Fre(v$,{basename:t,hydrationData:window.__staticRouterHydrationData}),r=e?Bre(o):o;Pb.hydrateRoot(document.getElementById("app"),s.jsx(C9e,{store:Y_,router:r,helmetContext:n}))}N7t();export{nXt as $,Hgt as A,b as B,tn as C,Zo as D,jo as E,MN as F,lXt as G,IP as H,me as I,cXt as J,ze as K,rt as L,G as M,fQ as N,Co as O,CXt as P,EQ as Q,MC as R,d8 as S,lT as T,sXt as U,zt as V,Qe as W,fo as X,IXt as Y,Bu as Z,rXt as _,Ii as a,bn as a$,aXt as a0,iXt as a1,Cs as a2,$e as a3,pXt as a4,Mve as a5,Ce as a6,bq as a7,H as a8,Ke as a9,fN as aA,oe as aB,KE as aC,Fr as aD,gXt as aE,fn as aF,da as aG,yt as aH,st as aI,Vd as aJ,Vs as aK,Eot as aL,xZt as aM,CQ as aN,WXt as aO,Ve as aP,oi as aQ,QXt as aR,ra as aS,EXt as aT,vZt as aU,got as aV,fot as aW,YXt as aX,Lve as aY,Va as aZ,AZt as a_,Qt as aa,bR as ab,ts as ac,lx as ad,i0 as ae,ca as af,VW as ag,z as ah,Z as ai,Zu as aj,BW as ak,Kt as al,YR as am,xq as an,v as ao,sl as ap,KC as aq,o8 as ar,Up as as,Ze as at,eXt as au,u9 as av,Ft as aw,Ws as ax,xl as ay,dXt as az,wa as b,ln as b$,Oa as b0,TZt as b1,nBe as b2,mt as b3,CZt as b4,_Zt as b5,Ue as b6,zXt as b7,KXt as b8,qXt as b9,ks as bA,V7t as bB,xXt as bC,Bn as bD,B7t as bE,iH as bF,wue as bG,U7t as bH,ag as bI,vi as bJ,lt as bK,Qn as bL,Gp as bM,pc as bN,rs as bO,qCt as bP,_T as bQ,TQ as bR,cs as bS,Nve as bT,NA as bU,lc as bV,Ui as bW,Rs as bX,ur as bY,Ca as bZ,lI as b_,bZt as ba,VXt as bb,Dgt as bc,eu as bd,mZt as be,mXt as bf,hXt as bg,Jt as bh,iZt as bi,lZt as bj,V_ as bk,fXt as bl,J7t as bm,X7t as bn,ps as bo,tXt as bp,jve as bq,gt as br,os as bs,qs as bt,K7t as bu,G7t as bv,Yt as bw,qPe as bx,Cr as by,U1e as bz,Wt as c,At as c$,tZt as c0,nZt as c1,W5 as c2,sZt as c3,Kf as c4,rEt as c5,Ks as c6,io as c7,XXt as c8,tl as c9,ka as cA,X5 as cB,EQe as cC,gPe as cD,aZt as cE,rZt as cF,H_ as cG,Mg as cH,Ss as cI,Fd as cJ,hn as cK,RXt as cL,Sm as cM,zN as cN,lo as cO,kqe as cP,OC as cQ,RC as cR,d4 as cS,Tse as cT,Fu as cU,sVt as cV,KN as cW,$u as cX,ul as cY,Md as cZ,Vt as c_,ngt as ca,dgt as cb,JXt as cc,Ts as cd,eZt as ce,Xp as cf,VR as cg,iT as ch,ZXt as ci,qe as cj,Jd as ck,on as cl,VD as cm,Qs as cn,aP as co,sg as cp,cee as cq,BZt as cr,xn as cs,ho as ct,oZt as cu,$_ as cv,DZt as cw,fd as cx,tZ as cy,Ci as cz,MZt as d,Kd as d$,Mr as d0,Ql as d1,VP as d2,Ho as d3,Et as d4,tE as d5,nl as d6,xS as d7,Te as d8,Yo as d9,XC as dA,EP as dB,O9 as dC,rI as dD,CN as dE,OR as dF,iJe as dG,yP as dH,dZt as dI,uZt as dJ,OZt as dK,NZt as dL,PZt as dM,pZt as dN,ee as dO,On as dP,jXt as dQ,S4e as dR,Qg as dS,He as dT,u_ as dU,Ya as dV,qi as dW,Hl as dX,EV as dY,dV as dZ,gV as d_,_e as da,go as db,Zt as dc,Y0 as dd,j7t as de,w7t as df,Ht as dg,zpt as dh,Kpt as di,FZt as dj,Eq as dk,vo as dl,fZe as dm,IVt as dn,NW as dp,Kb as dq,yXt as dr,F7t as ds,H7t as dt,ec as du,a4 as dv,bs as dw,SP as dx,k_ as dy,u8 as dz,YB as e,a0e as e$,ayt as e0,ch as e1,Ao as e2,ng as e3,LZt as e4,CT as e5,oc as e6,Zmt as e7,Oi as e8,mtt as e9,yn as eA,Id as eB,DXt as eC,oo as eD,Pc as eE,OXt as eF,is as eG,PXt as eH,As as eI,jZt as eJ,Y7t as eK,Li as eL,eE as eM,iS as eN,Jg as eO,s$t as eP,fte as eQ,mZ as eR,AXt as eS,Cn as eT,i0e as eU,vXt as eV,dC as eW,n0e as eX,uC as eY,QD as eZ,r0e as e_,PF as ea,Uc as eb,X7 as ec,An as ed,$Xt as ee,HXt as ef,yV as eg,DN as eh,fV as ei,xV as ej,BXt as ek,WO as el,YO as em,tIe as en,Vo as eo,Xee as ep,sIe as eq,wXt as er,FXt as es,UXt as et,GXt as eu,AV as ev,xa as ew,Lct as ex,kN as ey,ga as ez,Me as f,_d as f$,o0e as f0,zD as f1,oVe as f2,ir as f3,iK as f4,dS as f5,bXt as f6,cS as f7,bg as f8,tT as f9,YSe as fA,pe as fB,ae as fC,gs as fD,Wo as fE,sne as fF,Ng as fG,t8 as fH,hP as fI,WC as fJ,AP as fK,MXt as fL,YZe as fM,Pn as fN,TT as fO,yX as fP,Rrt as fQ,$ze as fR,q1 as fS,fs as fT,Q7 as fU,ES as fV,rg as fW,Rx as fX,$de as fY,Dx as fZ,Ip as f_,V8 as fa,$7t as fb,Lh as fc,Tn as fd,iy as fe,Yn as ff,Cte as fg,Kn as fh,rp as fi,SD as fj,pp as fk,yd as fl,YE as fm,VE as fn,gn as fo,Ds as fp,Hg as fq,$g as fr,Vet as fs,dp as ft,_Xt as fu,ot as fv,XWt as fw,vu as fx,ml as fy,N_ as fz,Qu as g,Y1 as g0,W1 as g1,Ude as g2,Ox as g3,K1 as g4,Yze as g5,Vze as g6,zh as g7,ft as g8,$gt as g9,IZt as gA,fC as gB,yC as gC,vr as gD,jt as gE,fT as gF,Oj as gG,gN as gH,FS as gI,fZt as gJ,Rat as gK,yZt as gL,cZt as gM,rX as ga,sgt as gb,iht as gc,Nht as gd,I3 as ge,Nze as gf,iyt as gg,vT as gh,La as gi,kXt as gj,NXt as gk,LXt as gl,EZt as gm,pet as gn,hZt as go,kZt as gp,Xot as gq,gZt as gr,SZt as gs,Oat as gt,q7t as gu,Ai as gv,W7t as gw,Nwe as gx,gP as gy,Ot as gz,EX as h,lEt as i,Bst as j,D as k,pn as l,AJe as m,oXt as n,ll as o,Z7t as p,se as q,U as r,J as s,T as t,fe as u,uXt as v,Q7t as w,z7t as x,WPe as y,G2 as z};
//# sourceMappingURL=index-DCzVCakK.js.map
